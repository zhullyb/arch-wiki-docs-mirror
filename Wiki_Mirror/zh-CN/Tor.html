<!DOCTYPE html>
<html class="client-nojs" lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<title>Tor (简体中文) - ArchWiki</title>
<link rel="stylesheet" href="../ArchWikiOffline.css">
<meta name="ResourceLoaderDynamicStyles" content="">
<meta name="generator" content="MediaWiki 1.35.0">
<meta name="referrer" content="no-referrer-when-downgrade">
<meta name="robots" content="noindex,follow">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="shortcut icon" href="/favicon.ico">
<link rel="search" type="application/opensearchdescription+xml" href="/opensearch_desc.php" title="ArchWiki (en)">
<link rel="EditURI" type="application/rsd+xml" href="https://wiki.archlinux.org/api.php?action=rsd">
<link rel="license" href="http://www.gnu.org/copyleft/fdl.html">
<link rel="alternate" type="application/atom+xml" title="ArchWiki Atom feed" href="/index.php?title=Special:RecentChanges&amp;feed=atom">
</head>
<body class="mediawiki ltr sitedir-ltr mw-hide-empty-elt ns-0 ns-subject page-Tor_简体中文 rootpage-Tor_简体中文 skin-vector action-view skin-vector-legacy">
<div id="content" class="mw-body" role="main" style="margin: 0">
	<a id="top"></a>
	<div id="siteNotice" class="mw-body-content"></div>
	<div class="mw-indicators mw-body-content">
	</div>
	<h1 id="firstHeading" class="firstHeading" lang="en">Tor (简体中文)</h1>
	<div id="bodyContent" class="mw-body-content">
		<div id="siteSub" class="noprint">From ArchWiki</div>
		<div id="contentSub"></div>
		<div id="contentSub2"></div>
		
		<div id="jump-to-nav"></div>
		<a class="mw-jump-link" href="#mw-head">Jump to navigation</a>
		<a class="mw-jump-link" href="#searchInput">Jump to search</a>
		<div id="mw-content-text" lang="en" dir="ltr" class="mw-content-ltr">
<div class="warningbox">The printable version is no longer supported and may have rendering errors. Please update your browser bookmarks and please use the default browser print function instead.</div>
<div class="mw-parser-output">
<div class="archwiki-template-meta-related-articles-start">
<p>相关文章</p>
<ul>
<li><a href="../en/Privoxy.html" title="Privoxy">Privoxy</a></li>
<li><a href="../en/Polipo.html" title="Polipo">Polipo</a></li>
</ul>
</div>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>翻译状态：</strong>本文是 <a href="../en/Tor.html" title="Tor">Tor</a> 的<a href="../zh-CN/ArchWiki:Translation_Team.html" title="ArchWiki:Translation Team (简体中文)">翻译</a>。上次翻译日期：2020-04-02。如果英文版本有所<a rel="nofollow" class="external text" href="https://wiki.archlinux.org/index.php?title=Tor&amp;diff=0&amp;oldid=489707">更改</a>，则您可以帮助同步翻译。</div>
<p><a rel="nofollow" class="external text" href="https://www.torproject.org/download/download.html.en">Tor</a> 是一个开源实现，第二代洋葱路由匿名代理网络，提供免费访问。其首要目标是通过对流量分析攻击保护，使网上的匿名性。
</p>
<div id="toc" class="toc" role="navigation" aria-labelledby="mw-toc-heading">
<input type="checkbox" role="button" id="toctogglecheckbox" class="toctogglecheckbox" style="display:none"><div class="toctitle" lang="en" dir="ltr">
<h2 id="mw-toc-heading">Contents</h2>
<span class="toctogglespan"><label class="toctogglelabel" for="toctogglecheckbox"></label></span>
</div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#%E4%BB%8B%E7%BB%8D"><span class="tocnumber">1</span> <span class="toctext">介绍</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#%E5%AE%89%E8%A3%85"><span class="tocnumber">2</span> <span class="toctext">安装</span></a></li>
<li class="toclevel-1 tocsection-3"><a href="#%E9%85%8D%E7%BD%AE"><span class="tocnumber">3</span> <span class="toctext">配置</span></a></li>
<li class="toclevel-1 tocsection-4"><a href="#%E7%94%A8%E6%B3%95"><span class="tocnumber">4</span> <span class="toctext">用法</span></a></li>
<li class="toclevel-1 tocsection-5">
<a href="#%E7%BD%91%E9%A1%B5%E6%B5%8F%E8%A7%88"><span class="tocnumber">5</span> <span class="toctext">网页浏览</span></a>
<ul>
<li class="toclevel-2 tocsection-6"><a href="#Firefox"><span class="tocnumber">5.1</span> <span class="toctext">Firefox</span></a></li>
<li class="toclevel-2 tocsection-7"><a href="#Chromium"><span class="tocnumber">5.2</span> <span class="toctext">Chromium</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-8">
<a href="#%E5%8D%B3%E6%97%B6%E9%80%9A%E4%BF%A1"><span class="tocnumber">6</span> <span class="toctext">即时通信</span></a>
<ul>
<li class="toclevel-2 tocsection-9"><a href="#Pidgin"><span class="tocnumber">6.1</span> <span class="toctext">Pidgin</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-10">
<a href="#Irssi"><span class="tocnumber">7</span> <span class="toctext">Irssi</span></a>
<ul>
<li class="toclevel-2 tocsection-11"><a href="#%E5%A4%96%E9%83%A8%E9%93%BE%E6%8E%A5"><span class="tocnumber">7.1</span> <span class="toctext">外部链接</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-12">
<a href="#%E4%BD%BF%E7%94%A8_HTTP_%E4%BB%A3%E7%90%86"><span class="tocnumber">8</span> <span class="toctext">使用 HTTP 代理</span></a>
<ul>
<li class="toclevel-2 tocsection-13"><a href="#Polipo"><span class="tocnumber">8.1</span> <span class="toctext">Polipo</span></a></li>
<li class="toclevel-2 tocsection-14">
<a href="#Privoxy"><span class="tocnumber">8.2</span> <span class="toctext">Privoxy</span></a>
<ul>
<li class="toclevel-3 tocsection-15"><a href="#%E5%9C%A8Firefox%E4%BD%BF%E7%94%A8Tor_%E5%92%8C_Privoxy"><span class="tocnumber">8.2.1</span> <span class="toctext">在Firefox使用Tor 和 Privoxy</span></a></li>
<li class="toclevel-3 tocsection-16"><a href="#%E5%9C%A8%E5%85%B6%E4%BB%96%E7%A8%8B%E5%BA%8F%E4%BD%BF%E7%94%A8Tor_%E5%92%8CPrivoxy"><span class="tocnumber">8.2.2</span> <span class="toctext">在其他程序使用Tor 和Privoxy</span></a></li>
</ul>
</li>
</ul>
</li>
<li class="toclevel-1 tocsection-17">
<a href="#%E8%BF%90%E8%A1%8CTor_%E6%9C%8D%E5%8A%A1"><span class="tocnumber">9</span> <span class="toctext">运行Tor 服务</span></a>
<ul>
<li class="toclevel-2 tocsection-18"><a href="#%E9%85%8D%E7%BD%AE_2"><span class="tocnumber">9.1</span> <span class="toctext">配置</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-19"><a href="#%E8%BF%90%E8%A1%8C_Tor_%E6%A1%A5"><span class="tocnumber">10</span> <span class="toctext">运行 Tor 桥</span></a></li>
<li class="toclevel-1 tocsection-20"><a href="#TorDNS"><span class="tocnumber">11</span> <span class="toctext">TorDNS</span></a></li>
<li class="toclevel-1 tocsection-21"><a href="#Torify"><span class="tocnumber">12</span> <span class="toctext">Torify</span></a></li>
<li class="toclevel-1 tocsection-22">
<a href="#%E9%97%AE%E9%A2%98%E8%A7%A3%E5%86%B3"><span class="tocnumber">13</span> <span class="toctext">问题解决</span></a>
<ul>
<li class="toclevel-2 tocsection-23"><a href="#User_value%E7%9A%84%E9%97%AE%E9%A2%98"><span class="tocnumber">13.1</span> <span class="toctext">User value的问题</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-24"><a href="#%E5%A4%96%E9%83%A8%E9%93%BE%E6%8E%A5_2"><span class="tocnumber">14</span> <span class="toctext">外部链接</span></a></li>
</ul>
</div>

<h2>
<span id=".E4.BB.8B.E7.BB.8D"></span><span class="mw-headline" id="介绍">介绍</span>
</h2>
<p>使用Tor网络在他们的机器上运行洋葱代理。这个软件向外连接到Tor，定期的通过Tor网络连接一个虚拟的电子回路。Tor在一个分层方式采用加密(因此有了‘洋葱’的比喻),确保路由器之间的完全保密。 同时， 洋葱代理服务器软件，向客户端提出了SOCKS接口。SOCKS监听程序是Tor的特点，通过Tor的虚拟电路的流量，然后复。
</p>
<div class="archwiki-template-box archwiki-template-box-warning">
<strong>警告：</strong> 仅仅使用Tor不能保证匿名。这里可以看出几个主要的误导 (see: <a rel="nofollow" class="external autonumber" href="https://www.torproject.org/download/download.html.en#%E4%BB%80%E4%B9%88%E6%98%AFTor%E7%9C%9F%E6%AD%A3%E7%9A%84%E5%B7%A5%E4%BD%9C">[1]</a>)。</div>
<p>通过这个过程洋葱代理将会管理终端用户的匿名网络流量。它通过加密流量来保持用户的匿名， 通过Tor的其他节点来发送信息，在发送信息到你指定的服务器之前解密。虽然Tor相对的来说比一般的使用DNS目录连接安全(例如：没有使用代理), 由于大量的数据加密所以它相对来说比较慢。 此外，尽Tor阻止了流量分析但是Tor不能阻Tor网络边界流量的确认。(例如：例如流量进入或者退出网络)。
</p>
<p><a href="https://en.wikipedia.org/wiki/Tor_(anonymity_network)" class="extiw" title="wikipedia:Tor (anonymity network)">Wikipedia:Tor (anonymity network)</a>
</p>
<h2>
<span id=".E5.AE.89.E8.A3.85"></span><span class="mw-headline" id="安装">安装</span>
</h2>
<p><a href="../zh-CN/Pacman.html" title="Pacman (简体中文)">安装</a>位于<a href="../zh-CN/Official_repositories.html" title="Official repositories (简体中文)">官方软件仓库</a>的软件包 <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=tor">tor</a></span>。 
</p>
<p>此外，还可以安装 <a href="../en/Qt.html" title="Qt">Qt</a> 前端 <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://aur.archlinux.org/packages/vidalia/">vidalia</a></span><sup><small>AUR</small></sup>。除了控制 Tor 进程外，Vidalia 可以查看 Tor 的配置和状态、监控带宽使用并查看、过滤和搜索日志信息。
</p>
<h2>
<span id=".E9.85.8D.E7.BD.AE"></span><span class="mw-headline" id="配置">配置</span>
</h2>
<p>为了跟好的理解Tor<code>/etc/tor/torrc</code>配置文件. 配置选项在 man tor<span class="plainlinks archwiki-template-man" title="$ man 1 tor"><a rel="nofollow" class="external text" href="https://man.archlinux.org/man/tor.1">tor(1)</a></span>和<a rel="nofollow" class="external text" href="https://www.torproject.org/docs/tor-manual.html.en">Tor website</a>有介绍. 
</p>
<p>默认配置应该能够很好的为大多数Tor用户服务除了哪些是用Vidalia的用户, Vidalia是一Tor的图形界面。 在<a href="../en/Arch_User_Repository.html" class="mw-redirect" title="AUR">AUR</a>有可用包<span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://aur.archlinux.org/packages/vidalia/">vidalia</a></span><sup><small>AUR</small></sup>。除了控制过程中的Vidalia允许您查看Tor状态监视带宽使用情况，查看，过滤，搜索日志消息;和配置Tor的某些方面。
</p>
<p>使用<code>TOR_MAX_FD</code>变量，您可以设置自定义文件为Tor的描述ulimits<code>/etc/conf.d/tor</code>。
</p>
<p>默认情况下的Tor记录在日志级别的通知“STDOUT”。如果你能够记录在自己的文件<code>torrc</code>, 他们默认为 <code>/usr/local/var/log/tor/</code>.
</p>
<h2>
<span id=".E7.94.A8.E6.B3.95"></span><span class="mw-headline" id="用法">用法</span>
</h2>
<p>可以通过命令行或 <b>vidalia</b> 等图形程序启动 Tor.
</p>
<p>要永久连接，可以启动 <b>tor</b> <a href="../en/Daemons.html" class="mw-redirect" title="Daemon">daemon</a> 并将其加入 <code>DAEMONS</code> 数组。
</p>
<p>程序配置成实验 127.0.0.1 或 localhost 作为 SOCKS5 代理就可以使用 Tor，端口要设置成 9050 (Tor 标准设置) 或 9051 (用 <b>vidalia</b>标准配置).
</p>
<p>访问 <a rel="nofollow" class="external text" href="https://check.torproject.org/">Tor</a>、<a rel="nofollow" class="external text" href="http://serifos.eecs.harvard.edu/cgi-bin/ipaddr.pl?tor=1">Harvard</a> 或 <a rel="nofollow" class="external text" href="https://torcheck.xenobite.eu/">Xenobite.eu</a> 可以检查 Tor 是否正确运行。
</p>
<h2>
<span id=".E7.BD.91.E9.A1.B5.E6.B5.8F.E8.A7.88"></span><span class="mw-headline" id="网页浏览">网页浏览</span>
</h2>
<p>Tor主要支持Firefox，但是也支持Chromium。
</p>
<h3><span class="mw-headline" id="Firefox">Firefox</span></h3>
<p>如果你使用Firefox, 你可以安装这个插件: <a rel="nofollow" class="external text" href="https://www.torproject.org/torbutton/">TorButton</a>。这将允许你很容易地在Tor的网络和正常网络切换。
</p>
<p>如果你正在使用多代理(例如：如果你想使用 TOR 和 "ssh -D") 也有一个插件叫作 "<a rel="nofollow" class="external text" href="https://addons.mozilla.org/firefox/addon/foxyproxy-standard/">FoxyProxy</a>" 他允许你对于不同网址或者全部网址指定多个代理。只需将它指向localhost上的端口8118（polipo运行中）。
</p>
<p>为了测试他, 在你的浏览器打开或者关闭Tor浏览这个网址<a rel="nofollow" class="external text" href="https://check.torproject.org/">this website</a>。
更多信息请查看这个网址<a rel="nofollow" class="external text" href="https://www.torproject.org/docs/tor-doc-unix.html.en">the official doc</a>。
</p>
<h3><span class="mw-headline" id="Chromium">Chromium</span></h3>
<p>当你使用Tor和Chromium时不需要polipo。只需要简单的运行Tor daemon, 
</p>
<p>然后运行：
</p>
<pre>$ chromium --proxy-server="socks://localhost:9050"
</pre>
<h2>
<span id=".E5.8D.B3.E6.97.B6.E9.80.9A.E4.BF.A1"></span><span class="mw-headline" id="即时通信">即时通信</span>
</h2>
<p>要让即时通信程序使用 Tor，并不需要 <a href="../en/Polipo.html" title="Polipo">polipo</a>/<a href="../en/Privoxy.html" title="Privoxy">privoxy</a> 等 http 代理。直接使用 tor 守护进程监听的端口 9050 即可。
</p>
<h3><span class="mw-headline" id="Pidgin">Pidgin</span></h3>
<p>通过 preferences -&gt; proxy 进入编辑，设置为：
</p>
<pre>Proxy type 	SOCKS5
Host 	        127.0.0.1
Port 	        9150
</pre>
<p>之后 <a href="../en/Pidgin.html" title="Pidgin">pidgin</a> 会使用 Tor 进行通信。有时根据不同账号的 IM 服务配置，需要修改代理设置。在 Accounts -&gt; Manage Accounts 中选择要修改的账号，在  Proxy 标签页中选择：
</p>
<pre>Proxy type 	Use Global Proxy Settings
</pre>
<h2><span class="mw-headline" id="Irssi">Irssi</span></h2>
<p>Freenode 不推荐使用 <a href="../en/Irssi.html" title="Irssi">Irssi</a> 和 Privoxy。他们推荐 <code>mapaddress</code> 方式，通过运行 <code>torify irssi</code> 启动。将下行加入 <code>/etc/tor/torrc</code>:
</p>
<pre>mapaddress  10.40.40.40 p4fsi4ockecnea7l.onion
</pre>
<p>Freenode 需要 charybdis 和 ircd-seven 的 SASL 机制在连接时进行 nickserv 确认。从 Freenode 网站(即 <a rel="nofollow" class="external free" href="https://web.archive.org/web/20150423190608/http://www.freenode.net/sasl/cap_sasl.pl">https://web.archive.org/web/20150423190608/http://www.freenode.net/sasl/cap_sasl.pl</a>) 下载启用 SASL 的 <code>cap_sasl.pl</code>，保存到  <code>~/.irssi/scripts/cap_sasl.pl</code>
</p>
<p>用 <a href="../en/Pacman.html" title="Pacman">pacman</a> 安装需要的 perl 模块和 <a href="../en/Arch_User_Repository.html" class="mw-redirect" title="AUR">AUR</a> 中的 <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://aur.archlinux.org/packages/perl-crypt-dh/">perl-crypt-dh</a></span><sup><small>AUR</small></sup><sup>[<a href="../en/Help:Procedures.html#Fix_broken_package_links" title="Help:Procedures">断开的链接</a>：package not found]</sup>.
</p>
<pre>$ pacman -S perl-crypt-openssl-bignum perl-crypt-blowfish
</pre>
<p>也可以通过 perl 直接安装:
</p>
<pre>$ perl -MCPAN -e 'install Crypt::OpenSSL::Bignum Crypt::DH Crypt::Blowfish'
</pre>
<p>启动 irssi 
</p>
<pre>$ torify irssi
</pre>
<p>加载使用 SASL 机制的脚本：
</p>
<pre>/script load cap_sasl.pl
</pre>
<p>将身份设置到 nickserv，连接时会读取这个值，支持的机制是 PLAIN 和 DH-BLOWFISH。
</p>
<pre>/sasl set &lt;network&gt; &lt;username&gt; &lt;password&gt; &lt;mechanism&gt;
</pre>
<p>连接到 Freenode:
</p>
<pre>/connect -network &lt;network&gt; 10.40.40.40
</pre>
<p>如果遇到问题，请访问 Arch 论坛上的 <a rel="nofollow" class="external text" href="https://bbs.archlinux.org/viewtopic.php?pid=956467">Cannot Connect to Freenode IRC using Irssi &amp; Tor</a>。
</p>
<h3>
<span id=".E5.A4.96.E9.83.A8.E9.93.BE.E6.8E.A5"></span><span class="mw-headline" id="外部链接">外部链接</span>
</h3>
<ul>
<li><a rel="nofollow" class="external text" href="https://web.archive.org/web/20160217155848/https://freenode.net/irc_servers.shtml#tor">Accessing freenode Via Tor</a></li>
<li><a rel="nofollow" class="external text" href="https://web.archive.org/web/20120618084030/http://freenode.net/sasl/README.txt">SASL README</a></li>
<li><a rel="nofollow" class="external text" href="https://trac.torproject.org/projects/tor/wiki/doc/TorifyHOWTO/IrcSilc">IRC/SILC torproject.org 上的 Wiki</a></li>
</ul>
<h2>
<span id=".E4.BD.BF.E7.94.A8_HTTP_.E4.BB.A3.E7.90.86"></span><span class="mw-headline" id="使用_HTTP_代理">使用 HTTP 代理</span>
</h2>
<p>如果你需要一个 HTTP 代理。
</p>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>注意：</strong> 现在 Tor 开发组推荐在 Privoxy 上使用 Polipo. <sup><a rel="nofollow" class="external autonumber" href="https://trac.torproject.org/projects/tor/wiki/doc/TorFAQ#WhydoweneedPolipoorPrivoxywithTorWhichisbetter">[2]</a></sup>
</div>
<h3><span class="mw-headline" id="Polipo">Polipo</span></h3>
<p>Polipo是一个轻量和快速的HTTP代理. 根据这篇文章来安装和配置<a href="../en/Polipo.html" title="Polipo">Polipo</a>。Tor 项目创建了一个定制的<a rel="nofollow" class="external text" href="https://gitweb.torproject.org/torbrowser.git/plain/build-scripts/config/polipo.conf?id=21e3c22670f0ceb1760b3403ff1a217301112e9d">Polipo 配置文件</a> 来提供让 Polipo更好地匿名。
</p>
<p>注意polipo不要求你是否能使用SOCKS 5代理，它自动在9050端口随Tor启动。如果你想在<a href="../en/Chromium.html" title="Chromium">Chromium</a>运行Tor,你不需要polipo。查看 <a href="#Chromium_and_tor">below</a><sup>[<a href="../en/ArchWiki:Requests.html#Broken_section_links" class="mw-redirect" title="ArchWiki:Requests">断开的链接</a>：无效的部分]</sup> 如何在 <a href="../en/Chromium.html" title="Chromium">Chromium</a> 使用 tor.
</p>
<h3><span class="mw-headline" id="Privoxy">Privoxy</span></h3>
<p>Privoxy 是一个 HTTP 代理，它使用 SOCKS4a 代理进行 html/cookie 过滤。可以安装 <a href="../en/Privoxy.html" title="Privoxy">Privoxy</a> 文章安装。
</p>
<h4>
<span id=".E5.9C.A8Firefox.E4.BD.BF.E7.94.A8Tor_.E5.92.8C_Privoxy"></span><span class="mw-headline" id="在Firefox使用Tor_和_Privoxy">在Firefox使用Tor 和 Privoxy</span>
</h4>
<p>最简单的方法就是使用<a rel="nofollow" class="external text" href="https://2019.www.torproject.org/docs/torbutton/">Torbutton</a> 扩展。
</p>
<p>或者, 你可以使用<a rel="nofollow" class="external text" href="https://addons.mozilla.org/firefox/addon/foxyproxy-standard">Foxyproxy</a>。然后重启Firefox你就会发现一个新的工具条。 点<i>Add</i>, 选<i>Standard proxy type</i>. 选 你要的<i>Proxy Label</i> , 例如<i>Tor</i>。进入“HTTP Proxy”和“SSL Proxy”区域：
</p>
<pre>Hostname: 127.0.0.1 Port: 8118
</pre>
<p>然后Firefox将会用代理连接。你也可以在<i>No Proxy for</i> 添加例外。
</p>
<p>现在,返回 <a rel="nofollow" class="external free" href="http://whatsmyip.net/">http://whatsmyip.net/</a> 检查你的ip地址是否和以前不同了。
</p>
<h4>
<span id=".E5.9C.A8.E5.85.B6.E4.BB.96.E7.A8.8B.E5.BA.8F.E4.BD.BF.E7.94.A8Tor_.E5.92.8CPrivoxy"></span><span class="mw-headline" id="在其他程序使用Tor_和Privoxy">在其他程序使用Tor 和Privoxy</span>
</h4>
<p>你可以在像即时通信, Jabber, IRC,等软件使用这个方法。
</p>
<p>你可以指定代理(127.0.0.1 port 8118)在那些支持HTTP代理的软件里面。
</p>
<p>如果使用SOCKS 代理，你可以指定你的程序到Tor (127.0.0.1 port 9050)。用这种方法的一个问题是，虽然自己做DNS解析的应用程序可能会泄漏信息。
</p>
<p>你可以考虑使用Socks4A (e.g. via privoxy)来取代他。
</p>
<h2>
<span id=".E8.BF.90.E8.A1.8CTor_.E6.9C.8D.E5.8A.A1"></span><span class="mw-headline" id="运行Tor_服务">运行Tor 服务</span>
</h2>
<h3>
<span id=".E9.85.8D.E7.BD.AE_2"></span><span class="mw-headline" id="配置_2">配置</span>
</h3>
<p>你的带宽必须至少20kb/s:
</p>
<pre>Nickname &lt;tornickname&gt;
ORPort 9001
BandwidthRate 20 KB            # Throttle traffic to 20KB/s
BandwidthBurst 50 KB           # But allow bursts up to 50KB/s
</pre>
<p>允许 Irc 在 6660-6667 端口输出：
</p>
<pre>ExitPolicy accept *:6660-6667,reject *:* # Allow irc ports but no more
</pre>
<p>Tor 作为输出节点:
</p>
<pre>ExitPolicy accept *:119        # Accept nntp as well as default exit policy
</pre>
<p>Tor 作为中间人：
</p>
<pre>ExitPolicy reject *:*
</pre>
<h2>
<span id=".E8.BF.90.E8.A1.8C_Tor_.E6.A1.A5"></span><span class="mw-headline" id="运行_Tor_桥">运行 Tor 桥</span>
</h2>
<p>根据 <a rel="nofollow" class="external free" href="https://2019.www.torproject.org/docs/bridges">https://2019.www.torproject.org/docs/bridges</a> ，将 torrc 修改为：
</p>
<pre>SocksPort 0
ORPort 443
BridgeRelay 1
Exitpolicy reject *:*
</pre>
<p>如果在启动时出现如下错误：
</p>
<pre>Could not bind to 0.0.0.0:443: Permission denied errors on startup
</pre>
<p>需要选择一个更高的 ORPort (例如 8080) 或者在路由器中 <a rel="nofollow" class="external text" href="https://www.portforward.com/">转发端口</a>。
</p>
<h2><span class="mw-headline" id="TorDNS">TorDNS</span></h2>
<p>Tor 0.2.x系列提供了一个内置的DNS转发器。在Tor配置文件添加如下文件来启动它。
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/tor/torrc</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;"> DNSPort 9053
 AutomapHostsOnResolve 1
 AutomapHostsSuffixes .exit,.onion
</pre>
<p>然后重新启动 Tor 来加载更新过的配置文件：
</p>
<pre>/etc/rc.d/tor restart
</pre>
<p>这将让Tor接受DNS请求(在这个例子里面监听着9053端口)。并通过Tor网络域名。一个缺点是，它是仅能够解决一个记录的DNS查询； MX 和NS 请求没有回应。 
</p>
<p>更多信息请查看 <a rel="nofollow" class="external text" href="https://techstdout.boum.org/TorDns/">Debian-based introduction</a>。
</p>
<p>DNS查询，也可以通过命令行<code>tor-resolve</code>来查询。例如：
</p>
<pre>$ tor-resolve archlinux.org
66.211.214.131
</pre>
<h2><span class="mw-headline" id="Torify">Torify</span></h2>
<p><code>torify</code> 允许你的程序不需要更改配置来通过访问Tor网络。
</p>
<p>man page:
</p>
<pre> torify  is  a simple wrapper that calls tsocks with a tor specific configuration file.

 tsocks itself is a wrapper between the tsocks library and the  application  that
 you would like to run socksified
</pre>
<p>使用例子：
</p>
<pre>$ torify elinks checkip.dyndns.org
$ torify wget -qO- https://check.torproject.org/ | grep -i congratulations
</pre>
<p>Torify <b>不会</b>通过Tor网络来查询DNS。其中一种解决方法就是和<code>tor-resolve</code> 来解决(前文所述)。在这种情况下, 上面的例子程序将像这样
</p>
<pre>$ tor-resolve checkip.dyndns.org
208.78.69.70
$ torify elinks 208.78.69.70
</pre>
<h2>
<span id=".E9.97.AE.E9.A2.98.E8.A7.A3.E5.86.B3"></span><span class="mw-headline" id="问题解决">问题解决</span>
</h2>
<h3>
<span id="User_value.E7.9A.84.E9.97.AE.E9.A2.98"></span><span class="mw-headline" id="User_value的问题">User value的问题</span>
</h3>
<p>如果<i>tor</i> daemon启动失败，你可以在root环境下运行一下命令(或者使用sudo)
</p>
<pre># tor
</pre>
<p>如果你收到以下 error
</p>
<pre>May 23 00:27:24.624 [warn] Error setting groups to gid 43: "Operation not permitted".
May 23 00:27:24.624 [warn] If you set the "User" option, you must start Tor as root.
May 23 00:27:24.624 [warn] Failed to parse/validate config: Problem with User value. See logs for details.
May 23 00:27:24.624 [err] Reading config failed--see warnings above.
</pre>
<p>它意味着你的User value有问题。通过以下的步骤解决：
</p>
<p>运行以下命令检查<code>/var/lib/tor</code>目录的权限
</p>
<pre># ls -l /var/lib/
</pre>
<p>如果<code>/var/lib/tor</code>权限显示如下
</p>
<pre>drwx------ 2 tor    tor    4096 May 12 21:03 tor
</pre>
<p>这意味着它被<i>tor</i>用户和 <i>tor</i>组所拥有
</p>
<p>通过以下命令把拥有者和组改为<i>root</i>, <i>root</i>
</p>
<pre># chown -R root:root /var/lib/tor
</pre>
<p>如果你重新检查权限,他现在应该显示为
</p>
<pre>drwx------ 2 root   root   4096 May 12 21:03 tor
</pre>
<p>现在打开 <code>/etc/tor/torrc</code>找到以下文字
</p>
<pre>## Uncomment this to start the process in the background... or use
## --runasdaemon 1 on the command line.
RunAsDaemon 1
User tor
Group tor
</pre>
<p>注释掉<i>User tor</i> 和<i>Group tor</i>, 所以他应该显示为
</p>
<pre>## Uncomment this to start the process in the background... or use
## --runasdaemon 1 on the command line.
RunAsDaemon 1
#User tor
#Group tor
</pre>
<p>保存更改然后重启<i>tor</i> daemon, 他应该能够工作了
</p>
<pre># /etc/rc.d/tor restart
</pre>
<h2>
<span id=".E5.A4.96.E9.83.A8.E9.93.BE.E6.8E.A5_2"></span><span class="mw-headline" id="外部链接_2">外部链接</span>
</h2>
<ul>
<li><a rel="nofollow" class="external text" href="https://www.torproject.org/">Official Website</a></li>
<li><a rel="nofollow" class="external text" href="https://trac.torproject.org/projects/tor/wiki#Unixish">Unix-based Tor Articles</a></li>
<li><a rel="nofollow" class="external text" href="https://trac.torproject.org/projects/tor/wiki/doc/SupportPrograms">Software commonly integrated with Tor</a></li>
<li><a rel="nofollow" class="external text" href="https://www.torproject.org/docs/tor-hidden-service.html.en">How to set up a Tor <i>Hidden Service</i></a></li>
</ul>
</div>
</div>
<div id="catlinks" class="catlinks" data-mw="interface">
<div id="mw-normal-catlinks" class="mw-normal-catlinks">
<a href="../Special:Categories.html" title="Special:Categories">Categories</a>: <ul>
<li><a href="../zh-CN/Category:Internet_applications.html" title="Category:Internet applications (简体中文)">Internet applications (简体中文)</a></li>
<li><a href="../zh-CN/Category:Proxy_servers.html" title="Category:Proxy servers (简体中文)">Proxy servers (简体中文)</a></li>
</ul>
</div>
<div id="mw-hidden-catlinks" class="mw-hidden-catlinks mw-hidden-cats-hidden">Hidden categories: <ul>
<li><a href="../en/Category:Pages_with_broken_package_links.html" title="Category:Pages with broken package links">Pages with broken package links</a></li>
<li><a href="../en/Category:Pages_with_broken_section_links.html" title="Category:Pages with broken section links">Pages with broken section links</a></li>
</ul>
</div>
</div>
	</div>
</div>

<footer id="footer" class="mw-footer" role="contentinfo" style="margin: 0">
	<ul id="footer-info">
		<li>Retrieved from "<a dir="ltr" href="https://wiki.archlinux.org/index.php?title=Tor_(%E7%AE%80%E4%BD%93%E4%B8%AD%E6%96%87)&amp;oldid=662896">https://wiki.archlinux.org/index.php?title=Tor_(简体中文)&amp;oldid=662896</a>"</li>
		<li id="footer-info-lastmod"> This page was last edited on 19 April 2021, at 19:04.</li>
		<li id="footer-info-copyright">Content is available under <a class="external" rel="nofollow" href="http://www.gnu.org/copyleft/fdl.html">GNU Free Documentation License 1.3 or later</a> unless otherwise noted.</li>
	<br>
</ul>
	<ul id="footer-places">
		<li id="footer-places-privacy"><a href="../en/ArchWiki:Privacy_policy.html" title="ArchWiki:Privacy policy">Privacy policy</a></li>
		<li id="footer-places-about"><a href="../en/ArchWiki:About.html" title="ArchWiki:About">About ArchWiki</a></li>
		<li id="footer-places-disclaimer"><a href="../en/ArchWiki:General_disclaimer.html" title="ArchWiki:General disclaimer">Disclaimers</a></li>
	</ul>
	<ul id="footer-icons" class="noprint">
		<li id="footer-copyrightico">
	</ul>
	<div style="clear: both;"></div>
</footer>



</body>
</html>
