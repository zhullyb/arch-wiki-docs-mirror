<!DOCTYPE html>
<html class="client-nojs" lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<title>rEFInd (简体中文) - ArchWiki</title>
<link rel="stylesheet" href="../ArchWikiOffline.css">
<meta name="ResourceLoaderDynamicStyles" content="">
<meta name="generator" content="MediaWiki 1.35.0">
<meta name="robots" content="noindex,follow">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="shortcut icon" href="/favicon.ico">
<link rel="search" type="application/opensearchdescription+xml" href="/opensearch_desc.php" title="ArchWiki (en)">
<link rel="EditURI" type="application/rsd+xml" href="https://wiki.archlinux.org/api.php?action=rsd">
<link rel="license" href="http://www.gnu.org/copyleft/fdl.html">
<link rel="alternate" type="application/atom+xml" title="ArchWiki Atom feed" href="/index.php?title=Special:RecentChanges&amp;feed=atom">
</head>
<body class="mediawiki ltr sitedir-ltr mw-hide-empty-elt ns-0 ns-subject page-REFInd_简体中文 rootpage-REFInd_简体中文 skin-vector action-view skin-vector-legacy">
<div id="content" class="mw-body" role="main" style="margin: 0">
	<a id="top"></a>
	<div id="siteNotice" class="mw-body-content"></div>
	<div class="mw-indicators mw-body-content">
	</div>
	<h1 id="firstHeading" class="firstHeading" lang="en">rEFInd (简体中文)</h1>
	<div id="bodyContent" class="mw-body-content">
		<div id="siteSub" class="noprint">From ArchWiki</div>
		<div id="contentSub"></div>
		<div id="contentSub2"></div>
		
		<div id="jump-to-nav"></div>
		<a class="mw-jump-link" href="#mw-head">Jump to navigation</a>
		<a class="mw-jump-link" href="#searchInput">Jump to search</a>
		<div id="mw-content-text" lang="en" dir="ltr" class="mw-content-ltr">
<div class="warningbox">The printable version is no longer supported and may have rendering errors. Please update your browser bookmarks and please use the default browser print function instead.</div>
<div class="mw-parser-output">
<p><span></span>
</p>
<div class="archwiki-template-meta-related-articles-start">
<p>Related articles</p>
<ul>
<li><a href="../zh-CN/Arch_boot_process.html" title="Arch boot process (简体中文)">Arch boot process (简体中文)</a></li>
<li><a href="../zh-CN/Arch_boot_process.html#%E5%90%AF%E5%8A%A8%E5%8A%A0%E8%BD%BD%E5%99%A8" class="mw-redirect" title="Boot loaders (简体中文)">Boot loaders (简体中文)</a></li>
<li><a href="../zh-CN/Unified_Extensible_Firmware_Interface.html" title="Unified Extensible Firmware Interface (简体中文)">Unified Extensible Firmware Interface (简体中文)</a></li>
</ul>
</div>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>翻译状态：</strong>本文是 <a href="../en/REFInd.html" title="REFInd">rEFInd</a> 的<a href="../zh-CN/ArchWiki:Translation_Team.html" title="ArchWiki:Translation Team (简体中文)">翻译</a>。上次翻译日期：2014-06-01。如果英文版本有所<a rel="nofollow" class="external text" href="https://wiki.archlinux.org/index.php?title=REFInd&amp;diff=0&amp;oldid=315512">更改</a>，则您可以帮助同步翻译。</div>
<p><a rel="nofollow" class="external text" href="https://www.rodsbooks.com/refind/">rEFInd</a> 是一个 <a href="../zh-CN/Unified_Extensible_Firmware_Interface.html" title="Unified Extensible Firmware Interface (简体中文)">UEFI</a> 启动管理器。它是 <a rel="nofollow" class="external text" href="http://refit.sourceforge.net/">rEFIt</a> （不再维护）的一个分支并且针对非 Mac 硬件修复了若干问题。它被设计为平台无关，可启动多个操作系统。
</p>
<div id="toc" class="toc" role="navigation" aria-labelledby="mw-toc-heading">
<input type="checkbox" role="button" id="toctogglecheckbox" class="toctogglecheckbox" style="display:none"><div class="toctitle" lang="en" dir="ltr">
<h2 id="mw-toc-heading">Contents</h2>
<span class="toctogglespan"><label class="toctogglelabel" for="toctogglecheckbox"></label></span>
</div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#%E5%AE%89%E8%A3%85"><span class="tocnumber">1</span> <span class="toctext">安装</span></a></li>
<li class="toclevel-1 tocsection-2">
<a href="#%E6%89%8B%E5%8A%A8%E5%AE%89%E8%A3%85"><span class="tocnumber">2</span> <span class="toctext">手动安装</span></a>
<ul>
<li class="toclevel-2 tocsection-3"><a href="#%E8%87%AA%E5%AE%9A%E4%B9%89%E8%8F%9C%E5%8D%95%E9%A1%B9"><span class="tocnumber">2.1</span> <span class="toctext">自定义菜单项</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-4"><a href="#%E5%9C%A8%E5%B7%B2%E6%9C%89%E7%9A%84_Windows_UEFI_%E5%AE%89%E8%A3%85%E4%B8%AD%E4%BD%BF%E7%94%A8_rEFIND"><span class="tocnumber">3</span> <span class="toctext">在已有的 Windows UEFI 安装中使用 rEFIND</span></a></li>
<li class="toclevel-1 tocsection-5">
<a href="#%E6%9B%B4%E6%96%B0_rEFInd"><span class="tocnumber">4</span> <span class="toctext">更新 rEFInd</span></a>
<ul>
<li class="toclevel-2 tocsection-6"><a href="#Systemd_%E8%87%AA%E5%8A%A8%E5%8C%96"><span class="tocnumber">4.1</span> <span class="toctext">Systemd 自动化</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-7"><a href="#Apple_Macs"><span class="tocnumber">5</span> <span class="toctext">Apple Macs</span></a></li>
<li class="toclevel-1 tocsection-8"><a href="#VirtualBox"><span class="tocnumber">6</span> <span class="toctext">VirtualBox</span></a></li>
<li class="toclevel-1 tocsection-9"><a href="#%E5%8F%82%E8%A7%81"><span class="tocnumber">7</span> <span class="toctext">参见</span></a></li>
</ul>
</div>

<h2>
<span id=".E5.AE.89.E8.A3.85"></span><span class="mw-headline" id="安装">安装</span>
</h2>
<p>从<a href="../en/Official_repositories.html" title="Official repositories">官方软件源</a>安装 <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=refind">refind</a></span>。然后运行
</p>
<pre># refind-install
</pre>
<p>此操作会检测您的内核和 <a href="../zh-CN/EFI_system_partition.html" title="EFI system partition (简体中文)">EFI system partition (简体中文)</a> 分区，复制需要的文件，创建默认配置文件并将 rEFInd 设置为默认的 UEFI 启动项
</p>
<div class="archwiki-template-box archwiki-template-box-warning">
<strong>警告：</strong> 当 <code>refind-install</code> 运行在chroot环境下 (例如：安装Arch Linux时的live环境) <code>/boot/refind_linux.conf</code> 内将会添加live系统的内核选项，而不是安装它的系统。 
<p>编辑 <code>/boot/refind_linux.conf</code> 并确保其中的 <a href="../zh-CN/Kernel_parameters.html" title="Kernel parameters (简体中文)">kernel parameters (简体中文)</a> 对于你的系统是正确的，否则下次启动可能会出现内核错误。
</p>
查看示例：<a href="../en/REFInd.html#refind_linux.conf" title="REFInd">rEFInd#refind_linux.conf</a>。</div>
<h2>
<span id=".E6.89.8B.E5.8A.A8.E5.AE.89.E8.A3.85"></span><span class="mw-headline" id="手动安装">手动安装</span>
</h2>
<div class="archwiki-template-box archwiki-template-box-tip">
<strong>Tip:</strong>  rEFInd 能够以多种方式启动 Linux。参见 <a rel="nofollow" class="external text" href="http://www.rodsbooks.com/refind/linux.html">The rEFInd Boot Manager: Methods of Booting Linux</a>。本节将阐述使用 <a href="../en/EFISTUB.html" title="EFISTUB">EFISTUB</a> 的过程。</div>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Note:</strong> 对于 32 位 EFI，请将 <b>x64</b> 替换为 <b>ia32</b>。</div>
<p>如果 <code>refind-install</code> 脚本没有正常工作，您可以手动设置 rEFInd。
</p>
<ol>
<li>在 ESP 中创建一个目录来存放 rEFInd 的文件。此处假定您的 ESP 分区被挂载到 <code>/boot/efi</code> 并且您希望将 rEFInd 存放在 <code>/boot/efi/EFI/refind</code>。</li>
<li>将可执行文件、配置文件和资源文件复制到 ESP<pre># cp /usr/share/refind/refind_x64.efi /boot/efi/EFI/refind/refind_x64.efi
# cp /usr/share/refind/refind.conf-sample /boot/efi/EFI/refind/refind.conf
# cp -r /usr/share/refind/{icons,fonts,drivers_x64} /boot/efi/EFI/refind/
</pre>
</li>
<li>编辑刚才复制的配置文件。该文件有详细的注释。默认情况下，rEFInd 会在您的驱动器中寻找 EFISTUB 内核，所以您可能不需要做任何更改就能启动。</li>
<li>如果需要定制内核引导选项，复制示例配置文件到你的内核的目录。编辑该文件并为您的根分区输入正确的 <code>PARTUUID</code> 和 <code>rootfstype</code> （可以使用 <code>blkid</code> 和 <code>lsblk -f</code>）. <pre># cp /usr/share/refind/refind_linux.conf-sample /boot/refind_linux.conf
</pre> <div class="archwiki-template-box archwiki-template-box-tip">
<strong>Tip:</strong> <code>refind_linux.conf</code> 的每一行都会被显示为一个子菜单项。按下 + 、 Insert 或 F2 来展开子菜单.</div>
</li>
<li>使用 <code>efibootmgr</code> 创建一条 UEFI 启动项（更改 X 、Y 使其指向您的 ESP 分区）。 参见 <code>efibootmgr</code> 的 man 手册. <pre># efibootmgr -c -d /dev/sdX -p Y -l /EFI/refind/refind_x64.efi -L "rEFInd"
</pre>
</li>
</ol>
<div class="archwiki-template-box archwiki-template-box-tip">
<strong>Tip:</strong> 在 rEFInd 中按下 F10 将会保存屏幕截图到 ESP 分区的根目录</div>
<h3>
<span id=".E8.87.AA.E5.AE.9A.E4.B9.89.E8.8F.9C.E5.8D.95.E9.A1.B9"></span><span class="mw-headline" id="自定义菜单项">自定义菜单项</span>
</h3>
<p>您可以使用 <code>refind.conf</code> 中的小节手动创建启动条目。 确保 <code>scanfor</code> 包括 <code>manual</code> 否则条目将不会出现。
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">refind.conf</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">menuentry "Arch Linux" {
        icon     /EFI/refind/icons/os_arch.icns
        volume   1:
        loader   /boot/vmlinuz-linux
        initrd   /boot/initramfs-linux.img
        options  "root=PARTUUID=3518bb68-d01e-45c9-b973-0b5d918aae96 rw rootfstype=ext4"
}
</pre>
<h2>
<span id=".E5.9C.A8.E5.B7.B2.E6.9C.89.E7.9A.84_Windows_UEFI_.E5.AE.89.E8.A3.85.E4.B8.AD.E4.BD.BF.E7.94.A8_rEFIND"></span><span class="mw-headline" id="在已有的_Windows_UEFI_安装中使用_rEFIND">在已有的 Windows UEFI 安装中使用 rEFIND</span>
</h2>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Note:</strong> 在页面 <a href="../zh-CN/Dual_boot_with_Windows.html" class="mw-redirect" title="Windows and Arch Dual Boot (简体中文)">Windows and Arch Dual Boot (简体中文)</a> 中查看通常的注意事项。</div>
<p>rEFInd 兼容 UEFI Windows 安装时创建的 EFI 系统分区，因此没有必要创建或格式化另一个 FAT32 分区。只需挂载 Windows 的 ESP 并像往常一样安装 rEFInd。默认情况下，rEFInd 的自动检测功能应该识别任何现有的 Windows 引导程序。
</p>
<h2>
<span id=".E6.9B.B4.E6.96.B0_rEFInd"></span><span class="mw-headline" id="更新_rEFInd">更新 rEFInd</span>
</h2>
<p>Pacman 只更新在 <code>/usr/share/refind</code> 中的文件，不会将新文件复制到 ESP。
如果 <code>refind-install</code> 成功安装了 rEFInd，则可以再次运行以更新文件。 新的配置文件会被复制为 <code>refind.conf-sample</code> ——就像 <code>.pacdiff</code> —— 你可以选择改变合并到你的配置文件。
否则，您可以重复上文的步骤，复制新的文件。
</p>
<h3>
<span id="Systemd_.E8.87.AA.E5.8A.A8.E5.8C.96"></span><span class="mw-headline" id="Systemd_自动化">Systemd 自动化</span>
</h3>
<p>如果需要自动复制 rEFInd 文件和更新 NVRAM（如果需要），可以使用下面的脚本。
</p>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Note:</strong> 如果您想更改 rEFInd 的安装目录，在脚本中修改 $refind_dir。</div>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/usr/lib/systemd/scripts/refind_name_patchv2</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">#!/usr/bin/env bash
## COPYRIGHT 2013 : MARK E. LEE (BLUERIDER) : mlee24@binghamton.edu; mark@markelee.com

## LOG
## 1/17/2013 : Version 2 of refind_name_patch is released
##           : Supports long subdirectory location for refind
##           : Updates nvram when needed
##           : 10% speed boost
## 7/15/2013 : Changed arch to match 32-bit (ia32) and 64-bit (x64) naming scheme
##           : Changed directory copying in update-efi-dir to copy tools and drivers directories explicitly
##           : Changed efibootmgr writing code to be more concise and added (-w) to write the entry as per dusktreader's excellent guide : https://docs.google.com/document/d/1pvgm3BprpXoadsQi38FxqMOCUZhcSqFhZ26FZBkmn9I/edit
##           : Function to check if NVRAM boot entry was already listed was fixed to use awk and an if then clause
##           : ref_bin_escape was modified from : ref_bin_escape=${ref_bin//\//\\\\} to remove extra backslashes (error does not show up when using cmdline)
## 7/29/2013 : Changed location of tools,drivers, and binary directory to match capricious upstream move to /usr/share/refind

function main () {  ## main insertion function
  declare -r refind_dir="/boot/efi/EFI/refind"; ## set the refind directory
  arch=$(uname -m | awk -F'_' '{if ($1 == "x86") {print "x"$2} else if ($1 == "i686") {print "ia32"}}') &amp;&amp;  ## get bit architecture
  update-efi-dir;  ## updates or creates the refind directory
  update-efi-nvram;  ## updates nvram if needed
}

function update-efi-dir () {  ## setup the refind directory
  if [ ! -d $refind_dir ]; then  ## check if refind directory exists
    echo "Couldn't find $refind_dir";
    mkdir $refind_dir &amp;&amp;  ## make the refind directory if needed
    echo "Made $refind_dir";
  fi;
  if [ "$arch" ]; then  ## check if anything was stored in $arch
    cp -r /usr/share/refind/{refind_$arch.efi,keys,images,icons,fonts,docs,{tools,drivers}_$arch} $refind_dir/  &amp;&amp; ## update the bins and dirs
    echo "Updated binaries and directory files for refind at $refind_dir";
   else
    echo "Failed to detect an x86 architecture";
    exit;
  fi;
}

function update-efi-nvram () { ## update the nvram with efibootmgr
  declare -r ref_bin=${refind_dir/\/boot\/efi}/refind_$arch.efi;  ## get path of refind binary (without /boot/efi)
  declare -r ref_bin_escape=${ref_bin//\//\\};  ## insert escape characters into $ref_bin
  [ "$(efibootmgr -v | awk "/${ref_bin_escape//\\/\\\\}/")" ] &amp;&amp; ( ## check if boot entry is in nvram \
    echo "Found boot entry, no need to update nvram";
    ) || ( ## if boot entry is not in nvram; add it
    declare -r esp=$(mount -l | awk '/ESP/ {print $1}') &amp;&amp;  ## get ESP partition
    efibootmgr -cgw -d ${esp:0:8} -p ${esp:8} -L "rEFInd" -l $ref_bin_escape &amp;&amp; ## update nvram
    echo "
    Updated nvram with entry rEFInd to boot $ref_bin
    Did not copy configuration files, please move refind.conf to $refind_dir/";
    )
}
main;  ## run the main insertion function
</pre>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/usr/lib/systemd/system/refind_update.path</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">[Unit]
Description=Update rEFInd bootloader files

[Path]
PathChanged=/usr/share/refind/refind_&lt;arch&gt;.efi
Unit=refind_update.service

[Install]
WantedBy=multi-user.target
</pre>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/usr/lib/systemd/system/refind_update.service</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">[Unit]
Description=Update rEFInd directories, binaries, and nvram

[Service]
Type=oneshot
ExecStart=/usr/bin/bash /usr/lib/systemd/scripts/refind_name_patchv2
RemainAfterExit=no
</pre>
<p>运行以下命令以激活这个 systemd path 单元：
</p>
<pre># systemctl enable refind_update.path
</pre>
<h2><span class="mw-headline" id="Apple_Macs">Apple Macs</span></h2>
<p><a href="../zh-CN/Arch_User_Repository.html" title="Arch User Repository (简体中文)">AUR</a> 上的 <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://aur.archlinux.org/packages/mactel-boot/">mactel-boot</a></span><sup><small>AUR</small></sup> 是 "bless" 工具的实验性替代品。如果它不能正常工作，
在 OS X 中使用 "bless" 来将 rEFInd 设置为默认启动项。假设您的 UEFISYS 分区挂载到 <code>/mnt/efi</code>。
</p>
<pre>$ sudo bless --setBoot --folder /mnt/efi/EFI/refind --file /mnt/efi/EFI/refind/refind_x64.efi
</pre>
<h2><span class="mw-headline" id="VirtualBox">VirtualBox</span></h2>
<p>参见 <a href="../en/VirtualBox.html#Using_Arch_under_Virtualbox_EFI_mode" title="VirtualBox">VirtualBox#Using Arch under Virtualbox EFI mode</a><sup>[<a href="../en/ArchWiki:Requests.html#Broken_section_links" class="mw-redirect" title="ArchWiki:Requests">断开的链接</a>：无效的部分]</sup>.
</p>
<h2>
<span id=".E5.8F.82.E8.A7.81"></span><span class="mw-headline" id="参见">参见</span>
</h2>
<ul><li>
<a rel="nofollow" class="external text" href="http://www.rodsbooks.com/refind/">The rEFInd Boot Manager</a> by Roderick W. Smith.</li></ul>
</div>
</div>
<div id="catlinks" class="catlinks" data-mw="interface">
<div id="mw-normal-catlinks" class="mw-normal-catlinks">
<a href="../Special:Categories.html" title="Special:Categories">Category</a>: <ul><li><a href="../zh-CN/Category:Boot_loaders.html" title="Category:Boot loaders (简体中文)">Boot loaders (简体中文)</a></li></ul>
</div>
<div id="mw-hidden-catlinks" class="mw-hidden-catlinks mw-hidden-cats-hidden">Hidden category: <ul><li><a href="../en/Category:Pages_with_broken_section_links.html" title="Category:Pages with broken section links">Pages with broken section links</a></li></ul>
</div>
</div>
	</div>
</div>

<footer id="footer" class="mw-footer" role="contentinfo" style="margin: 0">
	<ul id="footer-info">
		<li>Retrieved from "<a dir="ltr" href="https://wiki.archlinux.org/index.php?title=REFInd_(%E7%AE%80%E4%BD%93%E4%B8%AD%E6%96%87)&amp;oldid=640564">https://wiki.archlinux.org/index.php?title=REFInd_(简体中文)&amp;oldid=640564</a>"</li>
		<li id="footer-info-lastmod"> This page was last edited on 4 November 2020, at 08:18.</li>
		<li id="footer-info-copyright">Content is available under <a class="external" rel="nofollow" href="http://www.gnu.org/copyleft/fdl.html">GNU Free Documentation License 1.3 or later</a> unless otherwise noted.</li>
	<br>
</ul>
	<ul id="footer-places">
		<li id="footer-places-privacy"><a href="../en/ArchWiki:Privacy_policy.html" title="ArchWiki:Privacy policy">Privacy policy</a></li>
		<li id="footer-places-about"><a href="../en/ArchWiki:About.html" title="ArchWiki:About">About ArchWiki</a></li>
		<li id="footer-places-disclaimer"><a href="../en/ArchWiki:General_disclaimer.html" title="ArchWiki:General disclaimer">Disclaimers</a></li>
	</ul>
	<ul id="footer-icons" class="noprint">
		<li id="footer-copyrightico">
	</ul>
	<div style="clear: both;"></div>
</footer>



</body>
</html>
