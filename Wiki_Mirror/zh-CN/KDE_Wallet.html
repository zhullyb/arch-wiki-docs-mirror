<!DOCTYPE html>
<html class="client-nojs" lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<title>KDE Wallet (简体中文) - ArchWiki</title>
<link rel="stylesheet" href="../ArchWikiOffline.css">
<meta name="ResourceLoaderDynamicStyles" content="">
<meta name="generator" content="MediaWiki 1.35.0">
<meta name="referrer" content="no-referrer-when-downgrade">
<meta name="robots" content="noindex,follow">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="shortcut icon" href="/favicon.ico">
<link rel="search" type="application/opensearchdescription+xml" href="/opensearch_desc.php" title="ArchWiki (en)">
<link rel="EditURI" type="application/rsd+xml" href="https://wiki.archlinux.org/api.php?action=rsd">
<link rel="license" href="http://www.gnu.org/copyleft/fdl.html">
<link rel="alternate" type="application/atom+xml" title="ArchWiki Atom feed" href="/index.php?title=Special:RecentChanges&amp;feed=atom">
</head>
<body class="mediawiki ltr sitedir-ltr mw-hide-empty-elt ns-0 ns-subject page-KDE_Wallet_简体中文 rootpage-KDE_Wallet_简体中文 skin-vector action-view skin-vector-legacy">
<div id="content" class="mw-body" role="main" style="margin: 0">
	<a id="top"></a>
	<div id="siteNotice" class="mw-body-content"></div>
	<div class="mw-indicators mw-body-content">
	</div>
	<h1 id="firstHeading" class="firstHeading" lang="en">KDE Wallet (简体中文)</h1>
	<div id="bodyContent" class="mw-body-content">
		<div id="siteSub" class="noprint">From ArchWiki</div>
		<div id="contentSub"></div>
		<div id="contentSub2"></div>
		
		<div id="jump-to-nav"></div>
		<a class="mw-jump-link" href="#mw-head">Jump to navigation</a>
		<a class="mw-jump-link" href="#searchInput">Jump to search</a>
		<div id="mw-content-text" lang="en" dir="ltr" class="mw-content-ltr">
<div class="warningbox">The printable version is no longer supported and may have rendering errors. Please update your browser bookmarks and please use the default browser print function instead.</div>
<div class="mw-parser-output">
<div class="archwiki-template-box archwiki-template-box-note">
<strong>翻译状态：</strong>本文是 <a href="../en/KDE_Wallet.html" title="KDE Wallet">KDE Wallet</a> 的<a href="../zh-CN/ArchWiki:Translation_Team.html" title="ArchWiki:Translation Team (简体中文)">翻译</a>。上次翻译日期：2019-4-11。如果英文版本有所<a rel="nofollow" class="external text" href="https://wiki.archlinux.org/index.php?title=KDE_Wallet&amp;diff=0&amp;oldid=568128">更改</a>，则您可以帮助同步翻译。</div>
<p><a rel="nofollow" class="external text" href="https://utils.kde.org/projects/kwalletmanager/">KDE Wallet Manager</a> 是一个用于管理 <a href="../en/KDE.html" title="KDE">KDE</a> Plasma 上的密码的工具。KWallet子系统提供了访问和管理兼容KWallet的应用所保存的密码的功能，同时你也可以用它来保存你自己的密码。
</p>
<div id="toc" class="toc" role="navigation" aria-labelledby="mw-toc-heading">
<input type="checkbox" role="button" id="toctogglecheckbox" class="toctogglecheckbox" style="display:none"><div class="toctitle" lang="en" dir="ltr">
<h2 id="mw-toc-heading">Contents</h2>
<span class="toctogglespan"><label class="toctogglelabel" for="toctogglecheckbox"></label></span>
</div>
<ul>
<li class="toclevel-1 tocsection-1">
<a href="#%E5%9C%A8%E7%99%BB%E5%BD%95%E6%97%B6%E8%87%AA%E5%8A%A8%E8%A7%A3%E9%94%81_Kwallet"><span class="tocnumber">1</span> <span class="toctext">在登录时自动解锁 Kwallet</span></a>
<ul>
<li class="toclevel-2 tocsection-2"><a href="#%E9%85%8D%E7%BD%AE_display_manager"><span class="tocnumber">1.1</span> <span class="toctext">配置 display manager</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-3"><a href="#%E4%BD%BF%E7%94%A8_KDE_Wallet_%E5%AD%98%E5%82%A8_ssh_key_passphrases"><span class="tocnumber">2</span> <span class="toctext">使用 KDE Wallet 存储 ssh key passphrases</span></a></li>
<li class="toclevel-1 tocsection-4"><a href="#Firefox_%E4%B8%8A%E7%9A%84_KDE_Wallet_%E6%94%AF%E6%8C%81"><span class="tocnumber">3</span> <span class="toctext">Firefox 上的 KDE Wallet 支持</span></a></li>
<li class="toclevel-1 tocsection-5"><a href="#Chrome_%E5%92%8C_Chromium_%E7%9A%84_KDE_Wallet_%E6%94%AF%E6%8C%81"><span class="tocnumber">4</span> <span class="toctext">Chrome 和 Chromium 的 KDE Wallet 支持</span></a></li>
<li class="toclevel-1 tocsection-6"><a href="#See_also"><span class="tocnumber">5</span> <span class="toctext">See also</span></a></li>
</ul>
</div>

<h2>
<span id=".E5.9C.A8.E7.99.BB.E5.BD.95.E6.97.B6.E8.87.AA.E5.8A.A8.E8.A7.A3.E9.94.81_Kwallet"></span><span class="mw-headline" id="在登录时自动解锁_Kwallet">在登录时自动解锁 Kwallet</span>
</h2>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Note:</strong> 
<ul>
<li>
<span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=kwallet-pam">kwallet-pam</a></span> 与 <a href="../en/GnuPG.html" title="GnuPG">GnuPG</a> keys 不兼容，所以 KDE Wallet 必须使用 <code>blowfish</code> 加密方式。</li>
<li>所选择的 KWallet 密码必须与当前 <a href="../en/Users_and_groups.html" class="mw-redirect" title="User">用户</a> 的密码相同。</li>
<li>KWallet 在账户使用自动登录的时候不会自动解锁。</li>
<li>要自动解锁的 wallet 必须要命名为 <code>kdewallet</code> (这是默认的名字)。任何其他名字的 wallet 都不会自动解锁。</li>
<li>如果桌面环境用的是 <a href="../en/KDE.html" title="KDE">KDE</a>, 建议关闭 KDE Wallet settings 里的 <i>Close when last application stops using it</i> 选项来防止 wallet 在每次被使用（比如获取<a href="../en/Network_configuration/Wireless.html" class="mw-redirect" title="WiFi">WiFi</a>密码）之后被关闭。</li>
<li>可能需要先把默认创建的 wallet 删除——即删除所有已经储存的密码条目。</li>
<li>如果 kwallet Migration Assistant在每次登录之后都要求输入密码，请重命名或删除 <code>~/.kde4/share/apps/kwallet</code> 文件夹.</li>
</ul>
</div>
<p><a href="../zh-CN/Help:Reading.html#%E5%AE%89%E8%A3%85%E8%BD%AF%E4%BB%B6%E5%8C%85" class="mw-redirect" title="安装">安装</a> <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=kwallet-pam">kwallet-pam</a></span> 包来提供对 <a href="../en/PAM.html" title="PAM">PAM</a> 的兼容模块。
</p>
<p>选择性 <a href="../zh-CN/Help:Reading.html#%E5%AE%89%E8%A3%85%E8%BD%AF%E4%BB%B6%E5%8C%85" class="mw-redirect" title="安装">安装</a> <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=kwalletmanager">kwalletmanager</a></span> 来使用 KWallet 管理工具。这个工具可以用于建立一个 <code>blowfish</code> 加密的KDE Wallet，同时提供了 <i>kcm-module</i> 没有提供的其他设置。
</p>
<div class="archwiki-template-box archwiki-template-box-tip">
<strong>Tip:</strong> 替代选项是使用 KWalletManager 然后设置一个空的 Kwallet 密码, 这样就可以避免需要输入密码来解锁 wallet。只要在 <i>Change Password..</i> 的时候把两个框都留空就可以了。但是这样的话无法阻止对 wallet 的未授权访问。 因此非常建议打开 <i>Access Control</i> 里的 <i>Prompt when an application accesses a wallet</i> 选项来避免未授权访问。</div>
<h3>
<span id=".E9.85.8D.E7.BD.AE_display_manager"></span><span class="mw-headline" id="配置_display_manager">配置 display manager</span>
</h3>
<p>下面的几行必须存在于你使用的 Display Manager 的配置文件里：
</p>
<pre>auth            optional        pam_kwallet5.so
session         optional        pam_kwallet5.so auto_start</pre>
<p>常见的 <a href="../en/Display_manager.html" title="Display manager">display manager</a> 所需要修改的文件如下：
</p>
<ul>
<li>
<a href="../en/SDDM.html" title="SDDM">SDDM</a>：不需要进行修改，因为 <code>/etc/pam.d/sddm</code> 里已经写好了。</li>
<li>
<a href="../en/GDM.html" title="GDM">GDM</a>： 修改 <code>/etc/pam.d/gdm-password</code>。</li>
<li>
<a href="../en/LightDM.html" title="LightDM">LightDM</a>： 修改 <code>/etc/pam.d/lightdm</code> 和 <code>/etc/pam.d/lightdm-greeter</code>：</li>
</ul>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Note:</strong> 旧版本的 KDE 钱包与 LightDM 的整合存在漏洞，你需要安装更新版本（5.21.1-1以上）的<span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=kwallet-pam">kwallet-pam</a></span>。</div>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/pam.d/lightdm</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">#%PAM-1.0
auth            include         system-login
<b>auth            optional        pam_kwallet5.so</b>

account         include         system-login

password        include         system-login

session         include         system-login
<b>session         optional        pam_kwallet5.so auto_start</b></pre>
<h2>
<span id=".E4.BD.BF.E7.94.A8_KDE_Wallet_.E5.AD.98.E5.82.A8_ssh_key_passphrases"></span><span class="mw-headline" id="使用_KDE_Wallet_存储_ssh_key_passphrases">使用 KDE Wallet 存储 ssh key passphrases</span>
</h2>
<p><a href="../zh-CN/Help:Reading.html#%E5%AE%89%E8%A3%85%E8%BD%AF%E4%BB%B6%E5%8C%85" class="mw-redirect" title="安装">安装</a> <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=ksshaskpass">ksshaskpass</a></span>。
</p>
<p><a href="../en/Help:Reading.html#Append,_add,_create,_edit" class="mw-redirect" title="Create">创建</a> 一个 <a href="../en/KDE.html#Autostart" title="KDE">autostart script file</a> 并把它标记为 <a href="../en/Help:Reading.html#Make_executable" class="mw-redirect" title="Executable">executable</a>:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">~/.config/autostart-scripts/ssh-add.sh</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">#!/bin/sh
ssh-add &lt;/dev/null
</pre>
<div class="archwiki-template-box archwiki-template-box-tip">
<strong>Tip:</strong> 上面这个 ssh-add.sh 脚本只会添加默认的 <code>~/.ssh/id_rsa</code> key。如果你在 <code>~/.ssh/</code> 下有多个SSH key，假设分别是 <code>key1</code>, <code>key2</code>, <code>key3</code>，你需要像下面这样修改脚本来自动添加它们：
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">~/.config/autostart-scripts/ssh-add.sh</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">#!/bin/sh
ssh-add $HOME/.ssh/key1 $HOME/.ssh/key2 $HOME/.ssh/key3 &lt;/dev/null
</pre>
</div>
<p>你需要设置<a href="../en/Environment_variables.html" class="mw-redirect" title="Environment variable">环境变量</a> <code>SSH_ASKPASS</code> 为 <code>ksshaskpass</code>：
</p>
<pre>export SSH_ASKPASS="/usr/bin/ksshaskpass"
</pre>
<p>它会要你输入密码来解锁 SSH keys。在重启之后，输入kwallet密码之后 SSH keys 就会被解锁。
</p>
<p>如果要添加一个新的 key 并把密码储存在 kwallet里，使用这个命令：
</p>
<pre>$ ssh-add <i>/path/to/new/key</i> &lt;/dev/null
</pre>
<p>并把这个 key 按照上面所说的方法添加到 <code>~/.config/autostart-scripts/ssh-add.sh</code> 的 keys 列表里。
</p>
<h2>
<span id="Firefox_.E4.B8.8A.E7.9A.84_KDE_Wallet_.E6.94.AF.E6.8C.81"></span><span class="mw-headline" id="Firefox_上的_KDE_Wallet_支持">Firefox 上的 KDE Wallet 支持</span>
</h2>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Note:</strong> Firefox 57 及更新版本上这个 addon 已经失效了。如果你还想用它，请使用 <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://aur.archlinux.org/packages/firefox-esr52/">firefox-esr52</a></span><sup><small>AUR</small></sup> (生命周期支持到 2018 八月)。</div>
<p>一个非官方的<a href="../en/Firefox.html" title="Firefox">Firefox</a> addon <a rel="nofollow" class="external text" href="https://addons.mozilla.org/addon/kde5-wallet-password-integrati/">KDE5 Wallet</a><sup title="最后检查状态：404">[<a href="https://en.wikipedia.org/wiki/Wikipedia:Link_rot" class="extiw" title="wikipedia:Wikipedia:Link rot">失效链接</a> 2020-08-02 ⓘ]</sup> 提供集成支持。
</p>
<h2>
<span id="Chrome_.E5.92.8C_Chromium_.E7.9A.84_KDE_Wallet_.E6.94.AF.E6.8C.81"></span><span class="mw-headline" id="Chrome_和_Chromium_的_KDE_Wallet_支持">Chrome 和 Chromium 的 KDE Wallet 支持</span>
</h2>
<p>Chrome/Chromium 内置了 wallet 支持。在运行 Chromium 的时候加上 <code>--password-store=kwallet</code> 或者 <code>--password-store=detect</code> 参数来启用它。如果需要永久启用这个参数，参考 <a href="../en/Chromium.html#Making_flags_persistent" class="mw-redirect" title="Chromium/Tips and tricks">Chromium/Tips and tricks#Making flags persistent</a>。(设置 CHROMIUM_USER_FLAGS 是无效的。)
</p>
<h2><span class="mw-headline" id="See_also">See also</span></h2>
<ul><li><a rel="nofollow" class="external text" href="https://www.dennogumi.org/2014/04/unlocking-kwallet-with-pam/">Unlocking KWallet with PAM</a></li></ul>
</div>
</div>
<div id="catlinks" class="catlinks" data-mw="interface">
<div id="mw-normal-catlinks" class="mw-normal-catlinks">
<a href="../Special:Categories.html" title="Special:Categories">Category</a>: <ul><li><a href="../zh-CN/Category:KDE.html" title="Category:KDE (简体中文)">KDE (简体中文)</a></li></ul>
</div>
<div id="mw-hidden-catlinks" class="mw-hidden-catlinks mw-hidden-cats-hidden">Hidden category: <ul><li><a href="../en/Category:Pages_with_dead_links.html" title="Category:Pages with dead links">Pages with dead links</a></li></ul>
</div>
</div>
	</div>
</div>

<footer id="footer" class="mw-footer" role="contentinfo" style="margin: 0">
	<ul id="footer-info">
		<li>Retrieved from "<a dir="ltr" href="https://wiki.archlinux.org/index.php?title=KDE_Wallet_(%E7%AE%80%E4%BD%93%E4%B8%AD%E6%96%87)&amp;oldid=653667">https://wiki.archlinux.org/index.php?title=KDE_Wallet_(简体中文)&amp;oldid=653667</a>"</li>
		<li id="footer-info-lastmod"> This page was last edited on 28 February 2021, at 02:28.</li>
		<li id="footer-info-copyright">Content is available under <a class="external" rel="nofollow" href="http://www.gnu.org/copyleft/fdl.html">GNU Free Documentation License 1.3 or later</a> unless otherwise noted.</li>
	<br>
</ul>
	<ul id="footer-places">
		<li id="footer-places-privacy"><a href="../en/ArchWiki:Privacy_policy.html" title="ArchWiki:Privacy policy">Privacy policy</a></li>
		<li id="footer-places-about"><a href="../en/ArchWiki:About.html" title="ArchWiki:About">About ArchWiki</a></li>
		<li id="footer-places-disclaimer"><a href="../en/ArchWiki:General_disclaimer.html" title="ArchWiki:General disclaimer">Disclaimers</a></li>
	</ul>
	<ul id="footer-icons" class="noprint">
		<li id="footer-copyrightico">
	</ul>
	<div style="clear: both;"></div>
</footer>



</body>
</html>
