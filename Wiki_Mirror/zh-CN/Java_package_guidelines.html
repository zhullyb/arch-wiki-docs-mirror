<!DOCTYPE html>
<html class="client-nojs" lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<title>Java package guidelines (简体中文) - ArchWiki</title>
<link rel="stylesheet" href="../ArchWikiOffline.css">
<meta name="ResourceLoaderDynamicStyles" content="">
<meta name="generator" content="MediaWiki 1.35.0">
<meta name="robots" content="noindex,follow">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="shortcut icon" href="/favicon.ico">
<link rel="search" type="application/opensearchdescription+xml" href="/opensearch_desc.php" title="ArchWiki (en)">
<link rel="EditURI" type="application/rsd+xml" href="https://wiki.archlinux.org/api.php?action=rsd">
<link rel="license" href="http://www.gnu.org/copyleft/fdl.html">
<link rel="alternate" type="application/atom+xml" title="ArchWiki Atom feed" href="/index.php?title=Special:RecentChanges&amp;feed=atom">
</head>
<body class="mediawiki ltr sitedir-ltr mw-hide-empty-elt ns-0 ns-subject page-Java_package_guidelines_简体中文 rootpage-Java_package_guidelines_简体中文 skin-vector action-view skin-vector-legacy">
<div id="content" class="mw-body" role="main" style="margin: 0">
	<a id="top"></a>
	<div id="siteNotice" class="mw-body-content"></div>
	<div class="mw-indicators mw-body-content">
	</div>
	<h1 id="firstHeading" class="firstHeading" lang="en">Java package guidelines (简体中文)</h1>
	<div id="bodyContent" class="mw-body-content">
		<div id="siteSub" class="noprint">From ArchWiki</div>
		<div id="contentSub"></div>
		<div id="contentSub2"></div>
		
		<div id="jump-to-nav"></div>
		<a class="mw-jump-link" href="#mw-head">Jump to navigation</a>
		<a class="mw-jump-link" href="#searchInput">Jump to search</a>
		<div id="mw-content-text" lang="en" dir="ltr" class="mw-content-ltr">
<div class="warningbox">The printable version is no longer supported and may have rendering errors. Please update your browser bookmarks and please use the default browser print function instead.</div>
<div class="mw-parser-output">
<div class="toc" style="display:block; text-align: center; margin-bottom: 1em;">
<b><a href="../en/Arch_package_guidelines.html" title="Arch package guidelines">Arch 软件包准则</a></b>
<hr>
<p><a href="../zh-CN/32-bit_package_guidelines.html" title="32-bit package guidelines (简体中文)">32-bit</a> – <a href="../zh-CN/CLR_package_guidelines.html" title="CLR package guidelines (简体中文)">CLR</a> – <a href="../zh-CN/CMake_package_guidelines.html" title="CMake package guidelines (简体中文)">CMake</a> – <a href="/index.php?title=Cross-compiling_tools_package_guidelines_(%E7%AE%80%E4%BD%93%E4%B8%AD%E6%96%87)&amp;action=edit&amp;redlink=1" class="new" title="Cross-compiling tools package guidelines (简体中文) (page does not exist)">Cross</a> – <a href="/index.php?title=DKMS_package_guidelines_(%E7%AE%80%E4%BD%93%E4%B8%AD%E6%96%87)&amp;action=edit&amp;redlink=1" class="new" title="DKMS package guidelines (简体中文) (page does not exist)">DKMS</a> – <a href="../zh-CN/Eclipse_plugin_package_guidelines.html" title="Eclipse plugin package guidelines (简体中文)">Eclipse</a> – <a href="/index.php?title=Electron_package_guidelines_(%E7%AE%80%E4%BD%93%E4%B8%AD%E6%96%87)&amp;action=edit&amp;redlink=1" class="new" title="Electron package guidelines (简体中文) (page does not exist)">Electron</a> – <a href="/index.php?title=Font_packaging_guidelines_(%E7%AE%80%E4%BD%93%E4%B8%AD%E6%96%87)&amp;action=edit&amp;redlink=1" class="new" title="Font packaging guidelines (简体中文) (page does not exist)">Font</a> – <a href="../zh-CN/Free_Pascal_package_guidelines.html" title="Free Pascal package guidelines (简体中文)">Free Pascal</a> – <a href="/index.php?title=GNOME_package_guidelines_(%E7%AE%80%E4%BD%93%E4%B8%AD%E6%96%87)&amp;action=edit&amp;redlink=1" class="new" title="GNOME package guidelines (简体中文) (page does not exist)">GNOME</a> – <a href="../zh-CN/Go_package_guidelines.html" title="Go package guidelines (简体中文)">Go</a> – <a href="../zh-CN/Haskell_package_guidelines.html" title="Haskell package guidelines (简体中文)">Haskell</a> – <a class="mw-selflink selflink">Java</a> – <a href="/index.php?title=KDE_package_guidelines_(%E7%AE%80%E4%BD%93%E4%B8%AD%E6%96%87)&amp;action=edit&amp;redlink=1" class="new" title="KDE package guidelines (简体中文) (page does not exist)">KDE</a> – <a href="../zh-CN/Kernel_module_package_guidelines.html" title="Kernel module package guidelines (简体中文)">Kernel</a> – <a href="/index.php?title=Lisp_package_guidelines_(%E7%AE%80%E4%BD%93%E4%B8%AD%E6%96%87)&amp;action=edit&amp;redlink=1" class="new" title="Lisp package guidelines (简体中文) (page does not exist)">Lisp</a> – <a href="/index.php?title=Meson_package_guidelines_(%E7%AE%80%E4%BD%93%E4%B8%AD%E6%96%87)&amp;action=edit&amp;redlink=1" class="new" title="Meson package guidelines (简体中文) (page does not exist)">Meson</a> – <a href="/index.php?title=MinGW_package_guidelines_(%E7%AE%80%E4%BD%93%E4%B8%AD%E6%96%87)&amp;action=edit&amp;redlink=1" class="new" title="MinGW package guidelines (简体中文) (page does not exist)">MinGW</a> – <a href="/index.php?title=Node.js_package_guidelines_(%E7%AE%80%E4%BD%93%E4%B8%AD%E6%96%87)&amp;action=edit&amp;redlink=1" class="new" title="Node.js package guidelines (简体中文) (page does not exist)">Node.js</a> – <a href="/index.php?title=Nonfree_applications_package_guidelines_(%E7%AE%80%E4%BD%93%E4%B8%AD%E6%96%87)&amp;action=edit&amp;redlink=1" class="new" title="Nonfree applications package guidelines (简体中文) (page does not exist)">Nonfree</a> – <a href="/index.php?title=OCaml_package_guidelines_(%E7%AE%80%E4%BD%93%E4%B8%AD%E6%96%87)&amp;action=edit&amp;redlink=1" class="new" title="OCaml package guidelines (简体中文) (page does not exist)">OCaml</a> – <a href="/index.php?title=Perl_package_guidelines_(%E7%AE%80%E4%BD%93%E4%B8%AD%E6%96%87)&amp;action=edit&amp;redlink=1" class="new" title="Perl package guidelines (简体中文) (page does not exist)">Perl</a> – <a href="../zh-CN/PHP_package_guidelines.html" title="PHP package guidelines (简体中文)">PHP</a> – <a href="../zh-CN/Python_package_guidelines.html" title="Python package guidelines (简体中文)">Python</a> – <a href="/index.php?title=R_package_guidelines_(%E7%AE%80%E4%BD%93%E4%B8%AD%E6%96%87)&amp;action=edit&amp;redlink=1" class="new" title="R package guidelines (简体中文) (page does not exist)">R</a> – <a href="/index.php?title=Ruby_Gem_package_guidelines_(%E7%AE%80%E4%BD%93%E4%B8%AD%E6%96%87)&amp;action=edit&amp;redlink=1" class="new" title="Ruby Gem package guidelines (简体中文) (page does not exist)">Ruby</a> – <a href="/index.php?title=Rust_package_guidelines_(%E7%AE%80%E4%BD%93%E4%B8%AD%E6%96%87)&amp;action=edit&amp;redlink=1" class="new" title="Rust package guidelines (简体中文) (page does not exist)">Rust</a> – <a href="../zh-CN/VCS_package_guidelines.html" title="VCS package guidelines (简体中文)">VCS</a> – <a href="/index.php?title=Web_application_package_guidelines_(%E7%AE%80%E4%BD%93%E4%B8%AD%E6%96%87)&amp;action=edit&amp;redlink=1" class="new" title="Web application package guidelines (简体中文) (page does not exist)">Web</a> – <a href="/index.php?title=Wine_package_guidelines_(%E7%AE%80%E4%BD%93%E4%B8%AD%E6%96%87)&amp;action=edit&amp;redlink=1" class="new" title="Wine package guidelines (简体中文) (page does not exist)">Wine</a>
</p>
</div>
<div class="noprint archwiki-template-message">
<p><a href="../File:Tango-preferences-desktop-locale.png" class="image"><img alt="Tango-preferences-desktop-locale.png" src="../File:Tango-preferences-desktop-locale.png" decoding="async" width="48" height="48"></a><b>本文或本节需要<a href="../zh-CN/ArchWiki:Contributing.html#%E7%BF%BB%E8%AF%91" title="ArchWiki:Contributing (简体中文)">翻译</a>。要贡献翻译，请访问<a href="../zh-CN/ArchWiki:Translation_Team.html" class="mw-redirect" title="ArchWiki Translation Team (简体中文)">简体中文翻译团队</a>。</b><a href="../File:Tango-preferences-desktop-locale.png" class="image"><img alt="Tango-preferences-desktop-locale.png" src="../File:Tango-preferences-desktop-locale.png" decoding="async" width="48" height="48"></a></p>
<div>
<b>附注：</b> <span style="color:red;">请使用模板的第一个参数进行更详细的指示。</span>（在 <a rel="nofollow" class="external text" href="https://wiki.archlinux.org/index.php/Talk:Java_package_guidelines_(%E7%AE%80%E4%BD%93%E4%B8%AD%E6%96%87)">Talk:Java package guidelines (简体中文)#</a> 中讨论）</div>
</div>
<p>This document defines a proposed standard for packaging Java programs under Arch Linux. Java programs are notoriously difficult to package cleanly without overlapping dependencies. This document describes a way to remedy this situation. These guidelines are flexible in order to cover the many different scenarios that arise when dealing with Java applications.
</p>
<div id="toc" class="toc" role="navigation" aria-labelledby="mw-toc-heading">
<input type="checkbox" role="button" id="toctogglecheckbox" class="toctogglecheckbox" style="display:none"><div class="toctitle" lang="en" dir="ltr">
<h2 id="mw-toc-heading">Contents</h2>
<span class="toctogglespan"><label class="toctogglelabel" for="toctogglecheckbox"></label></span>
</div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#%E4%BB%8B%E7%BB%8D"><span class="tocnumber">1</span> <span class="toctext">介绍</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#%E5%85%B8%E5%9E%8B%E7%9A%84Java%E5%BA%94%E7%94%A8%E8%BD%AF%E4%BB%B6%E7%9A%84%E7%BB%93%E6%9E%84"><span class="tocnumber">2</span> <span class="toctext">典型的Java应用软件的结构</span></a></li>
<li class="toclevel-1 tocsection-3">
<a href="#Arch%E4%B8%8B%E7%9A%84Java%E6%89%93%E5%8C%85"><span class="tocnumber">3</span> <span class="toctext">Arch下的Java打包</span></a>
<ul>
<li class="toclevel-2 tocsection-4"><a href="#%E7%9B%AE%E5%BD%95%E6%A0%91%E7%BB%93%E6%9E%84%E5%AE%9E%E4%BE%8B"><span class="tocnumber">3.1</span> <span class="toctext">目录树结构实例</span></a></li>
<li class="toclevel-2 tocsection-5"><a href="#%E4%BE%9D%E8%B5%96%E5%85%B3%E7%B3%BB"><span class="tocnumber">3.2</span> <span class="toctext">依赖关系</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-6"><a href="#%E9%92%88%E5%AF%B9Arch64_%E7%94%A8%E6%88%B7"><span class="tocnumber">4</span> <span class="toctext">针对Arch64 用户</span></a></li>
</ul>
</div>

<h2>
<span id=".E4.BB.8B.E7.BB.8D"></span><span class="mw-headline" id="介绍">介绍</span>
</h2>
<p>Arch Linux packagers cannot seem to agree on how to handle Java packages. Various methods are used in <code>PKGBUILD</code>s across the official and unofficial repositories and in the <a rel="nofollow" class="external text" href="https://aur.archlinux.org/">AUR</a>. These solutions include placing the whole mess in <code>/opt </code>with shell scripts in <code>/usr/bin</code> or profiles placed in <code>/etc/profile</code>. Others are placed in directories in <code>/usr/share</code> with scripts placed in <code>/usr/bin</code>. Many add unnecessary files to the system <code>CLASSPATH</code> and <code>PATH</code>.
</p>
<h2>
<span id=".E5.85.B8.E5.9E.8B.E7.9A.84Java.E5.BA.94.E7.94.A8.E8.BD.AF.E4.BB.B6.E7.9A.84.E7.BB.93.E6.9E.84"></span><span class="mw-headline" id="典型的Java应用软件的结构">典型的Java应用软件的结构</span>
</h2>
<p>大部分的桌面Java应用程序结构简单，它们经常独立于系统安装（但依赖于java软件包）。This usually installs everything in a single directory with subdirectories called <code>bin</code>, <code>lib</code>, <code>jar</code>, <code>conf</code>, etc. There is usually a main jar file containing the main executable classes. A shellscript is usually provided to run the main class so users do not have to invoke the Java interpreter directly. This shell script is usually quite complex, as it is generic across distros, and often includes special cases for different systems (ie: CYGWIN).
</p>
<p>The <code>lib</code> directory, often contains bundled jar files that satisfy dependencies of the Java application. This makes it simple for a user to install the program (all dependencies included), but is a package developer's nightmare. It is a waste of space when several packages bundle the same dependency. This was not a big issue in the past when there were fewer desktop Java applications and libraries, and those that existed tended to be very large anyway. Things are different now...
</p>
<p>Other files necessary to run the program are usually stored in the same folder as the main jar file, or a subdirectory thereof. Since Java programs don't know where their classes were loaded from, they usually need to be run from within this directory (i.e. the shell script should <code>cd</code> into the directory), or an environment variable is set to indicate the directory's location.
</p>
<h2>
<span id="Arch.E4.B8.8B.E7.9A.84Java.E6.89.93.E5.8C.85"></span><span class="mw-headline" id="Arch下的Java打包">Arch下的Java打包</span>
</h2>
<p>Packaging Java applications in Arch is going to take quite a bit more work for packagers than it currently does. The effort will be worth it, however, resulting in a cleaner filesystem and fewer bundled dependencies (as more and more Java libraries are refactored into their own packages, packaging will become easier). The following guidelines should be followed in creating an Arch Linux Java package:
</p>
<ul><li>If a Java library has a generic name, the package name should be prepended with the title <code>java-</code> to help distinguish it from other libraries. This is not necessary with uniquely named packages (like JUnit), end-user programs (like Eclipse), or libraries that can be uniquely described with another prefix (like jakarta-commons-collections or apache-ant).</li></ul>
<ul><li>You do not need to compile Java applications from source. Very little optimization goes into the compile process, as with gcc created binaries. If the source package provides an easy way to build from source go ahead and use it, but if its easier to just grab a binary release of a jar file or an installer you may use that as well.</li></ul>
<ul><li>Place all jar files (and no other files) distributed with the program in a <code>/usr/share/java/myprogram</code> directory. This includes all dependency jar files distributed with the application. However, effort should be made to place common or large dependency libraries into their own packages. This can only happen if the program does not depend on a specific version of a dependency library.</li></ul>
<p>This rule makes it possible to iteratively refactor dependencies. That is, the package and all its dependencies can be placed into one directory at first. After this has been tested, major dependencies can be refactored out one at a time.  Note that some applications include bundled dependencies inside the main jar file. That is, they unjar the bundled dependencies and include them in the main jar. Such dependencies are usually very small and there is little point in refactoring them.
</p>
<ul><li>If the program is meant to be run by the user, write a custom shell script that runs the main jar file. This script should be placed in <code>/usr/bin</code>. Libraries generally don't require shell scripts. Write the shell script from scratch, rather than using one that is bundled with the program. Remove code that tests for custom environments (like CYGWIN), and code that tries to determine if <code>JAVA_HOME</code> has been set (The J2RE package ensures <code>JAVA_HOME</code> has been properly set, so we do not need to test for it).</li></ul>
<ul><li>Set the <code>CLASSPATH</code> using the <code>-cp</code> option to the Java interpreter unless there is an explicit reason not to (ie: the <code>CLASSPATH</code> is used as a plugin mechanism). The <code>CLASSPATH</code> should include all jar files in the <code>/usr/share/java/myprogram</code> direcory, as well as jar files that are from dependency libraries that have been refactored to other directories. You can use something like the following code:</li></ul>
<pre>for name in /usr/share/java/myprogram/*.jar ; do
  CP=$CP:$name
done
CP=$CP:/usr/share/java/dep1/dep1.jar
java -cp $CP myprogram.java.MainClass
</pre>
<ul><li>Make sure the shellscript is executable!</li></ul>
<ul><li>Other files distributed with the package should be stored in a directory named after the package under <code>/usr/share</code>. You may need to set the location of this directory in a variable like <code>MYPROJECT_HOME</code> inside the shellscript. This guideline assumes that the program expects all files to be in the same directory (as is standard with Java packages). If it seems more natural to put a configuration file elsewhere (for example, a daemon in <code>/etc/rc.d</code> or logs in <code>/var/log</code>), then feel free to do so.</li></ul>
<p>Bear in mind that <code>/usr</code> may be mounted as read-only on some systems. If there are files in the shared directory that need to be written by the application, they may have to be relocated to <code>/etc</code>, <code>/var</code>, or the user's home directory.
</p>
<ul><li>As is standard with Arch Linux packages, if the above standards cannot be adhered to without a serious amount of work, the package should be installed in its preferred manner, with the resulting directory located in <code>/opt</code>. This is useful for programs that bundle JREs or include customized versions of dependencies, or do other strange or painful tasks.</li></ul>
<h3>
<span id=".E7.9B.AE.E5.BD.95.E6.A0.91.E7.BB.93.E6.9E.84.E5.AE.9E.E4.BE.8B"></span><span class="mw-headline" id="目录树结构实例">目录树结构实例</span>
</h3>
<p>To clarify, here is an example directory structure for a hypothetical program called <code>foo</code>. Since <code>foo</code> is a common name, the package is named <code>java-foo</code>, but notice this is not reflected in the directory structure:
</p>
<ul>
<li><code>/usr/share/java/foo/</code></li>
<li><code>/usr/share/java/foo/foo.jar</code></li>
<li>
<code>/usr/share/java/foo/bar.jar</code> (included dependency of <code>java-foo</code>)</li>
<li><code>/usr/share/foo/</code></li>
<li>
<code>/usr/share/foo/*.*</code> (some general files required by <code>java-foo</code>)</li>
<li>
<code>/usr/bin/foo</code> (executable shell script)</li>
</ul>
<h3>
<span id=".E4.BE.9D.E8.B5.96.E5.85.B3.E7.B3.BB"></span><span class="mw-headline" id="依赖关系">依赖关系</span>
</h3>
<p>Java包会根据需要，会依赖于'java-runtime' 或者'java-environment'。
</p>
<p>For most packages, <code>java-runtime</code> is what is needed to simply run software written in Java. <code>java-runtime</code> is a virtual dependency provided by:
</p>
<ul>
<li>
<span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=jre7-openjdk">jre7-openjdk</a></span> (free)</li>
<li>
<span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://aur.archlinux.org/packages/java-gcj-compat/">java-gcj-compat</a></span><sup><small>AUR</small></sup> (free)</li>
<li>
<span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://aur.archlinux.org/packages/jre/">jre</a></span><sup><small>AUR</small></sup> (non-free)</li>
</ul>
<p><code>java-environment</code> (e.g. JDK) is needed by packages that will need to compile Java source code into bytecode. <code>java-environment</code> is a virtual dependency provided by:
</p>
<ul>
<li>
<span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=jdk7-openjdk">jdk7-openjdk</a></span> (free)</li>
<li>
<span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://aur.archlinux.org/packages/jdk/">jdk</a></span><sup><small>AUR</small></sup> (non-free)</li>
</ul>
<h2>
<span id=".E9.92.88.E5.AF.B9Arch64_.E7.94.A8.E6.88.B7"></span><span class="mw-headline" id="针对Arch64_用户">针对Arch64 用户</span>
</h2>
<p>This does not appear to be available for 64-bit.
</p>
</div>
</div>
<div id="catlinks" class="catlinks" data-mw="interface">
<div id="mw-normal-catlinks" class="mw-normal-catlinks">
<a href="../Special:Categories.html" title="Special:Categories">Category</a>: <ul><li><a href="../zh-CN/Category:Arch_package_guidelines.html" title="Category:Arch package guidelines (简体中文)">Arch package guidelines (简体中文)</a></li></ul>
</div>
<div id="mw-hidden-catlinks" class="mw-hidden-catlinks mw-hidden-cats-hidden">Hidden category: <ul><li><a href="../zh-CN/Category:Pages_or_sections_flagged_with_Template:Translateme.html" title="Category:Pages or sections flagged with Template:Translateme (简体中文)">Pages or sections flagged with Template:Translateme (简体中文)</a></li></ul>
</div>
</div>
	</div>
</div>

<footer id="footer" class="mw-footer" role="contentinfo" style="margin: 0">
	<ul id="footer-info">
		<li>Retrieved from "<a dir="ltr" href="https://wiki.archlinux.org/index.php?title=Java_package_guidelines_(%E7%AE%80%E4%BD%93%E4%B8%AD%E6%96%87)&amp;oldid=608282">https://wiki.archlinux.org/index.php?title=Java_package_guidelines_(简体中文)&amp;oldid=608282</a>"</li>
		<li id="footer-info-lastmod"> This page was last edited on 26 April 2020, at 10:20.</li>
		<li id="footer-info-copyright">Content is available under <a class="external" rel="nofollow" href="http://www.gnu.org/copyleft/fdl.html">GNU Free Documentation License 1.3 or later</a> unless otherwise noted.</li>
	<br>
</ul>
	<ul id="footer-places">
		<li id="footer-places-privacy"><a href="../en/ArchWiki:Privacy_policy.html" title="ArchWiki:Privacy policy">Privacy policy</a></li>
		<li id="footer-places-about"><a href="../en/ArchWiki:About.html" title="ArchWiki:About">About ArchWiki</a></li>
		<li id="footer-places-disclaimer"><a href="../en/ArchWiki:General_disclaimer.html" title="ArchWiki:General disclaimer">Disclaimers</a></li>
	</ul>
	<ul id="footer-icons" class="noprint">
		<li id="footer-copyrightico">
	</ul>
	<div style="clear: both;"></div>
</footer>



</body>
</html>
