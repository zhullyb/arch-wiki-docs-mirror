<!DOCTYPE html>
<html class="client-nojs" lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<title>Access Control Lists (简体中文) - ArchWiki</title>
<link rel="stylesheet" href="../ArchWikiOffline.css">
<meta name="ResourceLoaderDynamicStyles" content="">
<meta name="generator" content="MediaWiki 1.35.0">
<meta name="robots" content="noindex,follow">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="shortcut icon" href="/favicon.ico">
<link rel="search" type="application/opensearchdescription+xml" href="/opensearch_desc.php" title="ArchWiki (en)">
<link rel="EditURI" type="application/rsd+xml" href="https://wiki.archlinux.org/api.php?action=rsd">
<link rel="license" href="http://www.gnu.org/copyleft/fdl.html">
<link rel="alternate" type="application/atom+xml" title="ArchWiki Atom feed" href="/index.php?title=Special:RecentChanges&amp;feed=atom">
</head>
<body class="mediawiki ltr sitedir-ltr mw-hide-empty-elt ns-0 ns-subject page-Access_Control_Lists_简体中文 rootpage-Access_Control_Lists_简体中文 skin-vector action-view skin-vector-legacy">
<div id="content" class="mw-body" role="main" style="margin: 0">
	<a id="top"></a>
	<div id="siteNotice" class="mw-body-content"></div>
	<div class="mw-indicators mw-body-content">
	</div>
	<h1 id="firstHeading" class="firstHeading" lang="en">Access Control Lists (简体中文)</h1>
	<div id="bodyContent" class="mw-body-content">
		<div id="siteSub" class="noprint">From ArchWiki</div>
		<div id="contentSub"></div>
		<div id="contentSub2"></div>
		
		<div id="jump-to-nav"></div>
		<a class="mw-jump-link" href="#mw-head">Jump to navigation</a>
		<a class="mw-jump-link" href="#searchInput">Jump to search</a>
		<div id="mw-content-text" lang="en" dir="ltr" class="mw-content-ltr">
<div class="warningbox">The printable version is no longer supported and may have rendering errors. Please update your browser bookmarks and please use the default browser print function instead.</div>
<div class="mw-parser-output">
<div class="archwiki-template-box archwiki-template-box-note">
<strong>翻译状态：</strong>本文是 <a href="../en/Access_Control_Lists.html" title="Access Control Lists">Access Control Lists</a> 的<a href="../zh-CN/ArchWiki:Translation_Team.html" title="ArchWiki:Translation Team (简体中文)">翻译</a>。上次翻译日期：2020-06-02。如果英文版本有所<a rel="nofollow" class="external text" href="https://wiki.archlinux.org/index.php?title=Access_Control_Lists&amp;diff=0&amp;oldid=617031">更改</a>，则您可以帮助同步翻译。</div>
<p><a href="https://en.wikipedia.org/wiki/Access_Control_List" class="extiw" title="wikipedia:Access Control List">访问控制列表</a> (ACL) 为<a href="../zh-CN/File_systems.html" class="mw-redirect" title="文件系统">文件系统</a>提供了一种附加的、更灵活的权限机制。它的设计目的是帮助 UNIX 文件权限。ACL 允许您将任何用户或组的权限授予任何磁盘资源
</p>
<div id="toc" class="toc" role="navigation" aria-labelledby="mw-toc-heading">
<input type="checkbox" role="button" id="toctogglecheckbox" class="toctogglecheckbox" style="display:none"><div class="toctitle" lang="en" dir="ltr">
<h2 id="mw-toc-heading">Contents</h2>
<span class="toctogglespan"><label class="toctogglelabel" for="toctogglecheckbox"></label></span>
</div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#%E5%AE%89%E8%A3%85"><span class="tocnumber">1</span> <span class="toctext">安装</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#%E5%90%AF%E7%94%A8_ACL"><span class="tocnumber">2</span> <span class="toctext">启用 ACL</span></a></li>
<li class="toclevel-1 tocsection-3">
<a href="#%E4%BD%BF%E7%94%A8"><span class="tocnumber">3</span> <span class="toctext">使用</span></a>
<ul>
<li class="toclevel-2 tocsection-4"><a href="#%E8%AE%BE%E7%BD%AE_ACL"><span class="tocnumber">3.1</span> <span class="toctext">设置 ACL</span></a></li>
<li class="toclevel-2 tocsection-5"><a href="#%E6%9F%A5%E7%9C%8B_ACL"><span class="tocnumber">3.2</span> <span class="toctext">查看 ACL</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-6">
<a href="#%E4%BE%8B%E5%AD%90"><span class="tocnumber">4</span> <span class="toctext">例子</span></a>
<ul>
<li class="toclevel-2 tocsection-7"><a href="#ACL_%E5%AF%B9_ls_%E5%91%BD%E4%BB%A4%E7%9A%84%E5%BD%B1%E5%93%8D"><span class="tocnumber">4.1</span> <span class="toctext">ACL 对 ls 命令的影响</span></a></li>
<li class="toclevel-2 tocsection-8"><a href="#%E6%8E%88%E4%BA%88_WEB_%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%A7%81%E6%9C%89%E6%96%87%E4%BB%B6%E7%9A%84%E6%89%A7%E8%A1%8C%E6%9D%83%E9%99%90"><span class="tocnumber">4.2</span> <span class="toctext">授予 WEB 服务器私有文件的执行权限</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-9"><a href="#%E5%8F%82%E9%98%85"><span class="tocnumber">5</span> <span class="toctext">参阅</span></a></li>
</ul>
</div>

<h2>
<span id=".E5.AE.89.E8.A3.85"></span><span class="mw-headline" id="安装">安装</span>
</h2>
<p><span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=acl">acl</a></span> 是 <a href="../en/Systemd.html" title="Systemd">systemd</a> 的依赖之一, 它应该已经被安装了.
</p>
<h2>
<span id=".E5.90.AF.E7.94.A8_ACL"></span><span class="mw-headline" id="启用_ACL">启用 ACL</span>
</h2>
<p>要启用 ACL，文件系统在挂载时必须要加入 <code>acl</code> 参数。要开机时自动启用 ACL，你可以通过编辑 <a href="../en/Fstab.html" title="Fstab">fstab</a> 文件来实现。
</p>
<p>需要注意的是对于 <a href="../en/Btrfs.html" title="Btrfs">Btrfs</a>、Ext2/<a href="../en/Ext3.html" title="Ext3">3</a>/<a href="../en/Ext4.html" title="Ext4">4</a> 文件系统已经默认启用了 <code>acl</code> 参数。对于 Ext2/<a href="../en/Ext3.html" title="Ext3">3</a>/<a href="../en/Ext4.html" title="Ext4">4</a> 文件系统，你可以通过以下方式检查 <code>acl</code> 参数是否在默认情况已经启用：
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;"># tune2fs -l /dev/sd<i>XY</i> | grep "Default mount options:"</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">Default mount options:    user_xattr acl
</pre>
<p>在某些情况下默认挂载选项可能会被覆盖，此时你可以在 <code>/proc/mounts</code> 文件中的相关行中看到 <code>noacl</code>。
</p>
<p>你可以通过 <code>tune2fs -o <i>option</i> <i>partition</i></code> 命令设置文件系统的默认挂载选项。例如：
</p>
<pre># tune2fs -o acl /dev/sd<i>XY</i>
</pre>
<p>当磁盘被设置默认挂载方式后，无论以后它被哪一台 Linux 挂载，都将默认启用 <code>acl</code> 选项，而无需手动编辑 <code>/etc/fstab</code> 文件。
</p>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>注意：</strong> 
<ul>
<li>
<code>acl</code> 选项在创建 ext2/3/4 文件系统时将被默认启用，该行为被 <code>/etc/mke2fs.conf</code> 控制。</li>
<li>
<code>/proc/mounts</code> 文件中不会列出默认挂载选项。</li>
</ul>
</div>
<h2>
<span id=".E4.BD.BF.E7.94.A8"></span><span class="mw-headline" id="使用">使用</span>
</h2>
<h3>
<span id=".E8.AE.BE.E7.BD.AE_ACL"></span><span class="mw-headline" id="设置_ACL">设置 ACL</span>
</h3>
<p>ACL 可以通过 <i>setfacl</i> 命令被设置。
</p>
<div class="archwiki-template-box archwiki-template-box-tip">
<strong>提示：</strong> 你可以通过添加 <code>--test</code> 参数来测试该命令的结果</div>
<p>为用户设定权限(<code><i>user</i></code> 是用户名或 UID)：
</p>
<pre># setfacl -m "u:<i>user:permissions</i>" &lt;file/dir&gt;
</pre>
<p>为用户组设定权限 (<code><i>group</i></code>是用户组名或 GID)：
</p>
<pre># setfacl -m "g:<i>group:permissions</i>" &lt;file/dir&gt;
</pre>
<p>为其他用户设定权限：
</p>
<pre># setfacl -m "other:<i>permissions</i>" &lt;file/dir&gt;
</pre>
<p>允许所有<i>新创建的文件</i>或<i>目录</i>从父目录继承条目(这不会影响将<i>复制</i>到目录中的文件)：
</p>
<pre># setfacl -dm "<i>条目</i>" &lt;目录&gt;
</pre>
<p>删除权限：
</p>
<pre># setfacl -x "<i>用户/用户组</i>" &lt;文件/目录&gt;
</pre>
<p>删除默认权限
</p>
<pre># setfacl -k &lt;文件/目录&gt;
</pre>
<p>删除所有ACL权限（拥有者、用户组和其他用户的权限将被保留）
</p>
<pre># setfacl -b &lt;file/dir&gt;
</pre>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>注意：</strong> The default behavior of <i>setfacl</i> is to recalculate the ACL mask entry, unless a <code>--mask</code> entry was explicitly given. The mask entry is set to the union of all permissions of the owning group, and all named user and group entries (These are exactly the entries affected by the mask entry).</div>
<div class="archwiki-template-box archwiki-template-box-tip">
<strong>提示：</strong> 要递归地将属性应用到文件夹下的所有子文件夹和文件，使用 <code>-R</code> 参数。</div>
<h3>
<span id=".E6.9F.A5.E7.9C.8B_ACL"></span><span class="mw-headline" id="查看_ACL">查看 ACL</span>
</h3>
<p>要显示 ACL 权限，使用:
</p>
<pre># getfacl &lt;file/dir&gt;
</pre>
<h2>
<span id=".E4.BE.8B.E5.AD.90"></span><span class="mw-headline" id="例子">例子</span>
</h2>
<p>给予 <code>johnny</code> 对 <code>abc</code> 文件的所有访问权：
</p>
<pre># setfacl -m "u:johnny:rwx" abc
</pre>
<p>检查权限：
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;"># getfacl abc</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;"># file: abc
# owner: someone
# group: someone
user::rw-
user:johnny:rwx
group::r--
mask::rwx
other::r--
</pre>
<p>改变 <code>johnny</code> 的权限：
</p>
<pre># setfacl -m "u:johnny:r-x" abc
</pre>
<p>检查权限：
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;"># getfacl abc</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;"># file: abc
# owner: someone
# group: someone
user::rw-
user:johnny:r-x
group::r--
mask::r-x
other::r--
</pre>
<p>删除所有已添加的 ACL 权限信息：
</p>
<pre># setfacl -b abc
</pre>
<p>检查权限：
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;"># getfacl abc</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;"># file: abc
# owner: someone
# group: someone
user::rw-
group::r--
other::r--
</pre>
<h3>
<span id="ACL_.E5.AF.B9_ls_.E5.91.BD.E4.BB.A4.E7.9A.84.E5.BD.B1.E5.93.8D"></span><span class="mw-headline" id="ACL_对_ls_命令的影响">ACL 对 ls 命令的影响</span>
</h3>
<p>当使用 <code>ls -l</code> 命令时，含有ACL权限的文件将会显示一个 <code><b>+</b></code>
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">$ ls -l /dev/audio</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">crw-rw----+ 1 root audio 14, 4 nov.   9 12:49 /dev/audio
</pre>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">$ getfacl /dev/audio</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">getfacl: Removing leading '/' from absolute path names
# file: dev/audio
# owner: root
# group: audio
user::rw-
user:solstice:rw-
group::rw-
mask::rw-
other::---
</pre>
<h3>
<span id=".E6.8E.88.E4.BA.88_WEB_.E6.9C.8D.E5.8A.A1.E5.99.A8.E7.A7.81.E6.9C.89.E6.96.87.E4.BB.B6.E7.9A.84.E6.89.A7.E8.A1.8C.E6.9D.83.E9.99.90"></span><span class="mw-headline" id="授予_WEB_服务器私有文件的执行权限">授予 WEB 服务器私有文件的执行权限</span>
</h3>
<p>下面的例子演示了如何对 WEB 服务器这样的进程赋予其访问用户目录的权限，以便防止其越权处理文件。
</p>
<p>假设运行该 WEB 服务器进程的用户为 <code>http</code>，授予其访问 <code>/home/geoffrey</code> 的权限。
</p>
<p>首先授予 <code>http</code> 执行权限：
</p>
<pre># setfacl -m "u:http:--x" /home/geoffrey
</pre>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>注意：</strong> 要获取目录下的文件列表，必须要对目录拥有执行权</div>
<p>由于 <code>http</code> 现在已经对 <code>/home/geoffrey</code> 拥有执行权，下面移除 other 对 <code>/home/geoffrey</code> 的权限：
</p>
<pre># chmod o-rx /home/geoffrey
</pre>
<p>使用<code>getfacl</code> 查看更改：
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">$ getfacl /home/geoffrey</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">getfacl: Removing leading '/' from absolute path names
# file: home/geoffrey
# owner: geoffrey
# group: geoffrey
user::rwx
user:http:--x
group::r-x
mask::r-x
other::---
</pre>
<p>正如上面的输出所示，<code>other</code> 不再具有任何权限，但是用户 <code>http</code> 仍然能够访问文件，因此可以认为安全性有所提高。
</p>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>注意：</strong> 可能需要为用户 
<p><code>http</code> 提供特定目录或文件的写访问权：
</p>
<pre># setfacl -dm "u:http:rwx" /home/geoffrey/project1/cache
</pre>
</div>
<h2>
<span id=".E5.8F.82.E9.98.85"></span><span class="mw-headline" id="参阅">参阅</span>
</h2>
<ul>
<li><span class="plainlinks archwiki-template-man" title="$ man 1 getfacl"><a rel="nofollow" class="external text" href="https://man.archlinux.org/man/getfacl.1">getfacl(1)</a></span></li>
<li><span class="plainlinks archwiki-template-man" title="$ man 1 setfacl"><a rel="nofollow" class="external text" href="https://man.archlinux.org/man/setfacl.1">setfacl(1)</a></span></li>
<li>一个虽然旧但却全面的 ACL <a rel="nofollow" class="external text" href="https://www.usenix.org/legacy/publications/library/proceedings/usenix03/tech/freenix03/full_papers/gruenbacher/gruenbacher_html/main.html">指导</a>
</li>
<li><a rel="nofollow" class="external text" href="https://unix.stackexchange.com/questions/1314/how-to-set-default-file-permissions-for-all-folders-files-in-a-directory">如何为文件和文件夹设置默认权限？</a></li>
</ul>
</div>
</div>
<div id="catlinks" class="catlinks" data-mw="interface"><div id="mw-normal-catlinks" class="mw-normal-catlinks">
<a href="../Special:Categories.html" title="Special:Categories">Category</a>: <ul><li><a href="../zh-CN/Category:Access_control.html" title="Category:Access control (简体中文)">Access control (简体中文)</a></li></ul>
</div></div>
	</div>
</div>

<footer id="footer" class="mw-footer" role="contentinfo" style="margin: 0">
	<ul id="footer-info">
		<li>Retrieved from "<a dir="ltr" href="https://wiki.archlinux.org/index.php?title=Access_Control_Lists_(%E7%AE%80%E4%BD%93%E4%B8%AD%E6%96%87)&amp;oldid=630926">https://wiki.archlinux.org/index.php?title=Access_Control_Lists_(简体中文)&amp;oldid=630926</a>"</li>
		<li id="footer-info-lastmod"> This page was last edited on 11 August 2020, at 18:07.</li>
		<li id="footer-info-copyright">Content is available under <a class="external" rel="nofollow" href="http://www.gnu.org/copyleft/fdl.html">GNU Free Documentation License 1.3 or later</a> unless otherwise noted.</li>
	<br>
</ul>
	<ul id="footer-places">
		<li id="footer-places-privacy"><a href="../en/ArchWiki:Privacy_policy.html" title="ArchWiki:Privacy policy">Privacy policy</a></li>
		<li id="footer-places-about"><a href="../en/ArchWiki:About.html" title="ArchWiki:About">About ArchWiki</a></li>
		<li id="footer-places-disclaimer"><a href="../en/ArchWiki:General_disclaimer.html" title="ArchWiki:General disclaimer">Disclaimers</a></li>
	</ul>
	<ul id="footer-icons" class="noprint">
		<li id="footer-copyrightico">
	</ul>
	<div style="clear: both;"></div>
</footer>



</body>
</html>
