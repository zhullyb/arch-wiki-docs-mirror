<!DOCTYPE html>
<html class="client-nojs" lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<title>PRIME (简体中文) - ArchWiki</title>
<link rel="stylesheet" href="../ArchWikiOffline.css">
<meta name="ResourceLoaderDynamicStyles" content="">
<meta name="generator" content="MediaWiki 1.35.0">
<meta name="robots" content="noindex,follow">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="shortcut icon" href="/favicon.ico">
<link rel="search" type="application/opensearchdescription+xml" href="/opensearch_desc.php" title="ArchWiki (en)">
<link rel="EditURI" type="application/rsd+xml" href="https://wiki.archlinux.org/api.php?action=rsd">
<link rel="license" href="http://www.gnu.org/copyleft/fdl.html">
<link rel="alternate" type="application/atom+xml" title="ArchWiki Atom feed" href="/index.php?title=Special:RecentChanges&amp;feed=atom">
</head>
<body class="mediawiki ltr sitedir-ltr mw-hide-empty-elt ns-0 ns-subject page-PRIME_简体中文 rootpage-PRIME_简体中文 skin-vector action-view skin-vector-legacy">
<div id="content" class="mw-body" role="main" style="margin: 0">
	<a id="top"></a>
	<div id="siteNotice" class="mw-body-content"></div>
	<div class="mw-indicators mw-body-content">
	</div>
	<h1 id="firstHeading" class="firstHeading" lang="en">PRIME (简体中文)</h1>
	<div id="bodyContent" class="mw-body-content">
		<div id="siteSub" class="noprint">From ArchWiki</div>
		<div id="contentSub"></div>
		<div id="contentSub2"></div>
		
		<div id="jump-to-nav"></div>
		<a class="mw-jump-link" href="#mw-head">Jump to navigation</a>
		<a class="mw-jump-link" href="#searchInput">Jump to search</a>
		<div id="mw-content-text" lang="en" dir="ltr" class="mw-content-ltr">
<div class="warningbox">The printable version is no longer supported and may have rendering errors. Please update your browser bookmarks and please use the default browser print function instead.</div>
<div class="mw-parser-output">
<div class="noprint archwiki-template-message">
<p><a href="../File:Tango-preferences-desktop-locale.png" class="image"><img alt="Tango-preferences-desktop-locale.png" src="../File:Tango-preferences-desktop-locale.png" decoding="async" width="48" height="48"></a><b>本文或本节需要<a href="../zh-CN/ArchWiki:Contributing.html#%E7%BF%BB%E8%AF%91" title="ArchWiki:Contributing (简体中文)">翻译</a>。要贡献翻译，请访问<a href="../zh-CN/ArchWiki:Translation_Team.html" class="mw-redirect" title="ArchWiki Translation Team (简体中文)">简体中文翻译团队</a>。</b><a href="../File:Tango-preferences-desktop-locale.png" class="image"><img alt="Tango-preferences-desktop-locale.png" src="../File:Tango-preferences-desktop-locale.png" decoding="async" width="48" height="48"></a></p>
<div>
<b>附注：</b> <span style="color:red;">请使用模板的第一个参数进行更详细的指示。</span>（在 <a rel="nofollow" class="external text" href="https://wiki.archlinux.org/index.php/Talk:PRIME_(%E7%AE%80%E4%BD%93%E4%B8%AD%E6%96%87)">Talk:PRIME (简体中文)#</a> 中讨论）</div>
</div>
<p>PRIME 是一项用于管理新型号笔记本电脑中的混合显卡的技术(<a href="../en/NVIDIA_Optimus.html" title="NVIDIA Optimus">Optimus for NVIDIA</a>, AMD动态切换显卡技术)
以下驱动程序可支持PRIME技术：
</p>
<ul>
<li><span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=xf86-video-nouveau">xf86-video-nouveau</a></span></li>
<li><span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=xf86-video-ati">xf86-video-ati</a></span></li>
<li><span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=xf86-video-intel">xf86-video-intel</a></span></li>
</ul>
<div id="toc" class="toc" role="navigation" aria-labelledby="mw-toc-heading">
<input type="checkbox" role="button" id="toctogglecheckbox" class="toctogglecheckbox" style="display:none"><div class="toctitle" lang="en" dir="ltr">
<h2 id="mw-toc-heading">Contents</h2>
<span class="toctogglespan"><label class="toctogglelabel" for="toctogglecheckbox"></label></span>
</div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#%E5%AE%89%E8%A3%85"><span class="tocnumber">1</span> <span class="toctext">安装</span></a></li>
<li class="toclevel-1 tocsection-2">
<a href="#%E6%95%85%E9%9A%9C%E6%8E%92%E6%9F%A5"><span class="tocnumber">2</span> <span class="toctext">故障排查</span></a>
<ul>
<li class="toclevel-2 tocsection-3"><a href="#XRandR_%E5%8F%AA%E8%AF%86%E5%88%AB%E5%87%BA%E4%B8%80%E4%B8%AA%E6%98%BE%E5%8D%A1"><span class="tocnumber">2.1</span> <span class="toctext">XRandR 只识别出一个显卡</span></a></li>
<li class="toclevel-2 tocsection-4">
<a href="#%E5%BD%93%E7%A8%8B%E5%BA%8F%E4%BD%BF%E7%94%A8%E7%8B%AC%E7%AB%8B%E6%98%BE%E5%8D%A1%E6%B8%B2%E6%9F%93%E6%97%B6%EF%BC%8C%E7%A8%8B%E5%BA%8F%E9%BB%91%E5%B1%8F"><span class="tocnumber">2.2</span> <span class="toctext">当程序使用独立显卡渲染时，程序黑屏</span></a>
<ul>
<li class="toclevel-3 tocsection-5"><a href="#Black_screen_with_GL-based_compositors"><span class="tocnumber">2.2.1</span> <span class="toctext">Black screen with GL-based compositors</span></a></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>

<h2>
<span id=".E5.AE.89.E8.A3.85"></span><span class="mw-headline" id="安装">安装</span>
</h2>
<p>首先，检查所有添附到你的显示器上的显卡：
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">$ xrandr --listproviders</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">Providers: number : 2
Provider 0: id: 0x7d cap: 0xb, Source Output, Sink Output, Sink Offload crtcs: 3 outputs: 4 associated providers: 1 name:Intel
Provider 1: id: 0x56 cap: 0xf, Source Output, Sink Output, Source Offload, Sink Offload crtcs: 6 outputs: 1 associated providers: 1 name:radeon
</pre>
<p>我们可以看到有两块显卡：Intel，也就是集成的图形卡（id为0x7d），以及 Radeon，也就是独立显卡（id为0x56），通常情况下对GPU要求高的程序应该使用独立显卡。我们可以看到，默认情况下被使用的显卡总是Intel集成显卡：
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">$ glxinfo | grep "OpenGL renderer"</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">OpenGL renderer string: Mesa DRI Intel(R) Ivybridge Mobile
</pre>
<p><br>
为了使用独立显卡（此处以radeon为例），你必须先将集成显卡定义为offload provider，因为当前连接到显示器的是集成显卡：
</p>
<pre>$ xrandr --setprovideroffloadsink 0x56 0x7d
</pre>
<p>现在你可以在对显卡要求高的程序（如游戏，3D建模工具等等）中使用独立显卡了：
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">$ DRI_PRIME=1 glxinfo | grep "OpenGL renderer"</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">OpenGL renderer string: Gallium 0.4 on AMD TURKS
</pre>
<p>其他程序仍然会使用更节能的集成显卡。每次X11重启都必须再运行一次 <code>xrandr --setprovideroffloadsink 0x56 0x7d</code> ; 你可以写一个脚本并且在启动桌面环境时自动运行(或者将脚本放在 <code>/etc/X11/xinit/xinitrc.d/</code>目录下).
</p>
<h2>
<span id=".E6.95.85.E9.9A.9C.E6.8E.92.E6.9F.A5"></span><span class="mw-headline" id="故障排查">故障排查</span>
</h2>
<h3>
<span id="XRandR_.E5.8F.AA.E8.AF.86.E5.88.AB.E5.87.BA.E4.B8.80.E4.B8.AA.E6.98.BE.E5.8D.A1"></span><span class="mw-headline" id="XRandR_只识别出一个显卡">XRandR 只识别出一个显卡</span>
</h3>
<p>删除或者移走 /etc/X11/xorg.conf 以及 /etc/X11/xorg.conf.d/ 目录下任何与GPU有关的文件
</p>
<h3>
<span id=".E5.BD.93.E7.A8.8B.E5.BA.8F.E4.BD.BF.E7.94.A8.E7.8B.AC.E7.AB.8B.E6.98.BE.E5.8D.A1.E6.B8.B2.E6.9F.93.E6.97.B6.EF.BC.8C.E7.A8.8B.E5.BA.8F.E9.BB.91.E5.B1.8F"></span><span class="mw-headline" id="当程序使用独立显卡渲染时，程序黑屏">当程序使用独立显卡渲染时，程序黑屏</span>
</h3>
<p>某些情况下PRIME的正常工作需要一个混合窗口管理器。如果你使用的窗口管理器不进行混合渲染，你可以在其基础上使用<a href="../en/Xcompmgr.html" title="Xcompmgr">xcompmgr</a>。
</p>
<h4><span class="mw-headline" id="Black_screen_with_GL-based_compositors">Black screen with GL-based compositors</span></h4>
<p>Currently there are issues with GL-based compositors and PRIME offloading. While Xrender-based compositors (xcompmgr, xfwm, compton's default backend, cairo-compmgr, and a few others) will work without issue, GL-based compositors (Mutter/muffin, Compiz, compton with GLX backend, Kwin's OpenGL backend, etc) will initially show a black screen, as if there was no compositor running. While you can force an image to appear by resizing the offloaded window, this is not a practical solution as it will not work for things such as full screen Wine applications. This means that desktop environments such as GNOME3 and Cinnamon have issues with using PRIME offloading.
</p>
<p>Additionally if you are using an Intel IGP you might be able to fix the GL Compositing issue by running the IGP as UXA instead of SNA, however this may cause issues with the offloading process (ie, xrandr --listproviders may not list the discrete GPU).
</p>
</div>
</div>
<div id="catlinks" class="catlinks" data-mw="interface">
<div id="mw-normal-catlinks" class="mw-normal-catlinks">
<a href="../Special:Categories.html" title="Special:Categories">Category</a>: <ul><li><a href="../zh-CN/Category:Graphics.html" title="Category:Graphics (简体中文)">Graphics (简体中文)</a></li></ul>
</div>
<div id="mw-hidden-catlinks" class="mw-hidden-catlinks mw-hidden-cats-hidden">Hidden category: <ul><li><a href="../zh-CN/Category:Pages_or_sections_flagged_with_Template:Translateme.html" title="Category:Pages or sections flagged with Template:Translateme (简体中文)">Pages or sections flagged with Template:Translateme (简体中文)</a></li></ul>
</div>
</div>
	</div>
</div>

<footer id="footer" class="mw-footer" role="contentinfo" style="margin: 0">
	<ul id="footer-info">
		<li>Retrieved from "<a dir="ltr" href="https://wiki.archlinux.org/index.php?title=PRIME_(%E7%AE%80%E4%BD%93%E4%B8%AD%E6%96%87)&amp;oldid=608064">https://wiki.archlinux.org/index.php?title=PRIME_(简体中文)&amp;oldid=608064</a>"</li>
		<li id="footer-info-lastmod"> This page was last edited on 25 April 2020, at 11:05.</li>
		<li id="footer-info-copyright">Content is available under <a class="external" rel="nofollow" href="http://www.gnu.org/copyleft/fdl.html">GNU Free Documentation License 1.3 or later</a> unless otherwise noted.</li>
	<br>
</ul>
	<ul id="footer-places">
		<li id="footer-places-privacy"><a href="../en/ArchWiki:Privacy_policy.html" title="ArchWiki:Privacy policy">Privacy policy</a></li>
		<li id="footer-places-about"><a href="../en/ArchWiki:About.html" title="ArchWiki:About">About ArchWiki</a></li>
		<li id="footer-places-disclaimer"><a href="../en/ArchWiki:General_disclaimer.html" title="ArchWiki:General disclaimer">Disclaimers</a></li>
	</ul>
	<ul id="footer-icons" class="noprint">
		<li id="footer-copyrightico">
	</ul>
	<div style="clear: both;"></div>
</footer>



</body>
</html>
