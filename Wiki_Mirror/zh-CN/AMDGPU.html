<!DOCTYPE html>
<html class="client-nojs" lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<title>AMDGPU (简体中文) - ArchWiki</title>
<link rel="stylesheet" href="../ArchWikiOffline.css">
<meta name="ResourceLoaderDynamicStyles" content="">
<meta name="generator" content="MediaWiki 1.35.0">
<meta name="referrer" content="no-referrer-when-downgrade">
<meta name="robots" content="noindex,follow">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="shortcut icon" href="/favicon.ico">
<link rel="search" type="application/opensearchdescription+xml" href="/opensearch_desc.php" title="ArchWiki (en)">
<link rel="EditURI" type="application/rsd+xml" href="https://wiki.archlinux.org/api.php?action=rsd">
<link rel="license" href="http://www.gnu.org/copyleft/fdl.html">
<link rel="alternate" type="application/atom+xml" title="ArchWiki Atom feed" href="/index.php?title=Special:RecentChanges&amp;feed=atom">
</head>
<body class="mediawiki ltr sitedir-ltr mw-hide-empty-elt ns-0 ns-subject page-AMDGPU_简体中文 rootpage-AMDGPU_简体中文 skin-vector action-view skin-vector-legacy">
<div id="content" class="mw-body" role="main" style="margin: 0">
	<a id="top"></a>
	<div id="siteNotice" class="mw-body-content"></div>
	<div class="mw-indicators mw-body-content">
	</div>
	<h1 id="firstHeading" class="firstHeading" lang="en">AMDGPU (简体中文)</h1>
	<div id="bodyContent" class="mw-body-content">
		<div id="siteSub" class="noprint">From ArchWiki</div>
		<div id="contentSub"></div>
		<div id="contentSub2"></div>
		
		<div id="jump-to-nav"></div>
		<a class="mw-jump-link" href="#mw-head">Jump to navigation</a>
		<a class="mw-jump-link" href="#searchInput">Jump to search</a>
		<div id="mw-content-text" lang="en" dir="ltr" class="mw-content-ltr">
<div class="warningbox">The printable version is no longer supported and may have rendering errors. Please update your browser bookmarks and please use the default browser print function instead.</div>
<div class="mw-parser-output">
<div class="archwiki-template-meta-related-articles-start">
<p>Related articles</p>
<ul>
<li><a href="/title/ATI_(%E7%AE%80%E4%BD%93%E4%B8%AD%E6%96%87)" title="ATI (简体中文)">ATI (简体中文)</a></li>
<li><a href="/title/Xorg_(%E7%AE%80%E4%BD%93%E4%B8%AD%E6%96%87)" title="Xorg (简体中文)">Xorg (简体中文)</a></li>
<li><a href="/title/Vulkan" title="Vulkan">Vulkan</a></li>
</ul>
</div>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>翻译状态：</strong>本文是 <a href="/title/AMDGPU" title="AMDGPU">AMDGPU</a> 的<a href="/title/ArchWiki:Translation_Team_(%E7%AE%80%E4%BD%93%E4%B8%AD%E6%96%87)" title="ArchWiki:Translation Team (简体中文)">翻译</a>。上次翻译日期：2019-09-02。如果英文版本有所<a rel="nofollow" class="external text" href="https://wiki.archlinux.org/index.php?title=AMDGPU&amp;diff=0&amp;oldid=581347">更改</a>，则您可以帮助同步翻译。</div>
<p><b>amdgpu</b> 是 AMD Radeon 显卡的开源图形驱动。
</p>
<div id="toc" class="toc" role="navigation" aria-labelledby="mw-toc-heading">
<input type="checkbox" role="button" id="toctogglecheckbox" class="toctogglecheckbox" style="display:none"><div class="toctitle" lang="en" dir="ltr">
<h2 id="mw-toc-heading">Contents</h2>
<span class="toctogglespan"><label class="toctogglelabel" for="toctogglecheckbox"></label></span>
</div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#%E9%80%89%E6%8B%A9%E6%AD%A3%E7%A1%AE%E7%9A%84%E9%A9%B1%E5%8A%A8"><span class="tocnumber">1</span> <span class="toctext">选择正确的驱动</span></a></li>
<li class="toclevel-1 tocsection-2">
<a href="#%E5%AE%89%E8%A3%85"><span class="tocnumber">2</span> <span class="toctext">安装</span></a>
<ul>
<li class="toclevel-2 tocsection-3">
<a href="#%E5%BC%80%E5%90%AF_Southern_Islands_(SI)_and_Sea_Islands_(CIK)_%E6%94%AF%E6%8C%81"><span class="tocnumber">2.1</span> <span class="toctext">开启 Southern Islands (SI) and Sea Islands (CIK) 支持</span></a>
<ul>
<li class="toclevel-3 tocsection-4"><a href="#%E6%8C%87%E5%AE%9A%E6%AD%A3%E7%A1%AE%E7%9A%84%E6%A8%A1%E5%9D%97%E5%8A%A0%E8%BD%BD%E9%A1%BA%E5%BA%8F"><span class="tocnumber">2.1.1</span> <span class="toctext">指定正确的模块加载顺序</span></a></li>
<li class="toclevel-3 tocsection-5">
<a href="#%E8%AE%BE%E7%BD%AE%E6%89%80%E9%9C%80%E7%9A%84%E6%A8%A1%E5%9D%97%E5%8F%82%E6%95%B0"><span class="tocnumber">2.1.2</span> <span class="toctext">设置所需的模块参数</span></a>
<ul>
<li class="toclevel-4 tocsection-6"><a href="#%E5%9C%A8%E5%86%85%E6%A0%B8%E5%91%BD%E4%BB%A4%E8%A1%8C%E4%B8%AD%E8%AE%BE%E7%BD%AE%E6%A8%A1%E5%9D%97%E5%8F%82%E6%95%B0"><span class="tocnumber">2.1.2.1</span> <span class="toctext">在内核命令行中设置模块参数</span></a></li>
<li class="toclevel-4 tocsection-7"><a href="#%E8%AE%BE%E7%BD%AE%E5%86%85%E6%A0%B8%E5%8F%82%E6%95%B0%E5%9C%A8_modprobe.d_%E4%B8%AD"><span class="tocnumber">2.1.2.2</span> <span class="toctext">设置内核参数在 modprobe.d 中</span></a></li>
</ul>
</li>
</ul>
</li>
<li class="toclevel-2 tocsection-8"><a href="#AMDGPU_PRO"><span class="tocnumber">2.2</span> <span class="toctext">AMDGPU PRO</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-9">
<a href="#%E5%8A%A0%E8%BD%BD"><span class="tocnumber">3</span> <span class="toctext">加载</span></a>
<ul>
<li class="toclevel-2 tocsection-10"><a href="#Enable_early_KMS"><span class="tocnumber">3.1</span> <span class="toctext">Enable early KMS</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-11">
<a href="#Xorg_configuration"><span class="tocnumber">4</span> <span class="toctext">Xorg configuration</span></a>
<ul>
<li class="toclevel-2 tocsection-12"><a href="#Tear_Free_Rendering"><span class="tocnumber">4.1</span> <span class="toctext">Tear Free Rendering</span></a></li>
<li class="toclevel-2 tocsection-13"><a href="#DRI_level"><span class="tocnumber">4.2</span> <span class="toctext">DRI level</span></a></li>
<li class="toclevel-2 tocsection-14"><a href="#Variable_refresh_rate"><span class="tocnumber">4.3</span> <span class="toctext">Variable refresh rate</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-15">
<a href="#Features"><span class="tocnumber">5</span> <span class="toctext">Features</span></a>
<ul>
<li class="toclevel-2 tocsection-16"><a href="#Video_acceleration"><span class="tocnumber">5.1</span> <span class="toctext">Video acceleration</span></a></li>
<li class="toclevel-2 tocsection-17"><a href="#Overclocking"><span class="tocnumber">5.2</span> <span class="toctext">Overclocking</span></a></li>
<li class="toclevel-2 tocsection-18"><a href="#Enable_GPU_display_scaling"><span class="tocnumber">5.3</span> <span class="toctext">Enable GPU display scaling</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-19">
<a href="#Troubleshooting"><span class="tocnumber">6</span> <span class="toctext">Troubleshooting</span></a>
<ul>
<li class="toclevel-2 tocsection-20"><a href="#Xorg_or_applications_won't_start"><span class="tocnumber">6.1</span> <span class="toctext">Xorg or applications won't start</span></a></li>
<li class="toclevel-2 tocsection-21"><a href="#Screen_artifacts_and_frequency_problem"><span class="tocnumber">6.2</span> <span class="toctext">Screen artifacts and frequency problem</span></a></li>
<li class="toclevel-2 tocsection-22"><a href="#R9_390_series_Poor_Performance_and/or_Instability"><span class="tocnumber">6.3</span> <span class="toctext">R9 390 series Poor Performance and/or Instability</span></a></li>
<li class="toclevel-2 tocsection-23"><a href="#Freezes_with_%22%5Bdrm%5D_IP_block:gmc_v8_0_is_hung!%22_kernel_error"><span class="tocnumber">6.4</span> <span class="toctext">Freezes with "[drm] IP block:gmc_v8_0 is hung!" kernel error</span></a></li>
<li class="toclevel-2 tocsection-24"><a href="#Cursor_corruption"><span class="tocnumber">6.5</span> <span class="toctext">Cursor corruption</span></a></li>
</ul>
</li>
</ul>
</div>

<h2>
<span id=".E9.80.89.E6.8B.A9.E6.AD.A3.E7.A1.AE.E7.9A.84.E9.A9.B1.E5.8A.A8"></span><span class="mw-headline" id="选择正确的驱动">选择正确的驱动</span>
</h2>
<p>请参考<a href="/title/Xorg#AMD" title="Xorg">Xorg#AMD</a>选择合适的显卡驱动，这个页面包含 <b>AMDGPU</b> 和 <b>AMDGPU PRO</b>的说明。
</p>
<p>目前驱动支持<a rel="nofollow" class="external text" href="https://www.x.org/wiki/RadeonFeature/">Volcanic Islands (VI)</a> (和更新的显卡) 并且实验性支持 <a rel="nofollow" class="external text" href="https://www.phoronix.com/scan.php?page=news_item&amp;px=AMD-AMDGPU-Released">Sea Islands (CI)</a> 和 <a rel="nofollow" class="external text" href="https://www.phoronix.com/scan.php?page=news_item&amp;px=AMDGPU-SI-Experimental-Code">Southern Islands (SI)</a> 显卡，AMD 没有计划支持更老的 GCN GPUs。
</p>
<p>驱动不支持的显卡用户可以使用开源<a href="/title/Radeon" class="mw-redirect" title="Radeon">radeon</a>驱动代替。
</p>
<h2>
<span id=".E5.AE.89.E8.A3.85"></span><span class="mw-headline" id="安装">安装</span>
</h2>
<p>安装这个<span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=mesa">mesa</a></span> 软件包，它提供 DRI 和 3D 加速。
</p>
<ul>
<li>为支持32位程序，也可以从<a href="/title/Multilib" class="mw-redirect" title="Multilib">multilib</a>仓库中安装<span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=lib32-mesa">lib32-mesa</a></span>软件包。</li>
<li>为提供 DDX 驱动 (可提供 2D 加速 在<a href="/title/Xorg" title="Xorg">Xorg</a>中)，可以安装这个 <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=xf86-video-amdgpu">xf86-video-amdgpu</a></span> 软件包。</li>
<li>为支持 <a href="/title/Vulkan" title="Vulkan">Vulkan</a> , 可以安装 <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=vulkan-radeon">vulkan-radeon</a></span> 软件包， 也可以选择安装<span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=lib32-vulkan-radeon">lib32-vulkan-radeon</a></span>软件包为 32 位程序提供支持。</li>
</ul>
<p>想要开启<a href="#Video_acceleration">accelerated video decoding</a>，可以安装<span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=libva-mesa-driver">libva-mesa-driver</a></span>和<span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=lib32-libva-mesa-driver">lib32-libva-mesa-driver</a></span>软件包来支持 VA-API，安装<span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=mesa-vdpau">mesa-vdpau</a></span>和<span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=lib32-mesa-vdpau">lib32-mesa-vdpau</a></span>软件包支持VDPAU。
</p>
<h3>
<span id=".E5.BC.80.E5.90.AF_Southern_Islands_.28SI.29_and_Sea_Islands_.28CIK.29_.E6.94.AF.E6.8C.81"></span><span class="mw-headline" id="开启_Southern_Islands_(SI)_and_Sea_Islands_(CIK)_支持">开启 Southern Islands (SI) and Sea Islands (CIK) 支持</span>
</h3>
<p><span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=linux">linux</a></span> 软件包 可以开启 AMDGPU 支持对于 the Southern Islands (SI) 和 Sea Islands (CIK)的显卡。 当编译和构建一个 <a href="/title/Kernels_(%E7%AE%80%E4%BD%93%E4%B8%AD%E6%96%87)" class="mw-redirect" title="Kernels (简体中文)">kernels (简体中文)</a>, 需要设置<code>CONFIG_DRM_AMDGPU_SI=Y</code> 和 <code>CONFIG_DRM_AMDGPU_CIK=Y</code> 参数。
</p>
<h4>
<span id=".E6.8C.87.E5.AE.9A.E6.AD.A3.E7.A1.AE.E7.9A.84.E6.A8.A1.E5.9D.97.E5.8A.A0.E8.BD.BD.E9.A1.BA.E5.BA.8F"></span><span class="mw-headline" id="指定正确的模块加载顺序">指定正确的模块加载顺序</span>
</h4>
<p>当内核启用 AMDGPU 对 SI/CIK 显卡的支持时，<a href="/title/Radeon" class="mw-redirect" title="Radeon">radeon</a>驱动可能会在<code>amdgpu</code>驱动之前加载。 
</p>
<p>确保<code>amdgpu</code>在<a href="/title/Mkinitcpio#MODULES" title="Mkinitcpio">Mkinitcpio#MODULES</a>数组中被设置为第一个模块，例如<code>MODULES=(amdgpu radeon)</code>。
</p>
<h4>
<span id=".E8.AE.BE.E7.BD.AE.E6.89.80.E9.9C.80.E7.9A.84.E6.A8.A1.E5.9D.97.E5.8F.82.E6.95.B0"></span><span class="mw-headline" id="设置所需的模块参数">设置所需的模块参数</span>
</h4>
<p><code>amdgpu</code> 和 <code>radeon</code>模块都需要设置的<a href="/title/Module_parameters" class="mw-redirect" title="Module parameters">module parameters</a>是<code>cik_support=</code> and <code>si_support=</code>。
</p>
<p>它们必需设置为内核参数或者在一个<i>modprobe</i>配置文件中，并且取决于显卡的 GCN 版本。
</p>
<div class="archwiki-template-box archwiki-template-box-tip">
<strong>Tip:</strong> <a href="/title/Dmesg" class="mw-redirect" title="Dmesg">dmesg</a>可能会指示应该使用的正确内核参数: <code>[..] amdgpu 0000:01:00.0: Use radeon.cik_support=0 amdgpu.cik_support=1 to override</code>.</div>
<h5>
<span id=".E5.9C.A8.E5.86.85.E6.A0.B8.E5.91.BD.E4.BB.A4.E8.A1.8C.E4.B8.AD.E8.AE.BE.E7.BD.AE.E6.A8.A1.E5.9D.97.E5.8F.82.E6.95.B0"></span><span class="mw-headline" id="在内核命令行中设置模块参数">在内核命令行中设置模块参数</span>
</h5>
<p>设置以下 <a href="/title/Kernel_parameters" title="Kernel parameters">kernel parameters</a>之一:
</p>
<ul>
<li>Southern Islands (SI): <code>radeon.si_support=0 amdgpu.si_support=1</code>
</li>
<li>Sea Islands (CIK): <code>radeon.cik_support=0 amdgpu.cik_support=1</code>
</li>
</ul>
<h5>
<span id=".E8.AE.BE.E7.BD.AE.E5.86.85.E6.A0.B8.E5.8F.82.E6.95.B0.E5.9C.A8_modprobe.d_.E4.B8.AD"></span><span class="mw-headline" id="设置内核参数在_modprobe.d_中">设置内核参数在 modprobe.d 中</span>
</h5>
<p>在 <code>/etc/modprobe.d/</code>中创建配置 <a href="/title/Modprobe" class="mw-redirect" title="Modprobe">modprobe</a> 文件， 查看 <span class="plainlinks archwiki-template-man" title="$ man 5 modprobe.d"><a rel="nofollow" class="external text" href="https://man.archlinux.org/man/modprobe.d.5">modprobe.d(5)</a></span> 可以了解语法细节。
</p>
<p>对于 Southern Islands (SI) 使用 <code>si_support=1</code> 选项，对于 Sea Islands (CIK) 使用 <code>cik_support=1</code> 选项，就像下面的例子一样:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/modprobe.d/amdgpu.conf</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">options amdgpu si_support=1
options amdgpu cik_support=0</pre>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/modprobe.d/radeon.conf</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">options radeon si_support=0
options radeon cik_support=0</pre>
<p>确保 <code>modconf</code> 添加到 <code>HOOKS</code> 数组中在 <code>/etc/mkinitcpio.conf</code> 和 <a href="/title/Regenerate_the_initramfs" class="mw-redirect" title="Regenerate the initramfs">regenerate the initramfs</a>。
</p>
<h3><span class="mw-headline" id="AMDGPU_PRO">AMDGPU PRO</span></h3>
<p>AMD 提供一个叫 <i>AMDGPU PRO</i> 的专有二进制用户驱动，它工作于开源驱动 AMDGPU 之上。
</p>
<p>From <a rel="nofollow" class="external text" href="https://www.phoronix.com/vr.php?view=27266">Radeon Software 18.50 vs Mesa 19 benchmarks</a> article: When it comes to OpenGL games, the RadeonSI Gallium3D driver simply dominates the proprietary AMD OpenGL driver. About the only advantage to the closed-source AMD OpenGL driver is its support for GL 4.6 while RadeonSI is still limited to GL 4.5 until its SPIR-V ingestion support is completed.
</p>
<p>安装 <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://aur.archlinux.org/packages/amdgpu-pro-libgl/">amdgpu-pro-libgl</a></span><sup><small>AUR</small></sup>软件包， 也可以安装 <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://aur.archlinux.org/packages/lib32-amdgpu-pro-libgl/">lib32-amdgpu-pro-libgl</a></span><sup><small>AUR</small></sup> 软件包提供32位程序支持。
</p>
<h2>
<span id=".E5.8A.A0.E8.BD.BD"></span><span class="mw-headline" id="加载">加载</span>
</h2>
<p>应该会在系统启动时自动加载。
</p>
<p>如果没有自动加载:
</p>
<ul>
<li>如果需要的话，确保 <a href="#%E5%BC%80%E5%90%AF_Southern_Islands_(SI)_and_Sea_Islands_(CIK)_%E6%94%AF%E6%8C%81">#开启 Southern Islands (SI) and Sea Islands (CIK) 支持</a>。</li>
<li>确保你已经安装最新的 <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=linux-firmware">linux-firmware</a></span> 软件包。</li>
<li>确保你没有将 <code>nomodeset</code> 或 <code>vga=</code> 作为内核参数，因为<code>amdgpu</code> 需要 <a href="/title/KMS" class="mw-redirect" title="KMS">KMS</a>。</li>
<li>确保你没有禁用 <code>amdgpu</code> 通过使用 <a href="/title/Kernel_modules#Blacklisting" class="mw-redirect" title="Kernel modules">kernel module blacklisting</a>。</li>
</ul>
<h3><span class="mw-headline" id="Enable_early_KMS">Enable early KMS</span></h3>
<p>See <a href="/title/Kernel_mode_setting#Early_KMS_start" title="Kernel mode setting">Kernel mode setting#Early KMS start</a>.
</p>
<h2><span class="mw-headline" id="Xorg_configuration">Xorg configuration</span></h2>
<p><a href="/title/Xorg" title="Xorg">Xorg</a> will automatically load the driver and it will use your monitor's EDID to set the native resolution. Configuration is only required for tuning the driver.
</p>
<p>If you want manual configuration, create <code>/etc/X11/xorg.conf.d/20-amdgpu.conf</code>, and add the following:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/X11/xorg.conf.d/20-amdgpu.conf</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">Section "Device"
     Identifier "AMD"
     Driver "amdgpu"
 EndSection</pre>
<p>Using this section, you can enable features and tweak the driver settings, see <span class="plainlinks archwiki-template-man" title="$ man 4 amdgpu"><a rel="nofollow" class="external text" href="https://man.archlinux.org/man/amdgpu.4">amdgpu(4)</a></span> first before setting driver options.
</p>
<h3><span class="mw-headline" id="Tear_Free_Rendering">Tear Free Rendering</span></h3>
<p><i>TearFree</i> controls tearing prevention using the hardware page flipping mechanism. If this option is set, the default value of the property is 'on' or 'off' accordingly. If this option isn't set, the default value of the property is auto, which means that TearFree is on for rotated outputs, outputs with RandR transforms applied and for RandR 1.4 slave outputs, otherwise off:
</p>
<pre>Option "TearFree" "true"
</pre>
<h3><span class="mw-headline" id="DRI_level">DRI level</span></h3>
<p><i>DRI</i> sets  the maximum level of DRI to enable. Valid values are <i>2</i> for DRI2 or <i>3</i> for DRI3. The default is <i>3</i> for DRI3 if the <a href="/title/Xorg" title="Xorg">Xorg</a> version is &gt;=  1.18.3, otherwise DRI2 is used:
</p>
<pre>Option "DRI" "3"
</pre>
<h3><span class="mw-headline" id="Variable_refresh_rate">Variable refresh rate</span></h3>
<p>See <a href="/title/Variable_refresh_rate" title="Variable refresh rate">Variable refresh rate</a>.
</p>
<h2><span class="mw-headline" id="Features">Features</span></h2>
<h3><span class="mw-headline" id="Video_acceleration">Video acceleration</span></h3>
<p>See <a href="/title/Hardware_video_acceleration" title="Hardware video acceleration">Hardware video acceleration</a>.
</p>
<h3><span class="mw-headline" id="Overclocking">Overclocking</span></h3>
<p>Since Linux 4.17, it is possible to adjust clocks and voltages of the graphics card via <code>/sys/class/drm/card0/device/pp_od_clk_voltage</code>. It is however required to unlock access to it in sysfs by appending the boot parameter <code>amdgpu.ppfeaturemask=0xffffffff</code>.
</p>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Note:</strong> In sysfs, paths like <code>/sys/class/drm/...</code> are just symlinks and may change between reboots. Persistent locations can be found in <code>/sys/devices/</code>, e.g. <code>/sys/devices/pci0000:00/0000:00:01.0/0000:01:00.0/</code>. Adjust the commands accordingly for a reliable result.</div>
<p>To set the GPU clock for the maximum pstate 7 on e.g. a Polaris GPU to 1209MHz and 900mV voltage, run:
</p>
<pre># echo "s 7 1209 900" &gt; /sys/class/drm/card0/device/pp_od_clk_voltage
</pre>
<p>The same procedure can be applied to the VRAM, e.g. maximum pstate 2 on Polaris 5xx series cards:
</p>
<pre># echo "m 2 1850 850" &gt; /sys/class/drm/card0/device/pp_od_clk_voltage
</pre>
<div class="archwiki-template-box archwiki-template-box-warning">
<strong>Warning:</strong> Double check the entered values, as mistakes might instantly cause fatal hardware damage!</div>
<p>To apply, run
</p>
<pre># echo "c" &gt; /sys/class/drm/card0/device/pp_od_clk_voltage
</pre>
<p>To check if it worked out, read out clocks and voltage under 3D load:
</p>
<pre># watch -n 0.5  cat /sys/kernel/debug/dri/0/amdgpu_pm_info
</pre>
<p>You can reset to the default values using this:
</p>
<pre># echo "r" &gt; /sys/class/drm/card0/device/pp_od_clk_voltage
</pre>
<p>It is also possible to forbid the driver so switch to certain pstates, e.g. to workaround problems with deep powersaving pstates like flickering artifacts or stutter. To force the highest VRAM pstate on a Polaris RX 5xx card, while still allowing the GPU itself to run with lower clocks, run:
</p>
<pre># echo "manual" &gt; /sys/class/drm/card0/device/power_dpm_force_performance_level
# echo "2" &gt;  /sys/class/drm/card0/device/pp_dpm_mclk
</pre>
<p>Allow only the three highest GPU pstates:
</p>
<pre># echo "5 6 7" &gt;  /sys/class/drm/card0/device/pp_dpm_sclk
</pre>
<p>To set the allowed maximum power consumption of the GPU to e.g. 50 Watts, run
</p>
<pre># echo 50000000 &gt; /sys/class/drm/card0/device/hwmon/hwmon0/power1_cap
</pre>
<p>Until Linux kernel 4.20, it will only be possible to decrease the value, not increase.
</p>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Note:</strong> The above procedure was tested with a Polaris RX 560 card. There may be different behavior or bugs with different GPUs.</div>
<h3><span class="mw-headline" id="Enable_GPU_display_scaling">Enable GPU display scaling</span></h3>
<p>To avoid the usage of the scaler which is built in the display, and use the GPU own scaler instead, when not using the native resolution of the monitor, execute:
</p>
<pre>$ xrandr --output "&lt;output&gt;" --set "scaling mode" "&lt;scaling mode&gt;"
</pre>
<p>Possible values for <code>"scaling mode"</code> are: <code>None, Full, Center, Full aspect</code>
</p>
<ul><li>To show the available outputs and settings, execute:</li></ul>
<pre>$ xrandr --prop
</pre>
<ul><li>To set <code>scaling mode = Full aspect</code> for just every available output, execute:</li></ul>
<pre>$ for output in $(xrandr --prop | grep -E -o -i "^[A-Z\-]+-[0-9]+"); do xrandr --output "$output" --set "scaling mode" "Full aspect"; done
</pre>
<h2><span class="mw-headline" id="Troubleshooting">Troubleshooting</span></h2>
<h3>
<span id="Xorg_or_applications_won.27t_start"></span><span class="mw-headline" id="Xorg_or_applications_won't_start">Xorg or applications won't start</span>
</h3>
<ul>
<li>"(EE) AMDGPU(0): [DRI2] DRI2SwapBuffers: drawable has no back or front?" error after opening glxgears, can open Xorg server but OpenGL apps crash.</li>
<li>"(EE) AMDGPU(0): Given depth (32) is not supported by amdgpu driver" error, Xorg won't start.</li>
</ul>
<p>Setting the screen's depth under Xorg to 16 or 32 will cause problems/crash. To avoid that, you should use a standard screen depth of 24 by adding this to your "screen" section:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/X11/xorg.conf.d/10-screen.conf</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">Section "Screen"
       Identifier     "Screen"
       DefaultDepth    24
       SubSection      "Display"
               Depth   24
       EndSubSection
EndSection
</pre>
<h3><span class="mw-headline" id="Screen_artifacts_and_frequency_problem">Screen artifacts and frequency problem</span></h3>
<p><a href="/title/ATI#Dynamic_power_management" title="ATI">Dynamic power management</a> may cause screen artifacts to appear when displaying to monitors at higher frequencies (120+Hz) due to issues in the way GPU clock speeds are managed<a rel="nofollow" class="external autonumber" href="https://bugs.freedesktop.org/show_bug.cgi?id=96868">[1]</a><a rel="nofollow" class="external autonumber" href="https://bugs.freedesktop.org/show_bug.cgi?id=102646">[2]</a>.
</p>
<p>A workaround <a rel="nofollow" class="external autonumber" href="https://bugs.freedesktop.org/show_bug.cgi?id=96868#c13">[3]</a> is saving <code>high</code> or <code>low</code> in <code>/sys/class/drm/card0/device/power_dpm_force_performance_level</code>.
</p>
<p>There is also a GUI solution <a rel="nofollow" class="external autonumber" href="https://github.com/marazmista/radeon-profile">[4]</a> where you can manage the "power_dpm" with <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://aur.archlinux.org/packages/radeon-profile-git/">radeon-profile-git</a></span><sup><small>AUR</small></sup> and <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://aur.archlinux.org/packages/radeon-profile-daemon-git/">radeon-profile-daemon-git</a></span><sup><small>AUR</small></sup>.
</p>
<h3>
<span id="R9_390_series_Poor_Performance_and.2For_Instability"></span><span class="mw-headline" id="R9_390_series_Poor_Performance_and/or_Instability">R9 390 series Poor Performance and/or Instability</span>
</h3>
<p>If you experience issues <a rel="nofollow" class="external autonumber" href="https://bugs.freedesktop.org/show_bug.cgi?id=91880">[5]</a> with a AMD R9 390 series graphics card, set <code>radeon.cik_support=0 radeon.si_support=0 amdgpu.cik_support=1 amdgpu.si_support=1 amdgpu.dpm=1 amdgpu.dc=1</code> as <a href="/title/Kernel_parameters" title="Kernel parameters">kernel parameters</a> to force the use of amdgpu driver instead of radeon.
</p>
<p>If it still does not work, try disabling DPM, by setting the <a href="/title/Kernel_parameters" title="Kernel parameters">kernel parameters</a> to: <code>radeon.cik_support=0 radeon.si_support=0 amdgpu.cik_support=1 amdgpu.si_support=1</code>
</p>
<h3>
<span id="Freezes_with_.22.5Bdrm.5D_IP_block:gmc_v8_0_is_hung.21.22_kernel_error"></span><span class="mw-headline" id='Freezes_with_"[drm]_IP_block:gmc_v8_0_is_hung!"_kernel_error'>Freezes with "[drm] IP block:gmc_v8_0 is hung!" kernel error</span>
</h3>
<p>If you experience freezes and kernel crashes during a GPU intensive task with the kernel error " [drm] IP block:gmc_v8_0 is hung!" <a rel="nofollow" class="external autonumber" href="https://bugs.freedesktop.org/show_bug.cgi?id=102322">[6]</a>, a workaround is to set <code>amdgpu.vm_update_mode=3</code> as <a href="/title/Kernel_parameters" title="Kernel parameters">kernel parameters</a> to force the GPUVM page tables update to be done using the CPU. Downsides are listed here <a rel="nofollow" class="external autonumber" href="https://bugs.freedesktop.org/show_bug.cgi?id=102322#c15">[7]</a>.
</p>
<h3><span class="mw-headline" id="Cursor_corruption">Cursor corruption</span></h3>
<p>If you experience issues with the mouse cursor sometimes not rendering properly, set <code>Option "SWCursor" "True"</code> in the <code>"Device"</code> section of the <code>/etc/X11/xorg.conf.d/20-amdgpu.conf</code> configuration file.
</p>
<p>If you are using <code>xrandr</code> for scaling and the cursor is flickering or disappearing, you may be able to fix it by setting the <code>TearFree</code> property: <code>xrandr --output HDMI-A-0 --set TearFree on</code>.
</p>
</div>
</div>
<div id="catlinks" class="catlinks" data-mw="interface"><div id="mw-normal-catlinks" class="mw-normal-catlinks">
<a href="/title/Special:Categories" title="Special:Categories">Categories</a>: <ul>
<li><a href="/title/Category:Graphics_(%E7%AE%80%E4%BD%93%E4%B8%AD%E6%96%87)" title="Category:Graphics (简体中文)">Graphics (简体中文)</a></li>
<li><a href="/title/Category:X_server_(%E7%AE%80%E4%BD%93%E4%B8%AD%E6%96%87)" title="Category:X server (简体中文)">X server (简体中文)</a></li>
</ul>
</div></div>
	</div>
</div>

<footer id="footer" class="mw-footer" role="contentinfo" style="margin: 0">
	<ul id="footer-info">
		<li>Retrieved from "<a dir="ltr" href="https://wiki.archlinux.org/index.php?title=AMDGPU_(%E7%AE%80%E4%BD%93%E4%B8%AD%E6%96%87)&amp;oldid=664138">https://wiki.archlinux.org/index.php?title=AMDGPU_(简体中文)&amp;oldid=664138</a>"</li>
		<li id="footer-info-lastmod"> This page was last edited on 25 April 2021, at 08:21.</li>
		<li id="footer-info-copyright">Content is available under <a class="external" rel="nofollow" href="http://www.gnu.org/copyleft/fdl.html">GNU Free Documentation License 1.3 or later</a> unless otherwise noted.</li>
	<br>
</ul>
	<ul id="footer-places">
		<li id="footer-places-privacy"><a href="/title/ArchWiki:Privacy_policy" title="ArchWiki:Privacy policy">Privacy policy</a></li>
		<li id="footer-places-about"><a href="/title/ArchWiki:About" title="ArchWiki:About">About ArchWiki</a></li>
		<li id="footer-places-disclaimer"><a href="/title/ArchWiki:General_disclaimer" title="ArchWiki:General disclaimer">Disclaimers</a></li>
	</ul>
	<ul id="footer-icons" class="noprint">
		<li id="footer-copyrightico">
	</ul>
	<div style="clear: both;"></div>
</footer>



</body>
</html>
