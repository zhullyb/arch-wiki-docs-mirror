<!DOCTYPE html>
<html class="client-nojs" lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<title>WPS Office (简体中文) - ArchWiki</title>
<link rel="stylesheet" href="../ArchWikiOffline.css">
<meta name="ResourceLoaderDynamicStyles" content="">
<meta name="generator" content="MediaWiki 1.35.0">
<meta name="referrer" content="no-referrer-when-downgrade">
<meta name="robots" content="noindex,follow">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="shortcut icon" href="/favicon.ico">
<link rel="search" type="application/opensearchdescription+xml" href="/opensearch_desc.php" title="ArchWiki (en)">
<link rel="EditURI" type="application/rsd+xml" href="https://wiki.archlinux.org/api.php?action=rsd">
<link rel="license" href="http://www.gnu.org/copyleft/fdl.html">
<link rel="alternate" type="application/atom+xml" title="ArchWiki Atom feed" href="/index.php?title=Special:RecentChanges&amp;feed=atom">
</head>
<body class="mediawiki ltr sitedir-ltr mw-hide-empty-elt ns-0 ns-subject page-WPS_Office_简体中文 rootpage-WPS_Office_简体中文 skin-vector action-view skin-vector-legacy">
<div id="content" class="mw-body" role="main" style="margin: 0">
	<a id="top"></a>
	<div id="siteNotice" class="mw-body-content"></div>
	<div class="mw-indicators mw-body-content">
	</div>
	<h1 id="firstHeading" class="firstHeading" lang="en">WPS Office (简体中文)</h1>
	<div id="bodyContent" class="mw-body-content">
		<div id="siteSub" class="noprint">From ArchWiki</div>
		<div id="contentSub"></div>
		<div id="contentSub2"></div>
		
		<div id="jump-to-nav"></div>
		<a class="mw-jump-link" href="#mw-head">Jump to navigation</a>
		<a class="mw-jump-link" href="#searchInput">Jump to search</a>
		<div id="mw-content-text" lang="en" dir="ltr" class="mw-content-ltr">
<div class="warningbox">The printable version is no longer supported and may have rendering errors. Please update your browser bookmarks and please use the default browser print function instead.</div>
<div class="mw-parser-output">
<p><a rel="nofollow" class="external text" href="http://linux.wps.cn/">WPS Office for Linux</a> 是金山公司推出的、运行于 Linux 平台上的全功能办公软件。与 Microsoft Office 高度兼容，且更加尊重 Linux 用户特定的使用习惯，并自带方正字体集。
</p>
<div id="toc" class="toc" role="navigation" aria-labelledby="mw-toc-heading">
<input type="checkbox" role="button" id="toctogglecheckbox" class="toctogglecheckbox" style="display:none"><div class="toctitle" lang="en" dir="ltr">
<h2 id="mw-toc-heading">Contents</h2>
<span class="toctogglespan"><label class="toctogglelabel" for="toctogglecheckbox"></label></span>
</div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#%E5%AE%89%E8%A3%85"><span class="tocnumber">1</span> <span class="toctext">安装</span></a></li>
<li class="toclevel-1 tocsection-2">
<a href="#%E6%8F%90%E7%A4%BA%E4%B8%8E%E6%8A%80%E5%B7%A7"><span class="tocnumber">2</span> <span class="toctext">提示与技巧</span></a>
<ul>
<li class="toclevel-2 tocsection-3"><a href="#%E4%BF%AE%E6%94%B9_WPS_%E6%96%87%E4%BB%B6%E5%9B%BE%E6%A0%87%E4%BB%A5%E5%8F%8A%E6%96%87%E4%BB%B6%E5%85%B3%E8%81%94"><span class="tocnumber">2.1</span> <span class="toctext">修改 WPS 文件图标以及文件关联</span></a></li>
<li class="toclevel-2 tocsection-4">
<a href="#%E4%BD%BF%E7%94%A8_GTK+_UI"><span class="tocnumber">2.2</span> <span class="toctext">使用 GTK+ UI</span></a>
<ul>
<li class="toclevel-3 tocsection-5"><a href="#%E4%BF%AE%E6%94%B9%E5%90%AF%E5%8A%A8_desktop_%E6%96%87%E4%BB%B6"><span class="tocnumber">2.2.1</span> <span class="toctext">修改启动 desktop 文件</span></a></li>
<li class="toclevel-3 tocsection-6">
<a href="#%E4%BF%AE%E6%94%B9%E5%90%AF%E5%8A%A8%E8%84%9A%E6%9C%AC"><span class="tocnumber">2.2.2</span> <span class="toctext">修改启动脚本</span></a>
<ul>
<li class="toclevel-4 tocsection-7"><a href="#%E6%89%8B%E5%8A%A8%E4%BF%AE%E5%A4%8D_%E9%87%91%E5%B1%B1_PDF_%E5%90%AF%E5%8A%A8%E8%84%9A%E6%9C%AC"><span class="tocnumber">2.2.2.1</span> <span class="toctext">手动修复 金山 PDF 启动脚本</span></a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toclevel-1 tocsection-8">
<a href="#%E7%96%91%E9%9A%BE%E8%A7%A3%E7%AD%94"><span class="tocnumber">3</span> <span class="toctext">疑难解答</span></a>
<ul>
<li class="toclevel-2 tocsection-9"><a href="#Zip_%E6%A8%A1%E6%9D%BF%E5%8E%8B%E7%BC%A9%E5%8C%85%E4%B9%B1%E7%A0%81"><span class="tocnumber">3.1</span> <span class="toctext">Zip 模板压缩包乱码</span></a></li>
<li class="toclevel-2 tocsection-10"><a href="#%E5%85%AC%E5%BC%8F%E6%97%A0%E6%B3%95%E6%AD%A3%E5%B8%B8%E6%98%BE%E7%A4%BA"><span class="tocnumber">3.2</span> <span class="toctext">公式无法正常显示</span></a></li>
<li class="toclevel-2 tocsection-11"><a href="#KDE%E4%B8%ADMicrosoft_Office%E6%96%87%E4%BB%B6%E6%A0%BC%E5%BC%8F%E8%A2%AB%E8%AF%86%E5%88%AB%E4%B8%BAZip"><span class="tocnumber">3.3</span> <span class="toctext">KDE中Microsoft Office文件格式被识别为Zip</span></a></li>
<li class="toclevel-2 tocsection-12"><a href="#Fcitx5_%E6%97%A0%E6%B3%95%E8%BE%93%E5%85%A5%E4%B8%AD%E6%96%87"><span class="tocnumber">3.4</span> <span class="toctext">Fcitx5 无法输入中文</span></a></li>
<li class="toclevel-2 tocsection-13"><a href="#GNOME%E6%A1%8C%E9%9D%A2%E7%8E%AF%E5%A2%83%E4%B8%AD%E4%BD%BF%E7%94%A8%E6%9A%97%E8%89%B2%E4%B8%BB%E9%A2%98%E6%97%B6%E4%B8%8D%E6%AD%A3%E5%B8%B8%E6%98%BE%E7%A4%BA"><span class="tocnumber">3.5</span> <span class="toctext">GNOME桌面环境中使用暗色主题时不正常显示</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-14"><a href="#%E5%8F%82%E8%A7%81"><span class="tocnumber">4</span> <span class="toctext">参见</span></a></li>
</ul>
</div>

<h2>
<span id=".E5.AE.89.E8.A3.85"></span><span class="mw-headline" id="安装">安装</span>
</h2>
<p>WPS Office for Linux 分为国内版和国际版，国内版：<span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://aur.archlinux.org/packages/wps-office-cn/">wps-office-cn</a></span><sup><small>AUR</small></sup>，国际版：<span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://aur.archlinux.org/packages/wps-office/">wps-office</a></span><sup><small>AUR</small></sup>。 
</p>
<p>中文使用者还需要安装中文语言包：<span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://aur.archlinux.org/packages/wps-office-mui-zh-cn/">wps-office-mui-zh-cn</a></span><sup><small>AUR</small></sup>，此外可选安装 WPS 需要的符号字体：<span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://aur.archlinux.org/packages/ttf-wps-fonts/">ttf-wps-fonts</a></span><sup><small>AUR</small></sup>。
</p>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>注意：</strong> 请留意自带字体的版权状况，可阅读 <a rel="nofollow" class="external text" href="http://community.wps.cn/wiki/WPS_Office_Linux%E7%89%88%E6%9C%80%E7%BB%88%E7%94%A8%E6%88%B7%E5%8D%8F%E8%AE%AE">WPS Office for Linux 最终用户协议</a> 第十四条</div>
<p><code>wps</code>、<code>et</code>、<code>wpp</code>、<code>wpspdf</code> 分别为启动 WPS 文字、WPS 表格、WPS 演示、WPS PDF 的命令。
</p>
<h2>
<span id=".E6.8F.90.E7.A4.BA.E4.B8.8E.E6.8A.80.E5.B7.A7"></span><span class="mw-headline" id="提示与技巧">提示与技巧</span>
</h2>
<h3>
<span id=".E4.BF.AE.E6.94.B9_WPS_.E6.96.87.E4.BB.B6.E5.9B.BE.E6.A0.87.E4.BB.A5.E5.8F.8A.E6.96.87.E4.BB.B6.E5.85.B3.E8.81.94"></span><span class="mw-headline" id="修改_WPS_文件图标以及文件关联">修改 WPS 文件图标以及文件关联</span>
</h3>
<p>安装 WPS 后，您所用 icon-theme 中的 DOC、XLS、PPT 等文件会被替换成 WPS Office 所自带的 WPS 文字、ET 表格、WPP 演示等图标。如果您并不需要，可自行修改相关的 mime 配置文件：
</p>
<pre>/usr/share/mime/packages/wps-office-{wpp,wps,et}.xml
/usr/share/mime/packages/freedesktop.org.xml #(属于软件包shared-mime-info)
</pre>
<p>以及 desktop 文件：
</p>
<pre>/usr/share/applications/wps-office-{wpp,wps,et}.desktop
</pre>
<p>处理策略：WPS 自己的格式由 <code>wps-office-{wpp,wps,et}.xml</code> 定义，其他的用 <code>freedesktop.org.xml</code> 定义。同时修改 <code>desktop</code> 文件的 <code>MimeType</code> 项。
</p>
<p>在 PKGBUILD 文件中的 <code>package</code> 函数添加以下语句：
</p>
<pre>##et wpp wps 支持的MimeType
    _etMT="MimeType=application\/wps-office.et;application\/wps-office.ett;application\/vnd.ms-excel;\
application\/vnd.openxmlformats-officedocument.spreadsheetml.template;\
application\/vnd.openxmlformats-officedocument.spreadsheetml.sheet;"
    _wppMT="MimeType=application\/wps-office.dps;application\/wps-office.dpt;application\/vnd.ms-powerpoint;\
application\/vnd.openxmlformats-officedocument.presentationml.presentation;\
application\/vnd.openxmlformats-officedocument.presentationml.slideshow;\
application\/vnd.openxmlformats-officedocument.presentationml.template;"
    _wpsMT="MimeType=application\/wps-office.wps;application\/wps-office.wpt;\
application\/msword;application\/rtf;application\/msword-template;\
application\/vnd.openxmlformats-officedocument.wordprocessingml.template;\
application\/vnd.openxmlformats-officedocument.wordprocessingml.document;"

    ##mime
    sed -i '3,31d' $pkgdir/usr/share/mime/packages/wps-office-et.xml
    sed -i '3,36d' $pkgdir/usr/share/mime/packages/wps-office-wpp.xml
    sed -i '3,30d' $pkgdir/usr/share/mime/packages/wps-office-wps.xml

    ##desktop
    #_et
    sed -i "s/^MimeType.*$/$_etMT/" $pkgdir/usr/share/applications/wps-office-et.desktop
    #_wpp
    sed -i "s/^MimeType.*$/$_wppMT/" $pkgdir/usr/share/applications/wps-office-wpp.desktop
    #_wps
    sed -i "s/^MimeType.*$/$_wpsMT/" $pkgdir/usr/share/applications/wps-office-wps.desktop</pre>
<h3>
<span id=".E4.BD.BF.E7.94.A8_GTK.2B_UI"></span><span class="mw-headline" id="使用_GTK+_UI">使用 GTK+ UI</span>
</h3>
<p>WPS 默认的 UI 为 Qt，事实上其捆绑的 Qt 为 4.7.4，从而因为版本不符，无法正常加载 qtcurve 之类的主题。但我们可以改为 <a href="/title/Qt_(%E7%AE%80%E4%BD%93%E4%B8%AD%E6%96%87)#Qt5" title="Qt (简体中文)">GTK+</a>，直接加上参数 <code>-style gtk+</code> 即可。
</p>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Note:</strong> 使用使用 <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://aur.archlinux.org/packages/qt4/">qt4</a></span><sup><small>AUR</small></sup> 提供的 Qt 配置工具<i>qtconfig-qt4</i>，将GUI Style更改为GTK+也有效果</div>
<h4>
<span id=".E4.BF.AE.E6.94.B9.E5.90.AF.E5.8A.A8_desktop_.E6.96.87.E4.BB.B6"></span><span class="mw-headline" id="修改启动_desktop_文件">修改启动 desktop 文件</span>
</h4>
<p>修改 <code>/usr/share/applications/</code> 下以 wps-office 开头的 desktop 文件：
</p>
<div class="archwiki-template-box archwiki-template-box-tip">
<strong>提示：</strong> 如果你使用的 flatpak 安装的应用，请查看 <code>/var/lib/flatpak/exports/share/applications</code> 目录</div>
<p>找到 Exec 行，在 %f 前添加启动参数：
</p>
<pre>-style=gtk+
</pre>
<p>为避免软件更新后，修改被覆盖，可以选择拷贝所有需要修改的 desktop 文件到 <code>~/.local/share/applications/</code> 后，再做修改。
</p>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>注意：</strong> 在修改 desktop 后请运行 <code>update-desktop-database ~/.local/share/applications/</code> 命令刷新菜单缓存（该命令的参数是存放已修改过的 desktop 文件的目录）</div>
<h4>
<span id=".E4.BF.AE.E6.94.B9.E5.90.AF.E5.8A.A8.E8.84.9A.E6.9C.AC"></span><span class="mw-headline" id="修改启动脚本">修改启动脚本</span>
</h4>
<p>修改 /usr/bin/ 目录下的 et、wpp、wps 启动脚本文件  
</p>
<p>删除该行（如果有的话）：
</p>
<pre>gOptExt=
</pre>
<p>然后添加：
</p>
<pre>gOptExt="-style=gtk+"
export GTK2_RC_FILES=/usr/share/themes/Adwaita/gtk-2.0/gtkrc
</pre>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>注意：</strong> 在 export 参数中可以导入其他支持GTK2的主题，对于应用界面将会呈现不一样的效果</div>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>注意：</strong> 对于 金山 PDF （WPS PDF） 应用，可能存在启动脚本缺失的情况，请参考下节解决方案</div>
<h5>
<span id=".E6.89.8B.E5.8A.A8.E4.BF.AE.E5.A4.8D_.E9.87.91.E5.B1.B1_PDF_.E5.90.AF.E5.8A.A8.E8.84.9A.E6.9C.AC"></span><span class="mw-headline" id="手动修复_金山_PDF_启动脚本">手动修复 金山 PDF 启动脚本</span>
</h5>
<p>金山 PDF 提供的启动脚本缺失了对 GTK 的自定义配置
可以在其启动脚本 /usr/bin/wpspdf 开始位置添加： 
</p>
<pre>gOptExt="-style=gtk+"
export GTK2_RC_FILES=/usr/share/themes/Adwaita/gtk-2.0/gtkrc
</pre>
<p>并在其后的 run 函数中添加 <code>${gOptExt}</code>，修改后的 run 函数如下：
</p>
<pre>function run()
{
	if [ -e "${gInstallPath}/office6/${gApp}" ] ; then
		{ ${gInstallPath}/office6/${gApp} ${gOptExt} "$@"; } &gt;/dev/null 2&gt;&amp;1
	else
		echo "${gApp} does not exist!"
	fi
}
</pre>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Note:</strong> 由于每次升级可能导致文件修改遗失，可以考虑将 et、wpp、wps 文件复制到其他目录（例如：<code>~/.local/bin/</code>），并将其添加到 <a href="/title/Environment_variables" title="Environment variables">Environment variables</a>
</div>
<h2>
<span id=".E7.96.91.E9.9A.BE.E8.A7.A3.E7.AD.94"></span><span class="mw-headline" id="疑难解答">疑难解答</span>
</h2>
<h3>
<span id="Zip_.E6.A8.A1.E6.9D.BF.E5.8E.8B.E7.BC.A9.E5.8C.85.E4.B9.B1.E7.A0.81"></span><span class="mw-headline" id="Zip_模板压缩包乱码">Zip 模板压缩包乱码</span>
</h3>
<p>请先安装 <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://aur.archlinux.org/packages/unzip-iconv/">unzip-iconv</a></span><sup><small>AUR</small></sup>，解压时用参数 <code>-O gb18030</code> 即可。
</p>
<h3>
<span id=".E5.85.AC.E5.BC.8F.E6.97.A0.E6.B3.95.E6.AD.A3.E5.B8.B8.E6.98.BE.E7.A4.BA"></span><span class="mw-headline" id="公式无法正常显示">公式无法正常显示</span>
</h3>
<p>大部分数学公式的正常显示需要以下字体：
</p>
<pre>symbol.ttf webdings.ttf wingding.ttf wingdng2.ttf wingdng3.ttf monotypesorts.ttf MTExtra.ttf
</pre>
<p><a href="/title/AUR_(%E7%AE%80%E4%BD%93%E4%B8%AD%E6%96%87)" class="mw-redirect" title="AUR (简体中文)">AUR (简体中文)</a> 中的 <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://aur.archlinux.org/packages/ttf-wps-fonts/">ttf-wps-fonts</a></span><sup><small>AUR</small></sup> 包含了除monotypesorts.ttf之外的字体，直接安装即可。
</p>
<h3>
<span id="KDE.E4.B8.ADMicrosoft_Office.E6.96.87.E4.BB.B6.E6.A0.BC.E5.BC.8F.E8.A2.AB.E8.AF.86.E5.88.AB.E4.B8.BAZip"></span><span class="mw-headline" id="KDE中Microsoft_Office文件格式被识别为Zip">KDE中Microsoft Office文件格式被识别为Zip</span>
</h3>
<p>在安装完成wps之后，系统的Microsoft Office文件格式会被识别为zip，无法与wps关联，可以通过删除/usr/share/mime/packages/下的mime文件即可修改格式识别：
</p>
<pre>sudo rm /usr/share/mime/packages/wps-office-*.xml
sudo update-mime-database /usr/share/mime
</pre>
<h3>
<span id="Fcitx5_.E6.97.A0.E6.B3.95.E8.BE.93.E5.85.A5.E4.B8.AD.E6.96.87"></span><span class="mw-headline" id="Fcitx5_无法输入中文">Fcitx5 无法输入中文</span>
</h3>
<p>该问题在国内版 <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://aur.archlinux.org/packages/wps-office-cn/">wps-office-cn</a></span><sup><small>AUR</small></sup> 11.1.0.9604-1 版本更新后部分用户出现，于 <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://aur.archlinux.org/packages/wps-office-cn/">wps-office-cn</a></span><sup><small>AUR</small></sup> 11.1.0.9615-1 版本修复，但是部分用户仍然需要修改环境变量（例如 <code>.xprofile</code> 文件）<a rel="nofollow" class="external autonumber" href="https://github.com/fcitx/fcitx5/issues/83">[1]</a>：
</p>
<pre>export QT_IM_MODULE=fcitx5
</pre>
<h3>
<span id="GNOME.E6.A1.8C.E9.9D.A2.E7.8E.AF.E5.A2.83.E4.B8.AD.E4.BD.BF.E7.94.A8.E6.9A.97.E8.89.B2.E4.B8.BB.E9.A2.98.E6.97.B6.E4.B8.8D.E6.AD.A3.E5.B8.B8.E6.98.BE.E7.A4.BA"></span><span class="mw-headline" id="GNOME桌面环境中使用暗色主题时不正常显示">GNOME桌面环境中使用暗色主题时不正常显示</span>
</h3>
<p>在暗色主题下，WPS 的字体跟随系统主题，导致字体颜色与背景为同色，无法看清。  
</p>
<p>关于此问题可参考上面的章节：<a href="/title/WPS_Office_(%E7%AE%80%E4%BD%93%E4%B8%AD%E6%96%87)#%E4%BD%BF%E7%94%A8_GTK+_UI" title="WPS Office (简体中文)">使用_GTK+_UI</a>  
</p>
<h2>
<span id=".E5.8F.82.E8.A7.81"></span><span class="mw-headline" id="参见">参见</span>
</h2>
<ul><li><a rel="nofollow" class="external text" href="https://forum.manjaro.org/t/how-to-associate-all-microsoft-office-files-to-wps-office-applications/33528/6">How to associate all Microsoft office files to WPS office applications?</a></li></ul>
</div>
</div>
<div id="catlinks" class="catlinks" data-mw="interface"><div id="mw-normal-catlinks" class="mw-normal-catlinks">
<a href="/title/Special:Categories" title="Special:Categories">Category</a>: <ul><li><a href="/title/Category:Office_(%E7%AE%80%E4%BD%93%E4%B8%AD%E6%96%87)" title="Category:Office (简体中文)">Office (简体中文)</a></li></ul>
</div></div>
	</div>
</div>

<footer id="footer" class="mw-footer" role="contentinfo" style="margin: 0">
	<ul id="footer-info">
		<li>Retrieved from "<a dir="ltr" href="https://wiki.archlinux.org/index.php?title=WPS_Office_(%E7%AE%80%E4%BD%93%E4%B8%AD%E6%96%87)&amp;oldid=670397">https://wiki.archlinux.org/index.php?title=WPS_Office_(简体中文)&amp;oldid=670397</a>"</li>
		<li id="footer-info-lastmod"> This page was last edited on 11 May 2021, at 01:05.</li>
		<li id="footer-info-copyright">Content is available under <a class="external" rel="nofollow" href="http://www.gnu.org/copyleft/fdl.html">GNU Free Documentation License 1.3 or later</a> unless otherwise noted.</li>
	<br>
</ul>
	<ul id="footer-places">
		<li id="footer-places-privacy"><a href="/title/ArchWiki:Privacy_policy" title="ArchWiki:Privacy policy">Privacy policy</a></li>
		<li id="footer-places-about"><a href="/title/ArchWiki:About" title="ArchWiki:About">About ArchWiki</a></li>
		<li id="footer-places-disclaimer"><a href="/title/ArchWiki:General_disclaimer" title="ArchWiki:General disclaimer">Disclaimers</a></li>
	</ul>
	<ul id="footer-icons" class="noprint">
		<li id="footer-copyrightico">
	</ul>
	<div style="clear: both;"></div>
</footer>



</body>
</html>
