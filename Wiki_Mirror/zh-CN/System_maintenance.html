<!DOCTYPE html>
<html class="client-nojs" lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<title>System maintenance (简体中文) - ArchWiki</title>
<link rel="stylesheet" href="../ArchWikiOffline.css">
<meta name="ResourceLoaderDynamicStyles" content="">
<meta name="generator" content="MediaWiki 1.35.0">
<meta name="robots" content="noindex,follow">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="shortcut icon" href="/favicon.ico">
<link rel="search" type="application/opensearchdescription+xml" href="/opensearch_desc.php" title="ArchWiki (en)">
<link rel="EditURI" type="application/rsd+xml" href="https://wiki.archlinux.org/api.php?action=rsd">
<link rel="license" href="http://www.gnu.org/copyleft/fdl.html">
<link rel="alternate" type="application/atom+xml" title="ArchWiki Atom feed" href="/index.php?title=Special:RecentChanges&amp;feed=atom">
</head>
<body class="mediawiki ltr sitedir-ltr mw-hide-empty-elt ns-0 ns-subject page-System_maintenance_简体中文 rootpage-System_maintenance_简体中文 skin-vector action-view skin-vector-legacy">
<div id="content" class="mw-body" role="main" style="margin: 0">
	<a id="top"></a>
	<div id="siteNotice" class="mw-body-content"></div>
	<div class="mw-indicators mw-body-content">
	</div>
	<h1 id="firstHeading" class="firstHeading" lang="en">System maintenance (简体中文)</h1>
	<div id="bodyContent" class="mw-body-content">
		<div id="siteSub" class="noprint">From ArchWiki</div>
		<div id="contentSub"></div>
		<div id="contentSub2"></div>
		
		<div id="jump-to-nav"></div>
		<a class="mw-jump-link" href="#mw-head">Jump to navigation</a>
		<a class="mw-jump-link" href="#searchInput">Jump to search</a>
		<div id="mw-content-text" lang="en" dir="ltr" class="mw-content-ltr">
<div class="warningbox">The printable version is no longer supported and may have rendering errors. Please update your browser bookmarks and please use the default browser print function instead.</div>
<div class="mw-parser-output">
<div class="archwiki-template-meta-related-articles-start">
<p>相关文章</p>
<ul>
<li><a href="../zh-CN/General_recommendations.html" title="General recommendations (简体中文)">General recommendations (简体中文)</a></li>
</ul>
</div>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>翻译状态：</strong>本文是 <a href="../en/System_maintenance.html" title="System maintenance">System_maintenance</a> 的<a href="../zh-CN/ArchWiki:Translation_Team.html" title="ArchWiki:Translation Team (简体中文)">翻译</a>。上次翻译日期：2018-11-02。如果英文版本有所<a rel="nofollow" class="external text" href="https://wiki.archlinux.org/index.php?title=System_maintenance&amp;diff=0&amp;oldid=546559">更改</a>，则您可以帮助同步翻译。</div>
<p>要持续使用 Arch linux，需要进行系统日常维护，每个用户都应该及时维护系统。
</p>
<div id="toc" class="toc" role="navigation" aria-labelledby="mw-toc-heading">
<input type="checkbox" role="button" id="toctogglecheckbox" class="toctogglecheckbox" style="display:none"><div class="toctitle" lang="en" dir="ltr">
<h2 id="mw-toc-heading">Contents</h2>
<span class="toctogglespan"><label class="toctogglelabel" for="toctogglecheckbox"></label></span>
</div>
<ul>
<li class="toclevel-1 tocsection-1">
<a href="#%E6%A3%80%E6%9F%A5%E9%94%99%E8%AF%AF"><span class="tocnumber">1</span> <span class="toctext">检查错误</span></a>
<ul>
<li class="toclevel-2 tocsection-2"><a href="#systemd_%E6%9C%8D%E5%8A%A1%E9%97%AE%E9%A2%98"><span class="tocnumber">1.1</span> <span class="toctext">systemd 服务问题</span></a></li>
<li class="toclevel-2 tocsection-3"><a href="#%E6%97%A5%E5%BF%97%E6%96%87%E4%BB%B6"><span class="tocnumber">1.2</span> <span class="toctext">日志文件</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-4">
<a href="#%E5%A4%87%E4%BB%BD"><span class="tocnumber">2</span> <span class="toctext">备份</span></a>
<ul>
<li class="toclevel-2 tocsection-5"><a href="#%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6"><span class="tocnumber">2.1</span> <span class="toctext">配置文件</span></a></li>
<li class="toclevel-2 tocsection-6"><a href="#%E5%AE%89%E8%A3%85%E7%9A%84%E8%BD%AF%E4%BB%B6%E5%8C%85"><span class="tocnumber">2.2</span> <span class="toctext">安装的软件包</span></a></li>
<li class="toclevel-2 tocsection-7"><a href="#Pacman_%E6%95%B0%E6%8D%AE%E5%BA%93"><span class="tocnumber">2.3</span> <span class="toctext">Pacman 数据库</span></a></li>
<li class="toclevel-2 tocsection-8"><a href="#LUKS_headers"><span class="tocnumber">2.4</span> <span class="toctext">LUKS headers</span></a></li>
<li class="toclevel-2 tocsection-9"><a href="#%E7%B3%BB%E7%BB%9F%E5%92%8C%E7%94%A8%E6%88%B7%E6%95%B0%E6%8D%AE"><span class="tocnumber">2.5</span> <span class="toctext">系统和用户数据</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-10">
<a href="#%E6%9B%B4%E6%96%B0%E7%B3%BB%E7%BB%9F"><span class="tocnumber">3</span> <span class="toctext">更新系统</span></a>
<ul>
<li class="toclevel-2 tocsection-11"><a href="#%E5%8D%87%E7%BA%A7%E5%89%8D%E7%9A%84%E5%87%86%E5%A4%87"><span class="tocnumber">3.1</span> <span class="toctext">升级前的准备</span></a></li>
<li class="toclevel-2 tocsection-12"><a href="#%E9%81%BF%E5%85%8D%E6%9F%90%E4%BA%9B_Pacman_%E5%91%BD%E4%BB%A4"><span class="tocnumber">3.2</span> <span class="toctext">避免某些 Pacman 命令</span></a></li>
<li class="toclevel-2 tocsection-13"><a href="#%E4%B8%8D%E6%94%AF%E6%8C%81%E9%83%A8%E5%88%86%E5%8D%87%E7%BA%A7"><span class="tocnumber">3.3</span> <span class="toctext">不支持部分升级</span></a></li>
<li class="toclevel-2 tocsection-14"><a href="#%E6%B3%A8%E6%84%8F%E6%9B%B4%E6%96%B0%E6%97%B6%E7%9A%84%E6%8F%90%E9%86%92"><span class="tocnumber">3.4</span> <span class="toctext">注意更新时的提醒</span></a></li>
<li class="toclevel-2 tocsection-15"><a href="#%E5%A4%84%E7%90%86%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6%E6%9B%B4%E6%96%B0"><span class="tocnumber">3.5</span> <span class="toctext">处理配置文件更新</span></a></li>
<li class="toclevel-2 tocsection-16"><a href="#%E5%9B%9E%E9%80%80%E6%9C%89%E9%97%AE%E9%A2%98%E7%9A%84%E6%9B%B4%E6%96%B0"><span class="tocnumber">3.6</span> <span class="toctext">回退有问题的更新</span></a></li>
<li class="toclevel-2 tocsection-17"><a href="#%E6%A3%80%E6%9F%A5%E5%AD%A4%E7%AB%8B%E5%92%8C%E6%9C%AA%E4%BD%BF%E7%94%A8%E8%BD%AF%E4%BB%B6%E5%8C%85"><span class="tocnumber">3.7</span> <span class="toctext">检查孤立和未使用软件包</span></a></li>
<li class="toclevel-2 tocsection-18"><a href="#%E4%BD%BF%E7%94%A8%E5%8C%85%E7%AE%A1%E7%90%86%E5%99%A8%E5%AE%89%E8%A3%85%E8%BD%AF%E4%BB%B6"><span class="tocnumber">3.8</span> <span class="toctext">使用包管理器安装软件</span></a></li>
<li class="toclevel-2 tocsection-19"><a href="#%E9%80%89%E6%8B%A9%E5%BC%80%E6%BA%90%E9%A9%B1%E5%8A%A8"><span class="tocnumber">3.9</span> <span class="toctext">选择开源驱动</span></a></li>
<li class="toclevel-2 tocsection-20"><a href="#%E8%B0%A8%E6%85%8E%E4%BD%BF%E7%94%A8%E9%9D%9E%E5%AE%98%E6%96%B9%E6%88%96%E6%B5%8B%E8%AF%95%E4%B8%8D%E8%B6%B3%E7%9A%84%E8%BD%AF%E4%BB%B6%E5%8C%85"><span class="tocnumber">3.10</span> <span class="toctext">谨慎使用非官方或测试不足的软件包</span></a></li>
<li class="toclevel-2 tocsection-21"><a href="#%E6%9B%B4%E6%96%B0%E9%95%9C%E5%83%8F%E5%88%97%E8%A1%A8"><span class="tocnumber">3.11</span> <span class="toctext">更新镜像列表</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-22">
<a href="#%E6%B8%85%E7%90%86%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F"><span class="tocnumber">4</span> <span class="toctext">清理文件系统</span></a>
<ul>
<li class="toclevel-2 tocsection-23"><a href="#%E8%BD%AF%E4%BB%B6%E5%8C%85%E7%BC%93%E5%AD%98"><span class="tocnumber">4.1</span> <span class="toctext">软件包缓存</span></a></li>
<li class="toclevel-2 tocsection-24"><a href="#%E4%B8%8D%E9%9C%80%E8%A6%81%E7%9A%84%E8%BD%AF%E4%BB%B6%E5%8C%85"><span class="tocnumber">4.2</span> <span class="toctext">不需要的软件包</span></a></li>
<li class="toclevel-2 tocsection-25"><a href="#%E6%97%A7%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6"><span class="tocnumber">4.3</span> <span class="toctext">旧配置文件</span></a></li>
<li class="toclevel-2 tocsection-26"><a href="#%E7%A0%B4%E6%8D%9F%E7%9A%84%E8%BD%AF%E9%93%BE%E6%8E%A5"><span class="tocnumber">4.4</span> <span class="toctext">破损的软链接</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-27">
<a href="#%E6%8A%80%E5%B7%A7"><span class="tocnumber">5</span> <span class="toctext">技巧</span></a>
<ul>
<li class="toclevel-2 tocsection-28"><a href="#%E4%BD%BF%E7%94%A8%E7%BB%8F%E8%BF%87%E9%AA%8C%E8%AF%81%E7%9A%84%E8%BD%AF%E4%BB%B6%E5%8C%85"><span class="tocnumber">5.1</span> <span class="toctext">使用经过验证的软件包</span></a></li>
<li class="toclevel-2 tocsection-29"><a href="#%E5%AE%89%E8%A3%85%E5%86%85%E6%A0%B8%E7%9A%84%E9%95%BF%E6%9C%9F%E6%94%AF%E6%8C%81%E7%89%88%E6%9C%AC"><span class="tocnumber">5.2</span> <span class="toctext">安装内核的长期支持版本</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-30"><a href="#%E5%8F%82%E9%98%85"><span class="tocnumber">6</span> <span class="toctext">参阅</span></a></li>
</ul>
</div>

<h2>
<span id=".E6.A3.80.E6.9F.A5.E9.94.99.E8.AF.AF"></span><span class="mw-headline" id="检查错误">检查错误</span>
</h2>
<h3>
<span id="systemd_.E6.9C.8D.E5.8A.A1.E9.97.AE.E9.A2.98"></span><span class="mw-headline" id="systemd_服务问题">systemd 服务问题</span>
</h3>
<p>检查是否有 systemd 服务失败:
</p>
<pre>$ systemctl --failed
</pre>
<p>更多信息请参考 <a href="../en/Systemd.html#Analyzing_the_system_state" title="Systemd">Systemd#Analyzing the system state</a>.
</p>
<h3>
<span id=".E6.97.A5.E5.BF.97.E6.96.87.E4.BB.B6"></span><span class="mw-headline" id="日志文件">日志文件</span>
</h3>
<p>检查 <code>/var/log</code> 日志文件中是否存在错误, 检查<a href="../en/Systemd.html#Journal" title="Systemd">systemd 日志</a><sup>[<a href="../en/ArchWiki:Requests.html#Broken_section_links" class="mw-redirect" title="ArchWiki:Requests">断开的链接</a>：无效的部分]</sup>中的高优先级错误：
</p>
<pre> # journalctl -p 3 -xb
</pre>
<p>Xorg 的相关错误可以查看 <a href="../en/Xorg.html#Troubleshooting" title="Xorg">Xorg#Troubleshooting</a>。
</p>
<h2>
<span id=".E5.A4.87.E4.BB.BD"></span><span class="mw-headline" id="备份">备份</span>
</h2>
<p>把重要数据的备份作为日常维护任务。
</p>
<p>其它备份方案可以参考 <a href="../en/Synchronization_and_backup_programs.html" title="Synchronization and backup programs">同步和备份程序页面</a>，<a href="../en/Category:System_recovery.html" title="Category:System recovery">Category:System recovery</a> 包含其它相关文章。
</p>
<p>可以通过 <a href="../en/Systemd/Timers.html" title="Systemd/Timers">systemd/Timers</a> 自动备份.
</p>
<h3>
<span id=".E9.85.8D.E7.BD.AE.E6.96.87.E4.BB.B6"></span><span class="mw-headline" id="配置文件">配置文件</span>
</h3>
<p>在编辑任何配置文件前，先保留备份。这样出问题是可以直接还原。<a href="../en/Vim.html" title="Vim">vim</a> 和 <a href="../en/Emacs.html" title="Emacs">emacs</a> 编辑器会自动备份，<a href="../en/Etckeeper.html" title="Etckeeper">etckeeper</a> 可以将 <code>/etc</code> 纳入版本控制系统。详情请参考 <a href="../en/Dotfiles.html#Version_control" title="Dotfiles">dotfiles#Version control</a><sup>[<a href="../en/ArchWiki:Requests.html#Broken_section_links" class="mw-redirect" title="ArchWiki:Requests">断开的链接</a>：无效的部分]</sup>。
</p>
<h3>
<span id=".E5.AE.89.E8.A3.85.E7.9A.84.E8.BD.AF.E4.BB.B6.E5.8C.85"></span><span class="mw-headline" id="安装的软件包">安装的软件包</span>
</h3>
<p>维护一个所有安装软件包的列表，这样在不得己进行系统重装时，可以很快恢复到初始环境。
</p>
<p>详情参考 <a href="../en/Pacman/Tips_and_tricks.html#List_of_installed_packages" class="mw-redirect" title="Pacman tips">Pacman tips#List of installed packages</a>。
</p>
<h3>
<span id="Pacman_.E6.95.B0.E6.8D.AE.E5.BA.93"></span><span class="mw-headline" id="Pacman_数据库">Pacman 数据库</span>
</h3>
<p>参考 <a href="../en/Pacman/Tips_and_tricks.html#Back_up_the_pacman_database" title="Pacman/Tips and tricks">pacman/Tips and tricks#Back up the pacman database</a>.
</p>
<h3><span class="mw-headline" id="LUKS_headers">LUKS headers</span></h3>
<p>如果 LUKS 使用密码加密，建议定期检查和同步 LUKS 加密分区的头部数据。参考 <a href="../en/Dm-crypt/Device_encryption.html#Backup_and_restore" title="Dm-crypt/Device encryption">Dm-crypt/Device encryption#Backup and restore</a>.
</p>
<h3>
<span id=".E7.B3.BB.E7.BB.9F.E5.92.8C.E7.94.A8.E6.88.B7.E6.95.B0.E6.8D.AE"></span><span class="mw-headline" id="系统和用户数据">系统和用户数据</span>
</h3>
<p>参考 <a href="../en/System_backup.html" title="System backup">System backup</a>。
</p>
<h2>
<span id=".E6.9B.B4.E6.96.B0.E7.B3.BB.E7.BB.9F"></span><span class="mw-headline" id="更新系统">更新系统</span>
</h2>
<p>建议日常进行<a href="../en/Pacman.html#Upgrading_packages" title="Pacman">系统完整更新</a>，这样既能享受到最新的问题修复和安全更新，还可以避免一次更新太多的软件包，手动处理是分批进行的。从社区寻求帮助时，其他人会假定系统进行了完整更新。
</p>
<p>手头上保留 Arch 安装盘或其它 Linux "Live" 环境，这样有问题是可以进行修正。如果在生产环境使用 Arch，无法接受任何的停机，那么在更新前请在非关键系统上测试新配置文件和软件包，没有问题的时候再部署到生产环境。
</p>
<p>如果软件包来自 <a href="../en/Arch_User_Repository.html" class="mw-redirect" title="AUR">AUR</a>, 请注意更新完整. 
</p>
<h3>
<span id=".E5.8D.87.E7.BA.A7.E5.89.8D.E7.9A.84.E5.87.86.E5.A4.87"></span><span class="mw-headline" id="升级前的准备">升级前的准备</span>
</h3>
<p>建议升级前访问 <a rel="nofollow" class="external text" href="https://archlinux.org/">Arch Linux 主页</a>查看最新消息（或订阅 <a rel="nofollow" class="external text" href="https://archlinux.org/feeds/news/">RSS</a>，或订阅 <a rel="nofollow" class="external text" href="https://mailman.archlinux.org/mailman/listinfo/arch-announce/">arch-announce 邮件列表</a>，或关注 <a rel="nofollow" class="external text" href="https://twitter.com/archlinux">@archlinux</a>。如果升级需要不寻常的用户操作介入时（无法简单地按照 <i>pacman</i> 的输出信息处理），以上信息总会给出合适的方法。
</p>
<p>在更新<a href="../en/Kernel.html" title="Kernel">kernel</a>, <a href="../en/Xorg.html" title="Xorg">xorg</a>, <a href="../en/Systemd.html" title="Systemd">systemd</a> 和 <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=glibc">glibc</a></span>等重要软件之前, 查看<a rel="nofollow" class="external text" href="https://bbs.archlinux.org/">论坛</a>看是否有被报告的出错等问题.
</p>
<p>有时候系统更新会出现问题并需要进行一些手动调整，请不要在重要任务前进行系统更新。
</p>
<h3>
<span id=".E9.81.BF.E5.85.8D.E6.9F.90.E4.BA.9B_Pacman_.E5.91.BD.E4.BB.A4"></span><span class="mw-headline" id="避免某些_Pacman_命令">避免某些 Pacman 命令</span>
</h3>
<p>避免 <a href="#%E4%B8%8D%E6%94%AF%E6%8C%81%E9%83%A8%E5%88%86%E5%8D%87%E7%BA%A7">部分更新</a>，不要运行 <code>pacman -Sy</code> 而是运行 <code>pacman -Syu</code>.
</p>
<p>一般情况下，避免使用 pacman 的 <code>--force</code> 选项，<b>尤其要避免</b> <code>pacman -Syu --force</code> 这种可能更新多个软件包的指令。<code>--force</code> 忽略文件冲突，可能导致文件丢失！如果系统按正常维护，Arch 开发者会给出明确的指导，在 Arch 主页会有通知。
</p>
<p>避免使用 <code>-d</code> 选项，<code>pacman -Rdd package</code> 会在删除软件包时跳过依赖关系检查。如果删除了系统必要的依赖关系，可能导致系统损坏。
</p>
<h3>
<span id=".E4.B8.8D.E6.94.AF.E6.8C.81.E9.83.A8.E5.88.86.E5.8D.87.E7.BA.A7"></span><span class="mw-headline" id="不支持部分升级">不支持部分升级</span>
</h3>
<p>Arch Linux 是滚动发行版，新<a href="https://en.wikipedia.org/wiki/Library_(computing)" class="extiw" title="wikipedia:Library (computing)">库</a> 版本将不断被推送到源。开发者和信任用户会按照需要重新构建源中的所有软件包。如果有本地安装的版本(例如 AUR 软件包)，需要在它们的依赖关系升级了<a href="https://en.wikipedia.org/wiki/soname" class="extiw" title="wikipedia:soname">soname</a>时重新编译。
</p>
<p>也就是说，部分升级是<b>不被支持的</b>。
</p>
<p>不要使用 <code>pacman -Sy package</code> 或等价命令如 <code>pacman -Sy</code> 之后再 <code>pacman -S package</code>。在安装软件包前请更新源并升级。同理请特别注意 IgnorePkg/IgnoreGroup 的使用。
</p>
<p>如果进行了部分升级，二进制包因为找不到链接库而损坏，<b>不要通过简单的符号链接进行修正</b>。库升级 <a href="https://en.wikipedia.org/wiki/soname" class="extiw" title="wikipedia:soname">soname</a> 是因为它们<b>不再向前兼容</b>。只要 <i>pacman</i> 可以运行，使用更新的源进行 <code>pacman -Syu</code> 就能修复这些问题。
</p>
<p><span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=pacman-contrib">pacman-contrib</a></span> 软件包提供的 <i>checkupdates</i> 脚本可以检查更新但不进行实际安装。
</p>
<h3>
<span id=".E6.B3.A8.E6.84.8F.E6.9B.B4.E6.96.B0.E6.97.B6.E7.9A.84.E6.8F.90.E9.86.92"></span><span class="mw-headline" id="注意更新时的提醒">注意更新时的提醒</span>
</h3>
<p>当升级系统时， 请一定要注意<a href="../en/Pacman.html" title="Pacman">pacman</a>输出的注意信息。 如果有需要用户手动操作的，请一定要立即搞定。 如果不明白 pacman 输出的信息， 请去论坛搜索或者看Arch Linux首页的新闻。
</p>
<h3>
<span id=".E5.A4.84.E7.90.86.E9.85.8D.E7.BD.AE.E6.96.87.E4.BB.B6.E6.9B.B4.E6.96.B0"></span><span class="mw-headline" id="处理配置文件更新">处理配置文件更新</span>
</h3>
<p>pacman 可能会创建 <code>.pacnew</code> 和 <code>.pacsave</code> 文件，这是 pacman 会通知用户，而用户需要主动处理这些文件。详细的操作说明请参考：<a href="../en/Pacman/Pacnew_and_Pacsave.html" class="mw-redirect" title="Pacnew and Pacsave files">Pacnew and Pacsave files</a>.
</p>
<p>同样，注意所有你可能会复制或创建的配置文件。如果软件包提供了一个空配置文件，这个文件被复制到主目录，请注意查看示例文件是否有更新。
</p>
<h3>
<span id=".E5.9B.9E.E9.80.80.E6.9C.89.E9.97.AE.E9.A2.98.E7.9A.84.E6.9B.B4.E6.96.B0"></span><span class="mw-headline" id="回退有问题的更新">回退有问题的更新</span>
</h3>
<p>如果软件包可能导致问题，软件包维护者会在更新时给出提示信息。在更新后遇到问题，请先确认 <code>/var/log/pacman.log</code> 中有没有提醒信息.
</p>
<p><br>	
</p>
<div class="archwiki-template-box archwiki-template-box-tip">
<strong>Tip:</strong> 可以使用 <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://aur.archlinux.org/packages/wat-git/">wat-git</a></span><sup><small>AUR</small></sup> 等工具搜索 pacman 日志。</div>
<p>然后看看 <a rel="nofollow" class="external free" href="https://archlinux.org/">https://archlinux.org/</a> 中有没有新闻，然后再到论坛上查找类似的问题，如果都没有找到，可用到 <a rel="nofollow" class="external text" href="https://bbs.archlinux.org">论坛</a>, <a href="../en/Arch_IRC_channels.html" class="mw-redirect" title="IRC">IRC</a> 中发帖求助。
</p>
<p><a href="../en/Downgrading_packages.html" title="Downgrading packages">降级</a> 是最后的解决方案。
</p>
<h3>
<span id=".E6.A3.80.E6.9F.A5.E5.AD.A4.E7.AB.8B.E5.92.8C.E6.9C.AA.E4.BD.BF.E7.94.A8.E8.BD.AF.E4.BB.B6.E5.8C.85"></span><span class="mw-headline" id="检查孤立和未使用软件包">检查孤立和未使用软件包</span>
</h3>
<p>更新系统后，可能有些软件包不再需要，或者不再属于官方软件仓库。
</p>
<p>用 <code>pacman -Qtd</code> 命令查找之前作为依赖安装，现在不再需要的软件包。如果孤立的包还是需要的，可用修改 <a href="../en/Pacman.html#Installation_reason" class="mw-redirect" title="Installation reason">安装原因</a>。如果不再需要，可用将其删除。
</p>
<p>除此之外，有些软件包可能已经不再属于远程仓库，但是依然还安装在本地，用 <code>pacman -Qm</code> 命令查找所有这些软件包。注意此命令会包含手动安装的软件，例如 <a href="../en/Arch_User_Repository.html" class="mw-redirect" title="AUR">AUR</a> 中的软件。
</p>
<h3>
<span id=".E4.BD.BF.E7.94.A8.E5.8C.85.E7.AE.A1.E7.90.86.E5.99.A8.E5.AE.89.E8.A3.85.E8.BD.AF.E4.BB.B6"></span><span class="mw-headline" id="使用包管理器安装软件">使用包管理器安装软件</span>
</h3>
<p>软件包管理 <a href="../en/Pacman.html" title="Pacman">pacman</a> 可以比你更好的记录安装的文件。如果你手动地安装软件，你会过了一会就不知道你到底安装了什么，到底安装在哪里，安装导致的那些冲突，是否安装在了错误的地方，等等问题. 
</p>
<ul>
<li>使用 <a href="../en/Pacman.html#Installing_packages" title="Pacman">Pacman#Installing packages</a> 中介绍的方法安装官方软件包。</li>
<li>如果找不到需要的软件包，看看 <a href="../en/Arch_User_Repository.html" class="mw-redirect" title="AUR">AUR</a> 中有没有提供软件包打包脚本。</li>
<li>如果都没有找到，请学习<a href="../en/Creating_packages.html" title="Creating packages">创建软件包</a>。</li>
</ul>
<p>要清理自己安装的文件，可以<a href="../en/Pacman/Tips_and_tricks.html#Identify_files_not_owned_by_any_package" title="Pacman/Tips and tricks">这里</a>.
</p>
<h3>
<span id=".E9.80.89.E6.8B.A9.E5.BC.80.E6.BA.90.E9.A9.B1.E5.8A.A8"></span><span class="mw-headline" id="选择开源驱动">选择开源驱动</span>
</h3>
<p>尽可能地选择开源驱动。避免私有驱动。大多数时候，开源驱动比私有驱动更加稳定可靠。开源驱动的bugs修改起来比较容易快速，但同时私有驱动提供更多的特性和性能，不过也可能带来稳定性的代价。为了避免这个两难选择，可以选择已知的有很好的开源驱动支持的硬件。关于硬件和开源Linux驱动的信息可以在这里找到：<a rel="nofollow" class="external text" href="http://www.linux-drivers.org/">linux-drivers.org</a>.
</p>
<h3>
<span id=".E8.B0.A8.E6.85.8E.E4.BD.BF.E7.94.A8.E9.9D.9E.E5.AE.98.E6.96.B9.E6.88.96.E6.B5.8B.E8.AF.95.E4.B8.8D.E8.B6.B3.E7.9A.84.E8.BD.AF.E4.BB.B6.E5.8C.85"></span><span class="mw-headline" id="谨慎使用非官方或测试不足的软件包">谨慎使用非官方或测试不足的软件包</span>
</h3>
<p>在使用 AUR 或 <a href="../en/Unofficial_user_repositories.html" class="mw-redirect" title="Unofficial user repository">非官方软件仓库</a>中的软件包时应有预防措施。大部分软件包都是由用户提供的，并不能提供和官方软件仓库相同的质量。谨慎使用 <a href="../en/AUR_helpers.html" title="AUR helpers">AUR helpers</a> ，他们简化了 AUR 中的软件包的安装过程, 在编译和安装 AUR 中的软件包之前，<b>务必</b>检查软件包的 PKGBUILD 确保其中不含有错误或恶意的代码。
</p>
<p>只在绝对必要的情况下使用第三方的软件仓库.<a href="../en/Pacman/Tips_and_tricks.html#Maintenance" title="Pacman/Tips and tricks">pacman/Tips and tricks#Maintenance</a>提供了清理软件的方法。
</p>
<h3>
<span id=".E6.9B.B4.E6.96.B0.E9.95.9C.E5.83.8F.E5.88.97.E8.A1.A8"></span><span class="mw-headline" id="更新镜像列表">更新镜像列表</span>
</h3>
<p>镜像的质量会随着时间而变化，有些镜像会下线或者同步和下载出问题，所以请注意更新 pacman 的镜像列表，详情参考 <a href="../en/Mirrors.html" title="Mirrors">mirrors</a>。
</p>
<h2>
<span id=".E6.B8.85.E7.90.86.E6.96.87.E4.BB.B6.E7.B3.BB.E7.BB.9F"></span><span class="mw-headline" id="清理文件系统">清理文件系统</span>
</h2>
<p>检查磁盘空间的使用状况，删除占用空间较大的无用文件：
</p>
<ul>
<li>
<a href="../en/List_of_applications.html#Disk_usage_display" title="List of applications">List of applications#Disk usage display</a>.</li>
<li>
<a href="../en/List_of_applications.html#Disk_cleaning" title="List of applications">List of applications#Disk cleaning</a>.</li>
</ul>
<h3>
<span id=".E8.BD.AF.E4.BB.B6.E5.8C.85.E7.BC.93.E5.AD.98"></span><span class="mw-headline" id="软件包缓存">软件包缓存</span>
</h3>
<p>从 <code>/var/cache/pacman/pkg/</code> 删除不需要的 <code>.pkg</code> 可以减少空间占用。详情参考 <a href="../en/Pacman.html#Cleaning_the_package_cache" title="Pacman">Pacman#Cleaning the package cache</a>.
</p>
<h3>
<span id=".E4.B8.8D.E9.9C.80.E8.A6.81.E7.9A.84.E8.BD.AF.E4.BB.B6.E5.8C.85"></span><span class="mw-headline" id="不需要的软件包">不需要的软件包</span>
</h3>
<p>从系统里面删除不需要的软件包可以减少空间占用和维护难度。详情参考 <a href="../en/Pacman/Tips_and_tricks.html#Removing_unused_packages_(orphans)" title="Pacman/Tips and tricks">Pacman/Tips and tricks#Removing unused packages (orphans)</a>.
</p>
<h3>
<span id=".E6.97.A7.E9.85.8D.E7.BD.AE.E6.96.87.E4.BB.B6"></span><span class="mw-headline" id="旧配置文件">旧配置文件</span>
</h3>
<p>旧的配置文件可能和新软件版本不兼容，所以请定期清理和更新配置文件，尤其是主目录和 <code>~/.config</code>. 在重新安装或共享 /home 时，注意下面文件夹：
</p>
<ul>
<li>
<code>~/.config/</code> -- 软件保存配置文件的地方</li>
<li>
<code>~/.cache/</code> -- 程序缓存大小可能持续增加</li>
<li>
<code>~/.local/share/</code> -- 可能有旧文件</li>
</ul>
<p>参考 <a href="../en/XDG_Base_Directory.html" class="mw-redirect" title="XDG Base Directory support">XDG Base Directory support</a>.
</p>
<p>为了帮助清理 home 目录，建议维护一份不需要的文件列表并定期清理，例如使用 <a rel="nofollow" class="external text" href="https://github.com/lahwaacz/Scripts/blob/master/rmshit.py">rmshit.py</a>. 
</p>
<p><span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=rmlint">rmlint</a></span> 也可以用来查找不需要的重复文件，空文件和损坏的软链接。
</p>
<h3>
<span id=".E7.A0.B4.E6.8D.9F.E7.9A.84.E8.BD.AF.E9.93.BE.E6.8E.A5"></span><span class="mw-headline" id="破损的软链接">破损的软链接</span>
</h3>
<p>系统中可能存在老的，损坏的软链接，应该删除它们。方法可以参考 <a rel="nofollow" class="external text" href="https://unix.stackexchange.com/questions/34248/how-can-i-find-broken-symlinks">here</a> 和 <a rel="nofollow" class="external text" href="http://www.commandlinefu.com/commands/view/8260/find-broken-symlinks">here</a>.
</p>
<p>下面命令可以列出所有有问题的软链接，可以检查并删除列表中的文件。
</p>
<pre>  # find -xtype l -print
</pre>
<h2>
<span id=".E6.8A.80.E5.B7.A7"></span><span class="mw-headline" id="技巧">技巧</span>
</h2>
<h3>
<span id=".E4.BD.BF.E7.94.A8.E7.BB.8F.E8.BF.87.E9.AA.8C.E8.AF.81.E7.9A.84.E8.BD.AF.E4.BB.B6.E5.8C.85"></span><span class="mw-headline" id="使用经过验证的软件包">使用经过验证的软件包</span>
</h3>
<p>Arch 的滚动发行让用户可以使用最新的功能和上游更新，但是这也增加了系统维护的难度。为了增加稳定性，可以尽量使用经过验证的稳定版本。这些软件包不太容易在升级时遇到问题。选用具有活跃开发社区的软件，选用用户能力更出众的软件，这样在出问题是更容易获得帮助。
</p>
<p>避免使用测试仓库，这些软件包都是实验性质，不适合安装到稳定系统。因此对于<a href="../en/Arch_User_Repository.html" class="mw-redirect" title="AUR">AUR</a>中的包以及部分 community 中的包需要一些谨慎，这些开发中的包是直接从上游开发版分支中获取到的，通常会在包的名字上注有：dev, devel, svn, cvs, git, hg, 或是 darcs 的信息。
</p>
<h3>
<span id=".E5.AE.89.E8.A3.85.E5.86.85.E6.A0.B8.E7.9A.84.E9.95.BF.E6.9C.9F.E6.94.AF.E6.8C.81.E7.89.88.E6.9C.AC"></span><span class="mw-headline" id="安装内核的长期支持版本">安装内核的长期支持版本</span>
</h3>
<p><span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=linux-lts">linux-lts</a></span> 是 Arch 官方提供的 Linux kernel 的长期支持版本。内核上游开发者针对此版本提供了长期支持，包括安全补丁和功能 backports。适用于需要长期支持的用户，也可以将此内核作为新内核升级的后备内核。
</p>
<p>需要编辑 <a href="../en/Arch_boot_process.html#Boot_loader" class="mw-redirect" title="Bootloader">bootloader</a> 的启动加载项，启动到 <code>vmlinuz-linux-lts</code> 和 <code>initramfs-linux-lts.img</code>。
</p>
<h2>
<span id=".E5.8F.82.E9.98.85"></span><span class="mw-headline" id="参阅">参阅</span>
</h2>
<ul>
<li><a rel="nofollow" class="external text" href="https://bbs.archlinux.org/viewtopic.php?id=146850">Arch News Bash Script</a></li>
<li><a rel="nofollow" class="external text" href="https://bbs.archlinux.org/viewtopic.php?pid=1791008">Automatic Arch System Maintenance</a></li>
</ul>
</div>
</div>
<div id="catlinks" class="catlinks" data-mw="interface">
<div id="mw-normal-catlinks" class="mw-normal-catlinks">
<a href="../Special:Categories.html" title="Special:Categories">Category</a>: <ul><li><a href="../zh-CN/Category:System_administration.html" title="Category:System administration (简体中文)">System administration (简体中文)</a></li></ul>
</div>
<div id="mw-hidden-catlinks" class="mw-hidden-catlinks mw-hidden-cats-hidden">Hidden category: <ul><li><a href="../en/Category:Pages_with_broken_section_links.html" title="Category:Pages with broken section links">Pages with broken section links</a></li></ul>
</div>
</div>
	</div>
</div>

<footer id="footer" class="mw-footer" role="contentinfo" style="margin: 0">
	<ul id="footer-info">
		<li>Retrieved from "<a dir="ltr" href="https://wiki.archlinux.org/index.php?title=System_maintenance_(%E7%AE%80%E4%BD%93%E4%B8%AD%E6%96%87)&amp;oldid=647063">https://wiki.archlinux.org/index.php?title=System_maintenance_(简体中文)&amp;oldid=647063</a>"</li>
		<li id="footer-info-lastmod"> This page was last edited on 26 December 2020, at 12:26.</li>
		<li id="footer-info-copyright">Content is available under <a class="external" rel="nofollow" href="http://www.gnu.org/copyleft/fdl.html">GNU Free Documentation License 1.3 or later</a> unless otherwise noted.</li>
	<br>
</ul>
	<ul id="footer-places">
		<li id="footer-places-privacy"><a href="../en/ArchWiki:Privacy_policy.html" title="ArchWiki:Privacy policy">Privacy policy</a></li>
		<li id="footer-places-about"><a href="../en/ArchWiki:About.html" title="ArchWiki:About">About ArchWiki</a></li>
		<li id="footer-places-disclaimer"><a href="../en/ArchWiki:General_disclaimer.html" title="ArchWiki:General disclaimer">Disclaimers</a></li>
	</ul>
	<ul id="footer-icons" class="noprint">
		<li id="footer-copyrightico">
	</ul>
	<div style="clear: both;"></div>
</footer>



</body>
</html>
