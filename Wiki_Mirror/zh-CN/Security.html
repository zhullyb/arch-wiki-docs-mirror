<!DOCTYPE html>
<html class="client-nojs" lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<title>Security (简体中文) - ArchWiki</title>
<link rel="stylesheet" href="../ArchWikiOffline.css">
<meta name="ResourceLoaderDynamicStyles" content="">
<meta name="generator" content="MediaWiki 1.35.0">
<meta name="robots" content="noindex,follow">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="shortcut icon" href="/favicon.ico">
<link rel="search" type="application/opensearchdescription+xml" href="/opensearch_desc.php" title="ArchWiki (en)">
<link rel="EditURI" type="application/rsd+xml" href="https://wiki.archlinux.org/api.php?action=rsd">
<link rel="license" href="http://www.gnu.org/copyleft/fdl.html">
<link rel="alternate" type="application/atom+xml" title="ArchWiki Atom feed" href="/index.php?title=Special:RecentChanges&amp;feed=atom">
</head>
<body class="mediawiki ltr sitedir-ltr mw-hide-empty-elt ns-0 ns-subject page-Security_简体中文 rootpage-Security_简体中文 skin-vector action-view skin-vector-legacy">
<div id="content" class="mw-body" role="main" style="margin: 0">
	<a id="top"></a>
	<div id="siteNotice" class="mw-body-content"></div>
	<div class="mw-indicators mw-body-content">
	</div>
	<h1 id="firstHeading" class="firstHeading" lang="en">Security (简体中文)</h1>
	<div id="bodyContent" class="mw-body-content">
		<div id="siteSub" class="noprint">From ArchWiki</div>
		<div id="contentSub"></div>
		<div id="contentSub2"></div>
		
		<div id="jump-to-nav"></div>
		<a class="mw-jump-link" href="#mw-head">Jump to navigation</a>
		<a class="mw-jump-link" href="#searchInput">Jump to search</a>
		<div id="mw-content-text" lang="en" dir="ltr" class="mw-content-ltr">
<div class="warningbox">The printable version is no longer supported and may have rendering errors. Please update your browser bookmarks and please use the default browser print function instead.</div>
<div class="mw-parser-output">
<div class="archwiki-template-meta-related-articles-start">
<p>相关文章</p>
<ul>
<li><a href="../en/Arch_Security_Team.html" title="Arch Security Team">Arch Security Team</a></li>
<li><a href="../zh-CN/General_recommendations.html" title="General recommendations (简体中文)">General recommendations (简体中文)</a></li>
<li><a href="../zh-CN/PAM.html" title="PAM (简体中文)">PAM (简体中文)</a></li>
<li><a href="../zh-CN/Capabilities.html" title="Capabilities (简体中文)">Capabilities (简体中文)</a></li>
<li><a href="../en/List_of_applications/Security.html" class="mw-redirect" title="List of Applications/Security">List of Applications/Security</a></li>
</ul>
</div>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>翻译状态：</strong>本文是 <a href="../en/Security.html" title="Security">Security</a> 的<a href="../zh-CN/ArchWiki:Translation_Team.html" title="ArchWiki:Translation Team (简体中文)">翻译</a>。上次翻译日期：2019-02-04。如果英文版本有所<a rel="nofollow" class="external text" href="https://wiki.archlinux.org/index.php?title=Security&amp;diff=0&amp;oldid=565780">更改</a>，则您可以帮助同步翻译。</div>
<p>本文包含了 <a href="https://en.wikipedia.org/wiki/Hardening_(computing)" class="extiw" title="wikipedia:Hardening (computing)">加固</a> Arch Linux 系统的常用建议与最佳实践。
</p>
<div id="toc" class="toc" role="navigation" aria-labelledby="mw-toc-heading">
<input type="checkbox" role="button" id="toctogglecheckbox" class="toctogglecheckbox" style="display:none"><div class="toctitle" lang="en" dir="ltr">
<h2 id="mw-toc-heading">Contents</h2>
<span class="toctogglespan"><label class="toctogglelabel" for="toctogglecheckbox"></label></span>
</div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#%E6%A6%82%E5%BF%B5"><span class="tocnumber">1</span> <span class="toctext">概念</span></a></li>
<li class="toclevel-1 tocsection-2">
<a href="#%E5%AF%86%E7%A0%81"><span class="tocnumber">2</span> <span class="toctext">密码</span></a>
<ul>
<li class="toclevel-2 tocsection-3"><a href="#%E9%80%89%E6%8B%A9%E5%AE%89%E5%85%A8%E7%9A%84%E5%AF%86%E7%A0%81"><span class="tocnumber">2.1</span> <span class="toctext">选择安全的密码</span></a></li>
<li class="toclevel-2 tocsection-4"><a href="#%E7%BB%B4%E6%8A%A4%E5%AF%86%E7%A0%81%E5%AE%89%E5%85%A8"><span class="tocnumber">2.2</span> <span class="toctext">维护密码安全</span></a></li>
<li class="toclevel-2 tocsection-5"><a href="#%E5%AF%86%E7%A0%81%E7%9A%84%E6%95%A3%E5%88%97%E5%80%BC"><span class="tocnumber">2.3</span> <span class="toctext">密码的散列值</span></a></li>
<li class="toclevel-2 tocsection-6"><a href="#%E7%94%A8_pam_pwquality_%E5%BC%BA%E5%88%B6%E4%BD%BF%E7%94%A8%E5%BC%BA%E5%AF%86%E7%A0%81"><span class="tocnumber">2.4</span> <span class="toctext">用 pam_pwquality 强制使用强密码</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-7">
<a href="#CPU"><span class="tocnumber">3</span> <span class="toctext">CPU</span></a>
<ul>
<li class="toclevel-2 tocsection-8"><a href="#%E5%BE%AE%E7%A0%81"><span class="tocnumber">3.1</span> <span class="toctext">微码</span></a></li>
<li class="toclevel-2 tocsection-9">
<a href="#%E7%A1%AC%E4%BB%B6%E6%BC%8F%E6%B4%9E"><span class="tocnumber">3.2</span> <span class="toctext">硬件漏洞</span></a>
<ul>
<li class="toclevel-3 tocsection-10"><a href="#%E5%90%8C%E6%AD%A5%E5%A4%9A%E7%BA%BF%E7%A8%8B%EF%BC%88%E8%B6%85%E7%BA%BF%E7%A8%8B%EF%BC%89"><span class="tocnumber">3.2.1</span> <span class="toctext">同步多线程（超线程）</span></a></li>
</ul>
</li>
</ul>
</li>
<li class="toclevel-1 tocsection-11">
<a href="#%E5%AD%98%E5%82%A8"><span class="tocnumber">4</span> <span class="toctext">存储</span></a>
<ul>
<li class="toclevel-2 tocsection-12"><a href="#%E7%A3%81%E7%9B%98%E5%8A%A0%E5%AF%86"><span class="tocnumber">4.1</span> <span class="toctext">磁盘加密</span></a></li>
<li class="toclevel-2 tocsection-13">
<a href="#%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F"><span class="tocnumber">4.2</span> <span class="toctext">文件系统</span></a>
<ul>
<li class="toclevel-3 tocsection-14"><a href="#%E6%8C%82%E8%BD%BD%E7%82%B9"><span class="tocnumber">4.2.1</span> <span class="toctext">挂载点</span></a></li>
</ul>
</li>
<li class="toclevel-2 tocsection-15"><a href="#%E6%96%87%E4%BB%B6%E8%AE%BF%E9%97%AE%E6%9D%83%E9%99%90"><span class="tocnumber">4.3</span> <span class="toctext">文件访问权限</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-16">
<a href="#%E8%B4%A6%E6%88%B7%E8%AE%BE%E7%BD%AE"><span class="tocnumber">5</span> <span class="toctext">账户设置</span></a>
<ul>
<li class="toclevel-2 tocsection-17"><a href="#%E4%B8%8D%E8%A6%81%E6%97%A5%E5%B8%B8%E4%BD%BF%E7%94%A8_root_%E8%B4%A6%E6%88%B7"><span class="tocnumber">5.1</span> <span class="toctext">不要日常使用 root 账户</span></a></li>
<li class="toclevel-2 tocsection-18"><a href="#%E5%9C%A8%E5%A4%B1%E8%B4%A5%E7%9A%84%E7%99%BB%E5%BD%95%E5%B0%9D%E8%AF%95%E5%90%8E%E5%BC%BA%E5%88%B6%E5%BB%B6%E6%97%B6%E4%B8%80%E6%AE%B5%E6%97%B6%E9%97%B4"><span class="tocnumber">5.2</span> <span class="toctext">在失败的登录尝试后强制延时一段时间</span></a></li>
<li class="toclevel-2 tocsection-19"><a href="#%E5%9C%A8%E4%B8%89%E6%AC%A1%E7%99%BB%E5%BD%95%E5%B0%9D%E8%AF%95%E5%A4%B1%E8%B4%A5%E5%90%8E%E5%B0%81%E9%94%81%E7%94%A8%E6%88%B7"><span class="tocnumber">5.3</span> <span class="toctext">在三次登录尝试失败后封锁用户</span></a></li>
<li class="toclevel-2 tocsection-20"><a href="#%E9%99%90%E5%88%B6%E8%BF%9B%E7%A8%8B%E6%95%B0%E9%87%8F"><span class="tocnumber">5.4</span> <span class="toctext">限制进程数量</span></a></li>
<li class="toclevel-2 tocsection-21"><a href="#%E9%9D%9E_root_%E8%BF%90%E8%A1%8C_Xorg"><span class="tocnumber">5.5</span> <span class="toctext">非 root 运行 Xorg</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-22">
<a href="#%E9%99%90%E5%88%B6_root_%E6%9D%83%E9%99%90"><span class="tocnumber">6</span> <span class="toctext">限制 root 权限</span></a>
<ul>
<li class="toclevel-2 tocsection-23">
<a href="#%E7%94%A8_sudo_%E6%9B%BF%E4%BB%A3_su"><span class="tocnumber">6.1</span> <span class="toctext">用 sudo 替代 su</span></a>
<ul>
<li class="toclevel-3 tocsection-24"><a href="#%E4%BD%BF%E7%94%A8_sudo_%E7%BC%96%E8%BE%91%E6%96%87%E4%BB%B6"><span class="tocnumber">6.1.1</span> <span class="toctext">使用 sudo 编辑文件</span></a></li>
</ul>
</li>
<li class="toclevel-2 tocsection-25">
<a href="#%E9%99%90%E5%88%B6_root_%E7%99%BB%E5%BD%95"><span class="tocnumber">6.2</span> <span class="toctext">限制 root 登录</span></a>
<ul>
<li class="toclevel-3 tocsection-26"><a href="#%E4%BB%85%E5%85%81%E8%AE%B8%E7%89%B9%E5%AE%9A%E7%94%A8%E6%88%B7"><span class="tocnumber">6.2.1</span> <span class="toctext">仅允许特定用户</span></a></li>
<li class="toclevel-3 tocsection-27"><a href="#%E6%8B%92%E7%BB%9D_SSH_%E7%99%BB%E5%BD%95"><span class="tocnumber">6.2.2</span> <span class="toctext">拒绝 SSH 登录</span></a></li>
</ul>
</li>
</ul>
</li>
<li class="toclevel-1 tocsection-28">
<a href="#%E5%BC%BA%E5%88%B6%E8%AE%BF%E9%97%AE%E6%8E%A7%E5%88%B6"><span class="tocnumber">7</span> <span class="toctext">强制访问控制</span></a>
<ul>
<li class="toclevel-2 tocsection-29"><a href="#%E5%9F%BA%E4%BA%8E%E8%B7%AF%E5%BE%84%E7%9A%84%E5%BC%BA%E5%88%B6%E8%AE%BF%E9%97%AE%E6%8E%A7%E5%88%B6"><span class="tocnumber">7.1</span> <span class="toctext">基于路径的强制访问控制</span></a></li>
<li class="toclevel-2 tocsection-30"><a href="#%E5%9F%BA%E4%BA%8E%E6%A0%87%E7%AD%BE%E7%9A%84%E5%BC%BA%E5%88%B6%E8%AE%BF%E9%97%AE%E6%8E%A7%E5%88%B6"><span class="tocnumber">7.2</span> <span class="toctext">基于标签的强制访问控制</span></a></li>
<li class="toclevel-2 tocsection-31"><a href="#%E8%AE%BF%E9%97%AE%E6%8E%A7%E5%88%B6%E8%A1%A8_(ACLs)"><span class="tocnumber">7.3</span> <span class="toctext">访问控制表 (ACLs)</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-32">
<a href="#%E5%86%85%E6%A0%B8%E5%8A%A0%E5%9B%BA"><span class="tocnumber">8</span> <span class="toctext">内核加固</span></a>
<ul>
<li class="toclevel-2 tocsection-33">
<a href="#%E5%86%85%E6%A0%B8%E8%87%AA%E6%88%91%E4%BF%9D%E6%8A%A4_/_%E6%BC%8F%E6%B4%9E%E9%98%B2%E6%8A%A4"><span class="tocnumber">8.1</span> <span class="toctext">内核自我保护 / 漏洞防护</span></a>
<ul>
<li class="toclevel-3 tocsection-34">
<a href="#%E7%94%A8%E6%88%B7%E7%A9%BA%E9%97%B4_ASLR_%E6%AF%94%E8%BE%83"><span class="tocnumber">8.1.1</span> <span class="toctext">用户空间 ASLR 比较</span></a>
<ul>
<li class="toclevel-4 tocsection-35"><a href="#64_%E4%BD%8D%E8%BF%9B%E7%A8%8B"><span class="tocnumber">8.1.1.1</span> <span class="toctext">64 位进程</span></a></li>
<li class="toclevel-4 tocsection-36"><a href="#32_%E4%BD%8D%E8%BF%9B%E7%A8%8B%EF%BC%88%E8%BF%90%E8%A1%8C%E5%9C%A8_x86_64_%E5%86%85%E6%A0%B8%E4%B8%8A%EF%BC%89"><span class="tocnumber">8.1.1.2</span> <span class="toctext">32 位进程（运行在 x86_64 内核上）</span></a></li>
</ul>
</li>
</ul>
</li>
<li class="toclevel-2 tocsection-37"><a href="#%E9%99%90%E5%88%B6%E8%AE%BF%E9%97%AE%E5%86%85%E6%A0%B8%E6%97%A5%E5%BF%97"><span class="tocnumber">8.2</span> <span class="toctext">限制访问内核日志</span></a></li>
<li class="toclevel-2 tocsection-38"><a href="#%E9%99%90%E5%88%B6%E8%AE%BF%E9%97%AE_proc_%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F%E4%B8%AD%E7%9A%84%E5%86%85%E6%A0%B8%E6%8C%87%E9%92%88"><span class="tocnumber">8.3</span> <span class="toctext">限制访问 proc 文件系统中的内核指针</span></a></li>
<li class="toclevel-2 tocsection-39"><a href="#%E7%A6%81%E7%94%A8_BPF_%E5%8D%B3%E6%97%B6%E7%BC%96%E8%AF%91"><span class="tocnumber">8.4</span> <span class="toctext">禁用 BPF 即时编译</span></a></li>
<li class="toclevel-2 tocsection-40">
<a href="#ptrace_%E7%9A%84%E5%8F%AF%E8%B0%83%E7%94%A8%E8%8C%83%E5%9B%B4"><span class="tocnumber">8.5</span> <span class="toctext">ptrace 的可调用范围</span></a>
<ul>
<li class="toclevel-3 tocsection-41"><a href="#%E7%A4%BA%E4%BE%8B%EF%BC%9A%E7%94%B1%E4%BA%8E%E4%B8%8A%E8%BF%B0%E5%8E%9F%E5%9B%A0%E5%8A%9F%E8%83%BD%E5%8F%97%E9%99%90%E7%9A%84%E7%A8%8B%E5%BA%8F"><span class="tocnumber">8.5.1</span> <span class="toctext">示例：由于上述原因功能受限的程序</span></a></li>
</ul>
</li>
<li class="toclevel-2 tocsection-42"><a href="#%E9%9A%90%E8%97%8F%E8%BF%9B%E7%A8%8B"><span class="tocnumber">8.6</span> <span class="toctext">隐藏进程</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-43">
<a href="#%E6%B2%99%E7%9B%92%E7%A8%8B%E5%BA%8F"><span class="tocnumber">9</span> <span class="toctext">沙盒程序</span></a>
<ul>
<li class="toclevel-2 tocsection-44"><a href="#Firejail"><span class="tocnumber">9.1</span> <span class="toctext">Firejail</span></a></li>
<li class="toclevel-2 tocsection-45"><a href="#bubblewrap"><span class="tocnumber">9.2</span> <span class="toctext">bubblewrap</span></a></li>
<li class="toclevel-2 tocsection-46"><a href="#chroots"><span class="tocnumber">9.3</span> <span class="toctext">chroots</span></a></li>
<li class="toclevel-2 tocsection-47"><a href="#Linux_containers"><span class="tocnumber">9.4</span> <span class="toctext">Linux containers</span></a></li>
<li class="toclevel-2 tocsection-48"><a href="#%E5%85%B6%E4%BB%96%E8%99%9A%E6%8B%9F%E5%8C%96%E6%8A%80%E6%9C%AF"><span class="tocnumber">9.5</span> <span class="toctext">其他虚拟化技术</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-49">
<a href="#%E7%BD%91%E7%BB%9C%E4%B8%8E%E9%98%B2%E7%81%AB%E5%A2%99"><span class="tocnumber">10</span> <span class="toctext">网络与防火墙</span></a>
<ul>
<li class="toclevel-2 tocsection-50"><a href="#%E9%98%B2%E7%81%AB%E5%A2%99"><span class="tocnumber">10.1</span> <span class="toctext">防火墙</span></a></li>
<li class="toclevel-2 tocsection-51"><a href="#%E5%86%85%E6%A0%B8%E5%8F%82%E6%95%B0"><span class="tocnumber">10.2</span> <span class="toctext">内核参数</span></a></li>
<li class="toclevel-2 tocsection-52"><a href="#SSH"><span class="tocnumber">10.3</span> <span class="toctext">SSH</span></a></li>
<li class="toclevel-2 tocsection-53"><a href="#DNS"><span class="tocnumber">10.4</span> <span class="toctext">DNS</span></a></li>
<li class="toclevel-2 tocsection-54"><a href="#%E4%BB%A3%E7%90%86"><span class="tocnumber">10.5</span> <span class="toctext">代理</span></a></li>
<li class="toclevel-2 tocsection-55"><a href="#%E7%AE%A1%E7%90%86_SSL_%E8%AF%81%E4%B9%A6"><span class="tocnumber">10.6</span> <span class="toctext">管理 SSL 证书</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-56"><a href="#%E8%BD%AF%E4%BB%B6%E5%8C%85%E9%AA%8C%E8%AF%81"><span class="tocnumber">11</span> <span class="toctext">软件包验证</span></a></li>
<li class="toclevel-1 tocsection-57"><a href="#%E8%AE%A2%E9%98%85%E6%BC%8F%E6%B4%9E%E5%91%8A%E8%AD%A6"><span class="tocnumber">12</span> <span class="toctext">订阅漏洞告警</span></a></li>
<li class="toclevel-1 tocsection-58">
<a href="#%E7%89%A9%E7%90%86%E5%AE%89%E5%85%A8"><span class="tocnumber">13</span> <span class="toctext">物理安全</span></a>
<ul>
<li class="toclevel-2 tocsection-59"><a href="#%E9%94%81%E5%AE%9A_BIOS"><span class="tocnumber">13.1</span> <span class="toctext">锁定 BIOS</span></a></li>
<li class="toclevel-2 tocsection-60">
<a href="#%E5%BC%95%E5%AF%BC%E5%8A%A0%E8%BD%BD%E7%A8%8B%E5%BA%8F_(Bootloader)"><span class="tocnumber">13.2</span> <span class="toctext">引导加载程序 (Bootloader)</span></a>
<ul>
<li class="toclevel-3 tocsection-61"><a href="#Syslinux"><span class="tocnumber">13.2.1</span> <span class="toctext">Syslinux</span></a></li>
<li class="toclevel-3 tocsection-62"><a href="#GRUB"><span class="tocnumber">13.2.2</span> <span class="toctext">GRUB</span></a></li>
</ul>
</li>
<li class="toclevel-2 tocsection-63"><a href="#%E5%90%AF%E5%8A%A8%E5%88%86%E5%8C%BA%E7%BD%AE%E4%BA%8E%E5%8F%AF%E7%A7%BB%E5%8A%A8%E9%97%AA%E5%AD%98%E4%B8%8A"><span class="tocnumber">13.3</span> <span class="toctext">启动分区置于可移动闪存上</span></a></li>
<li class="toclevel-2 tocsection-64"><a href="#%E8%87%AA%E5%8A%A8%E6%B3%A8%E9%94%80"><span class="tocnumber">13.4</span> <span class="toctext">自动注销</span></a></li>
<li class="toclevel-2 tocsection-65"><a href="#%E9%98%B2%E8%8C%83%E6%81%B6%E6%84%8F_USB_%E8%AE%BE%E5%A4%87"><span class="tocnumber">13.5</span> <span class="toctext">防范恶意 USB 设备</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-66"><a href="#%E9%87%8D%E6%96%B0%E6%9E%84%E5%BB%BA%E8%BD%AF%E4%BB%B6%E5%8C%85"><span class="tocnumber">14</span> <span class="toctext">重新构建软件包</span></a></li>
<li class="toclevel-1 tocsection-67"><a href="#%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99"><span class="tocnumber">15</span> <span class="toctext">参考资料</span></a></li>
</ul>
</div>

<h2>
<span id=".E6.A6.82.E5.BF.B5"></span><span class="mw-headline" id="概念">概念</span>
</h2>
<ul>
<li>收紧安全措施有可能达到使系统无法使用的程度。安全性与便利性需要得到平衡。诀窍在于建立一个安全且有用的系统。</li>
<li>最大的威胁是（并且一直都会是）用户。</li>
<li>
<a href="https://en.wikipedia.org/wiki/Principle_of_least_privilege" class="extiw" title="wikipedia:Principle of least privilege">最小权限原则</a>：系统的每一部分应该只能访问到它确实需要的东西，除此之外的则不可以。</li>
<li>纵深防御：多个独立的层次能带来更好的安全性。当一层防护被攻破时，另一层应该能够阻止攻击。</li>
<li>保持一点点的偏执和多疑。如果有件事看起来太好了，不像是真的，那可能确实如此。</li>
<li>永远无法令系统 100% 安全，除非把机器从网络上断开，关掉电源，锁进保险柜，用混凝土封住并不再使用它。</li>
<li>为失败做好准备。预先为安全措施被攻破的情况制定可供执行的计划。</li>
</ul>
<h2>
<span id=".E5.AF.86.E7.A0.81"></span><span class="mw-headline" id="密码">密码</span>
</h2>
<p>密码是一个安全 Linux 系统的关键。它可以保护你的<a href="../zh-CN/Users_and_groups.html" title="Users and groups (简体中文)">用户账户</a>、<a href="../en/Data-at-rest_encryption.html" class="mw-redirect" title="Disk encryption">加密的文件系统</a>和 <a href="../en/SSH_keys.html" title="SSH keys">SSH</a>/<a href="../en/GnuPG.html" class="mw-redirect" title="GPG">GPG</a> 密钥。密码也是让计算机信任使用者的主要方式，所以安全问题的一大部分在于如何选择高强度的密码并保护它们不被泄露。
</p>
<h3>
<span id=".E9.80.89.E6.8B.A9.E5.AE.89.E5.85.A8.E7.9A.84.E5.AF.86.E7.A0.81"></span><span class="mw-headline" id="选择安全的密码">选择安全的密码</span>
</h3>
<p>密码必须足够复杂，不能轻易地被猜中（比如和个人信息有关的密码），也不能轻易地被社会工程或暴力尝试等方法 <a href="https://en.wikipedia.org/wiki/Password_cracking" class="extiw" title="wikipedia:Password cracking">破解</a>。强密码的要点在于 <i>长度</i> 和 <i>随机性</i>。在密码学中，密码的质量被称为它的 <a href="https://en.wikipedia.org/wiki/Entropic_security" class="extiw" title="wikipedia:Entropic security">熵安全性</a> 。
</p>
<p>不安全的密码包括：
</p>
<ul>
<li>个人可识别信息（如：狗的名字，出生日期，区号，最喜欢的视频游戏）</li>
<li>对单词简单地替换一些字符（如：<code>k1araj0hns0n</code>），因为现代字典攻击可以轻松对付它们</li>
<li>在基本单词或常见字符串的前后加上数字，符号或其他字符（如：<code>DG091101%</code>）</li>
<li>常见句子或词典中单词的序列（如：<code>photocopyhauntbranchexpose</code>），包括对其字符进行替换（如：<code>Ph0toc0pyh4uN7br@nch3xp*se</code>）</li>
<li>任何一个<a href="https://en.wikipedia.org/wiki/List_of_the_most_common_passwords" class="extiw" title="wikipedia:List of the most common passwords">最常见的密码</a>
</li>
</ul>
<p>最好的选择是由随机来源生成的长密码（越长越好）。使用长密码很重要。<a rel="nofollow" class="external text" href="https://www.theregister.com/2019/02/14/password_length">弱哈希算法会使得一个8字符密码的哈希值在几小时之内便被攻破。</a>
</p>
<p>有个方法可以产生安全性好的、看起来随机的密码，那就是从一句句子的每一个词中提炼出一个符号。
例如 “the girl is walking down the rainy street” 这句话可以转换为 <code>t6!WdtR5</code> 或是更加复杂的 <code>t&amp;6!RrlW@dtR,57</code>。
这种方法可以更为简单地帮助记忆密码，但是请注意，不同字母出现在单词开头的概率不同 (<a href="https://en.wikipedia.org/wiki/Letter_frequency#Relative_frequencies_of_the_first_letters_of_a_word_in_the_English_language" class="extiw" title="wikipedia:Letter frequency">Wikipedia:Letter frequency</a>)。同时也要考虑 <a rel="nofollow" class="external text" href="http://world.std.com/~reinhold/diceware.html">Diceware Passphrase</a> 中提到的方法，使用足够数量的单词。
</p>
<p>更好的方法是使用 <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=pwgen">pwgen</a></span> 或 <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://aur.archlinux.org/packages/apg/">apg</a></span><sup><small>AUR</small></sup> 等工具生成伪随机密码：为了记住它们，一种方法（仅针对经常输入的密码）是生成一个长密码并记住一小段（这一小段要能保证最低限度的安全），暂时把完整的密码写下来。随着时间推移，输入次数增加，密码会随着肌肉记忆根深蒂固。这种方法很难，但是能保证密码不会出现在破解用的字典里，也可以抵御能“智能地”组合单词并替换部分字符的暴力破解。
</p>
<p>将生成与记忆密码两者结合的 <a href="../en/List_of_applications/Security.html#Password_managers" class="mw-redirect" title="Password manager">密码管理器</a> 也很有用，它可以保存长而复杂的随机密码，同时被一个方便记忆的主密码保护着。该密码必须仅用于此密码管理器，特别注意要避免保存或通过任何网络传输这个密码。当然这个方法限制了只能从存有密码库的电脑上使用已保存的密码（另一方面，这也可以视为额外的安全特性）。一些密码管理器也提供智能手机应用，可以显示密码，以便在没有安装密码管理器的系统上手动输入。需要注意，一旦忘记主密码，密码管理器就引入了单点故障。
</p>
<p>从前，使用一长串相互无关的单词作为密码是很有效的方法。原理在于，如果使用足够长的短语，密码长度所带来的熵就可以抵消使用字典单词所失去的熵。这个 <a rel="nofollow" class="external text" href="https://xkcd.com/936/">XKCD 漫画</a>描绘了此方法中对于熵的权衡。然而，密码破解者已经知道了这一技巧，所生成的单词表包含字典单词的数十亿种排列与变种，从而降低了这种密码的等效熵。
</p>
<p>可以看下 Bruce Schneier 的文章 <a rel="nofollow" class="external text" href="https://www.schneier.com/blog/archives/2014/03/choosing_secure_1.html">Choosing Secure Passwords</a>，<a rel="nofollow" class="external text" href="https://www.iusmentis.com/security/passphrasefaq/">The passphrase FAQ</a> 或 <a href="https://en.wikipedia.org/wiki/Password_strength" class="extiw" title="wikipedia:Password strength">Wikipedia:Password strength</a> 获取额外背景信息。
</p>
<h3>
<span id=".E7.BB.B4.E6.8A.A4.E5.AF.86.E7.A0.81.E5.AE.89.E5.85.A8"></span><span class="mw-headline" id="维护密码安全">维护密码安全</span>
</h3>
<p>一旦你选择了一个强密码，一定要保证它的安全。当心 <a href="https://en.wikipedia.org/wiki/Keylogger" class="extiw" title="wikipedia:Keylogger">键盘记录器</a>（软件或硬件），屏幕记录器，<a href="https://en.wikipedia.org/wiki/Social_engineering_(security)" class="extiw" title="wikipedia:Social engineering (security)">社会工程</a>，<a href="https://en.wikipedia.org/wiki/Shoulder_surfing_(computer_security)" class="extiw" title="wikipedia:Shoulder surfing (computer security)">肩窥</a>，并避免重复使用密码，这样不安全的服务器就无法泄漏超出其范围的信息。<a href="../en/List_of_applications/Security.html#Password_managers" title="List of applications/Security">密码管理器</a> 可以帮助管理大量复杂密码：将密码从管理器复制粘贴到其他程序中时，请确保每次粘贴完都清除复制缓冲区，并确保它们不会保存在日志记录里面（例如，不要将它们粘贴在普通的终端命令中，因为这些命令会存到 <code>.bash_history</code> 等文件里）。
</p>
<p>最好不要因为安全性强的密码难记而选择不安全的密码，密码是它们之间的一种平衡。与拥有许多相似的弱密码相比，更好的做法是建立一个加密的安全密码数据库，数据库由密钥和一个强主密码保护着。把密码写下来可能同样有效<a rel="nofollow" class="external autonumber" href="https://www.schneier.com/blog/archives/2005/06/write_down_your.html">[1]</a>，这样在增加物理安全需求的同时也避开了软件中的潜在漏洞。
</p>
<p>衡量密码强度的另一个指标是它不能够被轻易从其他地方恢复。
</p>
<p>如果你的登录密码和用于磁盘加密的密码相同（这在登录时自动挂载加密分区或目录很有用），请确保 <code>/etc/shadow</code> 也在加密分区上，或者使用强哈希算法（即 sha512/bcrypt，而不是 md5）来存储密码（详细信息请参阅 <a href="../en/SHA_password_hashes.html" title="SHA password hashes">SHA password hashes</a>）。
</p>
<p>如果要备份密码数据库，请勿将备份的副本存储在密码保护之下（比如存储在加密的驱动器或需要身份验证的远程存储服务），而解锁副本的密码又存储在副本中，这样在需要时将无法访问它（相当于把房间的钥匙锁在了房间里）。一个有用的技巧是，使用主密码的简单哈希来加密存储着密码数据库的驱动器或在线帐户。维护一份记录备份位置的列表：如果有一天觉得主密码被泄露，一是要更改所有数据库备份的密码，二是要使用从新主密码派生的新哈希来保护存有数据库的位置。
</p>
<p>以安全的方式控制数据库的版本可能非常复杂：如果你这样做，那你必须有办法更新所有数据库版本的主密码。主密码泄露时情况可能并不能马上清楚：为了降低其他人在你意识到主密码泄露之前发现密码的风险，可以选择定期更改主密码。如果你觉得自己失去了对数据库副本的控制权，则需要在特定时间内更改副本中包括的所有密码，这一特定时间是暴力破解主密码所用的时间，取决于主密码的熵。
</p>
<h3>
<span id=".E5.AF.86.E7.A0.81.E7.9A.84.E6.95.A3.E5.88.97.E5.80.BC"></span><span class="mw-headline" id="密码的散列值">密码的散列值</span>
</h3>
<div class="noprint archwiki-template-message">
<p><a href="../File:Tango-view-fullscreen.png" class="image"><img alt="Tango-view-fullscreen.png" src="../File:Tango-view-fullscreen.png" decoding="async" width="48" height="48"></a><b>This article or section needs expansion.</b><a href="../File:Tango-view-fullscreen.png" class="image"><img alt="Tango-view-fullscreen.png" src="../File:Tango-view-fullscreen.png" decoding="async" width="48" height="48"></a></p>
<div>
<b>Reason:</b> 提及<a href="https://en.wikipedia.org/wiki/Key_derivation_function" class="extiw" title="wikipedia:Key derivation function">密钥导出函数</a>，特别是 PBKDF2、bcrypt 和 scrypt，应当提及用法、优缺点，基于定制硬件的暴力攻击应当特别提及。 (Discuss in <a rel="nofollow" class="external text" href="https://wiki.archlinux.org/index.php/Talk:Security_(%E7%AE%80%E4%BD%93%E4%B8%AD%E6%96%87)">Talk:Security (简体中文)#</a>)</div>
</div>
<p>默认情况下，Arch 将用户密码散列值存储在仅 root 可读的 <code>/etc/shadow</code> 文件中，与存储在所有人可读的 <code>/etc/passwd</code> 文件中的其他用户参数分开，请参阅 <a href="../zh-CN/Users_and_groups.html#%E7%94%A8%E6%88%B7%E4%BF%A1%E6%81%AF%E5%AD%98%E5%82%A8" title="Users and groups (简体中文)">Users and groups (简体中文)#用户信息存储</a>。另请参阅 <a href="#%E9%99%90%E5%88%B6_root_%E6%9D%83%E9%99%90">#限制 root 权限</a>。
</p>
<p>密码使用 <b>passwd</b> 命令来设置，该命令使用 <a href="https://en.wikipedia.org/wiki/Crypt_(C)" class="extiw" title="wikipedia:Crypt (C)">crypt</a> 函数对密码进行 <a href="https://en.wikipedia.org/wiki/Key_stretching" class="extiw" title="wikipedia:Key stretching">拉伸</a>，然后将它们保存在 <code>/etc/shadow</code> 中。请参阅 <a href="../en/SHA_password_hashes.html" title="SHA password hashes">SHA password hashes</a>。密码也被 <a href="https://en.wikipedia.org/wiki/Salt_(cryptography)" class="extiw" title="wikipedia:Salt (cryptography)">加盐（salted）</a>，以抵御 <a href="https://en.wikipedia.org/wiki/Rainbow_table" class="extiw" title="wikipedia:Rainbow table">彩虹表</a> 攻击。
</p>
<p>另请参阅 <a rel="nofollow" class="external text" href="http://www.slashroot.in/how-are-passwords-stored-linux-understanding-hashing-shadow-utils">在 Linux 中密码如何存储（理解使用 shadow 工具的散列值化）</a>。
</p>
<h3>
<span id=".E7.94.A8_pam_pwquality_.E5.BC.BA.E5.88.B6.E4.BD.BF.E7.94.A8.E5.BC.BA.E5.AF.86.E7.A0.81"></span><span class="mw-headline" id="用_pam_pwquality_强制使用强密码">用 pam_pwquality 强制使用强密码</span>
</h3>
<p><i>pam_pwquality</i> 提供针对 <a href="https://en.wikipedia.org/wiki/Dictionary_attack" class="extiw" title="wikipedia:Dictionary attack">字典攻击</a> 的保护，并可用于配置在整个系统中实施的密码策略。它基于 <i>pam_cracklib</i>，故也向后兼容其选项。
</p>
<p><a href="../zh-CN/Help:Reading.html#%E5%AE%89%E8%A3%85%E8%BD%AF%E4%BB%B6%E5%8C%85" title="Help:Reading (简体中文)">安装</a> <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=libpwquality">libpwquality</a></span> 软件包。
</p>
<div class="archwiki-template-box archwiki-template-box-warning">
<strong>警告：</strong> <i>root</i> 账户默认不会受此策略影响。</div>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>注意：</strong> 可以用 <i>root</i> 帐户来帮助想绕过策略的用户设置他们的密码。这在设置临时密码时很有用。</div>
<p>举个例子，假设要强制执行下面的策略：
</p>
<ul>
<li>如果密码错误，请提示 2 次（retry 选项）</li>
<li>最小长度为10个字符（minlen 选项）</li>
<li>输入新密码时，新密码应至少有 6 个字符与旧密码不同（difok 选项）</li>
<li>至少 1 个数字（dcredit 选项）</li>
<li>至少 1 个大写字母（ucredit 选项）</li>
<li>至少 1 个小写字母（lcredit 选项）</li>
<li>至少 1 个除上述之外的其他字符（ocredit 选项）</li>
<li>不能包含单词 "myservice" 和 "mydomain"</li>
<li>为 root 应用此策略</li>
</ul>
<p>编辑 <code>/etc/pam.d/passwd</code> 文件，把它改成：
</p>
<pre>#%PAM-1.0
password required pam_pwquality.so retry=2 minlen=10 difok=6 dcredit=-1 ucredit=-1 ocredit=-1 lcredit=-1 [badwords=myservice mydomain] enforce_for_root
password required pam_unix.so use_authtok sha512 shadow</pre>
<p><code>password required pam_unix.so use_authtok</code> 用来告诉 <i>pam_unix</i> 模块不要显示输入密码的提示符，而采用 <i>pam_pwquality</i> 所提供的。
</p>
<p>更多信息可以参考 <span class="plainlinks archwiki-template-man" title="$ man 8 pam_pwquality"><a rel="nofollow" class="external text" href="https://man.archlinux.org/man/pam_pwquality.8">pam_pwquality(8)</a></span> 和 <span class="plainlinks archwiki-template-man" title="$ man 8 pam_unix"><a rel="nofollow" class="external text" href="https://man.archlinux.org/man/pam_unix.8">pam_unix(8)</a></span> 手册页。
</p>
<h2><span class="mw-headline" id="CPU">CPU</span></h2>
<h3>
<span id=".E5.BE.AE.E7.A0.81"></span><span class="mw-headline" id="微码">微码</span>
</h3>
<p>关于如何为CPU微码安装重要安全更新的信息见<a href="../zh-CN/Microcode.html" title="Microcode (简体中文)">微码</a>。
</p>
<h3>
<span id=".E7.A1.AC.E4.BB.B6.E6.BC.8F.E6.B4.9E"></span><span class="mw-headline" id="硬件漏洞">硬件漏洞</span>
</h3>
<p>有些 CPU 存在硬件漏洞。这些漏洞的列表见<a rel="nofollow" class="external text" href="https://www.kernel.org/doc/html/latest/admin-guide/hw-vuln/">关于硬件漏洞的 Linux 内核文档</a>，其中也包含了修补方法选择指南，有助于针对特定使用场景自定义内核，从而修补这些漏洞。
</p>
<p>要检查是否受到已知漏洞影响，请运行：
</p>
<pre>$ grep -r . /sys/devices/system/cpu/vulnerabilities/
</pre>
<p>大部分情况下，更新内核和微码能够修补漏洞。
</p>
<h4>
<span id=".E5.90.8C.E6.AD.A5.E5.A4.9A.E7.BA.BF.E7.A8.8B.EF.BC.88.E8.B6.85.E7.BA.BF.E7.A8.8B.EF.BC.89"></span><span class="mw-headline" id="同步多线程（超线程）">同步多线程（超线程）</span>
</h4>
<p><a href="https://en.wikipedia.org/wiki/zh:%E5%90%8C%E6%97%B6%E5%A4%9A%E7%BA%BF%E7%A8%8B" class="extiw" title="wikipedia:zh:同时多线程">同步多线程</a>（SMT），在英特尔 CPU 上又称超线程，这一硬件功能可能是 <a rel="nofollow" class="external text" href="https://www.kernel.org/doc/html/latest/admin-guide/hw-vuln/l1tf.html">L1 Terminal Fault</a> 与 <a rel="nofollow" class="external text" href="https://www.kernel.org/doc/html/latest/admin-guide/hw-vuln/mds.html">微架构数据采样（Microarchitectural Data Sampling）</a> 漏洞的来源。 Linux 内核和微码更新含有针对已知漏洞的补丁，但是<a rel="nofollow" class="external text" href="https://www.kernel.org/doc/html/latest/admin-guide/hw-vuln/l1tf.html#virtualization-with-untrusted-guests">如果存在不受信任的虚拟化客户机，则对于某些 CPU 可能仍然需要禁用 SMT</a>。
</p>
<p>SMT 往往可以在系统固件中关闭。更多信息见主板或系统文档。通过添加以下<a href="../zh-CN/Kernel_parameters.html" title="Kernel parameters (简体中文)">内核参数</a>，也可以在内核中禁用 SMT：
</p>
<pre>l1tf=full,force mds=full,nosmt mitigations=auto,nosmt nosmt=force
</pre>
<h2>
<span id=".E5.AD.98.E5.82.A8"></span><span class="mw-headline" id="存储">存储</span>
</h2>
<h3>
<span id=".E7.A3.81.E7.9B.98.E5.8A.A0.E5.AF.86"></span><span class="mw-headline" id="磁盘加密">磁盘加密</span>
</h3>
<p>进行<a href="../en/Data-at-rest_encryption.html" class="mw-redirect" title="Disk encryption">磁盘加密</a>时最好使用<a href="#%E5%AF%86%E7%A0%81">强密码</a>进行全盘加密，这是保护数据免受物理恢复的唯一方法。这也可以在计算机关闭或相关硬盘卸载时充分保护数据安全。
</p>
<p>当然，一旦计算机启动，磁盘挂载完毕，这些数据就像存储在未加密的磁盘上一样易受攻击。因此，最佳做法是在不需要用到数据分区时立即卸载它们。
</p>
<p>部分程序，比如 <a href="../en/Dm-crypt.html" title="Dm-crypt">dm-crypt</a>，允许用户加密 Loop 文件并将其作为虚拟卷使用。当系统只有特定的部分需要加密时，这种方法可以替代全盘加密。
</p>
<h3>
<span id=".E6.96.87.E4.BB.B6.E7.B3.BB.E7.BB.9F"></span><span class="mw-headline" id="文件系统">文件系统</span>
</h3>
<p>如果用 sysctl 启用了内核的 <code>fs.protected_hardlinks</code> 和 <code>fs.protected_symlinks</code> 选项，内核就可以防止出现硬链接和软链接（符号链接）相关的安全问题。因此将全局可写的目录独立出来不再具有安全方面的优势。
</p>
<p>包含全局可写目录的文件系统仍然可以作为一种防止磁盘空间耗尽的粗略手段。但是，把 <code>/var</code> 或 <code>/tmp</code> 所在分区塞满也足以使系统停止响应。处理这种问题的更灵活的机制是存在的（比如 <a href="../en/Disk_quota.html" title="Disk quota">磁盘配额</a>），并且某些 <a href="../zh-CN/File_systems.html" title="File systems (简体中文)">文件系统</a> 自身就带有相关功能（Btrfs 的子卷可以设置配额）。
</p>
<h4>
<span id=".E6.8C.82.E8.BD.BD.E7.82.B9"></span><span class="mw-headline" id="挂载点">挂载点</span>
</h4>
<p>根据最小权限原则，挂载文件系统时应该采用最为严格的挂载选项（在不损失功能的情况下）。
</p>
<p>相关的挂载选项有：
</p>
<ul>
<li>
<code>nodev</code>: 文件系统中，禁止解释任何字符或屏蔽特殊设备。</li>
<li>
<code>nosuid</code>: 禁止 set-user-identifier 或 set-group-identifier 标志位生效。</li>
<li>
<code>noexec</code>: 禁止文件系统里的任何二进制文件直接运行。
<ul>
<li>在 <code>/home</code> 上设置 <code>noexec</code> 选项会禁用可执行脚本，影响 <a href="../en/Wine.html" title="Wine">Wine</a>* 、PyCharm 和 <a href="../en/Steam.html" title="Steam">Steam</a> 等正常运行。</li>
<li>部分软件包（比如编译 <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=nvidia-dkms">nvidia-dkms</a></span>）可能需要 <code>/var</code> 有 <code>exec</code> 权限。</li>
</ul>
</li>
</ul>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>注意：</strong> Wine 运行 Windows 应用时不需要 <code>exec</code> （可执行）标识，仅在 Wine 自身安装在 <code>/home</code> 时需要。</div>
<p>用于存放数据的文件系统应该坚持使用 <code>nodev</code>、<code>nosuid</code> 和 <code>noexec</code> 挂载。
</p>
<p>可能的文件系统划分参考：
</p>
<ul>
<li><code>/var</code></li>
<li><code>/home</code></li>
<li><code>/dev/shm</code></li>
<li><code>/tmp</code></li>
<li><code>/boot</code></li>
</ul>
<h3>
<span id=".E6.96.87.E4.BB.B6.E8.AE.BF.E9.97.AE.E6.9D.83.E9.99.90"></span><span class="mw-headline" id="文件访问权限">文件访问权限</span>
</h3>
<p>默认的 <a href="../en/File_permissions_and_attributes.html" class="mw-redirect" title="File permissions">文件权限</a> 对几乎所有文件都赋予了读权限，修改文件权限可以在取得了非 root 账户（如<code>http</code> 或 <code>nobody</code> 账户）的攻击者面前隐藏有价值的信息。
</p>
<p>例如：
</p>
<pre># chmod 700 /boot /etc/{iptables,arptables}
</pre>
<p>可以修改默认的 <a href="../en/Umask.html" title="Umask">Umask</a> <code>0022</code> 来为新建的文件提高安全性。<a rel="nofollow" class="external text" href="https://apps.nsa.gov/iaarchive/library/ia-guidance/security-configuration/operating-systems/guide-to-the-secure-configuration-of-red-hat-enterprise.cfm">NSA RHEL5 安全指南</a>建议将 umask 设置为 <code>0077</code> 以获得最充分的安全性，这将使得新文件无法被创建者之外的用户读取。要修改 umask，参见 <a href="../en/Umask.html#Set_the_mask_value" title="Umask">Umask#Set the mask value</a>。
</p>
<h2>
<span id=".E8.B4.A6.E6.88.B7.E8.AE.BE.E7.BD.AE"></span><span class="mw-headline" id="账户设置">账户设置</span>
</h2>
<h3>
<span id=".E4.B8.8D.E8.A6.81.E6.97.A5.E5.B8.B8.E4.BD.BF.E7.94.A8_root_.E8.B4.A6.E6.88.B7"></span><span class="mw-headline" id="不要日常使用_root_账户">不要日常使用 root 账户</span>
</h3>
<p>根据最小权限原则，不要日常使用 root 账户。给每个使用系统的人建立一个没有特权的用户账户。必要时使用 <a href="../zh-CN/Sudo.html" title="Sudo (简体中文)">Sudo</a> 临时以高权限访问。
</p>
<h3>
<span id=".E5.9C.A8.E5.A4.B1.E8.B4.A5.E7.9A.84.E7.99.BB.E5.BD.95.E5.B0.9D.E8.AF.95.E5.90.8E.E5.BC.BA.E5.88.B6.E5.BB.B6.E6.97.B6.E4.B8.80.E6.AE.B5.E6.97.B6.E9.97.B4"></span><span class="mw-headline" id="在失败的登录尝试后强制延时一段时间">在失败的登录尝试后强制延时一段时间</span>
</h3>
<p>将下方的行添加至 <code>/etc/pam.d/system-login</code> 即可在失败的登录尝试后延时至少 4 秒：
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/pam.d/system-login</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">auth optional pam_faildelay.so delay=4000000</pre>
<p><code>4000000</code> 是延时的微秒数。
</p>
<h3>
<span id=".E5.9C.A8.E4.B8.89.E6.AC.A1.E7.99.BB.E5.BD.95.E5.B0.9D.E8.AF.95.E5.A4.B1.E8.B4.A5.E5.90.8E.E5.B0.81.E9.94.81.E7.94.A8.E6.88.B7"></span><span class="mw-headline" id="在三次登录尝试失败后封锁用户">在三次登录尝试失败后封锁用户</span>
</h3>
<p>至 <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=pambase">pambase</a></span> 20200721.1-2时，<code>pam_faillock.so</code> 默认启用，在15分钟内3次失败的登录尝试之后会封锁用户10分钟（见 <a rel="nofollow" class="external text" href="https://bugs.archlinux.org/task/67644">FS#67644</a>）。这一封锁只适用于密码认证（如登陆及 sudo），通过 SSH 的公钥认证仍然会被接受。为防止彻底拒绝服务，该封锁对于 root 禁用。
</p>
<p>要解锁用户，执行：
</p>
<pre>$ faillock --reset --user <i>username</i>
</pre>
<p>默认情况下，封锁机制为每个用户一个文件，位于 <code>/run/faillock/</code>。删除或清空此文件及可解锁该用户——该目录是由 root 所有，但文件是由该用户所有，故 <code>faillock</code> 命令只会清空文件，因此并不需要 root。
</p>
<p><code>pam_faillock.so</code> 模块可通过文件 <code>/etc/security/faillock.conf</code> 配置。封锁参数：
</p>
<ul>
<li>
<code>unlock_time</code> — 封锁时间（单位为秒，默认10分钟）。</li>
<li>
<code>fail_interval</code> — 导致封锁的失败尝试时间范围（单位为秒，默认15分钟）。</li>
<li>
<code>deny</code> — 封锁前允许的登录失败次数（默认为3）。</li>
</ul>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>注意：</strong> <code>deny = 0</code> 会禁用封锁。</div>
<p>更改无需重启即可生效。更多配置选项见 <span class="plainlinks archwiki-template-man" title="$ man 5 faillock.conf"><a rel="nofollow" class="external text" href="https://man.archlinux.org/man/faillock.conf.5">faillock.conf(5)</a></span> ，如启用 root 账户封锁、在中心化登录（如 LDAP）情况下禁用等。
</p>
<h3>
<span id=".E9.99.90.E5.88.B6.E8.BF.9B.E7.A8.8B.E6.95.B0.E9.87.8F"></span><span class="mw-headline" id="限制进程数量">限制进程数量</span>
</h3>
<p>在有很多用户或存在不可信用户的系统上，限制每个用户同时可运行的进程数很重要，这样可以防止 <a href="https://en.wikipedia.org/wiki/Fork_bomb" class="extiw" title="wikipedia:Fork bomb">fork bombs</a> 以及其他拒绝服务攻击。<code>/etc/security/limits.conf</code> 决定了每个用户或组可以运行的进程数，默认情况下为空（除了有用的注释）。将以下行添加到此文件将限制所有用户每位最多运行 100 个活动进程，除非他们使用 <code>prlimit</code> 命令将此次会话的最大值显式地提高到 200。可以根据用户应当运行的进程数量或当前管理的系统的硬件条件来确定这些值。
</p>
<pre>* soft nproc 100
* hard nproc 200
</pre>
<p>当前每个用户运行的进程数量可以使用 <code>ps --no-headers -Leo user | sort | uniq -c</code> 查看。这可以帮助确定合适的进程限额。
</p>
<h3>
<span id=".E9.9D.9E_root_.E8.BF.90.E8.A1.8C_Xorg"></span><span class="mw-headline" id="非_root_运行_Xorg">非 root 运行 Xorg</span>
</h3>
<p>由于其架构和过时的设计，<a href="../zh-CN/Xorg.html" title="Xorg (简体中文)">Xorg</a> 通常 <a rel="nofollow" class="external text" href="https://security.stackexchange.com/questions/4641/why-are-people-saying-that-the-x-window-system-is-not-secure/4646#4646">被认为是不安全的</a>。因此建议避免以 root 身份运行它。
</p>
<p>有关如何在没有 root 权限的情况下运行 Xorg 的详细信息，请参阅 <a href="../zh-CN/Xorg.html#%E6%B2%A1%E6%9C%89_root_%E6%9D%83%E9%99%90%E7%9A%84_Xorg" title="Xorg (简体中文)">Xorg_(简体中文)#没有_root_权限的_Xorg</a>。或者使用 <a href="../zh-CN/Wayland.html" title="Wayland (简体中文)">Wayland</a> 代替 Xorg。
</p>
<h2>
<span id=".E9.99.90.E5.88.B6_root_.E6.9D.83.E9.99.90"></span><span class="mw-headline" id="限制_root_权限">限制 root 权限</span>
</h2>
<p>按照系统的设计，root 用户是系统中最强大的用户。因为这样，有许多方法可以既保持 root 用户的权限，同时限制其造成破坏的能力，或者至少可以追溯 root 用户的操作。
</p>
<h3>
<span id=".E7.94.A8_sudo_.E6.9B.BF.E4.BB.A3_su"></span><span class="mw-headline" id="用_sudo_替代_su">用 sudo 替代 su</span>
</h3>
<div class="noprint archwiki-template-message">
<p><a href="../File:Merge-arrows-2.png" class="image"><img alt="Merge-arrows-2.png" src="../File:Merge-arrows-2.png" decoding="async" width="48" height="48"></a><b>This article or section is a candidate for merging with <a href="../en/Sudo.html" title="Sudo">sudo</a>.</b><a href="../File:Merge-arrows-2.png" class="image"><img alt="Merge-arrows-2.png" src="../File:Merge-arrows-2.png" decoding="async" width="48" height="48"></a></p>
<div>
<b>Notes:</b> 这是一篇专门说明 sudo 的文章。 (Discuss in <a rel="nofollow" class="external text" href="https://wiki.archlinux.org/index.php/Talk:Security_(%E7%AE%80%E4%BD%93%E4%B8%AD%E6%96%87)">Talk:Security (简体中文)#</a>)</div>
</div>
<p>出于 <a href="../zh-CN/Su.html#%E5%8F%A6%E4%B8%80%E4%B8%AA%E9%80%89%E6%8B%A9%EF%BC%9ASudo" title="Su (简体中文)">多种原因</a>，使用 <a href="../zh-CN/Sudo.html" title="Sudo (简体中文)">sudo</a> 进行特权访问比 <a href="../zh-CN/Su.html" title="Su (简体中文)">su</a> 更好。
</p>
<ul>
<li>sudo 记录了普通权限用户运行每个特权命令的日志。</li>
<li>root 用户的密码不需要告知每个请求 root 权限的用户。</li>
<li>
<code>sudo</code> 可以防止用户意外地以 <i>root</i> 身份执行无需该权限的命令，因为 sudo 并没有为 root 创建完整的终端。这符合 <a href="https://en.wikipedia.org/wiki/Principle_of_least_privilege" class="extiw" title="wikipedia:Principle of least privilege">最小权限原则</a>。</li>
<li class="mw-empty-elt">
</ul>
<p>可以为单个用户启用单个程序的 root 权限，而不用为了运行一个程序启用该用户对 root 的完整访问权。例如，要授予用户 <i>alice</i> 对特定程序的访问权限：
</p>
<pre># visudo
</pre>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/sudoers</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">alice ALL = NOPASSWD: /path/to/program
</pre>
<p>另外，也可以为所有用户开放单个程序。例如允许以普通用户身份从服务器挂载 Samba 共享：
</p>
<pre>%users ALL=/sbin/mount.cifs,/sbin/umount.cifs
</pre>
<p>这将允许 users 组中的所有用户从任何机器 (ALL) 运行此系统的 <code>/sbin/mount.cifs</code> 和 <code>/sbin/umount.cifs</code> 命令。
</p>
<div class="archwiki-template-box archwiki-template-box-tip">
<strong>提示：</strong> 
<p>要 <code>visudo</code> 使用指定版本的 <code>nano</code> 而不是 <code>vi</code>，
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/sudoers</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">Defaults editor=/usr/bin/rnano</pre>
<p>Export <code># EDITOR=nano visudo</code> 被认为存在严重安全风险，因为任何程序都可以作为 <code>EDITOR</code>。
</p>
</div>
<h4>
<span id=".E4.BD.BF.E7.94.A8_sudo_.E7.BC.96.E8.BE.91.E6.96.87.E4.BB.B6"></span><span class="mw-headline" id="使用_sudo_编辑文件">使用 sudo 编辑文件</span>
</h4>
<p>以 root 身份运行文本编辑器可能会变成安全漏洞，因为许多编辑器可以运行任意 shell 命令或更改正在编辑的文件以外的文件。要避免这一风险，请用 <code>sudoedit filename</code>（等同于 <code>sudo -e filename</code>）编辑文件。这将使用普通用户的权限来编辑文件的副本，在编辑器关闭后会使用 sudo 覆盖原始文件。可以通过设置 <code>SUDO_EDITOR</code> 环境变量来更改所使用的编辑器：
</p>
<pre>$ export SUDO_EDITOR=vim
</pre>
<p>也可以使用类似 <code>rvim</code> 这样的编辑器，它功能受限，以便以 root 用户身份安全运行。
</p>
<h3>
<span id=".E9.99.90.E5.88.B6_root_.E7.99.BB.E5.BD.95"></span><span class="mw-headline" id="限制_root_登录">限制 root 登录</span>
</h3>
<p>正确配置 <a href="../en/Sudo.html" title="Sudo">sudo</a> 后，完全的 root 权限就可以被严格限制或停用，且不会损失太多可用性。要禁用 root 而允许使用 <a href="../en/Sudo.html" title="Sudo">sudo</a>，可以运行 <code>passwd -l root</code>。
</p>
<h4>
<span id=".E4.BB.85.E5.85.81.E8.AE.B8.E7.89.B9.E5.AE.9A.E7.94.A8.E6.88.B7"></span><span class="mw-headline" id="仅允许特定用户">仅允许特定用户</span>
</h4>
<p><a href="../en/PAM.html" title="PAM">PAM</a> 的 <code>pam_wheel.so</code> 模块可以做到仅允许 <code>wheel</code> 组中的用户使用 <code>su</code> 登录。编辑 <code>/etc/pam.d/su</code> 和 <code>/etc/pam.d/su-l</code> 两份文件，去掉以下行的注释：
</p>
<pre># Uncomment the following line to require a user to be in the "wheel" group.
auth		required	pam_wheel.so use_uid
</pre>
<p>这一行表示只有已经能够运行特权命令的用户才能以 root 用户身份登录。
</p>
<h4>
<span id=".E6.8B.92.E7.BB.9D_SSH_.E7.99.BB.E5.BD.95"></span><span class="mw-headline" id="拒绝_SSH_登录">拒绝 SSH 登录</span>
</h4>
<p>即使你不想禁止 root 用户在本地登录，也最好 <a href="../zh-CN/Secure_Shell.html#%E7%A6%81%E7%94%A8_root_%E7%99%BB%E5%BD%95" title="Secure Shell (简体中文)">禁止 root 通过 SSH 登录</a><sup>[<a href="../en/ArchWiki:Requests.html#Broken_section_links" class="mw-redirect" title="ArchWiki:Requests">断开的链接</a>：无效的部分]</sup>。这样做的目的是在用户可以在远程完全破坏系统之前添加额外的一层安全保护。
</p>
<h2>
<span id=".E5.BC.BA.E5.88.B6.E8.AE.BF.E9.97.AE.E6.8E.A7.E5.88.B6"></span><span class="mw-headline" id="强制访问控制">强制访问控制</span>
</h2>
<p><a href="https://en.wikipedia.org/wiki/Mandatory_Access_Control" class="extiw" title="wikipedia:Mandatory Access Control">Mandatory access control</a>（MAC, 强制访问控制）是一种安全策略，它与 Arch 以及大部分 Linux 发行版默认使用的 <a href="https://en.wikipedia.org/wiki/Discretionary_Access_Control" class="extiw" title="wikipedia:Discretionary Access Control">Discretionary access control</a> （DAC, 自主访问控制）有很大的不同。MAC 本质上是对照着一个安全规则集，检查程序的每一个可能对系统造成影响的操作。与 DAC 方式相比，用户不能修改 MAC 的规则集。使用几乎任何强制访问控制系统都将显著提高计算机的安全性，尽管它们的实现方式存在差异。
</p>
<h3>
<span id=".E5.9F.BA.E4.BA.8E.E8.B7.AF.E5.BE.84.E7.9A.84.E5.BC.BA.E5.88.B6.E8.AE.BF.E9.97.AE.E6.8E.A7.E5.88.B6"></span><span class="mw-headline" id="基于路径的强制访问控制">基于路径的强制访问控制</span>
</h3>
<p>基于路径的访问控制是一种简单的访问控制形式，它根据文件的路径提供相应的权限。这种方式有个缺点，就是当文件改变路径以后相应的权限并没有随着文件一起移动。从积极的方面来说，基于路径的 MAC 可以在更广泛的文件系统上实现，这与基于标签的另一种可选方案是不同的。
</p>
<ul><li class="mw-empty-elt"></ul>
<p><a href="../en/AppArmor.html" title="AppArmor">AppArmor</a> 是一个由 <a href="https://en.wikipedia.org/wiki/Canonical" class="extiw" title="wikipedia:Canonical">Canonical</a> 维护的 MAC 实现，它被看做是 SELinux 的简化版替代方案。
</p>
<ul><li class="mw-empty-elt"></ul>
<p><a href="../en/TOMOYO_Linux.html" class="mw-redirect" title="Tomoyo">Tomoyo</a> 是另一种提供访问控制的系统，简单而易用。它的使用方式和内部实现都被设计得足够简单，需要的依赖也很少。
</p>
<h3>
<span id=".E5.9F.BA.E4.BA.8E.E6.A0.87.E7.AD.BE.E7.9A.84.E5.BC.BA.E5.88.B6.E8.AE.BF.E9.97.AE.E6.8E.A7.E5.88.B6"></span><span class="mw-headline" id="基于标签的强制访问控制">基于标签的强制访问控制</span>
</h3>
<p>基于标签的访问控制意味着每份文件都带有扩展属性用于决定它的安全权限。虽然这类系统应该比基于路径的控制更灵活，但它只适用于支持这些扩展属性的文件系统。
</p>
<ul><li class="mw-empty-elt"></ul>
<p><a href="../en/SELinux.html" title="SELinux">SELinux</a> 是一个基于 <a href="https://en.wikipedia.org/wiki/NSA" class="extiw" title="wikipedia:NSA">NSA</a> 的项目，用于提高 Linux 的安全性。它完整实现了 MAC，将系统用户与角色独立开来。它实现了一个非常强大的多级 MAC 策略，可以在系统扩大和改变得超出其原始配置时也能轻松控制系统。
</p>
<h3>
<span id=".E8.AE.BF.E9.97.AE.E6.8E.A7.E5.88.B6.E8.A1.A8_.28ACLs.29"></span><span class="mw-headline" id="访问控制表_(ACLs)">访问控制表 (ACLs)</span>
</h3>
<p><a href="../en/Access_Control_Lists.html" title="Access Control Lists">Access Control Lists</a>（ACLs，访问控制表）是以某种方式将规则直接附加到文件系统的一种可选方法。ACLs 将程序的实际操作与允许的操作对照，来实现访问控制。
</p>
<h2>
<span id=".E5.86.85.E6.A0.B8.E5.8A.A0.E5.9B.BA"></span><span class="mw-headline" id="内核加固">内核加固</span>
</h2>
<h3>
<span id=".E5.86.85.E6.A0.B8.E8.87.AA.E6.88.91.E4.BF.9D.E6.8A.A4_.2F_.E6.BC.8F.E6.B4.9E.E9.98.B2.E6.8A.A4"></span><span class="mw-headline" id="内核自我保护_/_漏洞防护">内核自我保护 / 漏洞防护</span>
</h3>
<p><span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=linux-hardened">linux-hardened</a></span> 相较于 <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=linux">linux</a></span> 使用了 <a rel="nofollow" class="external text" href="https://github.com/anthraxx/linux-hardened">基本内核加固补丁集</a> 和更多安全相关的编译时配置选项。也可以使用自定义编译选项来把握安全性和性能之间的平衡，而不是使用强调安全性的默认选项。
</p>
<p>如果你用了内核代码树以外的驱动，比如 <a href="../zh-CN/NVIDIA.html" title="NVIDIA (简体中文)">NVIDIA</a>，可能会需要切换到它的 <a href="../zh-CN/Dynamic_Kernel_Module_Support.html" title="Dynamic Kernel Module Support (简体中文)">DKMS</a> 包。
</p>
<h4>
<span id=".E7.94.A8.E6.88.B7.E7.A9.BA.E9.97.B4_ASLR_.E6.AF.94.E8.BE.83"></span><span class="mw-headline" id="用户空间_ASLR_比较">用户空间 ASLR 比较</span>
</h4>
<p><span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=linux-hardened">linux-hardened</a></span> 包为用户空间进程提供了改进的 ASLR（Address Space Layout Randomization，地址空间布局随机化）实现。<span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=paxtest">paxtest</a></span> 命令可用于获取所提供熵的估计值：
</p>
<h5>
<span id="64_.E4.BD.8D.E8.BF.9B.E7.A8.8B"></span><span class="mw-headline" id="64_位进程">64 位进程</span>
</h5>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">linux-hardened</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">Anonymous mapping randomization test     : 32 quality bits (guessed)
Heap randomization test (ET_EXEC)        : 26 quality bits (guessed)
Heap randomization test (PIE)            : 40 quality bits (guessed)
Main executable randomization (ET_EXEC)  : No randomization
Main executable randomization (PIE)      : 32 quality bits (guessed)
Shared library randomization test        : 32 quality bits (guessed)
VDSO randomization test                  : 32 quality bits (guessed)
Stack randomization test (SEGMEXEC)      : 40 quality bits (guessed)
Stack randomization test (PAGEEXEC)      : 40 quality bits (guessed)
Arg/env randomization test (SEGMEXEC)    : 44 quality bits (guessed)
Arg/env randomization test (PAGEEXEC)    : 44 quality bits (guessed)
Offset to library randomisation (ET_EXEC): 32 quality bits (guessed)
Offset to library randomisation (ET_DYN) : 34 quality bits (guessed)
Randomization under memory exhaustion @~0: 32 bits (guessed)
Randomization under memory exhaustion @0 : 32 bits (guessed)
</pre>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">linux</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">Anonymous mapping randomization test     : 28 quality bits (guessed)
Heap randomization test (ET_EXEC)        : 13 quality bits (guessed)
Heap randomization test (PIE)            : 28 quality bits (guessed)
Main executable randomization (ET_EXEC)  : No randomization
Main executable randomization (PIE)      : 28 quality bits (guessed)
Shared library randomization test        : 28 quality bits (guessed)
VDSO randomization test                  : 20 quality bits (guessed)
Stack randomization test (SEGMEXEC)      : 30 quality bits (guessed)
Stack randomization test (PAGEEXEC)      : 30 quality bits (guessed)
Arg/env randomization test (SEGMEXEC)    : 22 quality bits (guessed)
Arg/env randomization test (PAGEEXEC)    : 22 quality bits (guessed)
Offset to library randomisation (ET_EXEC): 28 quality bits (guessed)
Offset to library randomisation (ET_DYN) : 28 quality bits (guessed)
Randomization under memory exhaustion @~0: 28 bits (guessed)
Randomization under memory exhaustion @0 : 28 bits (guessed)
</pre>
<h5>
<span id="32_.E4.BD.8D.E8.BF.9B.E7.A8.8B.EF.BC.88.E8.BF.90.E8.A1.8C.E5.9C.A8_x86_64_.E5.86.85.E6.A0.B8.E4.B8.8A.EF.BC.89"></span><span class="mw-headline" id="32_位进程（运行在_x86_64_内核上）">32 位进程（运行在 x86_64 内核上）</span>
</h5>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">linux-hardened</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">Anonymous mapping randomization test     : 16 quality bits (guessed)
Heap randomization test (ET_EXEC)        : 22 quality bits (guessed)
Heap randomization test (PIE)            : 27 quality bits (guessed)
Main executable randomization (ET_EXEC)  : No randomization
Main executable randomization (PIE)      : 18 quality bits (guessed)
Shared library randomization test        : 16 quality bits (guessed)
VDSO randomization test                  : 16 quality bits (guessed)
Stack randomization test (SEGMEXEC)      : 24 quality bits (guessed)
Stack randomization test (PAGEEXEC)      : 24 quality bits (guessed)
Arg/env randomization test (SEGMEXEC)    : 28 quality bits (guessed)
Arg/env randomization test (PAGEEXEC)    : 28 quality bits (guessed)
Offset to library randomisation (ET_EXEC): 18 quality bits (guessed)
Offset to library randomisation (ET_DYN) : 16 quality bits (guessed)
Randomization under memory exhaustion @~0: 18 bits (guessed)
Randomization under memory exhaustion @0 : 18 bits (guessed)
</pre>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">linux</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">Anonymous mapping randomization test     : 8 quality bits (guessed)
Heap randomization test (ET_EXEC)        : 13 quality bits (guessed)
Heap randomization test (PIE)            : 13 quality bits (guessed)
Main executable randomization (ET_EXEC)  : No randomization
Main executable randomization (PIE)      : 8 quality bits (guessed)
Shared library randomization test        : 8 quality bits (guessed)
VDSO randomization test                  : 8 quality bits (guessed)
Stack randomization test (SEGMEXEC)      : 19 quality bits (guessed)
Stack randomization test (PAGEEXEC)      : 19 quality bits (guessed)
Arg/env randomization test (SEGMEXEC)    : 11 quality bits (guessed)
Arg/env randomization test (PAGEEXEC)    : 11 quality bits (guessed)
Offset to library randomisation (ET_EXEC): 8 quality bits (guessed)
Offset to library randomisation (ET_DYN) : 13 quality bits (guessed)
Randomization under memory exhaustion @~0: No randomization
Randomization under memory exhaustion @0 : No randomization
</pre>
<h3>
<span id=".E9.99.90.E5.88.B6.E8.AE.BF.E9.97.AE.E5.86.85.E6.A0.B8.E6.97.A5.E5.BF.97"></span><span class="mw-headline" id="限制访问内核日志">限制访问内核日志</span>
</h3>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>注意：</strong> 这个功能在 <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=linux-hardened">linux-hardened</a></span> 中是默认打开的。</div>
<p>内核日志包含了那些试图利用内核漏洞（如敏感内存地址）的攻击者的有用信息。<code>kernel.dmesg_restrict</code> 标记可以禁止不带 <code>CAP_SYS_ADMIN</code> 能力的进程访问内核日志（默认只有 root 运行的进程带有该能力）。
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/sysctl.d/50-dmesg-restrict.conf</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">kernel.dmesg_restrict = 1</pre>
<h3>
<span id=".E9.99.90.E5.88.B6.E8.AE.BF.E9.97.AE_proc_.E6.96.87.E4.BB.B6.E7.B3.BB.E7.BB.9F.E4.B8.AD.E7.9A.84.E5.86.85.E6.A0.B8.E6.8C.87.E9.92.88"></span><span class="mw-headline" id="限制访问_proc_文件系统中的内核指针">限制访问 proc 文件系统中的内核指针</span>
</h3>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>注意：</strong> <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=linux-hardened">linux-hardened</a></span> 默认设置是 <code>kptr_restrict=2</code> 而不是 <code>0</code>。</div>
<p>将 <code>kernel.kptr_restrict</code> 设置为 1 将针对没有 <code>CAP_SYSLOG</code> 的普通用户隐藏 <code>/proc/kallsyms</code> 中的内核符号地址，这使得利用内核漏洞动态解析地址/符号变得更加困难。这对预编译好的 Arch Linux 内核没有多大帮助，因为攻击者可以直接下载到内核包并从那里手动获取符号，但如果你正在编译自己的内核，这可以帮助减轻本地根攻击。这样做以后会影响非 root 用户运行部分 <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=perf">perf</a></span> 命令（虽然很多 <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=perf">perf</a></span> 功能本身就需要 root 权限）。更多信息请参见 <a rel="nofollow" class="external text" href="https://bugs.archlinux.org/task/34323">FS#34323</a>。
</p>
<p>将  <code>kernel.kptr_restrict</code> 设置为 2 将隐藏 <code>/proc/kallsyms</code> 中的内核符号地址，而忽略用户的权限。
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/sysctl.d/50-kptr-restrict.conf</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">kernel.kptr_restrict = 1</pre>
<h3>
<span id=".E7.A6.81.E7.94.A8_BPF_.E5.8D.B3.E6.97.B6.E7.BC.96.E8.AF.91"></span><span class="mw-headline" id="禁用_BPF_即时编译">禁用 BPF 即时编译</span>
</h3>
<p>Linux 内核有一个功能，就是将 BPF/Seccomp 规则集编译为原生代码来优化性能。<code>net.core.bpf_jit_enable</code> 标志位应设置为 <code>0</code> 以获得最大安全性。
</p>
<p>BPF/Seccomp 编译在特定领域中很有用，比如各类动态服务（类似 Mesos 和 Kubernetes 这样的集群管理平台），它通常不适用于桌面用户或静态服务。JIT 编译器为攻击者提供了进行堆喷射攻击 (Heap spraying attack) 的可能性。在这种攻击中，他们用恶意代码填充内核堆，然后利用另一个漏洞执行此代码，比如解除引用一个不正确的函数指针。2018 年早先公布的 <a href="https://en.wikipedia.org/wiki/Spectre_(security_vulnerability)" class="extiw" title="wikipedia:Spectre (security vulnerability)">幽灵</a> 漏洞，是其最为突出的一次利用过程。
</p>
<p><br>
</p>
<h3>
<span id="ptrace_.E7.9A.84.E5.8F.AF.E8.B0.83.E7.94.A8.E8.8C.83.E5.9B.B4"></span><span class="mw-headline" id="ptrace_的可调用范围">ptrace 的可调用范围</span>
</h3>
<p>Arch 默认启用了 Yama LSM，提供了 <code>kernel.yama.ptrace_scope</code> 标志位作为开关。默认情况下这个开关是打开的，它可以使得没有 <code>CAP_SYS_PTRACE</code> 能力的进程无法对其作用域之外的其他进程执行 <code>ptrace</code> 调用。虽然许多调试工具需要 <code>ptrace</code> 来实现某些功能，但这一修改显著提高了安全性。如果没有此功能，且不使用命名空间等额外隔离层的情况下，同一用户运行的进程之间基本没有隔离。调试器可以附加到现有进程的能力证明了这个弱点确实存在。
</p>
<h4>
<span id=".E7.A4.BA.E4.BE.8B.EF.BC.9A.E7.94.B1.E4.BA.8E.E4.B8.8A.E8.BF.B0.E5.8E.9F.E5.9B.A0.E5.8A.9F.E8.83.BD.E5.8F.97.E9.99.90.E7.9A.84.E7.A8.8B.E5.BA.8F"></span><span class="mw-headline" id="示例：由于上述原因功能受限的程序">示例：由于上述原因功能受限的程序</span>
</h4>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>注意：</strong> 你仍然可以以 root 身份执行这些命令（例如允许某些用户使用 <a href="../en/Sudo.html" title="Sudo">sudo</a>，且无论是否需要密码）。</div>
<ul>
<li><code>gdb -p $PID</code></li>
<li><code>strace -p $PID</code></li>
<li><code>perf trace -p $PID</code></li>
<li><code>reptyr $PID</code></li>
</ul>
<h3>
<span id=".E9.9A.90.E8.97.8F.E8.BF.9B.E7.A8.8B"></span><span class="mw-headline" id="隐藏进程">隐藏进程</span>
</h3>
<div class="archwiki-template-box archwiki-template-box-warning">
<strong>警告：</strong> 
<ul>
<li>这可能会导致某些应用程序出现问题，例如在沙盒和 <a href="../en/Xorg.html" title="Xorg">Xorg</a> 中运行的应用程序（请参阅解决方法）。</li>
<li>当所使用的 <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=systemd">systemd</a></span> 版本大于 237.64-1 时，这可能会导致 <a href="../en/D-Bus.html" title="D-Bus">D-Bus</a>、<a href="../en/PulseAudio.html" title="PulseAudio">PulseAudio</a> 和 <a href="../en/Bluetooth.html" title="Bluetooth">bluetooth</a> 出现问题。</li>
</ul>
</div>
<p>其他用户的进程通常可以在 <code>/proc</code> 访问到，而内核有能力向非特权用户隐藏这些进程，按照 <a rel="nofollow" class="external text" href="https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/tree/Documentation/filesystems/proc.txt#n1919">此处</a><sup title="最后检查状态：404">[<a href="https://en.wikipedia.org/wiki/Wikipedia:Link_rot" class="extiw" title="wikipedia:Wikipedia:Link rot">失效链接</a> 2020-08-04 ⓘ]</sup> 记录的方法以 <code>hidepid=</code> 和 <code>gid=</code> 选项挂载 <code>proc</code> 文件系统即可。
</p>
<p>这使得入侵者收集正在运行的进程信息变得异常艰难，同样艰难的还包括判断是否存在特权运行的守护进程、其他用户是否正在运行敏感程序，甚至无法捕捉到其他用户运行的任何程序，更无法捕捉到特定的程序是否正在运行（假设该程序不会因为其自身行为暴露自己），并且作为额外的优势，那些通过外部参数传递敏感信息的、写得不那么好的程序现在可以防范本地窃听了。
</p>
<p>由 <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=filesystem">filesystem</a></span> 软件包提供的 <code>proc</code> <a href="../en/Users_and_groups.html#System_groups" title="Users and groups">用户组</a> 相当于一个白名单，包含了有权访问其他用户进程信息的用户。如果用户或服务需要访问除自身以外的 <code>/proc/&lt;pid&gt;</code> 目录，请 <a href="../en/Users_and_groups.html#Group_management" title="Users and groups">将他们加入该用户组</a>。
</p>
<p>例如，把除了 <code>proc</code> 组中用户之外的其他用户的进程信息都隐藏起来：
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/fstab</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">proc	/proc	proc	nosuid,nodev,noexec,hidepid=2,gid=proc	0	0</pre>
<p>要使用户会话正常工作，需要为 <i>systemd-logind</i> 添加例外：
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/systemd/system/systemd-logind.service.d/hidepid.conf</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">[Service]
SupplementaryGroups=proc</pre>
<h2>
<span id=".E6.B2.99.E7.9B.92.E7.A8.8B.E5.BA.8F"></span><span class="mw-headline" id="沙盒程序">沙盒程序</span>
</h2>
<p>另请参阅 <a href="https://en.wikipedia.org/wiki/Sandbox_(computer_security)" class="extiw" title="wikipedia:Sandbox (computer security)">Wikipedia:Sandbox (computer security)</a>。
</p>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>注意：</strong> 用户命名空间配置项 <code>CONFIG_USER_NS</code> 当前在 <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=linux">linux</a></span>（v4.14.5或更高版本）、<span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=linux-lts">linux-lts</a></span>（v4.14.15或更高版本）和 <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=linux-hardened">linux-hardened</a></span> 中启用。关闭它可能会导致程序无法开启某些沙盒功能。由于会增加本地提权的可能性，非特权用法默认是禁用的，启用它需要将 <code>kernel.unprivileged_userns_clone</code> <a href="../en/Sysctl.html" title="Sysctl">sysctl</a> 设置为 <code>1</code>。</div>
<h3><span class="mw-headline" id="Firejail">Firejail</span></h3>
<p><a href="../en/Firejail.html" title="Firejail">Firejail</a> 是一个易于使用的、简单的工具，用于沙盒化程序和服务器。建议将 Firejail 也用于浏览器以及其他网络应用程序，就像对待正在运行的服务器程序一样。
</p>
<h3><span class="mw-headline" id="bubblewrap">bubblewrap</span></h3>
<p><a href="../en/Bubblewrap.html" title="Bubblewrap">bubblewrap</a> 是一个由 <a href="https://en.wikipedia.org/wiki/Flatpak" class="extiw" title="wikipedia:Flatpak">Flatpak</a> 开发的基于 setuid 的沙盒程序，其资源占用比 Firejail 更小。虽然它缺少某些功能，例如文件路径白名单，但 bubblewrap 确实提供了 bind mounts 的功能，能够创建 user/IPC/PID/network/cgroup 命名空间，并且可以支持简单和 <a rel="nofollow" class="external text" href="https://github.com/projectatomic/bubblewrap/blob/master/demos/bubblewrap-shell.sh">复杂的沙盒</a>。
</p>
<h3><span class="mw-headline" id="chroots">chroots</span></h3>
<p>手动构造 <a href="../zh-CN/Chroot.html" title="Chroot (简体中文)">chroot</a> jail 也是可以的。
</p>
<h3><span class="mw-headline" id="Linux_containers">Linux containers</span></h3>
<p>在不使用 KVM 和 VirtualBox 又需要更大程度隔离的情况下，<a href="../en/Linux_Containers.html" title="Linux Containers">Linux Containers</a>（Linux 软件容器）是一个不错的选择。LXC 使用自己的虚拟硬件，在现有内核之上的 pseudo-chroot 内运行。
</p>
<h3>
<span id=".E5.85.B6.E4.BB.96.E8.99.9A.E6.8B.9F.E5.8C.96.E6.8A.80.E6.9C.AF"></span><span class="mw-headline" id="其他虚拟化技术">其他虚拟化技术</span>
</h3>
<p>使用类似 <a href="../zh-CN/VirtualBox.html" title="VirtualBox (简体中文)">VirtualBox</a>、<a href="../zh-CN/KVM.html" title="KVM (简体中文)">KVM</a>、<a href="../zh-CN/Xen.html" title="Xen (简体中文)">Xen</a> 或 <a rel="nofollow" class="external text" href="https://www.qubes-os.org/">Qubes OS</a>（基于 Xen）的完全虚拟化技术，可以在运行有风险的应用程序或浏览危险网站时提高隔离性和安全性。
</p>
<h2>
<span id=".E7.BD.91.E7.BB.9C.E4.B8.8E.E9.98.B2.E7.81.AB.E5.A2.99"></span><span class="mw-headline" id="网络与防火墙">网络与防火墙</span>
</h2>
<h3>
<span id=".E9.98.B2.E7.81.AB.E5.A2.99"></span><span class="mw-headline" id="防火墙">防火墙</span>
</h3>
<p>虽然源里面的 Arch 内核能够启用 <a href="https://en.wikipedia.org/wiki/Netfilter" class="extiw" title="wikipedia:Netfilter">Netfilter</a> 的 <a href="../en/Iptables.html" title="Iptables">iptables</a> 和 <a href="../en/Nftables.html" title="Nftables">nftables</a>，但它们默认是关闭的。因此强烈建议配置防火墙来保护系统上运行的服务。许多资料（包括 ArchWiki）没有明确说明哪些服务值得保护，因此启用防火墙是一个很好的预防措施。
</p>
<ul>
<li>参阅 <a href="../zh-CN/Iptables.html" title="Iptables (简体中文)">iptables</a> 和 <a href="../en/Nftables.html" title="Nftables">nftables</a> 来获取一般信息。</li>
<li>参阅 <a href="../zh-CN/Simple_stateful_firewall.html" title="Simple stateful firewall (简体中文)">Simple stateful firewall</a> 来获取配置 iptables 防火墙的指南。</li>
<li>参阅 <a href="../en/Category:Firewalls.html" title="Category:Firewalls">Category:Firewalls</a> 来获取设置 netfilter 的其他方法。</li>
<li>参阅 <a href="../zh-CN/Ipset.html" title="Ipset (简体中文)">Ipset</a> 以设置 IP 地址黑名单，内容可参考来自 Bluetack 的名单。</li>
</ul>
<h3>
<span id=".E5.86.85.E6.A0.B8.E5.8F.82.E6.95.B0"></span><span class="mw-headline" id="内核参数">内核参数</span>
</h3>
<p>作用于网络的内核参数可以使用 <a href="../en/Sysctl.html" title="Sysctl">Sysctl</a> 来设置。要查询具体方法，请参阅 <a href="../en/Sysctl.html#TCP/IP_stack_hardening" title="Sysctl">Sysctl#TCP/IP stack hardening</a>。
</p>
<h3><span class="mw-headline" id="SSH">SSH</span></h3>
<p>为了减轻 <a href="https://en.wikipedia.org/wiki/Brute-force_attack" class="extiw" title="wikipedia:Brute-force attack">暴力攻击</a>，建议强制使用基于密钥的身份验证。对于 OpenSSH，请参阅 <a href="../en/OpenSSH.html#Force_public_key_authentication" title="OpenSSH">OpenSSH#Force public key authentication</a>。另外，<a href="../en/Fail2ban.html" title="Fail2ban">Fail2ban</a> 或 <a href="../en/Sshguard.html" title="Sshguard">Sshguard</a> 通过监控日志并写入 <a href="../en/Iptables.html" title="Iptables">iptables 规则</a> 提供了较少形式的保护，但这样做可能会使服务器拒绝服务，因为攻击者可以伪装成管理员的地址并发送欺骗性的数据包。
</p>
<p>你可以用双因素身份验证来进一步强化身份验证。<a href="../en/Google_Authenticator.html" title="Google Authenticator">Google Authenticator</a>（Google 身份验证器）使用一次性密码 (OTP) 提供两步验证过程。
</p>
<p>拒绝 root 登录也是一种很好的做法，既可以跟踪入侵，也可以在 root 访问之前添加额外的安全层。对于 OpenSSH，请参阅 <a href="../en/OpenSSH.html#Deny" title="OpenSSH">OpenSSH#Deny</a>。
</p>
<h3><span class="mw-headline" id="DNS">DNS</span></h3>
<div class="noprint archwiki-template-message">
<p><a href="../File:Tango-inaccurate.png" class="image"><img alt="Tango-inaccurate.png" src="../File:Tango-inaccurate.png" decoding="async" width="48" height="48"></a><b>The factual accuracy of this article or section is disputed.</b><a href="../File:Tango-inaccurate.png" class="image"><img alt="Tango-inaccurate.png" src="../File:Tango-inaccurate.png" decoding="async" width="48" height="48"></a></p>
<div>
<b>Reason:</b> 由于 <a href="../en/Transport_Layer_Security.html#HSTS" class="mw-redirect" title="HSTS">HSTS</a> 技术，浏览器可能可以识别出 DNS 欺骗。 (Discuss in <a rel="nofollow" class="external text" href="https://wiki.archlinux.org/index.php/Talk:Security_(%E7%AE%80%E4%BD%93%E4%B8%AD%E6%96%87)">Talk:Security (简体中文)#</a>)</div>
</div>
<p>默认情况下，多数系统上的 <a href="../en/Domain_name_resolution.html" class="mw-redirect" title="DNS">DNS</a> 查询请求的发送和接收是不加密的，并且不验证数据是否来自规范的服务器，这可能导致 <a href="https://en.wikipedia.org/wiki/Man-in-the-middle_attack" class="extiw" title="wikipedia:Man-in-the-middle attack">中间人攻击</a>，攻击者拦截用户的 DNS 查询并修改响应数据为 <a href="https://en.wikipedia.org/wiki/Phishing" class="extiw" title="wikipedia:Phishing">钓鱼</a> 网站的 IP 地址，导致钓鱼网站收集用户的宝贵信息。用户和浏览器/其他软件都不会知道发生了什么，因为 DNS 协议始终将查询结果视为合法的。
</p>
<p><a href="../en/DNSSEC.html" title="DNSSEC">DNSSEC</a> 是一套标准，要求 DNS 服务器向客户端出示 DNS 数据的原始验证证明、曾经的验证失败记录和数据完整性。然而这一标准尚未广泛使用。启用 DNSSEC 后，攻击者无法修改您的 DNS 查询请求和返回的结果，但仍可以读取它们。
</p>
<p><a href="../zh-CN/Dnscrypt-proxy.html" class="mw-redirect" title="DNSCrypt (简体中文)">DNSCrypt</a> 以及后来的替代协议 <i>DNS over TLS</i> 和 <i>DNS over HTTPS</i>，使用加密技术来保护与 DNS 服务器的通信，系统层面上通常只采用其中一种协议。有关实现这些协议的软件，请参阅 <a href="../en/Domain_name_resolution.html#DNS_servers" title="Domain name resolution">Domain name resolution#DNS servers</a>。
</p>
<p>如果你有一个域名，请设置 <a href="../en/Mail_server.html#Sender_Policy_Framework" class="mw-redirect" title="Sender Policy Framework">Sender Policy Framework</a>（发件人策略框架）来抵御电子邮件欺骗。
</p>
<h3>
<span id=".E4.BB.A3.E7.90.86"></span><span class="mw-headline" id="代理">代理</span>
</h3>
<p>代理通常用作应用程序和网络之间的附加层，拦截不受信任的来源的数据。从攻击面上看，以较低权限运行的小代理的攻击面明显小于使用最终用户权限运行的复杂应用程序。
</p>
<p>例如，DNS 解析器是在 <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=glibc">glibc</a></span> 中实现的，它与应用程序链接（可能以root身份运行），因此 DNS 解析器中的 bug 可能导致本机执行远程代码。而这可以安装充当代理的 DNS 缓存服务器（例如 <a href="../en/Dnsmasq.html" title="Dnsmasq">dnsmasq</a>）来避免。<a rel="nofollow" class="external autonumber" href="https://googleonlinesecurity.blogspot.it/2016/02/cve-2015-7547-glibc-getaddrinfo-stack.html">[2]</a>
</p>
<h3>
<span id=".E7.AE.A1.E7.90.86_SSL_.E8.AF.81.E4.B9.A6"></span><span class="mw-headline" id="管理_SSL_证书">管理 SSL 证书</span>
</h3>
<div class="noprint archwiki-template-message">
<p><a href="../File:Merge-arrows-2.png" class="image"><img alt="Merge-arrows-2.png" src="../File:Merge-arrows-2.png" decoding="async" width="48" height="48"></a><b>This article or section is a candidate for merging with <a href="../en/Transport_Layer_Security.html" title="Transport Layer Security">Transport Layer Security</a>.</b><a href="../File:Merge-arrows-2.png" class="image"><img alt="Merge-arrows-2.png" src="../File:Merge-arrows-2.png" decoding="async" width="48" height="48"></a></p>
<div>
<b>Notes:</b> 有一篇专门介绍传输层安全协议的文章。 (Discuss in <a rel="nofollow" class="external text" href="https://wiki.archlinux.org/index.php/Talk:Security_(%E7%AE%80%E4%BD%93%E4%B8%AD%E6%96%87)">Talk:Security (简体中文)#</a>)</div>
</div>
<p>请参阅 <a href="../zh-CN/OpenSSL.html" title="OpenSSL (简体中文)">OpenSSL</a> 和 <a href="../en/Network_Security_Services.html" title="Network Security Services">Network Security Services</a>（NSS，网络安全服务）来管理各自的服务器端 SSL 证书。值得注意的是，与此相关的 <a href="../en/Certbot.html" class="mw-redirect" title="Let’s Encrypt">Let’s Encrypt</a> 项目也支持这些协议。
</p>
<p>默认的 Internet SSL 证书信任链由 <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=ca-certificates">ca-certificates</a></span> 包及其依赖项提供。请注意，Arch 依赖于信任源（例如 <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=ca-certificates-mozilla">ca-certificates-mozilla</a></span>）来提供受系统信任的证书。
</p>
<p>有时你可能需要暂时更改默认设置。例如，当你读到这一 <a rel="nofollow" class="external text" href="https://www.theregister.co.uk/2016/05/27/blue_coat_ca_certs/">新闻</a> 并希望手动解除证书信任，而不是等到信任源提供商这样做，在 Arch 的体系里非常简单：
</p>
<ol>
<li>以 .crt 格式获取相应的证书（示例：<a rel="nofollow" class="external text" href="https://crt.sh/?id=19538258">查看</a>, <a rel="nofollow" class="external text" href="https://crt.sh/?d=19538258">下载</a>；如果是现有的受信任的根证书颁发机构，你也可以在系统路径中找到它）</li>
<li>将其复制到 <code>/etc/ca-certificates/trust-source/blacklist/</code>
</li>
<li>以 root 身份运行 <i>update-ca-trust</i>。</li>
</ol>
<p>要检查黑名单是否按预期那样工作，请重新打开浏览器并通过其 GUI 执行此操作，现在浏览器应显示其为不受信任。
</p>
<h2>
<span id=".E8.BD.AF.E4.BB.B6.E5.8C.85.E9.AA.8C.E8.AF.81"></span><span class="mw-headline" id="软件包验证">软件包验证</span>
</h2>
<p>如果没有正确地对包进行签名，包管理器就有可能 <a rel="nofollow" class="external text" href="https://www.cs.arizona.edu/stork/packagemanagersecurity/attacks-on-package-managers.html#overview">受到攻击</a><sup title="最后检查状态：404">[<a href="https://en.wikipedia.org/wiki/Wikipedia:Link_rot" class="extiw" title="wikipedia:Wikipedia:Link rot">失效链接</a> 2020-08-04 ⓘ]</sup>，甚至可能会影响原本具有 <a rel="nofollow" class="external text" href="https://www.cs.arizona.edu/stork/packagemanagersecurity/faq.html">签名机制</a><sup title="最后检查状态：404">[<a href="https://en.wikipedia.org/wiki/Wikipedia:Link_rot" class="extiw" title="wikipedia:Wikipedia:Link rot">失效链接</a> 2020-08-04 ⓘ]</sup> 的包管理器。Arch 默认采用软件包签名机制，并依赖来自 5 个可信主密钥的信任网络。详情请参阅 <a href="../zh-CN/0306e39ac7285139de785bf9297b3d25.html" class="mw-redirect" title="Pacman/Package signing (简体中文)">pacman/Package signing (简体中文)</a>。
</p>
<h2>
<span id=".E8.AE.A2.E9.98.85.E6.BC.8F.E6.B4.9E.E5.91.8A.E8.AD.A6"></span><span class="mw-headline" id="订阅漏洞告警">订阅漏洞告警</span>
</h2>
<p>订阅国家漏洞数据库 (National Vulnerability Database) 提供的常见漏洞和披露 (Common Vulnerabilities and Exposure, CVE) 安全警报更新，相关内容可以在 <a rel="nofollow" class="external text" href="https://nvd.nist.gov/download.cfm">NVD 下载页</a> 上找到。<a rel="nofollow" class="external text" href="https://security.archlinux.org/">Arch Linux Security Tracker</a> 是一个特别有用的资源，它结合了 Arch Linux 安全通报 (ASA)，Arch Linux 漏洞组 (AVG) 以及 CVE 数据集，且以表格形式呈现。另请参阅 <a href="../en/Arch_Security_Team.html" title="Arch Security Team">Arch Security Team</a>（Arch 安全团队）。
</p>
<div class="archwiki-template-box archwiki-template-box-warning">
<strong>警告：</strong> 不要试图进行 <a href="../zh-CN/System_maintenance.html#%E4%B8%8D%E6%94%AF%E6%8C%81%E9%83%A8%E5%88%86%E5%8D%87%E7%BA%A7" title="System maintenance (简体中文)">部分升级</a>，因为 Arch Linux 不支持部分升级且可能导致系统不稳定，要升级组件时应升级整个系统。另外，系统更新不及时可能会使以后的更新过程更加复杂。</div>
<h2>
<span id=".E7.89.A9.E7.90.86.E5.AE.89.E5.85.A8"></span><span class="mw-headline" id="物理安全">物理安全</span>
</h2>
<p>理论上如果有足够的时间和计算资源，对计算机的物理访问都将会变成 root 权限的访问。但通过设置足够的障碍可以获得切实的安全保障。
</p>
<p>攻击者只需连接恶意的 IEEE 1394（火线接口），Thunderbolt 或 PCI Express 设备即可在下次启动时完全控制计算机，因为它们可以完全访问内存。<a rel="nofollow" class="external autonumber" href="https://www.breaknenter.org/projects/inception/">[3]</a><sup title="最后检查状态：SSL error">[<a href="https://en.wikipedia.org/wiki/Wikipedia:Link_rot" class="extiw" title="wikipedia:Wikipedia:Link rot">失效链接</a> 2020-08-04 ⓘ]</sup> 你无法阻止类似这样的操作，包括修改硬件本身的操作（比如将恶意固件刷到设备上）。但是，绝大多数攻击者都没有这样的知识和信心。
</p>
<p><a href="#%E7%A3%81%E7%9B%98%E5%8A%A0%E5%AF%86">#磁盘加密</a> 将在计算机被盗时保护数据，但经验丰富的攻击者可以给计算机安装恶意固件，在用户下次登录时获取加密的数据。
</p>
<h3>
<span id=".E9.94.81.E5.AE.9A_BIOS"></span><span class="mw-headline" id="锁定_BIOS">锁定 BIOS</span>
</h3>
<p>向 BIOS 添加密码可防止其他人启动到可移动设备，否则这和其他人对计算机具有 root 访问权限基本相同。你应该确保你的磁盘在引导顺序中处于第一位，并且可以的话禁用其他引导设备。
</p>
<h3>
<span id=".E5.BC.95.E5.AF.BC.E5.8A.A0.E8.BD.BD.E7.A8.8B.E5.BA.8F_.28Bootloader.29"></span><span class="mw-headline" id="引导加载程序_(Bootloader)">引导加载程序 (Bootloader)</span>
</h3>
<p>保护引导加载程序非常重要。因为有一个神奇的内核参数叫做 <code>init=/bin/sh</code>，它会使得任何用户的登录限制完全无用。
</p>
<h4><span class="mw-headline" id="Syslinux">Syslinux</span></h4>
<p>Syslinux 支持 <a href="../en/Syslinux.html#Security" title="Syslinux">用密码保护引导加载程序</a>。它允许为每个菜单项设置密码或为整个引导程序设置密码。
</p>
<h4><span class="mw-headline" id="GRUB">GRUB</span></h4>
<p><a href="../zh-CN/GRUB.html" title="GRUB (简体中文)">GRUB</a> 也可以设置引导密码。详情请参阅 <a href="../en/GRUB/Tips_and_tricks.html#Password_protection_of_GRUB_menu" title="GRUB/Tips and tricks">GRUB/Tips and tricks#Password protection of GRUB menu</a>。它还支持 <a href="../en/GRUB.html#Encrypted_/boot" title="GRUB">加密的 /boot</a>，这样只会使引导程序的部分代码保持未加密状态。GRUB 的配置、<a href="../zh-CN/Kernel.html" class="mw-redirect" title="Kernels (简体中文)">内核</a> 和 <a href="../zh-CN/Arch_boot_process.html#initramfs" title="Arch boot process (简体中文)">initramfs</a> 都是加密的。
</p>
<h3>
<span id=".E5.90.AF.E5.8A.A8.E5.88.86.E5.8C.BA.E7.BD.AE.E4.BA.8E.E5.8F.AF.E7.A7.BB.E5.8A.A8.E9.97.AA.E5.AD.98.E4.B8.8A"></span><span class="mw-headline" id="启动分区置于可移动闪存上">启动分区置于可移动闪存上</span>
</h3>
<p>一个较为流行的做法是将启动分区放在可移动闪存上，在没有它的情况下系统便无法启动。这个想法的支持者经常使用 <a href="#%E7%A3%81%E7%9B%98%E5%8A%A0%E5%AF%86">全盘加密</a>，有些还用到了放在启动分区上的 <a href="../en/Dm-crypt/Specialties.html#Encrypted_system_using_a_detached_LUKS_header" title="Dm-crypt/Specialties">分离加密头</a>。
</p>
<h3>
<span id=".E8.87.AA.E5.8A.A8.E6.B3.A8.E9.94.80"></span><span class="mw-headline" id="自动注销">自动注销</span>
</h3>
<p>如果你用的是 <a href="../zh-CN/Bash.html" title="Bash (简体中文)">Bash</a> 或 <a href="../zh-CN/Zsh.html" title="Zsh (简体中文)">Zsh</a>，则可以设置 <code>TMOUT</code> 的值，使 shell 在超时后自动注销。
</p>
<p>例如，下面的脚本内容将使用户自动从虚拟控制台（非 X11 中的终端模拟器）注销：
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/profile.d/shell-timeout.sh</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">TMOUT="$(( 60*10 ))";
[ -z "$DISPLAY" ] &amp;&amp; export TMOUT;
case $( /usr/bin/tty ) in
	/dev/tty[0-9]*) export TMOUT;;
esac
</pre>
<p>如果确实想要所有 Bash/Zsh 提示符（包括 X 中的）都有超时，请使用：
</p>
<pre>$ export TMOUT="$(( 60*10 ))";
</pre>
<p>请注意，shell 中运行的某些命令（例如：SSH 会话或没有 <code>TMOUT</code> 支持的其他 shell）将使上述设置失效。但是如果你主要使用 VC 以 root 身份重新启动僵死的 GDM/Xorg，那么这非常有用。
</p>
<h3>
<span id=".E9.98.B2.E8.8C.83.E6.81.B6.E6.84.8F_USB_.E8.AE.BE.E5.A4.87"></span><span class="mw-headline" id="防范恶意_USB_设备">防范恶意 USB 设备</span>
</h3>
<p>请安装 <a href="../en/USBGuard.html" title="USBGuard">USBGuard</a>，这是一个软件框架，通过基于设备属性的基本白名单和黑名单功能，帮助保护计算机免受恶意 USB 设备（例如 <a rel="nofollow" class="external text" href="https://srlabs.de/badusb">BadUSB</a>、<a rel="nofollow" class="external text" href="https://github.com/samyk/poisontap">PoisonTap</a> 或 <a rel="nofollow" class="external text" href="https://lanturtle.com/">LanTurtle</a>）的侵害。
</p>
<h2>
<span id=".E9.87.8D.E6.96.B0.E6.9E.84.E5.BB.BA.E8.BD.AF.E4.BB.B6.E5.8C.85"></span><span class="mw-headline" id="重新构建软件包">重新构建软件包</span>
</h2>
<p>软件包可以去除不需要的功能并重新构建，这样可以缩小受攻击范围。例如，<span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=bzip2">bzip2</a></span> 可以在没有 <code>bzip2recover</code> 的情况下重新构建，以试图规避 <a rel="nofollow" class="external text" href="https://security.archlinux.org/CVE-2016-3189">CVE-2016-3189</a> 漏洞。强化安全的自定义编译参数也可以手动或通过包装器在编译时加入。
</p>
<h2>
<span id=".E5.8F.82.E8.80.83.E8.B5.84.E6.96.99"></span><span class="mw-headline" id="参考资料">参考资料</span>
</h2>
<ul>
<li><a rel="nofollow" class="external text" href="https://security.archlinux.org/">Arch Linux Security Tracker</a></li>
<li><a rel="nofollow" class="external text" href="https://wiki.centos.org/HowTos/OS_Protection">CentOS Wiki: OS Protection</a></li>
<li><a rel="nofollow" class="external text" href="https://www.ibm.com/developerworks/linux/tutorials/l-harden-desktop/index.html">Hardening the Linux desktop</a></li>
<li><a rel="nofollow" class="external text" href="https://www.ibm.com/developerworks/linux/tutorials/l-harden-server/index.html">Hardening the Linux server</a></li>
<li><a rel="nofollow" class="external text" href="https://github.com/lfit/itpol/blob/master/linux-workstation-security.md">Linux Foundation: Linux workstation security checklist</a></li>
<li><a rel="nofollow" class="external text" href="https://www.privacytools.io/">privacytools.io Privacy Resources</a></li>
<li><a rel="nofollow" class="external text" href="https://access.redhat.com/documentation/en-US/Red_Hat_Enterprise_Linux/7/html/Security_Guide/">Red Hat Enterprise Linux 7 Security Guide</a></li>
<li>
<a rel="nofollow" class="external text" href="https://www.debian.org/doc/manuals/securing-debian-howto/securing-debian-howto.en.pdf">Securing Debian Manual (PDF)</a><sup title="最后检查状态：404">[<a href="https://en.wikipedia.org/wiki/Wikipedia:Link_rot" class="extiw" title="wikipedia:Wikipedia:Link rot">失效链接</a> 2020-08-04 ⓘ]</sup>
</li>
<li><a rel="nofollow" class="external text" href="https://web.archive.org/web/20140220055801/http://crunchbang.org:80/forums/viewtopic.php?id=24722">The paranoid #! Security Guide</a></li>
</ul>
</div>
</div>
<div id="catlinks" class="catlinks" data-mw="interface">
<div id="mw-normal-catlinks" class="mw-normal-catlinks">
<a href="../Special:Categories.html" title="Special:Categories">Categories</a>: <ul>
<li><a href="../zh-CN/Category:Security.html" title="Category:Security (简体中文)">Security (简体中文)</a></li>
<li><a href="../zh-CN/Category:File_systems.html" title="Category:File systems (简体中文)">File systems (简体中文)</a></li>
<li><a href="../zh-CN/Category:Networking.html" title="Category:Networking (简体中文)">Networking (简体中文)</a></li>
</ul>
</div>
<div id="mw-hidden-catlinks" class="mw-hidden-catlinks mw-hidden-cats-hidden">Hidden categories: <ul>
<li><a href="../en/Category:Pages_or_sections_flagged_with_Template:Expansion.html" title="Category:Pages or sections flagged with Template:Expansion">Pages or sections flagged with Template:Expansion</a></li>
<li><a href="../en/Category:Pages_or_sections_flagged_with_Template:Merge.html" title="Category:Pages or sections flagged with Template:Merge">Pages or sections flagged with Template:Merge</a></li>
<li><a href="../en/Category:Pages_with_broken_section_links.html" title="Category:Pages with broken section links">Pages with broken section links</a></li>
<li><a href="../en/Category:Pages_with_dead_links.html" title="Category:Pages with dead links">Pages with dead links</a></li>
<li><a href="../en/Category:Pages_or_sections_flagged_with_Template:Accuracy.html" title="Category:Pages or sections flagged with Template:Accuracy">Pages or sections flagged with Template:Accuracy</a></li>
</ul>
</div>
</div>
	</div>
</div>

<footer id="footer" class="mw-footer" role="contentinfo" style="margin: 0">
	<ul id="footer-info">
		<li>Retrieved from "<a dir="ltr" href="https://wiki.archlinux.org/index.php?title=Security_(%E7%AE%80%E4%BD%93%E4%B8%AD%E6%96%87)&amp;oldid=648379">https://wiki.archlinux.org/index.php?title=Security_(简体中文)&amp;oldid=648379</a>"</li>
		<li id="footer-info-lastmod"> This page was last edited on 6 January 2021, at 17:20.</li>
		<li id="footer-info-copyright">Content is available under <a class="external" rel="nofollow" href="http://www.gnu.org/copyleft/fdl.html">GNU Free Documentation License 1.3 or later</a> unless otherwise noted.</li>
	<br>
</ul>
	<ul id="footer-places">
		<li id="footer-places-privacy"><a href="../en/ArchWiki:Privacy_policy.html" title="ArchWiki:Privacy policy">Privacy policy</a></li>
		<li id="footer-places-about"><a href="../en/ArchWiki:About.html" title="ArchWiki:About">About ArchWiki</a></li>
		<li id="footer-places-disclaimer"><a href="../en/ArchWiki:General_disclaimer.html" title="ArchWiki:General disclaimer">Disclaimers</a></li>
	</ul>
	<ul id="footer-icons" class="noprint">
		<li id="footer-copyrightico">
	</ul>
	<div style="clear: both;"></div>
</footer>



</body>
</html>
