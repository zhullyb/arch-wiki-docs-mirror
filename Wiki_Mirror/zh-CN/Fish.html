<!DOCTYPE html>
<html class="client-nojs" lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<title>fish (简体中文) - ArchWiki</title>
<link rel="stylesheet" href="../ArchWikiOffline.css">
<meta name="ResourceLoaderDynamicStyles" content="">
<meta name="generator" content="MediaWiki 1.35.0">
<meta name="robots" content="noindex,follow">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="shortcut icon" href="/favicon.ico">
<link rel="search" type="application/opensearchdescription+xml" href="/opensearch_desc.php" title="ArchWiki (en)">
<link rel="EditURI" type="application/rsd+xml" href="https://wiki.archlinux.org/api.php?action=rsd">
<link rel="license" href="http://www.gnu.org/copyleft/fdl.html">
<link rel="alternate" type="application/atom+xml" title="ArchWiki Atom feed" href="/index.php?title=Special:RecentChanges&amp;feed=atom">
</head>
<body class="mediawiki ltr sitedir-ltr mw-hide-empty-elt ns-0 ns-subject page-Fish_简体中文 rootpage-Fish_简体中文 skin-vector action-view skin-vector-legacy">
<div id="content" class="mw-body" role="main" style="margin: 0">
	<a id="top"></a>
	<div id="siteNotice" class="mw-body-content"></div>
	<div class="mw-indicators mw-body-content">
	</div>
	<h1 id="firstHeading" class="firstHeading" lang="en">fish (简体中文)</h1>
	<div id="bodyContent" class="mw-body-content">
		<div id="siteSub" class="noprint">From ArchWiki</div>
		<div id="contentSub"></div>
		<div id="contentSub2"></div>
		
		<div id="jump-to-nav"></div>
		<a class="mw-jump-link" href="#mw-head">Jump to navigation</a>
		<a class="mw-jump-link" href="#searchInput">Jump to search</a>
		<div id="mw-content-text" lang="en" dir="ltr" class="mw-content-ltr">
<div class="warningbox">The printable version is no longer supported and may have rendering errors. Please update your browser bookmarks and please use the default browser print function instead.</div>
<div class="mw-parser-output">
<p><span></span>
</p>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>翻译状态：</strong>本文是 <a href="../en/Fish.html" title="Fish">Fish</a> 的<a href="../zh-CN/ArchWiki:Translation_Team.html" title="ArchWiki:Translation Team (简体中文)">翻译</a>。上次翻译日期：2019-05-09。如果英文版本有所<a rel="nofollow" class="external text" href="https://wiki.archlinux.org/index.php?title=Fish&amp;diff=0&amp;oldid=567009">更改</a>，则您可以帮助同步翻译。</div>
<p><a rel="nofollow" class="external text" href="https://fishshell.com">fish</a>是“<i><b>f</b>riendly <b>i</b>nteractive <b>sh</b>ell</i>”的缩写，是一个“交互式的、对用户友好的 <a href="../en/Command-line_shell.html" title="Command-line shell">命令行shell</a>”。
</p>
<p><i>fish</i>被有意设计成不完全与<a href="https://en.wikipedia.org/wiki/POSIX" class="extiw" title="wikipedia:POSIX">POSIX</a>兼容。fish的作者们认为POSIX中存在一些缺陷和矛盾，并通过fish简化的或不同的语法解决这些问题。因此，即使简单的POSIX兼容的脚本也可能需要较多的修改，甚至完全重写，才能在fish中运行。
</p>
<div id="toc" class="toc" role="navigation" aria-labelledby="mw-toc-heading">
<input type="checkbox" role="button" id="toctogglecheckbox" class="toctogglecheckbox" style="display:none"><div class="toctitle" lang="en" dir="ltr">
<h2 id="mw-toc-heading">Contents</h2>
<span class="toctogglespan"><label class="toctogglelabel" for="toctogglecheckbox"></label></span>
</div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#%E5%AE%89%E8%A3%85"><span class="tocnumber">1</span> <span class="toctext">安装</span></a></li>
<li class="toclevel-1 tocsection-2">
<a href="#%E6%8A%8Afish%E9%9B%86%E6%88%90%E5%88%B0%E7%B3%BB%E7%BB%9F%E4%B8%AD"><span class="tocnumber">2</span> <span class="toctext">把fish集成到系统中</span></a>
<ul>
<li class="toclevel-2 tocsection-3"><a href="#%E6%8A%8Afish%E8%AE%BE%E4%B8%BA%E9%BB%98%E8%AE%A4shell"><span class="tocnumber">2.1</span> <span class="toctext">把fish设为默认shell</span></a></li>
<li class="toclevel-2 tocsection-4">
<a href="#%E5%8F%AA%E6%8A%8Afish%E8%AE%BE%E4%B8%BA%E4%BA%A4%E4%BA%92%E5%BC%8Fshell"><span class="tocnumber">2.2</span> <span class="toctext">只把fish设为交互式shell</span></a>
<ul>
<li class="toclevel-3 tocsection-5"><a href="#%E9%80%9A%E8%BF%87.bashrc%E5%90%AF%E5%8A%A8fish"><span class="tocnumber">2.2.1</span> <span class="toctext">通过.bashrc启动fish</span></a></li>
<li class="toclevel-3 tocsection-6"><a href="#%E4%BD%BF%E7%94%A8%E7%BB%88%E7%AB%AF%E6%A8%A1%E6%8B%9F%E5%99%A8%E7%9A%84%E9%80%89%E9%A1%B9"><span class="tocnumber">2.2.2</span> <span class="toctext">使用终端模拟器的选项</span></a></li>
<li class="toclevel-3 tocsection-7"><a href="#%E4%BD%BF%E7%94%A8%E7%BB%88%E7%AB%AF%E5%A4%8D%E7%94%A8%E5%99%A8%E7%9A%84%E9%80%89%E9%A1%B9"><span class="tocnumber">2.2.3</span> <span class="toctext">使用终端复用器的选项</span></a></li>
</ul>
</li>
</ul>
</li>
<li class="toclevel-1 tocsection-8">
<a href="#%E9%85%8D%E7%BD%AE"><span class="tocnumber">3</span> <span class="toctext">配置</span></a>
<ul>
<li class="toclevel-2 tocsection-9"><a href="#%E7%BD%91%E9%A1%B5%E7%95%8C%E9%9D%A2"><span class="tocnumber">3.1</span> <span class="toctext">网页界面</span></a></li>
<li class="toclevel-2 tocsection-10"><a href="#%E5%91%BD%E4%BB%A4%E8%A1%A5%E5%85%A8"><span class="tocnumber">3.2</span> <span class="toctext">命令补全</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-11">
<a href="#%E6%8F%90%E7%A4%BA%E4%B8%8E%E6%8A%80%E5%B7%A7"><span class="tocnumber">4</span> <span class="toctext">提示与技巧</span></a>
<ul>
<li class="toclevel-2 tocsection-12"><a href="#%E5%91%BD%E4%BB%A4%E6%9B%BF%E6%8D%A2"><span class="tocnumber">4.1</span> <span class="toctext">命令替换</span></a></li>
<li class="toclevel-2 tocsection-13"><a href="#%E4%B8%B2%E8%81%94%E5%91%BD%E4%BB%A4"><span class="tocnumber">4.2</span> <span class="toctext">串联命令</span></a></li>
<li class="toclevel-2 tocsection-14"><a href="#%E5%85%B3%E9%97%AD%E9%97%AE%E5%80%99%E8%AF%AD"><span class="tocnumber">4.3</span> <span class="toctext">关闭问候语</span></a></li>
<li class="toclevel-2 tocsection-15"><a href="#%E9%85%8D%E7%BD%AEsu%E5%91%BD%E4%BB%A4%E9%BB%98%E8%AE%A4%E5%90%AF%E5%8A%A8fish"><span class="tocnumber">4.4</span> <span class="toctext">配置su命令默认启动fish</span></a></li>
<li class="toclevel-2 tocsection-16"><a href="#%E7%99%BB%E5%BD%95fish%E6%97%B6%E8%87%AA%E5%8A%A8%E5%BC%80%E5%90%AFX"><span class="tocnumber">4.5</span> <span class="toctext">登录fish时自动开启X</span></a></li>
<li class="toclevel-2 tocsection-17"><a href="#%E4%BD%BF%E7%94%A8_liquidprompt"><span class="tocnumber">4.6</span> <span class="toctext">使用 liquidprompt</span></a></li>
<li class="toclevel-2 tocsection-18"><a href="#%E5%9C%A8%E6%8F%90%E7%A4%BA%E4%B8%AD%E5%A2%9E%E5%8A%A0git%E7%8A%B6%E6%80%81"><span class="tocnumber">4.7</span> <span class="toctext">在提示中增加git状态</span></a></li>
<li class="toclevel-2 tocsection-19"><a href="#%E5%9C%A8SSH%E4%B8%AD%E7%94%A8%E5%BD%A9%E8%89%B2%E6%98%BE%E7%A4%BA%E4%B8%BB%E6%9C%BA%E5%90%8D"><span class="tocnumber">4.8</span> <span class="toctext">在SSH中用彩色显示主机名</span></a></li>
<li class="toclevel-2 tocsection-20"><a href="#ssh-agent_%E9%97%AE%E9%A2%98"><span class="tocnumber">4.9</span> <span class="toctext">ssh-agent 问题</span></a></li>
<li class="toclevel-2 tocsection-21"><a href="#%22command_not_found%22_%E9%92%A9%E5%AD%90"><span class="tocnumber">4.10</span> <span class="toctext">"command not found" 钩子</span></a></li>
<li class="toclevel-2 tocsection-22"><a href="#%E4%BB%8Ejobs%E4%B8%AD%E5%88%A0%E9%99%A4%E8%BF%9B%E7%A8%8B"><span class="tocnumber">4.11</span> <span class="toctext">从jobs中删除进程</span></a></li>
<li class="toclevel-2 tocsection-23"><a href="#%E8%AE%BE%E7%BD%AE%E5%88%AB%E5%90%8D"><span class="tocnumber">4.12</span> <span class="toctext">设置别名</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-24"><a href="#%E5%8F%A6%E8%AF%B7%E5%8F%82%E9%98%85"><span class="tocnumber">5</span> <span class="toctext">另请参阅</span></a></li>
</ul>
</div>

<h2>
<span id=".E5.AE.89.E8.A3.85"></span><span class="mw-headline" id="安装">安装</span>
</h2>
<p>安装<span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=fish">fish</a></span>软件包。也可以从AUR安装开发版的<span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://aur.archlinux.org/packages/fish-git/">fish-git</a></span><sup><small>AUR</small></sup>。
</p>
<p>安装完成后，输入<code>fish</code>即可进入fish shell。
</p>
<p>要查看帮助文档，在fish中输入<code>help</code>。文档将会在浏览器中打开。建议用户至少读完文档中“Syntax overview”这一节内容，因为fish的语法和其他shell的不太一样。
</p>
<h2>
<span id=".E6.8A.8Afish.E9.9B.86.E6.88.90.E5.88.B0.E7.B3.BB.E7.BB.9F.E4.B8.AD"></span><span class="mw-headline" id="把fish集成到系统中">把fish集成到系统中</span>
</h2>
<p>需要考虑的是：是把fish设置为默认shell，也就是用户登录时直接进入的shell，还是通过当前的默认shell启动fish，并只在交互模式下使用fish。这里，我们假设当前的默认shell是<a href="../zh-CN/Bash.html" title="Bash (简体中文)">Bash</a>。
</p>
<ul><li>把fish设为<b>默认shell</b>：这种方式需要用户对fish的运行机制及其脚本语言有些基本的了解。用户需要把当前的初始化脚本和环境变量移动到fish的环境中。<a href="#%E6%8A%8Afish%E8%AE%BE%E4%B8%BA%E9%BB%98%E8%AE%A4shell">#把fish设为默认shell</a>中有具体的步骤。</li></ul>
<ul><li>只把fish用作<b>交互式shell</b>：这种方法“破坏性”较小。Bash会照常运行所有的初始化脚本，并在此基础上启动fish。<a href="#%E5%8F%AA%E6%8A%8Afish%E8%AE%BE%E4%B8%BA%E4%BA%A4%E4%BA%92%E5%BC%8Fshell">#只把fish设为交互式shell</a>中有具体的步骤。</li></ul>
<h3>
<span id=".E6.8A.8Afish.E8.AE.BE.E4.B8.BA.E9.BB.98.E8.AE.A4shell"></span><span class="mw-headline" id="把fish设为默认shell">把fish设为默认shell</span>
</h3>
<p>如果你决定把fish设为默认的shell，首先你需要将你的用户的shell改为<code>/usr/bin/fish</code>。参照<a href="../en/Command-line_shell.html#Changing_your_default_shell" title="Command-line shell">Command-line shell#Changing your default shell</a>中的步骤。
</p>
<p>下一步是把Bash的几个初始化脚本中现有的操作和配置写成fish的格式。这些脚本分别是<code>/etc/profile</code>、<code>~/.bash_profile</code>、<code>/etc/bash.bashrc</code>和<code>~/.bashrc</code>。
</p>
<p>需要特别关注的是，在登录到fish中后，你需要尽快检查、调整环境变量<code>$PATH</code>的内容。在fish中，<code>$PATH</code>是一个<i>全局环境变量</i>，即它的作用范围包含所有函数，它在重启时会被清除，以及它对fish的所有子进程都是可见的（是一个<i>环境变量</i>）。向<code>$PATH</code>添加长期使用的路径的推荐的方法，是将他们赋给<code>fish_user_paths</code>这个全局变量。这个变量的内容重启时不会丢失，并会被自动添加到<code>$PATH</code>中。比如，
</p>
<pre>$ set -U fish_user_paths <i>/第一个/路径</i> <i>/第二个/路径</i> <i>/第三个/路径</i>
</pre>
<p>这三个路径就会一直保持在<code>$PATH</code>中。这种方式比较简单，因为不需要修改配置文件。
</p>
<h3>
<span id=".E5.8F.AA.E6.8A.8Afish.E8.AE.BE.E4.B8.BA.E4.BA.A4.E4.BA.92.E5.BC.8Fshell"></span><span class="mw-headline" id="只把fish设为交互式shell">只把fish设为交互式shell</span>
</h3>
<p>如果不将fish设为默认shell，就能照常运行Bash的初始化脚本。这能够保证用户当前的环境变量不受影响并且在fish中也能使用，因为fish是作为Bash的子进程运行的。下面是几种只把fish设为交互式shell的方法。
</p>
<h4>
<span id=".E9.80.9A.E8.BF.87.bashrc.E5.90.AF.E5.8A.A8fish"></span><span class="mw-headline" id="通过.bashrc启动fish">通过.bashrc启动fish</span>
</h4>
<p>保持默认shell为Bash不变，然后添加一行<code>exec fish</code>到合适的<a href="../en/Bash.html#Configuration_files" title="Bash">Bash配置文件</a>中，比如<code>.bashrc</code>。在这种方法中，Bash会正常执行<code>/etc/profile</code>和<code>/etc/profile.d</code>中的所有配置文件。相对于之后几种方法，这种是最通用的，因为这种方法在本机计算机和SSH远程计算机上都能使用。
</p>
<div class="archwiki-template-box archwiki-template-box-tip">
<strong>Tip:</strong> 
<ul>
<li>在这种配置下，要使用Bash而不是接着启动fish，需要使用<code>bash --norc</code>，以防止Bash加载<code>~/.bashrc</code>并执行<code>exec fish</code>。</li>
<li>要让类似于<code>bash -c 'echo test'</code>中的命令在Bash中执行而不是启动fish，你可以将<code>exec fish</code>换为<code>if [ -z "$BASH_EXECUTION_STRING" ]; then exec fish; fi</code>。</li>
</ul>
</div>
<h4>
<span id=".E4.BD.BF.E7.94.A8.E7.BB.88.E7.AB.AF.E6.A8.A1.E6.8B.9F.E5.99.A8.E7.9A.84.E9.80.89.E9.A1.B9"></span><span class="mw-headline" id="使用终端模拟器的选项">使用终端模拟器的选项</span>
</h4>
<p>另一种方法是在启动终端模拟器时通过添加命令行选项来启动fish。对于大部分的终端，这个选项是 <code>-e</code>。比如，要打开gnome-terminal并运行fish，可以将gnome-terminal的快捷方式改为：
</p>
<pre>gnome-terminal -e fish
</pre>
<p>对于不支持设置shell的终端模拟器，比如<span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://aur.archlinux.org/packages/lilyterm-git/">lilyterm-git</a></span><sup><small>AUR</small></sup>，则需要这样：
</p>
<pre>SHELL=/usr/bin/fish lilyterm
</pre>
<p>另外，有些终端可以在设置或配置文件中将fish设为默认shell。
</p>
<h4>
<span id=".E4.BD.BF.E7.94.A8.E7.BB.88.E7.AB.AF.E5.A4.8D.E7.94.A8.E5.99.A8.E7.9A.84.E9.80.89.E9.A1.B9"></span><span class="mw-headline" id="使用终端复用器的选项">使用终端复用器的选项</span>
</h4>
<p>要将fish设为<a href="../en/Tmux.html" title="Tmux">tmux</a>启动的默认shell，在<code>~/.tmux.conf</code>中加入这行：
</p>
<pre>set-option -g default-shell "/usr/bin/fish"
</pre>
<p>当<i>tmux</i>启动时，就会自动进入fish。
</p>
<h2>
<span id=".E9.85.8D.E7.BD.AE"></span><span class="mw-headline" id="配置">配置</span>
</h2>
<p>fish的配置脚本保存在<code>~/.config/fish/config.fish</code>。这个文件与 <code>.bashrc</code>相似，当每次启动时，fish会执行这个文件中的命令。需要注意的是，如果需要设置长期保留的变量，应该将这个变量设为一个<i>全局变量</i>，而不是将它定义在这些配置脚本中。
</p>
<p>用户定义的函数保存在<code>~/.config/fish/functions</code>中，文件名为<code><i>函数名</i>.fish</code>。
</p>
<h3>
<span id=".E7.BD.91.E9.A1.B5.E7.95.8C.E9.9D.A2"></span><span class="mw-headline" id="网页界面">网页界面</span>
</h3>
<p>通过下面命令即可用浏览器打开fish的配置页面。
</p>
<pre>fish_config
</pre>
<p>在浏览器中可以交互式配置fish的配色、提示符、函数、变量、历史记录和快捷键。
</p>
<h3>
<span id=".E5.91.BD.E4.BB.A4.E8.A1.A5.E5.85.A8"></span><span class="mw-headline" id="命令补全">命令补全</span>
</h3>
<p>fish可以通过解析man的数据生成自动补全规则。这些自动补全规则保存于<code>~/.config/fish/generated_completions/</code>。可以运行下面的命令更新自动补齐规则。
</p>
<pre>fish_update_completions
</pre>
<p>你也可以在<code>~/.config/fish/completions/</code>中定义自己的自动补全规则。<code>/usr/share/fish/completions/</code>中有更多的例子。
</p>
<p>对Arch Linux来说， <i>pacman</i>, <i>pacman-key</i>, <i>makepkg</i>, <i>cower</i>, <i>pbget</i>, <i>pacmatic</i>这些命令的自动补全规则已经在fish中内置了——fish在不同的发行版中内置了不同的命令补全规则。fish的内存管理足够智能，不会因为命令补全产生负面影响。
</p>
<h2>
<span id=".E6.8F.90.E7.A4.BA.E4.B8.8E.E6.8A.80.E5.B7.A7"></span><span class="mw-headline" id="提示与技巧">提示与技巧</span>
</h2>
<h3>
<span id=".E5.91.BD.E4.BB.A4.E6.9B.BF.E6.8D.A2"></span><span class="mw-headline" id="命令替换">命令替换</span>
</h3>
<p><i>fish</i>不包含Bash式的历史记录替换功能（如<code>sudo !!</code>）。fish的开发者在<a rel="nofollow" class="external text" href="http://fishshell.com/docs/current/faq.html#faq-history">fish faq</a>中建议使用交互式的方式调用历史记录：<code>上</code>方向键可回顾整条命令，而<code>Alt+上</code>会回顾命令的单个参数。
</p>
<p>不过，<a rel="nofollow" class="external text" href="https://github.com/fish-shell/fish-shell/wiki/Bash-Style-Command-Substitution-and-Chaining-(!!-!%24-&amp;&amp;-%7C%7C)">fish wiki</a>中介绍了一些在fish中使用历史替换的办法。这种方法提供的历史替换并不完整，但可用的有<code>!!</code>（替换上一条命令）和<code>!$</code>（替换上一条命令的最后一个参数）。
</p>
<h3>
<span id=".E4.B8.B2.E8.81.94.E5.91.BD.E4.BB.A4"></span><span class="mw-headline" id="串联命令">串联命令</span>
</h3>
<p>在低于3.0的版本中，fish并未实现串联命令符号<code>&amp;&amp;</code>和<code>!!</code>，推荐使用<code>; and</code>和<code>; or</code>语法来实现相似的效果。根据<a rel="nofollow" class="external text" href="https://github.com/fish-shell/fish-shell/wiki/Bash-Style-Command-Substitution-and-Chaining-(!!-!%24-&amp;&amp;-%7C%7C)#getting--and-">fish wiki</a>中的步骤，可以通过设置快捷键自动将<code>&amp;&amp;</code>和<code>!!</code>替换为<code>; and</code>和<code>; or</code>。
</p>
<h3>
<span id=".E5.85.B3.E9.97.AD.E9.97.AE.E5.80.99.E8.AF.AD"></span><span class="mw-headline" id="关闭问候语">关闭问候语</span>
</h3>
<p>默认情况下，每次启动fish，fish都会打印问候语。要关闭问候语，可以在fish中运行：
</p>
<pre>set -U fish_greeting
</pre>
<h3>
<span id=".E9.85.8D.E7.BD.AEsu.E5.91.BD.E4.BB.A4.E9.BB.98.E8.AE.A4.E5.90.AF.E5.8A.A8fish"></span><span class="mw-headline" id="配置su命令默认启动fish">配置su命令默认启动fish</span>
</h3>
<p>当你使用"su"用户切换到其他用户的时候，默认使用的shell是Bash，但是你可以在fish的配置文件中添加一个函数覆盖默认的"su"命令，使得你在使用"su"命令切换用户的时候会自动使用fish：
</p>
<pre>function su
    /bin/su --shell=/usr/bin/fish $argv
end
</pre>
<h3>
<span id=".E7.99.BB.E5.BD.95fish.E6.97.B6.E8.87.AA.E5.8A.A8.E5.BC.80.E5.90.AFX"></span><span class="mw-headline" id="登录fish时自动开启X">登录fish时自动开启X</span>
</h3>
<p>把下面配置添加到 <code>~/.config/fish/config.fish</code>，即可在你登录tty1的时候自动启动X。
</p>
<pre># Start X at login
if status --is-login
    if test -z "$DISPLAY" -a $XDG_VTNR = 1
        exec startx -- -keeptty
    end
end
</pre>
<h3>
<span id=".E4.BD.BF.E7.94.A8_liquidprompt"></span><span class="mw-headline" id="使用_liquidprompt">使用 liquidprompt</span>
</h3>
<p><a rel="nofollow" class="external text" href="https://github.com/nojhan/liquidprompt">Liquidprompt</a>是一个“用于Bash和Zsh的全功能的、经过仔细设计的、自适应的提示符”，但它目前没有计划兼容fish<a rel="nofollow" class="external autonumber" href="https://github.com/nojhan/liquidprompt/pull/230">[1]</a>。 <a rel="nofollow" class="external text" href="https://github.com/wesbarnett/fish-lp">这个项目</a><sup title="最后检查状态：404">[<a href="https://en.wikipedia.org/wiki/Wikipedia:Link_rot" class="extiw" title="wikipedia:Wikipedia:Link rot">失效链接</a> 2020-08-02 ⓘ]</sup>提供了一种用于fish的实现。
</p>
<h3>
<span id=".E5.9C.A8.E6.8F.90.E7.A4.BA.E4.B8.AD.E5.A2.9E.E5.8A.A0git.E7.8A.B6.E6.80.81"></span><span class="mw-headline" id="在提示中增加git状态">在提示中增加git状态</span>
</h3>
<p>当你处在一个git目录中时，如果你想在fish的提示符中显示分支和修改的相关信息，可以仿照以下的例子编写<code>fish_prompt</code>函数：
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">~/.config/fish/functions/fish_prompt.fish</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">function fish_prompt
  set -l last_status $status

  if not set -q __fish_git_prompt_show_informative_status
    set -g __fish_git_prompt_show_informative_status 1
  end
  if not set -q __fish_git_prompt_color_branch
    set -g __fish_git_prompt_color_branch brmagenta
  end
  if not set -q __fish_git_prompt_showupstream
    set -g __fish_git_prompt_showupstream "informative"
  end
  if not set -q __fish_git_prompt_showdirtystate
    set -g __fish_git_prompt_showdirtystate "yes"
  end
  if not set -q __fish_git_prompt_color_stagedstate
    set -g __fish_git_prompt_color_stagedstate yellow
  end
  if not set -q __fish_git_prompt_color_invalidstate
    set -g __fish_git_prompt_color_invalidstate red
  end
  if not set -q __fish_git_prompt_color_cleanstate
    set -g __fish_git_prompt_color_cleanstate brgreen
  end

  printf '%s%s %s%s%s%s ' (set_color $fish_color_host) (prompt_hostname) (set_color $fish_color_cwd) (prompt_pwd) (set_color normal) (__fish_git_prompt)

  if not test $last_status -eq 0
    set_color $fish_color_error
  end
  echo -n '$ '
  set_color normal
end
</pre>
<p>然而，fish已经抛弃了这种方式，参见<a rel="nofollow" class="external text" href="https://github.com/fish-shell/fish-shell/blob/master/share/functions/__fish_git_prompt.fish">fish-shell git</a>。作为替代，fish现在内置了<a rel="nofollow" class="external text" href="https://mariuszs.github.io/blog/2013/informative_git_prompt.html">Informative Git Prompt</a>。该功能可以通过fish_config启用。
</p>
<h3>
<span id=".E5.9C.A8SSH.E4.B8.AD.E7.94.A8.E5.BD.A9.E8.89.B2.E6.98.BE.E7.A4.BA.E4.B8.BB.E6.9C.BA.E5.90.8D"></span><span class="mw-headline" id="在SSH中用彩色显示主机名">在SSH中用彩色显示主机名</span>
</h3>
<p>如果需要在通过SSH登录到fish时用不同的颜色标记提示符中的主机名，请将以下内容添加到函数<code>fish_prompt</code>中，或者添加到fish的配置文件中。这里以红色为例：
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">~/.config/fish/functions/fish_prompt.fish</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">...
if set -q SSH_TTY
  set -g fish_color_host brred
end
...</pre>
<h3>
<span id="ssh-agent_.E9.97.AE.E9.A2.98"></span><span class="mw-headline" id="ssh-agent_问题">ssh-agent 问题</span>
</h3>
<p>在fish中，<code>eval (ssh-agent)</code>会因为变量的设置方式而报错。一个变通的方案是使用csh风格的选项<code>-c</code>：
</p>
<pre> $ eval (ssh-agent -c)
</pre>
<h3>
<span id=".22command_not_found.22_.E9.92.A9.E5.AD.90"></span><span class="mw-headline" id='"command_not_found"_钩子'>"command not found" 钩子</span>
</h3>
<p><a href="../en/Pkgfile.html" title="Pkgfile">pkgfile</a> 包含了一个 "未找到命令"("command not found") 钩子，但你输入一个当前系统不存在的命令，pkgfile会自动从官方仓库中搜索哪个安装包有这个命令。只要你安装了<a href="../en/Pkgfile.html" title="Pkgfile">pkgfile</a>，这个钩子就会自动启用。
</p>
<h3>
<span id=".E4.BB.8Ejobs.E4.B8.AD.E5.88.A0.E9.99.A4.E8.BF.9B.E7.A8.8B"></span><span class="mw-headline" id="从jobs中删除进程">从jobs中删除进程</span>
</h3>
<p>当退出<i>fish</i>的时候，所有后台进程也会终止。为了保持一个任务即使在fish退出了之后也继续运行，需要先输入<code>disown</code>命令，再退出。举例来说，在后台启动firefox，然后退出fish，但firefox在后台继续运行：
</p>
<p><br>
</p>
<pre> $ firefox &amp;
 $ disown
 $ exit
</pre>
<p>你会发现虽然你退出了fish，但firefox没有退出。请参阅<span class="plainlinks archwiki-template-man" title="$ man 1 disown">disown(1)</span>了解更多细节。
</p>
<h3>
<span id=".E8.AE.BE.E7.BD.AE.E5.88.AB.E5.90.8D"></span><span class="mw-headline" id="设置别名">设置别名</span>
</h3>
<p>如果想要快速的设置一个持久化的别名（即使重启也不会失效），可以直接在fish下输入：
</p>
<pre>$ alias FooAliasName "foo"
$ funcsave FooAliasName
</pre>
<p>这样会把你的别名作为fish中的函数。如果你想查看或者编辑所有的函数可以使用<code>fish_config</code>，然后在<b>Function</b>标签下进行配置。
</p>
<h2>
<span id=".E5.8F.A6.E8.AF.B7.E5.8F.82.E9.98.85"></span><span class="mw-headline" id="另请参阅">另请参阅</span>
</h2>
<ul>
<li>
<a rel="nofollow" class="external free" href="http://fishshell.com/">http://fishshell.com/</a> - fish主页</li>
<li>
<a rel="nofollow" class="external free" href="http://fishshell.com/docs/current/index.html">http://fishshell.com/docs/current/index.html</a> - 文档</li>
<li>
<a rel="nofollow" class="external free" href="http://hyperpolyglot.org/unix-shells">http://hyperpolyglot.org/unix-shells</a> - Shell 语法对照表</li>
</ul>
</div>
</div>
<div id="catlinks" class="catlinks" data-mw="interface">
<div id="mw-normal-catlinks" class="mw-normal-catlinks">
<a href="../Special:Categories.html" title="Special:Categories">Category</a>: <ul><li><a href="../zh-CN/Category:Command-line_shells.html" title="Category:Command-line shells (简体中文)">Command-line shells (简体中文)</a></li></ul>
</div>
<div id="mw-hidden-catlinks" class="mw-hidden-catlinks mw-hidden-cats-hidden">Hidden category: <ul><li><a href="../en/Category:Pages_with_dead_links.html" title="Category:Pages with dead links">Pages with dead links</a></li></ul>
</div>
</div>
	</div>
</div>

<footer id="footer" class="mw-footer" role="contentinfo" style="margin: 0">
	<ul id="footer-info">
		<li>Retrieved from "<a dir="ltr" href="https://wiki.archlinux.org/index.php?title=Fish_(%E7%AE%80%E4%BD%93%E4%B8%AD%E6%96%87)&amp;oldid=635037">https://wiki.archlinux.org/index.php?title=Fish_(简体中文)&amp;oldid=635037</a>"</li>
		<li id="footer-info-lastmod"> This page was last edited on 12 September 2020, at 17:24.</li>
		<li id="footer-info-copyright">Content is available under <a class="external" rel="nofollow" href="http://www.gnu.org/copyleft/fdl.html">GNU Free Documentation License 1.3 or later</a> unless otherwise noted.</li>
	<br>
</ul>
	<ul id="footer-places">
		<li id="footer-places-privacy"><a href="../en/ArchWiki:Privacy_policy.html" title="ArchWiki:Privacy policy">Privacy policy</a></li>
		<li id="footer-places-about"><a href="../en/ArchWiki:About.html" title="ArchWiki:About">About ArchWiki</a></li>
		<li id="footer-places-disclaimer"><a href="../en/ArchWiki:General_disclaimer.html" title="ArchWiki:General disclaimer">Disclaimers</a></li>
	</ul>
	<ul id="footer-icons" class="noprint">
		<li id="footer-copyrightico">
	</ul>
	<div style="clear: both;"></div>
</footer>



</body>
</html>
