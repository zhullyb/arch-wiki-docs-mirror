<!DOCTYPE html>
<html class="client-nojs" lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<title>xinit (简体中文) - ArchWiki</title>
<link rel="stylesheet" href="../ArchWikiOffline.css">
<meta name="ResourceLoaderDynamicStyles" content="">
<meta name="generator" content="MediaWiki 1.35.0">
<meta name="robots" content="noindex,follow">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="shortcut icon" href="/favicon.ico">
<link rel="search" type="application/opensearchdescription+xml" href="/opensearch_desc.php" title="ArchWiki (en)">
<link rel="EditURI" type="application/rsd+xml" href="https://wiki.archlinux.org/api.php?action=rsd">
<link rel="license" href="http://www.gnu.org/copyleft/fdl.html">
<link rel="alternate" type="application/atom+xml" title="ArchWiki Atom feed" href="/index.php?title=Special:RecentChanges&amp;feed=atom">
</head>
<body class="mediawiki ltr sitedir-ltr mw-hide-empty-elt ns-0 ns-subject page-Xinit_简体中文 rootpage-Xinit_简体中文 skin-vector action-view skin-vector-legacy">
<div id="content" class="mw-body" role="main" style="margin: 0">
	<a id="top"></a>
	<div id="siteNotice" class="mw-body-content"></div>
	<div class="mw-indicators mw-body-content">
	</div>
	<h1 id="firstHeading" class="firstHeading" lang="en">xinit (简体中文)</h1>
	<div id="bodyContent" class="mw-body-content">
		<div id="siteSub" class="noprint">From ArchWiki</div>
		<div id="contentSub"></div>
		<div id="contentSub2"></div>
		
		<div id="jump-to-nav"></div>
		<a class="mw-jump-link" href="#mw-head">Jump to navigation</a>
		<a class="mw-jump-link" href="#searchInput">Jump to search</a>
		<div id="mw-content-text" lang="en" dir="ltr" class="mw-content-ltr">
<div class="warningbox">The printable version is no longer supported and may have rendering errors. Please update your browser bookmarks and please use the default browser print function instead.</div>
<div class="mw-parser-output">
<p><span></span>
</p>
<div class="archwiki-template-meta-related-articles-start">
<p>相关文章</p>
<ul>
<li><a href="../zh-CN/Display_manager.html" title="Display manager (简体中文)">Display manager (简体中文)</a></li>
<li><a href="../zh-CN/Xinit.html#%E5%9C%A8%E7%99%BB%E5%BD%95%E6%97%B6%E8%87%AA%E5%8A%A8%E5%90%AF%E7%94%A8_X" class="mw-redirect" title="Start X at Login (简体中文)">Start X at Login (简体中文)</a></li>
<li><a href="../zh-CN/Xorg.html" title="Xorg (简体中文)">Xorg_(简体中文)</a></li>
<li><a href="../zh-CN/Xprofile.html" title="Xprofile (简体中文)">Xprofile_(简体中文)</a></li>
<li><a href="../en/X_resources.html" class="mw-redirect" title="Xresources">Xresources</a></li>
</ul>
</div>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>翻译状态：</strong>本文是 <a href="../en/Xinit.html" title="Xinit">xinit</a> 的<a href="../zh-CN/ArchWiki:Translation_Team.html" title="ArchWiki:Translation Team (简体中文)">翻译</a>。上次翻译日期：2019-03-14。如果英文版本有所<a rel="nofollow" class="external text" href="https://wiki.archlinux.org/index.php?title=Xinit&amp;diff=0&amp;oldid=560963">更改</a>，则您可以帮助同步翻译。</div>
<p>摘自 <a href="https://en.wikipedia.org/wiki/xinit" class="extiw" title="wikipedia:xinit">Wikipedia</a>:
</p>
<dl><dd>用户可以通过 <b>xinit</b> 程序手动启动 <a href="../en/Xorg.html" title="Xorg">Xorg</a> 显示服务器，<span class="plainlinks archwiki-template-man" title="$ man 1 startx"><a rel="nofollow" class="external text" href="https://man.archlinux.org/man/startx.1">startx(1)</a></span> 脚本是 <span class="plainlinks archwiki-template-man" title="$ man 1 xinit"><a rel="nofollow" class="external text" href="https://man.archlinux.org/man/xinit.1">xinit(1)</a></span> 的前端。</dd></dl>
<p><i>xinit</i> 通常用在启动 X 时执行<a href="../zh-CN/Window_manager.html" title="Window manager (简体中文)">窗口管理器</a> 或 <a href="../en/Desktop_environment.html" title="Desktop environment">桌面环境</a>。虽然可以使用 <i>xinit</i> 在无窗口管理器的情况下启动图形程序，大部分图形程序都需要一个兼容 <a href="https://en.wikipedia.org/wiki/Extended_Window_Manager_Hints" class="extiw" title="wikipedia:Extended Window Manager Hints">EWMH</a> 的窗口管理器。<a href="../en/Display_manager.html" title="Display manager">显示管理器</a> 启动 <a href="../en/Xorg.html" title="Xorg">Xorg</a> 并读取 <a href="../en/Xprofile.html" title="Xprofile">xprofile</a>。
</p>
<div id="toc" class="toc" role="navigation" aria-labelledby="mw-toc-heading">
<input type="checkbox" role="button" id="toctogglecheckbox" class="toctogglecheckbox" style="display:none"><div class="toctitle" lang="en" dir="ltr">
<h2 id="mw-toc-heading">Contents</h2>
<span class="toctogglespan"><label class="toctogglelabel" for="toctogglecheckbox"></label></span>
</div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#%E5%AE%89%E8%A3%85"><span class="tocnumber">1</span> <span class="toctext">安装</span></a></li>
<li class="toclevel-1 tocsection-2">
<a href="#%E9%85%8D%E7%BD%AE"><span class="tocnumber">2</span> <span class="toctext">配置</span></a>
<ul>
<li class="toclevel-2 tocsection-3"><a href="#xinitrc"><span class="tocnumber">2.1</span> <span class="toctext">xinitrc</span></a></li>
<li class="toclevel-2 tocsection-4"><a href="#xserverrc"><span class="tocnumber">2.2</span> <span class="toctext">xserverrc</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-5"><a href="#%E4%BD%BF%E7%94%A8"><span class="tocnumber">3</span> <span class="toctext">使用</span></a></li>
<li class="toclevel-1 tocsection-6">
<a href="#%E6%8F%90%E7%A4%BA%E5%92%8C%E6%8A%80%E5%B7%A7"><span class="tocnumber">4</span> <span class="toctext">提示和技巧</span></a>
<ul>
<li class="toclevel-2 tocsection-7"><a href="#%E4%BB%8E%E5%91%BD%E4%BB%A4%E8%A1%8C%E8%A6%86%E7%9B%96_xinitrc"><span class="tocnumber">4.1</span> <span class="toctext">从命令行覆盖 xinitrc</span></a></li>
<li class="toclevel-2 tocsection-8"><a href="#%E5%9C%A8%E7%99%BB%E5%BD%95%E6%97%B6%E8%87%AA%E5%8A%A8%E5%90%AF%E7%94%A8_X"><span class="tocnumber">4.2</span> <span class="toctext">在登录时自动启用 X</span></a></li>
<li class="toclevel-2 tocsection-9"><a href="#Switching_between_desktop_environments/window_managers"><span class="tocnumber">4.3</span> <span class="toctext">Switching between desktop environments/window managers</span></a></li>
<li class="toclevel-2 tocsection-10"><a href="#%E4%B8%8D%E5%90%AF%E5%8A%A8%E7%AA%97%E5%8F%A3%E7%AE%A1%E7%90%86%E5%99%A8%EF%BC%8C%E7%9B%B4%E6%8E%A5%E5%90%AF%E5%8A%A8%E7%A8%8B%E5%BA%8F"><span class="tocnumber">4.4</span> <span class="toctext">不启动窗口管理器，直接启动程序</span></a></li>
<li class="toclevel-2 tocsection-11"><a href="#Output_redirection_using_startx"><span class="tocnumber">4.5</span> <span class="toctext">Output redirection using startx</span></a></li>
</ul>
</li>
</ul>
</div>

<h2>
<span id=".E5.AE.89.E8.A3.85"></span><span class="mw-headline" id="安装">安装</span>
</h2>
<p><a href="../en/Help:Reading.html#Installation_of_packages" class="mw-redirect" title="Install">安装</a> 软件包 <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=xorg-xinit">xorg-xinit</a></span>。
</p>
<h2>
<span id=".E9.85.8D.E7.BD.AE"></span><span class="mw-headline" id="配置">配置</span>
</h2>
<p><i>xinit</i> 和 <i>startx</i> 可以带一个可选的客户端程序参数，如果未提供这个参数，它们会从 <code>~/.xinitrc</code> 确认要启动的客户端。所以 <code>xinit /usr/bin/foo</code> 等价于在 <code>~/.xinitrc</code> 中设置 <code>exec foo</code> 并执行 <code>xinit</code>。 
</p>
<h3><span class="mw-headline" id="xinitrc">xinitrc</span></h3>
<p><code>~/.xinitrc</code> 可以方便的启动依赖 X 的程序，并在 X 启动时设置环境变量。如果用户主目录中存在 <code>.xinitrc</code>，<i>startx</i> 和 <i>xinit</i> 会执行此文件。如果不存在，<i>startx</i> 会执行默认的 <code>/etc/X11/xinit/xinitrc</code>。这个文件默认启动 <a href="../en/Twm.html" title="Twm">Twm</a> 和  <a href="../en/Xterm.html" title="Xterm">Xterm</a>. <i>xinit</i> 的默认行为不一样，请参阅 <span class="plainlinks archwiki-template-man" title="$ man 1 xinit"><a rel="nofollow" class="external text" href="https://man.archlinux.org/man/xinit.1">xinit(1)</a></span>。要设置窗口管理器或桌面环境，先通过复制创建默认文件：
</p>
<pre>$ cp /etc/X11/xinit/xinitrc ~/.xinitrc
</pre>
<p>根据示例文件修改可以保留一些默认行为，例如会引用 <code>/etc/X11/xinit/xinitrc.d</code> 中以 <code>.sh</code> 结尾的脚本。 
</p>
<p>然后编辑 <code>~/.xinitrc</code> ，例如要使用 <a href="../en/Openbox.html" title="Openbox">Openbox</a>，修改为：
</p>
<pre>...
xscreensaver <b>&amp;</b>
xsetroot -cursor_name left_ptr <b>&amp;</b>
<b>exec</b> openbox-session
</pre>
<p><code>~/.xinitrc</code> 中应该只有 <b>一个</b> 未注释掉的 <code>exec</code> 行，而且 exec 行必须位于配置文件的末尾。exec 后面的所有命令只有窗口退出后才会被执行。在窗口管理器前启动的命令，例如屏保和壁纸程序，必须自行 fork 后台进程或用<code>&amp;</code>在后台启动, 否则启动程序会等待它们退出才会启动窗口管理器或桌面环境。使用 <code>exec</code> 作为前缀会替换当前的进程，这样进程进入后台时 X 不会退出。
</p>
<p>某些程序，比如 <a href="../en/X_resources.html" class="mw-redirect" title="Xrdb">xrdb</a>，不应该被 fork. 使用 <code>exec</code> 前缀时，程序将会用窗口管理器进程替换脚本进程，所以即使进程进入后台 X 也不会退出。
</p>
<h3><span class="mw-headline" id="xserverrc">xserverrc</span></h3>
<p><code>xserverrc</code> 文件是一个启动 X server 的 shell 脚本。如果存在 <code>~/.xserverrc</code> ，<i>startx</i> 和 <i>xinit</i> 都会执行这个文件。如果文件不存在，<i>startx</i> 会使用 <code>/etc/X11/xinit/xserverrc</code>.
</p>
<p>为了维护  <code>logind</code> 的 <a href="../en/General_troubleshooting.html#Session_permissions" title="General troubleshooting">authenticated session 会话</a>，避免切换终端时跳过屏幕锁， 必须找用户登录的虚拟终端启动 <a href="../en/Xorg.html" title="Xorg">Xorg</a>。<a rel="nofollow" class="external autonumber" href="http://blog.falconindy.com/articles/back-to-basics-with-x-and-systemd.html">[1]</a> 所以建议在 <code>~/.xserverrc</code> 中指定 <code>vt$XDG_VTNR</code>:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">~/.xserverrc</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">	
#!/bin/sh
exec /usr/bin/Xorg -nolisten tcp "$@" vt$XDG_VTNR
</pre>
<p>如果要让 X 在其他的终端启动，可以使用 <code>/usr/lib/systemd/systemd-multi-seat-x</code> 提供的 X server 包裹程序。修改 <code>~/.xserverrc</code>，可以让 <i>xinit</i> 和<i>startx</i> 都使用这个包裹程序.
</p>
<h2>
<span id=".E4.BD.BF.E7.94.A8"></span><span class="mw-headline" id="使用">使用</span>
</h2>
<p>现在以普通用户启动 X：
</p>
<pre> $ startx
</pre>
<p>或者
</p>
<pre>$ xinit -- :1
</pre>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Note:</strong> <i>xinit</i> 无法在其它 X server 启动时处理多个显示，要使用多显示，需要通过 <code>-- :<i>display_number</i></code> 指定，<code><i>display_number</i></code> 是 1 或更高的数值。</div>
<p>选择的窗口管理器或桌面环境就应该正常启动了.
</p>
<p>要退出 X, 运行窗口管理器的退出功能，如果窗口管理器未提供此功能，可以运行：
</p>
<pre>$ pkill -15 Xorg
</pre>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Note:</strong> <i>pkill</i> 会杀死所有 X 实例，如果仅希望杀死当前虚拟终端的窗口管理器，运行：
<pre>$ pkill -15 -t tty"$XDG_VTNR" Xorg
</pre>
</div>
<h2>
<span id=".E6.8F.90.E7.A4.BA.E5.92.8C.E6.8A.80.E5.B7.A7"></span><span class="mw-headline" id="提示和技巧">提示和技巧</span>
</h2>
<h3>
<span id=".E4.BB.8E.E5.91.BD.E4.BB.A4.E8.A1.8C.E8.A6.86.E7.9B.96_xinitrc"></span><span class="mw-headline" id="从命令行覆盖_xinitrc">从命令行覆盖 xinitrc</span>
</h3>
<p>如果你有一个可用的  <code>~/.xinitrc</code>, 件，只想尝试下其他的窗口管理器/桌面环境，你可从命令行给 <code>startx</code> 完整路径
</p>
<pre>$ startx /full/path/to/window-manager
</pre>
<p>必须使用完整 <b>required</b>. 还有一个选项是为 <a href="#xserverrc">#xserverrc</a> 提供额外参数，加在 <code>--</code> 后面，例如：
</p>
<pre> $ startx /usr/bin/enlightenment -- -br +bs -dpi 96
</pre>
<p>参阅  <span class="plainlinks archwiki-template-man" title="$ man 1 startx"><a rel="nofollow" class="external text" href="https://man.archlinux.org/man/startx.1">startx(1)</a></span>.
</p>
<h3>
<span id=".E5.9C.A8.E7.99.BB.E5.BD.95.E6.97.B6.E8.87.AA.E5.8A.A8.E5.90.AF.E7.94.A8_X"></span><span class="mw-headline" id="在登录时自动启用_X">在登录时自动启用 X</span>
</h3>
<p>先确保 <i>startx</i> 已经配置好了。
</p>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>注意：</strong> 这种方式将在登陆 tty 启动 X，只有这样才能保持登录会话。</div>
<p>如果使用<a href="../en/Bash.html" title="Bash">Bash</a>, 编辑 <code>~/.bash_profile</code>,加入如下内容. 如果文件不存在，从 <code>/etc/skel/.bash_profile</code> 复制一个框架版本。
</p>
<p>如果使用 <a href="../en/Zsh.html" title="Zsh">zsh</a>，则编辑 <code>~/.zprofile</code>.
</p>
<pre>if [[ ! $DISPLAY &amp;&amp; $XDG_VTNR -eq 1 ]]; then
  exec startx
fi
</pre>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>注意：</strong> 
<ul>
<li>如果想在多个 VT 上使用图形登陆，可以将<code>-eq 1</code>修改为<code>-le 3</code> (vt1 到 vt3)</li>
<li>如果希望在 X 会话终止时保持登入状态，删除 <code>exec</code>.</li>
</ul>
</div>
<ul>
<li>此方法与<a href="../en/Getty.html#Automatic_login_to_virtual_console" class="mw-redirect" title="Automatic login to virtual console">automatic login to virtual console</a>一起可以实现自动登陆。</li>
<li>如果 X 被关闭，用户将自动退出。要避免这个问题，删除 <code>exec</code>。</li>
<li>要将 X 会话的输出重定向到一个文件，请创建一个别名<a href="../en/Bash.html#Aliases" class="mw-redirect" title="Alias">alias</a>:</li>
</ul>
<dl><dd><pre>alias startx='startx &amp;&gt; ~/.xlog'</pre></dd></dl>
<p>参阅 <a href="../en/Fish.html#Start_X_at_login" title="Fish">Fish#Start X at login</a> 和 <a href="../en/Systemd/User.html#Automatic_login_into_Xorg_without_display_manager" title="Systemd/User">Systemd/User#Automatic login into Xorg without display manager</a>.
</p>
<p>可以和 <a href="../en/Getty.html#Automatic_login_to_virtual_console" class="mw-redirect" title="Automatic login to virtual console">自动登录到虚拟终端</a>一起使用.
</p>
<h3>
<span id="Switching_between_desktop_environments.2Fwindow_managers"></span><span class="mw-headline" id="Switching_between_desktop_environments/window_managers">Switching between desktop environments/window managers</span>
</h3>
<p>If you are frequently switching between different desktop environments or window managers, it is convenient to either use a <a href="../en/Display_manager.html" title="Display manager">display manager</a> or expand <code>.xinitrc</code> to make the switching possible.
</p>
<p>The following example <code>~/.xinitrc</code> shows how to start a particular desktop environment or window manager with an argument:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">~/.xinitrc</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">...

# Here Xfce is kept as default
session=${1:-xfce}

case $session in
    i3|i3wm           ) exec i3;;
    kde               ) exec startkde;;
    xfce|xfce4        ) exec startxfce4;;
    # No known session, try to run it as command
    *                 ) exec $1;;
esac
</pre>
<p>To pass the argument <i>session</i>:
</p>
<pre>$ xinit <i>session</i>
</pre>
<p>or
</p>
<pre>$ startx ~/.xinitrc <i>session</i>
</pre>
<h3>
<span id=".E4.B8.8D.E5.90.AF.E5.8A.A8.E7.AA.97.E5.8F.A3.E7.AE.A1.E7.90.86.E5.99.A8.EF.BC.8C.E7.9B.B4.E6.8E.A5.E5.90.AF.E5.8A.A8.E7.A8.8B.E5.BA.8F"></span><span class="mw-headline" id="不启动窗口管理器，直接启动程序">不启动窗口管理器，直接启动程序</span>
</h3>
<p>It is possible to start only specific applications without a window manager, although most likely this is only useful with a single application shown in full-screen mode. For example:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">~/.xinitrc</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">...

exec chromium
</pre>
<p>With this method you need to set each application window's geometry through its own configuration files, if possible at all.
</p>
<div class="archwiki-template-box archwiki-template-box-tip">
<strong>Tip:</strong> This method can be useful to launch graphical games, especially on systems where excluding the memory or CPU usage of a window manager or desktop environment, and possible accessory applications, can help improve the game's execution performance.</div>
<p>See also <a href="../en/Display_manager.html#Starting_applications_without_a_window_manager" title="Display manager">Display manager#Starting applications without a window manager</a>.
</p>
<h3><span class="mw-headline" id="Output_redirection_using_startx">Output redirection using startx</span></h3>
<p>See <a href="../en/Xorg.html#Broken_redirection" title="Xorg">Xorg#Broken redirection</a><sup>[<a href="../en/ArchWiki:Requests.html#Broken_section_links" class="mw-redirect" title="ArchWiki:Requests">断开的链接</a>：无效的部分]</sup> for details.
</p>
</div>
</div>
<div id="catlinks" class="catlinks" data-mw="interface">
<div id="mw-normal-catlinks" class="mw-normal-catlinks">
<a href="../Special:Categories.html" title="Special:Categories">Categories</a>: <ul>
<li><a href="../zh-CN/Category:Desktop_environments.html" title="Category:Desktop environments (简体中文)">Desktop environments (简体中文)</a></li>
<li><a href="../zh-CN/Category:Xorg_commands.html" title="Category:Xorg commands (简体中文)">Xorg commands (简体中文)</a></li>
</ul>
</div>
<div id="mw-hidden-catlinks" class="mw-hidden-catlinks mw-hidden-cats-hidden">Hidden category: <ul><li><a href="../en/Category:Pages_with_broken_section_links.html" title="Category:Pages with broken section links">Pages with broken section links</a></li></ul>
</div>
</div>
	</div>
</div>

<footer id="footer" class="mw-footer" role="contentinfo" style="margin: 0">
	<ul id="footer-info">
		<li>Retrieved from "<a dir="ltr" href="https://wiki.archlinux.org/index.php?title=Xinit_(%E7%AE%80%E4%BD%93%E4%B8%AD%E6%96%87)&amp;oldid=636183">https://wiki.archlinux.org/index.php?title=Xinit_(简体中文)&amp;oldid=636183</a>"</li>
		<li id="footer-info-lastmod"> This page was last edited on 23 September 2020, at 01:19.</li>
		<li id="footer-info-copyright">Content is available under <a class="external" rel="nofollow" href="http://www.gnu.org/copyleft/fdl.html">GNU Free Documentation License 1.3 or later</a> unless otherwise noted.</li>
	<br>
</ul>
	<ul id="footer-places">
		<li id="footer-places-privacy"><a href="../en/ArchWiki:Privacy_policy.html" title="ArchWiki:Privacy policy">Privacy policy</a></li>
		<li id="footer-places-about"><a href="../en/ArchWiki:About.html" title="ArchWiki:About">About ArchWiki</a></li>
		<li id="footer-places-disclaimer"><a href="../en/ArchWiki:General_disclaimer.html" title="ArchWiki:General disclaimer">Disclaimers</a></li>
	</ul>
	<ul id="footer-icons" class="noprint">
		<li id="footer-copyrightico">
	</ul>
	<div style="clear: both;"></div>
</footer>



</body>
</html>
