<!DOCTYPE html>
<html class="client-nojs" lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<title>Solid state drive (简体中文) - ArchWiki</title>
<link rel="stylesheet" href="../ArchWikiOffline.css">
<meta name="ResourceLoaderDynamicStyles" content="">
<meta name="generator" content="MediaWiki 1.35.0">
<meta name="referrer" content="no-referrer-when-downgrade">
<meta name="robots" content="noindex,follow">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="shortcut icon" href="/favicon.ico">
<link rel="search" type="application/opensearchdescription+xml" href="/opensearch_desc.php" title="ArchWiki (en)">
<link rel="EditURI" type="application/rsd+xml" href="https://wiki.archlinux.org/api.php?action=rsd">
<link rel="license" href="http://www.gnu.org/copyleft/fdl.html">
<link rel="alternate" type="application/atom+xml" title="ArchWiki Atom feed" href="/index.php?title=Special:RecentChanges&amp;feed=atom">
</head>
<body class="mediawiki ltr sitedir-ltr mw-hide-empty-elt ns-0 ns-subject page-Solid_state_drive_简体中文 rootpage-Solid_state_drive_简体中文 skin-vector action-view skin-vector-legacy">
<div id="content" class="mw-body" role="main" style="margin: 0">
	<a id="top"></a>
	<div id="siteNotice" class="mw-body-content"></div>
	<div class="mw-indicators mw-body-content">
	</div>
	<h1 id="firstHeading" class="firstHeading" lang="en">Solid state drive (简体中文)</h1>
	<div id="bodyContent" class="mw-body-content">
		<div id="siteSub" class="noprint">From ArchWiki</div>
		<div id="contentSub"></div>
		<div id="contentSub2"></div>
		
		<div id="jump-to-nav"></div>
		<a class="mw-jump-link" href="#mw-head">Jump to navigation</a>
		<a class="mw-jump-link" href="#searchInput">Jump to search</a>
		<div id="mw-content-text" lang="en" dir="ltr" class="mw-content-ltr">
<div class="warningbox">The printable version is no longer supported and may have rendering errors. Please update your browser bookmarks and please use the default browser print function instead.</div>
<div class="mw-parser-output">
<div class="archwiki-template-meta-related-articles-start">
<p>Related articles</p>
<ul>
<li><a href="../en/Solid_state_drive/NVMe.html" title="Solid state drive/NVMe">Solid state drive/NVMe</a></li>
<li><a href="../en/Solid_state_drive/Memory_cell_clearing.html" title="Solid state drive/Memory cell clearing">Solid state drive/Memory cell clearing</a></li>
<li><a href="../en/Benchmarking.html" class="mw-redirect" title="Benchmarking/Data storage devices">Benchmarking/Data storage devices</a></li>
<li><a href="../en/Improving_performance.html#Storage_devices" title="Improving performance">Improving performance#Storage devices</a></li>
<li><a href="../en/Flashcache.html" title="Flashcache">Flashcache</a></li>
</ul>
</div>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>翻译状态：</strong>本文是 <a href="../en/Solid_state_drive.html" class="mw-redirect" title="Solid State Drives">Solid_State_Drives</a> 的<a href="../zh-CN/ArchWiki:Translation_Team.html" title="ArchWiki:Translation Team (简体中文)">翻译</a>。上次翻译日期：2021-01-30。如果英文版本有所<a rel="nofollow" class="external text" href="https://wiki.archlinux.org/index.php?title=Solid_State_Drives&amp;diff=0&amp;oldid=649230">更改</a>，则您可以帮助同步翻译。</div>
<div class="noprint archwiki-template-message">
<p><a href="../File:Tango-preferences-desktop-locale.png" class="image"><img alt="Tango-preferences-desktop-locale.png" src="../File:Tango-preferences-desktop-locale.png" decoding="async" width="48" height="48"></a><b>本文或本节需要<a href="../zh-CN/ArchWiki:Contributing.html#%E7%BF%BB%E8%AF%91" title="ArchWiki:Contributing (简体中文)">翻译</a>。要贡献翻译，请访问<a href="../zh-CN/ArchWiki:Translation_Team.html" class="mw-redirect" title="ArchWiki Translation Team (简体中文)">简体中文翻译团队</a>。</b><a href="../File:Tango-preferences-desktop-locale.png" class="image"><img alt="Tango-preferences-desktop-locale.png" src="../File:Tango-preferences-desktop-locale.png" decoding="async" width="48" height="48"></a></p>
<div>
<b>附注：</b> "External SSD with TRIM support"节未翻译（在 <a rel="nofollow" class="external text" href="https://wiki.archlinux.org/index.php/Talk:Solid_state_drive_(%E7%AE%80%E4%BD%93%E4%B8%AD%E6%96%87)">Talk:Solid state drive (简体中文)#</a> 中讨论）</div>
</div>
<p>本文介绍专题操作<a href="https://en.wikipedia.org/wiki/Solid-state_drive" class="extiw" title="wikipedia:Solid-state drive">固态硬盘</a>和其他闪存的存储设备。如果要出于特定目的对SSD进行分区，请考虑<a href="https://en.wikipedia.org/wiki/List_of_file_systems#File_systems_optimized_for_flash_memory.2C_solid_state_media" class="extiw" title="wikipedia:List of file systems">针对闪存优化的文件系统列表</a>。对于一般用途，您只需选择喜好的<a href="../en/File_systems.html" class="mw-redirect" title="Filesystem">文件系统</a>。
</p>
<div id="toc" class="toc" role="navigation" aria-labelledby="mw-toc-heading">
<input type="checkbox" role="button" id="toctogglecheckbox" class="toctogglecheckbox" style="display:none"><div class="toctitle" lang="en" dir="ltr">
<h2 id="mw-toc-heading">Contents</h2>
<span class="toctogglespan"><label class="toctogglelabel" for="toctogglecheckbox"></label></span>
</div>
<ul>
<li class="toclevel-1 tocsection-1">
<a href="#%E4%BD%BF%E7%94%A8"><span class="tocnumber">1</span> <span class="toctext">使用</span></a>
<ul>
<li class="toclevel-2 tocsection-2">
<a href="#TRIM"><span class="tocnumber">1.1</span> <span class="toctext">TRIM</span></a>
<ul>
<li class="toclevel-3 tocsection-3"><a href="#Periodic_TRIM"><span class="tocnumber">1.1.1</span> <span class="toctext">Periodic TRIM</span></a></li>
<li class="toclevel-3 tocsection-4"><a href="#Continuous_TRIM"><span class="tocnumber">1.1.2</span> <span class="toctext">Continuous TRIM</span></a></li>
<li class="toclevel-3 tocsection-5"><a href="#Trim%E6%95%B4%E4%B8%AA%E8%AE%BE%E5%A4%87"><span class="tocnumber">1.1.3</span> <span class="toctext">Trim整个设备</span></a></li>
<li class="toclevel-3 tocsection-6"><a href="#%E4%B8%BALVM%E5%90%AF%E7%94%A8TRIM"><span class="tocnumber">1.1.4</span> <span class="toctext">为LVM启用TRIM</span></a></li>
<li class="toclevel-3 tocsection-7"><a href="#%E4%B8%BAdm-crypt%E5%90%AF%E7%94%A8TRIM"><span class="tocnumber">1.1.5</span> <span class="toctext">为dm-crypt启用TRIM</span></a></li>
</ul>
</li>
<li class="toclevel-2 tocsection-8">
<a href="#%E6%8F%90%E5%8D%87%E6%80%A7%E8%83%BD"><span class="tocnumber">1.2</span> <span class="toctext">提升性能</span></a>
<ul>
<li class="toclevel-3 tocsection-9">
<a href="#%E7%89%A9%E7%90%86%E5%9D%97%E5%A4%A7%E5%B0%8F"><span class="tocnumber">1.2.1</span> <span class="toctext">物理块大小</span></a>
<ul>
<li class="toclevel-4 tocsection-10"><a href="#NVMe"><span class="tocnumber">1.2.1.1</span> <span class="toctext">NVMe</span></a></li>
<li class="toclevel-4 tocsection-11"><a href="#SATA"><span class="tocnumber">1.2.1.2</span> <span class="toctext">SATA</span></a></li>
</ul>
</li>
</ul>
</li>
<li class="toclevel-2 tocsection-12">
<a href="#%E5%AE%89%E5%85%A8"><span class="tocnumber">1.3</span> <span class="toctext">安全</span></a>
<ul>
<li class="toclevel-3 tocsection-13"><a href="#Hdparm_%E6%98%BE%E7%A4%BA_%22frozen%22_%E7%8A%B6%E6%80%81"><span class="tocnumber">1.3.1</span> <span class="toctext">Hdparm 显示 "frozen" 状态</span></a></li>
<li class="toclevel-3 tocsection-14"><a href="#SSD%E5%AD%98%E5%82%A8%E5%8D%95%E5%85%83%E7%9A%84%E6%B8%85%E9%99%A4"><span class="tocnumber">1.3.2</span> <span class="toctext">SSD存储单元的清除</span></a></li>
<li class="toclevel-3 tocsection-15"><a href="#%E7%A1%AC%E4%BB%B6%E5%8A%A0%E5%AF%86"><span class="tocnumber">1.3.3</span> <span class="toctext">硬件加密</span></a></li>
</ul>
</li>
</ul>
</li>
<li class="toclevel-1 tocsection-16">
<a href="#%E6%95%85%E9%9A%9C%E6%8E%92%E9%99%A4"><span class="tocnumber">2</span> <span class="toctext">故障排除</span></a>
<ul>
<li class="toclevel-2 tocsection-17"><a href="#%E5%A4%84%E7%90%86NCQ%E9%94%99%E8%AF%AF"><span class="tocnumber">2.1</span> <span class="toctext">处理NCQ错误</span></a></li>
<li class="toclevel-2 tocsection-18"><a href="#%E5%A4%84%E7%90%86%E4%B8%8ESATA%E7%94%B5%E6%BA%90%E7%AE%A1%E7%90%86%E6%9C%89%E5%85%B3%E7%9A%84%E9%94%99%E8%AF%AF"><span class="tocnumber">2.2</span> <span class="toctext">处理与SATA电源管理有关的错误</span></a></li>
<li class="toclevel-2 tocsection-19"><a href="#External_SSD_with_TRIM_support"><span class="tocnumber">2.3</span> <span class="toctext">External SSD with TRIM support</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-20">
<a href="#%E5%9B%BA%E4%BB%B6%E5%8D%87%E7%BA%A7"><span class="tocnumber">3</span> <span class="toctext">固件升级</span></a>
<ul>
<li class="toclevel-2 tocsection-21"><a href="#ADATA"><span class="tocnumber">3.1</span> <span class="toctext">ADATA</span></a></li>
<li class="toclevel-2 tocsection-22"><a href="#Crucial"><span class="tocnumber">3.2</span> <span class="toctext">Crucial</span></a></li>
<li class="toclevel-2 tocsection-23"><a href="#Intel"><span class="tocnumber">3.3</span> <span class="toctext">Intel</span></a></li>
<li class="toclevel-2 tocsection-24"><a href="#Kingston"><span class="tocnumber">3.4</span> <span class="toctext">Kingston</span></a></li>
<li class="toclevel-2 tocsection-25"><a href="#Mushkin"><span class="tocnumber">3.5</span> <span class="toctext">Mushkin</span></a></li>
<li class="toclevel-2 tocsection-26"><a href="#OCZ"><span class="tocnumber">3.6</span> <span class="toctext">OCZ</span></a></li>
<li class="toclevel-2 tocsection-27">
<a href="#Samsung"><span class="tocnumber">3.7</span> <span class="toctext">Samsung</span></a>
<ul>
<li class="toclevel-3 tocsection-28"><a href="#%E5%9C%A8Linux%E4%B8%8B%E6%9B%B4%E6%96%B0"><span class="tocnumber">3.7.1</span> <span class="toctext">在Linux下更新</span></a></li>
</ul>
</li>
<li class="toclevel-2 tocsection-29"><a href="#SanDisk"><span class="tocnumber">3.8</span> <span class="toctext">SanDisk</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-30"><a href="#%E5%8F%A6%E8%A7%81"><span class="tocnumber">4</span> <span class="toctext">另见</span></a></li>
</ul>
</div>

<h2>
<span id=".E4.BD.BF.E7.94.A8"></span><span class="mw-headline" id="使用">使用</span>
</h2>
<h3><span class="mw-headline" id="TRIM">TRIM</span></h3>
<p>绝大多数SSD支持 <a href="https://en.wikipedia.org/wiki/TRIM" class="extiw" title="wikipedia:TRIM">ATA_TRIM 命令</a> 以保持性能并降低损耗。<a rel="nofollow" class="external text" href="https://www.techspot.com/review/737-ocz-vector-150-ssd/page9.html">本文</a>展示了SSD装满数据前后的速度变化。
</p>
<p>自 Linux 内核版本 3.8 开始，对 TRIM 的支持不断被添加到不同的<a href="../en/File_systems.html" class="mw-redirect" title="Filesystems">文件系统</a>中。见下表：
</p>
<table class="wikitable sortable">
<tbody>
<tr>
<th>文件系统</th>
<th>Continuous TRIM <br> (<code>discard</code> option)</th>
<th>Periodic TRIM <br> (<i>fstrim</i>)</th>
<th>References<br> and notes
</th>
</tr>
<tr>
<td><a href="../en/Btrfs.html" title="Btrfs">Btrfs</a></td>
<td data-sort-value="5" style="background: #afa; color: inherit; vertical-align: middle; text-align: center;">是</td>
<td data-sort-value="5" style="background: #afa; color: inherit; vertical-align: middle; text-align: center;">是</td>
<td>
</td>
</tr>
<tr>
<td><a href="../en/Ext3.html" title="Ext3">Ext3</a></td>
<td data-sort-value="1" style="background: #faa; color: inherit; vertical-align: middle; text-align: center;">否</td>
<td style="background: inherit; color: inherit; vertical-align: middle; text-align: center;">?</td>
<td>
</td>
</tr>
<tr>
<td><a href="../en/Ext4.html" title="Ext4">Ext4</a></td>
<td data-sort-value="5" style="background: #afa; color: inherit; vertical-align: middle; text-align: center;">是</td>
<td data-sort-value="5" style="background: #afa; color: inherit; vertical-align: middle; text-align: center;">是</td>
<td>
<a rel="nofollow" class="external autonumber" href="https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/tree/Documentation/filesystems/ext4.txt?id=5012284700775a4e6e3fbe7eac4c543c4874b559#n342">[1]</a>
</td>
</tr>
<tr>
<td><a href="../en/F2FS.html" title="F2FS">F2FS</a></td>
<td data-sort-value="5" style="background: #afa; color: inherit; vertical-align: middle; text-align: center;">是</td>
<td data-sort-value="5" style="background: #afa; color: inherit; vertical-align: middle; text-align: center;">是</td>
<td>
</td>
</tr>
<tr>
<td><a href="../en/JFS.html" title="JFS">JFS</a></td>
<td data-sort-value="5" style="background: #afa; color: inherit; vertical-align: middle; text-align: center;">是</td>
<td data-sort-value="5" style="background: #afa; color: inherit; vertical-align: middle; text-align: center;">是</td>
<td>
<a rel="nofollow" class="external autonumber" href="https://www.phoronix.com/scan.php?page=news_item&amp;px=MTE5ODY">[2]</a>
</td>
</tr>
<tr>
<td><a href="https://en.wikipedia.org/wiki/NILFS" class="extiw" title="wikipedia:NILFS">NILFS2</a></td>
<td data-sort-value="5" style="background: #afa; color: inherit; vertical-align: middle; text-align: center;">是</td>
<td data-sort-value="5" style="background: #afa; color: inherit; vertical-align: middle; text-align: center;">是</td>
<td>
</td>
</tr>
<tr>
<td><a href="../en/NTFS-3G.html" title="NTFS-3G">NTFS-3G</a></td>
<td data-sort-value="1" style="background: #faa; color: inherit; vertical-align: middle; text-align: center;">否</td>
<td data-sort-value="5" style="background: #afa; color: inherit; vertical-align: middle; text-align: center;">是</td>
<td>since version 2015.3.14, <a rel="nofollow" class="external autonumber" href="http://permalink.gmane.org/gmane.comp.file-systems.ntfs-3g.devel/1101">[3]</a>
</td>
</tr>
<tr>
<td><a href="../en/FAT.html" class="mw-redirect" title="VFAT">VFAT</a></td>
<td data-sort-value="5" style="background: #afa; color: inherit; vertical-align: middle; text-align: center;">是</td>
<td data-sort-value="5" style="background: #afa; color: inherit; vertical-align: middle; text-align: center;">是</td>
<td>
<i>fstrim</i> is supported since kernel 4.19
</td>
</tr>
<tr>
<td><a href="../en/XFS.html" title="XFS">XFS</a></td>
<td data-sort-value="5" style="background: #afa; color: inherit; vertical-align: middle; text-align: center;">是</td>
<td data-sort-value="5" style="background: #afa; color: inherit; vertical-align: middle; text-align: center;">是</td>
<td>
<a rel="nofollow" class="external autonumber" href="http://xfs.org/index.php/FITRIM/discard">[4]</a>
</td>
</tr>
</tbody>
</table>
<div class="archwiki-template-box archwiki-template-box-warning">
<strong>警告：</strong> 在启用TRIM功能前，请确保你的SSD支持TRIM。否则可能导致数据丢失！</div>
<p>检验TRIM支持：
</p>
<pre>$ lsblk --discard
</pre>
<p>查看DISC-GRAN (discard granularity)和DISC-MAX (discard max bytes)列。非零数值表示对应设备支持TRIM。
</p>
<p>或者，<a href="../en/Help:Reading.html#Installation_of_packages" class="mw-redirect" title="Install">安装</a><span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=hdparm">hdparm</a></span> 包并执行：
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;"># hdparm -I /dev/sda | grep TRIM</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">        *    Data Set Management TRIM supported (limit 1 block)
</pre>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>注意：</strong> 不同的规范定义了不同的TRIM支持类型。因此，对于不同设备，以上输出可能不同。参见<a href="https://en.wikipedia.org/wiki/TRIM#ATA" class="extiw" title="wikipedia:TRIM">Wikipedia:TRIM#ATA</a>
</div>
<h4><span class="mw-headline" id="Periodic_TRIM">Periodic TRIM</span></h4>
<p><span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=util-linux">util-linux</a></span>包提供了<code>fstrim.service</code>和<code>fstrim.timer</code>两个Systemd unit文件。<a href="../en/Systemd.html#Using_units" class="mw-redirect" title="Enabling">启用</a>计时器(<code>fstrim.timer</code>)会每周激活服务来在所有已挂载的支持discard操作的文件系统上执行<span class="plainlinks archwiki-template-man" title="$ man 8 fstrim"><a rel="nofollow" class="external text" href="https://man.archlinux.org/man/fstrim.8">fstrim(8)</a></span>。
</p>
<p>该计时器使用<code>/var/lib/systemd/timers/stamp-fstrim.timer</code>（将在服务第一次启动时创建）的时间戳来判断上次运行的时间。因此，不必担心服务被太过频繁地调用。
</p>
<p>该unit的状态与活动可通过<a href="../en/Systemd/Journal.html" class="mw-redirect" title="Journalctl">journalctl</a>查看。若要修改运行的周期或执行的指令，可<a href="../en/Systemd.html#Editing_provided_units" class="mw-redirect" title="Edit">编辑unit</a>文件。
</p>
<h4><span class="mw-headline" id="Continuous_TRIM">Continuous TRIM</span></h4>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>注意：</strong> 如果已定期运行<code>fstrim</code>，就不必再启用Continuous TRIM。只需在periodic TRIM和Continuous TRIM中选择一个即可。</div>
<p>除定期（若使用<code>fstrim.timer</code>则默认为每周）执行TRIM指令外，也可每次在文件被删除后就立即执行TRIM指令（这被称为Continuous TRIM）。
</p>
<div class="archwiki-template-box archwiki-template-box-warning">
<strong>警告：</strong> 在<a href="https://en.wikipedia.org/wiki/Serial_ATA#SATA_revision_3.1" class="extiw" title="wikipedia:Serial ATA">SATA 3.1</a>前，所有TRIM指令都是非队列(non-queued)的，使用Continuous TRIM将造成频繁的卡顿，此时应使用<a href="#Periodic_TRIM">#Periodic TRIM</a>。此外，某些设备也会造成类似问题。因为在这些设备上，队列的TRIM指令会造成严重的数据损坏。在这种情况下，系统可能会强制发送非队列的TRIM指令。参见<a rel="nofollow" class="external text" href="https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/tree/drivers/ata/libata-core.c">Linux源码</a>中的<code>ata_device_blacklist</code>。详见<a href="https://en.wikipedia.org/wiki/Trim_(computing)#Disadvantages" class="extiw" title="wikipedia:Trim (computing)">Wikipedia:Trim_(computing)#Disadvantages</a>
</div>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>注意：</strong> Continuous TRIM不是最被Linux社区推荐的TRIM方式。例如，Ubuntu默认使用periodic TRIM<a rel="nofollow" class="external autonumber" href="https://askubuntu.com/questions/1034169/is-trim-enabled-on-my-ubuntu-18-04-installation">[5]</a>, Debian不建议使用continuous TRIM <a rel="nofollow" class="external autonumber" href="https://wiki.debian.org/SSDOptimization#Mounting_SSD_filesystems">[6]</a>，Red Hat建议在可行的情况下使用periodic TRIM而非continuous TRIM。<a rel="nofollow" class="external autonumber" href="https://access.redhat.com/documentation/en-US/Red_Hat_Enterprise_Linux/7/html/Storage_Administration_Guide/ch02s04.html">[7]</a><sup title="Last check status: 404">[<a href="https://en.wikipedia.org/wiki/Wikipedia:Link_rot" class="extiw" title="wikipedia:Wikipedia:Link rot">dead link</a> 2020-04-03 ⓘ]</sup>（存档于<a rel="nofollow" class="external autonumber" href="https://web.archive.org/web/20160917183831/https://access.redhat.com/documentation/en-US/Red_Hat_Enterprise_Linux/7/html/Storage_Administration_Guide/ch02s04.html">[8]</a>）</div>
<p>要使用Continuous TRIM，在<code>/etc/fstab</code>中对应挂载点指定<code>discard</code>选项：
</p>
<pre>/dev/sda1  /           ext4  defaults,<b>discard</b>   0  1
</pre>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>注意：</strong> 不能在<code>/etc/fstab</code>中为XFS <code>/</code> 分区指定discard挂载选项选项。根据<a rel="nofollow" class="external text" href="https://bbs.archlinux.org/viewtopic.php?id=143254">此帖子</a>，必须使用<code>rootflags=discard</code> <a href="../en/Kernel_parameters.html" class="mw-redirect" title="Kernel parameter">内核参数</a>。</div>
<p>对于Ext4文件系统，也可用<i>tune2fs</i>将<code>discard</code>设置为一个<a href="../en/Access_Control_Lists.html#Enable_ACL" title="Access Control Lists">默认挂载选项</a>：
</p>
<pre># tune2fs -o discard /dev/sd<b>XY</b>
</pre>
<p>使用此方式代替<code>/etc/fstab</code>中的条目对于可移动驱动器尤其有用。这样，在其他计算机上挂载分区时，就不需要每次修改<code>/etc/fstab</code>了。
</p>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>注意：</strong> 此默认挂载选项不会在<code>/proc/mounts</code>中列出。</div>
<h4>
<span id="Trim.E6.95.B4.E4.B8.AA.E8.AE.BE.E5.A4.87"></span><span class="mw-headline" id="Trim整个设备">Trim整个设备</span>
</h4>
<p>当在全新安装或想卖掉你的SSD时，你可能想Trim整个设备。可以使用blkdiscard命令，这将立即丢弃设备上所有的block。
</p>
<div class="archwiki-template-box archwiki-template-box-warning">
<strong>警告：</strong> 设备上的所有数据都将丢失！</div>
<pre># blkdiscard /dev/sd<i>X</i>
</pre>
<h4>
<span id=".E4.B8.BALVM.E5.90.AF.E7.94.A8TRIM"></span><span class="mw-headline" id="为LVM启用TRIM">为LVM启用TRIM</span>
</h4>
<p>由LVM逻辑卷上的文件系统产生的TRIM请求将直达对应物理卷。因此，无需额外的配置。
</p>
<p><a href="../en/LVM.html" title="LVM">LVM</a>操作（<i>lvremove</i>, <i>lvreduce</i>等）默认不会产生TRIM请求，以便使用<span class="plainlinks archwiki-template-man" title="$ man 8 vgcfgrestore"><a rel="nofollow" class="external text" href="https://man.archlinux.org/man/vgcfgrestore.8">vgcfgrestore(8)</a></span>恢复之前的卷组（VG）设定。<code>/etc/lvm/lvm.conf</code>中的<code>issue_discards</code>设置决定是否在逻辑卷不再占用卷组空间时将discard发送给底层物理卷。
</p>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>注意：</strong> 在修改<code>issue_discards</code>设置前，请仔细阅读<code>/etc/lvm/lvm.conf</code>中的注释。<code>issue_discards</code>设置不会影响由逻辑卷文件系统产生的TRIM请求（如在文件系统内删除文件）的传递，也不会影响thin pool中的空间管理。</div>
<div class="archwiki-template-box archwiki-template-box-warning">
<strong>警告：</strong> 启用<code>issue_discards</code>后，将不能再使用<i>vgcfgrestore</i>恢复卷组（VG）元数据。一旦执行LVM命令，将无法撤销。</div>
<h4>
<span id=".E4.B8.BAdm-crypt.E5.90.AF.E7.94.A8TRIM"></span><span class="mw-headline" id="为dm-crypt启用TRIM">为dm-crypt启用TRIM</span>
</h4>
<div class="archwiki-template-box archwiki-template-box-warning">
<strong>警告：</strong> discard选项允许discard请求通过加密的块设备传递。这可能并不会<a rel="nofollow" class="external autonumber" href="https://www.spinics.net/lists/raid/msg40916.html">[9]</a> <a rel="nofollow" class="external autonumber" href="https://wiki.debian.org/SSDOptimization#Mounting_SSD_filesystems">[10]</a>提升SSD性能，而且有安全风险。详见<a href="../en/Dm-crypt/Specialties.html#Discard/TRIM_support_for_solid_state_drives_(SSD)" title="Dm-crypt/Specialties">dm-crypt/Specialties#Discard/TRIM support for solid state drives (SSD)</a>。</div>
<p>对非<code>/</code>文件系统，为SSD上的块设备配置 <code>/etc/crypttab</code> 来把 <code>discard</code> 加入到选项列表中 (见 <a href="../en/Dm-crypt/System_configuration.html#crypttab" title="Dm-crypt/System configuration">Dm-crypt/System configuration#crypttab</a>)。
</p>
<p>对于<code>/</code>文件系统，遵循 <a href="../en/Dm-crypt/Specialties.html#Discard.2FTRIM_support_for_solid_state_drives_.28SSD.29" title="Dm-crypt/Specialties">Dm-crypt/TRIM support for SSD</a> 的指示来将正确的内核参数加入到bootloader配置中。
</p>
<h3>
<span id=".E6.8F.90.E5.8D.87.E6.80.A7.E8.83.BD"></span><span class="mw-headline" id="提升性能">提升性能</span>
</h3>
<p>参照<a href="../en/Improving_performance.html#Storage_devices" title="Improving performance">Improving performance#Storage devices</a>中的提示来提高SSD性能。
</p>
<h4>
<span id=".E7.89.A9.E7.90.86.E5.9D.97.E5.A4.A7.E5.B0.8F"></span><span class="mw-headline" id="物理块大小">物理块大小</span>
</h4>
<p>大多数SSD将其扇区大小报告为512字节（与HDD兼容），但实际上具有更大的块大小 -- 通常是4kB、8kB甚至更大。由于被认为扇区大小为512字节，文件系统不能自动优化到物理块大小。为防止性能损失，应在创建文化系统时手动指定扇区大小。
</p>
<p>作为手动指定扇区大小的替代，某些SSD可在格式化时更改块大小，因此其可能会汇报一个更接近其真实数值的块大小。
</p>
<h5><span class="mw-headline" id="NVMe">NVMe</span></h5>
<p>使用<i>Identify Namespace</i>命令来查看指定的NVMe设备是否支持该特性。
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;"># nvme id-ns /dev/nvme0n1</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">nlbaf   : 0
[...]
lbaf  0 : ms:0   lbads:9  rp:0 (in use)
</pre>
<p><code>nlbaf</code>是支持的LBA格式数减1，所以本例中只支持1种格式。支持的格式列举在其后。<code>lbaf 0</code>表示支持LBA format #0。其<code>lbads</code>（LBA data size）为9，表示块大小为2<sup>9</sup>=512字节。如果设备支持4kB块大小，<code>lbads</code>将会是12。<code>rp</code>（相对性能）表示那种LBA格式具有最好的性能，0表示当前格式具有最好的性能。<code>ms</code>（可能）是每个块中额外的元数据大小（Bytes），在Linux下，对其的支持并不完善，所以最好选择该值为0的格式。
</p>
<p>要修改块大小，使用<code>nvme format</code>命令并通过<code>--lbaf</code>参数指定对应的lbaf值。
</p>
<h5><span class="mw-headline" id="SATA">SATA</span></h5>
<p>对于SATA设备，必须使用制造商提供的工具。 不是所有的SATA设备都支持修改块大小。
</p>
<ul><li>Intel: 使用<a rel="nofollow" class="external text" href="https://downloadcenter.intel.com/download/29337/Intel-Memory-and-Storage-Tool-CLI-Command-Line-Interface-?product=83425">Intel Memory and Storage (MAS) 工具</a> (<span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://aur.archlinux.org/packages/intel-mas-cli-tool/">intel-mas-cli-tool</a></span><sup><small>AUR</small></sup>)及<code>-set PhysicalSectorSize=4096</code>参数。</li></ul>
<h3>
<span id=".E5.AE.89.E5.85.A8"></span><span class="mw-headline" id="安全">安全</span>
</h3>
<h4>
<span id="Hdparm_.E6.98.BE.E7.A4.BA_.22frozen.22_.E7.8A.B6.E6.80.81"></span><span class="mw-headline" id='Hdparm_显示_"frozen"_状态'>Hdparm 显示 "frozen" 状态</span>
</h4>
<p>一些主板BIOS在初始化时发送了"security freeze"命令给连接上的存储设备。同样，一些SSD(和HDD) BIOS在工厂已设置为"security freeze"。二者都会导致设备的密码安全设置设为 <b>frozen</b>，如下面的输出: 
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">:~# hdparm -I /dev/sda</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">Security: 
 	Master password revision code = 65534
 		supported
 	not	enabled
 	<b>not	locked</b>
 		<b>frozen</b>
 	not	expired: security count
 		supported: enhanced erase
 	4min for SECURITY ERASE UNIT. 2min for ENHANCED SECURITY ERASE UNIT.</pre>
<p>如格式化设备或安装新系统之类的操作不受"security freeze"影响。 
</p>
<p>上面的输出显示了设备在启动时<b>not locked</b>，而<b>frozen</b>状态保护设备免于间谍软件侵害。它们试图在运行时设置密码来达到目的。
</p>
<p>如果你想为"frozen"的设备设置密码，则必须要主板BIOS支持才可。许多笔记本都支持，这是因为这是 <a href="https://en.wikipedia.org/wiki/Hardware-based_full_disk_encryption" class="extiw" title="wikipedia:Hardware-based full disk encryption">硬件加密</a> 所必需的，但并非台式机/服务器主板所必需。例如，对于 Intel DH67CL/BL 主板，必须用跳线设置为"maintenance mode"来查看设置 (见 <a rel="nofollow" class="external autonumber" href="https://sstahlman.blogspot.in/2014/07/hardware-fde-with-intel-ssd-330-on.html?showComment=1411193181867#c4579383928221016762">[11]</a><sup title="最后检查状态：domain name not resolved">[<a href="https://en.wikipedia.org/wiki/Wikipedia:Link_rot" class="extiw" title="wikipedia:Wikipedia:Link rot">失效链接</a> 2020-08-04 ⓘ]</sup>, <a rel="nofollow" class="external autonumber" href="https://communities.intel.com/message/251978#251978">[12]</a>)。 
</p>
<div class="archwiki-template-box archwiki-template-box-warning">
<strong>警告：</strong> 不要试图用<code>hdparm</code>来改变上述的<b>lock</b>安全设置，除非你十分清楚自己在干什么。</div>
<p>如果你想擦除SSD，见 <a href="../en/Securely_wipe_disk.html#hdparm" title="Securely wipe disk">Securely wipe disk#hdparm</a> 以及 <a href="#SSD%E5%AD%98%E5%82%A8%E5%8D%95%E5%85%83%E7%9A%84%E6%B8%85%E9%99%A4">下文</a>。
</p>
<h4>
<span id="SSD.E5.AD.98.E5.82.A8.E5.8D.95.E5.85.83.E7.9A.84.E6.B8.85.E9.99.A4"></span><span class="mw-headline" id="SSD存储单元的清除">SSD存储单元的清除</span>
</h4>
<p>有时用户希望通过重置SSD单元到刚安装时的纯净状态以使其恢复到 <a rel="nofollow" class="external text" href="https://www.anandtech.com/storage/showdoc.aspx?i=3531&amp;p=8">出厂时的写入性能</a>。即使是原生支持TRIM的SSD，其写入性能也会随时间变差。TRIM只在文件删除时起作用，而不是如增量保存一样的替代保障措施。
</p>
<p>重置按wiki文章<a href="../en/Solid_state_drive/Memory_cell_clearing.html" class="mw-redirect" title="SSD memory cell clearing">SSD memory cell clearing</a>指示，三步之内即可轻松完成。如果重置的原因是为了擦除数据，你可能不想依靠SSD bios来安全执行。更多信息与例子见<a href="../en/Securely_wipe_disk.html#Flash_memory" title="Securely wipe disk">Securely wipe disk#Flash memory</a>。
</p>
<h4>
<span id=".E7.A1.AC.E4.BB.B6.E5.8A.A0.E5.AF.86"></span><span class="mw-headline" id="硬件加密">硬件加密</span>
</h4>
<p>正如<a href="#Hdparm_%E6%98%BE%E7%A4%BA_%22frozen%22_%E7%8A%B6%E6%80%81">#Hdparm 显示 "frozen" 状态</a>中提到的，在BIOS中为存储设备（SSD/HDD）设置密码可能在支持的设备上启动硬件加密。如果设备同时符合OPAL标准，硬件加密还可能在BIOS没有设置密码的功能上实现，见<a href="../en/Self-encrypting_drives.html" title="Self-encrypting drives">Self-encrypting drives</a>。
</p>
<h2>
<span id=".E6.95.85.E9.9A.9C.E6.8E.92.E9.99.A4"></span><span class="mw-headline" id="故障排除">故障排除</span>
</h2>
<p>你遇到的问题可能是由于SSD固件而不是Linux产生的。在尝试排除故障前，请检查以下固件是否有更新：
</p>
<ul>
<li>
<a href="#Firmware">SSD的固件</a><sup>[<a href="../en/ArchWiki:Requests.html#Broken_section_links" class="mw-redirect" title="ArchWiki:Requests">断开的链接</a>：无效的部分]</sup>
</li>
<li><a href="../en/Flashing_BIOS_from_Linux.html" title="Flashing BIOS from Linux">主板的BIOS/UEFI</a></li>
</ul>
<p>即使是固件的bug，也可能在不更新固件的情况下避免。若没有固件更新可用，或你不想进行固件更新，以下内容可能有所帮助。
</p>
<h3>
<span id=".E5.A4.84.E7.90.86NCQ.E9.94.99.E8.AF.AF"></span><span class="mw-headline" id="处理NCQ错误">处理NCQ错误</span>
</h3>
<p>部分SSD和SATA芯片组并不在Linux的原生命令队列(NCQ)下正常工作。dmesg错误提示看起来像这样: 
</p>
<pre>[ 9.115544] ata9: exception Emask 0x0 SAct 0xf SErr 0x0 action 0x10 frozen
[ 9.115550] ata9.00: failed command: READ FPDMA QUEUED
[ 9.115556] ata9.00: cmd 60/04:00:d4:82:85/00:00:1f:00:00/40 tag 0 ncq 2048 in
[ 9.115557] res 40/00:18:d3:82:85/00:00:1f:00:00/40 Emask 0x4 (timeout)
</pre>
<p>要在系统启动时禁用NCQ，在<a href="../en/Arch_boot_process.html#Boot_loader" class="mw-redirect" title="Bootloader">bootloader</a>配置中添加内核命令行<code>libata.force=noncq</code>。要仅为disk0 port9关闭NCQ，使用：<code>libata.force=9.00:noncq</code>
</p>
<p>或者，可通过sysfs在不重启的情况下在指定设备上关闭NCQ：
</p>
<pre># echo 1 &gt; /sys/block/sdX/device/queue_depth
</pre>
<p>如果问题仍未得到解决或导致了其他问题，<a href="../en/Bug_reporting_guidelines.html" class="mw-redirect" title="Reporting bug guidelines">提交一个bug</a>。
</p>
<h3>
<span id=".E5.A4.84.E7.90.86.E4.B8.8ESATA.E7.94.B5.E6.BA.90.E7.AE.A1.E7.90.86.E6.9C.89.E5.85.B3.E7.9A.84.E9.94.99.E8.AF.AF"></span><span class="mw-headline" id="处理与SATA电源管理有关的错误">处理与SATA电源管理有关的错误</span>
</h3>
<p>某些SSD（如Transcend MTS400）在SATA Active Link Power Management（<a href="https://en.wikipedia.org/wiki/Aggressive_Link_Power_Management" class="extiw" title="wikipedia:Aggressive Link Power Management">ALPM</a>）启用时会出现错误。
ALPM默认关闭，并被节能程序（如<a href="../en/TLP.html" title="TLP">TLP</a>, <a href="../en/Laptop_Mode_Tools.html" title="Laptop Mode Tools">Laptop Mode Tools</a>）启用。
</p>
<p>如果在使用这些节能程序时遇到SATA相关错误，应将使用电池时与充电时的电源配置都设为<code>max_performance</code>来关闭ALPM。
</p>
<h3><span class="mw-headline" id="External_SSD_with_TRIM_support">External SSD with TRIM support</span></h3>
<div class="noprint archwiki-template-message">
<p><a href="../File:Tango-edit-clear.png" class="image"><img alt="Tango-edit-clear.png" src="../File:Tango-edit-clear.png" decoding="async" width="48" height="48"></a><b>This article or section needs language, wiki syntax or style improvements. See <a href="../en/Help:Style.html" title="Help:Style">Help:Style</a> for reference.</b><a href="../File:Tango-edit-clear.png" class="image"><img alt="Tango-edit-clear.png" src="../File:Tango-edit-clear.png" decoding="async" width="48" height="48"></a></p>
<div>
<b>Reason:</b> Several <a href="../en/Help:Style.html" title="Help:Style">style</a> and formatting problems, especially too many explicit commands - see <a href="../en/Help:Style.html#File_editing_requests" title="Help:Style">Help:Style#File editing requests</a>. (Discuss in <a rel="nofollow" class="external text" href="https://wiki.archlinux.org/index.php/Talk:Solid_state_drive_(%E7%AE%80%E4%BD%93%E4%B8%AD%E6%96%87)">Talk:Solid state drive (简体中文)#</a>)</div>
</div>
<p>Several USB-to-SATA bridge chips (like VL715, VL716 etc.) and also USB-to-PCIe bridge chips (like the <a rel="nofollow" class="external text" href="http://www.jmicron.com/PDF/brief/jms583.pdf">JMicron JMS583</a> used in external NVMe enclosures like <a rel="nofollow" class="external text" href="https://www.raidsonic.de/en/standards/searchresults.php?we_objectID=5666">IB-1817M-C31</a>) support TRIM-like commands that can be sent through the <a href="https://en.wikipedia.org/wiki/USB_Attached_SCSI" class="extiw" title="wikipedia:USB Attached SCSI">USB Attached SCSI</a> driver (named "uas" under Linux).
</p>
<p>But the kernel may not automatically detect this capability, and therefore might not use it.
Assuming your block device in question is /dev/sdX, you can find out whether that is the case by using the command
</p>
<pre> sg_readcap -l /dev/sdX
</pre>
<p>If in its output you find a line stating "Logical block provisioning: lbpme=0" then you know that the kernel assumes the device does not support "<a rel="nofollow" class="external text" href="https://www.seagate.com/files/staticfiles/support/docs/manual/Interface%20manuals/100293068k.pdf#G4.1427908">Logical Block Provisioning Management</a>" because the (LBPME) bit is not set.
</p>
<p>If this is the case, then you should next find out whether the <a rel="nofollow" class="external text" href="https://www.seagate.com/files/staticfiles/support/docs/manual/Interface%20manuals/100293068k.pdf#G4.3076244">"Vital Product Data" (VPD) page on "Logical Block Provisioning"</a> of your device tells of supported mechanisms for unmapping data. You can do this using the command:
</p>
<pre> sg_vpd -a /dev/sdX
</pre>
<p>Look for lines in the output that look like this:
</p>
<pre> Unmap command supported (LBPU): 1
 Write same (16) with unmap bit supported (LBPWS): 0
 Write same (10) with unmap bit supported (LBPWS10): 0
</pre>
<p>This example would tell you the device supports the "UNMAP" command.
</p>
<p>Have a look at the output of
</p>
<pre> cat /sys/block/sdX/device/scsi_disk/*/provisioning_mode
</pre>
<p>If the kernel did not detect the capability of your device to unmap data, then this will likely return "full".
Apart from "full", the kernel SCSI storage driver currently knows the following values for provisioning_mode:
</p>
<pre> unmap
 writesame_16
 writesame_10
 writesame_zero
 disabled
</pre>
<p>For the example above, you could now write "unmap" to "provisioning_mode" to ask the kernel to use that:
</p>
<pre> echo "unmap" &gt;/sys/block/sdX/device/scsi_disk/*/provisioning_mode
</pre>
<p>This should immediately enable you to use tools like "blkdiscard" on /dev/sdX or "fstrim" on filesystems mounted on /dev/sdX.
</p>
<p>If you want to enable a "provisioning_mode" automatically when an external device of a certain vendor/product is attached, this can be automated via the "<a href="../en/Udev.html" title="Udev">udev</a>" mechanism. First find the USB Vendor and Product IDs:
</p>
<pre> cat /sys/block/sdX/../../../../../../idVendor
 cat /sys/block/sdX/../../../../../../idProduct
</pre>
<p>Then create or append to a <a href="../en/Udev.html" title="Udev">udev</a> rule file (example here using idVendor 152d and idProduct 0583):
</p>
<pre> echo 'ACTION=="add|change", ATTRS{idVendor}=="152d", ATTRS{idProduct}=="0583", SUBSYSTEM=="scsi_disk", ATTR{provisioning_mode}="unmap"' &gt;&gt;/etc/udev/rules.d/10-uas-discard.rules
</pre>
<p>(You can also use the <code>lsusb</code> command to look for the relevant idVendor / idProduct.)
</p>
<h2>
<span id=".E5.9B.BA.E4.BB.B6.E5.8D.87.E7.BA.A7"></span><span class="mw-headline" id="固件升级">固件升级</span>
</h2>
<h3><span class="mw-headline" id="ADATA">ADATA</span></h3>
<p>ADATA 在其<a rel="nofollow" class="external text" href="http://www.adata.com.tw/index.php?action=ss_main&amp;page=ss_content_driver&amp;lan=en">支持页面</a>上提供了Linux (i686)版的工具。在选择型号之后会出现到最新固件的链接。最新的Linux上的升级工具打包有固件，并必须以root权限运行。必须首先给二进制文件设置合适的权限。
</p>
<h3><span class="mw-headline" id="Crucial">Crucial</span></h3>
<p>Crucial 提供了以ISO镜像文件升级固件的选项。镜像可以在<a rel="nofollow" class="external text" href="http://www.crucial.com/usa/en/support-ssd">选择产品</a>和下载"Manual Boot File"之后找到。
</p>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>注意：</strong> Crucial提供的ISO镜像可能不是hybrid格式。如果直接使用<code>dd</code>命令将镜像复制到设备上，由于<a href="../en/Partitioning.html#Master_Boot_Record" class="mw-redirect" title="MBR">MBR</a>不会被设置，将无法从该设备启动。</div>
<p>M4 Crucial model用户可通过<code>smartctl</code>检查是否有需要的固件更新。
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">$ smartctl --all /dev/sd<b>X</b></pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">==&gt; WARNING: This drive may hang after 5184 hours of power-on time:
<a rel="nofollow" class="external free" href="https://www.tomshardware.com/news/Crucial-m4-Firmware-BSOD,14544.html">https://www.tomshardware.com/news/Crucial-m4-Firmware-BSOD,14544.html</a>
See the following web pages for firmware updates:
<a rel="nofollow" class="external free" href="http://www.crucial.com/support/firmware.aspx">http://www.crucial.com/support/firmware.aspx</a><sup title="最后检查状态：404">[<a href="https://en.wikipedia.org/wiki/Wikipedia:Link_rot" class="extiw" title="wikipedia:Wikipedia:Link rot">失效链接</a> 2020-08-04 ⓘ]</sup>
<a rel="nofollow" class="external free" href="http://www.micron.com/products/solid-state-storage/client-ssd#software">http://www.micron.com/products/solid-state-storage/client-ssd#software</a><sup title="最后检查状态：404">[<a href="https://en.wikipedia.org/wiki/Wikipedia:Link_rot" class="extiw" title="wikipedia:Wikipedia:Link rot">失效链接</a> 2020-08-04 ⓘ]</sup>
</pre>
<p>建议看见这个警告的用户备份所有重要数据并<b>立即升级</b>。参见<a rel="nofollow" class="external text" href="http://www.rojtberg.net/1008/updating-crucial-mx100-firmware-with-ubuntu/">该指引</a>来使用ISO镜像和grub来更新Crucial MX100的固件。
</p>
<h3><span class="mw-headline" id="Intel">Intel</span></h3>
<p>对于无法使用Windows版本<a rel="nofollow" class="external text" href="https://downloadcenter.intel.com/download/18455">Intel® Solid-State Drive Toolbox</a>软件的系统，Intel提供了一个基于Linux live系统的<a rel="nofollow" class="external text" href="https://downloadcenter.intel.com/download/18363">固件更新工具</a>。
</p>
<p>此外，还可用使用<a rel="nofollow" class="external text" href="https://downloadcenter.intel.com/download/29337/Intel-Memory-and-Storage-Tool-CLI-Command-Line-Interface-?product=83425">Intel Memory and Storage (MAS) Tool</a>（<span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://aur.archlinux.org/packages/intel-mas-cli-tool/">intel-mas-cli-tool</a></span><sup><small>AUR</small></sup>）命令行工具来在Linux下刷入固件。其<a rel="nofollow" class="external text" href="https://downloadmirror.intel.com/29337/eng/Intel_Memory_And_Storage_Tool_User%20Guide-Public-342245-001US.pdf">PDF用户指南</a>。
</p>
<p>一个检查固件状态的例子：
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;"># intelmas show -intelssd 0</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">DevicePath : /dev/nvme0n1
DeviceStatus : Healthy
Firmware : 002C
FirmwareUpdateAvailable : The selected Intel SSD contains current firmware as of this tool release.
</pre>
<p>若有多个SSD，请将<code>-intelssd 0</code>修改为对应的值（<code>1</code>对应第二块SSD，以此类推）。
</p>
<p>如果有可用的更新，可通过<code>intelmas load -intelssd 0</code>来应用。PDF用户指南建议进行应用操作后重启并再进行一次。所有设备的最新固件都作为MAS工具的一部分发布，无需单独下载。
</p>
<h3><span class="mw-headline" id="Kingston">Kingston</span></h3>
<p>适用于基于Sandforce设备的KUF工具可从<span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://aur.archlinux.org/packages/kingston_fw_updater/">kingston_fw_updater</a></span><sup><small>AUR</small></sup>获取。
</p>
<h3><span class="mw-headline" id="Mushkin">Mushkin</span></h3>
<p>不怎么出名的 Mushkin 牌固态硬盘也使用 Sandforce 控制器，提供了Linux版的升级工具 (和 Kingston 的几乎一样)。
</p>
<h3><span class="mw-headline" id="OCZ">OCZ</span></h3>
<p>OCZ 在<a rel="nofollow" class="external text" href="http://www.ocztechnology.com/ssd_tools/">论坛</a>上提供了Linux (i686 and x86_64) 版的升级工具。
</p>
<h3><span class="mw-headline" id="Samsung">Samsung</span></h3>
<p>Samsung 注意到使用他们的 Magician Software 是"不支持的"，但是是可能的。显然 Magician Software 可以把USB做成以升级固件启动。最简单的方式是使用他们提供的用于升级固件的可启动的ISO镜像。可从<a rel="nofollow" class="external text" href="https://www.samsung.com/global/business/semiconductor/samsungssd/downloads.html">这里</a>获取。
</p>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>注意：</strong> Samsung 根本不明确提供这些。他们似乎有四个固件升级页面，每个页面要求做不同的事情。</div>
<p>用户更喜欢从USB的live Linux系统上升级固件(而不是在Microsoft Windows下用三星的 "Magician" 软件)。参见<a rel="nofollow" class="external text" href="http://fomori.org/blog/?p=933">这里</a>。
</p>
<h4>
<span id=".E5.9C.A8Linux.E4.B8.8B.E6.9B.B4.E6.96.B0"></span><span class="mw-headline" id="在Linux下更新">在Linux下更新</span>
</h4>
<p>此外，固件可在不使用USB启动盘的情况下直接更新。首先，从<a rel="nofollow" class="external text" href="https://www.samsung.com/semiconductor/minisite/ssd/download/tools.html">这里</a>下载适用于Windows的最新固件（一个磁盘镜像，以<code>Samsung_SSD_840_EVO_EXT0DB6Q.iso</code>为例）。
</p>
<p>设置磁盘镜像：
</p>
<pre>$ udisksctl loop-setup -r -f Samsung_SSD_840_EVO_EXT0DB6Q.iso
</pre>
<p>这会将ISO映射到一个loop设备，假设为<code>/dev/loop0</code>。执行：
</p>
<pre>$ udisksctl mount -b /dev/loop0
</pre>
<p>获取需要镜像中需要的内容：
</p>
<pre>$ mkdir Samsung_SSD_840_EVO_EXT0DB6Q
$ cp -r /run/media/$USER/CDROM/isolinux/ Samsung_SSD_840_EVO_EXT0DB6Q
</pre>
<p>卸载镜像：
</p>
<pre>$ udisksctl unmount -b /dev/loop0
$ cd Samsung_SSD_840_EVO_EXT0DB6Q/isolinux
</pre>
<p>固件包含在一个FreeDOS镜像中，用上文的方法将其挂载：
</p>
<pre>$ udisksctl loop-setup -r -f btdsk.img
$ udisksctl mount -b /dev/loop1
$ cp -r /run/media/$USER/C04D-1342/ Samsung_SSD_840_EVO_EXT0DB6Q
$ cd Samsung_SSD_840_EVO_EXT0DB6Q/C04D-1342/samsung
</pre>
<p>使用magician获取目标SSD的编号：
</p>
<pre># magician -L
</pre>
<p>假设编号为0，执行：
</p>
<pre># magician --disk 0 -F -p DSRD
</pre>
<p>确认固件已被更新：
</p>
<pre># magician -L
</pre>
<p>最后，重启计算机。
</p>
<h3><span class="mw-headline" id="SanDisk">SanDisk</span></h3>
<p>SanDisk 制作<b>ISO固件镜像</b>来允许用户在 SanDisk SSD 工具包不支持的系统上升级。必须找到正确的<i>SSD 型号</i>以及它的<i>容量</i>(例如 60GB, <b>或者</b> 256GB)。烧制合适的ISO固件镜像之后，只需重启电脑启动到新创立的CD/DVD启动盘(也可以是USB)。
</p>
<p>ISO镜像必须只包含一个linux内核和一个initrd.解压到 <code>/boot</code> 分区并用 <a href="../en/GRUB.html" title="GRUB">GRUB</a> 或者 <a href="../en/Syslinux.html" title="Syslinux">Syslinux</a> 启动它来升级。
</p>
<p>目前我找不到列出固件升级的单独页面(恕我直言网站简直一团糟)，但这里有一些相关链接:
</p>
<p>SanDisk Extreme SSD <a rel="nofollow" class="external text" href="http://kb.sandisk.com/app/answers/detail/a_id/10127">Firmware Release notes</a> and <a rel="nofollow" class="external text" href="http://kb.sandisk.com/app/answers/detail/a_id/10476">Manual Firmware update version R211</a> 
</p>
<p>SanDisk Ultra SSD <a rel="nofollow" class="external text" href="http://kb.sandisk.com/app/answers/detail/a_id/10192">Firmware release notes</a> and <a rel="nofollow" class="external text" href="http://kb.sandisk.com/app/answers/detail/a_id/10477">Manual Firmware update version 365A13F0</a>
</p>
<h2>
<span id=".E5.8F.A6.E8.A7.81"></span><span class="mw-headline" id="另见">另见</span>
</h2>
<ul>
<li><a rel="nofollow" class="external text" href="https://www.reddit.com/r/archlinux/comments/rkwjm/what_should_i_keep_in_mind_when_installing_on_ssd/">Discussion on Reddit about installing Arch on an SSD</a></li>
<li>See the <a href="../en/Flashcache.html" title="Flashcache">Flashcache</a> article for advanced information on using solid-state with rotational drives for top performance.</li>
<li>
<a rel="nofollow" class="external text" href="https://lifehacker.com/5837769/make-sure-your-partitions-are-correctly-aligned-for-optimal-solid-state-drive-performance">Speed Up Your SSD By Correctly Aligning Your Partitions</a> (using GParted)</li>
<li><a rel="nofollow" class="external text" href="http://permalink.gmane.org/gmane.comp.file-systems.btrfs/19446">Re: Varying Leafsize and Nodesize in Btrfs</a></li>
<li><a rel="nofollow" class="external text" href="http://thread.gmane.org/gmane.comp.file-systems.btrfs/19650/focus=19667">Re: SSD alignment and Btrfs sector size</a></li>
<li>
<a rel="nofollow" class="external text" href="http://forums.anandtech.com/showthread.php?t=2266113">Erase Block (Alignment) Misinformation?</a><sup title="最后检查状态：404">[<a href="https://en.wikipedia.org/wiki/Wikipedia:Link_rot" class="extiw" title="wikipedia:Wikipedia:Link rot">失效链接</a> 2020-08-04 ⓘ]</sup>
</li>
<li><a rel="nofollow" class="external text" href="https://superuser.com/questions/492084/is-alignment-to-erase-block-size-needed-for-modern-ssds">Is alignment to erase block size needed for modern SSD's?</a></li>
<li><a rel="nofollow" class="external text" href="http://thread.gmane.org/gmane.comp.file-systems.btrfs/15646">Btrfs support for efficient SSD operation (data blocks alignment)</a></li>
<li><a rel="nofollow" class="external text" href="https://serverfault.com/questions/356534/ssd-erase-block-size-lvm-pv-on-raw-device-alignment">SSD, Erase Block Size &amp; LVM: PV on raw device, Alignment</a></li>
</ul>
</div>
</div>
<div id="catlinks" class="catlinks" data-mw="interface">
<div id="mw-normal-catlinks" class="mw-normal-catlinks">
<a href="../Special:Categories.html" title="Special:Categories">Category</a>: <ul><li><a href="../zh-CN/Category:Storage.html" title="Category:Storage (简体中文)">Storage (简体中文)</a></li></ul>
</div>
<div id="mw-hidden-catlinks" class="mw-hidden-catlinks mw-hidden-cats-hidden">Hidden categories: <ul>
<li><a href="../zh-CN/Category:Pages_or_sections_flagged_with_Template:Translateme.html" title="Category:Pages or sections flagged with Template:Translateme (简体中文)">Pages or sections flagged with Template:Translateme (简体中文)</a></li>
<li><a href="../en/Category:Pages_with_dead_links.html" title="Category:Pages with dead links">Pages with dead links</a></li>
<li><a href="../en/Category:Pages_with_broken_section_links.html" title="Category:Pages with broken section links">Pages with broken section links</a></li>
<li><a href="../en/Category:Pages_or_sections_flagged_with_Template:Style.html" title="Category:Pages or sections flagged with Template:Style">Pages or sections flagged with Template:Style</a></li>
</ul>
</div>
</div>
	</div>
</div>

<footer id="footer" class="mw-footer" role="contentinfo" style="margin: 0">
	<ul id="footer-info">
		<li>Retrieved from "<a dir="ltr" href="https://wiki.archlinux.org/index.php?title=Solid_state_drive_(%E7%AE%80%E4%BD%93%E4%B8%AD%E6%96%87)&amp;oldid=663345">https://wiki.archlinux.org/index.php?title=Solid_state_drive_(简体中文)&amp;oldid=663345</a>"</li>
		<li id="footer-info-lastmod"> This page was last edited on 21 April 2021, at 11:45.</li>
		<li id="footer-info-copyright">Content is available under <a class="external" rel="nofollow" href="http://www.gnu.org/copyleft/fdl.html">GNU Free Documentation License 1.3 or later</a> unless otherwise noted.</li>
	<br>
</ul>
	<ul id="footer-places">
		<li id="footer-places-privacy"><a href="../en/ArchWiki:Privacy_policy.html" title="ArchWiki:Privacy policy">Privacy policy</a></li>
		<li id="footer-places-about"><a href="../en/ArchWiki:About.html" title="ArchWiki:About">About ArchWiki</a></li>
		<li id="footer-places-disclaimer"><a href="../en/ArchWiki:General_disclaimer.html" title="ArchWiki:General disclaimer">Disclaimers</a></li>
	</ul>
	<ul id="footer-icons" class="noprint">
		<li id="footer-copyrightico">
	</ul>
	<div style="clear: both;"></div>
</footer>



</body>
</html>
