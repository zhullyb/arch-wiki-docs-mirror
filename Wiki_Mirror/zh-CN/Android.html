<!DOCTYPE html>
<html class="client-nojs" lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<title>Android (简体中文) - ArchWiki</title>
<link rel="stylesheet" href="../ArchWikiOffline.css">
<meta name="ResourceLoaderDynamicStyles" content="">
<meta name="generator" content="MediaWiki 1.35.0">
<meta name="robots" content="noindex,follow">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="shortcut icon" href="/favicon.ico">
<link rel="search" type="application/opensearchdescription+xml" href="/opensearch_desc.php" title="ArchWiki (en)">
<link rel="EditURI" type="application/rsd+xml" href="https://wiki.archlinux.org/api.php?action=rsd">
<link rel="license" href="http://www.gnu.org/copyleft/fdl.html">
<link rel="alternate" type="application/atom+xml" title="ArchWiki Atom feed" href="/index.php?title=Special:RecentChanges&amp;feed=atom">
</head>
<body class="mediawiki ltr sitedir-ltr mw-hide-empty-elt ns-0 ns-subject page-Android_简体中文 rootpage-Android_简体中文 skin-vector action-view skin-vector-legacy">
<div id="content" class="mw-body" role="main" style="margin: 0">
	<a id="top"></a>
	<div id="siteNotice" class="mw-body-content"></div>
	<div class="mw-indicators mw-body-content">
	</div>
	<h1 id="firstHeading" class="firstHeading" lang="en">Android (简体中文)</h1>
	<div id="bodyContent" class="mw-body-content">
		<div id="siteSub" class="noprint">From ArchWiki</div>
		<div id="contentSub"></div>
		<div id="contentSub2"></div>
		
		<div id="jump-to-nav"></div>
		<a class="mw-jump-link" href="#mw-head">Jump to navigation</a>
		<a class="mw-jump-link" href="#searchInput">Jump to search</a>
		<div id="mw-content-text" lang="en" dir="ltr" class="mw-content-ltr">
<div class="warningbox">The printable version is no longer supported and may have rendering errors. Please update your browser bookmarks and please use the default browser print function instead.</div>
<div class="mw-parser-output">
<div class="archwiki-template-meta-related-articles-start">
<p>相关文章</p>
<ul>
<li><a href="../en/Android_tethering.html" title="Android tethering">Android tethering</a></li>
</ul>
</div>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>翻译状态：</strong>本文是 <a href="../en/Android.html" title="Android">Android</a> 的<a href="../zh-CN/ArchWiki:Translation_Team.html" title="ArchWiki:Translation Team (简体中文)">翻译</a>。上次翻译日期：2016-09-26。如果英文版本有所<a rel="nofollow" class="external text" href="https://wiki.archlinux.org/index.php?title=Android&amp;diff=0&amp;oldid=451481">更改</a>，则您可以帮助同步翻译。</div>
<div id="toc" class="toc" role="navigation" aria-labelledby="mw-toc-heading">
<input type="checkbox" role="button" id="toctogglecheckbox" class="toctogglecheckbox" style="display:none"><div class="toctitle" lang="en" dir="ltr">
<h2 id="mw-toc-heading">Contents</h2>
<span class="toctogglespan"><label class="toctogglelabel" for="toctogglecheckbox"></label></span>
</div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#%E6%B5%8F%E8%A7%88%E5%AE%89%E5%8D%93%E8%AE%BE%E5%A4%87"><span class="tocnumber">1</span> <span class="toctext">浏览安卓设备</span></a></li>
<li class="toclevel-1 tocsection-2">
<a href="#%E5%AE%89%E5%8D%93%E5%BC%80%E5%8F%91"><span class="tocnumber">2</span> <span class="toctext">安卓开发</span></a>
<ul>
<li class="toclevel-2 tocsection-3"><a href="#%E5%AE%89%E5%8D%93_SDK_%E6%A0%B8%E5%BF%83%E7%BB%84%E4%BB%B6"><span class="tocnumber">2.1</span> <span class="toctext">安卓 SDK 核心组件</span></a></li>
<li class="toclevel-2 tocsection-4"><a href="#%E8%8E%B7%E5%8F%96_Android_SDK_%E7%89%B9%E5%AE%9A%E5%B9%B3%E5%8F%B0_API"><span class="tocnumber">2.2</span> <span class="toctext">获取 Android SDK 特定平台 API</span></a></li>
<li class="toclevel-2 tocsection-5">
<a href="#%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83"><span class="tocnumber">2.3</span> <span class="toctext">开发环境</span></a>
<ul>
<li class="toclevel-3 tocsection-6"><a href="#Android_Studio"><span class="tocnumber">2.3.1</span> <span class="toctext">Android Studio</span></a></li>
<li class="toclevel-3 tocsection-7"><a href="#Eclipse"><span class="tocnumber">2.3.2</span> <span class="toctext">Eclipse</span></a></li>
<li class="toclevel-3 tocsection-8"><a href="#Netbeans"><span class="tocnumber">2.3.3</span> <span class="toctext">Netbeans</span></a></li>
</ul>
</li>
<li class="toclevel-2 tocsection-9">
<a href="#%E5%AE%89%E5%8D%93%E8%B0%83%E8%AF%95%E6%A1%A5_(ADB)"><span class="tocnumber">2.4</span> <span class="toctext">安卓调试桥 (ADB)</span></a>
<ul>
<li class="toclevel-3 tocsection-10"><a href="#%E8%BF%9E%E6%8E%A5%E8%AE%BE%E5%A4%87"><span class="tocnumber">2.4.1</span> <span class="toctext">连接设备</span></a></li>
<li class="toclevel-3 tocsection-11"><a href="#%E6%89%8B%E5%8A%A8%E6%9F%A5%E6%89%BE%E8%AE%BE%E5%A4%87_ID"><span class="tocnumber">2.4.2</span> <span class="toctext">手动查找设备 ID</span></a></li>
<li class="toclevel-3 tocsection-12"><a href="#%E6%B7%BB%E5%8A%A0_udev_%E8%A7%84%E5%88%99"><span class="tocnumber">2.4.3</span> <span class="toctext">添加 udev 规则</span></a></li>
<li class="toclevel-3 tocsection-13"><a href="#%E9%85%8D%E7%BD%AE_adb"><span class="tocnumber">2.4.4</span> <span class="toctext">配置 adb</span></a></li>
<li class="toclevel-3 tocsection-14"><a href="#%E6%A3%80%E6%B5%8B%E8%AE%BE%E5%A4%87"><span class="tocnumber">2.4.5</span> <span class="toctext">检测设备</span></a></li>
<li class="toclevel-3 tocsection-15"><a href="#%E4%BD%BF%E7%94%A8%E6%96%B9%E6%B3%95"><span class="tocnumber">2.4.6</span> <span class="toctext">使用方法</span></a></li>
<li class="toclevel-3 tocsection-16"><a href="#%E6%B3%A8%E6%84%8F%E4%BA%8B%E9%A1%B9%E5%92%8C%E7%96%91%E9%9A%BE%E6%9D%82%E7%97%87"><span class="tocnumber">2.4.7</span> <span class="toctext">注意事项和疑难杂症</span></a></li>
</ul>
</li>
<li class="toclevel-2 tocsection-17"><a href="#NVIDIA_Tegra_%E5%B9%B3%E5%8F%B0%E4%B8%93%E7%94%A8%E5%B7%A5%E5%85%B7"><span class="tocnumber">2.5</span> <span class="toctext">NVIDIA Tegra 平台专用工具</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-18">
<a href="#%E6%9E%84%E5%BB%BA_Android"><span class="tocnumber">3</span> <span class="toctext">构建 Android</span></a>
<ul>
<li class="toclevel-2 tocsection-19"><a href="#%E9%9C%80%E8%A6%81%E7%9A%84%E8%BD%AF%E4%BB%B6%E5%8C%85"><span class="tocnumber">3.1</span> <span class="toctext">需要的软件包</span></a></li>
<li class="toclevel-2 tocsection-20"><a href="#Java_Development_Kit"><span class="tocnumber">3.2</span> <span class="toctext">Java Development Kit</span></a></li>
<li class="toclevel-2 tocsection-21"><a href="#%E9%85%8D%E7%BD%AE%E6%9E%84%E5%BB%BA%E7%8E%AF%E5%A2%83"><span class="tocnumber">3.3</span> <span class="toctext">配置构建环境</span></a></li>
<li class="toclevel-2 tocsection-22"><a href="#%E4%B8%8B%E8%BD%BD%E6%BA%90%E4%BB%A3%E7%A0%81"><span class="tocnumber">3.4</span> <span class="toctext">下载源代码</span></a></li>
<li class="toclevel-2 tocsection-23"><a href="#%E5%BC%80%E5%A7%8B%E6%9E%84%E5%BB%BA"><span class="tocnumber">3.5</span> <span class="toctext">开始构建</span></a></li>
<li class="toclevel-2 tocsection-24"><a href="#%E6%B5%8B%E8%AF%95%E9%95%9C%E5%83%8F"><span class="tocnumber">3.6</span> <span class="toctext">测试镜像</span></a></li>
<li class="toclevel-2 tocsection-25"><a href="#%E5%88%9B%E5%BB%BA%E5%8F%AF%E7%83%A7%E5%BD%95%E9%95%9C%E5%83%8F"><span class="tocnumber">3.7</span> <span class="toctext">创建可烧录镜像</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-26">
<a href="#%E6%81%A2%E5%A4%8D_Android"><span class="tocnumber">4</span> <span class="toctext">恢复 Android</span></a>
<ul>
<li class="toclevel-2 tocsection-27"><a href="#Fastboot"><span class="tocnumber">4.1</span> <span class="toctext">Fastboot</span></a></li>
<li class="toclevel-2 tocsection-28">
<a href="#Samsung"><span class="tocnumber">4.2</span> <span class="toctext">Samsung</span></a>
<ul>
<li class="toclevel-3 tocsection-29"><a href="#Heimdall"><span class="tocnumber">4.2.1</span> <span class="toctext">Heimdall</span></a></li>
<li class="toclevel-3 tocsection-30"><a href="#Odin_(Virtualbox)"><span class="tocnumber">4.2.2</span> <span class="toctext">Odin (Virtualbox)</span></a></li>
</ul>
</li>
</ul>
</li>
<li class="toclevel-1 tocsection-31">
<a href="#%E5%85%B6%E5%AE%83%E8%BF%9E%E6%8E%A5%E6%96%B9%E6%B3%95"><span class="tocnumber">5</span> <span class="toctext">其它连接方法</span></a>
<ul>
<li class="toclevel-2 tocsection-32"><a href="#adb-sync"><span class="tocnumber">5.1</span> <span class="toctext">adb-sync</span></a></li>
<li class="toclevel-2 tocsection-33"><a href="#AirDroid"><span class="tocnumber">5.2</span> <span class="toctext">AirDroid</span></a></li>
<li class="toclevel-2 tocsection-34"><a href="#AndroidScreencast"><span class="tocnumber">5.3</span> <span class="toctext">AndroidScreencast</span></a></li>
<li class="toclevel-2 tocsection-35"><a href="#FTP"><span class="tocnumber">5.4</span> <span class="toctext">FTP</span></a></li>
<li class="toclevel-2 tocsection-36"><a href="#KDE_Connect"><span class="tocnumber">5.5</span> <span class="toctext">KDE Connect</span></a></li>
<li class="toclevel-2 tocsection-37"><a href="#SSH_%E6%9C%8D%E5%8A%A1%E5%99%A8"><span class="tocnumber">5.6</span> <span class="toctext">SSH 服务器</span></a></li>
<li class="toclevel-2 tocsection-38"><a href="#Samba"><span class="tocnumber">5.7</span> <span class="toctext">Samba</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-39">
<a href="#%E6%8A%80%E5%B7%A7%E5%92%8C%E6%8F%90%E7%A4%BA"><span class="tocnumber">6</span> <span class="toctext">技巧和提示</span></a>
<ul>
<li class="toclevel-2 tocsection-40"><a href="#%E8%B0%83%E8%AF%95%E6%97%B6%E5%87%BA%E7%8E%B0_%22Source_not_found%22"><span class="tocnumber">6.1</span> <span class="toctext">调试时出现 "Source not found"</span></a></li>
<li class="toclevel-2 tocsection-41"><a href="#%E5%9C%A8_sd_%E5%8D%A1%E4%B8%8A%E5%AE%89%E8%A3%85_Linux_%E5%8F%91%E8%A1%8C%E7%89%88"><span class="tocnumber">6.2</span> <span class="toctext">在 sd 卡上安装 Linux 发行版</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-42">
<a href="#%E7%96%91%E9%9A%BE%E6%9D%82%E7%97%87"><span class="tocnumber">7</span> <span class="toctext">疑难杂症</span></a>
<ul>
<li class="toclevel-2 tocsection-43"><a href="#Android_Studio:_Android_Virtual_Devices_show_'failed_to_load'."><span class="tocnumber">7.1</span> <span class="toctext">Android Studio: Android Virtual Devices show 'failed to load'.</span></a></li>
<li class="toclevel-2 tocsection-44"><a href="#aapt:_No_such_file_or_directory"><span class="tocnumber">7.2</span> <span class="toctext">aapt: No such file or directory</span></a></li>
<li class="toclevel-2 tocsection-45"><a href="#ValueError:_unsupported_pickle_protocol"><span class="tocnumber">7.3</span> <span class="toctext">ValueError: unsupported pickle protocol</span></a></li>
</ul>
</li>
</ul>
</div>

<h2>
<span id=".E6.B5.8F.E8.A7.88.E5.AE.89.E5.8D.93.E8.AE.BE.E5.A4.87"></span><span class="mw-headline" id="浏览安卓设备">浏览安卓设备</span>
</h2>
<p>有多种方法浏览安卓设备：
</p>
<ul>
<li>
<a href="../en/Media_Transfer_Protocol.html" class="mw-redirect" title="MTP">MTP</a> 协议可以用USB传输文件。</li>
<li>
<a href="#%E5%85%B6%E5%AE%83%E8%BF%9E%E6%8E%A5%E6%96%B9%E6%B3%95">其它连接方法</a> (比如 FTP, SSH)。</li>
</ul>
<p>更高阶的用法，开发、刷入固件和恢复固件等：
</p>
<ul>
<li>
<a href="#%E5%AE%89%E5%8D%93%E8%B0%83%E8%AF%95%E6%A1%A5_(ADB)">ADB 工具包</a> 广泛用于开发。</li>
<li>
<a href="#%E6%81%A2%E5%A4%8D_Android">恢复 Android</a> 用于刷入和恢复安卓固件（包括 fastboot）。</li>
</ul>
<h2>
<span id=".E5.AE.89.E5.8D.93.E5.BC.80.E5.8F.91"></span><span class="mw-headline" id="安卓开发">安卓开发</span>
</h2>
<p>在Archlinux中开发安卓程序，需如下三步：
</p>
<ol>
<li>安装 Android SDK 核心组件，</li>
<li>安装一个或数个 Android SDK 特定平台软件包，</li>
<li>安装一个兼容 Android SDK 的 IDE</li>
</ol>
<h3>
<span id=".E5.AE.89.E5.8D.93_SDK_.E6.A0.B8.E5.BF.83.E7.BB.84.E4.BB.B6"></span><span class="mw-headline" id="安卓_SDK_核心组件">安卓 SDK 核心组件</span>
</h3>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>注意：</strong> 如果运行 64 位操作系统，你需要启用<a href="../en/Official_repositories.html#multilib" class="mw-redirect" title="Multilib">multilib</a>软件源以避免安装时出现"error: target not found: lib32-zlib"报错信息。</div>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>注意：</strong> 如果你想要安装 <a href="#Android_Studio">#Android Studio</a> 且使用其来管理你的SDK安装，你不需要安装以下软件包。</div>
<p>在开发安卓程序之前，需要安装安卓 SDK。它由下列三组软件包组成，均可从 <a href="../zh-CN/Arch_User_Repository.html" title="Arch User Repository (简体中文)">AUR</a> 安装：
</p>
<ol>
<li>
<span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://aur.archlinux.org/packages/android-sdk/">android-sdk</a></span><sup><small>AUR</small></sup>
</li>
<li>
<span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://aur.archlinux.org/packages/android-sdk-platform-tools/">android-sdk-platform-tools</a></span><sup><small>AUR</small></sup>
</li>
<li>
<span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://aur.archlinux.org/packages/android-sdk-build-tools/">android-sdk-build-tools</a></span><sup><small>AUR</small></sup>
</li>
</ol>
<p>对于旧设备的支持， <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://aur.archlinux.org/packages/android-support/">android-support</a></span><sup><small>AUR</small></sup> 软件包是必需的。
软件包会安装到<code>/opt/android-sdk</code>。
这个目录需要 root 权限，所以你需要以 root 用户运行 sdk manager，否则你将无法修改这个目录中的内容。
如果打算以一般用户权限来访问，需要创建 android sdk 用户组（名称任意）：
</p>
<pre># groupadd sdkusers
</pre>
<p>然后将用户添加到这个组中：
</p>
<pre># gpasswd -a &lt;user&gt; sdkusers
</pre>
<p>修改目录所属的用户组：
</p>
<pre># chown -R :sdkusers /opt/android-sdk/
</pre>
<p>修改目录的权限，使得刚加入组中的用户也能在目录中写入：
</p>
<pre># chmod -R g+w /opt/android-sdk/
</pre>
<p>重新登录或者以 &lt;user&gt; 登录终端的用户组变为新建的组：
</p>
<pre>$ newgrp sdkusers
</pre>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>注意：</strong> 除了上述 <a href="../en/Arch_User_Repository.html" class="mw-redirect" title="AUR">AUR</a> 全局安装的方式，还可以参考<a rel="nofollow" class="external text" href="https://developer.android.com/sdk/index.html">上游说明</a>将 SDK 安装到用户 home 目录。你也可以使用<a href="../en/Arch_User_Repository.html" class="mw-redirect" title="AUR">AUR</a>中的 android-*-dummy 软件包来解决系统依赖。</div>
<h3>
<span id=".E8.8E.B7.E5.8F.96_Android_SDK_.E7.89.B9.E5.AE.9A.E5.B9.B3.E5.8F.B0_API"></span><span class="mw-headline" id="获取_Android_SDK_特定平台_API">获取 Android SDK 特定平台 API</span>
</h3>
<p>从<a href="../zh-CN/Arch_User_Repository.html" title="Arch User Repository (简体中文)">AUR</a>安装所需的 Android SDK 特定平台软件包：
</p>
<ul>
<li>
<span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://aur.archlinux.org/packages/android-platform-21/">android-platform-21</a></span><sup><small>AUR</small></sup>
</li>
<li>
<span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://aur.archlinux.org/packages/android-platform-20/">android-platform-20</a></span><sup><small>AUR</small></sup>
</li>
<li>
<span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://aur.archlinux.org/packages/android-platform-19/">android-platform-19</a></span><sup><small>AUR</small></sup>
</li>
<li>
<span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://aur.archlinux.org/packages/android-platform-18/">android-platform-18</a></span><sup><small>AUR</small></sup>
</li>
<li>
<span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://aur.archlinux.org/packages/android-platform-17/">android-platform-17</a></span><sup><small>AUR</small></sup>
</li>
<li>
<span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://aur.archlinux.org/packages/android-platform-16/">android-platform-16</a></span><sup><small>AUR</small></sup>
</li>
<li>
<span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://aur.archlinux.org/packages/android-platform-15/">android-platform-15</a></span><sup><small>AUR</small></sup>
</li>
<li>
<span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://aur.archlinux.org/packages/android-platform-14/">android-platform-14</a></span><sup><small>AUR</small></sup>
</li>
</ul>
<h3>
<span id=".E5.BC.80.E5.8F.91.E7.8E.AF.E5.A2.83"></span><span class="mw-headline" id="开发环境">开发环境</span>
</h3>
<p>如下所述，基于 IntelliJ IDEA 的 Android Studio 是新的官方开发环境，也可以使用 <a href="../en/Eclipse.html" title="Eclipse">Eclipse</a> + 官方不再支持的 ADT 插件，或者结合 NBAndroid 插件使用 <a href="../en/Netbeans.html" title="Netbeans">Netbeans</a> 进行开发。
</p>
<h4><span class="mw-headline" id="Android_Studio">Android Studio</span></h4>
<p><a rel="nofollow" class="external text" href="http://developer.android.com/sdk/installing/studio.html">Android Studio</a> 是基于 <a rel="nofollow" class="external text" href="https://www.jetbrains.com/idea/">IntelliJ Idea</a> 的 Android 开发环境。它替代了原来的 <a rel="nofollow" class="external text" href="https://developer.android.com/tools/help/adt.html">Eclipse Android Developer Tools</a> 插件，为开发和调试提供了集成环境。
</p>
<p>你可以通过 <a href="../en/Arch_User_Repository.html" class="mw-redirect" title="AUR">AUR</a> 中的 <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://aur.archlinux.org/packages/android-studio/">android-studio</a></span><sup><small>AUR</small></sup> 软件包下载并安装。若提示缺少 SDK，参考上节获取 Android SDK 特定平台 API。
</p>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>注意：</strong> 如果使用了除i3wm之外的平铺窗口管理器，可能需要按 <a rel="nofollow" class="external text" href="https://code.google.com/p/android/issues/detail?id=57675">这里</a> 描述的修复方法进行处理。</div>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>注意：</strong> 确保<a href="../en/Java.html#Change_default_Java_environment" title="Java">配置了 Java 环境</a> 已正确配置，否则无法启动 android-studio。</div>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>注意：</strong> 如 <a rel="nofollow" class="external text" href="https://youtrack.jetbrains.com/issue/IDEA-57233#comment=27-876236">这个</a> 页面所述，安装 <a href="../en/Font_configuration.html#Installation" class="mw-redirect" title="Infinality">infinality-bundle</a><sup>[<a href="../en/ArchWiki:Requests.html#Broken_section_links" class="mw-redirect" title="ArchWiki:Requests">断开的链接</a>：无效的部分]</sup> 并使用 AUR 中 infinality 打完补丁的 openJDK7 （<span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://aur.archlinux.org/packages/jdk7-openjdk-infinality/">jdk7-openjdk-infinality</a></span><sup><small>AUR</small></sup>）或者 openJDK 8 （<span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://aur.archlinux.org/packages/jdk8-openjdk-infinality/">jdk8-openjdk-infinality</a></span><sup><small>AUR</small></sup>）能修复 Android Studio 中糟糕的字体渲染问题，也可以使用 <a href="../en/Unofficial_user_repositories.html#infinality-bundle" title="Unofficial user repositories">Infinality 非官方软件库</a><sup>[<a href="../en/ArchWiki:Requests.html#Broken_section_links" class="mw-redirect" title="ArchWiki:Requests">断开的链接</a>：无效的部分]</sup> 中打完补丁的 OpenJDK8。</div>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>注意：</strong> 在 <code>~/.AndroidStudio1.2/studio64.vmoptions</code> 文件中添加 <code>-Dhidpi=true</code> 能修复 HiDPI 缩放情况下文本超出控件边界的问题。</div>
<p>一般会在 Android Studio 图形界面下编译应用，如果需要通过命令行编译应用 （使用诸如 <code>./gradlew assembleDebug</code>），需要在 <code>~/.bashrc</code> 中添加：
</p>
<pre>export ANDROID_HOME=/opt/android-sdk
</pre>
<h4><span class="mw-headline" id="Eclipse">Eclipse</span></h4>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>注意：</strong> 自 2014-12-08 起，官方已经不再建议使用 ADT 插件，官方的开发环境是 Android Studio。</div>
<p>官方的但已经废弃的 <a rel="nofollow" class="external text" href="http://developer.android.com/sdk/eclipse-adt.html">Eclipse ADT</a> 插件可以通过 <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://aur.archlinux.org/packages/eclipse-android/">eclipse-android</a></span><sup><small>AUR</small></sup><sup>[<a href="../en/Help:Procedures.html#Fix_broken_package_links" title="Help:Procedures">断开的链接</a>：package not found]</sup> 软件包安装。
</p>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>注意：</strong> 
<ul>
<li>如果你遇到了不可解析的依赖的错误信息，手动安装 <a href="../en/Java.html" title="Java">Java</a> 并重试。</li>
<li>另外，你也可以通过 eclipse 内置的 "add new software" 方法来安装 ADT（详见 ADT 网站的帮助）。</li>
<li>如果实在不行，你可以下载 Android SDK 并使用捆绑的 Eclipse，通常不再会有问题。</li>
<li>如果你需要安装不在 AUR 中的额外 SDK 组件，你必须先改变 /opt/android-sdk 中文件的所有者和权限，运行 <code># chgrp -R users /opt/android-sdk ; chmod -R 0775 /opt/android-sdk</code> （详细信息可参见 <a href="../en/File_permissions_and_attributes.html" class="mw-redirect" title="File Permissions">文件权限</a>）。</li>
</ul>
</div>
<p>在下面设置中设置 Android SDK 路径：
</p>
<pre>Windows -&gt; Preferences -&gt; Android
</pre>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>注意：</strong> 如果 AUR 软件包升级之后插件无法在 Eclipse 中显示出来，eclipse 可能使用了过期缓存。执行一次 <code>sudo eclipse -clean</code>。如果还是不行，就删除 Eclipse 及其所有插件，删除 <code>/usr/share/eclipse</code> 再重装。</div>
<h4><span class="mw-headline" id="Netbeans">Netbeans</span></h4>
<p>如果想用 Netbeans 作为 Android 开发的 IDE，需要下载 <a rel="nofollow" class="external text" href="http://www.nbandroid.org">NBAndroid</a><sup title="最后检查状态：domain name not resolved">[<a href="https://en.wikipedia.org/wiki/Wikipedia:Link_rot" class="extiw" title="wikipedia:Wikipedia:Link rot">失效链接</a> 2020-08-02 ⓘ]</sup>：
</p>
<pre>Tools -&gt; Plugins -&gt; Settings
</pre>
<p>添加如下 URL：<a rel="nofollow" class="external free" href="http://nbandroid.org/updates/updates.xml">http://nbandroid.org/updates/updates.xml</a>
</p>
<p>然后到 <b>Available Plugins</b> 安装 IDE 版本对应的 <b>Android</b> 和 <b>Junit</b> 插件，安装后到：
</p>
<pre>Tools -&gt; Options -&gt; Miscellaneous -&gt; Android
</pre>
<p>设置 SDK 安装路径（默认是 /opt/android-sdk）。这样就行了，现在你可以在 Netbeans 里面创建和开发新的 Android 项目。
</p>
<h3>
<span id=".E5.AE.89.E5.8D.93.E8.B0.83.E8.AF.95.E6.A1.A5_.28ADB.29"></span><span class="mw-headline" id="安卓调试桥_(ADB)">安卓调试桥 (ADB)</span>
</h3>
<div class="archwiki-template-box archwiki-template-box-tip">
<strong>提示：</strong> 有些设备需要先启用 MTP 才能使用 ADB，而另一些设备需要启用 PTP。</div>
<div class="archwiki-template-box archwiki-template-box-tip">
<strong>提示：</strong> 许多设备的 udev 规则被包含在 <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=libmtp">libmtp</a></span>，所以如果你已经安装此软件包，以下步骤是不必要的。</div>
<h4>
<span id=".E8.BF.9E.E6.8E.A5.E8.AE.BE.E5.A4.87"></span><span class="mw-headline" id="连接设备">连接设备</span>
</h4>
<p>要使用 安卓调试桥(ADB) 在 Arch 下连接真实设备，必须：
</p>
<ol>
<li>安装 <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=android-tools">android-tools</a></span>。除此之外，如果希望为设备在 <code>/dev/</code> 中建立正确的节点,需安装 <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=android-udev">android-udev</a></span> 软件包。</li>
<li>在手机或设备上启用 USB 调试：</li>
<li>Jelly Bean （4.2）或更新版本：访问 <code>Settings（设置） --&gt; About Phone（关于手机）</code>，不停点击 “Build Number（版本号）” （7次），直到弹出消息提示开启了开发者选项。然后访问 <code>Settings（设置） --&gt; Developer（开发者选项） --&gt; USB debugging（USB 调式）</code> 并启用它。</li>
<li>旧版本： 通常能通过 <code>Settings（设置） --&gt; Applications （应用程序）--&gt; Development（开发者选项） --&gt; USB debugging（USB调试）</code>。勾选后重启手机，确保 USB 调试已启用。</li>
<li>将用户加入组 <i>adbusers</i>。</li>
<li>gpasswd -a <i>username</i> adbusers</li>
</ol>
<p>如果 <a href="#%E6%A3%80%E6%B5%8B%E8%AE%BE%E5%A4%87">ADB 能识别你的设备</a> (在IDE中可以看见和访问）就行了，否则见下面的内容。
</p>
<h4>
<span id=".E6.89.8B.E5.8A.A8.E6.9F.A5.E6.89.BE.E8.AE.BE.E5.A4.87_ID"></span><span class="mw-headline" id="手动查找设备_ID">手动查找设备 ID</span>
</h4>
<p>每一个手机供应商都提供了 usb 厂商ID和产品ID，比如 HTC Evo 为：
</p>
<pre>vendor id: 0bb4
product id: 0c8d
</pre>
<p>连接设备并执行：
</p>
<pre>$ lsusb
</pre>
<p>应该会出现类似的结果：
</p>
<pre>Bus 002 Device 006: ID 0bb4:0c8d High Tech Computer Corp.
</pre>
<h4>
<span id=".E6.B7.BB.E5.8A.A0_udev_.E8.A7.84.E5.88.99"></span><span class="mw-headline" id="添加_udev_规则">添加 udev 规则</span>
</h4>
<p>使用 <a rel="nofollow" class="external text" href="http://source.android.com/source/initializing.html#configuring-usb-access">Android developer</a> 的规则，或者下面的模板，并用你的 [VENDOR ID] 和 [PRODUCT ID] 替换里面的值。
然后把这些规则复制到 <code>/etc/udev/rules.d/51-android.rules</code>：
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/udev/rules.d/51-android.rules</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">SUBSYSTEM=="usb", ATTR{idVendor}=="[VENDOR ID]", MODE="0666", GROUP="adbusers"
SUBSYSTEM=="usb",ATTR{idVendor}=="[VENDOR ID]",ATTR{idProduct}=="[PRODUCT ID]",SYMLINK+="android_adb"
SUBSYSTEM=="usb",ATTR{idVendor}=="[VENDOR ID]",ATTR{idProduct}=="[PRODUCT ID]",SYMLINK+="android_fastboot"</pre>
<p>再加载刚定义的规则，运行：
</p>
<pre># udevadm control --reload-rules
</pre>
<p>确保你是 <code>adbusers</code> <a href="../en/Users_and_groups.html#Group_management" class="mw-redirect" title="User group">user group</a> 的成员，以访问 <code>adb</code> 设备。
</p>
<h4>
<span id=".E9.85.8D.E7.BD.AE_adb"></span><span class="mw-headline" id="配置_adb">配置 adb</span>
</h4>
<p>除了使用 udev 规则外，也可以创建/编辑 <code>~/.android/adb_usb.ini</code>，里面包含了一个 vendor ID 的列表。
</p>
<pre>$ cat ~/.android/adb_usb.ini 
0x27e8
</pre>
<h4>
<span id=".E6.A3.80.E6.B5.8B.E8.AE.BE.E5.A4.87"></span><span class="mw-headline" id="检测设备">检测设备</span>
</h4>
<p>配置了 udev 规则之后，拔掉设备然后重新连接，再运行：
</p>
<pre>$ adb devices
</pre>
<p>可以看到类似的结果：
</p>
<pre>List of devices attached 
HT07VHL00676    device
</pre>
<h4>
<span id=".E4.BD.BF.E7.94.A8.E6.96.B9.E6.B3.95"></span><span class="mw-headline" id="使用方法">使用方法</span>
</h4>
<p>现在可以通过 adb 在设备和计算机间传输文件了。使用：
</p>
<pre>$ adb push <i>&lt;what-to-copy&gt;</i> <i>&lt;where-to-place&gt;</i>
</pre>
<p>向设备传送文件，使用：
</p>
<pre>$ adb pull <i>&lt;what-to-pull&gt;</i> <i>&lt;where-to-place&gt;</i>
</pre>
<p>从设备获取文件。
</p>
<h4>
<span id=".E6.B3.A8.E6.84.8F.E4.BA.8B.E9.A1.B9.E5.92.8C.E7.96.91.E9.9A.BE.E6.9D.82.E7.97.87"></span><span class="mw-headline" id="注意事项和疑难杂症">注意事项和疑难杂症</span>
</h4>
<ul><li>
<b>ADB</b> 也可以通过 <a href="#Android_SDK_platform_API">platform tools</a><sup>[<a href="../en/ArchWiki:Requests.html#Broken_section_links" class="mw-redirect" title="ArchWiki:Requests">断开的链接</a>：无效的部分]</sup>（通常位于 <code>/opt/android-sdk/platform-tools/</code>）， 所以可能没有必要安装 <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=android-tools">android-tools</a></span>（位于 <code>/usr/bin/</code>）</li></ul>
<p>如果列表为空（设备没有找到），可能是因为设备上没有启用 USB 调试。可以到 设置 =&gt; 应用程序 =&gt; 开发 (Settings =&gt; Applications =&gt; Development) 来启用 USB 调试。Android 4.2 (Jelly Bean) 隐藏了开发者选项菜单，到 设置 =&gt; 关于手机 (Settings =&gt; About phone)，然后点击 Build number （版本号） 7 次来启用它。
</p>
<p>若仍有问题，比如 <i>adb</i> 显示 <code>???????? no permissions</code>，尝试以 root 权限重启 adb 服务。
</p>
<pre># adb kill-server
# adb start-server
</pre>
<h3>
<span id="NVIDIA_Tegra_.E5.B9.B3.E5.8F.B0.E4.B8.93.E7.94.A8.E5.B7.A5.E5.85.B7"></span><span class="mw-headline" id="NVIDIA_Tegra_平台专用工具">NVIDIA Tegra 平台专用工具</span>
</h3>
<p>如果应用程序的目标平台是 NVIDIA Tegra 平台，可以安装 NVIDIA 提供的工具、文档和示例。<a rel="nofollow" class="external text" href="http://developer.nvidia.com/category/zone/mobile-development">NVIDIA 移动开发者</a> 提供了两个工具：
</p>
<ol>
<li>
<a rel="nofollow" class="external text" href="http://developer.nvidia.com/tegra-resources">Tegra 安卓开发包</a> 提供了与<a rel="nofollow" class="external text" href="http://developer.android.com/sdk/eclipse-adt.html">Eclipse ADT</a>相关的工具（NVIDIA 调试管理器）及文档。</li>
<li>
<a rel="nofollow" class="external text" href="http://developer.nvidia.com/tegra-resources">Tegra Toolkit</a> 提供了工具(大部分是 CPU 和 GPU 优化相关)，示例和文档。</li>
</ol>
<p>因为 NVIDIA 现在需要先注册登录才能下载，所以两者均无法再从 <a href="../en/Arch_User_Repository.html" class="mw-redirect" title="AUR">AUR</a> 获取。
</p>
<h2>
<span id=".E6.9E.84.E5.BB.BA_Android"></span><span class="mw-headline" id="构建_Android">构建 Android</span>
</h2>
<p>请注意如下说明文档是基于<a rel="nofollow" class="external text" href="http://source.android.com/source/building.html">官方 AOSP 构建说明</a>的。其他基于 Android 的系统，如 LineageOS，通常需要额外的步骤。
</p>
<h3>
<span id=".E9.9C.80.E8.A6.81.E7.9A.84.E8.BD.AF.E4.BB.B6.E5.8C.85"></span><span class="mw-headline" id="需要的软件包">需要的软件包</span>
</h3>
<p>编译任意版本的安卓系统，都需要安装下列软件包：
</p>
<ul><li>
<span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=lib32-gcc-libs">lib32-gcc-libs</a></span> <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=git">git</a></span> <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=gnupg">gnupg</a></span> <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=flex">flex</a></span> <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=bison">bison</a></span> <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=gperf">gperf</a></span> <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=sdl">sdl</a></span> <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=wxgtk2">wxgtk2</a></span> <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=squashfs-tools">squashfs-tools</a></span> <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=curl">curl</a></span> <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=ncurses">ncurses</a></span> <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=zlib">zlib</a></span> <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=schedtool">schedtool</a></span> <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=perl-switch">perl-switch</a></span> <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=zip">zip</a></span> <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=unzip">unzip</a></span> <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=libxslt">libxslt</a></span> <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=python2-virtualenv">python2-virtualenv</a></span> <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=bc">bc</a></span> <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=rsync">rsync</a></span> <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://aur.archlinux.org/packages/ncurses5-compat-libs/">ncurses5-compat-libs</a></span><sup><small>AUR</small></sup> <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=lib32-zlib">lib32-zlib</a></span> <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=lib32-ncurses">lib32-ncurses</a></span> <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=lib32-readline">lib32-readline</a></span> <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://aur.archlinux.org/packages/lib32-ncurses5-compat-libs/">lib32-ncurses5-compat-libs</a></span><sup><small>AUR</small></sup>
</li></ul>
<p>在 <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://aur.archlinux.org/packages/aosp-devel/">aosp-devel</a></span><sup><small>AUR</small></sup> 综合包提供了他们全部简易安装。
</p>
<p>此外，LineageOS需要以下软件包：<span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://aur.archlinux.org/packages/xml2/">xml2</a></span><sup><small>AUR</small></sup>, <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=lzop">lzop</a></span>, <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=pngcrush">pngcrush</a></span>, <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=imagemagick">imagemagick</a></span>
</p>
<p>它们可以与 <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://aur.archlinux.org/packages/lineageos-devel/">lineageos-devel</a></span><sup><small>AUR</small></sup> 元软件包一起安装。
</p>
<div class="noprint archwiki-template-message">
<p><a href="../File:Tango-inaccurate.png" class="image"><img alt="Tango-inaccurate.png" src="../File:Tango-inaccurate.png" decoding="async" width="48" height="48"></a><b>The factual accuracy of this article or section is disputed.</b><a href="../File:Tango-inaccurate.png" class="image"><img alt="Tango-inaccurate.png" src="../File:Tango-inaccurate.png" decoding="async" width="48" height="48"></a></p>
<div>
<b>Reason:</b> The note below is not clear and probably incomplete. (Discuss in <a rel="nofollow" class="external text" href="https://wiki.archlinux.org/index.php/Talk:Android_(%E7%AE%80%E4%BD%93%E4%B8%AD%E6%96%87)">Talk:Android (简体中文)#</a>)</div>
</div>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>注意：</strong> 安装 <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=maven">maven</a></span> 和 <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=gradle">gradle</a></span> 去编译LineageOS可能会提高构建速度，因为构建过程优先使用系统的</div>
<h3><span class="mw-headline" id="Java_Development_Kit">Java Development Kit</span></h3>
<p><a rel="nofollow" class="external text" href="https://source.android.com/source/requirements">所需的JDK版本</a>取决于您正在构建的android版本：
</p>
<ul>
<li>对于Android 7和8（Nougat和 Oreo），OpenJDK 8是必需的，它与<span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=jdk8-openjdk">jdk8-openjdk</a></span>软件包一起提供。</li>
<li>对于Android 5和6（Lollipop 和 Marshmallow），OpenJDK 7是必需的，它与<span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=jdk7-openjdk">jdk7-openjdk</a></span>软件包一起提供。</li>
</ul>
<p>旧版本需要 <b>Oracle JDK</b> 才能编译，<b>不支持</b> OpenJDK。
</p>
<ul>
<li>Gingerbread 到 KitKat (2.3 - 4.4) 需要 Java 6，可以通过 <a href="../en/Arch_User_Repository.html" class="mw-redirect" title="AUR">AUR</a> 软件包 <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://aur.archlinux.org/packages/jdk6/">jdk6</a></span><sup><small>AUR</small></sup> 安装。</li>
<li>Cupcake 到 Froyo (1.5 - 2.2) 需要 Java 5，可以通过 <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=jdk7-openjdk">jdk7-openjdk</a></span> 软件包安装。</li>
</ul>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>注意：</strong> Android希望Java在 <code>/usr/lib/jvm/java-<i>version</i>-openjdk-amd64</code>.
<p>设置 JAVA_HOME 以避免此要求并匹配 Arch Linux 安装路径。
例:
</p>
<pre>$ export JAVA_HOME=/usr/lib/jvm/java-<i>version</i>-openjdk
</pre>
此更改仅对当前终端会话有效。</div>
<h3>
<span id=".E9.85.8D.E7.BD.AE.E6.9E.84.E5.BB.BA.E7.8E.AF.E5.A2.83"></span><span class="mw-headline" id="配置构建环境">配置构建环境</span>
</h3>
<p>安装 <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=repo">repo</a></span> 软件包。
</p>
<p>创建一个用于构建的目录：
</p>
<pre>$ mkdir ~/android
$ cd ~/android
</pre>
<p>需要把默认的 python 从 3.X 版切换到 2.X 版：
</p>
<pre>$ virtualenv2 venv
$ source venv/bin/activate
</pre>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>注意：</strong> 
<ul>
<li>此激活仅对当前终端会话有效。虚拟环境将保存在 <code>venv</code> 文件夹中。</li>
<li>在构建期间，您可能会收到与缺少的python模块有关的错误。 一个快速而肮脏的修复方法是 symlink /usr/lib/python2.7/* 到 ~/android/venv/lib/python2.7/ (如果与上面不同，请更改 ~/android 以反映您的构建目录).</li>
</ul>
<p>例:
</p>
<pre>$ ln -s /usr/lib/python2.7/* ~/android/venv/lib/python2.7/
</pre>
<p>或 (假设构建 Data/Android_Build):
</p>
<pre>$ ln -s /usr/lib/python2.7/* /Data/Android_Build/venv/lib/python2.7/
</pre>
</div>
<h3>
<span id=".E4.B8.8B.E8.BD.BD.E6.BA.90.E4.BB.A3.E7.A0.81"></span><span class="mw-headline" id="下载源代码">下载源代码</span>
</h3>
<p>克隆整个代码库。你 <b>仅</b> 需在初次构建安卓或者切换分支时执行这一步。
</p>
<ul><li>
<code>repo</code> 有一个 <code>-j</code> 选项，用法与 <code>make</code> 的相似。它决定了下载的线程数，你可以根据下载带宽进行调整。</li></ul>
<ul><li>你需要通过 <code>-b</code> 选项指定要检出的<b>分支</b>（安卓版本）。若不指定，会检出所谓的<b>master 分支</b>。</li></ul>
<pre>$ repo init -u <a rel="nofollow" class="external free" href="https://android.googlesource.com/platform/manifest">https://android.googlesource.com/platform/manifest</a> -b master
$ repo sync -j4
</pre>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>注意：</strong> 为尽一步减少下载时间，可以像下面使用repo 命令的 -c 开关：
<pre>$ repo sync -j8 -c
</pre>
<code>-c</code> 开关仅同步在 manifest 中指定的分支，它的内容由 <code>-b</code> 开关中指定的分支或者使用版本库维护者设置的默认分支来决定，。</div>
<p>静候多时。未编译的源代码加上这些代码的 <code>.repo</code>、<code>.git</code> 目录，大小会超过 10 GB。
</p>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>注意：</strong> 若之后要更新本地的安卓代码，只要进入编译目录，载入 Virtualenv，然后重新同步：
<pre>$ repo sync
</pre>
</div>
<h3>
<span id=".E5.BC.80.E5.A7.8B.E6.9E.84.E5.BB.BA"></span><span class="mw-headline" id="开始构建">开始构建</span>
</h3>
<p>AOSP 中需执行下列命令：
</p>
<pre>$ source build/envsetup.sh
$ lunch full-eng
$ make -j4
</pre>
<p>如果不添加任何参数运行 <b>lunch</b>，则会被询问想要创建什么样的 build。使用 -j 参e数加一个数字进行并行构建，数值介于CPU核数或线程数的 1 至 2 倍。
</p>
<p>编译很耗时。
</p>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>注意：</strong> 确保你有足够的内存，推荐 4GB 以上的内存。Android 会大量使用 /tmp 目录。默认情况下，/tmp 目录所挂载的分区大小是内存的一半，分区满时编译会失败。
<ul><li>另外，你也可以不使用 <a href="../en/Fstab.html" title="Fstab">fstab</a> 里的 tmpfs 。</li></ul>
</div>
<p><br>
</p>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>注意：</strong> 根据 <a rel="nofollow" class="external text" href="https://source.android.com/source/building-running.html#build-the-code">Android Building and Running guide</a><sup title="最后检查状态：404">[<a href="https://en.wikipedia.org/wiki/Wikipedia:Link_rot" class="extiw" title="wikipedia:Wikipedia:Link rot">失效链接</a> 2020-08-02 ⓘ]</sup>：
<p>"GNU make 使用 -jN 参数处理并行任务，编译时通常会使用界于 1 到 2 倍计算机硬件的线程数。例如，在 dual-E5520 机器上 （2 个 CPU, 每个 CPU 4核，每个核双线程），使用界于 make -j16 到 make -j32 的命令进行编译会最快。"
</p>
</div>
<h3>
<span id=".E6.B5.8B.E8.AF.95.E9.95.9C.E5.83.8F"></span><span class="mw-headline" id="测试镜像">测试镜像</span>
</h3>
<p>完成之后，运行并测试最终的映像。
</p>
<pre>$ emulator
</pre>
<h3>
<span id=".E5.88.9B.E5.BB.BA.E5.8F.AF.E7.83.A7.E5.BD.95.E9.95.9C.E5.83.8F"></span><span class="mw-headline" id="创建可烧录镜像">创建可烧录镜像</span>
</h3>
<p>通过下列命令创建可烧录的镜像：
</p>
<pre>make -j8 updatepackage
</pre>
<p>它会在 <b>out/target/product/hammerhead</b> （其中的 hammerhead 是设备名）生成一个可烧录的文件.
</p>
<h2>
<span id=".E6.81.A2.E5.A4.8D_Android"></span><span class="mw-headline" id="恢复_Android">恢复 Android</span>
</h2>
<div class="noprint archwiki-template-message">
<p><a href="../File:Tango-view-fullscreen.png" class="image"><img alt="Tango-view-fullscreen.png" src="../File:Tango-view-fullscreen.png" decoding="async" width="48" height="48"></a><b>This article or section needs expansion.</b><a href="../File:Tango-view-fullscreen.png" class="image"><img alt="Tango-view-fullscreen.png" src="../File:Tango-view-fullscreen.png" decoding="async" width="48" height="48"></a></p>
<div>
<b>Reason:</b> <span style="color:red;">please use the first argument of the template to provide a brief explanation.</span> (Discuss in <a rel="nofollow" class="external text" href="https://wiki.archlinux.org/index.php/Talk:Android_(%E7%AE%80%E4%BD%93%E4%B8%AD%E6%96%87)">Talk:Android (简体中文)#</a>)</div>
</div>
<p>某些情况下，Android 设备刷了某些定制 ROM 后想刷回官方的 Android 固件，可以访问 <a rel="nofollow" class="external text" href="http://forum.xda-developers.com/">XDA 论坛</a> 获取刷机的帮助。
</p>
<h3><span class="mw-headline" id="Fastboot">Fastboot</span></h3>
<p><a href="../en/Official_repositories.html" title="Official repositories">official repositories</a> 中的 <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=android-tools">android-tools</a></span> 软件包提供了 Fastboot（以及<a href="#Connecting_to_a_real_device_-_Android_Debug_Bridge_.28ADB.29">ADB</a><sup>[<a href="../en/ArchWiki:Requests.html#Broken_section_links" class="mw-redirect" title="ArchWiki:Requests">断开的链接</a>：无效的部分]</sup>）。
</p>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>注意：</strong> 通过 <code>fastboot</code> 重置固件是十分需要技巧的。你可以浏览 <a rel="nofollow" class="external text" href="http://www.xda-developers.com/">XDA developers forums</a> 以获取官方固件,通常是一个 <code>*.zip</code> 文件，但其中包含着固件文件和 <code>flash-all.sh</code> 脚本。例如，<a rel="nofollow" class="external text" href="https://developers.google.com/android/nexus/images">Google Nexus</a> 附件包括 <code>flash-all.sh</code> 脚本.另一个例子， OnePlus One - <a rel="nofollow" class="external text" href="http://forum.xda-developers.com/oneplus-one/general/guide-return-opo-to-100-stock-t2826541">XDA thread</a>，其中你可以找到包含着 <code>flash-all.sh</code> 脚本的固件。</div>
<h3><span class="mw-headline" id="Samsung">Samsung</span></h3>
<p>Samsung 设备不支持通过 <b>Fastboot'<i> 工具烧录。可选择的工具只有 </i>Heimdall</b> 和 <b>Odin</b> （通过使用 Windows 和 VirtualBox）。
</p>
<h4><span class="mw-headline" id="Heimdall">Heimdall</span></h4>
<p><a rel="nofollow" class="external text" href="http://glassechidna.com.au/heimdall/">Heimdall</a> 是一个跨平台用于在三星移动设备上烧录固件（也称作ROMS）的开源工具，它也是以<a rel="nofollow" class="external text" href="http://odindownload.com/">Odina</a> 的备选方案为人而知。 它可以通过 <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=heimdall">heimdall</a></span> 或 <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://aur.archlinux.org/packages/heimdall-git/">heimdall-git</a></span><sup><small>AUR</small></sup> 软件包被安装。
</p>
<p>烧路说明位于 Heimdall 的 <a rel="nofollow" class="external text" href="https://github.com/Benjamin-Dobell/Heimdall/tree/master/Linux">GitHub page</a><sup title="最后检查状态：404">[<a href="https://en.wikipedia.org/wiki/Wikipedia:Link_rot" class="extiw" title="wikipedia:Wikipedia:Link rot">失效链接</a> 2020-08-02 ⓘ]</sup> 或 <a rel="nofollow" class="external text" href="http://forum.xda-developers.com/showthread.php?t=1922461">XDA forums</a>。
</p>
<h4>
<span id="Odin_.28Virtualbox.29"></span><span class="mw-headline" id="Odin_(Virtualbox)">Odin (Virtualbox)</span>
</h4>
<p><a rel="nofollow" class="external text" href="http://glassechidna.com.au/heimdall/">Heimdall</a> 是一个跨平台用于在三星移动设备上烧录固件（也称作ROMS）的开源工具，它也是以<a rel="nofollow" class="external text" href="http://odindownload.com/">Odina</a> 的备选方案为人而知。 它可以通过 <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=heimdall">heimdall</a></span> 或 <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://aur.archlinux.org/packages/heimdall-git/">heimdall-git</a></span><sup><small>AUR</small></sup> 软件包被安装。
</p>
<p>烧路说明位于 Heimdall 的 <a rel="nofollow" class="external text" href="https://github.com/Benjamin-Dobell/Heimdall/tree/master/Linux">GitHub page</a><sup title="最后检查状态：404">[<a href="https://en.wikipedia.org/wiki/Wikipedia:Link_rot" class="extiw" title="wikipedia:Wikipedia:Link rot">失效链接</a> 2020-08-02 ⓘ]</sup> 或 <a rel="nofollow" class="external text" href="http://forum.xda-developers.com/showthread.php?t=1922461">XDA forums</a>。
</p>
<p>Arch Linux 相关步骤：
</p>
<ol>
<li>一同安装 <a href="../en/VirtualBox.html" title="VirtualBox">VirtualBox</a> 和它的 <a href="../en/VirtualBox.html#Extension_pack" title="VirtualBox">extension pack</a> 和 <a href="../en/VirtualBox.html#Guest_additions_disc" title="VirtualBox">guest additions</a>.</li>
<li>使用 VirtualBox 在虚拟硬盘中安装你偏好的且与 Odin 适配的 Windows 操作系统（安装了 VirtualBox guest additions的）。</li>
<li>打开 VirtualBox 中 Windows 操作系统的设置，跳转至<b>USB</b>，然后勾选（或者确保它是被勾选的）<b>Enable USB 2.0 (EHCI) Controller</b>。</li>
<li>在 VirtualBox 中运行 Windows 操作系统，点击菜单栏中的<b>Device</b> ---&gt; <b>USB Devices</b>，然后点击你已通过USB连接到电脑的 Samsung 移动设备。</li>
</ol>
<p>Windows 相关链接：
</p>
<ul>
<li>Samsung 驱动可以从 <a rel="nofollow" class="external text" href="http://androidxda.com/download-samsung-usb-drivers">here</a> 下载。</li>
<li>Odin can 可以从 <a rel="nofollow" class="external text" href="https://www.androidfilehost.com/?fid=23501681358557126">here</a> 下载。</li>
<li>Samsung 安卓固件可以从 <a rel="nofollow" class="external text" href="http://www.sammobile.com/firmwares/">here</a> 下载。</li>
</ul>
<p>如果你想确保一切都正常工作且准备就绪：
</p>
<ol>
<li>切换你的设备至下载模式,连接到你的 Linux 机器。</li>
<li>在虚拟机工具栏中， 选择 <code>devices</code> --&gt; <code>USB</code> --&gt; <code>...Samsung...</code> 设备。</li>
<li>打开 Odin.名为<b>Message</b>的对话框，将打印类似于。</li>
</ol>
<pre>&lt;ID:0/003&gt; Added!!
</pre>
<p>的信息
这意味着你的设备对于 Odin 是可见的，且是准备就绪烧录的。
</p>
<p>{{注意|不存在关于重置 Samsung 移动设备固件的通用说明。你必须通过 <a rel="nofollow" class="external text" href="https://www.google.com">Google</a> 和 <a rel="nofollow" class="external text" href="http://www.xda-developers.com">XDA developers forums</a> 来找到特定设备的烧录说明。例如， 这个<a rel="nofollow" class="external text" href="http://goo.gl/cZLyF8">帖子</a> 是关于Samsung Galaxy S4 设备的。
</p>
<h2>
<span id=".E5.85.B6.E5.AE.83.E8.BF.9E.E6.8E.A5.E6.96.B9.E6.B3.95"></span><span class="mw-headline" id="其它连接方法">其它连接方法</span>
</h2>
<h3><span class="mw-headline" id="adb-sync">adb-sync</span></h3>
<p><a rel="nofollow" class="external text" href="https://github.com/google/adb-sync">adb-sync</a> （可通过 <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://aur.archlinux.org/packages/adb-sync-git/">adb-sync-git</a></span><sup><small>AUR</small></sup> 安装）是一个使用 ADB 协议，用于在 PC 和安卓设备间同步文件的工具。
</p>
<h3><span class="mw-headline" id="AirDroid">AirDroid</span></h3>
<p><a rel="nofollow" class="external text" href="http://goo.gl/EZQ9GQ">AirDroid</a> 可以通过网页浏览器访问设备。
</p>
<h3><span class="mw-headline" id="AndroidScreencast">AndroidScreencast</span></h3>
<p><a rel="nofollow" class="external text" href="https://xsavikx.github.io/AndroidScreencast">AndroidScreencast</a> 是被开发用于从 PC 显示和控制你的安卓设备（使用ADB）。
</p>
<h3><span class="mw-headline" id="FTP">FTP</span></h3>
<p>在 Arch 上建立 FTP 服务器并通过手机访问，或者在手机上运行 FTP 服务并在 Arch 上连接。
参阅 <a href="../en/List_of_applications/Internet.html#FTP" title="List of applications/Internet">List of applications/Internet#FTP</a>。Android 上有许多 FTP 客户端/服务端应用。
</p>
<h3><span class="mw-headline" id="KDE_Connect">KDE Connect</span></h3>
<p><span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=kdeconnect">kdeconnect</a></span> 集成了你的安卓设备和 KDE 桌面，它的功能包括同步通知，同步剪贴板，多媒体控制，和文件/URL共享。
</p>
<h3>
<span id="SSH_.E6.9C.8D.E5.8A.A1.E5.99.A8"></span><span class="mw-headline" id="SSH_服务器">SSH 服务器</span>
</h3>
<p>Android 上有很多 SSH 服务器（应用），可以通过 <code>scp</code> 命令传输文件，参见 <a href="../en/Secure_Shell.html" class="mw-redirect" title="SSH">SSH</a>.
</p>
<h3><span class="mw-headline" id="Samba">Samba</span></h3>
<p>See <a href="../en/Samba.html" title="Samba">Samba</a>.
</p>
<h2>
<span id=".E6.8A.80.E5.B7.A7.E5.92.8C.E6.8F.90.E7.A4.BA"></span><span class="mw-headline" id="技巧和提示">技巧和提示</span>
</h2>
<h3>
<span id=".E8.B0.83.E8.AF.95.E6.97.B6.E5.87.BA.E7.8E.B0_.22Source_not_found.22"></span><span class="mw-headline" id='调试时出现_"Source_not_found"'>调试时出现 "Source not found"</span>
</h3>
<p>一般这时调试器正在单步进入（Step into） Java 代码。而 Android SDK 并不提供 Java 源代码，所以导致了错误。最好的解决方法是设置单步过滤器，不要跳转到（jump into） Java 源代码。单步过滤器默认没有启动，通过如下方式设置：
</p>
<pre>Window -&gt; Preferences -&gt; Java -&gt; Debug -&gt; Step Filtering
</pre>
<p>可以全选，此外还可以酌情添加 android.* 软件包。以下的论坛贴有更详细信息：
</p>
<p><a rel="nofollow" class="external free" href="http://www.eclipsezone.com/eclipse/forums/t83338.rhtml">http://www.eclipsezone.com/eclipse/forums/t83338.rhtml</a>
</p>
<h3>
<span id=".E5.9C.A8_sd_.E5.8D.A1.E4.B8.8A.E5.AE.89.E8.A3.85_Linux_.E5.8F.91.E8.A1.8C.E7.89.88"></span><span class="mw-headline" id="在_sd_卡上安装_Linux_发行版">在 sd 卡上安装 Linux 发行版</span>
</h3>
<p>可以参照这篇 <a rel="nofollow" class="external text" href="http://forum.xda-developers.com/showthread.php?t=631389">贴子</a> 安装 Debian，<a rel="nofollow" class="external text" href="http://archlinuxarm.org/forum/viewtopic.php?f=27&amp;t=1361&amp;start=40">archlinuxarm.org上</a>有在 chroot 环境下安装（与 Android 并存）的详细介绍。
</p>
<h2>
<span id=".E7.96.91.E9.9A.BE.E6.9D.82.E7.97.87"></span><span class="mw-headline" id="疑难杂症">疑难杂症</span>
</h2>
<h3>
<span id="Android_Studio:_Android_Virtual_Devices_show_.27failed_to_load.27."></span><span class="mw-headline" id="Android_Studio:_Android_Virtual_Devices_show_'failed_to_load'.">Android Studio: Android Virtual Devices show 'failed to load'.</span>
</h3>
<p>确保你已经设置了 <a href="#Android_Studio">#Android Studio</a> 中说明的 <code>ANDROID_HOME</code> 环境变量。
</p>
<h3><span class="mw-headline" id="aapt:_No_such_file_or_directory">aapt: No such file or directory</span></h3>
<p>安装工具包含 32 位程序，需要 32 位的库。如果是手动安装 SDK，还需要安装 multilib/<span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://aur.archlinux.org/packages/lib32-libstdc%2B%2B5/">lib32-libstdc++5</a></span><sup><small>AUR</small></sup> 和 multilib/<span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=lib32-zlib">lib32-zlib</a></span>。
</p>
<h3><span class="mw-headline" id="ValueError:_unsupported_pickle_protocol">ValueError: unsupported pickle protocol</span></h3>
<p>一种修复方法：
</p>
<pre>rm ~/.repopickle_.gitconfig
</pre>
<p>如果不起效，试试这样：
</p>
<pre>rm `find /path/to/android-root -name .repopickle_config`
</pre>
</div>
</div>
<div id="catlinks" class="catlinks" data-mw="interface">
<div id="mw-normal-catlinks" class="mw-normal-catlinks">
<a href="../Special:Categories.html" title="Special:Categories">Categories</a>: <ul>
<li><a href="../zh-CN/Category:Android.html" title="Category:Android (简体中文)">Android (简体中文)</a></li>
<li><a href="../zh-CN/Category:Development.html" title="Category:Development (简体中文)">Development (简体中文)</a></li>
</ul>
</div>
<div id="mw-hidden-catlinks" class="mw-hidden-catlinks mw-hidden-cats-hidden">Hidden categories: <ul>
<li><a href="../en/Category:Pages_with_broken_section_links.html" title="Category:Pages with broken section links">Pages with broken section links</a></li>
<li><a href="../en/Category:Pages_with_broken_package_links.html" title="Category:Pages with broken package links">Pages with broken package links</a></li>
<li><a href="../en/Category:Pages_with_dead_links.html" title="Category:Pages with dead links">Pages with dead links</a></li>
<li><a href="../en/Category:Pages_or_sections_flagged_with_Template:Accuracy.html" title="Category:Pages or sections flagged with Template:Accuracy">Pages or sections flagged with Template:Accuracy</a></li>
<li><a href="../en/Category:Pages_or_sections_flagged_with_Template:Expansion.html" title="Category:Pages or sections flagged with Template:Expansion">Pages or sections flagged with Template:Expansion</a></li>
</ul>
</div>
</div>
	</div>
</div>

<footer id="footer" class="mw-footer" role="contentinfo" style="margin: 0">
	<ul id="footer-info">
		<li>Retrieved from "<a dir="ltr" href="https://wiki.archlinux.org/index.php?title=Android_(%E7%AE%80%E4%BD%93%E4%B8%AD%E6%96%87)&amp;oldid=641649">https://wiki.archlinux.org/index.php?title=Android_(简体中文)&amp;oldid=641649</a>"</li>
		<li id="footer-info-lastmod"> This page was last edited on 16 November 2020, at 09:29.</li>
		<li id="footer-info-copyright">Content is available under <a class="external" rel="nofollow" href="http://www.gnu.org/copyleft/fdl.html">GNU Free Documentation License 1.3 or later</a> unless otherwise noted.</li>
	<br>
</ul>
	<ul id="footer-places">
		<li id="footer-places-privacy"><a href="../en/ArchWiki:Privacy_policy.html" title="ArchWiki:Privacy policy">Privacy policy</a></li>
		<li id="footer-places-about"><a href="../en/ArchWiki:About.html" title="ArchWiki:About">About ArchWiki</a></li>
		<li id="footer-places-disclaimer"><a href="../en/ArchWiki:General_disclaimer.html" title="ArchWiki:General disclaimer">Disclaimers</a></li>
	</ul>
	<ul id="footer-icons" class="noprint">
		<li id="footer-copyrightico">
	</ul>
	<div style="clear: both;"></div>
</footer>



</body>
</html>
