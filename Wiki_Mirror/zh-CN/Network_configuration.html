<!DOCTYPE html>
<html class="client-nojs" lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<title>Network configuration (简体中文) - ArchWiki</title>
<link rel="stylesheet" href="../ArchWikiOffline.css">
<meta name="ResourceLoaderDynamicStyles" content="">
<meta name="generator" content="MediaWiki 1.35.0">
<meta name="robots" content="noindex,follow">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="shortcut icon" href="/favicon.ico">
<link rel="search" type="application/opensearchdescription+xml" href="/opensearch_desc.php" title="ArchWiki (en)">
<link rel="EditURI" type="application/rsd+xml" href="https://wiki.archlinux.org/api.php?action=rsd">
<link rel="license" href="http://www.gnu.org/copyleft/fdl.html">
<link rel="alternate" type="application/atom+xml" title="ArchWiki Atom feed" href="/index.php?title=Special:RecentChanges&amp;feed=atom">
</head>
<body class="mediawiki ltr sitedir-ltr mw-hide-empty-elt ns-0 ns-subject page-Network_configuration_简体中文 rootpage-Network_configuration_简体中文 skin-vector action-view skin-vector-legacy">
<div id="content" class="mw-body" role="main" style="margin: 0">
	<a id="top"></a>
	<div id="siteNotice" class="mw-body-content"></div>
	<div class="mw-indicators mw-body-content">
	</div>
	<h1 id="firstHeading" class="firstHeading" lang="en">Network configuration (简体中文)</h1>
	<div id="bodyContent" class="mw-body-content">
		<div id="siteSub" class="noprint">From ArchWiki</div>
		<div id="contentSub"></div>
		<div id="contentSub2"></div>
		
		<div id="jump-to-nav"></div>
		<a class="mw-jump-link" href="#mw-head">Jump to navigation</a>
		<a class="mw-jump-link" href="#searchInput">Jump to search</a>
		<div id="mw-content-text" lang="en" dir="ltr" class="mw-content-ltr">
<div class="warningbox">The printable version is no longer supported and may have rendering errors. Please update your browser bookmarks and please use the default browser print function instead.</div>
<div class="mw-parser-output">
<div class="archwiki-template-meta-related-articles-start">
<p>相关文章</p>
<ul>
<li><a href="../en/Jumbo_frames.html" title="Jumbo frames">Jumbo frames</a></li>
<li><a href="../zh-CN/Category:Firewalls.html" class="mw-redirect" title="Firewalls (简体中文)">Firewalls (简体中文)</a></li>
<li><a href="../zh-CN/Router.html" title="Router (简体中文)">Router (简体中文)</a></li>
<li><a href="../zh-CN/Internet_sharing.html" title="Internet sharing (简体中文)">Internet sharing (简体中文)</a></li>
<li><a href="../en/Network_Debugging.html" title="Network Debugging">Network Debugging</a></li>
</ul>
</div>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>翻译状态：</strong>本文是 <a href="../en/Network_configuration.html" title="Network configuration">Network_configuration</a> 的<a href="../zh-CN/ArchWiki:Translation_Team.html" title="ArchWiki:Translation Team (简体中文)">翻译</a>。上次翻译日期：2016-08-28。如果英文版本有所<a rel="nofollow" class="external text" href="https://wiki.archlinux.org/index.php?title=Network_configuration&amp;diff=0&amp;oldid=445647">更改</a>，则您可以帮助同步翻译。</div>
<p>本页解释了如何在 <a href="https://en.wikipedia.org/wiki/OSI_layer_3" class="extiw" title="wikipedia:OSI layer 3">OSI 第三层</a> 及之上配置网络连接。有部分内容在 <a href="../en/Network_configuration/Ethernet.html" title="Network configuration/Ethernet">Ethernet</a> 和 <a href="../zh-CN/aa29dd559001de6a26e3fe87e084eb6e.html" class="mw-redirect" title="Wireless network configuration (简体中文)">Wireless network configuration (简体中文)</a> 两个页面中。
</p>
<div id="toc" class="toc" role="navigation" aria-labelledby="mw-toc-heading">
<input type="checkbox" role="button" id="toctogglecheckbox" class="toctogglecheckbox" style="display:none"><div class="toctitle" lang="en" dir="ltr">
<h2 id="mw-toc-heading">Contents</h2>
<span class="toctogglespan"><label class="toctogglelabel" for="toctogglecheckbox"></label></span>
</div>
<ul>
<li class="toclevel-1 tocsection-1">
<a href="#%E6%A3%80%E6%9F%A5%E8%BF%9E%E6%8E%A5"><span class="tocnumber">1</span> <span class="toctext">检查连接</span></a>
<ul>
<li class="toclevel-2 tocsection-2"><a href="#Ping"><span class="tocnumber">1.1</span> <span class="toctext">Ping</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-3">
<a href="#%E7%BD%91%E7%BB%9C%E7%AE%A1%E7%90%86"><span class="tocnumber">2</span> <span class="toctext">网络管理</span></a>
<ul>
<li class="toclevel-2 tocsection-4"><a href="#%E7%BD%91%E7%BB%9C%E5%B7%A5%E5%85%B7"><span class="tocnumber">2.1</span> <span class="toctext">网络工具</span></a></li>
<li class="toclevel-2 tocsection-5"><a href="#iproute2"><span class="tocnumber">2.2</span> <span class="toctext">iproute2</span></a></li>
<li class="toclevel-2 tocsection-6">
<a href="#%E7%BD%91%E7%BB%9C%E6%8E%A5%E5%8F%A3"><span class="tocnumber">2.3</span> <span class="toctext">网络接口</span></a>
<ul>
<li class="toclevel-3 tocsection-7"><a href="#%E5%88%97%E5%87%BA%E7%BD%91%E7%BB%9C%E6%8E%A5%E5%8F%A3"><span class="tocnumber">2.3.1</span> <span class="toctext">列出网络接口</span></a></li>
<li class="toclevel-3 tocsection-8"><a href="#%E5%90%AF%E7%94%A8%E5%92%8C%E7%A6%81%E7%94%A8%E7%BD%91%E7%BB%9C%E6%8E%A5%E5%8F%A3"><span class="tocnumber">2.3.2</span> <span class="toctext">启用和禁用网络接口</span></a></li>
</ul>
</li>
<li class="toclevel-2 tocsection-9"><a href="#%E9%9D%99%E6%80%81_IP_%E5%9C%B0%E5%9D%80"><span class="tocnumber">2.4</span> <span class="toctext">静态 IP 地址</span></a></li>
<li class="toclevel-2 tocsection-10"><a href="#IP_%E5%9C%B0%E5%9D%80"><span class="tocnumber">2.5</span> <span class="toctext">IP 地址</span></a></li>
<li class="toclevel-2 tocsection-11"><a href="#%E8%B7%AF%E7%94%B1%E8%A1%A8"><span class="tocnumber">2.6</span> <span class="toctext">路由表</span></a></li>
<li class="toclevel-2 tocsection-12">
<a href="#DHCP"><span class="tocnumber">2.7</span> <span class="toctext">DHCP</span></a>
<ul>
<li class="toclevel-3 tocsection-13"><a href="#%E6%9C%8D%E5%8A%A1%E5%99%A8"><span class="tocnumber">2.7.1</span> <span class="toctext">服务器</span></a></li>
</ul>
</li>
<li class="toclevel-2 tocsection-14"><a href="#%E7%BD%91%E7%BB%9C%E7%AE%A1%E7%90%86%E5%99%A8"><span class="tocnumber">2.8</span> <span class="toctext">网络管理器</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-15"><a href="#%E8%AE%BE%E7%BD%AE%E8%AE%A1%E7%AE%97%E6%9C%BA%E5%90%8D"><span class="tocnumber">3</span> <span class="toctext">设置计算机名</span></a></li>
<li class="toclevel-1 tocsection-16">
<a href="#%E8%AE%BE%E5%A4%87%E9%A9%B1%E5%8A%A8%E7%A8%8B%E5%BA%8F"><span class="tocnumber">4</span> <span class="toctext">设备驱动程序</span></a>
<ul>
<li class="toclevel-2 tocsection-17"><a href="#%E6%A3%80%E6%B5%8B%E9%A9%B1%E5%8A%A8%E7%8A%B6%E6%80%81"><span class="tocnumber">4.1</span> <span class="toctext">检测驱动状态</span></a></li>
<li class="toclevel-2 tocsection-18"><a href="#%E5%8A%A0%E8%BD%BD%E8%AE%BE%E5%A4%87%E6%A8%A1%E5%9D%97"><span class="tocnumber">4.2</span> <span class="toctext">加载设备模块</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-19">
<a href="#%E7%BD%91%E7%BB%9C%E6%8E%A5%E5%8F%A3_2"><span class="tocnumber">5</span> <span class="toctext">网络接口</span></a>
<ul>
<li class="toclevel-2 tocsection-20"><a href="#%E8%AE%BE%E5%A4%87%E5%91%BD%E5%90%8D"><span class="tocnumber">5.1</span> <span class="toctext">设备命名</span></a></li>
<li class="toclevel-2 tocsection-21">
<a href="#%E8%8E%B7%E5%8F%96%E5%BD%93%E5%89%8D%E7%BD%91%E7%BB%9C%E5%90%8D"><span class="tocnumber">5.2</span> <span class="toctext">获取当前网络名</span></a>
<ul>
<li class="toclevel-3 tocsection-22"><a href="#%E6%9B%B4%E6%94%B9%E8%AE%BE%E5%A4%87%E5%90%8D%E7%A7%B0"><span class="tocnumber">5.2.1</span> <span class="toctext">更改设备名称</span></a></li>
<li class="toclevel-3 tocsection-23"><a href="#%E4%BD%BF%E7%94%A8%E4%BC%A0%E7%BB%9F%E7%BD%91%E7%BB%9C%E5%91%BD%E5%90%8D%E8%A7%84%E5%88%99"><span class="tocnumber">5.2.2</span> <span class="toctext">使用传统网络命名规则</span></a></li>
</ul>
</li>
<li class="toclevel-2 tocsection-24"><a href="#%E8%AE%BE%E5%AE%9A%E8%AE%BE%E5%A4%87%E7%9A%84_MTU_%E5%92%8C%E9%98%9F%E5%88%97%E9%95%BF%E5%BA%A6"><span class="tocnumber">5.3</span> <span class="toctext">设定设备的 MTU 和队列长度</span></a></li>
<li class="toclevel-2 tocsection-25"><a href="#%E5%90%AF%E7%94%A8%E5%92%8C%E7%A6%81%E7%94%A8%E7%BD%91%E7%BB%9C%E6%8E%A5%E5%8F%A3_2"><span class="tocnumber">5.4</span> <span class="toctext">启用和禁用网络接口</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-26">
<a href="#%E9%85%8D%E7%BD%AE_IP_%E5%9C%B0%E5%9D%80"><span class="tocnumber">6</span> <span class="toctext">配置 IP 地址</span></a>
<ul>
<li class="toclevel-2 tocsection-27">
<a href="#%E5%8A%A8%E6%80%81_IP_%E5%9C%B0%E5%9D%80"><span class="tocnumber">6.1</span> <span class="toctext">动态 IP 地址</span></a>
<ul>
<li class="toclevel-3 tocsection-28"><a href="#systemd-networkd"><span class="tocnumber">6.1.1</span> <span class="toctext">systemd-networkd</span></a></li>
<li class="toclevel-3 tocsection-29"><a href="#dhcpcd"><span class="tocnumber">6.1.2</span> <span class="toctext">dhcpcd</span></a></li>
<li class="toclevel-3 tocsection-30"><a href="#netctl"><span class="tocnumber">6.1.3</span> <span class="toctext">netctl</span></a></li>
</ul>
</li>
<li class="toclevel-2 tocsection-31">
<a href="#%E9%9D%99%E6%80%81_IP_%E5%9C%B0%E5%9D%80_2"><span class="tocnumber">6.2</span> <span class="toctext">静态 IP 地址</span></a>
<ul>
<li class="toclevel-3 tocsection-32"><a href="#netctl_2"><span class="tocnumber">6.2.1</span> <span class="toctext">netctl</span></a></li>
<li class="toclevel-3 tocsection-33"><a href="#systemd-networkd_2"><span class="tocnumber">6.2.2</span> <span class="toctext">systemd-networkd</span></a></li>
<li class="toclevel-3 tocsection-34"><a href="#dhcpcd_2"><span class="tocnumber">6.2.3</span> <span class="toctext">dhcpcd</span></a></li>
<li class="toclevel-3 tocsection-35"><a href="#%E6%89%8B%E5%8A%A8%E6%8C%87%E5%AE%9A"><span class="tocnumber">6.2.4</span> <span class="toctext">手动指定</span></a></li>
<li class="toclevel-3 tocsection-36"><a href="#%E8%AE%A1%E7%AE%97%E5%9C%B0%E5%9D%80"><span class="tocnumber">6.2.5</span> <span class="toctext">计算地址</span></a></li>
</ul>
</li>
<li class="toclevel-2 tocsection-37"><a href="#IP_%E5%9C%B0%E5%9D%80_2"><span class="tocnumber">6.3</span> <span class="toctext">IP 地址</span></a></li>
<li class="toclevel-2 tocsection-38"><a href="#%E8%B7%AF%E7%94%B1%E8%A1%A8_2"><span class="tocnumber">6.4</span> <span class="toctext">路由表</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-39">
<a href="#%E6%9B%B4%E5%A4%9A%E8%AE%BE%E7%BD%AE"><span class="tocnumber">7</span> <span class="toctext">更多设置</span></a>
<ul>
<li class="toclevel-2 tocsection-40"><a href="#%E7%AC%94%E8%AE%B0%E6%9C%AC%E7%94%B5%E8%84%91%E4%BD%BF%E7%94%A8_Ifplugd"><span class="tocnumber">7.1</span> <span class="toctext">笔记本电脑使用 Ifplugd</span></a></li>
<li class="toclevel-2 tocsection-41"><a href="#%E7%BB%91%E5%AE%9A%E5%92%8C%E9%93%BE%E8%B7%AF%E8%81%9A%E5%90%88"><span class="tocnumber">7.2</span> <span class="toctext">绑定和链路聚合</span></a></li>
<li class="toclevel-2 tocsection-42"><a href="#IP_%E5%88%AB%E5%90%8D"><span class="tocnumber">7.3</span> <span class="toctext">IP 别名</span></a></li>
<li class="toclevel-2 tocsection-43"><a href="#%E6%9B%B4%E6%94%B9_MAC/%E7%A1%AC%E4%BB%B6%E5%9C%B0%E5%9D%80"><span class="tocnumber">7.4</span> <span class="toctext">更改 MAC/硬件地址</span></a></li>
<li class="toclevel-2 tocsection-44"><a href="#%E5%85%B1%E4%BA%AB%E7%BD%91%E7%BB%9C%E8%BF%9E%E6%8E%A5"><span class="tocnumber">7.5</span> <span class="toctext">共享网络连接</span></a></li>
<li class="toclevel-2 tocsection-45"><a href="#%E8%B7%AF%E7%94%B1%E9%85%8D%E7%BD%AE"><span class="tocnumber">7.6</span> <span class="toctext">路由配置</span></a></li>
<li class="toclevel-2 tocsection-46"><a href="#%E5%B1%80%E5%9F%9F%E7%BD%91%E4%B8%BB%E6%9C%BA%E7%9A%84%E5%90%8D%E7%A7%B0%E8%A7%A3%E6%9E%90"><span class="tocnumber">7.7</span> <span class="toctext">局域网主机的名称解析</span></a></li>
<li class="toclevel-2 tocsection-47"><a href="#%E5%85%A8%E6%8E%A5%E6%94%B6%E6%A8%A1%E5%BC%8F"><span class="tocnumber">7.8</span> <span class="toctext">全接收模式</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-48">
<a href="#%E7%96%91%E9%9A%BE%E6%8E%92%E8%A7%A3"><span class="tocnumber">8</span> <span class="toctext">疑难排解</span></a>
<ul>
<li class="toclevel-2 tocsection-49"><a href="#%E6%9B%B4%E6%8D%A2%E4%BA%86%E8%BF%9E%E6%8E%A5cable_modem%E7%9A%84%E8%AE%A1%E7%AE%97%E6%9C%BA"><span class="tocnumber">8.1</span> <span class="toctext">更换了连接cable modem的计算机</span></a></li>
<li class="toclevel-2 tocsection-50">
<a href="#TCP%E7%AA%97%E5%8F%A3%E6%89%A9%E7%BC%A9%EF%BC%88window_scaling%EF%BC%89%E6%95%85%E9%9A%9C"><span class="tocnumber">8.2</span> <span class="toctext">TCP窗口扩缩（window scaling）故障</span></a>
<ul>
<li class="toclevel-3 tocsection-51"><a href="#%E5%A6%82%E4%BD%95%E8%AF%8A%E6%96%AD%E6%95%85%E9%9A%9C"><span class="tocnumber">8.2.1</span> <span class="toctext">如何诊断故障</span></a></li>
<li class="toclevel-3 tocsection-52"><a href="#%E5%A6%82%E4%BD%95%E4%BF%AE%E5%A4%8D%EF%BC%88%E7%B3%9F%E7%B3%95%E7%9A%84%E6%96%B9%E6%B3%95%EF%BC%89"><span class="tocnumber">8.2.2</span> <span class="toctext">如何修复（糟糕的方法）</span></a></li>
<li class="toclevel-3 tocsection-53"><a href="#%E5%A6%82%E4%BD%95%E4%BF%AE%E5%A4%8D%EF%BC%88%E5%A5%BD%E7%82%B9%E7%9A%84%E6%96%B9%E6%B3%95%EF%BC%89"><span class="tocnumber">8.2.3</span> <span class="toctext">如何修复（好点的方法）</span></a></li>
<li class="toclevel-3 tocsection-54"><a href="#%E5%A6%82%E4%BD%95%E4%BF%AE%E5%A4%8D%EF%BC%88%E6%9C%80%E4%BD%B3%E7%9A%84%E6%96%B9%E6%B3%95%EF%BC%89"><span class="tocnumber">8.2.4</span> <span class="toctext">如何修复（最佳的方法）</span></a></li>
<li class="toclevel-3 tocsection-55"><a href="#%E6%9B%B4%E5%A4%9A"><span class="tocnumber">8.2.5</span> <span class="toctext">更多</span></a></li>
</ul>
</li>
<li class="toclevel-2 tocsection-56">
<a href="#Realtek_%E6%B2%A1%E6%9C%89%E8%BF%9E%E6%8E%A5/%E7%BD%91%E7%BB%9C%E5%94%A4%E9%86%92%E6%95%85%E9%9A%9C"><span class="tocnumber">8.3</span> <span class="toctext">Realtek 没有连接/网络唤醒故障</span></a>
<ul>
<li class="toclevel-3 tocsection-57"><a href="#%E5%9C%A8_Linux_%E4%B8%AD%E5%90%AF%E7%94%A8%E7%BD%91%E5%8D%A1"><span class="tocnumber">8.3.1</span> <span class="toctext">在 Linux 中启用网卡</span></a></li>
<li class="toclevel-3 tocsection-58"><a href="#%E6%96%B9%E6%B3%95%E4%B8%80_%E8%BF%98%E5%8E%9F/%E5%8F%98%E6%9B%B4Win%E9%A9%B1%E5%8A%A8"><span class="tocnumber">8.3.2</span> <span class="toctext">方法一 还原/变更Win驱动</span></a></li>
<li class="toclevel-3 tocsection-59"><a href="#%E6%96%B9%E6%B3%95%E4%BA%8C_%E5%90%AF%E5%8A%A8Windows%E9%A9%B1%E5%8A%A8%E9%87%8C%E7%9A%84%E7%BD%91%E7%BB%9C%E5%94%A4%E9%86%92%E5%8A%9F%E8%83%BD"><span class="tocnumber">8.3.3</span> <span class="toctext">方法二 启动Windows驱动里的网络唤醒功能</span></a></li>
<li class="toclevel-3 tocsection-60"><a href="#%E6%96%B9%E6%B3%95%E4%B8%89_%E6%9B%B4%E6%96%B0Realtek_Linux%E9%A9%B1%E5%8A%A8"><span class="tocnumber">8.3.4</span> <span class="toctext">方法三 更新Realtek Linux驱动</span></a></li>
<li class="toclevel-3 tocsection-61"><a href="#%E6%96%B9%E6%B3%95%E5%9B%9B_%E5%9C%A8_BIOS/CMOS_%E4%B8%AD%E5%90%AF%E7%94%A8_LAN_Boot_ROM"><span class="tocnumber">8.3.5</span> <span class="toctext">方法四 在 BIOS/CMOS 中启用 <i>LAN Boot ROM</i></span></a></li>
</ul>
</li>
<li class="toclevel-2 tocsection-62"><a href="#%E6%A3%80%E6%9F%A5_DHCP_%E9%97%AE%E9%A2%98%E5%85%88%E9%87%8A%E6%94%BE_IP_%E5%9C%B0%E5%9D%80"><span class="tocnumber">8.4</span> <span class="toctext">检查 DHCP 问题先释放 IP 地址</span></a></li>
<li class="toclevel-2 tocsection-63"><a href="#Atheros_%E8%8A%AF%E7%89%87%E7%BB%84%E6%89%BE%E4%B8%8D%E5%88%B0%E7%BD%91%E5%8D%A1"><span class="tocnumber">8.5</span> <span class="toctext">Atheros 芯片组找不到网卡</span></a></li>
<li class="toclevel-2 tocsection-64"><a href="#Broadcom_BCM57780"><span class="tocnumber">8.6</span> <span class="toctext">Broadcom BCM57780</span></a></li>
<li class="toclevel-2 tocsection-65"><a href="#Realtek_RTL8111/8168B"><span class="tocnumber">8.7</span> <span class="toctext">Realtek RTL8111/8168B</span></a></li>
<li class="toclevel-2 tocsection-66"><a href="#Gigabyte_Motherboard_with_Realtek_8111/8168/8411"><span class="tocnumber">8.8</span> <span class="toctext">Gigabyte Motherboard with Realtek 8111/8168/8411</span></a></li>
</ul>
</li>
</ul>
</div>

<h2>
<span id=".E6.A3.80.E6.9F.A5.E8.BF.9E.E6.8E.A5"></span><span class="mw-headline" id="检查连接">检查连接</span>
</h2>
<p>若要排查网络连接问题，请先确保你满足了以下要求。
</p>
<ol>
<li>你的<a href="#%E7%BD%91%E7%BB%9C%E6%8E%A5%E5%8F%A3">网络接口</a>可见并已启用。否则请检查设备驱动－请查阅 <a href="../en/Network_configuration/Ethernet.html#Device_driver" title="Network configuration/Ethernet">Network configuration/Ethernet#Device driver</a> 或 <a href="../zh-CN/aa29dd559001de6a26e3fe87e084eb6e.html#%E8%AE%BE%E5%A4%87%E9%A9%B1%E5%8A%A8" class="mw-redirect" title="Wireless network configuration (简体中文)">Wireless network configuration (简体中文)#设备驱动</a> 页面。</li>
<li>你已连接到网络。网线已接好或者已经<a href="../zh-CN/aa29dd559001de6a26e3fe87e084eb6e.html" class="mw-redirect" title="Wireless network configuration (简体中文)">连接到无线局域网</a>。</li>
<li>你的网络接口拥有一个<a href="#IP_%E5%9C%B0%E5%9D%80">IP 地址</a>。</li>
<li>你的<a href="#%E8%B7%AF%E7%94%B1%E8%A1%A8">路由表</a>设置正确。</li>
<li>你可以 <a href="#Ping">ping</a> 通一个本地 IP 地址（例如你的默认网关）。</li>
<li>你可以 <a href="#Ping">ping</a> 通一个公网 IP 地址（例如 <code>8.8.8.8</code> ，即谷歌的 DNS 服务器）。</li>
<li>
<a href="../en/Domain_name_resolution.html#Check_if_you_can_resolve_domain_names" class="mw-redirect" title="Check if you can resolve domain names">检查是否能解析域名</a>（例如 <code>archlinux.org</code>）。</li>
</ol>
<h3><span class="mw-headline" id="Ping">Ping</span></h3>
<div class="noprint archwiki-template-message">
<p><a href="../File:Tango-view-fullscreen.png" class="image"><img alt="Tango-view-fullscreen.png" src="../File:Tango-view-fullscreen.png" decoding="async" width="48" height="48"></a><b>This article or section needs expansion.</b><a href="../File:Tango-view-fullscreen.png" class="image"><img alt="Tango-view-fullscreen.png" src="../File:Tango-view-fullscreen.png" decoding="async" width="48" height="48"></a></p>
<div>
<b>Reason:</b> 需添加或链接到常见 ping 命令错误的内容，如“未知主机”或“网络不可达”等报错。 (Discuss in <a rel="nofollow" class="external text" href="https://wiki.archlinux.org/index.php/Talk:Network_configuration_(%E7%AE%80%E4%BD%93%E4%B8%AD%E6%96%87)">Talk:Network configuration (简体中文)#</a>)</div>
</div>
<p><a href="https://en.wikipedia.org/wiki/Ping_(networking_utility)" class="extiw" title="wikipedia:Ping (networking utility)">ping</a> 用于测试你是否可连接到某个主机。
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">$ ping www.example.com</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">PING www.example.com (93.184.216.34): 56(84) data bytes
64 bytes from 93.184.216.34: icmp_seq=0 ttl=56 time=11.632 ms
64 bytes from 93.184.216.34: icmp_seq=1 ttl=56 time=11.726 ms
64 bytes from 93.184.216.34: icmp_seq=2 ttl=56 time=10.683 ms
...</pre>
<p>如上所示，Ping 命令对每个收到的回应都会显示一行信息。详细的解释请阅读 <span class="plainlinks archwiki-template-man" title="$ man 8 ping"><a rel="nofollow" class="external text" href="https://man.archlinux.org/man/ping.8">ping(8)</a></span> 手册。注意，计算机可以配置为不响应 ICMP 回应请求。<a rel="nofollow" class="external autonumber" href="https://unix.stackexchange.com/questions/412446/how-to-disable-ping-response-icmp-echo-in-linux-all-the-time">[1]</a>
</p>
<p>如果没有收到回应，原因可能与你的默认网关配置或者你的网络接入服务商（ISP）有关。你可以运行 <a href="../en/Network_tools.html#Traceroute" class="mw-redirect" title="Traceroute">traceroute</a> 以进一步诊断到对端主机的路由。
</p>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>注意：</strong> 如果你运行 ping 命令时收到一条类似 <code>ping: icmp open socket: Operation not permitted</code> 的报错信息，请尝试重新安装 <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=iputils">iputils</a></span> 软件包。</div>
<h2>
<span id=".E7.BD.91.E7.BB.9C.E7.AE.A1.E7.90.86"></span><span class="mw-headline" id="网络管理">网络管理</span>
</h2>
<p>通过以下步骤来设置网络链接：
</p>
<ol>
<li>确保网络接口已连接并已开启。</li>
<li>连接到网络。网线已接好或者已经<a href="../zh-CN/aa29dd559001de6a26e3fe87e084eb6e.html" class="mw-redirect" title="Wireless network configuration (简体中文)">连接到无线局域网</a>。</li>
<li>配置网络连接：
<ul>
<li><a href="#%E9%9D%99%E6%80%81_IP_%E5%9C%B0%E5%9D%80">静态 IP 地址</a></li>
<li>动态 IP 地址：使用 <a href="#DHCP">DHCP</a>
</li>
</ul>
</li>
</ol>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>注意：</strong> 安装镜像会在开机时为 <a rel="nofollow" class="external text" href="https://git.archlinux.org/archiso.git/tree/configs/releng/airootfs/etc/udev/rules.d/81-dhcpcd.rules">有线网络设备</a> 启用 <a href="../en/Dhcpcd.html" title="Dhcpcd">dhcpcd</a> (<code>dhcpcd@<i>interface</i>.service</code>) </div>
<h3>
<span id=".E7.BD.91.E7.BB.9C.E5.B7.A5.E5.85.B7"></span><span class="mw-headline" id="网络工具">网络工具</span>
</h3>
<p>Arch Linux 已经弃用了 <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=net-tools">net-tools</a></span> 转而使用 <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=iproute2">iproute2</a></span>。 <a rel="nofollow" class="external autonumber" href="https://archlinux.org/news/deprecation-of-net-tools/">[2]</a>
</p>
<table class="wikitable">
<tbody>
<tr>
<th>已弃用的命令</th>
<th>替换命令
</th>
</tr>
<tr>
<td>arp</td>
<td>ip neighbor
</td>
</tr>
<tr>
<td><a rel="nofollow" class="external text" href="https://zh.wikipedia.org/wiki/Ifconfig">ifconfig</a></td>
<td>ip address, ip link
</td>
</tr>
<tr>
<td>netstat</td>
<td>
<a href="#Investigate_sockets">ss</a><sup>[<a href="../en/ArchWiki:Requests.html#Broken_section_links" class="mw-redirect" title="ArchWiki:Requests">断开的链接</a>：无效的部分]</sup>
</td>
</tr>
<tr>
<td>route</td>
<td>ip route
</td>
</tr>
</tbody>
</table>
<p>想要更多更完整的总结，请参阅<a rel="nofollow" class="external text" href="https://dougvitale.wordpress.com/2011/12/21/deprecated-linux-networking-commands-and-their-replacements/">这篇文章</a>。
</p>
<h3><span class="mw-headline" id="iproute2">iproute2</span></h3>
<p><a href="https://en.wikipedia.org/wiki/iproute2" class="extiw" title="wikipedia:iproute2">iproute2</a> 是 <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=base">base</a></span> <a href="../en/Meta_package_and_package_group.html#Difference_between_meta_package_and_package_group" class="mw-redirect" title="Meta package">元包</a> 的依赖，提供 <span class="plainlinks archwiki-template-man" title="$ man 8 ip"><a rel="nofollow" class="external text" href="https://man.archlinux.org/man/ip.8">ip(8)</a></span> 命令行接口，用于管理 <a href="#%E7%BD%91%E7%BB%9C%E6%8E%A5%E5%8F%A3">网络接口</a>，<a href="#IP_%E5%9C%B0%E5%9D%80">IP 地址</a> 和 <a href="#%E8%B7%AF%E7%94%B1%E8%A1%A8">路由表</a>。注意使用 <code>ip</code> 进行的配置会在重启后丢失。要进行永久配置，可以使用 <a href="#%E7%BD%91%E7%BB%9C%E7%AE%A1%E7%90%86%E5%99%A8">网络管理器</a> 或通过脚本和 <a href="../zh-CN/Systemd.html#%E7%BC%96%E5%86%99%E5%8D%95%E5%85%83%E6%96%87%E4%BB%B6" title="Systemd (简体中文)">systemd 单元</a> 使 ip 命令自动化。同时需要注意的是 ip 命令通常能够缩写，为了清楚起见，本文对其进行了详细说明。
</p>
<h3>
<span id=".E7.BD.91.E7.BB.9C.E6.8E.A5.E5.8F.A3"></span><span class="mw-headline" id="网络接口">网络接口</span>
</h3>
<p>默认情况下， <a href="../zh-CN/Udev.html" title="Udev (简体中文)">udev</a> 使用 <a rel="nofollow" class="external text" href="https://www.freedesktop.org/wiki/Software/systemd/PredictableNetworkInterfaceNames">可预测的网络接口名称</a> 分配给你的网络接口，该名称以 <code>en</code> (有线/<a rel="nofollow" class="external text" href="https://zh.wikipedia.org/wiki/%E4%BB%A5%E5%A4%AA%E7%BD%91">以太网</a>) ，<code>wl</code> (无线/WLAN) 或 <code>ww</code> (<a href="https://en.wikipedia.org/wiki/Wireless_WAN" class="extiw" title="wikipedia:Wireless WAN">WWAN</a>) 。
</p>
<div class="archwiki-template-box archwiki-template-box-tip">
<strong>Tip:</strong> 要改变接口名称，请参阅 <a href="#Change_interface_name">#Change interface name</a><sup>[<a href="../en/ArchWiki:Requests.html#Broken_section_links" class="mw-redirect" title="ArchWiki:Requests">断开的链接</a>：无效的部分]</sup> 和 <a href="#Revert_to_traditional_interface_names">#Revert to traditional interface names</a><sup>[<a href="../en/ArchWiki:Requests.html#Broken_section_links" class="mw-redirect" title="ArchWiki:Requests">断开的链接</a>：无效的部分]</sup> 。</div>
<h4>
<span id=".E5.88.97.E5.87.BA.E7.BD.91.E7.BB.9C.E6.8E.A5.E5.8F.A3"></span><span class="mw-headline" id="列出网络接口">列出网络接口</span>
</h4>
<p>有线和无线接口名称都可以通过 <code>ls /sys/class/net</code> 或 <code>ip link</code> 找到。要注意的是 <code>lo</code> 是 <a rel="nofollow" class="external text" href="https://zh.wikipedia.org/wiki/Loop%E8%AE%BE%E5%A4%87">Loop 设备</a> ，不被用于建立网络连接。
</p>
<p>同样，也可以用 <code>iw dev</code> 来检索无线设备的名称。可以参阅 <a href="../zh-CN/aa29dd559001de6a26e3fe87e084eb6e.html#%E8%8E%B7%E5%8F%96%E6%9C%89%E7%94%A8%E4%BF%A1%E6%81%AF" class="mw-redirect" title="Wireless network configuration (简体中文)">Wireless network configuration (简体中文)#获取有用信息</a>
</p>
<p>如果未列出您的网络接口，请确保已成功加载设备驱动。参阅 <a href="../en/Network_configuration/Ethernet.html#Device_driver" title="Network configuration/Ethernet">Network configuration/Ethernet#Device driver</a> 或 <a href="../zh-CN/aa29dd559001de6a26e3fe87e084eb6e.html#%E8%AE%BE%E5%A4%87%E9%A9%B1%E5%8A%A8" class="mw-redirect" title="Wireless network configuration (简体中文)">Wireless network configuration (简体中文)#设备驱动</a> 。
</p>
<h4>
<span id=".E5.90.AF.E7.94.A8.E5.92.8C.E7.A6.81.E7.94.A8.E7.BD.91.E7.BB.9C.E6.8E.A5.E5.8F.A3"></span><span class="mw-headline" id="启用和禁用网络接口">启用和禁用网络接口</span>
</h4>
<p>可以使用 <code>ip link set <i>interface</i> up|down</code> 来启用 / 禁用网络接口，参阅 <span class="plainlinks archwiki-template-man" title="$ man 8 ip-link"><a rel="nofollow" class="external text" href="https://man.archlinux.org/man/ip-link.8">ip-link(8)</a></span> 。
</p>
<p>要想检查接口 <code>eth0</code> 的状态：
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">$ ip link show dev eth0</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">2: eth0: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu 1500 qdisc pfifo_fast master br0 state DOWN mode DEFAULT qlen 1000
...
</pre>
<p><code>&lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt;</code> 中的 <code>UP</code> 表示接口已经启动，而非表示稍后的 <code>state DOWN</code> 。
</p>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>注意：</strong> 如果您的默认路由是通过接口 <code>eth0</code> 进行的，则将其删除也会删除该路由，而恢复备份将不会自动重新建立默认路由。参阅 <a href="#%E8%B7%AF%E7%94%B1%E8%A1%A8">#路由表</a> 以重新建立它。</div>
<h3>
<span id=".E9.9D.99.E6.80.81_IP_.E5.9C.B0.E5.9D.80"></span><span class="mw-headline" id="静态_IP_地址">静态 IP 地址</span>
</h3>
<p>可以通过绝大多数的 <a href="#%E7%BD%91%E7%BB%9C%E7%AE%A1%E7%90%86%E5%99%A8">网络管理器</a> 或 <a href="../zh-CN/Dhcpcd.html" title="Dhcpcd (简体中文)">dhcpcd (简体中文)</a> 来配置静态 IP 地址。
</p>
<p>要手动配置静态 IP 地址，请按照 <a href="#IP_%E5%9C%B0%E5%9D%80">IP 地址</a> 中的说明添加 IP 地址，设置 <a href="#%E8%B7%AF%E7%94%B1%E8%A1%A8">路由表</a> 并<a href="../zh-CN/Domain_name_resolution.html" title="Domain name resolution (简体中文)">配置 DNS 服务器</a>。
</p>
<h3>
<span id="IP_.E5.9C.B0.E5.9D.80"></span><span class="mw-headline" id="IP_地址">IP 地址</span>
</h3>
<p>通过 <span class="plainlinks archwiki-template-man" title="$ man 8 ip-address"><a rel="nofollow" class="external text" href="https://man.archlinux.org/man/ip-address.8">ip-address(8)</a></span> 来管理 <a rel="nofollow" class="external text" href="https://zh.wikipedia.org/wiki/IP%E5%9C%B0%E5%9D%80">IP 地址</a>。
</p>
<p>列出 IP 地址：
</p>
<pre>$ ip address show
</pre>
<p>将 IP 地址添加到接口：
</p>
<pre># ip address add <i>address/prefix_len</i> broadcast + dev <i>interface</i>
</pre>
<dl><dd>注意：</dd></dl>
<dl><dd><ul>
<li>这个地址将以 <a rel="nofollow" class="external text" href="https://zh.wikipedia.org/wiki/%E6%97%A0%E7%B1%BB%E5%88%AB%E5%9F%9F%E9%97%B4%E8%B7%AF%E7%94%B1">CIDR 表示法</a> 给出，还会提供 <a rel="nofollow" class="external text" href="https://zh.wikipedia.org/wiki/%E5%AD%90%E7%BD%91">子网掩码</a> 。</li>
<li>
<code>+</code> 是使 <code>ip</code> 从 IP 地址和子网掩码派生 <a href="https://en.wikipedia.org/wiki/Broadcast_address" class="extiw" title="wikipedia:Broadcast address">broadcast address</a> 的特殊符号</li>
</ul></dd></dl>
<dl><dd><div class="archwiki-template-box archwiki-template-box-note">
<strong>注意：</strong> 要确保手动分配的 IP 地址与 DHCP 分配的 IP 地址不冲突。</div></dd></dl>
<p>将 IP 地址从接口中删除：
</p>
<pre>$ ip address del <i>address/prefix_len</i> dev <i>interface</i>
</pre>
<p>删除所有符合条件的地址，例如某个特定接口的地址：
</p>
<pre>$ ip address flush dev <i>interface</i>
</pre>
<div class="archwiki-template-box archwiki-template-box-tip">
<strong>Tip:</strong> 可通过 <a rel="nofollow" class="external text" href="http://jodies.de/ipcalc">ipcalc</a> (<span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=ipcalc">ipcalc</a></span>) 计算 IP 地址。</div>
<h3>
<span id=".E8.B7.AF.E7.94.B1.E8.A1.A8"></span><span class="mw-headline" id="路由表">路由表</span>
</h3>
<p><a rel="nofollow" class="external text" href="https://zh.wikipedia.org/wiki/%E8%B7%AF%E7%94%B1%E8%A1%A8">路由表</a> 被用于确定是否可以直接访问某个 IP 地址或该使用哪个网关（路由器）。如果别的路由与这个 IP 地址匹配，将使用<a href="https://en.wikipedia.org/wiki/Default_gateway" class="extiw" title="wikipedia:Default gateway">默认网关</a> 。
</p>
<p>通过 <span class="plainlinks archwiki-template-man" title="$ man 8 ip-route"><a rel="nofollow" class="external text" href="https://man.archlinux.org/man/ip-route.8">ip-route(8)</a></span> 来管理路由表。
</p>
<p><b>PREFIX</b> 是 CIDR 表示法或默认网关的 <code>默认值</code> 。
</p>
<p>列出 IPv4 路由：
</p>
<pre>$ ip route show
</pre>
<p>列出 IPv6 路由：
</p>
<pre>$ ip -6 route
</pre>
<p>添加路由：
</p>
<pre># ip route add <i>PREFIX</i> via <i>address</i> dev <i>interface</i>
</pre>
<p>删除路由：
</p>
<pre># ip route del <i>PREFIX</i> via <i>address</i> dev <i>interface</i>
</pre>
<h3><span class="mw-headline" id="DHCP">DHCP</span></h3>
<p><a rel="nofollow" class="external text" href="https://zh.wikipedia.org/wiki/%E5%8A%A8%E6%80%81%E4%B8%BB%E6%9C%BA%E9%85%8D%E7%BD%AE%E5%8D%8F%E8%AE%AE">动态主机配置协议（DHCP）</a> 服务器为客户端提供动态 IP 地址，子网掩码，默认网关 IP 地址，有时还可以提供域名服务器。
</p>
<p>要使用 DHCP ，需要网络中有的 DHCP 服务器和 DHCP 客户端：
</p>
<table class="wikitable">
<tbody>
<tr>
<th>客户端</th>
<th>软件包</th>
<th><a href="../zh-CN/Archiso.html" title="Archiso (简体中文)">Archiso</a></th>
<th>注意</th>
<th>Systemd units
</th>
</tr>
<tr>
<td><a href="../zh-CN/Dhcpcd.html" title="Dhcpcd (简体中文)">dhcpcd</a></td>
<td><span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=dhcpcd">dhcpcd</a></span></td>
<td data-sort-value="5" style="background: #afa; color: inherit; vertical-align: middle; text-align: center;">Yes</td>
<td>DHCP, DHCPv6, ZeroConf, static IP</td>
<td>
<code>dhcpcd.service</code>, <code>dhcpcd@<i>interface</i>.service</code>
</td>
</tr>
<tr>
<td><a rel="nofollow" class="external text" href="https://www.isc.org/downloads/dhcp/">ISC dhclient</a></td>
<td><span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=dhclient">dhclient</a></span></td>
<td data-sort-value="5" style="background: #afa; color: inherit; vertical-align: middle; text-align: center;">Yes</td>
<td>DHCP, DHCPv6, BOOTP, static IP</td>
<td>
<code>dhclient@<i>interface</i>.service</code>
</td>
</tr>
</tbody>
</table>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>注意：</strong> 
<ul>
<li>不能同时运行两个 DHCP 客户端</li>
<li>使用 DHCP 客户端的同时还需要同时使用 <a href="#%E7%BD%91%E7%BB%9C%E7%AE%A1%E7%90%86%E5%99%A8">网络管理器</a>
</li>
</ul>
</div>
<div class="archwiki-template-box archwiki-template-box-tip">
<strong>Tip:</strong> 你可以通过 <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=dhcping">dhcping</a></span> 检查一个 DHCP 服务器是否在运行。</div>
<h4>
<span id=".E6.9C.8D.E5.8A.A1.E5.99.A8"></span><span class="mw-headline" id="服务器">服务器</span>
</h4>
<table class="wikitable">
<tbody>
<tr>
<th>服务器</th>
<th>软件包</th>
<th>IPv4</th>
<th>IPv6</th>
<th>GUI</th>
<th>接口</th>
<th>后端存储</th>
<th>注意
</th>
</tr>
<tr>
<td><a href="../zh-CN/Dhcpd.html" title="Dhcpd (简体中文)">dhcpd</a></td>
<td><span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=dhcp">dhcp</a></span></td>
<td data-sort-value="5" style="background: #afa; color: inherit; vertical-align: middle; text-align: center;">Yes</td>
<td data-sort-value="5" style="background: #afa; color: inherit; vertical-align: middle; text-align: center;">Yes</td>
<td><a rel="nofollow" class="external text" href="https://github.com/Akkadius/glass-isc-dhcp">Glass-ISC-DHCP</a></td>
<td>?</td>
<td>File</td>
<td>
</td>
</tr>
<tr>
<td><a href="../zh-CN/Dnsmasq.html" title="Dnsmasq (简体中文)">dnsmasq</a></td>
<td><span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=dnsmasq">dnsmasq</a></span></td>
<td data-sort-value="5" style="background: #afa; color: inherit; vertical-align: middle; text-align: center;">Yes</td>
<td data-sort-value="5" style="background: #afa; color: inherit; vertical-align: middle; text-align: center;">Yes</td>
<td data-sort-value="1" style="background: #faa; color: inherit; vertical-align: middle; text-align: center;">No</td>
<td>?</td>
<td>File</td>
<td>Also DNS, PXE and TFTP
</td>
</tr>
<tr>
<td><a href="../en/Kea.html" title="Kea">Kea</a></td>
<td><span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=kea">kea</a></span></td>
<td data-sort-value="5" style="background: #afa; color: inherit; vertical-align: middle; text-align: center;">Yes</td>
<td data-sort-value="5" style="background: #afa; color: inherit; vertical-align: middle; text-align: center;">Yes</td>
<td><a rel="nofollow" class="external text" href="https://github.com/isc-projects/kea-anterius">Kea-Anterius (Experimental)</a></td>
<td>REST, RADIUS and NETCONF</td>
<td>File, MySQL, PostgreSQL and Cassandra</td>
<td>Also DNS
</td>
</tr>
</tbody>
</table>
<h3>
<span id=".E7.BD.91.E7.BB.9C.E7.AE.A1.E7.90.86.E5.99.A8"></span><span class="mw-headline" id="网络管理器">网络管理器</span>
</h3>
<p>网络管理器可以在网络配置文件中管理网络连接设置，以便切换网络。
</p>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>注意：</strong> 有许多可选的方案，但他们都相互排斥，因此不要同时运行两个守护程序</div>
<table class="wikitable">
<tbody>
<tr>
<th>网络管理器</th>
<th>GUI</th>
<th>
<a href="../zh-CN/Archiso.html" title="Archiso (简体中文)">Archiso (简体中文)</a> <a rel="nofollow" class="external autonumber" href="https://gitlab.archlinux.org/archlinux/archiso/blob/master/configs/releng/packages.x86_64">[3]</a>
</th>
<th>CLI 工具</th>
<th>
<a rel="nofollow" class="external text" href="https://zh.wikipedia.org/wiki/%E7%82%B9%E5%AF%B9%E7%82%B9%E5%8D%8F%E8%AE%AE">点对点协议</a> 支持 <br>(e.g. 3G modem)</th>
<th><a href="#DHCP">DHCP 客户端</a></th>
<th>Systemd units
</th>
</tr>
<tr>
<th>
<a href="../en/ConnMan.html" title="ConnMan">ConnMan</a>
</th>
<td data-sort-value="3" style="background: #ffa; color: inherit; vertical-align: middle; text-align: center;">8 unofficial</td>
<td data-sort-value="1" style="background: #faa; color: inherit; vertical-align: middle; text-align: center;">No</td>
<td><span class="plainlinks archwiki-template-man" title="$ man 1 connmanctl"><a rel="nofollow" class="external text" href="https://man.archlinux.org/man/connmanctl.1">connmanctl(1)</a></span></td>
<td data-sort-value="5" style="background: #afa; color: inherit; vertical-align: middle; text-align: center;">Yes (with <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://aur.archlinux.org/packages/ofono/">ofono</a></span><sup><small>AUR</small></sup>)</td>
<td>内置</td>
<td>
<code>connman.service</code>
</td>
</tr>
<tr>
<th>
<a href="../zh-CN/Netctl.html" title="Netctl (简体中文)">netctl</a>
</th>
<td data-sort-value="3" style="background: #ffa; color: inherit; vertical-align: middle; text-align: center;">2 unofficial</td>
<td data-sort-value="5" style="background: #afa; color: inherit; vertical-align: middle; text-align: center;">Yes</td>
<td>
<span class="plainlinks archwiki-template-man" title="$ man 1 netctl"><a rel="nofollow" class="external text" href="https://man.archlinux.org/man/netctl.1">netctl(1)</a></span>, wifi-menu</td>
<td data-sort-value="5" style="background: #afa; color: inherit; vertical-align: middle; text-align: center;">Yes</td>
<td>
<a href="../zh-CN/Dhcpcd.html" title="Dhcpcd (简体中文)">dhcpcd</a> 或 <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=dhclient">dhclient</a></span>
</td>
<td>
<code>netctl-ifplugd@<i>interface</i>.service</code>, <code>netctl-auto@<i>interface</i>.service</code>
</td>
</tr>
<tr>
<th>
<a href="../zh-CN/NetworkManager.html" title="NetworkManager (简体中文)">NetworkManager</a>
</th>
<td data-sort-value="5" style="background: #afa; color: inherit; vertical-align: middle; text-align: center;">Yes</td>
<td data-sort-value="1" style="background: #faa; color: inherit; vertical-align: middle; text-align: center;">No</td>
<td>
<span class="plainlinks archwiki-template-man" title="$ man 1 nmcli"><a rel="nofollow" class="external text" href="https://man.archlinux.org/man/nmcli.1">nmcli(1)</a></span>, <span class="plainlinks archwiki-template-man" title="$ man 1 nmtui"><a rel="nofollow" class="external text" href="https://man.archlinux.org/man/nmtui.1">nmtui(1)</a></span>
</td>
<td data-sort-value="5" style="background: #afa; color: inherit; vertical-align: middle; text-align: center;">Yes</td>
<td>internal, <a href="../zh-CN/Dhcpcd.html" title="Dhcpcd (简体中文)">dhcpcd</a> 或 <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=dhclient">dhclient</a></span>
</td>
<td>
<code>NetworkManager.service</code>
</td>
</tr>
<tr>
<th>
<a href="../zh-CN/Systemd-networkd.html" title="Systemd-networkd (简体中文)">systemd-networkd</a>
</th>
<td data-sort-value="1" style="background: #faa; color: inherit; vertical-align: middle; text-align: center;">No</td>
<td data-sort-value="5" style="background: #afa; color: inherit; vertical-align: middle; text-align: center;">Yes (<span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=base">base</a></span>)</td>
<td><span class="plainlinks archwiki-template-man" title="$ man 1 networkctl"><a rel="nofollow" class="external text" href="https://man.archlinux.org/man/networkctl.1">networkctl(1)</a></span></td>
<td data-sort-value="1" style="background: #faa; color: inherit; vertical-align: middle; text-align: center;"><a rel="nofollow" class="external text" href="https://github.com/systemd/systemd/issues/481">No</a></td>
<td>内置</td>
<td>
<code>systemd-networkd.service</code>, <code>systemd-resolved.service</code>
</td>
</tr>
<tr>
<th>
<a href="../zh-CN/Wicd.html" title="Wicd (简体中文)">Wicd</a>
</th>
<td data-sort-value="5" style="background: #afa; color: inherit; vertical-align: middle; text-align: center;">Yes</td>
<td data-sort-value="1" style="background: #faa; color: inherit; vertical-align: middle; text-align: center;">No</td>
<td>
<span class="plainlinks archwiki-template-man" title="$ man 8 wicd-cli"><a rel="nofollow" class="external text" href="https://man.archlinux.org/man/wicd-cli.8">wicd-cli(8)</a></span><sup>[<a href="https://en.wikipedia.org/wiki/Wikipedia:Link_rot" class="extiw" title="wikipedia:Wikipedia:Link rot">失效链接</a> 2020-02-22]</sup>, <span class="plainlinks archwiki-template-man" title="$ man 8 wicd-curses"><a rel="nofollow" class="external text" href="https://man.archlinux.org/man/wicd-curses.8">wicd-curses(8)</a></span><sup>[<a href="https://en.wikipedia.org/wiki/Wikipedia:Link_rot" class="extiw" title="wikipedia:Wikipedia:Link rot">失效链接</a> 2020-02-22]</sup>
</td>
<td data-sort-value="1" style="background: #faa; color: inherit; vertical-align: middle; text-align: center;">No</td>
<td><a href="../zh-CN/Dhcpcd.html" title="Dhcpcd (简体中文)">dhcpcd</a></td>
<td>
<code>wicd.service</code>
</td>
</tr>
</tbody>
</table>
<p>参阅 <a href="../zh-CN/List_of_applications.html#%E7%BD%91%E7%BB%9C%E7%AE%A1%E7%90%86" title="List of applications (简体中文)">List of applications (简体中文)#网络管理</a> 。
</p>
<h2>
<span id=".E8.AE.BE.E7.BD.AE.E8.AE.A1.E7.AE.97.E6.9C.BA.E5.90.8D"></span><span class="mw-headline" id="设置计算机名">设置计算机名</span>
</h2>
<p><a href="https://en.wikipedia.org/wiki/Hostname" class="extiw" title="wikipedia:Hostname">主机名</a> 是一个网络中唯一标识一台机器的名称。主机名通过文件 <code>/etc/hostname</code> 进行配置。这样设置主机名：
</p>
<pre># hostnamectl set-hostname <b>myhostname</b>
</pre>
<p>这将会把 <b>myhostname</b> 写入 <code>/etc/hostname</code>。详情参见 <span class="plainlinks archwiki-template-man" title="$ man 5 hostname"><a rel="nofollow" class="external text" href="https://man.archlinux.org/man/hostname.5">hostname(5)</a></span> 和 <span class="plainlinks archwiki-template-man" title="$ man 1 hostnamectl"><a rel="nofollow" class="external text" href="https://man.archlinux.org/man/hostnamectl.1">hostnamectl(1)</a></span>。
</p>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>注意：</strong> 在 Arch Linux chroot 安装环境中，<i>hostnamectl</i>不起作用，要设置安装环境的主机名，请手动<a href="../en/Help:Reading.html#Append,_add,_create,_edit" class="mw-redirect" title="Textedit">编辑</a> <code>/etc/hostname</code>，加入一行<code><i>myhostname</i></code>.</div>
<p>建议同时在 <code>/etc/hosts</code> 中设置 hostname：
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/hosts</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">#
# /etc/hosts: static lookup table for host names
#
	
#&lt;ip-address&gt;	&lt;hostname.domain.org&gt;	&lt;hostname&gt;
127.0.0.1	localhost.localdomain	localhost	 <i>myhostname</i>
::1		localhost.localdomain	localhost	 <i>myhostname</i></pre>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>注意：</strong> <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=systemd">systemd</a></span> 通过 <code>myhostname</code> nss 模块(在 <code>/etc/nsswitch.conf</code> 中默认启用)进行主机名解析，所以大部分情况下都不需要在 <code>/etc/hosts</code> 中设置主机名。但是有些用户反馈如果不设置，某些依赖网络的程序会碰到延迟问题。参考 <a href="#Local_network_hostname_resolution">#Local network hostname resolution</a><sup>[<a href="../en/ArchWiki:Requests.html#Broken_section_links" class="mw-redirect" title="ArchWiki:Requests">断开的链接</a>：无效的部分]</sup>。</div>
<p>要临时设置主机名（直到下次重启为止），使用 <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=inetutils">inetutils</a></span> 中的 <code>hostname</code> 命令：
</p>
<pre># hostname <i>myhostname</i>
</pre>
<p>要设置清晰的主机名和其它机器数据，请参考 <code>machine-info</code> 手册页.
</p>
<h2>
<span id=".E8.AE.BE.E5.A4.87.E9.A9.B1.E5.8A.A8.E7.A8.8B.E5.BA.8F"></span><span class="mw-headline" id="设备驱动程序">设备驱动程序</span>
</h2>
<h3>
<span id=".E6.A3.80.E6.B5.8B.E9.A9.B1.E5.8A.A8.E7.8A.B6.E6.80.81"></span><span class="mw-headline" id="检测驱动状态">检测驱动状态</span>
</h3>
<p><a href="../en/Udev.html" title="Udev">Udev</a> 会探测网卡（<a href="https://en.wikipedia.org/wiki/Network_interface_controller" class="extiw" title="wikipedia:Network interface controller">NIC</a>）并在启动时自动载入必要的模块。 检查 <code>lspci -v</code> 输出中 "Ethernet controller" （或者类似的）条目，它会告诉你哪个内核模块包含了网络设备的驱动程序。例如：
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">$ lspci -v</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">02:00.0 Ethernet controller: Attansic Technology Corp. L1 Gigabit Ethernet Adapter (rev b0)
 	...
 	Kernel driver in use: atl1
 	Kernel modules: atl1
</pre>
<p>接下来， 用 <code>dmesg | grep <i>module_name</i></code> 来检查是否已经加载了驱动。例如：
</p>
<pre>$ dmesg |grep atl1
  ...
  atl1 0000:02:00.0: eth0 link is up 100 Mbps full duplex
</pre>
<p>如果驱动加载成功，就跳过下一节，否则，你需要知道您特定型号的网络设备需要哪一个模块。
</p>
<h3>
<span id=".E5.8A.A0.E8.BD.BD.E8.AE.BE.E5.A4.87.E6.A8.A1.E5.9D.97"></span><span class="mw-headline" id="加载设备模块">加载设备模块</span>
</h3>
<p>用 Google 查找芯片组需要的模块/驱动。常见的驱动模块有用于 Realtek 芯片组网卡的 <code>8139too</code>，或者用于 Sis 芯片组网卡的 <code>sis900</code>。知道要使用什么模块之后，尝试 <a href="../en/Kernel_module.html#Manual_module_handling" class="mw-redirect" title="Kernel modules">手动加载它</a>。如果你碰到了未找到模块的错误，可能驱动没有包括在 Arch 的内核中。你可以在 <a href="../en/Arch_User_Repository.html" class="mw-redirect" title="AUR">AUR</a> 中搜索模块名称。
</p>
<p>如果 udev 在引导时不能自动侦测和加载适当的模块，参见 <a href="../en/Kernel_module.html#Loading" class="mw-redirect" title="Kernel modules">Kernel modules#Loading</a><sup>[<a href="../en/ArchWiki:Requests.html#Broken_section_links" class="mw-redirect" title="ArchWiki:Requests">断开的链接</a>：无效的部分]</sup>。
</p>
<h2>
<span id=".E7.BD.91.E7.BB.9C.E6.8E.A5.E5.8F.A3_2"></span><span class="mw-headline" id="网络接口_2">网络接口</span>
</h2>
<h3>
<span id=".E8.AE.BE.E5.A4.87.E5.91.BD.E5.90.8D"></span><span class="mw-headline" id="设备命名">设备命名</span>
</h3>
<p>对于有多块网卡的电脑，固定的设备名称很重要。许多配置问题都是由于网络接口名称变化引起的。
</p>
<p><a href="../en/Udev.html" title="Udev">udev</a> 负责给设备命名。Systemd v197 引入了<a rel="nofollow" class="external text" href="https://www.freedesktop.org/wiki/Software/systemd/PredictableNetworkInterfaceNames">可预测的网络接口名称</a>自动给网络设备分配静态名称，网络接口现在是以前缀 <code>en</code>（以太网）、<code>wl</code>（WLAN）、或者 <code>ww</code>（WWAN）附上一个自动生成的标识符，产生了一个类似于 <code>enp0s25</code> 的条目。在 <a href="../en/Kernel_parameters.html" title="Kernel parameters">kernel parameters</a> 中添加 <code>net.ifnames=0</code> 可以禁用此功能.
</p>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>注意：</strong> 当你改变接口命名规则时，不要忘记更新所有与网络相关的配置文件和自定义的 systemd unit 文件以反映变化。特别是当你启用了 <a href="../en/Netctl.html#Basic_method" title="Netctl">netctl 静态配置</a><sup>[<a href="../en/ArchWiki:Requests.html#Broken_section_links" class="mw-redirect" title="ArchWiki:Requests">断开的链接</a>：无效的部分]</sup> 时，要运行 <code>netctl reenable <i>profile</i></code> 来更新生成的服务文件。</div>
<h3>
<span id=".E8.8E.B7.E5.8F.96.E5.BD.93.E5.89.8D.E7.BD.91.E7.BB.9C.E5.90.8D"></span><span class="mw-headline" id="获取当前网络名">获取当前网络名</span>
</h3>
<p>可以通过 sysfs 或 <code>ip link</code> 找到。
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">$ ls /sys/class/net</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">	
lo eth0 eth1 firewire0
</pre>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">$ ip link</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">1: lo: &lt;LOOPBACK,UP,LOWER_UP&gt; mtu 65536 qdisc noqueue state UNKNOWN mode DEFAULT group default
    link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00
2: enp0s3: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu 1500 qdisc fq_codel state UP mode DEFAULT group default qlen 1000
    link/ether 08:00:27:23:6f:3a brd ff:ff:ff:ff:ff:ff
</pre>
<p>无线设备名称也可以通过 <code>iw dev</code> 查看，请参考 <a href="../en/Network_configuration/Wireless.html#Getting_some_useful_information" class="mw-redirect" title="Wireless network configuration">Wireless network configuration#Getting some useful information</a><sup>[<a href="../en/ArchWiki:Requests.html#Broken_section_links" class="mw-redirect" title="ArchWiki:Requests">断开的链接</a>：无效的部分]</sup>.
</p>
<h4>
<span id=".E6.9B.B4.E6.94.B9.E8.AE.BE.E5.A4.87.E5.90.8D.E7.A7.B0"></span><span class="mw-headline" id="更改设备名称">更改设备名称</span>
</h4>
<p>你可以用 udev-rule 手动定义名称来更改设备名称。例如：
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/udev/rules.d/10-network.rules</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">SUBSYSTEM=="net", ACTION=="add", ATTR{address}=="aa:bb:cc:dd:ee:ff", NAME="net1"
SUBSYSTEM=="net", ACTION=="add", ATTR{address}=="ff:ee:dd:cc:bb:aa", NAME="net0"
</pre>
<p>值得注意的两点：
</p>
<ul>
<li>使用这条命令来获得每张网卡的 MAC 地址：<code>cat /sys/class/net/<b>设备名</b>/address</code>
</li>
<li>确保你的 udev 规则中使用小写的十六进制值，而不是大写。</li>
</ul>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>注意：</strong> 选择静态名称时，<b>应该避免使用形如 "eth<i>X</i>" 或 "wlan<i>X</i>" 的名称</b>，因为这可能在引导时导致内核与 udev 之间的竞争状态。相反，最好用内核默认不会使用的接口名称，例如：<code>net0</code>、<code>net1</code>、<code>wifi0</code>、<code>wifi1</code>。更多细节请查看 <a rel="nofollow" class="external text" href="https://www.freedesktop.org/wiki/Software/systemd/PredictableNetworkInterfaceNames">systemd</a> 文档。</div>
<h4>
<span id=".E4.BD.BF.E7.94.A8.E4.BC.A0.E7.BB.9F.E7.BD.91.E7.BB.9C.E5.91.BD.E5.90.8D.E8.A7.84.E5.88.99"></span><span class="mw-headline" id="使用传统网络命名规则">使用传统网络命名规则</span>
</h4>
<p>如果希望使用传统的命名方法 eth0,可以通过下面方法禁用 <a rel="nofollow" class="external text" href="https://www.freedesktop.org/wiki/Software/systemd/PredictableNetworkInterfaceNames">Predictable Network Interface Names</a>:
</p>
<ol><li>ln -s /dev/null /etc/udev/rules.d/80-net-setup-link.rules</li></ol>
<h3>
<span id=".E8.AE.BE.E5.AE.9A.E8.AE.BE.E5.A4.87.E7.9A.84_MTU_.E5.92.8C.E9.98.9F.E5.88.97.E9.95.BF.E5.BA.A6"></span><span class="mw-headline" id="设定设备的_MTU_和队列长度">设定设备的 MTU 和队列长度</span>
</h3>
<p>你可以手动定义一条 udev 规则来改变队列的 MTU（最大传输单元）和队列长度You can change the device MTU and queue length by defining manually with an udev-rule。举例来说：
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/udev/rules.d/10-network.rules</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">ACTION=="add", SUBSYSTEM=="net", KERNEL=="wl*", ATTR{mtu}="1480", ATTR{tx_queue_len}="2000"
</pre>
<h3>
<span id=".E5.90.AF.E7.94.A8.E5.92.8C.E7.A6.81.E7.94.A8.E7.BD.91.E7.BB.9C.E6.8E.A5.E5.8F.A3_2"></span><span class="mw-headline" id="启用和禁用网络接口_2">启用和禁用网络接口</span>
</h3>
<p>可以通过如下命令启用或禁用接口：
</p>
<pre># ip link set eth0 up
# ip link set eth0 down
</pre>
<p>查看结果：
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">$ ip link show dev eth0</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">2: eth0: &lt;BROADCAST,MULTICAST,PROMISC,UP,LOWER_UP&gt; mtu 1500 qdisc pfifo_fast master br0 state UP mode DEFAULT qlen 1000
...
</pre>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Note:</strong>  如果默认路由是通过 <code>eth0</code> 建立，禁用接口同时也会删除路由，再次启用也不会自动重新建立路由，要重新建立，请参考 <a href="#%E6%89%8B%E5%8A%A8%E5%88%86%E9%85%8D">#手动分配</a><sup>[<a href="../en/ArchWiki:Requests.html#Broken_section_links" class="mw-redirect" title="ArchWiki:Requests">断开的链接</a>：无效的部分]</sup>.</div>
<h2>
<span id=".E9.85.8D.E7.BD.AE_IP_.E5.9C.B0.E5.9D.80"></span><span class="mw-headline" id="配置_IP_地址">配置 IP 地址</span>
</h2>
<p>有两种配置方式：通过 <a href="https://en.wikipedia.org/wiki/Dynamic_Host_Configuration_Protocol" class="extiw" title="wikipedia:Dynamic Host Configuration Protocol">DHCP</a>，或者不变的<i>静态</i>地址。请选择一种方式，同时使用多个设置方式可能会引起冲突。
</p>
<h3>
<span id=".E5.8A.A8.E6.80.81_IP_.E5.9C.B0.E5.9D.80"></span><span class="mw-headline" id="动态_IP_地址">动态 IP 地址</span>
</h3>
<h4><span class="mw-headline" id="systemd-networkd">systemd-networkd</span></h4>
<p>一种DHCP的简单配置方法是利用systemd提供的<a href="../en/Systemd-networkd.html" title="Systemd-networkd">systemd-networkd</a>服务。参见<a href="../en/Systemd-networkd.html#Basic_DHCP_network" title="Systemd-networkd">systemd-networkd#Basic DHCP network</a><sup>[<a href="../en/ArchWiki:Requests.html#Broken_section_links" class="mw-redirect" title="ArchWiki:Requests">断开的链接</a>：无效的部分]</sup>。
</p>
<h4><span class="mw-headline" id="dhcpcd">dhcpcd</span></h4>
<p><a href="../en/Dhcpcd.html" title="Dhcpcd">dhcpcd</a> 是 Arch Linux 安装 ISO 上默认的 DHCP 客户端，功能强大，有多种客户端配置选项。启用方式请参考 <a href="../en/Dhcpcd.html#Running" title="Dhcpcd">dhcpcd#Running</a>。
</p>
<h4><span class="mw-headline" id="netctl">netctl</span></h4>
<p><a href="../en/Netctl.html" title="Netctl">netctl</a>是利用用户创建的profiles进行网络配置的CTI-based工具，如何创建profile参见<a href="../en/Netctl.html#Example_profiles" title="Netctl">netctl#Example profiles</a>，激活参见<a href="../en/Netctl.html#Basic_method" title="Netctl">netctl#Basic method</a><sup>[<a href="../en/ArchWiki:Requests.html#Broken_section_links" class="mw-redirect" title="ArchWiki:Requests">断开的链接</a>：无效的部分]</sup>。
</p>
<h3>
<span id=".E9.9D.99.E6.80.81_IP_.E5.9C.B0.E5.9D.80_2"></span><span class="mw-headline" id="静态_IP_地址_2">静态 IP 地址</span>
</h3>
<p>不管用什么方法设置静态 IP，都需要确定：
</p>
<ul>
<li>静态IP地址，</li>
<li>
<a href="https://en.wikipedia.org/wiki/Subnetwork" class="extiw" title="wikipedia:Subnetwork">子网掩码</a>，使用 <a href="https://en.wikipedia.org/wiki/CIDR_notation" class="extiw" title="wikipedia:CIDR notation">CIDR 表示法</a>
</li>
<li>
<a href="https://en.wikipedia.org/wiki/Classless_Inter-Domain_Routing#CIDR_notation" class="extiw" title="wikipedia:Classless Inter-Domain Routing">CIDR 表示法</a> 的子网掩码，例如 <code>255.255.255.0</code> 按 CIDR 表示为 <code>/24</code>
</li>
<li>
<a href="https://en.wikipedia.org/wiki/Broadcast_address" class="extiw" title="wikipedia:Broadcast address">广播地址</a>，</li>
<li>
<a href="https://en.wikipedia.org/wiki/Default_gateway" class="extiw" title="wikipedia:Default gateway">网关</a>的IP地址</li>
<li>Name server (DNS) IP addresses. See also <a href="../en/Domain_name_resolution.html" class="mw-redirect" title="Resolv.conf">resolv.conf</a>.</li>
</ul>
<p>如果你想配置一个内部网络，可以将你的 IP 设置成 192.168.*.* ，子网掩码设置成 255.255.255.0 ，广播地址设置成 192.168.*.255 。网关通常是 192.168.*.1 或者 192.168.*.254。
</p>
<div class="archwiki-template-box archwiki-template-box-warning">
<strong>Warning:</strong> 
<ul>
<li>请确保手动设置的 IP 地址不会和 DHCP 自动分配的地址冲突，参考 <a rel="nofollow" class="external text" href="http://www.raspberrypi.org/forums/viewtopic.php?f=28&amp;t=16797">这个论坛帖子</a>
</li>
<li>在不使用路由器的情况下和一台安装 Windows 的电脑分享你的网络连接，请确保两台电脑都使用静态 IP ，否则你的局域网将会有问题。</li>
</ul>
</div>
<h4><span class="mw-headline" id="netctl_2">netctl</span></h4>
<p>要创建 <a href="../en/Netctl.html" title="Netctl">netctl</a> 静态 IP 配置，设置 <code>IP=static</code> 选项以及 <code>Address</code>, <code>Gateway</code> 和 <code>DNS</code>. 参考 <a href="../en/Netctl.html#Wired" title="Netctl">netctl#Wired</a>.
</p>
<h4><span class="mw-headline" id="systemd-networkd_2">systemd-networkd</span></h4>
<p><a href="../en/Systemd-networkd.html" title="Systemd-networkd">systemd-networkd</a> 服务可以使用简单的配置文件配置静态 IP 地址，参考 <a href="../en/Systemd-networkd.html#Wired_adapter_using_a_static_IP" title="Systemd-networkd">systemd-networkd#Wired adapter using a static IP</a>.
</p>
<h4><span class="mw-headline" id="dhcpcd_2">dhcpcd</span></h4>
<p>参考 <a href="../en/Dhcpcd.html#Static_profile" title="Dhcpcd">dhcpcd#Static profile</a>.
</p>
<h4>
<span id=".E6.89.8B.E5.8A.A8.E6.8C.87.E5.AE.9A"></span><span class="mw-headline" id="手动指定">手动指定</span>
</h4>
<p>可以利用<span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=iproute2">iproute2</a></span>来手动指定静态 IP。这种方法设置的IP在重启后不会保留，因此这是一个测试连接的好方法。首先开启<a href="#Network_interfaces">network interface</a><sup>[<a href="../en/ArchWiki:Requests.html#Broken_section_links" class="mw-redirect" title="ArchWiki:Requests">断开的链接</a>：无效的部分]</sup>：
</p>
<pre> # ip link set <i>interface</i> up
</pre>
<p>在终端中指定一个静态 IP：
</p>
<pre># ip addr add <i>IP_address</i>/<i>subnet_mask</i> broadcast <i>broadcast_address</i> dev <i>interface</i>
</pre>
<p>如此添加你的网关（用你的网关 IP 替换）：
</p>
<pre># ip route add default via &lt;默认网关的 IP 地址&gt;
</pre>
<p>例如：
</p>
<pre># ip link set eth0 up
# ip addr add 192.168.1.2/24 dev eth0
# ip route add default via 192.168.1.1
</pre>
<div class="archwiki-template-box archwiki-template-box-tip">
<strong>Tip:</strong> 如果遇到 <code>RTNETLINK answers: Network is unreachable</code>错误，请将路由创建步骤拆成两步：
<pre># ip route add 192.168.1.1 dev eth0
# ip route add default via 192.168.1.1 dev eth0
</pre>
</div>
<p>要撤销设置 (例如将要切换成动态 IP 前)，先删除所有关联的 IP 地址:
</p>
<pre># ip addr flush dev <i>interface</i>
</pre>
<p>然后删除指定的网关：
</p>
<pre># ip route flush dev <i>interface</i>
</pre>
<p>最后禁用接口：
</p>
<ol><li>ip link set <i>interface</i> down</li></ol>
<p>更多选项参见：<span class="plainlinks archwiki-template-man" title="$ man 7 ip"><a rel="nofollow" class="external text" href="https://man.archlinux.org/man/ip.7">ip(7)</a></span>，这些命令可以用 systemd 服务自动启动，请参考<a href="../en/Systemd.html#Writing_unit_files" title="Systemd">systemd units</a>.
</p>
<h4>
<span id=".E8.AE.A1.E7.AE.97.E5.9C.B0.E5.9D.80"></span><span class="mw-headline" id="计算地址">计算地址</span>
</h4>
<p>可以用 <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=ipcalc">ipcalc</a></span> 软件包提供的 <code>ipcalc</code> 工具自动计算 IP 广播、子网掩码、主机范围等。例如通过火线连接视窗系统主机到 Arch。为了安全和网络组织，将它们分到独立的网络中，然后配置子网掩码和广播地址，网络中只有2台主机。要找出掩码和广播地址，我使用了 ipcalc，提供了它 arch firewire nic 的 IP 地址10.66.66.1，并告诉 ipcalc 要建立一个只有2台主机的网络。
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">$ ipcalc -nb 10.66.66.1 -s 1</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">Address:   10.66.66.1

Netmask:   255.255.255.252 = 30
Network:   10.66.66.0/30
HostMin:   10.66.66.1
HostMax:   10.66.66.2
Broadcast: 10.66.66.3
Hosts/Net: 2                     Class A, Private Internet
</pre>
<h3>
<span id="IP_.E5.9C.B0.E5.9D.80_2"></span><span class="mw-headline" id="IP_地址_2">IP 地址</span>
</h3>
<p><a href="https://en.wikipedia.org/wiki/IP_address" class="extiw" title="wikipedia:IP address">IP addresses</a>使用<span class="plainlinks archwiki-template-man" title="$ man 8 ip-address"><a rel="nofollow" class="external text" href="https://man.archlinux.org/man/ip-address.8">ip-address(8)</a></span>管理。
</p>
<p>显示 IP 地址：
</p>
<pre>$ ip address show
</pre>
<p>向某接口添加一个 IP：
</p>
<pre># ip address add <i>地址/前缀长度</i> broadcast + dev <i>interface</i>
</pre>
<dl><dd>请注意:</dd></dl>
<dl><dd><ul>
<li>地址格式是<a href="https://en.wikipedia.org/wiki/Classless_Inter-Domain_Routing#CIDR_notation" class="extiw" title="wikipedia:Classless Inter-Domain Routing">CIDR 标记</a>格式，这种格式也可以提供<a href="https://en.wikipedia.org/wiki/Subnetwork" class="extiw" title="wikipedia:Subnetwork">子网掩码</a>。</li>
<li>
<code>+</code>是一种特殊符号，使<code>ip</code>程序从 IP 地址和子网掩码获得<a href="https://en.wikipedia.org/wiki/Broadcast_address" class="extiw" title="wikipedia:Broadcast address">广播地址</a>。</li>
</ul></dd></dl>
<dl><dd><div class="archwiki-template-box archwiki-template-box-note">
<strong>Note:</strong> 确保手动分配的 IP 和 DHCP 分配的不冲突。</div></dd></dl>
<p>从某接口删除一个 IP 地址：
</p>
<pre>$ ip address del <i>地址/前缀长度</i> dev <i>interface</i>
</pre>
<p>删除所有符合某种条件的地址，例如删除特定接口下的地址：
</p>
<pre>$ ip address flush dev <i>interface</i>
</pre>
<div class="archwiki-template-box archwiki-template-box-tip">
<strong>Tip:</strong> 可以使用 <a rel="nofollow" class="external text" href="http://jodies.de/ipcalc">ipcalc</a> (<span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=ipcalc">ipcalc</a></span>) 计算 IP 地址。</div>
<h3>
<span id=".E8.B7.AF.E7.94.B1.E8.A1.A8_2"></span><span class="mw-headline" id="路由表_2">路由表</span>
</h3>
<p><a href="https://en.wikipedia.org/wiki/Routing_table" class="extiw" title="wikipedia:Routing table">routing table</a>用于决定是否能直连某个 IP 地址，或者应该使用哪个网关（路由器）进行通信。如果 IP 地址不匹配任何路由，就会走<a href="https://en.wikipedia.org/wiki/Default_gateway" class="extiw" title="wikipedia:Default gateway">默认网关</a>。
</p>
<p>路由表由<span class="plainlinks archwiki-template-man" title="$ man 8 ip-route"><a rel="nofollow" class="external text" href="https://man.archlinux.org/man/ip-route.8">ip-route(8)</a></span>管理。
</p>
<p><i>PREFIX</i>要么是 CIDR 标记，要么是<code>default</code>（默认网关）。
</p>
<p>显示路由表：
</p>
<pre>$ ip route show
</pre>
<p>添加路由：
</p>
<pre># ip route add <i>PREFIX</i> via <i>address</i> dev <i>interface</i>
</pre>
<p>删除路由：
</p>
<pre># ip route del <i>PREFIX</i> via <i>address</i> dev <i>interface</i>
</pre>
<p><br>
</p>
<h2>
<span id=".E6.9B.B4.E5.A4.9A.E8.AE.BE.E7.BD.AE"></span><span class="mw-headline" id="更多设置">更多设置</span>
</h2>
<h3>
<span id=".E7.AC.94.E8.AE.B0.E6.9C.AC.E7.94.B5.E8.84.91.E4.BD.BF.E7.94.A8_Ifplugd"></span><span class="mw-headline" id="笔记本电脑使用_Ifplugd">笔记本电脑使用 Ifplugd</span>
</h3>
<div class="archwiki-template-box archwiki-template-box-tip">
<strong>Tip:</strong> <a href="../en/Dhcpcd.html" title="Dhcpcd">dhcpcd</a> 也提供了同样的功能。</div>
<p><a href="../zh-CN/Official_repositories.html" class="mw-redirect" title="官方仓库">官方仓库</a> 中的 <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=ifplugd">ifplugd</a></span> 是一个守护进程，当网络适配器插入的时候自动配置网络，当网络断开的时候自动取消配置（比如某些3G的usb网络适配器）。这对于笔记本电脑这样的使用移动式的网络适配器的情况很有用，因为他只会在网络实际接入的时候才会配置网络接口。另外一个可能会用得着它的情况是，你需要重启你的网络，可是你既不想重启电脑也不想在 shell 中配置。
</p>
<p>在默认情况下，它会检查 <code>eth0</code> 设备。要更改这个设置（以及更改其他设置，比如等待时间），可以编辑 <code>/etc/ifplugd/ifplugd.conf</code>。
</p>
<p>启用 <code>net-auto-wired.service</code> 就会在开机时启动 ifplugd，否则，你可以使用 <code>ifplugd@eth0.service</code>。
</p>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>注意：</strong> <a href="../en/Netctl.html" title="Netctl">Netctl</a> 软件包包含了 <code>netctl-ifplugd@.service</code>，否则你可以使用 <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=ifplugd">ifplugd</a></span> 软件包中的 <code>ifplugd@.service</code>。例如 <code>systemctl enable ifplugd@eth0.service</code>。</div>
<h3>
<span id=".E7.BB.91.E5.AE.9A.E5.92.8C.E9.93.BE.E8.B7.AF.E8.81.9A.E5.90.88"></span><span class="mw-headline" id="绑定和链路聚合">绑定和链路聚合</span>
</h3>
<p>参见 <a href="../zh-CN/Netctl.html#%E7%BB%91%E5%AE%9A" title="Netctl (简体中文)">绑定</a> 或 <a href="../zh-CN/Wireless_bonding.html" class="mw-redirect" title="无线网络绑定">无线网络绑定</a>。
</p>
<h3>
<span id="IP_.E5.88.AB.E5.90.8D"></span><span class="mw-headline" id="IP_别名">IP 别名</span>
</h3>
<p>IP 别名是指给同一个网络接口分配多个 IP 地址。这样一个网络节点可以有多个网络连接，每个实现不同的作用。典型的用处是 Web 服务器和 FTP 服务器的虚拟主机，或者是重组服务器时不需要更新其他任何机器上的 IP （对于名称服务器来说很有用）。
</p>
<p>要手动设置别名，可以使用 <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=iproute2">iproute2</a></span> 执行：
</p>
<pre># ip addr add 192.168.2.101/24 dev eth0 label eth0:1
</pre>
<p>要删除别名：
</p>
<pre># ip addr del 192.168.2.101/24 dev eth0:1
</pre>
<p>发送到一个子网的软件不会使用主别名，如果目标 IP 属于子别名，原始 IP 也会被相应设置。如果有多个网卡，可以通过  <code>ip route</code> 查看默认路由。
</p>
<h3>
<span id=".E6.9B.B4.E6.94.B9_MAC.2F.E7.A1.AC.E4.BB.B6.E5.9C.B0.E5.9D.80"></span><span class="mw-headline" id="更改_MAC/硬件地址">更改 MAC/硬件地址</span>
</h3>
<p>参见 <a href="../en/MAC_address_spoofing.html" title="MAC address spoofing">伪造 MAC 地址</a>。
</p>
<h3>
<span id=".E5.85.B1.E4.BA.AB.E7.BD.91.E7.BB.9C.E8.BF.9E.E6.8E.A5"></span><span class="mw-headline" id="共享网络连接">共享网络连接</span>
</h3>
<p>参见 <a href="../en/Internet_sharing.html" title="Internet sharing">共享网络连接</a>。
</p>
<h3>
<span id=".E8.B7.AF.E7.94.B1.E9.85.8D.E7.BD.AE"></span><span class="mw-headline" id="路由配置">路由配置</span>
</h3>
<p>参见 <a href="../en/Router.html" title="Router">路由</a>。
</p>
<h3>
<span id=".E5.B1.80.E5.9F.9F.E7.BD.91.E4.B8.BB.E6.9C.BA.E7.9A.84.E5.90.8D.E7.A7.B0.E8.A7.A3.E6.9E.90"></span><span class="mw-headline" id="局域网主机的名称解析">局域网主机的名称解析</span>
</h3>
<p>首先需要设置好主机名。
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">$ ping <i>myhostname</i></pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">PING myhostname (192.168.1.2) 56(84) bytes of data.
64 bytes from myhostname (192.168.1.2): icmp_seq=1 ttl=64 time=0.043 ms</pre>
<p>如果希望其他机器通过主机名访问到这台机器，可以手动修改 <code>/etc/hosts</code> 文件或通过一个服务解析此主机名。使用 systemd 时，主机名解析可以通过 <code>myhostname</code> nss 模块提供。但是并不是所有的网络服务都被支持 (例如: <a rel="nofollow" class="external autonumber" href="https://bbs.archlinux.org/viewtopic.php?id=176761">[4]</a>, <a rel="nofollow" class="external autonumber" href="https://bbs.archlinux.org/viewtopic.php?id=186967">[5]</a>)，或者其它客户端使用不同的操作系统解析主机名，这个也无法被 systemd 支持。 
</p>
<p>第一个解决方法是修改 <code>/etc/hosts</code>:
</p>
<pre>127.0.1.1	<i>myhostname</i>.localdomain	<i>myhostname</i>	
</pre>
<p>这样系统可以同时解析两个主机名: 
</p>
<pre>$ getent hosts 
127.0.0.1       localhost
127.0.1.1       myhostname.localdomain myhostname
</pre>
<p>如果使用固定 IP 地址，请用 IP 地址替换 <code>127.0.1.1</code>. 
</p>
<p>还有一个方法是架设 DNS 服务器例如 <a href="../en/BIND.html" title="BIND">BIND</a> or <a href="../en/Unbound.html" title="Unbound">Unbound</a>, 但是这些方法有点小提大作。小的网络可以使用  <a href="https://en.wikipedia.org/wiki/Zero-configuration_networking" class="extiw" title="wikipedia:Zero-configuration networking">zero-configuration networking</a> 服务。有两个选择：
</p>
<ul><li>
<a href="../en/Samba.html" title="Samba">Samba</a> 通过 Microsoft's <b>NetBIOS</b> 提供主机名称解析。这只需要安装 <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=samba">samba</a></span> 并启用 <code>nmbd.service</code> 服务。运行 Windows、 OS X、或者运行着 <code>nmbd</code> 的 Linux，将能找到你的机器。</li></ul>
<ul><li>
<a href="../en/Avahi.html" title="Avahi">Avahi</a> 通过 <b>zeroconf</b>，提供主机名称解析, 它也被称称作 Avahi 或者 Bonjour。这需要比 Samba 再稍微复杂一点的配置：详细信息参见 <a href="../en/Avahi.html#Hostname_resolution" title="Avahi">Avahi#Hostname resolution</a>。运行 OS X 的电脑，或者运行着 Avahi 守护进程的 Linux，将能找到你的机器。Windows 没有内置的 Avahi 客户端或者守护进程。</li></ul>
<h3>
<span id=".E5.85.A8.E6.8E.A5.E6.94.B6.E6.A8.A1.E5.BC.8F"></span><span class="mw-headline" id="全接收模式">全接收模式</span>
</h3>
<p>切换网卡到 <a href="https://en.wikipedia.org/wiki/Promiscuous_mode" class="extiw" title="wikipedia:Promiscuous mode">全接收模式</a> 可以让网卡接收所有数据然后转交给操作系统处理。而正常模式下，网卡会丢掉不是不发给自己的数据。通常用来检查网络问题或进行 <a href="https://en.wikipedia.org/wiki/Packet_sniffing" class="extiw" title="wikipedia:Packet sniffing">数据包嗅探</a>.
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/systemd/system/promiscuous@.service</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">[Unit]
Description=Set %i interface in promiscuous mode
After=network.target

[Service]
Type=oneshot
ExecStart=/usr/bin/ip link set dev %i promisc on
RemainAfterExit=yes

[Install]
WantedBy=multi-user.target
</pre>
<p>如果要在 <code>eth0</code> 上启用全接收模式，只需要 <a href="../en/Systemd.html#Using_units" class="mw-redirect" title="Enable">启用</a> <code>promiscuous@eth0.service</code>.
</p>
<h2>
<span id=".E7.96.91.E9.9A.BE.E6.8E.92.E8.A7.A3"></span><span class="mw-headline" id="疑难排解">疑难排解</span>
</h2>
<h3>
<span id=".E6.9B.B4.E6.8D.A2.E4.BA.86.E8.BF.9E.E6.8E.A5cable_modem.E7.9A.84.E8.AE.A1.E7.AE.97.E6.9C.BA"></span><span class="mw-headline" id="更换了连接cable_modem的计算机">更换了连接cable modem的计算机</span>
</h3>
<p>许多家庭有线电视的运营商（例如加拿大最大的有线电视公司Videotron,还有中国大陆的有线电视宽带公司）都使用记录网卡MAC地址的方法将cable modem配置为只能一台计算机使用。一旦cable modem获得第一台连接它的PC的MAC地址，就不会响应任何其它MAC地址。这样如果你换了台PC（或者路由器），由于新PC（或者路由器）的MAC地址和旧的不同，就没法连接cable modem了。这时候必须复位cable modem以使它重新辨认新的PC。 你得关闭cable modem电源，然后重新打开。一旦cable modem重启并再次登录在线完毕（指示灯熄灭），重启新连接的PC以使它发起一个DHCP请求，或者手动发起DHCP请求。
</p>
<p>如果这个方法不能奏效，你需要克隆原来机器上的MAC地址。参见 <a href="../en/Network_configuration.html#Change_MAC/hardware_address" class="mw-redirect" title="Configuring Network">Change MAC/hardware address</a><sup>[<a href="../en/ArchWiki:Requests.html#Broken_section_links" class="mw-redirect" title="ArchWiki:Requests">断开的链接</a>：无效的部分]</sup>。
</p>
<h3>
<span id="TCP.E7.AA.97.E5.8F.A3.E6.89.A9.E7.BC.A9.EF.BC.88window_scaling.EF.BC.89.E6.95.85.E9.9A.9C"></span><span class="mw-headline" id="TCP窗口扩缩（window_scaling）故障">TCP窗口扩缩（window scaling）故障</span>
</h3>
<p>TCP包头有个窗口（window）值表明其它主机可以发送多少数据回来。这个值只有16个bit，也就是说窗口打消最多只有64Kb。TCP包会被缓存一段时间（得被记录），如果内存限制（过去经常是）的话，主机很容易会用完内存。
</p>
<p>回到1992年，内存逐渐增加，<a rel="nofollow" class="external text" href="http://www.faqs.org/rfcs/rfc1323.html">RFC 1323</a>被发布以改善情况:窗口扩缩(Window Scaling)。所有包里的窗口值，可以被初始连接时定义的一个缩放因子（Scale Factor）所改变。
</p>
<p>8-bit的缩放因子使得窗口可以是初始64Kb的32倍。
</p>
<p>但是Internet上有些有故障的路由器和防火墙会将缩放因子重写为0,这导致主机之间产生误解。
</p>
<p>Linux内核2.6.17引入了新的计算方式生成更高的缩放因子，间接的使得这些有故障的路由器和防火墙引发的后果更明显。
</p>
<p>这导致连接缓慢甚至中断。
</p>
<h4>
<span id=".E5.A6.82.E4.BD.95.E8.AF.8A.E6.96.AD.E6.95.85.E9.9A.9C"></span><span class="mw-headline" id="如何诊断故障">如何诊断故障</span>
</h4>
<p>首先，我们要明白：这个问题很怪异。在某些案例中，你根本无法使用(HTTP, FTP, ...)，而有时候，你可以连接某些主机（很少）。
</p>
<p>当你碰到这个故障时，<code>dmesg</code>的输出正确，日志也没问题，<code>ip a</code>报告状态正常— 实际上一切都正常。
</p>
<p>如果你无法浏览任何网站，不过你能ping通少部分主机，很可能你是遇到了这个问题。：ping使用ICMP协议所以不受TCP问题的影响。
</p>
<p>你可以尝试使用WireShark。你也许会看到UDP和ICMP通讯成功，但是TCP通讯不成功（仅对外国主机）。
</p>
<h4>
<span id=".E5.A6.82.E4.BD.95.E4.BF.AE.E5.A4.8D.EF.BC.88.E7.B3.9F.E7.B3.95.E7.9A.84.E6.96.B9.E6.B3.95.EF.BC.89"></span><span class="mw-headline" id="如何修复（糟糕的方法）">如何修复（糟糕的方法）</span>
</h4>
<p>用比较糟糕的方法修复的话，你可以修改缩放因子计算所基于的tcp_rmem值。虽然它对大部分主机有效，但并不担保一定都有效，特别是某些很远的主机。
</p>
<pre># echo "4096 87380 174760" &gt; /proc/sys/net/ipv4/tcp_rmem
</pre>
<h4>
<span id=".E5.A6.82.E4.BD.95.E4.BF.AE.E5.A4.8D.EF.BC.88.E5.A5.BD.E7.82.B9.E7.9A.84.E6.96.B9.E6.B3.95.EF.BC.89"></span><span class="mw-headline" id="如何修复（好点的方法）">如何修复（好点的方法）</span>
</h4>
<p>只需要禁止窗口缩放。虽然窗口缩放是个不错的TCP特性，但它也可能令人不安，特别是当你没法修改除了问题的路由器的时候。有几种方法可以禁止窗口缩放，而看来最可靠的（适用于大部分内核）将下面一行加入到你的<code>/etc/sysctl.d/99-disable_window_scaling.conf</code> 中 （见 <a href="../en/Sysctl.html" title="Sysctl">sysctl</a>）
</p>
<pre>net.ipv4.tcp_window_scaling = 0
</pre>
<h4>
<span id=".E5.A6.82.E4.BD.95.E4.BF.AE.E5.A4.8D.EF.BC.88.E6.9C.80.E4.BD.B3.E7.9A.84.E6.96.B9.E6.B3.95.EF.BC.89"></span><span class="mw-headline" id="如何修复（最佳的方法）">如何修复（最佳的方法）</span>
</h4>
<p>这个故障是由有毛病的路由器/防火墙引致的，所以最好换了它。有些用户报告说那些有故障的路由是他们自己的DSL路由。
</p>
<h4>
<span id=".E6.9B.B4.E5.A4.9A"></span><span class="mw-headline" id="更多">更多</span>
</h4>
<p>本段内容是基于LWN文章<a rel="nofollow" class="external text" href="http://lwn.net/Articles/92727/">TCP window scaling and broken routers</a>和一个Kernel Trap 文章：<a rel="nofollow" class="external text" href="http://kerneltrap.org/node/6723">Window Scaling on the Internet</a><sup title="最后检查状态：domain name not resolved">[<a href="https://en.wikipedia.org/wiki/Wikipedia:Link_rot" class="extiw" title="wikipedia:Wikipedia:Link rot">失效链接</a> 2020-08-04 ⓘ]</sup>。
</p>
<p>在LKML上也有几篇相关的帖子。
</p>
<h3>
<span id="Realtek_.E6.B2.A1.E6.9C.89.E8.BF.9E.E6.8E.A5.2F.E7.BD.91.E7.BB.9C.E5.94.A4.E9.86.92.E6.95.85.E9.9A.9C"></span><span class="mw-headline" id="Realtek_没有连接/网络唤醒故障">Realtek 没有连接/网络唤醒故障</span>
</h3>
<p>使用基于Realtek 8168 8169 8101 8111芯片网卡（独立网卡和板载）的用户也许会发现这个故障，启动时网卡不可用，网卡上的连接指示灯不亮。这通常会发生在安装了Windows的双启动系统上。在windows下使用realtek官方驱动（2007年5月后的版本）会引发故障。新驱动通过在Windows关机时禁止网卡来关闭网络唤醒功能，直到下一次Windows启动前网卡都会一直不可用。通过观察连接指示灯在Windows启动前一直熄灭，而Windows关机时也会熄灭，你可以发现它。正常操作应该是只要系统一直开着，即使在POST加电过程中，连接指示灯也应该一直亮着的。这个故障也会影响其它没有安装新驱动的操作系统（例如Live CD等）。这里给出几种解决方案：
</p>
<h4>
<span id=".E5.9C.A8_Linux_.E4.B8.AD.E5.90.AF.E7.94.A8.E7.BD.91.E5.8D.A1"></span><span class="mw-headline" id="在_Linux_中启用网卡">在 Linux 中启用网卡</span>
</h4>
<p>参考上面的启用和禁用网络接口段落。
</p>
<h4>
<span id=".E6.96.B9.E6.B3.95.E4.B8.80_.E8.BF.98.E5.8E.9F.2F.E5.8F.98.E6.9B.B4Win.E9.A9.B1.E5.8A.A8"></span><span class="mw-headline" id="方法一_还原/变更Win驱动">方法一 还原/变更Win驱动</span>
</h4>
<p>你可以将你的Windows网卡驱动还原回Microsoft自带的驱动（如果有的话），或者安装2007年5月份以前的Realtek官方驱动（也许在网卡附带的CD上）。
</p>
<h4>
<span id=".E6.96.B9.E6.B3.95.E4.BA.8C_.E5.90.AF.E5.8A.A8Windows.E9.A9.B1.E5.8A.A8.E9.87.8C.E7.9A.84.E7.BD.91.E7.BB.9C.E5.94.A4.E9.86.92.E5.8A.9F.E8.83.BD"></span><span class="mw-headline" id="方法二_启动Windows驱动里的网络唤醒功能">方法二 启动Windows驱动里的网络唤醒功能</span>
</h4>
<p>也许最好最快的修复方法就是改变Windows驱动里的这个设置。这个方法可以解决很多其它操作系统而不仅仅是Arch的麻烦。在Windows的设备管理器里，找到你的Realtek网卡，双击它。在“高级”标签页中，开启"wake-on-lan after shutdown"选项。
</p>
<pre> 例如在Windows XP里
 右键点击我的电脑--&gt;管理--&gt;设备管理器--&gt;网络适配器--&gt;双击 Realtek ... --&gt; 高级标签页--&gt; Wake-On-Lan After Shutdown --&gt; 启用。
</pre>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>注意：</strong> 新的 Realtek Windows 驱动程序中（已测试了 2009/01/22 GIGABYTE 上的 <i>Realtek 8111/8169 LAN Driver v5.708.1030.2008</i>）可能与这里的选项稍微有点不同，像 <i>Shutdown Wake-On-LAN --&gt; Enable</i>。似乎把它切换成 <code>Disable</code> 没有效果（你仍然可以在Windows关闭时看到连接指示灯熄灭）。一个比较不好的解决方法是引导 Windows，然后立即重启系统（执行非正常重启/关机），不给予 Windows 驱动程序关闭 LAN 的机会。连接指示灯将会保持亮着，网卡也会在 POST 之后保持可用 - 直到你再次进入 Windows 并正常关机。</div>
<h4>
<span id=".E6.96.B9.E6.B3.95.E4.B8.89_.E6.9B.B4.E6.96.B0Realtek_Linux.E9.A9.B1.E5.8A.A8"></span><span class="mw-headline" id="方法三_更新Realtek_Linux驱动">方法三 更新Realtek Linux驱动</span>
</h4>
<p>可以在realtek的官方网页上找到新的Linux驱动。(没有测试过，不过相信也能解决问题）。
</p>
<h4>
<span id=".E6.96.B9.E6.B3.95.E5.9B.9B_.E5.9C.A8_BIOS.2FCMOS_.E4.B8.AD.E5.90.AF.E7.94.A8_LAN_Boot_ROM"></span><span class="mw-headline" id="方法四_在_BIOS/CMOS_中启用_LAN_Boot_ROM">方法四 在 BIOS/CMOS 中启用 <i>LAN Boot ROM</i></span>
</h4>
<p>尽管 Windows 驱动程序在系统关闭时禁用了它，但在 BIOS/CMOS 中设置 <i>Integrated Peripherals --&gt; Onboard LAN Boot ROM --&gt; Enabled</i>，系统启动时会重新激活 Realtek LAN 芯片。
</p>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>注意：</strong> 这个方法多次在 GIGABYTE GA-G31M-ES2L 主板，2009/02/05 发布的 BIOS 版本 F8 上测试成功。YMMV。</div>
<h3>
<span id=".E6.A3.80.E6.9F.A5_DHCP_.E9.97.AE.E9.A2.98.E5.85.88.E9.87.8A.E6.94.BE_IP_.E5.9C.B0.E5.9D.80"></span><span class="mw-headline" id="检查_DHCP_问题先释放_IP_地址">检查 DHCP 问题先释放 IP 地址</span>
</h3>
<p>当 DHCP 获得了错误的 IP 分配就可能产生这个问题。举例来说，当两个路由器通过VPN相连，通过VPN与我相连的路由器可能分配IP地址。要修复这个问题，在终端中以 root 权限释放 IP 地址：
</p>
<pre># dhcpcd -k
</pre>
<p>然后请求一个新的地址：
</p>
<pre># dhcpcd
</pre>
<p>可能你必须运行这两个命令好几次。
</p>
<h3>
<span id="Atheros_.E8.8A.AF.E7.89.87.E7.BB.84.E6.89.BE.E4.B8.8D.E5.88.B0.E7.BD.91.E5.8D.A1"></span><span class="mw-headline" id="Atheros_芯片组找不到网卡">Atheros 芯片组找不到网卡</span>
</h3>
<p>有些用户的 Atheros 芯片无法正常工作 (至少在 2014.2 月的安装中). 可以通过安装 <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://aur.archlinux.org/packages/backports-patched/">backports-patched</a></span><sup><small>AUR</small></sup> 解决。
</p>
<h3><span class="mw-headline" id="Broadcom_BCM57780">Broadcom BCM57780</span></h3>
<p>这个 Broadcom 芯片只有你指定模块的加载顺序后才能正常工作。这些模块是 <code>broadcom</code> 和 <code>tg3</code>，前者需要首先加载。
</p>
<p>如果你的电脑有这个芯片，这些步骤应该有用：
</p>
<pre>$ lspci | grep Ethernet
02:00.0 Ethernet controller: Broadcom Corporation NetLink BCM57780 Gigabit Ethernet PCIe (rev 01)
</pre>
<p>如果你的有线网络不能工作，尝试断开网线，然后以 root 权限实施以下步骤：
</p>
<pre># modprobe -r tg3
# modprobe broadcom
# modprobe tg3
</pre>
<p>现在接入网线。如果现在你的故障解决了，你可以把 <code>broadcom</code> 和 <code>tg3</code> （以此顺序）加入到 <code>/etc/mkinitcpio.conf</code> 的 <code>MODULES</code> 一行，使得变更持久化：
</p>
<pre>MODULES=".. broadcom tg3 .."
</pre>
<p>然后重新编译 initramfs:
</p>
<pre># mkinitcpio -p linux
</pre>
<ul><li>还有一种方法是创建 <code>/etc/modprobe.d/broadcom.conf</code>:</li></ul>
<pre> softdep tg3 pre: broadcom
</pre>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>注意：</strong> 这些方法可能也适用于其它芯片，例如 BCM57760。</div>
<h3>
<span id="Realtek_RTL8111.2F8168B"></span><span class="mw-headline" id="Realtek_RTL8111/8168B">Realtek RTL8111/8168B</span>
</h3>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;"># lspci | grep Ethernet</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">03:00.0 Ethernet controller: Realtek Semiconductor Co., Ltd. RTL8111/8168B PCI Express Gigabit Ethernet controller (rev 02)
</pre>
<p>The adapter should be recognized by the <code>r8169</code> module. However, with some chip revisions the connection may go off and on all the time. The alternative <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=r8168">r8168</a></span> can be found in the <a href="../en/Official_repositories.html" title="Official repositories">official repositories</a> and should be used for a reliable connection in this case. <a href="../en/Kernel_module.html#Blacklisting" class="mw-redirect" title="Kernel modules">Blacklist</a> <code>r8169</code>, if <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=r8168">r8168</a></span> is not automatically loaded by <a href="../en/Udev.html" title="Udev">udev</a>，see <a href="../en/Kernel_module.html#Automatic_module_handling" class="mw-redirect" title="Kernel modules">Kernel modules#Automatic module handling</a><sup>[<a href="../en/ArchWiki:Requests.html#Broken_section_links" class="mw-redirect" title="ArchWiki:Requests">断开的链接</a>：无效的部分]</sup>。
</p>
<div class="noprint archwiki-template-message">
<p><a href="../File:Tango-inaccurate.png" class="image"><img alt="Tango-inaccurate.png" src="../File:Tango-inaccurate.png" decoding="async" width="48" height="48"></a><b>The factual accuracy of this article or section is disputed.</b><a href="../File:Tango-inaccurate.png" class="image"><img alt="Tango-inaccurate.png" src="../File:Tango-inaccurate.png" decoding="async" width="48" height="48"></a></p>
<div>
<b>Reason:</b> "some revisions", no proof the driver is the cause, and not e.g poorly configured DNS servers (Discuss in <a rel="nofollow" class="external text" href="https://wiki.archlinux.org/index.php/Talk:Network_configuration_(%E7%AE%80%E4%BD%93%E4%B8%AD%E6%96%87)">Talk:Network configuration (简体中文)#</a>)</div>
</div>
<p>Another fault in the drivers for some revisions of this adapter is poor IPv6 support. <a href="../en/IPv6.html#Disable_functionality" title="IPv6">IPv6#Disable functionality</a> can be helpful if you encounter issues such as hanging webpages and slow speeds.
</p>
<h3>
<span id="Gigabyte_Motherboard_with_Realtek_8111.2F8168.2F8411"></span><span class="mw-headline" id="Gigabyte_Motherboard_with_Realtek_8111/8168/8411">Gigabyte Motherboard with Realtek 8111/8168/8411</span>
</h3>
<p>With motherboards such as the Gigabyte GA-990FXA-UD3, booting with IOMMU off (which can be the default) will cause the network interface to be unreliable, often failing to connect or connecting but allowing no throughput. This will apply not only to the onboard NIC, but any other pci-NIC you put in the box because the IOMMU setting affects the entire network interface on the board. Enabling IOMMU and booting with the install media will throw AMD I-10/xhci page faults for a second, but then boot normally, resulting in a fully functional onboard NIC (even with the r8169 module).
</p>
<p>When configuring the boot process for your installation, add <code>iommu=soft</code> as a <a href="../en/Kernel_parameters.html" class="mw-redirect" title="Kernel parameter">kernel parameter</a> to eliminate the error messages on boot and restore USB3.0 functionality.
</p>
</div>
</div>
<div id="catlinks" class="catlinks" data-mw="interface">
<div id="mw-normal-catlinks" class="mw-normal-catlinks">
<a href="../Special:Categories.html" title="Special:Categories">Category</a>: <ul><li><a href="../zh-CN/Category:Networking.html" title="Category:Networking (简体中文)">Networking (简体中文)</a></li></ul>
</div>
<div id="mw-hidden-catlinks" class="mw-hidden-catlinks mw-hidden-cats-hidden">Hidden categories: <ul>
<li><a href="../en/Category:Pages_or_sections_flagged_with_Template:Expansion.html" title="Category:Pages or sections flagged with Template:Expansion">Pages or sections flagged with Template:Expansion</a></li>
<li><a href="../en/Category:Pages_with_broken_section_links.html" title="Category:Pages with broken section links">Pages with broken section links</a></li>
<li><a href="../en/Category:Pages_with_dead_links.html" title="Category:Pages with dead links">Pages with dead links</a></li>
<li><a href="../en/Category:Pages_or_sections_flagged_with_Template:Accuracy.html" title="Category:Pages or sections flagged with Template:Accuracy">Pages or sections flagged with Template:Accuracy</a></li>
</ul>
</div>
</div>
	</div>
</div>

<footer id="footer" class="mw-footer" role="contentinfo" style="margin: 0">
	<ul id="footer-info">
		<li>Retrieved from "<a dir="ltr" href="https://wiki.archlinux.org/index.php?title=Network_configuration_(%E7%AE%80%E4%BD%93%E4%B8%AD%E6%96%87)&amp;oldid=646955">https://wiki.archlinux.org/index.php?title=Network_configuration_(简体中文)&amp;oldid=646955</a>"</li>
		<li id="footer-info-lastmod"> This page was last edited on 26 December 2020, at 12:18.</li>
		<li id="footer-info-copyright">Content is available under <a class="external" rel="nofollow" href="http://www.gnu.org/copyleft/fdl.html">GNU Free Documentation License 1.3 or later</a> unless otherwise noted.</li>
	<br>
</ul>
	<ul id="footer-places">
		<li id="footer-places-privacy"><a href="../en/ArchWiki:Privacy_policy.html" title="ArchWiki:Privacy policy">Privacy policy</a></li>
		<li id="footer-places-about"><a href="../en/ArchWiki:About.html" title="ArchWiki:About">About ArchWiki</a></li>
		<li id="footer-places-disclaimer"><a href="../en/ArchWiki:General_disclaimer.html" title="ArchWiki:General disclaimer">Disclaimers</a></li>
	</ul>
	<ul id="footer-icons" class="noprint">
		<li id="footer-copyrightico">
	</ul>
	<div style="clear: both;"></div>
</footer>



</body>
</html>
