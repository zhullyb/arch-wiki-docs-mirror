<!DOCTYPE html>
<html class="client-nojs" lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<title>TigerVNC (简体中文) - ArchWiki</title>
<link rel="stylesheet" href="../ArchWikiOffline.css">
<meta name="ResourceLoaderDynamicStyles" content="">
<meta name="generator" content="MediaWiki 1.35.0">
<meta name="referrer" content="no-referrer-when-downgrade">
<meta name="robots" content="noindex,follow">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="shortcut icon" href="/favicon.ico">
<link rel="search" type="application/opensearchdescription+xml" href="/opensearch_desc.php" title="ArchWiki (en)">
<link rel="EditURI" type="application/rsd+xml" href="https://wiki.archlinux.org/api.php?action=rsd">
<link rel="license" href="http://www.gnu.org/copyleft/fdl.html">
<link rel="alternate" type="application/atom+xml" title="ArchWiki Atom feed" href="/index.php?title=Special:RecentChanges&amp;feed=atom">
</head>
<body class="mediawiki ltr sitedir-ltr mw-hide-empty-elt ns-0 ns-subject page-TigerVNC_简体中文 rootpage-TigerVNC_简体中文 skin-vector action-view skin-vector-legacy">
<div id="content" class="mw-body" role="main" style="margin: 0">
	<a id="top"></a>
	<div id="siteNotice" class="mw-body-content"></div>
	<div class="mw-indicators mw-body-content">
	</div>
	<h1 id="firstHeading" class="firstHeading" lang="en">TigerVNC (简体中文)</h1>
	<div id="bodyContent" class="mw-body-content">
		<div id="siteSub" class="noprint">From ArchWiki</div>
		<div id="contentSub"></div>
		<div id="contentSub2"></div>
		
		<div id="jump-to-nav"></div>
		<a class="mw-jump-link" href="#mw-head">Jump to navigation</a>
		<a class="mw-jump-link" href="#searchInput">Jump to search</a>
		<div id="mw-content-text" lang="en" dir="ltr" class="mw-content-ltr">
<div class="warningbox">The printable version is no longer supported and may have rendering errors. Please update your browser bookmarks and please use the default browser print function instead.</div>
<div class="mw-parser-output">
<div class="archwiki-template-box archwiki-template-box-note">
<strong>翻译状态：</strong>本文是 <a href="/title/TigerVNC" title="TigerVNC">TigerVNC</a> 的<a href="/title/ArchWiki:Translation_Team_(%E7%AE%80%E4%BD%93%E4%B8%AD%E6%96%87)" title="ArchWiki:Translation Team (简体中文)">翻译</a>。上次翻译日期：2014-10-06。如果英文版本有所<a rel="nofollow" class="external text" href="https://wiki.archlinux.org/index.php?title=TigerVNC&amp;diff=0&amp;oldid=337318">更改</a>，则您可以帮助同步翻译。</div>
<div class="noprint archwiki-template-message">
<p><a href="/title/File:Tango-preferences-desktop-locale.png" class="image"><img alt="Tango-preferences-desktop-locale.png" src="../File:Tango-preferences-desktop-locale.png" decoding="async" width="48" height="48"></a><b>本文或本节需要<a href="/title/ArchWiki:Contributing_(%E7%AE%80%E4%BD%93%E4%B8%AD%E6%96%87)#%E7%BF%BB%E8%AF%91" title="ArchWiki:Contributing (简体中文)">翻译</a>。要贡献翻译，请访问<a href="/title/ArchWiki_Translation_Team_(%E7%AE%80%E4%BD%93%E4%B8%AD%E6%96%87)" class="mw-redirect" title="ArchWiki Translation Team (简体中文)">简体中文翻译团队</a>。</b><a href="/title/File:Tango-preferences-desktop-locale.png" class="image"><img alt="Tango-preferences-desktop-locale.png" src="../File:Tango-preferences-desktop-locale.png" decoding="async" width="48" height="48"></a></p>
<div>
<b>附注：</b> 翻译过时（在 <a rel="nofollow" class="external text" href="https://wiki.archlinux.org/title/Talk:TigerVNC_(%E7%AE%80%E4%BD%93%E4%B8%AD%E6%96%87)">Talk:TigerVNC (简体中文)#</a> 中讨论）</div>
</div>
<div class="archwiki-template-meta-related-articles-start">
<p>Related articles</p>
<ul>
<li><a href="/title/X11vnc" title="X11vnc">x11vnc</a></li>
</ul>
</div>
<p><a rel="nofollow" class="external text" href="https://tigervnc.org/">TigerVNC</a> 是<a href="https://en.wikipedia.org/wiki/Virtual_Network_Computing" class="extiw" title="wikipedia:Virtual Network Computing">Virtual Network Computing</a> (VNC) 的一种实现。它向用户提供一些远程功能，包括：
</p>
<ol>
<li>直接控制本地 X 会话。</li>
<li>在一台机器上的后台并行 X 会话，即并不显示在物理显示器上而是虚拟显示器。即使用户断开连接，在服务器上运行的所有程序依旧可以运行。</li>
</ol>
<p>此文章着重于对<b>服务端</b>的功能的讲解上。
</p>
<div id="toc" class="toc" role="navigation" aria-labelledby="mw-toc-heading">
<input type="checkbox" role="button" id="toctogglecheckbox" class="toctogglecheckbox" style="display:none"><div class="toctitle" lang="en" dir="ltr">
<h2 id="mw-toc-heading">Contents</h2>
<span class="toctogglespan"><label class="toctogglelabel" for="toctogglecheckbox"></label></span>
</div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#%E5%AE%89%E8%A3%85"><span class="tocnumber">1</span> <span class="toctext">安装</span></a></li>
<li class="toclevel-1 tocsection-2">
<a href="#%E4%B8%BA%E8%99%9A%E6%8B%9F%EF%BC%88%E6%97%A0%E7%95%8C%E9%9D%A2%EF%BC%89%E4%BC%9A%E8%AF%9D%E8%BF%90%E8%A1%8C_vncserver"><span class="tocnumber">2</span> <span class="toctext">为虚拟（无界面）会话运行 vncserver</span></a>
<ul>
<li class="toclevel-2 tocsection-3">
<a href="#%E5%88%9D%E6%AC%A1%E8%AE%BE%E7%BD%AE"><span class="tocnumber">2.1</span> <span class="toctext">初次设置</span></a>
<ul>
<li class="toclevel-3 tocsection-4"><a href="#%E6%9D%83%E9%99%90"><span class="tocnumber">2.1.1</span> <span class="toctext">权限</span></a></li>
</ul>
</li>
<li class="toclevel-2 tocsection-5"><a href="#%E5%90%AF%E5%8A%A8%E4%B8%8E%E5%81%9C%E6%AD%A2tigervnc"><span class="tocnumber">2.2</span> <span class="toctext">启动与停止tigervnc</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-6">
<a href="#%E5%9C%A8%E7%89%A9%E7%90%86%E6%98%BE%E7%A4%BA%E5%99%A8%E4%B8%8A%EF%BC%885900%E7%AB%AF%E5%8F%A3%EF%BC%89%E8%BF%90%E8%A1%8CVNC%E6%9C%8D%E5%8A%A1"><span class="tocnumber">3</span> <span class="toctext">在物理显示器上（5900端口）运行VNC服务</span></a>
<ul>
<li class="toclevel-2 tocsection-7"><a href="#%E4%BD%BF%E7%94%A8_TigerVNC_%E7%9A%84_x0vncserver_%EF%BC%88%E6%8E%A8%E8%8D%90%EF%BC%89"><span class="tocnumber">3.1</span> <span class="toctext">使用 TigerVNC 的 x0vncserver （推荐）</span></a></li>
<li class="toclevel-2 tocsection-8"><a href="#%E4%BD%BF%E7%94%A8_x11vnc_%EF%BC%88%E6%8E%A8%E8%8D%90%EF%BC%89"><span class="tocnumber">3.2</span> <span class="toctext">使用 x11vnc （推荐）</span></a></li>
<li class="toclevel-2 tocsection-9">
<a href="#%E4%BD%BF%E7%94%A8%E4%B8%80%E4%B8%AA_dirty_hack_%EF%BC%88%E4%B8%8D%E6%8E%A8%E8%8D%90%EF%BC%89"><span class="tocnumber">3.3</span> <span class="toctext">使用一个 dirty hack （不推荐）</span></a>
<ul>
<li class="toclevel-3 tocsection-10"><a href="#%E5%9F%BA%E6%9C%AC%E8%AE%BE%E7%BD%AE"><span class="tocnumber">3.3.1</span> <span class="toctext">基本设置</span></a></li>
<li class="toclevel-3 tocsection-11"><a href="#%E7%BB%99_xorg-server_%E6%89%93%E8%A1%A5%E4%B8%81"><span class="tocnumber">3.3.2</span> <span class="toctext">给 xorg-server 打补丁</span></a></li>
</ul>
</li>
</ul>
</li>
<li class="toclevel-1 tocsection-12">
<a href="#%E8%BF%9E%E6%8E%A5_VNC_%E6%9C%8D%E5%8A%A1"><span class="tocnumber">4</span> <span class="toctext">连接 VNC 服务</span></a>
<ul>
<li class="toclevel-2 tocsection-13"><a href="#%E6%97%A0%E5%AF%86%E7%A0%81%E9%AA%8C%E8%AF%81"><span class="tocnumber">4.1</span> <span class="toctext">无密码验证</span></a></li>
<li class="toclevel-2 tocsection-14"><a href="#%E5%9B%BE%E5%BD%A2%E7%95%8C%E9%9D%A2%E5%AE%A2%E6%88%B7%E7%AB%AF%E7%A4%BA%E4%BE%8B"><span class="tocnumber">4.2</span> <span class="toctext">图形界面客户端示例</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-15">
<a href="#%E4%BD%BF%E7%94%A8_SSH_%E9%9A%A7%E9%81%93%E5%8A%A0%E5%AF%86_VNC_%E6%9C%8D%E5%8A%A1"><span class="tocnumber">5</span> <span class="toctext">使用 SSH 隧道加密 VNC 服务</span></a>
<ul>
<li class="toclevel-2 tocsection-16"><a href="#%E6%9C%8D%E5%8A%A1%E7%AB%AF%E9%85%8D%E7%BD%AE"><span class="tocnumber">5.1</span> <span class="toctext">服务端配置</span></a></li>
<li class="toclevel-2 tocsection-17"><a href="#%E5%AE%A2%E6%88%B7%E7%AB%AF%E9%85%8D%E7%BD%AE"><span class="tocnumber">5.2</span> <span class="toctext">客户端配置</span></a></li>
<li class="toclevel-2 tocsection-18"><a href="#%E5%9C%A8_Android_%E8%AE%BE%E5%A4%87%E4%B8%8A%E9%80%9A%E8%BF%87_SSH_%E8%BF%9E%E6%8E%A5_VNC_%E6%9C%8D%E5%8A%A1%E5%99%A8"><span class="tocnumber">5.3</span> <span class="toctext">在 Android 设备上通过 SSH 连接 VNC 服务器</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-19">
<a href="#%E6%8F%90%E7%A4%BA%E5%92%8C%E6%8A%80%E5%B7%A7"><span class="tocnumber">6</span> <span class="toctext">提示和技巧</span></a>
<ul>
<li class="toclevel-2 tocsection-20"><a href="#%E5%9C%A8%E5%BC%80%E5%85%B3%E6%9C%BA%E6%97%B6%E5%90%AF%E5%8A%A8%E5%85%B3%E9%97%AD_VNC_%E6%9C%8D%E5%8A%A1"><span class="tocnumber">6.1</span> <span class="toctext">在开关机时启动关闭 VNC 服务</span></a></li>
<li class="toclevel-2 tocsection-21"><a href="#%E5%A4%8D%E5%88%B6%E8%BF%9C%E7%A8%8B%E6%9C%BA%E5%99%A8%E5%89%AA%E8%B4%B4%E6%9D%BF%E5%86%85%E5%AE%B9%E5%88%B0%E6%9C%AC%E5%9C%B0"><span class="tocnumber">6.2</span> <span class="toctext">复制远程机器剪贴板内容到本地</span></a></li>
<li class="toclevel-2 tocsection-22"><a href="#%E8%A7%A3%E5%86%B3%E6%97%A0%E5%85%89%E6%A0%87%E9%97%AE%E9%A2%98"><span class="tocnumber">6.3</span> <span class="toctext">解决无光标问题</span></a></li>
<li class="toclevel-2 tocsection-23"><a href="#%E8%BF%9E%E6%8E%A5%E5%88%B0_OS_X%EF%BC%88Mac%EF%BC%89%E7%B3%BB%E7%BB%9F"><span class="tocnumber">6.4</span> <span class="toctext">连接到 OS X（Mac）系统</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-24"><a href="#%E4%B8%AD%E6%96%87%E5%8E%9F%E5%86%85%E5%AE%B9"><span class="tocnumber">7</span> <span class="toctext">中文原内容</span></a></li>
<li class="toclevel-1 tocsection-25"><a href="#%E5%8F%A6%E5%A4%96%E5%8F%82%E8%A7%81"><span class="tocnumber">8</span> <span class="toctext">另外参见</span></a></li>
</ul>
</div>

<h2>
<span id=".E5.AE.89.E8.A3.85"></span><span class="mw-headline" id="安装">安装</span>
</h2>
<p>VNC 服务由 <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=tigervnc">tigervnc</a></span> 提供，在 <a href="/title/AUR" class="mw-redirect" title="AUR">AUR</a> 中也有 <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://aur.archlinux.org/packages/tightvnc/">tightvnc</a></span><sup><small>AUR</small></sup>。
</p>
<h2>
<span id=".E4.B8.BA.E8.99.9A.E6.8B.9F.EF.BC.88.E6.97.A0.E7.95.8C.E9.9D.A2.EF.BC.89.E4.BC.9A.E8.AF.9D.E8.BF.90.E8.A1.8C_vncserver"></span><span class="mw-headline" id="为虚拟（无界面）会话运行_vncserver">为虚拟（无界面）会话运行 vncserver</span>
</h2>
<h3>
<span id=".E5.88.9D.E6.AC.A1.E8.AE.BE.E7.BD.AE"></span><span class="mw-headline" id="初次设置">初次设置</span>
</h3>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>注意：</strong> 在物理内存允许的条件下，Linux系统可以拥有任意数量的VNC服务器——它们同时并行运行，互不干扰。</div>
<p>简易教程如下。但是推荐阅读vncserver的man手册来了解所有的配置项。
</p>
<ol>
<li>用<code>vncpasswd</code>创建密码，它会将哈希处理之后的密码存储在<code>~/.vnc/passwd</code>。</li>
<li>编辑<code>/etc/tigervnc/vncserver.users</code>来定义用户映射。这文件中定义的用户都会拥有独有的端口来运行它的会话。这文件中的数字对应的是TCP端口。默认情况下，:1 是TCP端口5901（5900+1）。如果需要运行一个并行的服务器，第二个实例可以运行在下一个最大的、未被占用的端口，即5902（5900+2）。</li>
<li>创建<code>~/.vnc/config</code>，至少要定义会话的类型，比如<code>session=foo</code>（将foo替换为你想要运行的桌面环境）。你可以通过查看<code>/usr/share/xsessions/</code>里的<code>.desktop</code>文件来知道有哪些桌面环境在当前系统上可以使用。</li>
</ol>
<p>比如：
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">~/.vnc/config</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">session=lxqt
geometry=1920x1080
localhost
alwaysshared</pre>
<h4>
<span id=".E6.9D.83.E9.99.90"></span><span class="mw-headline" id="权限">权限</span>
</h4>
<p>像对待 <code>~/.ssh</code> 一样保护 <code>~/.vnc</code> 是很好的做法，虽然并非必须。执行下面的命令来达到该目的：
</p>
<pre>$ chmod 700 ~/.vnc
</pre>
<h3>
<span id=".E5.90.AF.E5.8A.A8.E4.B8.8E.E5.81.9C.E6.AD.A2tigervnc"></span><span class="mw-headline" id="启动与停止tigervnc">启动与停止tigervnc</span>
</h3>
<p><a href="/title/Start" class="mw-redirect" title="Start">Start</a> <code>vncserver@.service</code>，如果需要让它随系统启动，<a href="/title/Enable" class="mw-redirect" title="Enable">enable</a>它。注意<code>/etc/tigervnc/vncserver.users</code>中定义的编号需要在@符号后面指定，比如启动:1的命令是：
</p>
<pre># systemctl start vncserver@:1
</pre>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Note:</strong> 已经不再支持直接调用<code>/usr/bin/vncserver</code>了，因为这样做不会建立完整可用的会话环境。systemd服务是唯一受支持的使用TigerVNC的方式。参见<a rel="nofollow" class="external text" href="https://github.com/TigerVNC/tigervnc/issues/1096">Issue #1096</a>。</div>
<h2>
<span id=".E5.9C.A8.E7.89.A9.E7.90.86.E6.98.BE.E7.A4.BA.E5.99.A8.E4.B8.8A.EF.BC.885900.E7.AB.AF.E5.8F.A3.EF.BC.89.E8.BF.90.E8.A1.8CVNC.E6.9C.8D.E5.8A.A1"></span><span class="mw-headline" id="在物理显示器上（5900端口）运行VNC服务">在物理显示器上（5900端口）运行VNC服务</span>
</h2>
<h3>
<span id=".E4.BD.BF.E7.94.A8_TigerVNC_.E7.9A.84_x0vncserver_.EF.BC.88.E6.8E.A8.E8.8D.90.EF.BC.89"></span><span class="mw-headline" id="使用_TigerVNC_的_x0vncserver_（推荐）">使用 TigerVNC 的 x0vncserver （推荐）</span>
</h3>
<p>TigerVNC 提供名为 x0vncserver 的二进制文件，它具有和 x11vnc 相类似的功能。例如：
</p>
<pre>x0vncserver -display :0 -passwordfile ~/.vnc/passwd
</pre>
<p>欲获取更多信息，执行
</p>
<pre>man x0vncserver
</pre>
<h3>
<span id=".E4.BD.BF.E7.94.A8_x11vnc_.EF.BC.88.E6.8E.A8.E8.8D.90.EF.BC.89"></span><span class="mw-headline" id="使用_x11vnc_（推荐）">使用 x11vnc （推荐）</span>
</h3>
<p>如果需要远程控制物理显示，使用 <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=x11vnc">x11vnc</a></span>。参见 <a href="/title/X11vnc" title="X11vnc">X11vnc</a> 获取更多信息。
</p>
<h3>
<span id=".E4.BD.BF.E7.94.A8.E4.B8.80.E4.B8.AA_dirty_hack_.EF.BC.88.E4.B8.8D.E6.8E.A8.E8.8D.90.EF.BC.89"></span><span class="mw-headline" id="使用一个_dirty_hack_（不推荐）">使用一个 dirty hack （不推荐）</span>
</h3>
<h4>
<span id=".E5.9F.BA.E6.9C.AC.E8.AE.BE.E7.BD.AE"></span><span class="mw-headline" id="基本设置">基本设置</span>
</h4>
<p>安装 xorg-server 和 tigervnc，并且在 Xorg 的配置中载入“vnc”。
示例：
<code>/etc/X11/xorg.conf.d/10-vnc.conf</code>:
</p>
<pre>Section "Module"
  Load "vnc"
EndSection

Section "Screen"
  Identifier "Screen0"
  Option "SecurityTypes" "None"
EndSection
</pre>
<p>为了进行密码验证，在执行 vncpasswd 命令后，将“Screen”一节换成下面这样
</p>
<pre>Section "Screen"
  Identifier "Screen0"
  Option "SecurityTypes" "VncAuth"
  Option "UserPasswdVerifier" "VncAuth"
  Option "PasswordFile" "/root/.vnc/passwd"
EndSection
</pre>
<h4>
<span id=".E7.BB.99_xorg-server_.E6.89.93.E8.A1.A5.E4.B8.81"></span><span class="mw-headline" id="给_xorg-server_打补丁">给 xorg-server 打补丁</span>
</h4>
<p>很不幸，在 xorg-server 包中有一个 bug。（2013/11/15）幸好 fedora 对此有一个补丁。
</p>
<p><a rel="nofollow" class="external free" href="http://pkgs.fedoraproject.org/cgit/xorg-x11-server.git/plain/0001-include-export-key_is_down-and-friends.patch?h=f19&amp;id=06e94667faa0cd1f9f32cf54e9e447ef50fde635">http://pkgs.fedoraproject.org/cgit/xorg-x11-server.git/plain/0001-include-export-key_is_down-and-friends.patch?h=f19&amp;id=06e94667faa0cd1f9f32cf54e9e447ef50fde635</a><sup title="最后检查状态：404">[<a href="https://en.wikipedia.org/wiki/Wikipedia:Link_rot" class="extiw" title="wikipedia:Wikipedia:Link rot">失效链接</a> 2020-08-06 ⓘ]</sup>
</p>
<p>执行 abs 命令，放好补丁文件并编辑 PKGBUILD。
</p>
<p>PKGBUILD 例子：
</p>
<pre>source = vnc.patch
sha256sums = '1bbbe70236dc70b5e35572f2197d163637100f8c58d0038bdc240df075eb5726'
prepare() {
  cd "${pkgbase}-${pkgver}"
  # patch for vnc module
  patch -Np1 -i ../vnc.patch
</pre>
<p>补丁（为免链接失效）
</p>
<pre>+++ b/include/input.h
@@ -244,12 +244,12 @@  typedef struct _InputAttributes {
 #define KEY_POSTED 2
 #define BUTTON_POSTED 2

-extern void set_key_down(DeviceIntPtr
diff --git a/include/input.h b/include/input.h
index 350daba..2d5e531 100644
--- a/include/input.h
+++ b/include/input.h
@@ -244,12 +244,12 @@  typedef struct _InputAttributes {
 #define KEY_POSTED 2
 #define BUTTON_POSTED 2

-extern void set_key_down(DeviceIntPtr pDev, int key_code, int type);
-extern void set_key_up(DeviceIntPtr pDev, int key_code, int type);
-extern int key_is_down(DeviceIntPtr pDev, int key_code, int type);
-extern void set_button_down(DeviceIntPtr pDev, int button, int type);
-extern void set_button_up(DeviceIntPtr pDev, int button, int type);
-extern int button_is_down(DeviceIntPtr pDev, int button, int type);
+extern _X_EXPORT void set_key_down(DeviceIntPtr pDev, int key_code, int type);
+extern _X_EXPORT void set_key_up(DeviceIntPtr pDev, int key_code, int type);
+extern _X_EXPORT int key_is_down(DeviceIntPtr pDev, int key_code, int type);
+extern _X_EXPORT void set_button_down(DeviceIntPtr pDev, int button, int type);
+extern _X_EXPORT void set_button_up(DeviceIntPtr pDev, int button, int type);
+extern _X_EXPORT int button_is_down(DeviceIntPtr pDev, int button, int type);

extern void InitCoreDevices(void);
extern void InitXTestDevices(void);
</pre>
<h2>
<span id=".E8.BF.9E.E6.8E.A5_VNC_.E6.9C.8D.E5.8A.A1"></span><span class="mw-headline" id="连接_VNC_服务">连接 VNC 服务</span>
</h2>
<p>一个 VNC 服务可允许任意数量的客户端来连接。下面给出一个简单例子，其中 VNC 服务运行在 10.1.10.2 的 5901（:1，使用速记法）端口：
</p>
<pre>$ vncviewer 10.1.10.2:1
</pre>
<h3>
<span id=".E6.97.A0.E5.AF.86.E7.A0.81.E9.AA.8C.E8.AF.81"></span><span class="mw-headline" id="无密码验证">无密码验证</span>
</h3>
<p><code>-passwd</code> 开关允许我们定义服务器上 <code>~/.vnc/passwd</code> 文件的位置。在服务器方面（无论是通过 <a href="/title/Secure_Shell_(%E7%AE%80%E4%BD%93%E4%B8%AD%E6%96%87)" title="Secure Shell (简体中文)">SSH</a> 还是物理接触），用户需要有权访问该文件。在任一情况下，都应将该文件放在客户端文件系统的一个安全位置（例如一个仅给期望用户以读取权限的位置）。
</p>
<pre>$ vncviewer -passwd /path/to/server-passwd-file
</pre>
<h3>
<span id=".E5.9B.BE.E5.BD.A2.E7.95.8C.E9.9D.A2.E5.AE.A2.E6.88.B7.E7.AB.AF.E7.A4.BA.E4.BE.8B"></span><span class="mw-headline" id="图形界面客户端示例">图形界面客户端示例</span>
</h3>
<ul>
<li><span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=gtk-vnc">gtk-vnc</a></span></li>
<li><span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=krdc">krdc</a></span></li>
<li><span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=rdesktop">rdesktop</a></span></li>
<li><span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=vinagre">vinagre</a></span></li>
<li><span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=remmina">remmina</a></span></li>
<li>
<span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://aur.archlinux.org/packages/vncviewer-jar/">vncviewer-jar</a></span><sup><small>AUR</small></sup>
</li>
</ul>
<h2>
<span id=".E4.BD.BF.E7.94.A8_SSH_.E9.9A.A7.E9.81.93.E5.8A.A0.E5.AF.86_VNC_.E6.9C.8D.E5.8A.A1"></span><span class="mw-headline" id="使用_SSH_隧道加密_VNC_服务">使用 SSH 隧道加密 VNC 服务</span>
</h2>
<h3>
<span id=".E6.9C.8D.E5.8A.A1.E7.AB.AF.E9.85.8D.E7.BD.AE"></span><span class="mw-headline" id="服务端配置">服务端配置</span>
</h3>
<p>若希望从 LAN 保护之外访问 VNC 服务，你需要考虑明文密码及客户端与服务端之间未加密通信的问题。VNC 服务可以很简单地使用 SSH 隧道进行加密。另外，不要使用此方法对外界打开另一个端口，因为通信会沿用户之前对 WAN 打开的 SSH 端口在隧道中依次进行。在这种情况下，强烈推荐使用 -localhost 开关运行 vncserver。该开关仅允许接收<i>从本机</i>发起的连接，并顺理成章地仅允许物理 SSH 连接并认证到机器上的用户。（This switch only allows connections <i>from the localhost</i> -- and by analogy only by users physically ssh'ed and authenticated on the box!）
</p>
<pre>$ vncserver -geometry 1440x900 -alwaysshared -dpi 96 -localhost :1
</pre>
<h3>
<span id=".E5.AE.A2.E6.88.B7.E7.AB.AF.E9.85.8D.E7.BD.AE"></span><span class="mw-headline" id="客户端配置">客户端配置</span>
</h3>
<p>既然服务器现在只接受本机的连接，使用 -L 开关通过 SSH 连接到该机器来打开隧道。例如：
</p>
<pre>$ ssh 目标机器IP -L 8900:localhost:5901
</pre>
<p>该命令将服务器的 5901 端口转发到客户机的 8900 端口。一旦已通过 SSH 连接，则保持该 xterm 或 shell 窗口开启——它会作为和服务器通信的加密隧道。为了通过 VNC 连接，打开第二个 xterm 并连接到客户机的加密隧道上（而不是远程服务器的 IP 地址）：
</p>
<pre>$ vncviewer localhost::8900
</pre>
<p>以下来自 SSH 的手册页面：
<i>-L [bind_address:] port:host:hostport</i>
</p>
<p><i>Specifies that the given port on the local (client) host is to be forwarded to the given host  and  port on the remote side.  This works by allocating a socket to listen to port on the local side, optionally bound to the specified bind_address.  Whenever  a  connection  is  made  to this port, the connection is forwarded over the secure channel, and a connection is made to host port hostport from the remote machine.  Port forwardings can also  be  specified  in the configuration file.  IPv6 addresses can be specified with an alternative syntax:</i>
</p>
<p><i>[bind_address/] port/host/ hostport or by enclosing the  address  in  square  brackets.</i>
<i>Only the superuser can forward privileged ports.  By default, the local port is bound in accordance with the GatewayPorts setting.  However, an explicit bind_address may be used to  bind  the connection to a specific address.  The bind_address of ``localhost'' indicates that the listening port be bound for local use only, while an empty address or `*' indicates that the port should be available from all interfaces.</i>
</p>
<h3>
<span id=".E5.9C.A8_Android_.E8.AE.BE.E5.A4.87.E4.B8.8A.E9.80.9A.E8.BF.87_SSH_.E8.BF.9E.E6.8E.A5_VNC_.E6.9C.8D.E5.8A.A1.E5.99.A8"></span><span class="mw-headline" id="在_Android_设备上通过_SSH_连接_VNC_服务器">在 Android 设备上通过 SSH 连接 VNC 服务器</span>
</h3>
<p>为了在 Android 设备上通过 SSH 连接到 VNC 服务器，需要具备以下条件：
</p>
<pre>1. 在要连接的机器上运行 SSH 服务
2. 在要连接的机器上运行 VNC 服务。（使用上面提到的 -localhost 标志来运行服务）
3. 在 Android 设备上安装 SSH 客户端。（ConnectBot 是一个常见选择，并在本向导中用作例子。）
4. 在 Android 设备上安装VNC客户端（androidVNC）
</pre>
<p>考虑为目标使用一些动态 DNC 服务，来解决无固定 IP 地址问题。（原文：Consider some dynamic DNS service for targets that do not have static IP addresses.）
</p>
<p>在 ConnectBot 中，键入 IP 并连接到所期望的机器。按选项键，选择端口转发，并增加一个新端口然后保存之：
</p>
<pre>Nickname: vnc
Type: Local
Source port: 5901
Destination: 127.0.0.1:5901</pre>
<p>在 androidVNC 中：
</p>
<pre>Nickname: nickname
Password: 设置 VNC 服务器时使用的密码
Address: 127.0.0.1 (we are in local after connecting through SSH)
Port: 5901</pre>
<p>连接即可。
</p>
<h2>
<span id=".E6.8F.90.E7.A4.BA.E5.92.8C.E6.8A.80.E5.B7.A7"></span><span class="mw-headline" id="提示和技巧">提示和技巧</span>
</h2>
<h3>
<span id=".E5.9C.A8.E5.BC.80.E5.85.B3.E6.9C.BA.E6.97.B6.E5.90.AF.E5.8A.A8.E5.85.B3.E9.97.AD_VNC_.E6.9C.8D.E5.8A.A1"></span><span class="mw-headline" id="在开关机时启动关闭_VNC_服务">在开关机时启动关闭 VNC 服务</span>
</h3>
<p>在这里寻找这个文件<code>/usr/lib/systemd/system/vncserver.service</code>
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/systemd/system/vncserver@:1.service</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;"># The vncserver service unit file
#
# 1. Copy this file to /etc/systemd/system/vncserver@:x.service
#  Note that x is the port number on which the vncserver will run.  The default is 1 which 
#  corresponds to port 5901.  For a 2nd instance, use x=2 which corresponds to port 5902.
# 2. Edit User=
#   ("User=foo")
# 3. Edit  and vncserver parameters appropriately
#   ("/usr/bin/vncserver %i -arg1 -arg2 -argn")
# 4. Run `systemctl --system daemon-reload`
# 5. Run `systemctl enable vncserver@:&lt;display&gt;.service`
#
# DO NOT RUN THIS SERVICE if your local area network is untrusted! 
#
# See the wiki page for more on security
# https://wiki.archlinux.org/index.php/Vncserver

[Unit]
Description=Remote desktop service (VNC)
After=syslog.target network.target

[Service]
Type=forking
User=

# Clean any existing files in /tmp/.X11-unix environment
ExecStartPre=-/usr/bin/vncserver -kill %i
ExecStart=/usr/bin/vncserver %i
ExecStop=/usr/bin/vncserver -kill %i

[Install]
WantedBy=multi-user.target
</pre>
<h3>
<span id=".E5.A4.8D.E5.88.B6.E8.BF.9C.E7.A8.8B.E6.9C.BA.E5.99.A8.E5.89.AA.E8.B4.B4.E6.9D.BF.E5.86.85.E5.AE.B9.E5.88.B0.E6.9C.AC.E5.9C.B0"></span><span class="mw-headline" id="复制远程机器剪贴板内容到本地">复制远程机器剪贴板内容到本地</span>
</h3>
<p>如果从远程机器到本机的复制不工作，如该<a rel="nofollow" class="external text" href="https://bbs.archlinux.org/viewtopic.php?id=101243">参考</a>下面所述，在服务器上执行 autocutsel：
</p>
<pre>$ autocutsel -fork
</pre>
<p>现在，按下 F8 键显示 VNC 弹出菜单，选择 <code>Clipboard: local -&gt; remote</code> 选项。
</p>
<p>你可以将上述命令放在 <code>~/.vnc/xstartup</code> 中，以使其在 VNC 服务启动时自动运行。
</p>
<h3>
<span id=".E8.A7.A3.E5.86.B3.E6.97.A0.E5.85.89.E6.A0.87.E9.97.AE.E9.A2.98"></span><span class="mw-headline" id="解决无光标问题">解决无光标问题</span>
</h3>
<p>如果使用 <code>x0vncserver</code> 时光标无法显示，那么像下面这样启动 vncviewer：
</p>
<pre>$ vncviewer DotWhenNoCursor=1 &lt;server&gt;
</pre>
<p>或者将 <code>DotWhenNoCursor=1</code> 写在 tigervnc 的配置文件（默认在 <code>~/.vnc/default.tigervnc</code>）中。
</p>
<h3>
<span id=".E8.BF.9E.E6.8E.A5.E5.88.B0_OS_X.EF.BC.88Mac.EF.BC.89.E7.B3.BB.E7.BB.9F"></span><span class="mw-headline" id="连接到_OS_X（Mac）系统">连接到 OS X（Mac）系统</span>
</h3>
<p>参见 <a rel="nofollow" class="external free" href="https://help.ubuntu.com/community/AppleRemoteDesktop">https://help.ubuntu.com/community/AppleRemoteDesktop</a> 。已在 Remmina 上测试。
</p>
<h2>
<span id=".E4.B8.AD.E6.96.87.E5.8E.9F.E5.86.85.E5.AE.B9"></span><span class="mw-headline" id="中文原内容">中文原内容</span>
</h2>
<p>VNC 代表 'Virtual Network Computing'（即虚拟网络计算机）.
</p>
<p>他是一种远程屏幕显示协议，也是一种使用该协议控制远程计算机的程序。通过它，你可以从任何地方的计算机，不管他们是局域网内的还是因特网上的，你都可以连接到你的桌面上。
</p>
<p>你可以通过安装<a href="/title/SSH" class="mw-redirect" title="SSH">SSH</a>（Secure SHell）支持来提升VNC会话的安全性。
</p>
<p>在ArchLinux中，内含有很多种VNC服务器和客户端可用，比如：
</p>
<ul><li><a href="/title/Tightvnc" class="mw-redirect" title="Tightvnc">Tightvnc</a></li></ul>
<ul><li><a href="/title/X11vnc_(%E7%AE%80%E4%BD%93%E4%B8%AD%E6%96%87)" title="X11vnc (简体中文)">X11vnc (简体中文)</a></li></ul>
<ul><li>其他</li></ul>
<p>你可以通过执行下面的命令来查看所有的VNC程序列表：
</p>
<pre># pacman -Ss vnc
</pre>
<h2>
<span id=".E5.8F.A6.E5.A4.96.E5.8F.82.E8.A7.81"></span><span class="mw-headline" id="另外参见">另外参见</span>
</h2>
<ul><li><a rel="nofollow" class="external free" href="https://github.com/TigerVNC/tigervnc">https://github.com/TigerVNC/tigervnc</a></li></ul>
</div>
</div>
<div id="catlinks" class="catlinks" data-mw="interface">
<div id="mw-normal-catlinks" class="mw-normal-catlinks">
<a href="/title/Special:Categories" title="Special:Categories">Categories</a>: <ul>
<li><a href="/title/Category:Remote_desktop_(%E7%AE%80%E4%BD%93%E4%B8%AD%E6%96%87)" title="Category:Remote desktop (简体中文)">Remote desktop (简体中文)</a></li>
<li><a href="/title/Category:Servers_(%E7%AE%80%E4%BD%93%E4%B8%AD%E6%96%87)" title="Category:Servers (简体中文)">Servers (简体中文)</a></li>
</ul>
</div>
<div id="mw-hidden-catlinks" class="mw-hidden-catlinks mw-hidden-cats-hidden">Hidden categories: <ul>
<li><a href="/title/Category:Pages_or_sections_flagged_with_Template:Translateme_(%E7%AE%80%E4%BD%93%E4%B8%AD%E6%96%87)" title="Category:Pages or sections flagged with Template:Translateme (简体中文)">Pages or sections flagged with Template:Translateme (简体中文)</a></li>
<li><a href="/title/Category:Pages_with_dead_links" title="Category:Pages with dead links">Pages with dead links</a></li>
</ul>
</div>
</div>
	</div>
</div>

<footer id="footer" class="mw-footer" role="contentinfo" style="margin: 0">
	<ul id="footer-info">
		<li>Retrieved from "<a dir="ltr" href="https://wiki.archlinux.org/index.php?title=TigerVNC_(%E7%AE%80%E4%BD%93%E4%B8%AD%E6%96%87)&amp;oldid=669442">https://wiki.archlinux.org/index.php?title=TigerVNC_(简体中文)&amp;oldid=669442</a>"</li>
		<li id="footer-info-lastmod"> This page was last edited on 8 May 2021, at 11:49.</li>
		<li id="footer-info-copyright">Content is available under <a class="external" rel="nofollow" href="http://www.gnu.org/copyleft/fdl.html">GNU Free Documentation License 1.3 or later</a> unless otherwise noted.</li>
	<br>
</ul>
	<ul id="footer-places">
		<li id="footer-places-privacy"><a href="/title/ArchWiki:Privacy_policy" title="ArchWiki:Privacy policy">Privacy policy</a></li>
		<li id="footer-places-about"><a href="/title/ArchWiki:About" title="ArchWiki:About">About ArchWiki</a></li>
		<li id="footer-places-disclaimer"><a href="/title/ArchWiki:General_disclaimer" title="ArchWiki:General disclaimer">Disclaimers</a></li>
	</ul>
	<ul id="footer-icons" class="noprint">
		<li id="footer-copyrightico">
	</ul>
	<div style="clear: both;"></div>
</footer>



</body>
</html>
