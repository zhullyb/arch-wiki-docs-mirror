<!DOCTYPE html>
<html class="client-nojs" lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<title>NVIDIA Optimus (简体中文) - ArchWiki</title>
<link rel="stylesheet" href="../ArchWikiOffline.css">
<meta name="ResourceLoaderDynamicStyles" content="">
<meta name="generator" content="MediaWiki 1.35.0">
<meta name="robots" content="noindex,follow">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="shortcut icon" href="/favicon.ico">
<link rel="search" type="application/opensearchdescription+xml" href="/opensearch_desc.php" title="ArchWiki (en)">
<link rel="EditURI" type="application/rsd+xml" href="https://wiki.archlinux.org/api.php?action=rsd">
<link rel="license" href="http://www.gnu.org/copyleft/fdl.html">
<link rel="alternate" type="application/atom+xml" title="ArchWiki Atom feed" href="/index.php?title=Special:RecentChanges&amp;feed=atom">
</head>
<body class="mediawiki ltr sitedir-ltr mw-hide-empty-elt ns-0 ns-subject page-NVIDIA_Optimus_简体中文 rootpage-NVIDIA_Optimus_简体中文 skin-vector action-view skin-vector-legacy">
<div id="content" class="mw-body" role="main" style="margin: 0">
	<a id="top"></a>
	<div id="siteNotice" class="mw-body-content"></div>
	<div class="mw-indicators mw-body-content">
	</div>
	<h1 id="firstHeading" class="firstHeading" lang="en">NVIDIA Optimus (简体中文)</h1>
	<div id="bodyContent" class="mw-body-content">
		<div id="siteSub" class="noprint">From ArchWiki</div>
		<div id="contentSub"></div>
		<div id="contentSub2"></div>
		
		<div id="jump-to-nav"></div>
		<a class="mw-jump-link" href="#mw-head">Jump to navigation</a>
		<a class="mw-jump-link" href="#searchInput">Jump to search</a>
		<div id="mw-content-text" lang="en" dir="ltr" class="mw-content-ltr">
<div class="warningbox">The printable version is no longer supported and may have rendering errors. Please update your browser bookmarks and please use the default browser print function instead.</div>
<div class="mw-parser-output">
<div class="archwiki-template-meta-related-articles-start">
<p>相关文章</p>
<ul>
<li><a href="../en/Bumblebee.html" title="Bumblebee">Bumblebee</a></li>
<li><a href="../en/Nouveau.html" title="Nouveau">Nouveau</a></li>
<li><a href="../en/NVIDIA.html" title="NVIDIA">NVIDIA</a></li>
<li><a href="../en/Nvidia-xrun.html" title="Nvidia-xrun">nvidia-xrun</a></li>
</ul>
</div>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>翻译状态：</strong>本文是 <a href="../en/NVIDIA_Optimus.html" title="NVIDIA Optimus">NVIDIA_Optimus</a> 的<a href="../zh-CN/ArchWiki:Translation_Team.html" title="ArchWiki:Translation Team (简体中文)">翻译</a>。上次翻译日期：2020-10-25。如果英文版本有所<a rel="nofollow" class="external text" href="https://wiki.archlinux.org/index.php?title=NVIDIA_Optimus&amp;diff=0&amp;oldid=630897">更改</a>，则您可以帮助同步翻译。</div>
<p><a href="https://en.wikipedia.org/wiki/NVIDIA_Optimus" class="extiw" title="wikipedia:NVIDIA Optimus">NVIDIA Optimus</a> 是一项允许英特尔（Intel）集成图形处理器（GPU）和英伟达（NVIDIA）独立图形处理器置入并通过一台笔记本电脑访问的技术。
</p>
<div id="toc" class="toc" role="navigation" aria-labelledby="mw-toc-heading">
<input type="checkbox" role="button" id="toctogglecheckbox" class="toctogglecheckbox" style="display:none"><div class="toctitle" lang="en" dir="ltr">
<h2 id="mw-toc-heading">Contents</h2>
<span class="toctogglespan"><label class="toctogglelabel" for="toctogglecheckbox"></label></span>
</div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#%E5%8F%AF%E7%94%A8%E6%96%B9%E6%B3%95"><span class="tocnumber">1</span> <span class="toctext">可用方法</span></a></li>
<li class="toclevel-1 tocsection-2">
<a href="#%E4%BB%85%E4%BD%BF%E7%94%A8%E8%8B%B1%E7%89%B9%E5%B0%94%E6%98%BE%E5%8D%A1"><span class="tocnumber">2</span> <span class="toctext">仅使用英特尔显卡</span></a>
<ul>
<li class="toclevel-2 tocsection-3"><a href="#%E5%9C%A8%E4%B8%8D%E5%88%87%E6%8D%A2%E6%B8%B2%E6%9F%93%E6%8F%90%E4%BE%9B%E7%A8%8B%E5%BA%8F%E6%83%85%E5%86%B5%E4%B8%8B%E4%BD%BF%E7%94%A8_CUDA"><span class="tocnumber">2.1</span> <span class="toctext">在不切换渲染提供程序情况下使用 CUDA</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-4">
<a href="#%E4%BB%85%E4%BD%BF%E7%94%A8%E8%8B%B1%E4%BC%9F%E8%BE%BE%E6%98%BE%E5%8D%A1"><span class="tocnumber">3</span> <span class="toctext">仅使用英伟达显卡</span></a>
<ul>
<li class="toclevel-2 tocsection-5">
<a href="#%E6%98%BE%E7%A4%BA%E7%AE%A1%E7%90%86%E5%99%A8"><span class="tocnumber">3.1</span> <span class="toctext">显示管理器</span></a>
<ul>
<li class="toclevel-3 tocsection-6"><a href="#LightDM"><span class="tocnumber">3.1.1</span> <span class="toctext">LightDM</span></a></li>
<li class="toclevel-3 tocsection-7"><a href="#SDDM"><span class="tocnumber">3.1.2</span> <span class="toctext">SDDM</span></a></li>
<li class="toclevel-3 tocsection-8"><a href="#GDM"><span class="tocnumber">3.1.3</span> <span class="toctext">GDM</span></a></li>
</ul>
</li>
<li class="toclevel-2 tocsection-9"><a href="#%E6%A3%80%E6%9F%A5_3D_%E8%AE%BE%E7%BD%AE"><span class="tocnumber">3.2</span> <span class="toctext">检查 3D 设置</span></a></li>
<li class="toclevel-2 tocsection-10"><a href="#%E6%9B%B4%E5%A4%9A%E4%BF%A1%E6%81%AF"><span class="tocnumber">3.3</span> <span class="toctext">更多信息</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-11">
<a href="#%E7%96%91%E9%9A%BE%E8%A7%A3%E7%AD%94"><span class="tocnumber">4</span> <span class="toctext">疑难解答</span></a>
<ul>
<li class="toclevel-2 tocsection-12"><a href="#%E5%9E%82%E7%9B%B4%E5%90%8C%E6%AD%A5%E6%92%95%E8%A3%82"><span class="tocnumber">4.1</span> <span class="toctext">垂直同步撕裂</span></a></li>
<li class="toclevel-2 tocsection-13"><a href="#Failed_to_initialize_the_NVIDIA_GPU_at_PCI:1:0:0_(GPU_fallen_off_the_bus_/_RmInitAdapter_failed!)"><span class="tocnumber">4.2</span> <span class="toctext">Failed to initialize the NVIDIA GPU at PCI:1:0:0 (GPU fallen off the bus / RmInitAdapter failed!)</span></a></li>
<li class="toclevel-2 tocsection-14"><a href="#%E5%88%86%E8%BE%A8%E7%8E%87%E5%92%8C%E5%B1%8F%E5%B9%95%E6%89%AB%E6%8F%8F%E9%94%99%E8%AF%AF%E2%80%9CEDID_errors_in_Xorg.log%E2%80%9D"><span class="tocnumber">4.3</span> <span class="toctext">分辨率和屏幕扫描错误“EDID errors in Xorg.log”</span></a></li>
<li class="toclevel-2 tocsection-15"><a href="#%E9%94%81%E5%AE%9A%E9%97%AE%E9%A2%98(lspci_%E6%8C%82%E8%B5%B7)"><span class="tocnumber">4.4</span> <span class="toctext">锁定问题(lspci 挂起)</span></a></li>
<li class="toclevel-2 tocsection-16"><a href="#%E7%AC%94%E8%AE%B0%E6%9C%AC%E7%94%B5%E8%84%91%E6%9C%AA%E5%8F%91%E7%8E%B0%E5%B1%8F%E5%B9%95/NVIDIA_Optimus"><span class="tocnumber">4.5</span> <span class="toctext">笔记本电脑未发现屏幕/NVIDIA Optimus</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-17">
<a href="#%E4%BD%BF%E7%94%A8%E5%8F%AF%E5%88%87%E6%8D%A2%E6%98%BE%E5%8D%A1"><span class="tocnumber">5</span> <span class="toctext">使用可切换显卡</span></a>
<ul>
<li class="toclevel-2 tocsection-18"><a href="#%E4%BD%BF%E7%94%A8_PRIME_%E6%B8%B2%E6%9F%93%E5%8D%B8%E6%8D%A2%EF%BC%88render_offload%EF%BC%89"><span class="tocnumber">5.1</span> <span class="toctext">使用 PRIME 渲染卸换（render offload）</span></a></li>
<li class="toclevel-2 tocsection-19"><a href="#%E4%BD%BF%E7%94%A8_nouveau"><span class="tocnumber">5.2</span> <span class="toctext">使用 nouveau</span></a></li>
<li class="toclevel-2 tocsection-20"><a href="#%E4%BD%BF%E7%94%A8%E5%A4%A7%E9%BB%84%E8%9C%82%EF%BC%88Bumblebee%EF%BC%89"><span class="tocnumber">5.3</span> <span class="toctext">使用大黄蜂（Bumblebee）</span></a></li>
<li class="toclevel-2 tocsection-21"><a href="#%E4%BD%BF%E7%94%A8_nvidia-xrun"><span class="tocnumber">5.4</span> <span class="toctext">使用 nvidia-xrun</span></a></li>
<li class="toclevel-2 tocsection-22"><a href="#%E4%BD%BF%E7%94%A8_optimus-manager"><span class="tocnumber">5.5</span> <span class="toctext">使用 optimus-manager</span></a></li>
</ul>
</li>
</ul>
</div>

<h2>
<span id=".E5.8F.AF.E7.94.A8.E6.96.B9.E6.B3.95"></span><span class="mw-headline" id="可用方法">可用方法</span>
</h2>
<p>这里有几种可行的方法：
</p>
<ul>
<li>
<a href="#%E4%BB%85%E4%BD%BF%E7%94%A8%E8%8B%B1%E7%89%B9%E5%B0%94%E6%98%BE%E5%8D%A1">#仅使用英特尔显卡</a> - 能节约用电，因为此时英伟达图形处理器是完全关闭（不通电）的。</li>
<li>
<a href="#%E4%BB%85%E4%BD%BF%E7%94%A8%E8%8B%B1%E4%BC%9F%E8%BE%BE%E6%98%BE%E5%8D%A1">#仅使用英伟达显卡</a> - 能比英特尔显卡提供更强的性能表现，但是电量流失也更快（这对移动设备不太友好）。此方法和 <a href="#%E4%BD%BF%E7%94%A8_optimus-manager">optimus-manager</a> 以及 <a href="#%E4%BD%BF%E7%94%A8_nvidia-xrun">nvidia-xrun</a> 两者一样采用了相同的底层处理，所以在选用一种更自动化的方法之前，应该先利用这个方法来排除故障和验证一些常规功能。</li>
<li>两者兼用 (在需要的时候使用英伟达图形处理器，其他时候关闭它以节省电量):
<ul>
<li>
<a href="#%E4%BD%BF%E7%94%A8_PRIME_%E6%B8%B2%E6%9F%93%E5%8D%B8%E6%8D%A2%EF%BC%88render_offload%EF%BC%89">#使用 PRIME 渲染卸换（render offload）</a> - 英伟达官方支持方法。</li>
<li>
<a href="#%E4%BD%BF%E7%94%A8_optimus-manager">#使用 optimus-manager</a> - 用一个简单的命令切换显卡（需要注销重新登录来生效）。这可实现需要时使用英伟达图形处理器达到最大性能，不用时则将后者关闭。</li>
<li>
<a href="#%E4%BD%BF%E7%94%A8_nvidia-xrun">#使用 nvidia-xrun</a> -  使用英伟达显卡在另外的 TTY 上运行单独的 X 会话。这可实现需要时使用英伟达图形处理器达到最大性能，不用时则将后者关闭。</li>
<li>
<a href="#%E4%BD%BF%E7%94%A8%E5%A4%A7%E9%BB%84%E8%9C%82%EF%BC%88Bumblebee%EF%BC%89">#使用大黄蜂（Bumblebee）</a> - 提供了与 Windows 下相似的功能，可以选择需要的程序使用英伟达显卡，而其他的程序则用英特尔显卡运行。不过大黄蜂有重大的性能问题。</li>
<li>
<a href="#%E4%BD%BF%E7%94%A8_nouveau">#使用 nouveau</a> - （与英伟达官方提供的专有驱动相比）提供的性能较差，而且可能导致睡眠和休眠问题。不适用于最新的英伟达图形处理器。</li>
</ul>
</li>
</ul>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>注意：</strong> 所有这些方法选择都是互斥的，如果测试了一种方法后又决定使用另一种方法，则必须确保在尝试另一种方法之前，还原通过遵循前一种方法所做的所有配置更改，否则可能会发生文件冲突和不定行为。</div>
<h2>
<span id=".E4.BB.85.E4.BD.BF.E7.94.A8.E8.8B.B1.E7.89.B9.E5.B0.94.E6.98.BE.E5.8D.A1"></span><span class="mw-headline" id="仅使用英特尔显卡">仅使用英特尔显卡</span>
</h2>
<p>如果只考虑使用某一张显卡而不用切换的话，请检查电脑的 BIOS，那里应该有禁用某一显卡的选项。有些笔记本只允许禁用独立显卡，另一些则相反。但如果只想用两张显卡中的一张的话，还是值得去检查一下 BIOS 的。
</p>
<p>如果 BIOS 不允许禁用掉英伟达显卡，那么可以从 Linux 内核本身禁用它。请参阅 <a href="../en/Hybrid_graphics.html#Fully_Power_Down_Discrete_GPU" title="Hybrid graphics">Hybrid graphics#Fully Power Down Discrete GPU</a>。
</p>
<h3>
<span id=".E5.9C.A8.E4.B8.8D.E5.88.87.E6.8D.A2.E6.B8.B2.E6.9F.93.E6.8F.90.E4.BE.9B.E7.A8.8B.E5.BA.8F.E6.83.85.E5.86.B5.E4.B8.8B.E4.BD.BF.E7.94.A8_CUDA"></span><span class="mw-headline" id="在不切换渲染提供程序情况下使用_CUDA">在不切换渲染提供程序情况下使用 CUDA</span>
</h3>
<p>您可以在不切换渲染到英伟达显卡的情况下使用 CUDA。所要做的就是确保在启动 CUDA 程序前英伟达显卡已经打开（通电），详情请参见 <a href="../en/Hybrid_graphics.html#Fully_Power_Down_Discrete_GPU" title="Hybrid graphics">Hybrid graphics#Fully Power Down Discrete GPU</a>。
</p>
<p>现在，当启动 CUDA 程序时，会自动加载必要的内核模块。在使用 CUDA 后要关闭英伟达显卡，请必须先将 <code>nvidia</code> 内核模块卸载：
</p>
<pre># rmmod nvidia_uvm
# rmmod nvidia
</pre>
<h2>
<span id=".E4.BB.85.E4.BD.BF.E7.94.A8.E8.8B.B1.E4.BC.9F.E8.BE.BE.E6.98.BE.E5.8D.A1"></span><span class="mw-headline" id="仅使用英伟达显卡">仅使用英伟达显卡</span>
</h2>
<p>专有的英伟达驱动可配置为主渲染提供程序。它也有明显的画面撕裂问题 —— 除非通过启动 <a href="../en/NVIDIA.html#DRM_kernel_mode_setting" title="NVIDIA">DRM 内核模式设定</a> 启用 PRIME Sync，更多信息请参见 <a rel="nofollow" class="external autonumber" href="https://devtalk.nvidia.com/default/topic/957814/linux/prime-and-prime-synchronization/">[1]</a>。专有驱动确实允许使用独立图形处理器，而且（截至 <a rel="nofollow" class="external text" href="https://www.phoronix.com/scan.php?page=article&amp;item=nouveau-410-blob&amp;num=1">2017 年一月</a>）它相比 nouveau 驱动有更明显的性能优势。
</p>
<p>首先，安装 <a href="../en/NVIDIA.html" title="NVIDIA">英伟达</a>驱动和 <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=xorg-xrandr">xorg-xrandr</a></span> 软件包。然后，配置 <code>/etc/X11/xorg.conf.d/10-nvidia-drm-outputclass.conf</code>，其中的选项将与软件包提供的 <code>/usr/share/X11/xorg.conf.d/10-nvidia-drm-outputclass.conf</code> 文件结合提供与此配置的兼容性。
</p>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>注意：</strong> 在一些配置上，此配置会使英伟达驱动无法通过 EDID 文件自动探测显示参数值。解决方案可参考<a href="#%E5%88%86%E8%BE%A8%E7%8E%87%E5%92%8C%E5%B1%8F%E5%B9%95%E6%89%AB%E6%8F%8F%E9%94%99%E8%AF%AF%E2%80%9CEDID_errors_in_Xorg.log%E2%80%9D">#分辨率和屏幕扫描错误“EDID errors in Xorg.log”</a>。</div>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/X11/xorg.conf.d/10-nvidia-drm-outputclass.conf</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">Section "OutputClass"
    Identifier "intel"
    MatchDriver "i915"
    Driver "modesetting"
EndSection

Section "OutputClass"
    Identifier "nvidia"
    MatchDriver "nvidia-drm"
    Driver "nvidia"
    Option "AllowEmptyInitialConfiguration"
    Option "PrimaryGPU" "yes"
    ModulePath "/usr/lib/nvidia/xorg"
    ModulePath "/usr/lib/xorg/modules"
EndSection

</pre>
<p>接下来，请在 <code>~/.xinitrc</code> 文件的开头处添加下列两行内容：
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">~/.xinitrc</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">xrandr --setprovideroutputsource modesetting NVIDIA-0
xrandr --auto
</pre>
<p>现在重启以加载驱动，X 服务器也应该启动了。
</p>
<p>如果显示 DPI 不正确，请再添加下列一行：
</p>
<pre>xrandr --dpi 96
</pre>
<p>如果在启动 X 服务器时出现黑屏，请确保 <code>~/.xinitrc</code> 文件中的两个 <code>xrandr</code> 命令后面没有“与（&amp;）”符号。如果有“与（&amp;）”号，窗口管理器似乎可以在 <code>xrandr</code> 命令执行完成前就运行了，从而导致了黑屏。
</p>
<h3>
<span id=".E6.98.BE.E7.A4.BA.E7.AE.A1.E7.90.86.E5.99.A8"></span><span class="mw-headline" id="显示管理器">显示管理器</span>
</h3>
<p>如果打算使用显示管理器 (Display Manager, DM)，就不是使用 <code>~/.xinitrc</code> 文件了，而是需要为显示管理器创建或编辑显示配置脚本。
</p>
<h4><span class="mw-headline" id="LightDM">LightDM</span></h4>
<p>为 <a href="../en/LightDM.html" title="LightDM">LightDM</a> 显示管理器创建/编辑脚本：
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/lightdm/display_setup.sh</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">#!/bin/sh
xrandr --setprovideroutputsource modesetting NVIDIA-0
xrandr --auto
</pre>
<p>然后赋予脚本可执行权限：
</p>
<pre># chmod +x /etc/lightdm/display_setup.sh
</pre>
<p>通过编辑 <code>/etc/lightdm/lightdm.conf</code> 的 <code>[Seat:*]</code> 部分配置 LightDM 来运行这个脚本：
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;"># nano /etc/lightdm/lightdm.conf</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">[Seat:*]
display-setup-script=/etc/lightdm/display_setup.sh</pre>
<p>现在重启，然后显示管理器应该能启动了。
</p>
<h4><span class="mw-headline" id="SDDM">SDDM</span></h4>
<p>为 <a href="../en/SDDM.html" title="SDDM">SDDM</a> 显示管理器创建/编辑脚本（SDDM 是 <a href="../en/KDE.html" title="KDE">KDE</a> 的默认显示管理器）：
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/usr/share/sddm/scripts/Xsetup</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">xrandr --setprovideroutputsource modesetting NVIDIA-0
xrandr --auto
</pre>
<h4><span class="mw-headline" id="GDM">GDM</span></h4>
<p>要为 <a href="../en/GDM.html" title="GDM">GDM</a> 创建启动脚本，请创建两个新的 .desktop 文件，如下：
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/usr/share/gdm/greeter/autostart/optimus.desktop
/etc/xdg/autostart/optimus.desktop</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">[Desktop Entry]
Type=Application
Name=Optimus
Exec=sh -c "xrandr --setprovideroutputsource modesetting NVIDIA-0; xrandr --auto"
NoDisplay=true
X-GNOME-Autostart-Phase=DisplayServer
</pre>
<p>并且请确保 GDM <a href="../zh-CN/GDM.html#%E4%BD%BF%E7%94%A8Xorg%E4%BD%9C%E4%B8%BA%E5%90%8E%E7%AB%AF" title="GDM (简体中文)">使用 Xorg 作为后端</a>。
</p>
<h3>
<span id=".E6.A3.80.E6.9F.A5_3D_.E8.AE.BE.E7.BD.AE"></span><span class="mw-headline" id="检查_3D_设置">检查 3D 设置</span>
</h3>
<p>可通过安装 <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=mesa-demos">mesa-demos</a></span> 并运行以下命令来检查英伟达显卡是否被使用：
</p>
<pre>$ glxinfo | grep NVIDIA
</pre>
<h3>
<span id=".E6.9B.B4.E5.A4.9A.E4.BF.A1.E6.81.AF"></span><span class="mw-headline" id="更多信息">更多信息</span>
</h3>
<p>更多信息请参见英伟达官方网页上的这个主题文章 <a rel="nofollow" class="external autonumber" href="https://us.download.nvidia.cn/XFree86/Linux-x86/370.28/README/randr14.html">[2]</a>。
</p>
<h2>
<span id=".E7.96.91.E9.9A.BE.E8.A7.A3.E7.AD.94"></span><span class="mw-headline" id="疑难解答">疑难解答</span>
</h2>
<div class="noprint archwiki-template-message">
<p><a href="../File:Tango-edit-clear.png" class="image"><img alt="Tango-edit-clear.png" src="../File:Tango-edit-clear.png" decoding="async" width="48" height="48"></a><b>This article or section needs language, wiki syntax or style improvements. See <a href="../en/Help:Style.html" title="Help:Style">Help:Style</a> for reference.</b><a href="../File:Tango-edit-clear.png" class="image"><img alt="Tango-edit-clear.png" src="../File:Tango-edit-clear.png" decoding="async" width="48" height="48"></a></p>
<div>
<b>Reason:</b> If this is relevant only for <a href="#Use_NVIDIA_graphics_only">#Use NVIDIA graphics only</a>, it should be a subsection. Otherwise it should be the last section on the page. (Discuss in <a rel="nofollow" class="external text" href="https://wiki.archlinux.org/index.php/Talk:NVIDIA_Optimus_(%E7%AE%80%E4%BD%93%E4%B8%AD%E6%96%87)">Talk:NVIDIA Optimus (简体中文)#</a>)</div>
</div>
<h3>
<span id=".E5.9E.82.E7.9B.B4.E5.90.8C.E6.AD.A5.E6.92.95.E8.A3.82"></span><span class="mw-headline" id="垂直同步撕裂">垂直同步撕裂</span>
</h3>
<p><span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=xorg-server">xorg-server</a></span>需要 1.19 或更高版本，<span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=linux">linux</a></span>内核需要4.5 或更高版本，<span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=nvidia">nvidia</a></span>需要370.23更高版本。还需要开启<a href="../en/NVIDIA.html#DRM_kernel_mode_setting" title="NVIDIA">DRM kernel mode setting</a>设置项以修复撕裂问题。
</p>
<p>官方论坛查看详细信息：<a rel="nofollow" class="external text" href="https://devtalk.nvidia.com/default/topic/957814/linux/prime-and-prime-synchronization/">forum thread</a>。
</p>
<h3>
<span id="Failed_to_initialize_the_NVIDIA_GPU_at_PCI:1:0:0_.28GPU_fallen_off_the_bus_.2F_RmInitAdapter_failed.21.29"></span><span class="mw-headline" id="Failed_to_initialize_the_NVIDIA_GPU_at_PCI:1:0:0_(GPU_fallen_off_the_bus_/_RmInitAdapter_failed!)">Failed to initialize the NVIDIA GPU at PCI:1:0:0 (GPU fallen off the bus / RmInitAdapter failed!)</span>
</h3>
<p>添加 <code>rcutree.rcu_idle_gp_delay=1</code> 到内核参数。原始话题见<a rel="nofollow" class="external autonumber" href="https://bbs.archlinux.org/viewtopic.php?id=169742">[3]</a>。
</p>
<h3>
<span id=".E5.88.86.E8.BE.A8.E7.8E.87.E5.92.8C.E5.B1.8F.E5.B9.95.E6.89.AB.E6.8F.8F.E9.94.99.E8.AF.AF.E2.80.9CEDID_errors_in_Xorg.log.E2.80.9D"></span><span class="mw-headline" id="分辨率和屏幕扫描错误“EDID_errors_in_Xorg.log”">分辨率和屏幕扫描错误“EDID errors in Xorg.log”</span>
</h3>
<p>这是由于NVIDIA的驱动程序没有检测显示器的EDID。你需要手动指定路径的EDID文件或以类似的方式提供相同的信息。
</p>
<p>增加这些线路和变化部分反映你自己的系统：
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/X11/xorg.conf</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">Section "Device"
       	Option		"ConnectedMonitor" "CRT-0"
       	Option		"CustomEDID" "CRT-0:/sys/class/drm/card0-LVDS-1/edid"
	Option		"IgnoreEDID" "false"
	Option		"UseEDID" "true"
EndSection
</pre>
<p>如果xorg不会开始尝试更换所有CRT到DFB。显示器连接通过LVDS，card0是标识为英特尔卡。EDID二进制是这个目录。如果硬件配置不同，CustomEDID的值可能有所不同，但这已得到证实。不管怎样，路径都将从/sys/class/drm开始
</p>
<p>或者你可以生成你的工具，如读取<span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=read-edid">read-edid</a></span>,将驱动点指向这个文件。也可以使用modelines，但是务必要修改 "UseEDID" 和 "IgnoreEDID"。
</p>
<h3>
<span id=".E9.94.81.E5.AE.9A.E9.97.AE.E9.A2.98.28lspci_.E6.8C.82.E8.B5.B7.29"></span><span class="mw-headline" id="锁定问题(lspci_挂起)">锁定问题(lspci 挂起)</span>
</h3>
<p>问题：lspci挂起，系统暂停失败，关机时挂起，optirun挂起。多出现在新的笔记本电脑或使用了类似bbswitch GTX的965m时（例如bumblebee）以及nouveau的情况。
</p>
<p>当独立显卡接通电源，可能出现这种情况，参见 (<a rel="nofollow" class="external text" href="https://bugzilla.kernel.org/show_bug.cgi?id=156341">kernel bug 156341</a>)。
</p>
<p>具体解决方法参见 <a rel="nofollow" class="external text" href="https://github.com/Bumblebee-Project/Bumblebee/issues/764#issuecomment-234494238">this issue</a>。
你可以添加<code>acpi_osi="!Windows 2015"</code> 或<code>acpi_osi=! acpi_osi="Windows 2009"</code> 到<a href="../en/Kernel_parameters.html" title="Kernel parameters">Kernel parameters</a>中。
</p>
<h3>
<span id=".E7.AC.94.E8.AE.B0.E6.9C.AC.E7.94.B5.E8.84.91.E6.9C.AA.E5.8F.91.E7.8E.B0.E5.B1.8F.E5.B9.95.2FNVIDIA_Optimus"></span><span class="mw-headline" id="笔记本电脑未发现屏幕/NVIDIA_Optimus">笔记本电脑未发现屏幕/NVIDIA Optimus</span>
</h3>
<p>检查<code>$ lspci | grep VGA</code>输入内容是否类似：
</p>
<pre>00:02.0 VGA compatible controller: Intel Corporation Core Processor Integrated Graphics Controller (rev 02)
01:00.0 VGA compatible controller: nVidia Corporation Device 0df4 (rev a1)
</pre>
<p>NVIDIA驱动自319.12 Beta <a rel="nofollow" class="external autonumber" href="http://www.nvidia.com/object/linux-display-amd64-319.12-driver.html">[4]</a>起已经包含在内核（版本3.9级以上)中。
</p>
<p>另一个解决方案是安装<a href="../en/Intel_graphics.html" class="mw-redirect" title="Intel">Intel</a>驱动进行显示，如果需要运行3D软件，可以使用 <a href="../zh-CN/Bumblebee.html" title="Bumblebee (简体中文)">Bumblebee (简体中文)</a>来使用NVIDIA显卡。
</p>
<h2>
<span id=".E4.BD.BF.E7.94.A8.E5.8F.AF.E5.88.87.E6.8D.A2.E6.98.BE.E5.8D.A1"></span><span class="mw-headline" id="使用可切换显卡">使用可切换显卡</span>
</h2>
<h3>
<span id=".E4.BD.BF.E7.94.A8_PRIME_.E6.B8.B2.E6.9F.93.E5.8D.B8.E6.8D.A2.EF.BC.88render_offload.EF.BC.89"></span><span class="mw-headline" id="使用_PRIME_渲染卸换（render_offload）">使用 PRIME 渲染卸换（render offload）</span>
</h3>
<p>这是英伟达为支持可切换显卡提供的官方方法。
</p>
<p>详情请参见 <a href="../en/PRIME.html#PRIME_render_offload" title="PRIME">PRIME#PRIME render offload</a>。
</p>
<h3>
<span id=".E4.BD.BF.E7.94.A8_nouveau"></span><span class="mw-headline" id="使用_nouveau">使用 nouveau</span>
</h3>
<p>要了解显卡切换相关内容，请参见 <a href="../en/PRIME.html" title="PRIME">PRIME</a>；要了解开源英伟达驱动相关内容，请参见 <a href="../en/Nouveau.html" title="Nouveau">nouveau</a>。
</p>
<h3>
<span id=".E4.BD.BF.E7.94.A8.E5.A4.A7.E9.BB.84.E8.9C.82.EF.BC.88Bumblebee.EF.BC.89"></span><span class="mw-headline" id="使用大黄蜂（Bumblebee）">使用大黄蜂（Bumblebee）</span>
</h3>
<p>请参见 <a href="../en/Bumblebee.html" title="Bumblebee">Bumblebee</a>。
</p>
<h3>
<span id=".E4.BD.BF.E7.94.A8_nvidia-xrun"></span><span class="mw-headline" id="使用_nvidia-xrun">使用 nvidia-xrun</span>
</h3>
<p>请参见 <a href="../en/Nvidia-xrun.html" title="Nvidia-xrun">nvidia-xrun</a>。
</p>
<h3>
<span id=".E4.BD.BF.E7.94.A8_optimus-manager"></span><span class="mw-headline" id="使用_optimus-manager">使用 optimus-manager</span>
</h3>
<p>请参见 <a rel="nofollow" class="external text" href="https://github.com/Askannz/optimus-manager">Optimus-manager</a> 上游文档。其中包含了在 Arch Linux 系统上的安装和配置方法。
</p>
</div>
</div>
<div id="catlinks" class="catlinks" data-mw="interface">
<div id="mw-normal-catlinks" class="mw-normal-catlinks">
<a href="../Special:Categories.html" title="Special:Categories">Category</a>: <ul><li><a href="../zh-CN/Category:Graphics.html" title="Category:Graphics (简体中文)">Graphics (简体中文)</a></li></ul>
</div>
<div id="mw-hidden-catlinks" class="mw-hidden-catlinks mw-hidden-cats-hidden">Hidden category: <ul><li><a href="../en/Category:Pages_or_sections_flagged_with_Template:Style.html" title="Category:Pages or sections flagged with Template:Style">Pages or sections flagged with Template:Style</a></li></ul>
</div>
</div>
	</div>
</div>

<footer id="footer" class="mw-footer" role="contentinfo" style="margin: 0">
	<ul id="footer-info">
		<li>Retrieved from "<a dir="ltr" href="https://wiki.archlinux.org/index.php?title=NVIDIA_Optimus_(%E7%AE%80%E4%BD%93%E4%B8%AD%E6%96%87)&amp;oldid=645101">https://wiki.archlinux.org/index.php?title=NVIDIA_Optimus_(简体中文)&amp;oldid=645101</a>"</li>
		<li id="footer-info-lastmod"> This page was last edited on 13 December 2020, at 14:02.</li>
		<li id="footer-info-copyright">Content is available under <a class="external" rel="nofollow" href="http://www.gnu.org/copyleft/fdl.html">GNU Free Documentation License 1.3 or later</a> unless otherwise noted.</li>
	<br>
</ul>
	<ul id="footer-places">
		<li id="footer-places-privacy"><a href="../en/ArchWiki:Privacy_policy.html" title="ArchWiki:Privacy policy">Privacy policy</a></li>
		<li id="footer-places-about"><a href="../en/ArchWiki:About.html" title="ArchWiki:About">About ArchWiki</a></li>
		<li id="footer-places-disclaimer"><a href="../en/ArchWiki:General_disclaimer.html" title="ArchWiki:General disclaimer">Disclaimers</a></li>
	</ul>
	<ul id="footer-icons" class="noprint">
		<li id="footer-copyrightico">
	</ul>
	<div style="clear: both;"></div>
</footer>



</body>
</html>
