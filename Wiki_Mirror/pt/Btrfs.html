<!DOCTYPE html>
<html class="client-nojs" lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<title>Btrfs (Português) - ArchWiki</title>
<link rel="stylesheet" href="../ArchWikiOffline.css">
<meta name="ResourceLoaderDynamicStyles" content="">
<meta name="generator" content="MediaWiki 1.35.0">
<meta name="robots" content="noindex,follow">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="shortcut icon" href="/favicon.ico">
<link rel="search" type="application/opensearchdescription+xml" href="/opensearch_desc.php" title="ArchWiki (en)">
<link rel="EditURI" type="application/rsd+xml" href="https://wiki.archlinux.org/api.php?action=rsd">
<link rel="license" href="http://www.gnu.org/copyleft/fdl.html">
<link rel="alternate" type="application/atom+xml" title="ArchWiki Atom feed" href="/index.php?title=Special:RecentChanges&amp;feed=atom">
</head>
<body class="mediawiki ltr sitedir-ltr mw-hide-empty-elt ns-0 ns-subject page-Btrfs_Português rootpage-Btrfs_Português skin-vector action-view skin-vector-legacy">
<div id="content" class="mw-body" role="main" style="margin: 0">
	<a id="top"></a>
	<div id="siteNotice" class="mw-body-content"></div>
	<div class="mw-indicators mw-body-content">
	</div>
	<h1 id="firstHeading" class="firstHeading" lang="en">Btrfs (Português)</h1>
	<div id="bodyContent" class="mw-body-content">
		<div id="siteSub" class="noprint">From ArchWiki</div>
		<div id="contentSub"></div>
		<div id="contentSub2"></div>
		
		<div id="jump-to-nav"></div>
		<a class="mw-jump-link" href="#mw-head">Jump to navigation</a>
		<a class="mw-jump-link" href="#searchInput">Jump to search</a>
		<div id="mw-content-text" lang="en" dir="ltr" class="mw-content-ltr">
<div class="warningbox">The printable version is no longer supported and may have rendering errors. Please update your browser bookmarks and please use the default browser print function instead.</div>
<div class="mw-parser-output">
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Status de tradução:</strong> Esse artigo é uma tradução de <a href="../en/Btrfs.html" title="Btrfs">Btrfs</a>. Data da última tradução: 2020-05-03. Você pode ajudar a sincronizar a tradução, se houver <a rel="nofollow" class="external text" href="https://wiki.archlinux.org/index.php?title=Btrfs&amp;diff=0&amp;oldid=610368">alterações</a> na versão em inglês.</div>
<div class="archwiki-template-meta-related-articles-start">
<p>Artigos relacionados</p>
<ul>
<li><a href="../pt/File_systems.html" class="mw-redirect" title="Sistemas de arquivos">Sistemas de arquivos</a></li>
<li><a href="../en/Snapper.html" title="Snapper">Snapper</a></li>
<li><a href="../pt/bd347841f13524ba6da3458e094be74d.html#Subvolumes_do_Btrfs_com_swap" class="mw-redirect" title="Dm-crypt/Criptografando todo um sistema">dm-crypt/Criptografando todo um sistema#Subvolumes do Btrfs com swap</a></li>
</ul>
</div>
<p>Da <a rel="nofollow" class="external text" href="https://btrfs.wiki.kernel.org/index.php/Main_Page">Wiki do Btrfs</a> (traduzido):
</p>
<dl><dd>Btrfs é uma cópia moderna no sistema de arquivos de gravação (Copy-on-Write) para Linux, visando implementar recursos avançados, além de focar na tolerância a falhas, reparo e administração fácil. Desenvolvido em conjunto com várias empresas, o Btrfs é licenciado sob a GPL e aberto à contribuições de qualquer pessoa.</dd></dl>
<div class="archwiki-template-box archwiki-template-box-warning">
<strong>Atenção:</strong> O Btrfs possui alguns recursos instáveis. Veja o <a rel="nofollow" class="external text" href="https://btrfs.wiki.kernel.org/index.php/Status">Status</a> na Wiki do Btrfs, <a rel="nofollow" class="external text" href="https://btrfs.wiki.kernel.org/index.php/FAQ#Is_btrfs_stable.3F">O Btrfs é estável?</a> e <a rel="nofollow" class="external text" href="https://btrfs.wiki.kernel.org/index.php/Getting_started">Começando</a> para informações mais detalhadas. Veja a sessão <a href="#Problemas_conhecidos">#Problemas conhecidos</a>.</div>
<div id="toc" class="toc" role="navigation" aria-labelledby="mw-toc-heading">
<input type="checkbox" role="button" id="toctogglecheckbox" class="toctogglecheckbox" style="display:none"><div class="toctitle" lang="en" dir="ltr">
<h2 id="mw-toc-heading">Contents</h2>
<span class="toctogglespan"><label class="toctogglelabel" for="toctogglecheckbox"></label></span>
</div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Prepara%C3%A7%C3%A3o"><span class="tocnumber">1</span> <span class="toctext">Preparação</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#Cria%C3%A7%C3%A3o_do_sistema_de_arquivos"><span class="tocnumber">2</span> <span class="toctext">Criação do sistema de arquivos</span></a></li>
<li class="toclevel-1 tocsection-3">
<a href="#Sistema_de_arquivos_em_um_%C3%BAnico_dispositivo"><span class="tocnumber">3</span> <span class="toctext">Sistema de arquivos em um único dispositivo</span></a>
<ul>
<li class="toclevel-2 tocsection-4"><a href="#Sistema_de_arquivos_com_v%C3%A1rios_dispositivos"><span class="tocnumber">3.1</span> <span class="toctext">Sistema de arquivos com vários dispositivos</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-5">
<a href="#Configurando_o_sistema_de_arquivos"><span class="tocnumber">4</span> <span class="toctext">Configurando o sistema de arquivos</span></a>
<ul>
<li class="toclevel-2 tocsection-6">
<a href="#Copy-on-Write_(CoW)"><span class="tocnumber">4.1</span> <span class="toctext">Copy-on-Write (CoW)</span></a>
<ul>
<li class="toclevel-3 tocsection-7"><a href="#Desativando_CoW"><span class="tocnumber">4.1.1</span> <span class="toctext">Desativando CoW</span></a></li>
<li class="toclevel-3 tocsection-8"><a href="#Criando_c%C3%B3pias_leves"><span class="tocnumber">4.1.2</span> <span class="toctext">Criando cópias leves</span></a></li>
</ul>
</li>
<li class="toclevel-2 tocsection-9">
<a href="#Compress%C3%A3o"><span class="tocnumber">4.2</span> <span class="toctext">Compressão</span></a>
<ul>
<li class="toclevel-3 tocsection-10"><a href="#Exibir_tipos_e_propor%C3%A7%C3%B5es_de_compacta%C3%A7%C3%A3o"><span class="tocnumber">4.2.1</span> <span class="toctext">Exibir tipos e proporções de compactação</span></a></li>
</ul>
</li>
<li class="toclevel-2 tocsection-11">
<a href="#Subvolumes"><span class="tocnumber">4.3</span> <span class="toctext">Subvolumes</span></a>
<ul>
<li class="toclevel-3 tocsection-12"><a href="#Criando_um_Subvolume"><span class="tocnumber">4.3.1</span> <span class="toctext">Criando um Subvolume</span></a></li>
<li class="toclevel-3 tocsection-13"><a href="#Listando_subvolumes"><span class="tocnumber">4.3.2</span> <span class="toctext">Listando subvolumes</span></a></li>
<li class="toclevel-3 tocsection-14"><a href="#Excluindo_um_subvolume"><span class="tocnumber">4.3.3</span> <span class="toctext">Excluindo um subvolume</span></a></li>
<li class="toclevel-3 tocsection-15"><a href="#Subvolumes_de_montagem"><span class="tocnumber">4.3.4</span> <span class="toctext">Subvolumes de montagem</span></a></li>
<li class="toclevel-3 tocsection-16"><a href="#Montando_o_subvolume_como_raiz"><span class="tocnumber">4.3.5</span> <span class="toctext">Montando o subvolume como raiz</span></a></li>
<li class="toclevel-3 tocsection-17"><a href="#Alterando_o_Subvolume_padr%C3%A3o"><span class="tocnumber">4.3.6</span> <span class="toctext">Alterando o Subvolume padrão</span></a></li>
</ul>
</li>
<li class="toclevel-2 tocsection-18"><a href="#Quota"><span class="tocnumber">4.4</span> <span class="toctext">Quota</span></a></li>
<li class="toclevel-2 tocsection-19"><a href="#Intervalo_de_confirma%C3%A7%C3%A3o"><span class="tocnumber">4.5</span> <span class="toctext">Intervalo de confirmação</span></a></li>
<li class="toclevel-2 tocsection-20"><a href="#TRIM_do_SSD"><span class="tocnumber">4.6</span> <span class="toctext">TRIM do SSD</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-21">
<a href="#Uso"><span class="tocnumber">5</span> <span class="toctext">Uso</span></a>
<ul>
<li class="toclevel-2 tocsection-22"><a href="#Arquivo_swap"><span class="tocnumber">5.1</span> <span class="toctext">Arquivo swap</span></a></li>
<li class="toclevel-2 tocsection-23"><a href="#Exibindo_espa%C3%A7o_usado/espa%C3%A7o_livre"><span class="tocnumber">5.2</span> <span class="toctext">Exibindo espaço usado/espaço livre</span></a></li>
<li class="toclevel-2 tocsection-24"><a href="#Desfragmenta%C3%A7%C3%A3o"><span class="tocnumber">5.3</span> <span class="toctext">Desfragmentação</span></a></li>
<li class="toclevel-2 tocsection-25"><a href="#RAID"><span class="tocnumber">5.4</span> <span class="toctext">RAID</span></a></li>
<li class="toclevel-2 tocsection-26">
<a href="#Scrub"><span class="tocnumber">5.5</span> <span class="toctext">Scrub</span></a>
<ul>
<li class="toclevel-3 tocsection-27"><a href="#Iniciar_manualmente"><span class="tocnumber">5.5.1</span> <span class="toctext">Iniciar manualmente</span></a></li>
<li class="toclevel-3 tocsection-28"><a href="#Comece_com_um_servi%C3%A7o_ou_cron%C3%B4metro"><span class="tocnumber">5.5.2</span> <span class="toctext">Comece com um serviço ou cronômetro</span></a></li>
</ul>
</li>
<li class="toclevel-2 tocsection-29"><a href="#Balance"><span class="tocnumber">5.6</span> <span class="toctext">Balance</span></a></li>
<li class="toclevel-2 tocsection-30"><a href="#Snapshots"><span class="tocnumber">5.7</span> <span class="toctext">Snapshots</span></a></li>
<li class="toclevel-2 tocsection-31"><a href="#Enviar/receber"><span class="tocnumber">5.8</span> <span class="toctext">Enviar/receber</span></a></li>
<li class="toclevel-2 tocsection-32"><a href="#Desduplica%C3%A7%C3%A3o"><span class="tocnumber">5.9</span> <span class="toctext">Desduplicação</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-33">
<a href="#Problemas_conhecidos"><span class="tocnumber">6</span> <span class="toctext">Problemas conhecidos</span></a>
<ul>
<li class="toclevel-2 tocsection-34"><a href="#Criptografia"><span class="tocnumber">6.1</span> <span class="toctext">Criptografia</span></a></li>
<li class="toclevel-2 tocsection-35"><a href="#TLP"><span class="tocnumber">6.2</span> <span class="toctext">TLP</span></a></li>
<li class="toclevel-2 tocsection-36"><a href="#Problemas_de_verifica%C3%A7%C3%A3o_do_btrfs"><span class="tocnumber">6.3</span> <span class="toctext">Problemas de verificação do btrfs</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-37">
<a href="#Dicas_e_truques"><span class="tocnumber">7</span> <span class="toctext">Dicas e truques</span></a>
<ul>
<li class="toclevel-2 tocsection-38"><a href="#Disco_Btrfs_sem_parti%C3%A7%C3%A3o"><span class="tocnumber">7.1</span> <span class="toctext">Disco Btrfs sem partição</span></a></li>
<li class="toclevel-2 tocsection-39"><a href="#Convers%C3%A3o_Ext3/4_para_Btrfs"><span class="tocnumber">7.2</span> <span class="toctext">Conversão Ext3/4 para Btrfs</span></a></li>
<li class="toclevel-2 tocsection-40"><a href="#Acelera%C3%A7%C3%A3o_de_hardware_de_soma_de_verifica%C3%A7%C3%A3o"><span class="tocnumber">7.3</span> <span class="toctext">Aceleração de hardware de soma de verificação</span></a></li>
<li class="toclevel-2 tocsection-41"><a href="#Recupera%C3%A7%C3%A3o_de_corrup%C3%A7%C3%A3o"><span class="tocnumber">7.4</span> <span class="toctext">Recuperação de corrupção</span></a></li>
<li class="toclevel-2 tocsection-42"><a href="#Inicializando_em_snapshots"><span class="tocnumber">7.5</span> <span class="toctext">Inicializando em snapshots</span></a></li>
<li class="toclevel-2 tocsection-43"><a href="#Use_subvolumes_Btrfs_com_systemd-nspawn"><span class="tocnumber">7.6</span> <span class="toctext">Use subvolumes Btrfs com systemd-nspawn</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-44">
<a href="#Solu%C3%A7%C3%A3o_de_problemas"><span class="tocnumber">8</span> <span class="toctext">Solução de problemas</span></a>
<ul>
<li class="toclevel-2 tocsection-45">
<a href="#GRUB"><span class="tocnumber">8.1</span> <span class="toctext">GRUB</span></a>
<ul>
<li class="toclevel-3 tocsection-46"><a href="#Deslocamento_da_parti%C3%A7%C3%A3o"><span class="tocnumber">8.1.1</span> <span class="toctext">Deslocamento da partição</span></a></li>
<li class="toclevel-3 tocsection-47"><a href="#Raiz_ausente"><span class="tocnumber">8.1.2</span> <span class="toctext">Raiz ausente</span></a></li>
</ul>
</li>
<li class="toclevel-2 tocsection-48"><a href="#BTRFS:_open_ctree_falhou"><span class="tocnumber">8.2</span> <span class="toctext">BTRFS: open_ctree falhou</span></a></li>
<li class="toclevel-2 tocsection-49"><a href="#Verifica%C3%A7%C3%A3o_do_Btrfs"><span class="tocnumber">8.3</span> <span class="toctext">Verificação do Btrfs</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-50"><a href="#Veja_tamb%C3%A9m"><span class="tocnumber">9</span> <span class="toctext">Veja também</span></a></li>
</ul>
</div>

<h2>
<span id="Prepara.C3.A7.C3.A3o"></span><span class="mw-headline" id="Preparação">Preparação</span>
</h2>
<p>Para utilitários do userspace <a href="../pt/Help:Reading.html#Instala%C3%A7%C3%A3o_de_pacotes" class="mw-redirect" title="Instale">instale</a> o pacote <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=btrfs-progs">btrfs-progs</a></span> necessário para as operações básicas.
</p>
<p>Se você precisar inicializar a partir de um sistema de arquivos Btrfs (ou seja, seu kernel e initramfs residem em uma partição Btrfs), verifique se o seu <a href="../pt/Arch_boot_process.html#Gerenciador_de_boot" class="mw-redirect" title="Gerenciador de boot">gerenciador de boot</a> suporta Btrfs.
</p>
<h2>
<span id="Cria.C3.A7.C3.A3o_do_sistema_de_arquivos"></span><span class="mw-headline" id="Criação_do_sistema_de_arquivos">Criação do sistema de arquivos</span>
</h2>
<p>Veja, a seguir como criar um novo <a href="../pt/File_systems.html" class="mw-redirect" title="Sistema de arquivos">sistema de arquivos</a> Btrfs. Para converter uma partição ext3/4 em Btrfs, veja <a href="#Convers%C3%A3o_Ext3/4_para_Btrfs">#Conversão Ext3/4 para Btrfs</a>. Para usar uma configuração sem partição, Veja <a href="#Disco_Btrfs_sem_parti%C3%A7%C3%A3o">#Disco Btrfs sem partição</a>.
</p>
<p>Veja <span class="plainlinks archwiki-template-man" title="$ man 8 mkfs.btrfs"><a rel="nofollow" class="external text" href="https://man.archlinux.org/man/mkfs.btrfs.8">mkfs.btrfs(8)</a></span> para mais informações.
</p>
<h2>
<span id="Sistema_de_arquivos_em_um_.C3.BAnico_dispositivo"></span><span class="mw-headline" id="Sistema_de_arquivos_em_um_único_dispositivo">Sistema de arquivos em um único dispositivo</span>
</h2>
<p>Para criar um sistema de arquivos Btrfs na partição <code>/dev/<i>partição</i></code>:
</p>
<pre># mkfs.btrfs -L <i>minhaEtiqueta</i> /dev/<i>partição</i>
</pre>
<p>O tamanho do bloco padrão do Btrfs é de 16 KB. Para usar um tamanho de bloco maior para dados / metadados, especifique-o um valor para o <code>nodesize</code> através da opção <code>-n</code> como mostrado neste exemplo, usando blocos de 16 KB:
</p>
<pre># mkfs.btrfs -L <i>minhaEtiqueta</i> -n 16k /dev/<i>partição</i>
</pre>
<h3>
<span id="Sistema_de_arquivos_com_v.C3.A1rios_dispositivos"></span><span class="mw-headline" id="Sistema_de_arquivos_com_vários_dispositivos">Sistema de arquivos com vários dispositivos</span>
</h3>
<div class="archwiki-template-box archwiki-template-box-warning">
<strong>Atenção:</strong> Os modos RAID 5 e RAID 6 dos Btrfs são fatalmente falhos, e não deve ser usado para "nada além de testaes com dados descartáveis." Veja <a rel="nofollow" class="external text" href="https://btrfs.wiki.kernel.org/index.php/RAID56">a página Btrfs em RAID5 e RAID6</a> para atualizações de status.</div>
<p>Vários dispositivos pode ser usado para criar um RAID. Os níveis de RAID suportados incluem RAID 0, RAID 1, RAID 10, RAID 5 e RAID 6. Os níveis de RAID podem ser configurados separadamente para dados e metadados usando essas opções respectivamente <code>-d</code> e <code>-m</code>. Por padrão, os dados são distribuídos (<code>raid0</code>) e os metadados são espelhados (<code>raid1</code>). Veja <a rel="nofollow" class="external text" href="https://btrfs.wiki.kernel.org/index.php/Using_Btrfs_with_Multiple_Devices">Usando Btrfs em vários dispositivos</a> para obter mais informações sobre como criar um volume RAID Btrfs.
</p>
<pre># mkfs.btrfs -d raid0 -m raid1 /dev/<i>partição1</i> /dev/<i>partição2</i> ...
</pre>
<p>Você pode criar uma <a href="https://en.wikipedia.org/wiki/JBOD" class="extiw" title="wikipedia:JBOD">configuração JBOD</a>, onde os discos são vistos como um sistema de arquivos, mas os arquivos não são duplicados usando <code>-d single -m raid1</code>.
</p>
<p>Você deve incluir o <code>udev</code> hook ou the <code>btrfs</code> hook no <code>/etc/mkinitcpio.conf</code> para usar vários dispositivos Btrfs em um pool. Veja o artigo <a href="../pt/Mkinitcpio.html#Hooks_comuns" title="Mkinitcpio (Português)">Mkinitcpio#Hooks comuns</a> para mais informações.
</p>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Nota:</strong> 
<ul>
<li>É possível adicionar dispositivos a um sistema de arquivos com vários dispositivos posteriormente. Veja o <a rel="nofollow" class="external text" href="https://btrfs.wiki.kernel.org/index.php/Using_Btrfs_with_Multiple_Devices">Artigo da Wiki do Btrfs</a> para mais informações.</li>
<li>Os dispositivos podem ter tamanhos diferentes. No entanto, só se uma unidade em uma configuração RAID for maior que as outras, esse espaço extra não será usado.</li>
<li>Alguns <a href="../pt/Arch_boot_process.html#Gerenciador_de_boot" class="mw-redirect" title="Gerenciador de boot">gerenciadores de boot</a> como <a href="../en/Syslinux.html" title="Syslinux">Syslinux</a> não suportam sistemas de arquivos com vários dispositivos.</li>
</ul>
</div>
<p>Veja <a href="#RAID">#RAID</a> para obter conselhos sobre manutenção específica para sistemas de arquivos Btrfs para vários dispositivos.
</p>
<h2><span class="mw-headline" id="Configurando_o_sistema_de_arquivos">Configurando o sistema de arquivos</span></h2>
<h3>
<span id="Copy-on-Write_.28CoW.29"></span><span class="mw-headline" id="Copy-on-Write_(CoW)">Copy-on-Write (CoW)</span>
</h3>
<p>Por padrão, Btrfs usa <a href="https://en.wikipedia.org/wiki/copy-on-write" class="extiw" title="wikipedia:copy-on-write">copy-on-write</a> para todos os arquivos o tempo todo. Veja a <a rel="nofollow" class="external text" href="https://btrfs.wiki.kernel.org/index.php/SysadminGuide#Copy_on_Write_.28CoW.29">Seção Guia do Btrfs Sysadmin</a> para detalhes de implementação, bem como vantagens e desvantagens.
</p>
<h4><span class="mw-headline" id="Desativando_CoW">Desativando CoW</span></h4>
<p>Para desativar copy-on-write de arquivos recém-criados em um subvolume montado, use o <code>nodatacow</code> opção de montagem. Isso afetará apenas os arquivos recém-criados. A cópia na gravação ainda ocorrerá para arquivos existentes. O <code>nodatacow</code> Essa opção também desativa a compactação. Veja <span class="plainlinks archwiki-template-man" title="$ man 5 btrfs"><a rel="nofollow" class="external text" href="https://man.archlinux.org/man/btrfs.5">btrfs(5)</a></span> para detalhes.
</p>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Nota:</strong> De <span class="plainlinks archwiki-template-man" title="$ man 5 btrfs"><a rel="nofollow" class="external text" href="https://man.archlinux.org/man/btrfs.5#MOUNT_OPTIONS">btrfs(5) § MOUNT OPTIONS</a></span> (traduzido): "em um único sistema de arquivos, não é possível montar alguns subvolumes com <code>nodatacow</code> e outros com <code>datacow</code>. A opção de montagem do primeiro subvolume montado se aplica a quaisquer outros subvolumes."</div>
<p>Para desativar copy-on-write de arquivos/diretórios únicos,:
</p>
<pre>$ chattr +C <i>/diretório/arquivo</i>
</pre>
<p>Isso desabilitará copy-on-write para as operações em que há apenas uma referência ao arquivo. Se houver mais de uma referência (por exemplo através de <code>cp --reflink=always</code> ou por causa de um snapshot do sistema de arquivos), copy-on-write ainda vai ocorrer.
</p>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Nota:</strong> De página man do chattr (traduzido): "Para btrfs, a opção 'C' deve ser definida em arquivos novos ou vazios. Se estiver definido em um arquivo que já possui blocos de dados, é indefinido quando os blocos atribuídos ao arquivo estarão totalmente estáveis. Se a opção 'C' estiver definida em um diretório, ela não terá efeito no diretório, mas os novos arquivos criados nesse diretório terão o atributo No_COW."</div>
<div class="archwiki-template-box archwiki-template-box-tip">
<strong>Tip:</strong> De acordo com a observação acima, você pode usar o seguinte truque para desativar Copy-on-Write em arquivos existentes em um diretório:
<pre>$ mv <i>/caminho/para/diretório</i> <i>/caminho/para/diretório</i>_antigo
$ mkdir <i>/caminho/para/diretório</i>
$ chattr +C <i>/caminho/para/diretório</i>
$ cp -a <i>/caminho/para/diretório</i>_antigo/* <i>/caminho/para/diretório</i>
$ rm -rf <i>/caminho/para/diretório</i>_antigo
</pre>
<p>Certifique-se de que os dados não sejam usados durante esse processo. Observe também que <code>mv</code> ou <code>cp --reflink</code> conforme descrito abaixo não funcionarão.
</p>
</div>
<h4>
<span id="Criando_c.C3.B3pias_leves"></span><span class="mw-headline" id="Criando_cópias_leves">Criando cópias leves</span>
</h4>
<p>Por padrão, ao copiar arquivos em um sistema de arquivos Btrfs com <code>cp</code>, cópias reais são criadas. Para criar uma cópia leve que faça referência aos dados originais, use a opção <i>reflink</i>:
</p>
<pre>$ cp --reflink <i>fonte</i> <i>destino</i>
</pre>
<p>Veja a página de manual do <span class="plainlinks archwiki-template-man" title="$ man 1 cp"><a rel="nofollow" class="external text" href="https://man.archlinux.org/man/cp.1">cp(1)</a></span> para mais detalhes sobre a opção <code>--reflink</code>.
</p>
<h3>
<span id="Compress.C3.A3o"></span><span class="mw-headline" id="Compressão">Compressão</span>
</h3>
<p>Btrfs suporta compactação transparente e automática. Isso não apenas reduz o tamanho dos arquivos, mas também pode <a rel="nofollow" class="external text" href="http://www.phoronix.com/scan.php?page=article&amp;item=btrfs_compress_2635&amp;num=1">melhorar o desempenho</a>, em alguns casos de uso específicos (por exemplo. thread único com E/S de arquivo pesado), enquanto obviamente prejudica o desempenho em outros casos (por exemplo. tarefas em múltiplas threads e / ou intensivas da CPU com E/S de arquivos grandes). Geralmente, é obtido melhor desempenho com os algoritmos de compactação mais rápidos, <i>zstd</i> e <i>lzo</i>, e alguns <a rel="nofollow" class="external text" href="https://www.phoronix.com/scan.php?page=article&amp;item=btrfs-zstd-compress">benchmarks</a> para fornecer comparações detalhadas.
</p>
<p><code>compress=<i>alg</i></code> é uma opção de montagem ativada automaticamente considerando todos os arquivos para compactação, onde <code><i>alg</i></code> e também <code>zlib</code>, <code>lzo</code>, <code>zstd</code>, ou <code>no</code> (sem compressão). Usando esta opção, o btrfs verificará se a compactação da primeira parte dos dados a reduz. Se isso acontecer, toda a gravação nesse arquivo será compactada. Caso contrário, nada será compactado. Com esta opção, se a primeira parte da gravação não diminuir, nenhuma compactação será aplicada à gravação, mesmo que o restante dos dados diminua tremendamente. <a rel="nofollow" class="external autonumber" href="https://btrfs.wiki.kernel.org/index.php/Compression#What_happens_to_incompressible_files.3F">[1]</a> Isso é feito para evitar que o disco aguarde para começar a gravar até que todos os dados a serem gravados sejam totalmente fornecidos ao btrfs e compactados.
</p>
<p>A opção de montagem <code>compress-force=<i>alg</i></code> pode ser usada, o que faz com que o btrfs pule a verificação se a compactação diminui a primeira parte e ativa a compactação automática para cada arquivo.  Na pior das hipóteses, isso pode causar (levemente) mais espaço a ser usado e uso da CPU sem nenhum objetivo.
</p>
<p>Somente arquivos criados ou modificados após a adição da opção de montagem serão compactados.
</p>
<p>Para aplicar compactação a arquivos existentes, use o comando <code>btrfs filesystem defragment -c<i>alg</i></code>, onde <code><i>alg</i></code> e também <code>zlib</code>, <code>lzo</code> ou <code>zstd</code>. Por exemplo, para compactar novamente todo o sistema de arquivos com <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=zstd">zstd</a></span>, execute o seguinte comando:
</p>
<pre># btrfs filesystem defragment -r -v -czstd /
</pre>
<p>Para habilitar a compactação ao instalar o Arch em uma partição Btrfs vazia, use a opção <code>compress</code> quando <a href="../pt/File_systems.html#Montar_um_sistema_de_arquivos" class="mw-redirect" title="Monta">montar</a> o sistema de arquivos: <code>mount -o compress=zstd /dev/sd<i>xY</i> /mnt/</code>. Durante a configuração, adicione <code>compress=zstd</code> para as opções de montagem do sistema de arquivos raiz no <a href="../pt/Fstab.html" title="Fstab (Português)">fstab</a>.
</p>
<div class="archwiki-template-box archwiki-template-box-tip">
<strong>Tip:</strong> A compactação também pode ser ativada por arquivo sem usar o <code>compress</code> opção de montagem; para fazer isso se aplica <code>chattr +c</code> para o arquivo. Quando aplicado a diretórios, fará com que novos arquivos sejam automaticamente compactados à medida que forem chegando.</div>
<div class="archwiki-template-box archwiki-template-box-warning">
<strong>Atenção:</strong> 
<ul>
<li>Sistemas usando kernels mais antigos ou <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=btrfs-progs">btrfs-progs</a></span> sem <code>zstd</code> o suporte pode não conseguir ler ou reparar seu sistema de arquivos se você usar esta opção.</li>
<li>
<a href="../pt/GRUB.html" title="GRUB (Português)">GRUB</a> introduziu suporte a <i>zstd</i> na versão 2.04. Certifique-se de atualizar o gerenciador de boot instalado na sua MBR/ESP desde então, executando <code>grub-install</code> com as opções apropriadas para a configuração do BIOS/UEFI, pois isso não é feito automaticamente. Veja <a rel="nofollow" class="external text" href="https://bugs.archlinux.org/task/63235">FS#63235</a>.</li>
<li>
<a href="../en/REFInd.html" title="REFInd">rEFInd</a> antes da versão 0.11.4 falta suporte para <i>zstd</i>, mude para <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://aur.archlinux.org/packages/refind-efi-git/">refind-efi-git</a></span><sup><small>AUR</small></sup><sup>[<a href="../en/ArchWiki:Requests.html#Broken_package_links" class="mw-redirect" title="ArchWiki:Requests">link quebrado</a>: package not found]</sup>, use uma partição de inicialização separada sem <i>zstd</i>, ou redefina a compactação dos arquivos de inicialização para algo suportado usando, por exemplo, o comando: <pre>$ btrfs filesystem defragment -v -clzo /boot/*</pre>
</li>
</ul>
</div>
<h4>
<span id="Exibir_tipos_e_propor.C3.A7.C3.B5es_de_compacta.C3.A7.C3.A3o"></span><span class="mw-headline" id="Exibir_tipos_e_proporções_de_compactação">Exibir tipos e proporções de compactação</span>
</h4>
<p><span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=compsize">compsize</a></span> pega uma lista de arquivos (ou um sistema de arquivos btrfs inteiro) e mede os tipos de compressão usados e as taxas de compressão efetivas. O tamanho não compactado pode não corresponder ao número fornecido por outros programas, como <code>du</code>, porque toda extensão é contada uma vez, mesmo que seja refletida várias vezes e mesmo que parte dela não seja mais usada em nenhum lugar, mas não tenha sido coletada como lixo. O <code>-x</code> A opção mantém em um único sistema de arquivos, o que é útil em situações como <code>compsize -x /</code> para evitar que ele tente procurar em subdiretórios não-btrfs e falhe durante toda a execução.
</p>
<h3><span class="mw-headline" id="Subvolumes">Subvolumes</span></h3>
<p>"Um subvolume btrfs não é um dispositivo de bloco (e não pode ser tratado como um) em vez disso, um subvolume btrfs pode ser pensado como um espaço para nome do arquivo POSIX. Este espaço para nome pode ser acessado através do subvolume de nível superior do sistema de arquivos ou pode ser montado por si próprio." <a rel="nofollow" class="external autonumber" href="https://btrfs.wiki.kernel.org/index.php/SysadminGuide#Subvolumes">[2]</a>
</p>
<p>Cada sistema de arquivos Btrfs possui um subvolume de nível superior com o ID 5. Ele pode ser montado como <code>/</code> (por padrão), ou outro subvolume pode ser <a href="#Listando_subvolumes">mountado</a>. Os subvolumes podem ser movimentados no sistema de arquivos e são mais identificados pelo ID do que pelo caminho.
</p>
<p>Consulte os seguintes links para obter mais detalhes:
</p>
<ul>
<li><a rel="nofollow" class="external text" href="https://btrfs.wiki.kernel.org/index.php/SysadminGuide#Subvolumes">Btrfs Wiki SysadminGuide#Subvolumes</a></li>
<li><a rel="nofollow" class="external text" href="https://btrfs.wiki.kernel.org/index.php/Getting_started#Basic_Filesystem_Commands">Btrfs Wiki Getting started#Basic Filesystem Commands</a></li>
<li><a rel="nofollow" class="external text" href="https://btrfs.wiki.kernel.org/index.php/Trees">Btrfs Wiki Trees</a></li>
</ul>
<h4><span class="mw-headline" id="Criando_um_Subvolume">Criando um Subvolume</span></h4>
<p>Para criar um subvolume:
</p>
<pre># btrfs subvolume create <i>/caminho/para/subvolume</i>
</pre>
<h4><span class="mw-headline" id="Listando_subvolumes">Listando subvolumes</span></h4>
<p>Para ver uma lista dos subvolumes atuais e seus IDs em <code><i>caminho</i></code>:
</p>
<pre># btrfs subvolume list -p <i>caminho</i>
</pre>
<h4><span class="mw-headline" id="Excluindo_um_subvolume">Excluindo um subvolume</span></h4>
<p>Para excluir um subvolume:
</p>
<pre># btrfs subvolume delete <i>/caminho/para/subvolume</i>
</pre>
<p>Desde o Linux 4.18, também é possível excluir um subvolume como um diretório regular (<code>rm -r</code>, <code>rmdir</code>).
</p>
<h4><span class="mw-headline" id="Subvolumes_de_montagem">Subvolumes de montagem</span></h4>
<p>Os subvolumes podem ser montados como partições do sistema de arquivos usando a opção de montagem <code>subvol=<i>/caminho/para/subvolume</i></code> ou <code>subvolid=<i>id-do-objeto</i></code>. Por exemplo, você pode ter um subvolume chamado <code>subvol_root</code> e monte-o como <code>/</code>. Pode-se imitar partições tradicionais do sistema de arquivos criando vários subvolumes no nível superior do sistema de arquivos e montando-os nos pontos de montagem apropriados. Assim, é possível restaurar facilmente um sistema de arquivos (ou parte dele) para um estado anterior usando <a href="#Snapshots">#Snapshots</a>.
</p>
<div class="archwiki-template-box archwiki-template-box-tip">
<strong>Tip:</strong> A alteração dos layouts de subvolume é simplificada ao não usar o subvolume de nível superior (ID = 5) como <code>/</code> (o que é feito por padrão). Em vez disso, considere criar um subvolume para abrigar seus dados reais e montá-los como <code>/</code>.</div>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Nota:</strong> De <span class="plainlinks archwiki-template-man" title="$ man 5 btrfs"><a rel="nofollow" class="external text" href="https://man.archlinux.org/man/btrfs.5#MOUNT_OPTIONS">btrfs(5) § MOUNT OPTIONS</a></span>: "A maioria das opções de montagem se aplica ao <b>sistema de arquivos inteiro</b>, e somente as opções para o primeiro subvolume a ser montado entrarão em vigor. Isso ocorre devido à falta de implementação e pode mudar no futuro.". Veja o <a rel="nofollow" class="external text" href="https://btrfs.wiki.kernel.org/index.php/FAQ#Can_I_mount_subvolumes_with_different_mount_options.3F">FAQ da Wiki do Btrfs</a> para quais opções de montagem podem ser usadas por subvolume.</div>
<p>Veja <a href="../en/Snapper.html#Suggested_filesystem_layout" title="Snapper">Snapper#Suggested filesystem layout</a>, <a rel="nofollow" class="external text" href="https://btrfs.wiki.kernel.org/index.php/SysadminGuide#Managing_Snapshots">Btrfs SysadminGuide#Managing Snapshots</a>, e <a rel="nofollow" class="external text" href="https://btrfs.wiki.kernel.org/index.php/SysadminGuide#Layout">Btrfs SysadminGuide#Layout</a> por exemplo, layouts de sistema de arquivos usando subvolumes.
</p>
<p>Veja <span class="plainlinks archwiki-template-man" title="$ man 5 btrfs"><a rel="nofollow" class="external text" href="https://man.archlinux.org/man/btrfs.5">btrfs(5)</a></span> para obter uma lista completa das opções de montagem específicas do btrfs.
</p>
<h4><span class="mw-headline" id="Montando_o_subvolume_como_raiz">Montando o subvolume como raiz</span></h4>
<p>Para usar um subvolume como ponto de montagem raiz, especifique o subvolume por meio de um <a href="../pt/Kernel_parameters.html" class="mw-redirect" title="Parâmetros do kernel">parâmetros do kernel</a> usando <code>rootflags=subvol=<i>/caminho/para/subvolume</i></code>. Edite o ponto de montagem raiz em <code>/etc/fstab</code> e especifique a opção de montagem <code>subvol=</code>. Como alternativa, o subvolume pode ser especificado com seu ID, <code>rootflags=subvolid=<i>id-do-objeto</i></code> como parâmetro do kernel e <code>subvolid=<i>id-do-objeto</i></code> como opção de montagem em <code>/etc/fstab</code>.
</p>
<h4>
<span id="Alterando_o_Subvolume_padr.C3.A3o"></span><span class="mw-headline" id="Alterando_o_Subvolume_padrão">Alterando o Subvolume padrão</span>
</h4>
<p>O subvolume padrão é montado se não houver <code>subvol=</code> opção de montagem é fornecida. Para alterar o subvolume padrão, faça:
</p>
<pre># btrfs subvolume set-default <i>id-do-subvolume</i> /
</pre>
<p>onde <i>id-do-subvolume</i> pode ser encontrado por <a href="#Listando_subvolumes">listando</a>.
</p>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Nota:</strong> Após alterar o subvolume padrão em um sistema com <a href="../pt/GRUB.html" title="GRUB (Português)">GRUB</a>, você deveria executar <code>grub-install</code> novamente para notificar o carregador de inicialização sobre as alterações. Veja <a rel="nofollow" class="external text" href="https://bbs.archlinux.org/viewtopic.php?pid=1615373">este tópico do fórum</a>.</div>
<p>Alterando o subvolume padrão com <code>btrfs subvolume set-default</code> tornará o nível superior do sistema de arquivos inacessível, exceto pelo uso das opções de montagem <code>subvol=/</code> ou <code>subvolid=5</code> <a rel="nofollow" class="external autonumber" href="https://btrfs.wiki.kernel.org/index.php/SysadminGuide">[3]</a>.
</p>
<h3><span class="mw-headline" id="Quota">Quota</span></h3>
<div class="archwiki-template-box archwiki-template-box-warning">
<strong>Atenção:</strong> O Qgroup ainda não está estável e a combinação de quota com (muitos) snapshots de subvolumes pode causar problemas de desempenho, por exemplo, ao excluir snapshots. Além disso, existem vários outros <a rel="nofollow" class="external text" href="https://btrfs.wiki.kernel.org/index.php/Quota_support#Known_issues">problemas conhecidos</a>.</div>
<p>O suporte a quota no Btrfs é implementado em um nível de subvolume pelo uso de grupos de quota ou qgroup: a cada subvolume é atribuído um grupo de quota na forma de <i> 0 / subvolume_id </i> por padrão. No entanto, é possível criar um grupo de cotas usando qualquer número, se desejado.
</p>
<p>Para usar qgroups, você precisa habilitar o quota primeiro usando
</p>
<pre># btrfs quota enable <i>caminho</i>
</pre>
<p>A partir deste ponto, os subvolumes recém-criados serão controlados por esses grupos.
Para habilitá-los retrospectivamente para subvolumes já existentes, ative o quota normalmente, crie um qgroup (grupo de quota) para cada um desses subvolumes usando seu <i> subvolume_id </i> e redigitalize-os:
</p>
<pre># btrfs subvolume list <i>caminho</i> | cut -d' ' -f2 | xargs -I{} -n1 btrfs qgroup create 0/{} <i>caminho</i>
# btrfs quota rescan <i>caminho</i>
</pre>
<p>Grupos de quota no Btrfs formam uma hierarquia de árvore, na qual qgroups são anexados a subvolumes. Os limites de tamanho são definidos por qgroup e se aplicam quando qualquer limite é atingido na árvore que contém um determinado subvolume.
</p>
<p>Os limites dos grupos de quota podem ser aplicados ao uso total de dados, uso não compartilhado de dados, uso de dados compactados ou ambos. A cópia e a exclusão de arquivos podem afetar os limites, pois o limite não compartilhado de outro qgroup pode mudar se os arquivos do volume original forem excluídos e apenas uma cópia restar. Por exemplo, um snapshot novo compartilha quase todos os blocos com o subvolume original; as novas gravações em um subvolume aumentam em direção ao limite exclusivo; as exclusões de dados comuns em um volume aumentam em direção ao limite exclusivo no outro.
</p>
<p>Para aplicar um limite a um qgroup, use o comando <code>btrfs qgroup limit</code>. Dependendo do seu uso, use um limite total, um limite não compartilhado (<code>-e</code>) ou limite compactadot (<code>-c</code>). Para mostrar o uso e os limites de um determinado caminho em um sistema de arquivos, use
</p>
<pre># btrfs qgroup show -reF <i>caminho</i>
</pre>
<h3>
<span id="Intervalo_de_confirma.C3.A7.C3.A3o"></span><span class="mw-headline" id="Intervalo_de_confirmação">Intervalo de confirmação</span>
</h3>
<p>A resolução na qual os dados são gravados no sistema de arquivos é ditada pelo próprio Btrfs e pelas configurações do sistema. O Btrfs assume como padrão um intervalo de ponto de verificação de 30 segundos no qual novos dados são confirmados no sistema de arquivos. Isso pode ser alterado anexando o <code>commit</code> opção de montagem em <code>/etc/fstab</code> para a partição btrfs.
</p>
<pre>LABEL=arch64 / btrfs defaults,noatime,compress=lzo,commit=120 0 0
</pre>
<p>As configurações do sistema também afetam os intervalos de confirmação. Eles incluem os arquivos em <code>/proc/sys/vm/*</code> e estão fora do escopo deste artigo wiki. A documentação do kernel para eles reside em <code>Documentation/sysctl/vm.txt</code>.
</p>
<h3><span class="mw-headline" id="TRIM_do_SSD">TRIM do SSD</span></h3>
<p>Um sistema de arquivos Btrfs pode liberar blocos não utilizados de uma unidade SSD que suporta o comando TRIM. A partir da versão 5.6 do kernel, há suporte a descarte assíncrono, ativado com a opção mount <code>discard=async</code>. As extensões liberadas não são descartadas imediatamente, mas agrupadas e aparadas posteriormente por um thread de trabalho separado, melhorando a latência de consolidação.
</p>
<p>Mais informações sobre como ativar e usar o TRIM podem ser encontradas em <a href="../en/Solid_state_drive.html#TRIM" class="mw-redirect" title="Solid State Drives">Solid State Drives#TRIM</a>.
</p>
<h2><span class="mw-headline" id="Uso">Uso</span></h2>
<h3><span class="mw-headline" id="Arquivo_swap">Arquivo swap</span></h3>
<p><a href="../pt/Swap.html#Arquivo_swap" class="mw-redirect" title="Arquivo swap">Arquivos swap</a> no Btrfs são suportados desde o kernel 5.0 do Linux.<a rel="nofollow" class="external autonumber" href="https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/commit/?id=ed46ff3d423780fa5173b38a844bf0fdb210a2a7">[4]</a> A maneira correta de inicializar um swap file é descrita em <a href="../pt/Swap.html#Cria%C3%A7%C3%A3o_de_arquivo_swap" class="mw-redirect" title="Arquivo swap">Arquivo swap#Criação de arquivo swap</a>. A configuração da hibernação para um swap file é descrita em <a href="../en/Power_management/Suspend_and_hibernate.html#Hibernation_into_swap_file_on_Btrfs" title="Power management/Suspend and hibernate">Power management/Suspend and hibernate#Hibernation into swap file on Btrfs</a>.
</p>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Nota:</strong> Para a versão 5.0 ou superior do kernel, o Btrfs possui suporte nativo ao swap file com algumas limitações:
<ul>
<li>O arquivo swap não pode estar em um subvolume de snapshot. O procedimento apropriado é criar um novo subvolume para colocar o swap file.</li>
<li>Ele não suporta swap files em sistemas de arquivos que abrangem vários dispositivos. Veja <a rel="nofollow" class="external text" href="https://btrfs.wiki.kernel.org/index.php/FAQ#Does_btrfs_support_swap_files.3F">Btrfs wiki: Does btrfs support swap files?</a> e <a rel="nofollow" class="external text" href="https://bbs.archlinux.org/viewtopic.php?pid=1849371#p1849371">Arch forums discussion</a>.</li>
</ul>
</div>
<div class="archwiki-template-box archwiki-template-box-warning">
<strong>Warning:</strong> Os kernels do Linux anteriores à versão 5.0 não suportam swap files. O uso de um swap file com Btrfs e um kernel anterior à 5.0 pode levar à corrupção do sistema de arquivos.</div>
<h3>
<span id="Exibindo_espa.C3.A7o_usado.2Fespa.C3.A7o_livre"></span><span class="mw-headline" id="Exibindo_espaço_usado/espaço_livre">Exibindo espaço usado/espaço livre</span>
</h3>
<p>Ferramentas gerais de espaço de usuário do linux, como <code>df</code> relatará incorretamente o espaço livre em uma partição Btrfs. Recomenda-se usar <code>btrfs filesystem usage</code> para consultar partições Btrfs. Por exemplo:
</p>
<pre># btrfs filesystem usage /
</pre>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Nota:</strong> O <code>btrfs filesystem usage</code> Atualmente, não funciona corretamente com os níveis RAID <code>RAID5/RAID6</code>.</div>
<p>Veja <a rel="nofollow" class="external autonumber" href="https://btrfs.wiki.kernel.org/index.php/FAQ#How_much_free_space_do_I_have.3F">[5]</a> para mais informações.
</p>
<h3>
<span id="Desfragmenta.C3.A7.C3.A3o"></span><span class="mw-headline" id="Desfragmentação">Desfragmentação</span>
</h3>
<p>O Btrfs suporta a desfragmentação online através da opção de montagem <code>autodefrag</code>, veja <span class="plainlinks archwiki-template-man" title="$ man 5 btrfs"><a rel="nofollow" class="external text" href="https://man.archlinux.org/man/btrfs.5#MOUNT_OPTIONS">btrfs(5) § MOUNT OPTIONS</a></span>. Para desfragmentar manualmente sua raiz, use:
</p>
<pre># btrfs filesystem defragment -r /
</pre>
<p>Usando o comando acima sem o <code>-r</code> Essa opção resultará em apenas os metadados mantidos pelo subvolume que contém o diretório sendo desfragmentado. Isso permite a desfragmentação de arquivo único, especificando simplesmente o caminho.
</p>
<p>Desfragmentando um arquivo que possui uma cópia COW (uma cópia de snapshot ou uma feita com <code>cp --reflink</code> ou bcp) além de usar o <code>-c</code> alternar com um algoritmo de compactação pode resultar em dois arquivos não relacionados, aumentando efetivamente o uso do disco.
</p>
<h3><span class="mw-headline" id="RAID">RAID</span></h3>
<p>O Btrfs oferece "RAID" nativo para <a href="#Sistema_de_arquivos_com_v%C3%A1rios_dispositivos">#Sistema de arquivos com vários dispositivos</a>. Recursos notáveis que diferenciam o btrfs RAID do <a href="../en/RAID.html" class="mw-redirect" title="Mdadm">mdadm</a> são matrizes redundantes de autocorreção e balanceamento on-line. Veja <a rel="nofollow" class="external text" href="https://btrfs.wiki.kernel.org/index.php/Using_Btrfs_with_Multiple_Devices">a página wiki do Btrfs</a> Para maiores informações. A página sysadmin do Btrfs também <a rel="nofollow" class="external text" href="https://btrfs.wiki.kernel.org/index.php/SysadminGuide#RAID_and_data_replication">tem uma seção</a> com algum informações mais técnicas.
</p>
<div class="archwiki-template-box archwiki-template-box-warning">
<strong>Atenção:</strong>  O código de paridade RAID (RAID 5/6) possui vários bugs de perda de dados em série. Veja a <a rel="nofollow" class="external text" href="https://btrfs.wiki.kernel.org/index.php/RAID56">página RAID5/6</a> da Wiki do Btrfs e reportes de bugs na <a rel="nofollow" class="external text" href="https://www.mail-archive.com/linux-btrfs@vger.kernel.org/msg55161.html">lista de discussão linux-btrfs</a> para mais informações.</div>
<h3><span class="mw-headline" id="Scrub">Scrub</span></h3>
<p>O <a rel="nofollow" class="external text" href="https://btrfs.wiki.kernel.org/index.php/Glossary">Glossário da Btrfs Wiki</a> afirma que o Btrfs scrub é "[uma] ferramenta de verificação de sistema de arquivos on-line. Lê todos os dados e metadados no sistema de arquivos e usa somas de verificação e cópias duplicadas do armazenamento RAID para identificar e reparar dados corrompidos".
</p>
<div class="archwiki-template-box archwiki-template-box-warning">
<strong>Warning:</strong> Um processo scrub em execução vai impedir o sistema de suspender, veja <a rel="nofollow" class="external text" href="http://comments.gmane.org/gmane.comp.file-systems.btrfs/33106">esta discussão</a><sup>[<a href="https://en.wikipedia.org/wiki/Wikipedia:Link_rot" class="extiw" title="wikipedia:Wikipedia:Link rot">dead link</a> 2020-02-23]</sup> para detalhes.</div>
<h4><span class="mw-headline" id="Iniciar_manualmente">Iniciar manualmente</span></h4>
<p>Para iniciar uma limpeza (em segundo plano) no sistema de arquivos que contém <code>/</code>:
</p>
<pre># btrfs scrub start /
</pre>
<p>Para verificar o status de uma limpeza em execução:
</p>
<pre># btrfs scrub status /
</pre>
<h4>
<span id="Comece_com_um_servi.C3.A7o_ou_cron.C3.B4metro"></span><span class="mw-headline" id="Comece_com_um_serviço_ou_cronômetro">Comece com um serviço ou cronômetro</span>
</h4>
<p>O pacote <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=btrfs-progs">btrfs-progs</a></span> traz o <code>btrfs-scrub@.timer</code> para executar o scrub mensalmente no ponto de montagem especificado. <a href="../pt/Systemd.html#Usando_units" class="mw-redirect" title="Habilite">Habilite</a> o temporizador com um caminho de escape, <code>btrfs-scrub@-.timer</code> para <code>/</code> e <code>btrfs-scrub@home.timer</code> para <code>/home</code>. Você pode usar <code>systemd-escape -p <i>/path/to/mountpoint</i></code> para escapar do path, veja <span class="plainlinks archwiki-template-man" title="$ man 1 systemd-escape"><a rel="nofollow" class="external text" href="https://man.archlinux.org/man/systemd-escape.1">systemd-escape(1)</a></span> para detalhes.
</p>
<p>Você também pode executar o scrub <a href="../pt/Systemd.html#Usando_units" class="mw-redirect" title="Inicia">iniciando</a> o <code>btrfs-scrub@.service</code> (com o mesmo caminho codificado). A vantagem disso sobre <code>btrfs scrub</code> (como usuário root) é que os resultados da limpeza serão registrados no <a href="../pt/508d3afdfb62d49d74039238ef71cd04.html" class="mw-redirect" title="Journal do systemd">journal do systemd</a>.
</p>
<h3><span class="mw-headline" id="Balance">Balance</span></h3>
<p>"O balance passa todos os dados no sistema de arquivos pelo alocador novamente. Destina-se principalmente a reequilibrar os dados no sistema de arquivos entre os dispositivos quando um dispositivo é adicionado ou removido. O balance regenerará cópias ausentes dos níveis redundantes de RAID, se um dispositivo falhou."<a rel="nofollow" class="external autonumber" href="https://btrfs.wiki.kernel.org/index.php/Glossary">[6]</a> Veja a <a rel="nofollow" class="external text" href="https://btrfs.wiki.kernel.org/index.php/FAQ#What_does_.22balance.22_do.3F">página FAQ</a>.
</p>
<p>Em um sistema de arquivos de dispositivo único, o balance também pode ser útil para (temporariamente) reduzir a quantidade de blocos de dados alocados, mas não utilizados (meta). Às vezes, isso é necessário para corrigir <a rel="nofollow" class="external text" href="https://btrfs.wiki.kernel.org/index.php/FAQ#Help.21_Btrfs_claims_I.27m_out_of_space.2C_but_it_looks_like_I_should_have_lots_left.21">problemas "filesystem full"</a>.
</p>
<pre># btrfs balance start /
# btrfs balance status /
</pre>
<h3><span class="mw-headline" id="Snapshots">Snapshots</span></h3>
<p>"Um snapshot é simplesmente um subvolume que compartilha seus dados (e metadados) com outros subvolumes, usando os recursos btrfs COW ". Veja o <a rel="nofollow" class="external text" href="https://btrfs.wiki.kernel.org/index.php/SysadminGuide#Snapshots">SysadminGuide#Snapshots da Wiki do Btrfs</a> para detalhes.
</p>
<p>Para criar um snapshot:
</p>
<pre># btrfs subvolume snapshot <i>fonte</i> [<i>destino</i>/]<i>nome</i>
</pre>
<p>Para criar um snapshot somente leitura, adicione a opção <code>-r</code>. Para criar uma versão modificável de um snapshot somente leitura, basta criar um snapshot.
</p>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Nota:</strong> Os snapshots não são recursivos. Todo subvolume aninhado será um diretório vazio dentro do snapshot.</div>
<h3>
<span id="Enviar.2Freceber"></span><span class="mw-headline" id="Enviar/receber">Enviar/receber</span>
</h3>
<p>Um subvolume pode ser enviado para stdout ou um arquivo usando o <code>send</code> comando. Isso geralmente é mais útil quando direcionado para o comando do Btrfs <code>receive</code>. Por exemplo, para enviar um snapshot chamado <code>/backup_da_raiz</code> (talvez de um snapshot que você fez do <code>/</code> mais cedo) para <code>/backup</code> você faria o seguinte:
</p>
<pre> # btrfs send /backup_da_raiz | btrfs receive /backup
</pre>
<p>O snapshot enviado <i>deve</i> ser somente leitura. O comando acima é útil para copiar um subvolume para um dispositivo externo (por exemplo, um dispositivo USB montado em <code>/backup</code>).
</p>
<p>Você também pode enviar apenas a diferença entre dois snapshots. Por exemplo, se você já enviou uma cópia do <code>backup_da_raiz</code> acima e criaram um novo instantâneo somente leitura em seu sistema chamado <code>root_backup_new</code>, para enviar apenas a diferença incremental para <code>/backup</code>:
</p>
<pre> # btrfs send -p /backup_da_raiz /novo_backup_da_raiz | btrfs receive /backup
</pre>
<p>Agora, um novo subvolume chamado <code>novo_backup_da_raiz</code> estará presente em <code>/backup</code>.
</p>
<p>Veja a <a rel="nofollow" class="external text" href="https://btrfs.wiki.kernel.org/index.php/Incremental_Backup">página da Wiki do Btrfs sobre Backup incremental</a>, para saber como usá-lo e ferramentas que automatizam o processo.
</p>
<h3>
<span id="Desduplica.C3.A7.C3.A3o"></span><span class="mw-headline" id="Desduplicação">Desduplicação</span>
</h3>
<p>Usando copy-on-write, O Btrfs pode copiar arquivos ou subvolumes inteiros sem copiar os dados. No entanto, sempre que um arquivo é alterado, uma nova cópia <i> adequada </i> é criada. A desduplicação leva isso um passo adiante, identificando ativamente blocos de dados que compartilham seqüências comuns e combinando-os em uma extensão com a mesma semântica copy-on-write.
</p>
<p>As ferramentas dedicadas para desduplicar uma partição formatada em Btrfs incluem <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=duperemove">duperemove</a></span>, <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://aur.archlinux.org/packages/bedup/">bedup</a></span><sup><small>AUR</small></sup> e <i>btrfs-dedup</i>. Pode-se também querer desduplicar dados em um nível baseado em arquivo, usando <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=rmlint">rmlint</a></span> ou <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://aur.archlinux.org/packages/jdupes/">jdupes</a></span><sup><small>AUR</small></sup>. Para uma visão geral dos recursos disponíveis desses programas e informações adicionais, consulte essa <a rel="nofollow" class="external text" href="https://btrfs.wiki.kernel.org/index.php/Deduplication#Batch">página da Wiki</a>.
</p>
<p>Além disso, os desenvolvedores do Btrfs estão trabalhando na desduplicação inband (também conhecida como síncrona ou inline), o que significa que a desduplicação é feita ao gravar novos dados no sistema de arquivos. Atualmente, ainda é um experimento desenvolvido fora da árvore. Usuários dispostos a testar o novo recurso devem ler a <a rel="nofollow" class="external text" href="https://btrfs.wiki.kernel.org/index.php/User_notes_on_dedupe">página apropriada da wiki do kernel</a>.
</p>
<h2><span class="mw-headline" id="Problemas_conhecidos">Problemas conhecidos</span></h2>
<p>Algumas limitações devem ser conhecidas antes de tentar.
</p>
<h3><span class="mw-headline" id="Criptografia">Criptografia</span></h3>
<p>O Btrfs não tem suporte nativo à criptografia, mas <a rel="nofollow" class="external text" href="https://lwn.net/Articles/700487/">pode</a> ter no futuro. Os usuários podem criptografar a partição antes de executar <code>mkfs.btrfs</code>. Veja <a href="../pt/bd347841f13524ba6da3458e094be74d.html#Subvolumes_do_Btrfs_com_swap" class="mw-redirect" title="Dm-crypt/Criptografando todo um sistema">dm-crypt/Criptografando todo um sistema#Subvolumes do Btrfs com swap</a>.
</p>
<p>Os sistemas de arquivos Btrfs existentes podem usar algo como <a href="../en/EncFS.html" title="EncFS">EncFS</a> ou <a href="../en/TrueCrypt.html" title="TrueCrypt">TrueCrypt</a>, embora talvez sem alguns dos recursos do Btrfs.
</p>
<h3><span class="mw-headline" id="TLP">TLP</span></h3>
<p>Usando TLP requer precauções especiais para evitar a corrupção do sistema de arquivos. Consulte a <a href="../en/TLP.html#Btrfs" title="TLP">seção TLP</a> Para maiores informações.
</p>
<h3>
<span id="Problemas_de_verifica.C3.A7.C3.A3o_do_btrfs"></span><span class="mw-headline" id="Problemas_de_verificação_do_btrfs">Problemas de verificação do btrfs</span>
</h3>
<p>A ferramenta <code>btrfs check</code> possui problemas conhecidos e não deve ser executada sem leitura adicional, consulte a seção <a href="#Verifica%C3%A7%C3%A3o_do_Btrfs">#Verificação do Btrfs</a>.
</p>
<h2><span class="mw-headline" id="Dicas_e_truques">Dicas e truques</span></h2>
<h3>
<span id="Disco_Btrfs_sem_parti.C3.A7.C3.A3o"></span><span class="mw-headline" id="Disco_Btrfs_sem_partição">Disco Btrfs sem partição</span>
</h3>
<div class="archwiki-template-box archwiki-template-box-warning">
<strong>Atenção:</strong> A maioria dos usuários não deseja esse tipo de instalação e, em vez disso, deve instalar o Btrfs em uma partição regular. Além disso, o GRUB desencoraja fortemente a instalação em um disco sem partição. Considere usar <code>--alloc-start</code> para mkfs.btrfs para dar grande espaço ao GRUB. </div>
<p>O Btrfs pode ocupar um dispositivo de armazenamento de dados inteiro, substituindo o <a href="../pt/Partitioning.html#Master_Boot_Record" class="mw-redirect" title="MBR (Português)">MBR</a> ou <a href="../pt/Partitioning.html#Tabela_de_Parti%C3%A7%C3%A3o_GUID" class="mw-redirect" title="GPT (Português)">GPT</a> esquemas de particionamento, usando <a href="#Subvolumes">subvolumes</a> para simular partições. No entanto, não é necessário usar uma configuração sem partição para simplesmente <a href="#Cria%C3%A7%C3%A3o_do_sistema_de_arquivos">Criação do sistema de arquivos</a> em uma <a href="../pt/Partitioning.html" class="mw-redirect" title="Partição">partição</a> existente que foi criada usando outro método. Existem algumas limitações nas configurações de disco único sem partição:
</p>
<ul>
<li>Não pode colocar outro <a href="../pt/File_systems.html" class="mw-redirect" title="Sistema de arquivos">sistema de arquivos</a> em outra partição no mesmo disco.</li>
<li>Se você estiver usando uma versão do kernel Linux anterior à 5.0, não poderá usar <a href="../pt/Swap.html" title="Swap (Português)">swap</a> já que o Btrfs ainda não suportava <a href="../pt/Swap.html#Arquivo_swap" title="Swap (Português)">arquivos swap</a> antes do kernel 5.0 e não há espaço para criar uma <a href="../pt/Swap.html#Parti%C3%A7%C3%A3o_swap" title="Swap (Português)">partição swap</a>
</li>
<li>Não pode usar <a href="../en/Unified_Extensible_Firmware_Interface.html" class="mw-redirect" title="UEFI">UEFI</a> para inicializar.</li>
</ul>
<p>Para substituir a tabela de partição existente com Btrfs, execute o seguinte comando:
</p>
<pre># mkfs.btrfs /dev/sd<i>X</i>
</pre>
<p>Por exemplo, use <code>/dev/sda</code> ao invés de <code>/dev/sda1</code>. O último formata uma partição existente em vez de substituir todo o esquema de particões. Como a partição raiz está em Btrfs, verifique se <code>btrfs</code> é compilado no kernel, ou coloque <code>btrfs</code> dentro do <a href="../pt/Mkinitcpio.html#MODULES" title="Mkinitcpio (Português)">arranjo MODULES do mkinitcpio</a> e <a href="../pt/Mkinitcpio.html#Cria%C3%A7%C3%A3o_e_ativa%C3%A7%C3%A3o_de_imagem" class="mw-redirect" title="Gere novamente o initramfs">gere novamente o initramfs</a>.
</p>
<p>Instale o <a href="../pt/Arch_boot_process.html#Gerenciador_de_boot" class="mw-redirect" title="Gerenciador de boot">gerenciador de boot</a> como você faria para um dispositivo de armazenamento de dados com <a href="../pt/Partitioning.html#Master_Boot_Record" class="mw-redirect" title="MBR (Português)">Master Boot Record</a>. Veja <a href="../en/Syslinux.html#Manual_install" title="Syslinux">Syslinux#Manual install</a> ou  <a href="../en/GRUB/Tips_and_tricks.html#Install_to_partition_or_partitionless_disk" title="GRUB/Tips and tricks">GRUB/Tips and tricks#Install to partition or partitionless disk</a>. Se o seu kernel não inicializar devido a <code>Failed to mount /sysroot.</code>, por favor adicione <code>GRUB_PRELOAD_MODULES="btrfs"</code> em <code>/etc/default/grub</code> e gere a configuração do grub (<a href="../pt/GRUB.html#Gerar_o_arquivo_de_configura%C3%A7%C3%A3o_principal" title="GRUB (Português)">GRUB#Gerar o arquivo de configuração principal</a>).
</p>
<h3>
<span id="Convers.C3.A3o_Ext3.2F4_para_Btrfs"></span><span class="mw-headline" id="Conversão_Ext3/4_para_Btrfs">Conversão Ext3/4 para Btrfs</span>
</h3>
<div class="archwiki-template-box archwiki-template-box-warning">
<strong>Atenção:</strong> Existem muitos relatórios na lista de discussão btrfs sobre conversões incompletas / corrompidas / quebradas. Verifique se você tem backups <i>válidos</i> de todos os dados que não pode perder. Veja <a rel="nofollow" class="external text" href="https://btrfs.wiki.kernel.org/index.php/Conversion_from_Ext3">Conversão Ext3</a> ou a wiki do btrfs para mais informações.</div>
<p>Inicialize a partir de um CD de instalação e depois converta:
</p>
<pre># btrfs-convert /dev/<i>partição</i>
</pre>
<p>Monte a partição e teste a conversão verificando os arquivos. Certifique-se de alterar o <code>/etc/fstab</code> refletir a mudança (<b>type</b> para <code>btrfs</code> e <b>fs_passno</b> [o ultimo campo] para <code>0</code> porque o Btrfs não faz uma verificação do sistema de arquivos na inicialização). Observe também que o UUID da partição será alterado, portanto, atualize o fstab adequadamente ao usar UUIDs. <code>chroot</code> no sistema e reconstrua a lista de menus do GRUB (veja <a href="../pt/Install_Arch_Linux_from_existing_Linux.html" class="mw-redirect" title="Instalar a partir de um Linux existente">Instalar a partir de um Linux existente</a> e artigos <a href="../pt/GRUB.html" title="GRUB (Português)">GRUB</a>). Se estiver convertendo um sistema de arquivos raiz, enquanto ainda estiver em chroot, execute <code>mkinitcpio -p linux</code>  para regenerar o initramfs ou o sistema não inicializará com êxito. Se você ficar preso no grub com 'sistema de arquivos desconhecido', tente reinstalar o grub com <code>grub-install /dev/<i>partição</i></code> e gere novamente a configuração <code>grub-mkconfig -o /boot/grub/grub.cfg</code>.
</p>
<p>Depois de confirmar que não há problemas, conclua a conversão excluindo o backup <code>ext2_saved</code> subvolume. Observe que você não pode voltar ao ext3/4 sem ele.
</p>
<pre># btrfs subvolume delete /ext2_saved
</pre>
<p>Finalmente <a href="#Balance">balance</a> o sistema de arquivos para recuperar o espaço.
</p>
<p>Lembre-se de que alguns aplicativos que foram instalados anteriormente precisam ser adaptados ao Btrfs. Notavelmente <a href="../en/TLP.html#Btrfs" title="TLP">TLP#Btrfs</a> precisa de cuidados especiais para evitar a corrupção do sistema de arquivos, mas outros aplicativos também podem se beneficiar de certos recursos.
</p>
<h3>
<span id="Acelera.C3.A7.C3.A3o_de_hardware_de_soma_de_verifica.C3.A7.C3.A3o"></span><span class="mw-headline" id="Aceleração_de_hardware_de_soma_de_verificação">Aceleração de hardware de soma de verificação</span>
</h3>
<p>O CRC32 é uma nova instrução no Intel SSE4.2. Para verificar se a soma de verificação Btrfs é acelerada por hardware:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">$ dmesg | grep crc32c</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">Btrfs loaded, crc32c=crc32c-intel</pre>
<p>Se você ver <code>crc32c=crc32c-generic</code>, provavelmente é porque sua partição raiz é Btrfs, e você terá que compilar <code>crc32c-intel</code> no kernel para fazê-lo funcionar. Colocando <code>crc32c-intel</code> para dentro do <a href="../pt/Mkinitcpio.html" title="Mkinitcpio (Português)">mkinitcpio.conf</a> <i>não</i> vai funcionar.
</p>
<h3>
<span id="Recupera.C3.A7.C3.A3o_de_corrup.C3.A7.C3.A3o"></span><span class="mw-headline" id="Recuperação_de_corrupção">Recuperação de corrupção</span>
</h3>
<div class="archwiki-template-box archwiki-template-box-warning">
<strong>Atenção:</strong> A ferramenta <code>btrfs check</code> tem problemas conhecidos, consulte a seção <a href="#Verifica%C3%A7%C3%A3o_do_Btrfs">#Verificação do Btrfs</a>
</div>
<p><i>btrfs-check</i> não pode ser usado em um sistema de arquivos montado. Para poder usar o <i> btrfs-check</i> sem inicializar a partir de um USB ativo, adicione-o ao disco RAM inicial:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/mkinitcpio.conf</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">BINARIES=("/usr/bin/btrfs")</pre>
<p><a href="../pt/Mkinitcpio.html#Cria%C3%A7%C3%A3o_e_ativa%C3%A7%C3%A3o_de_imagem" class="mw-redirect" title="Gere novamente o initramfs">Gere novamente o initramfs</a>.
</p>
<p>Se houver um problema na inicialização, o utilitário estará disponível para reparo.
</p>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Nota:</strong> Se o processo fsck precisar invalidar o cache de espaço (e/ou outros caches?) é normal que uma inicialização subsequente seja interrompida por um tempo (isso pode gerar mensagens do console sobre a interrupção da transação btrfs). O sistema deve se recuperar disso depois de um tempo.</div>
<p>Veja a <a rel="nofollow" class="external text" href="https://btrfs.wiki.kernel.org/index.php/Btrfsck">página da Wiki do Btrfs</a> para mais informações.
</p>
<h3><span class="mw-headline" id="Inicializando_em_snapshots">Inicializando em snapshots</span></h3>
<p>Para inicializar em um snapshot, o mesmo procedimento se aplica à montagem de um subvolume como sua partição raiz, conforme fornecido na seção <a href="#Montando_o_subvolume_como_raiz">montando um subvolume como sua partição raiz</a>, porque os instantâneos podem ser montados como subvolumes.
Se você estiver usando o GRUB, poderá preencher automaticamente o menu de inicialização com os instantâneos btrfs ao gerar novamente o arquivo de configuração com a ajuda do <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=grub-btrfs">grub-btrfs</a></span> ou <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://aur.archlinux.org/packages/grub-btrfs-git/">grub-btrfs-git</a></span><sup><small>AUR</small></sup>.
</p>
<h3><span class="mw-headline" id="Use_subvolumes_Btrfs_com_systemd-nspawn">Use subvolumes Btrfs com systemd-nspawn</span></h3>
<p>Veja os artigos <a href="../en/Systemd-nspawn.html#Use_Btrfs_subvolume_as_container_root" title="Systemd-nspawn">Systemd-nspawn#Use Btrfs subvolume as container root</a> e <a href="../en/Systemd-nspawn.html#Use_temporary_Btrfs_snapshot_of_container" title="Systemd-nspawn">Systemd-nspawn#Use temporary Btrfs snapshot of container</a>.
</p>
<h2>
<span id="Solu.C3.A7.C3.A3o_de_problemas"></span><span class="mw-headline" id="Solução_de_problemas">Solução de problemas</span>
</h2>
<p>Veja o <a rel="nofollow" class="external text" href="https://btrfs.wiki.kernel.org/index.php/Problem_FAQ">FAQ de problemas do Btrfs</a> para solução de problemas gerais.
</p>
<h3><span class="mw-headline" id="GRUB">GRUB</span></h3>
<h4>
<span id="Deslocamento_da_parti.C3.A7.C3.A3o"></span><span class="mw-headline" id="Deslocamento_da_partição">Deslocamento da partição</span>
</h4>
<p>O problema de deslocamento pode ocorrer quando você tenta incorporar <code>core.img</code> em um disco particionado. Significa que <a rel="nofollow" class="external text" href="https://wiki.archlinux.org/index.php?title=Talk:Btrfs&amp;diff=319474&amp;oldid=292530">está tudo bem</a> para incorporar o grub <code>core.img</code> em um pool Btrfs em um disco sem partição (por exemplo <code>/dev/sd<i>X</i></code>) diretamente.
</p>
<p><a href="../pt/GRUB.html" title="GRUB (Português)">GRUB</a> pode inicializar partições Btrfs, no entanto, o módulo pode ser maior que outros <a href="../pt/File_systems.html" class="mw-redirect" title="Sistemas de arquivos">sistemas de arquivos</a>. E o arquivo <code>core.img</code> feito por <code>grub-install</code> pode não caber nos primeiros 63 setores (31,5 KiB) da unidade entre o MBR e a primeira partição. Ferramentas de particionamento atualizadas, como <code> fdisk</code> e <code> gdisk</code> evitam esse problema compensando a primeira partição em aproximadamente 1MiB ou 2MiB.
</p>
<h4><span class="mw-headline" id="Raiz_ausente">Raiz ausente</span></h4>
<div class="noprint archwiki-template-message">
<p><a href="../File:Tango-inaccurate.png" class="image"><img alt="Tango-inaccurate.png" src="../File:Tango-inaccurate.png" decoding="async" width="48" height="48"></a><b>The factual accuracy of this article or section is disputed.</b><a href="../File:Tango-inaccurate.png" class="image"><img alt="Tango-inaccurate.png" src="../File:Tango-inaccurate.png" decoding="async" width="48" height="48"></a></p>
<div>
<b>Reason:</b> Sugerir não editar um arquivo de configuração manualmente. (Discuss in <a rel="nofollow" class="external text" href="https://wiki.archlinux.org/index.php/Talk:Btrfs#Should_not_suggest_to_edit_files_in_/usr/share">Talk:Btrfs#Should not suggest to edit files in /usr/share</a>)</div>
</div>
<p>Usuários com o seguinte: <code>error no such device: root</code> ao inicializar a partir de uma configuração de estilo RAID, edite /usr /share /grub /grub-mkconfig lib e remova as duas aspas da linha <code>echo "  search --no-floppy --fs-uuid --set=root ${hints} ${fs_uuid}"</code>. Gere novamente a configuração do grub e o sistema deverá inicializar sem erros.
</p>
<h3><span class="mw-headline" id="BTRFS:_open_ctree_falhou">BTRFS: open_ctree falhou</span></h3>
<p>Em novembro de 2014, parece haver um bug no <a href="../pt/Systemd.html" title="Systemd (Português)">systemd</a> ou no <a href="../pt/Mkinitcpio.html" title="Mkinitcpio (Português)">mkinitcpio</a> causando o seguinte erro em sistemas que usam Btrfs em vários dispositivos usando o hook <code>btrfs</code> em <code>mkinitcpio.conf</code>:
</p>
<pre>BTRFS: open_ctree failed
mount: wrong fs type, bad option, bad superblock on /dev/sdb2, missing codepage or helper program, or other error

In some cases useful info is found in syslog - try dmesg|tail or so.

You are now being dropped into an emergency shell.
</pre>
<p>Uma solução é remover <code>btrfs</code> do vetor <code>HOOKS</code> em <code>/etc/mkinitcpio.conf</code> e adicionar <code>btrfs</code> no vetor <code>MODULES</code>. Em seguida, <a href="../pt/Mkinitcpio.html#Cria%C3%A7%C3%A3o_e_ativa%C3%A7%C3%A3o_de_imagem" class="mw-redirect" title="Gere novamente o initramfs">gere novamente o initramfs</a> e reinicie.
</p>
<p>Você receberá o mesmo erro se tentar montar um arranjo raid sem um dos dispositivos. Nesse caso, você deve adicionar a opção de montagem <code>degraded</code> para <code>/etc/fstab</code>. Se sua raiz reside na matriz, você também deve adicionar <code>rootflags=degraded</code> para os <a href="../pt/Kernel_parameters.html" class="mw-redirect" title="Parâmetros do kernel">parâmetros do kernel</a>.
</p>
<p>Desde agosto de 2016, uma solução em potencial para esse bug é montar o arranjo por uma única unidade apenas em <code>/etc/fstab</code>, e permita que o btrfs descubra e acrescente as outras unidades automaticamente. Identificadores baseados em grupo, como UUID e LABEL, parecem contribuir para a falha. Por exemplo, uma arranjo RAID1 de dois dispositivos que consiste em 'disco1' e 'disco2' terá um UUID alocado, mas em vez de usar o UUID, use apenas <code>/dev/mapper/disco1</code> no <code>/etc/fstab</code>. Para uma explicação mais detalhada, consulte a seguinte <a rel="nofollow" class="external text" href="https://blog.samcater.com/fix-for-btrfs-open_ctree-failed-when-running-root-fs-on-raid-1-or-raid10-arch-linux/">postagem no blog</a><sup title="Status da última verificação: 404">[<a href="https://en.wikipedia.org/wiki/pt:Wikip%C3%A9dia:Liga%C3%A7%C3%A3o_inativa" class="extiw" title="wikipedia:pt:Wikipédia:Ligação inativa">link inativo</a> 2020-08-02 ⓘ]</sup>.
</p>
<p>Outra solução possível é remover o hook <code>udev</code> no <a href="../pt/Mkinitcpio.html" title="Mkinitcpio (Português)">mkinitcpio.conf</a> e substitua ele pelo hook <code>systemd</code>. Nesse caso, <code>btrfs</code> <b>não</b> deve estar nos vetores <code>HOOKS</code> ou <code>MODULES</code>.
</p>
<p>Veja a <a rel="nofollow" class="external text" href="https://bbs.archlinux.org/viewtopic.php?id=189845">discussão no forum</a> e <a rel="nofollow" class="external text" href="https://bugs.archlinux.org/task/42884">FS#42884</a> para mais informações e discussão.
</p>
<h3>
<span id="Verifica.C3.A7.C3.A3o_do_Btrfs"></span><span class="mw-headline" id="Verificação_do_Btrfs">Verificação do Btrfs</span>
</h3>
<div class="archwiki-template-box archwiki-template-box-warning">
<strong>Atenção:</strong> Como o Btrfs está em forte desenvolvimento, especialmente o comando <code>btrfs check</code> é altamente recomendado criar um <b>backup</b> e consulte a <a rel="nofollow" class="external text" href="https://btrfs.wiki.kernel.org/index.php/Btrfsck">Documentação do Btrfsck</a> antes de executar <code>btrfs check</code> com o <code>--repair</code>.</div>
<p>O comando <i><a rel="nofollow" class="external text" href="https://btrfs.wiki.kernel.org/index.php/Manpage/btrfs-check">btrfs check</a></i> pode ser usado para verificar ou reparar um sistema de arquivos Btrfs não montado. No entanto, essa ferramenta de reparo ainda é imatura e não é capaz de reparar certos erros do sistema de arquivos, mesmo aqueles que não tornam o sistema de arquivos desmontável.
</p>
<h2>
<span id="Veja_tamb.C3.A9m"></span><span class="mw-headline" id="Veja_também">Veja também</span>
</h2>
<ul>
<li>
<b>Site oficial</b>
<ul><li><a rel="nofollow" class="external text" href="https://btrfs.wiki.kernel.org/">Btrfs Wiki</a></li></ul>
</li>
<li>
<b>Relacionado com desempenho</b>
<ul>
<li><a rel="nofollow" class="external text" href="https://superuser.com/questions/432188/should-i-put-my-multi-device-btrfs-filesystem-on-disk-partitions-or-raw-devices">Btrfs on raw disks?</a></li>
<li><a rel="nofollow" class="external text" href="https://www.spinics.net/lists/linux-btrfs/msg18652.html">Varying leafsize and nodesize in Btrfs</a></li>
<li>
<a rel="nofollow" class="external text" href="http://comments.gmane.org/gmane.comp.file-systems.btrfs/15646">Btrfs support for efficient SSD operation (data blocks alignment)</a><sup>[<a href="https://en.wikipedia.org/wiki/Wikipedia:Link_rot" class="extiw" title="wikipedia:Wikipedia:Link rot">dead link</a> 2020-02-23]</sup>
</li>
<li><a rel="nofollow" class="external text" href="https://btrfs.wiki.kernel.org/index.php/FAQ#Is_Btrfs_optimized_for_SSD.3F">Is Btrfs optimized for SSDs?</a></li>
<li>
<b>Benchmark de opções de montagem do Phoronix</b>
<ul>
<li><a rel="nofollow" class="external text" href="http://www.phoronix.com/scan.php?page=article&amp;item=btrfs-mount-linux49">Linux 4.9</a></li>
<li><a rel="nofollow" class="external text" href="http://www.phoronix.com/scan.php?page=article&amp;item=linux_314_btrfs">Linux 3.14</a></li>
<li><a rel="nofollow" class="external text" href="http://www.phoronix.com/scan.php?page=article&amp;item=linux_btrfs_311&amp;num=1">Linux 3.11</a></li>
<li><a rel="nofollow" class="external text" href="http://www.phoronix.com/scan.php?page=news_item&amp;px=MTM0OTU">Linux 3.9</a></li>
<li><a rel="nofollow" class="external text" href="http://www.phoronix.com/scan.php?page=article&amp;item=btrfs_linux37_mounts&amp;num=1">Linux 3.7</a></li>
<li><a rel="nofollow" class="external text" href="http://www.phoronix.com/scan.php?page=article&amp;item=linux_btrfs_options&amp;num=1">Linux 3.2</a></li>
</ul>
</li>
<li><a rel="nofollow" class="external text" href="http://blog.erdemagaoglu.com/post/4605524309/lzo-vs-snappy-vs-lzf-vs-zlib-a-comparison-of">Lzo vs. zLib</a></li>
</ul>
</li>
<li>
<b>Diversos</b>
<ul>
<li><a rel="nofollow" class="external text" href="http://www.funtoo.org/wiki/BTRFS_Fun">Funtoo Wiki Btrfs Fun</a></li>
<li>
<a rel="nofollow" class="external text" href="http://www.phoronix.com/scan.php?page=news_item&amp;px=MTA0ODU">Avi Miller presenting Btrfs</a> at SCALE 10x, January 2012.</li>
<li>
<a rel="nofollow" class="external text" href="http://www.phoronix.com/scan.php?page=news_item&amp;px=MTA4Mzc">Summary of Chris Mason's talk</a> from LFCS 2012</li>
<li>
<a rel="nofollow" class="external text" href="https://git.kernel.org/?p=linux/kernel/git/torvalds/linux-2.6.git;a=commit;h=35054394c4b3cecd52577c2662c84da1f3e73525">Btrfs: stop providing a bmap operation to avoid swapfile corruptions</a> 2009-01-21</li>
<li><a rel="nofollow" class="external text" href="http://marc.merlins.org/perso/btrfs/post_2014-03-22_Btrfs-Tips_-Doing-Fast-Incremental-Backups-With-Btrfs-Send-and-Receive.html">Doing Fast Incremental Backups With Btrfs Send and Receive</a></li>
</ul>
</li>
</ul>
</div>
</div>
<div id="catlinks" class="catlinks" data-mw="interface">
<div id="mw-normal-catlinks" class="mw-normal-catlinks">
<a href="../Special:Categories.html" title="Special:Categories">Category</a>: <ul><li><a href="../pt/Category:File_systems.html" title="Category:File systems (Português)">File systems (Português)</a></li></ul>
</div>
<div id="mw-hidden-catlinks" class="mw-hidden-catlinks mw-hidden-cats-hidden">Hidden categories: <ul>
<li><a href="../en/Category:Pages_with_broken_package_links.html" title="Category:Pages with broken package links">Pages with broken package links</a></li>
<li><a href="../en/Category:Pages_with_dead_links.html" title="Category:Pages with dead links">Pages with dead links</a></li>
<li><a href="../en/Category:Pages_or_sections_flagged_with_Template:Accuracy.html" title="Category:Pages or sections flagged with Template:Accuracy">Pages or sections flagged with Template:Accuracy</a></li>
</ul>
</div>
</div>
	</div>
</div>

<footer id="footer" class="mw-footer" role="contentinfo" style="margin: 0">
	<ul id="footer-info">
		<li>Retrieved from "<a dir="ltr" href="https://wiki.archlinux.org/index.php?title=Btrfs_(Portugu%C3%AAs)&amp;oldid=638068">https://wiki.archlinux.org/index.php?title=Btrfs_(Português)&amp;oldid=638068</a>"</li>
		<li id="footer-info-lastmod"> This page was last edited on 14 October 2020, at 07:03.</li>
		<li id="footer-info-copyright">Content is available under <a class="external" rel="nofollow" href="http://www.gnu.org/copyleft/fdl.html">GNU Free Documentation License 1.3 or later</a> unless otherwise noted.</li>
	<br>
</ul>
	<ul id="footer-places">
		<li id="footer-places-privacy"><a href="../en/ArchWiki:Privacy_policy.html" title="ArchWiki:Privacy policy">Privacy policy</a></li>
		<li id="footer-places-about"><a href="../en/ArchWiki:About.html" title="ArchWiki:About">About ArchWiki</a></li>
		<li id="footer-places-disclaimer"><a href="../en/ArchWiki:General_disclaimer.html" title="ArchWiki:General disclaimer">Disclaimers</a></li>
	</ul>
	<ul id="footer-icons" class="noprint">
		<li id="footer-copyrightico">
	</ul>
	<div style="clear: both;"></div>
</footer>



</body>
</html>
