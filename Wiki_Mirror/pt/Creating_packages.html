<!DOCTYPE html>
<html class="client-nojs" lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<title>Creating packages (Português) - ArchWiki</title>
<link rel="stylesheet" href="../ArchWikiOffline.css">
<meta name="ResourceLoaderDynamicStyles" content="">
<meta name="generator" content="MediaWiki 1.35.0">
<meta name="referrer" content="no-referrer-when-downgrade">
<meta name="robots" content="noindex,follow">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="shortcut icon" href="/favicon.ico">
<link rel="search" type="application/opensearchdescription+xml" href="/opensearch_desc.php" title="ArchWiki (en)">
<link rel="EditURI" type="application/rsd+xml" href="https://wiki.archlinux.org/api.php?action=rsd">
<link rel="license" href="http://www.gnu.org/copyleft/fdl.html">
<link rel="alternate" type="application/atom+xml" title="ArchWiki Atom feed" href="/index.php?title=Special:RecentChanges&amp;feed=atom">
</head>
<body class="mediawiki ltr sitedir-ltr mw-hide-empty-elt ns-0 ns-subject page-Creating_packages_Português rootpage-Creating_packages_Português skin-vector action-view skin-vector-legacy">
<div id="content" class="mw-body" role="main" style="margin: 0">
	<a id="top"></a>
	<div id="siteNotice" class="mw-body-content"></div>
	<div class="mw-indicators mw-body-content">
	</div>
	<h1 id="firstHeading" class="firstHeading" lang="en">Creating packages (Português)</h1>
	<div id="bodyContent" class="mw-body-content">
		<div id="siteSub" class="noprint">From ArchWiki</div>
		<div id="contentSub"></div>
		<div id="contentSub2"></div>
		
		<div id="jump-to-nav"></div>
		<a class="mw-jump-link" href="#mw-head">Jump to navigation</a>
		<a class="mw-jump-link" href="#searchInput">Jump to search</a>
		<div id="mw-content-text" lang="en" dir="ltr" class="mw-content-ltr">
<div class="warningbox">The printable version is no longer supported and may have rendering errors. Please update your browser bookmarks and please use the default browser print function instead.</div>
<div class="mw-parser-output">
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Status de tradução:</strong> Esse artigo é uma tradução de <a href="../en/Creating_packages.html" title="Creating packages">Creating packages</a>. Data da última tradução: 2021-03-14. Você pode ajudar a sincronizar a tradução, se houver <a rel="nofollow" class="external text" href="https://wiki.archlinux.org/index.php?title=Creating_packages&amp;diff=0&amp;oldid=644976">alterações</a> na versão em inglês.</div>
<div class="archwiki-template-meta-related-articles-start">
<p>Artigos relacionados</p>
<ul>
<li><a href="../pt/Arch_Build_System.html" title="Arch Build System (Português)">Arch Build System</a></li>
<li><a href="../pt/Arch_package_guidelines.html" class="mw-redirect" title="Padrões de empacotamento do Arch">Padrões de empacotamento do Arch</a></li>
<li><a href="../pt/Arch_User_Repository.html" title="Arch User Repository (Português)">Arch User Repository</a></li>
<li><a href="../pt/Creating_packages_for_other_distributions.html" class="mw-redirect" title="Criando pacotes para outras distribuições">Criando pacotes para outras distribuições</a></li>
<li><a href="../pt/Makepkg.html" title="Makepkg (Português)">makepkg</a></li>
<li><a href="../pt/Pacman.html" title="Pacman (Português)">pacman</a></li>
<li><a href="../pt/Patching_packages.html" class="mw-redirect" title="Aplicação de patch no ABS">Aplicação de patch no ABS</a></li>
<li><a href="../pt/PKGBUILD.html" title="PKGBUILD (Português)">PKGBUILD</a></li>
<li><a href="../pt/.SRCINFO.html" title=".SRCINFO (Português)">.SRCINFO</a></li>
<li><a href="../DeveloperWiki:Building_in_a_Clean_Chroot.html" class="mw-redirect" title="DeveloperWiki:Building in a Clean Chroot">DeveloperWiki:Building in a Clean Chroot</a></li>
</ul>
</div>
<p>Esse artigo objetiva auxiliar usuários na criação de seus próprios pacotes usando o <a href="../pt/Arch_Build_System.html" title="Arch Build System (Português)">sistema de compilação</a> "tipo <i>ports</i>" do Arch Linux, também para enviou ao <a href="../pt/Arch_User_Repository.html" class="mw-redirect" title="AUR (Português)">AUR</a>. Ele cobre criação de um <a href="../pt/PKGBUILD.html" title="PKGBUILD (Português)">PKGBUILD</a> – um arquivo de descrição de compilação de pacote carregado pelo <code>makepkg</code> para criar um pacote binário a partir do fonte. Se já estiver em posse de um <code>PKGBUILD</code>, veja <a href="../pt/Makepkg.html" title="Makepkg (Português)">makepkg</a>. Para instruções sobre regras e formas existentes para melhorar a qualidade de pacote, veja <a href="../pt/Arch_package_guidelines.html" class="mw-redirect" title="Padrões de empacotamento do Arch">Padrões de empacotamento do Arch</a>.
</p>
<div id="toc" class="toc" role="navigation" aria-labelledby="mw-toc-heading">
<input type="checkbox" role="button" id="toctogglecheckbox" class="toctogglecheckbox" style="display:none"><div class="toctitle" lang="en" dir="ltr">
<h2 id="mw-toc-heading">Contents</h2>
<span class="toctogglespan"><label class="toctogglelabel" for="toctogglecheckbox"></label></span>
</div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Vis%C3%A3o_Geral"><span class="tocnumber">1</span> <span class="toctext">Visão Geral</span></a></li>
<li class="toclevel-1 tocsection-2">
<a href="#Prepara%C3%A7%C3%A3o"><span class="tocnumber">2</span> <span class="toctext">Preparação</span></a>
<ul>
<li class="toclevel-2 tocsection-3"><a href="#Pr%C3%A9-requisito_de_software"><span class="tocnumber">2.1</span> <span class="toctext">Pré-requisito de software</span></a></li>
<li class="toclevel-2 tocsection-4"><a href="#Baixe_e_teste_a_instala%C3%A7%C3%A3o"><span class="tocnumber">2.2</span> <span class="toctext">Baixe e teste a instalação</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-5">
<a href="#Cria%C3%A7%C3%A3o_de_um_PKGBUILD"><span class="tocnumber">3</span> <span class="toctext">Criação de um PKGBUILD</span></a>
<ul>
<li class="toclevel-2 tocsection-6"><a href="#Definindo_as_vari%C3%A1veis_do_PKGBUILD"><span class="tocnumber">3.1</span> <span class="toctext">Definindo as variáveis do PKGBUILD</span></a></li>
<li class="toclevel-2 tocsection-7">
<a href="#Fun%C3%A7%C3%B5es_do_PKGBUILD"><span class="tocnumber">3.2</span> <span class="toctext">Funções do PKGBUILD</span></a>
<ul>
<li class="toclevel-3 tocsection-8"><a href="#prepare()"><span class="tocnumber">3.2.1</span> <span class="toctext">prepare()</span></a></li>
<li class="toclevel-3 tocsection-9"><a href="#pkgver()"><span class="tocnumber">3.2.2</span> <span class="toctext">pkgver()</span></a></li>
<li class="toclevel-3 tocsection-10"><a href="#build()"><span class="tocnumber">3.2.3</span> <span class="toctext">build()</span></a></li>
<li class="toclevel-3 tocsection-11"><a href="#check()"><span class="tocnumber">3.2.4</span> <span class="toctext">check()</span></a></li>
<li class="toclevel-3 tocsection-12"><a href="#package()"><span class="tocnumber">3.2.5</span> <span class="toctext">package()</span></a></li>
</ul>
</li>
</ul>
</li>
<li class="toclevel-1 tocsection-13">
<a href="#Teste_do_PKGBUILD_e_pacote"><span class="tocnumber">4</span> <span class="toctext">Teste do PKGBUILD e pacote</span></a>
<ul>
<li class="toclevel-2 tocsection-14"><a href="#Verificando_sanidade_do_pacote"><span class="tocnumber">4.1</span> <span class="toctext">Verificando sanidade do pacote</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-15"><a href="#Enviando_pacotes_para_o_AUR"><span class="tocnumber">5</span> <span class="toctext">Enviando pacotes para o AUR</span></a></li>
<li class="toclevel-1 tocsection-16">
<a href="#Resumo"><span class="tocnumber">6</span> <span class="toctext">Resumo</span></a>
<ul>
<li class="toclevel-2 tocsection-17"><a href="#Avisos"><span class="tocnumber">6.1</span> <span class="toctext">Avisos</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-18"><a href="#Diretrizes_mais_detalhadas"><span class="tocnumber">7</span> <span class="toctext">Diretrizes mais detalhadas</span></a></li>
<li class="toclevel-1 tocsection-19"><a href="#Geradores_de_PKGBUILD"><span class="tocnumber">8</span> <span class="toctext">Geradores de PKGBUILD</span></a></li>
<li class="toclevel-1 tocsection-20"><a href="#Veja_tamb%C3%A9m"><span class="tocnumber">9</span> <span class="toctext">Veja também</span></a></li>
</ul>
</div>

<h2>
<span id="Vis.C3.A3o_Geral"></span><span class="mw-headline" id="Visão_Geral">Visão Geral</span>
</h2>
<p>Pacotes no Arch Linux são compilados usando o utilitário <a href="../pt/Makepkg.html" title="Makepkg (Português)">makepkg</a> e as informações armazenadas em um arquivo <a href="../pt/PKGBUILD.html" title="PKGBUILD (Português)">PKGBUILD</a>. Quando <code>makepkg</code> é executado, ele pesquisa por um <code>PKGBUILD</code> no diretório atual e segue as instruções nele para obter os arquivos necessários e/ou compilá-los para serem empacotados dentro do arquivo de pacote (<code>pkgname.pkg.tar.zst</code>). O pacote resultante contém arquivos binários e instruções de instalação prontos para serem instalados pelo <a href="../pt/Pacman.html" title="Pacman (Português)">pacman</a>.
</p>
<p>Um pacote do Arch é nada mais que um pacote tar, ou "tarball", comprimido usando <span class="plainlinks archwiki-template-man" title="$ man 1 zstd"><a rel="nofollow" class="external text" href="https://man.archlinux.org/man/zstd.1">zstd(1)</a></span>, que contém os seguintes arquivos gerados pelo makepkg:
</p>
<ul>
<li>Os arquivos binários para serem instalados.</li>
<li>
<code>.PKGINFO</code>: contém todos os metadados necessários pelo pacman para lidar com pacotes, dependências, etc.</li>
<li>
<code>.BUILDINFO</code>: contém informações necessárias para compilações reproduzíveis. Esse arquivo está presente somente se um pacote está compilado com pacman 5.1 ou mais recente. Veja <span class="plainlinks archwiki-template-man" title="$ man 5 BUILDINFO"><a rel="nofollow" class="external text" href="https://man.archlinux.org/man/BUILDINFO.5">BUILDINFO(5)</a></span>
</li>
<li>
<code>.MTREE</code>: contém <i>hashes</i> e <i>timestamps</i> dos arquivos, que são incluídos na base de dados local de forma que o pacman possa verificar a integridade do pacote.</li>
<li>
<code>.INSTALL</code>: um arquivo opcional usado para executar comandos após o estágio instalação/atualização/remoção. (Esse arquivo está presente apenas se especificado no <code>PKGBUILD</code>.)</li>
<li>
<code>.Changelog</code>: um arquivo opcional mantido pelo mantenedor do pacote documentando as mudanças do pacote. (Ele não está presente em todos pacotes.)</li>
</ul>
<h2>
<span id="Prepara.C3.A7.C3.A3o"></span><span class="mw-headline" id="Preparação">Preparação</span>
</h2>
<h3>
<span id="Pr.C3.A9-requisito_de_software"></span><span class="mw-headline" id="Pré-requisito_de_software">Pré-requisito de software</span>
</h3>
<p>Primeiro, certifique-se de que as ferramentas necessárias estejam <a href="../pt/Help:Reading.html#Instala%C3%A7%C3%A3o_de_pacotes" class="mw-redirect" title="Instala">instaladas</a>: o grupo de pacotes <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/groups/x86_64/base-devel/">base-devel</a></span> deve ser o suficiente; ele inclui <code>make</code> e ferramentas adicionais necessárias para compilar a partir do código-fonte.
</p>
<p>A ferramenta chave para compilar pacotes é o <a href="../pt/Makepkg.html" title="Makepkg (Português)">makepkg</a> (fornecido pelo <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=pacman">pacman</a></span>), que faz o seguinte:
</p>
<ol>
<li>Verifica se as dependências do pacote estão instaladas.</li>
<li>Baixa os arquivos fontes dos servidores especificados.</li>
<li>Desempacota os arquivos fontes.</li>
<li>Compila o software e instala-o sob um ambiente <i>fakeroot</i>.</li>
<li>Remove os símbolos de binários e bibliotecas.</li>
<li>Gera o arquivo meta do pacote que é incluído em cada pacote.</li>
<li>Comprime o ambiente <i>fakeroot</i> em um arquivo de pacote.</li>
<li>Armazena o arquivo de pacote no diretório de destino configurado, o qual é o diretório de trabalho atual por padrão.</li>
</ol>
<h3>
<span id="Baixe_e_teste_a_instala.C3.A7.C3.A3o"></span><span class="mw-headline" id="Baixe_e_teste_a_instalação">Baixe e teste a instalação</span>
</h3>
<p>Baixe o tarball fonte do software se você deseja empacotá-lo, extraí-lo e seguir as etapas do autor para instalar o programa. Tome nota de todos os comandos e/ou etapas necessários para compilar e instalar. Você estará repetindo os mesmos comandos no arquivo <code>PKGBUILD</code>.
</p>
<p>A maioria dos autores de software seguem o ciclo de compilação em 3 etapas:
</p>
<pre>./configure
make
make install
</pre>
<p>Esse é um bom momento para se certificar o programa está funcionando corretamente.
</p>
<h2>
<span id="Cria.C3.A7.C3.A3o_de_um_PKGBUILD"></span><span class="mw-headline" id="Criação_de_um_PKGBUILD">Criação de um PKGBUILD</span>
</h2>
<p>Quando <code>makepkg</code> é executado, ele procura por um arquivo <code>PKGBUILD</code> no diretório de trabalho atual. Se localizar um, ele baixa o código-fonte do software e compilá-o de acordo com as instruções especificadas no arquivo <code>PKGBUILD</code>. As instruções devem ser completamente interpretáveis pelo shell <a href="https://en.wikipedia.org/wiki/pt:Bash" class="extiw" title="wikipedia:pt:Bash">Bash</a>. Após concluir com sucesso, os binários resultantes e metadados do pacote, isto é, informações de versão e dependências do pacote, são empacotados em um arquivo de pacote <code>pkgname.pkg.tar.zst</code>. O pacote recém-criado que pode ser instalado usando <code>makepkg --install</code> que vai chamar o pacman em plano de fundo, ou diretamente usando <code>pacman -U <i>pkgname.pkg.tar.zst</i></code>.
</p>
<p>Para começar a compilar um novo pacote, primeiro crie um novo diretório para o pacote e mude o diretório atual para esse novo. Então, um arquivo <code>PKGBUILD</code> precisa ser criado: um protótipo de PKGBUILD localizado em <code>/usr/share/pacman/</code> pode ser usado ou você pode começar <code>PKGBUILD</code> a partir de outro pacote. A última opção pode ser uma boa escolha, se um pacote similar já existir.
</p>
<h3>
<span id="Definindo_as_vari.C3.A1veis_do_PKGBUILD"></span><span class="mw-headline" id="Definindo_as_variáveis_do_PKGBUILD">Definindo as variáveis do PKGBUILD</span>
</h3>
<p>Exemplos de PKGBUILDs estão localizados em <code>/usr/share/pacman/</code>. Uma explicação das variáveis possíveis no <code>PKGBUILD</code> pode ser encontrada no artigo <a href="../pt/PKGBUILD.html" title="PKGBUILD (Português)">PKGBUILD</a>.
</p>
<p><i>makepkg</i> define duas variáveis que você não deve usar como parte do processo de compilação e instalação:
</p>
<dl>
<dt><code>srcdir</code></dt>
<dd>aponta para o diretório no qual <i>makepkg</i> extrai e cria links simbólicos no vetor fonte.</dd>
</dl>
<dl>
<dt><code>pkgdir</code></dt>
<dd>aponta para o diretório no qual <i>makepkg</i> empacota o software instalado, o qual se torna o diretório raiz de seu pacote compilado.</dd>
</dl>
<p>Eles contêm caminhos <i>absolutos</i>, o que significa que você não tem que se preocupar com seu diretório de trabalho, se você usar essas variáveis adequadamente.
</p>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Nota:</strong> <i>makepkg</i>, e portanto as funções <code>build()</code> e <code>package()</code>, são feitas para serem não interativas. Utilitários interativos ou scripts chamados naquelas funções podem quebrar o <i>makepkg</i>, principalmente se for invocada com registro de log de compilação habilitado (<code>--log</code>). (Veja <a rel="nofollow" class="external text" href="https://bugs.archlinux.org/task/13214">FS#13214</a>.)</div>
<h3>
<span id="Fun.C3.A7.C3.B5es_do_PKGBUILD"></span><span class="mw-headline" id="Funções_do_PKGBUILD">Funções do PKGBUILD</span>
</h3>
<p>Ao compilar um pacote, o <code>makepkg</code> invocará as cinco funções seguintes se elas tiverem sido definidas no PKGBUILD. A função <code>package()</code> é exigida em todo PKGBUILD e sempre será invocada. Se alguma das outras funções não estiver definida, o <code>makepkg</code> simplesmente ignorará a invocação dessa função.
</p>
<p>Durante a compilação, as funções são invocadas na ordem na qual elas são listadas abaixo.
</p>
<h4>
<span id="prepare.28.29"></span><span class="mw-headline" id="prepare()">prepare()</span>
</h4>
<p>Com essa função, comandos que são usados para preparar fontes para compilação são executados, tal como <a href="../pt/Patching_packages.html" class="mw-redirect" title="Aplicação de patch no ABS">patching</a>. Essa função é executada após a extração do pacote, antes do <a href="#pkgver()">pkgver()</a> e a função de compilação. Se a extração for ignorada (<code>makepkg --noextract</code>), então <code>prepare()</code> não é executada.
</p>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Nota:</strong> (De <span class="plainlinks archwiki-template-man" title="$ man 5 PKGBUILD"><a rel="nofollow" class="external text" href="https://man.archlinux.org/man/PKGBUILD.5">PKGBUILD(5)</a></span>) A função é executada no modo <code>bash -e</code>, o que significa que qualquer comando que sair com um status não-zero fará com que a função saia.</div>
<h4>
<span id="pkgver.28.29"></span><span class="mw-headline" id="pkgver()">pkgver()</span>
</h4>
<p><code>pkgver()</code> é executado após os fontes serem obtidos, extraídos e o <a href="#prepare()">prepare()</a> executado. Então, você pode atualizar a variável <i>pkgver</i> durante um estágio do makepkg.
</p>
<p>Isso é particularmente útil se você estiver <a href="../pt/VCS_package_guidelines.html" class="mw-redirect" title="Diretrizes de pacotes VCS">fazendo pacote git/svn/hg/etc.</a>, nos quais o processo de compilação pode se manter o mesmo, mas o fonte não puder ser atualizado todo dia, ou toda hora. A forma antiga de fazer isso é colocar a data no campo <i>pkgver</i> que, se o software não fosse atualizado, makepkg ainda iria recompilá-lo pensando que a versão foi alterada. Alguns comandos úteis para isso são <code>git describe</code>, <code>hg identify -ni</code>, etc. Por favor, teste antes de enviar um PKGBUILD, já que uma falha na função <code>pkgver()</code> pode parar um processo de compilação.
</p>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Nota:</strong> pkgver não pode conter espaços ou hífens (<code>-</code>). Usar sed para corrigir isso é comum.</div>
<h4>
<span id="build.28.29"></span><span class="mw-headline" id="build()">build()</span>
</h4>
<p>Agora você precisa implementar a função <code>build()</code> no arquivo <code>PKGBUILD</code>. Essa função usa comandos comuns de shell com sintaxe <a href="https://en.wikipedia.org/wiki/pt:Bash" class="extiw" title="wikipedia:pt:Bash">Bash</a> para compilar automaticamente o software e criar um diretório chamado <code>pkg</code> para instalar o software. Isso permite que o <i>makepkg</i> empacote arquivos sem ter que examinar seu sistema de arquivos.
</p>
<p>A primeira etapa na função <code>build()</code> é alterar para o diretório criado ao descompactar o tarball fonte. <i>makepkg</i> vai alterar o diretório atual para <code>$srcdir</code> antes de executar a função <code>build()</code>. Por tanto, na maioria dos casos, como sugerido no <code>/usr/share/pacman/PKGBUILD.proto</code>, o primeiro comando se parece com isso:
</p>
<pre>cd "$pkgname-$pkgver"
</pre>
<p>Agora, você precisa listar os mesmos comandos que você usou quando compilou manualmente o software. A função <code>build()</code>, essencialmente, automatiza tudo que você fez manualmente e compila o software no ambiente <i>fakeroot</i> de compilação. SE o software que você está empacotando usa um script de compilação, é uma boa prática usar <code>--prefix=/usr</code> ao compilar pacotes para o pacman. Muitos softwares instalam arquivos relativos ao diretório <code>/usr/local</code>, o que deve ser feito apenas se você está compilando manualmente do fonte. Todos os pacotes do Arch Linux devem usar o diretório <code>/usr</code>. Como visto no arquivo <code>/usr/share/pacman/PKGBUILD.proto</code>, as próximas duas linhas geralmente se parecem com isso:
</p>
<pre>./configure --prefix=/usr
make
</pre>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Nota:</strong> Se seu software não precisa compilar nada, NÃO use a função <code>build()</code>. A função <code>build()</code> não é obrigatória, mas a função <code>package()</code> é.</div>
<h4>
<span id="check.28.29"></span><span class="mw-headline" id="check()">check()</span>
</h4>
<p>Lugar para as chamadas de <code>make check</code> ou rotinas de teste similares. É altamente recomendado ter um <code>check()</code> já que ela ajuda a se certificar que o software foi compilado corretamente e funciona bem com suas dependências.
</p>
<p>Usuários que não precisam dela (e ocasionalmente mantenedores que não corrigem um pacote para isso passar) podem desabilitá-la usando <code>BUILDENV+=('!check')</code> no PKGBUILD/makepkg.conf ou chamar <code>makepkg</code> com a opção <code>--nocheck</code>.
</p>
<h4>
<span id="package.28.29"></span><span class="mw-headline" id="package()">package()</span>
</h4>
<p>A etapa final é colocar os arquivos compilados em um diretório no qual <i>makepkg</i> possa obtê-los para criar um pacote. Isso por padrão é o diretório <code>pkg</code>—um ambiente <i>fakeroot</i> simples.  O diretório <code>pkg</code> replica a hierarquia do sistema de arquivos raiz dos caminhos de instalação do software. Se você tiver que colocar arquivos manualmente sob a raiz de seu sistema de arquivos, você deveria instalá-los no diretório <code>pkg</code> sob a mesma estrutura. Por exemplo, se você deseja instalar um arquivo no <code>/usr/bin</code>, ele deveria ser colocado sob <code>$pkgdir/usr/bin</code>. Muito poucos procedimentos de instalação exibem que o usuário copie diversos arquivos manualmente.  Em vez disso, para a maioria dos softwares, chamar <code>make install</code> servirá. A linha final deve se parecer com o seguinte para instalar corretamente o software no diretório <code>pkg</code>:
</p>
<pre>make DESTDIR="$pkgdir/" install
</pre>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Nota:</strong> Algumas vezes é caso do <code>DESTDIR</code> não ser usado no <code>Makefile</code>; em vez disso, você pode precisar usar <code>prefix</code>. Se o pacote é compilado com <i>autoconf</i> / <i>automake</i>, use <code>DESTDIR</code>; isso é o que está <a rel="nofollow" class="external text" href="https://www.gnu.org/software/automake/manual/automake.html#Install">documentado</a> nos manuais. Se <code>DESTDIR</code> não funcionar, tente compilar com <code>make prefix="$pkgdir/usr/" install</code>. Se isso não funcionar, você terá que olhar mais profundamente nos comandos de instalação que são executados por "<code>make &lt;...&gt; install</code>".</div>
<p><code>makepkg --repackage</code> executa apenas a função <code>package()</code>, então ele cria um pacote sem compilar. Isso pode economizar tempo, por exemplo, se você tiver alterado apenas a variável <code>depends</code> do pacote.
</p>
<h2><span class="mw-headline" id="Teste_do_PKGBUILD_e_pacote">Teste do PKGBUILD e pacote</span></h2>
<p>Na medida em que você escreve a função <code>build()</code>, você vai querer testar suas alterações frequentemente para se assegurar de que não há falhas. Você pode fazer isso usando o comando <code>makepkg</code> no diretório contendo o arquivo <code>PKGBUILD</code>. Com um <code>PKGBUILD</code> formatado corretamente, makepkg vai criar um pacote; com um <code>PKGBUILD</code> quebrado ou incompleto, ele vai gerar erros.
</p>
<p>Se makepkg finalizar com sucesso, ele vai colocar um arquivo chamado <code>pkgname-pkgver.pkg.tar.zst</code> em seu diretório de trabalho. Esse pacote pode ser instalado com o comando <code>pacman -U</code>. Porém, só porque um aquivo de pacote foi compilado não significa que ele está totalmente funcional. Ele pode conter apenas o diretório e nenhum arquivo se, por exemplo, um prefixo foi especificado equivocadamente. Você pode usar as funções de consulta do pacman para exibir uma lista de aquivos contidos no pacote e as dependências que ele exige com <code>pacman -Qlp [arquivo do pacote]</code> e <code>pacman -Qip [arquivo de pacote]</code>, respectivamente.
</p>
<p>Se o pacote parecer estar bom, então você está pronto! Porém, se você planeja lançar o arquivo <code>PKGBUILD</code>, é imperativo que você verifique, e verifique de novo, o conteúdo do vetor <code>depends</code>.
</p>
<p>Além disso, certifique-se de que os binários do pacote realmente são <i>executados</i> sem falha alguma! É irritante lançar um pacote que contém todos os arquivos necessários, mas trava por causa de alguma opção de configuração obscura que não funciona bem com o resto do sistema. Se você vai apenas compilar pacotes para o seu próprio sistema, você não precisa se preocupar tanto sobre a etapa de verificação de qualidade, pois, no final das contas, você é a única pessoa que sofrerá pelos equívocos.
</p>
<h3><span class="mw-headline" id="Verificando_sanidade_do_pacote">Verificando sanidade do pacote</span></h3>
<p>Após testar a funcionalidade do pacote, verifique-o por erros usando o <a href="../pt/Namcap.html" title="Namcap (Português)">namcap</a>:
</p>
<pre>$ namcap PKGBUILD
$ namcap <i>&lt;nome do arquivo do pacote&gt;</i>.pkg.tar.zst
</pre>
<p>Namcap vai:
</p>
<ol>
<li>Verificar o conteúdo do PKGBUILD por erros comuns e hierarquia de arquivos do pacote por arquivos desnecessários/colocados em lugar indevido</li>
<li>Varrer todos os arquivos ELF no pacote usando <code>ldd</code>, relatando automaticamente quais pacotes com as bibliotecas compartilhadas estão faltando no <code>depends</code> e quais podem ser omitidas como dependências transitivas</li>
<li>Pesquisar heuristicamente por dependências em falta ou redundantes</li>
</ol>
<p>e muito mais.
</p>
<p>Se habitue a verificar seus pacotes com namcap para evitar de ter que corrigir os erros mais simples após envio do pacote.
</p>
<h2><span class="mw-headline" id="Enviando_pacotes_para_o_AUR">Enviando pacotes para o AUR</span></h2>
<p>Por favor, leia <a href="../pt/AUR_submission_guidelines.html" class="mw-redirect" title="Diretrizes de envio ao AUR">Diretrizes de envio ao AUR</a> para uma descrição detalhada do processo de envio.
</p>
<h2><span class="mw-headline" id="Resumo">Resumo</span></h2>
<ol>
<li>Baixe o tarball fonte do software para empacotar.</li>
<li>Tente compilar o pacote e instalá-lo em um diretório arbitrário.</li>
<li>Copie o protótipo <code>/usr/share/pacman/PKGBUILD.proto</code> e renomeie-o para <code>PKGBUILD</code> em um diretório de trabalho temporário.</li>
<li>Edite o <code>PKGBUILD</code> de acordo com as necessidades do seu pacote.</li>
<li>Execute <code>makepkg</code> e verifique se o pacote resultante compila corretamente.</li>
<li>Se não, repita as duas etapas anteriores.</li>
</ol>
<h3><span class="mw-headline" id="Avisos">Avisos</span></h3>
<ul>
<li>Antes de você automatizar o processo de compilação do pacote, você deve tê-lo feito manualmente pelo menos uma vez, a menos que você saiba <i>exatamente</i> o que você está fazendo <i>desde já</i>, caso em que você não precisaria estar lendo isso em primeiro lugar. Infelizmente, apesar de uma boa quantidade de autores de programas seguirem o ciclo de compilação de 3 etapas de "<code>./configure</code>; <code>make</code>; <code>make install</code>", não é sempre que isso ocorre e as coisas podem dar muito errado se você tiver que aplicar patches para fazer tudo funcionar. Regra do polegar: Se você não puder fazer o programa compilar a partir do tarball fonte e fazê-lo ser instalado para um subdiretório temporário definido, você não precisa se quer empacotá-lo. Não há nenhum pozinho mágico no <code>makepkg</code> que faça os problemas do código-fonte sumirem.</li>
<li>Em alguns casos, os pacotes nem mesmo estão disponíveis e você tem que usar alguma coisa como <code>sh installer.run</code> para fazê-los funcionar. Você terá que fazer uma boa pesquisa (ler os READMEs, instruções de INSTALL, páginas man, talvez ebuilds do Gentoo ou outros instaladores de pacote, possivelmente até os MAKEFILEs ou o código-fonte) para fazê-lo funcionar. Em alguns casos realmente sérios, você tem que editar os arquivos fontes para fazê-los funcionar. Porém, <code>makepkg</code> precisa ser completamente autônomo, com nenhuma entrada de usuário. Portanto, se você precisa editar os makefiles, você pode ter que juntar um patch personalizado ao <code>PKGBUILD</code> e instalá-lo de dentro da função <code>prepare()</code>, ou você pode ter que usar alguns comandos <code>sed</code> de dentro da função <code>prepare()</code>.</li>
</ul>
<h2><span class="mw-headline" id="Diretrizes_mais_detalhadas">Diretrizes mais detalhadas</span></h2>
<div class="toc" style="display:block; text-align: center; margin-bottom: 1em;">
<b><a href="../pt/Arch_package_guidelines.html" class="mw-redirect" title="Diretrizes de pacotes do Arch">Diretrizes de pacotes do Arch</a></b>
<hr>
<p><a href="../pt/32-bit_package_guidelines.html" class="mw-redirect" title="Diretrizes de pacotes 32-bit">32-bit</a> – <a href="../pt/CLR_package_guidelines.html" class="mw-redirect" title="Diretrizes de pacotes CLR">CLR</a> – <a href="../pt/CMake_package_guidelines.html" class="mw-redirect" title="Diretrizes de pacotes CMake">CMake</a> – <a href="../pt/Cross-compiling_tools_package_guidelines.html" class="mw-redirect" title="Diretrizes de pacotes de ferramentas de compilação cruzada">Cross</a> – <a href="../pt/DKMS_package_guidelines.html" class="mw-redirect" title="Diretrizes de pacotes DKMS">DKMS</a> – <a href="../pt/Eclipse_plugin_package_guidelines.html" class="mw-redirect" title="Diretrizes de pacotes de plugin do Eclipse">Eclipse</a> – <a href="../pt/Electron_package_guidelines.html" class="mw-redirect" title="Diretrizes de pacotes Electron">Electron</a> – <a href="../pt/Font_package_guidelines.html" class="mw-redirect" title="Diretrizes de pacotes de fontes">Fonte</a> – <a href="../pt/Free_Pascal_package_guidelines.html" class="mw-redirect" title="Diretrizes de pacotes Free Pascal">Free Pascal</a> – <a href="../pt/GNOME_package_guidelines.html" class="mw-redirect" title="Diretrizes de pacotes GNOME">GNOME</a> – <a href="../pt/Go_package_guidelines.html" class="mw-redirect" title="Diretrizes de pacotes Go">Go</a> – <a href="../pt/Haskell_package_guidelines.html" class="mw-redirect" title="Diretrizes de pacotes Haskell">Haskell</a> – <a href="../pt/Java_package_guidelines.html" class="mw-redirect" title="Diretrizes de pacotes Java">Java</a> – <a href="../pt/KDE_package_guidelines.html" class="mw-redirect" title="Diretrizes de pacotes KDE">KDE</a> – <a href="../pt/Kernel_module_package_guidelines.html" class="mw-redirect" title="Diretrizes de pacotes de módulos de kernel">Kernel</a> – <a href="../pt/Lisp_package_guidelines.html" class="mw-redirect" title="Diretrizes de pacotes Lisp">Lisp</a> – <a href="../pt/Meson_package_guidelines.html" class="mw-redirect" title="Diretrizes de pacotes Meson">Meson</a> – <a href="../pt/MinGW_package_guidelines.html" class="mw-redirect" title="Diretrizes de pacotes MinGW">MinGW</a> – <a href="../pt/Node.js_package_guidelines.html" class="mw-redirect" title="Diretrizes de pacotes Node.js">Node.js</a> – <a href="../pt/Nonfree_applications_package_guidelines.html" class="mw-redirect" title="Diretrizes de pacotes de aplicativos não livres">Nonfree</a> – <a href="../pt/OCaml_package_guidelines.html" class="mw-redirect" title="Diretrizes de pacotes OCaml">OCaml</a> – <a href="../pt/Perl_package_guidelines.html" class="mw-redirect" title="Diretrizes de pacotes Perl">Perl</a> – <a href="../pt/PHP_package_guidelines.html" class="mw-redirect" title="Diretrizes de pacotes PHP">PHP</a> – <a href="../pt/Python_package_guidelines.html" class="mw-redirect" title="Diretrizes de pacotes Python">Python</a> – <a href="../pt/R_package_guidelines.html" class="mw-redirect" title="Diretrizes de pacotes R">R</a> – <a href="../pt/Ruby_Gem_package_guidelines.html" class="mw-redirect" title="Diretrizes de pacotes Ruby Gem">Ruby</a> – <a href="../pt/Rust_package_guidelines.html" class="mw-redirect" title="Diretrizes de pacotes Rust">Rust</a> – <a href="../pt/VCS_package_guidelines.html" class="mw-redirect" title="Diretrizes de pacotes VCS">VCS</a> – <a href="../pt/Web_application_package_guidelines.html" class="mw-redirect" title="Diretrizes de pacotes de aplicativos da Web">Web</a> – <a href="../pt/Wine_package_guidelines.html" class="mw-redirect" title="Diretrizes de pacotes Wine">Wine</a>
</p>
</div>
<h2><span class="mw-headline" id="Geradores_de_PKGBUILD">Geradores de PKGBUILD</span></h2>
<p>PKGBUILDs para alguns pacotes podem ser gerados automaticamente.
</p>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Nota:</strong> Usuários ainda são responsáveis por garantir que o pacote atende os padrões de alta qualidade antes de enviar os arquivos gerados para o <a href="../pt/Arch_User_Repository.html" class="mw-redirect" title="AUR (Português)">AUR</a>.</div>
<ul>
<li>
<a href="../en/Haskell.html" title="Haskell">Haskell</a>: <a rel="nofollow" class="external text" href="https://github.com/magthe/cblrepo">cblrepo</a>, <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=arch-hs">arch-hs</a></span>
</li>
<li>
<a href="../en/Node.js.html" title="Node.js">Node.js</a>: <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://aur.archlinux.org/packages/nodejs-npm2arch/">nodejs-npm2arch</a></span><sup><small>AUR</small></sup> <a rel="nofollow" class="external text" href="https://github.com/simon04/npm2arch">npm2arch</a>
</li>
<li>
<a href="../pt/Python.html" title="Python (Português)">Python</a>: <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://aur.archlinux.org/packages/pipman-git/">pipman-git</a></span><sup><small>AUR</small></sup>, <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://aur.archlinux.org/packages/pip2arch-git/">pip2arch-git</a></span><sup><small>AUR</small></sup>, <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://aur.archlinux.org/packages/python-pypi2pkgbuild/">python-pypi2pkgbuild</a></span><sup><small>AUR</small></sup>
</li>
<li>
<a href="../en/Ruby.html" title="Ruby">Ruby</a>: <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://aur.archlinux.org/packages/gem2arch/">gem2arch</a></span><sup><small>AUR</small></sup>, <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://aur.archlinux.org/packages/pacgem/">pacgem</a></span><sup><small>AUR</small></sup>
</li>
<li>
<a href="../en/Rust.html" title="Rust">Rust</a>: <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://aur.archlinux.org/packages/cargo-pkgbuild/">cargo-pkgbuild</a></span><sup><small>AUR</small></sup>
</li>
</ul>
<h2>
<span id="Veja_tamb.C3.A9m"></span><span class="mw-headline" id="Veja_também">Veja também</span>
</h2>
<ul>
<li>
<a rel="nofollow" class="external text" href="https://bbs.archlinux.org/viewtopic.php?id=91408">Como criar corretamente um arquivo de patch</a>.</li>
<li>
<a rel="nofollow" class="external text" href="https://archwomen.org/media/project_classroom/classlogs/">Arch Linux Classroom IRC Logs com aulas sobre criação de PKGBUILDs</a>.</li>
<li><a rel="nofollow" class="external text" href="http://www.linuxfromscratch.org/hints/downloads/files/fakeroot.txt">Abordagem com Fakeroot para instalação de pacote</a></li>
</ul>
</div>
</div>
<div id="catlinks" class="catlinks" data-mw="interface"><div id="mw-normal-catlinks" class="mw-normal-catlinks">
<a href="../Special:Categories.html" title="Special:Categories">Categories</a>: <ul>
<li><a href="../pt/Category:About_Arch.html" title="Category:About Arch (Português)">About Arch (Português)</a></li>
<li><a href="../pt/Category:Package_development.html" title="Category:Package development (Português)">Package development (Português)</a></li>
</ul>
</div></div>
	</div>
</div>

<footer id="footer" class="mw-footer" role="contentinfo" style="margin: 0">
	<ul id="footer-info">
		<li>Retrieved from "<a dir="ltr" href="https://wiki.archlinux.org/index.php?title=Creating_packages_(Portugu%C3%AAs)&amp;oldid=654877">https://wiki.archlinux.org/index.php?title=Creating_packages_(Português)&amp;oldid=654877</a>"</li>
		<li id="footer-info-lastmod"> This page was last edited on 14 March 2021, at 14:25.</li>
		<li id="footer-info-copyright">Content is available under <a class="external" rel="nofollow" href="http://www.gnu.org/copyleft/fdl.html">GNU Free Documentation License 1.3 or later</a> unless otherwise noted.</li>
	<br>
</ul>
	<ul id="footer-places">
		<li id="footer-places-privacy"><a href="../en/ArchWiki:Privacy_policy.html" title="ArchWiki:Privacy policy">Privacy policy</a></li>
		<li id="footer-places-about"><a href="../en/ArchWiki:About.html" title="ArchWiki:About">About ArchWiki</a></li>
		<li id="footer-places-disclaimer"><a href="../en/ArchWiki:General_disclaimer.html" title="ArchWiki:General disclaimer">Disclaimers</a></li>
	</ul>
	<ul id="footer-icons" class="noprint">
		<li id="footer-copyrightico">
	</ul>
	<div style="clear: both;"></div>
</footer>



</body>
</html>
