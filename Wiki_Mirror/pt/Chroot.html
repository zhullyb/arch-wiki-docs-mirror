<!DOCTYPE html>
<html class="client-nojs" lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<title>chroot (Português) - ArchWiki</title>
<link rel="stylesheet" href="../ArchWikiOffline.css">
<meta name="ResourceLoaderDynamicStyles" content="">
<meta name="generator" content="MediaWiki 1.35.0">
<meta name="robots" content="noindex,follow">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="shortcut icon" href="/favicon.ico">
<link rel="search" type="application/opensearchdescription+xml" href="/opensearch_desc.php" title="ArchWiki (en)">
<link rel="EditURI" type="application/rsd+xml" href="https://wiki.archlinux.org/api.php?action=rsd">
<link rel="license" href="http://www.gnu.org/copyleft/fdl.html">
<link rel="alternate" type="application/atom+xml" title="ArchWiki Atom feed" href="/index.php?title=Special:RecentChanges&amp;feed=atom">
</head>
<body class="mediawiki ltr sitedir-ltr mw-hide-empty-elt ns-0 ns-subject page-Chroot_Português rootpage-Chroot_Português skin-vector action-view skin-vector-legacy">
<div id="content" class="mw-body" role="main" style="margin: 0">
	<a id="top"></a>
	<div id="siteNotice" class="mw-body-content"></div>
	<div class="mw-indicators mw-body-content">
	</div>
	<h1 id="firstHeading" class="firstHeading" lang="en">chroot (Português)</h1>
	<div id="bodyContent" class="mw-body-content">
		<div id="siteSub" class="noprint">From ArchWiki</div>
		<div id="contentSub"></div>
		<div id="contentSub2"></div>
		
		<div id="jump-to-nav"></div>
		<a class="mw-jump-link" href="#mw-head">Jump to navigation</a>
		<a class="mw-jump-link" href="#searchInput">Jump to search</a>
		<div id="mw-content-text" lang="en" dir="ltr" class="mw-content-ltr">
<div class="warningbox">The printable version is no longer supported and may have rendering errors. Please update your browser bookmarks and please use the default browser print function instead.</div>
<div class="mw-parser-output">
<p><span></span>
</p>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Status de tradução:</strong> Esse artigo é uma tradução de <a href="../en/Chroot.html" title="Chroot">chroot</a>. Data da última tradução: 2019-11-11. Você pode ajudar a sincronizar a tradução, se houver <a rel="nofollow" class="external text" href="https://wiki.archlinux.org/index.php?title=Chroot&amp;diff=0&amp;oldid=587612">alterações</a> na versão em inglês.</div>
<div class="archwiki-template-meta-related-articles-start">
<p>Artigos relacionados</p>
<ul>
<li><a href="../pt/PRoot.html" title="PRoot (Português)">PRoot</a></li>
<li><a href="../pt/Linux_Containers.html" title="Linux Containers (Português)">Linux Containers</a></li>
<li><a href="../en/Systemd-nspawn.html" title="Systemd-nspawn">systemd-nspawn</a></li>
</ul>
</div>
<p><a href="https://en.wikipedia.org/wiki/pt:Chroot" class="extiw" title="wikipedia:pt:Chroot">chroot</a> é uma operação que altera o diretório raiz aparente para o processo atual de execução e seus filhos. Um programa que é executado em tal ambiente modificado não consegue acessar os arquivos e comandos fora dessa árvore de diretórios ambiental. Esse ambiente modificado é chamado de um <i>prisão chroot</i> (ou <i>chroot jail</i>).
</p>
<div id="toc" class="toc" role="navigation" aria-labelledby="mw-toc-heading">
<input type="checkbox" role="button" id="toctogglecheckbox" class="toctogglecheckbox" style="display:none"><div class="toctitle" lang="en" dir="ltr">
<h2 id="mw-toc-heading">Contents</h2>
<span class="toctogglespan"><label class="toctogglelabel" for="toctogglecheckbox"></label></span>
</div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Motiva%C3%A7%C3%A3o"><span class="tocnumber">1</span> <span class="toctext">Motivação</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#Requisitos"><span class="tocnumber">2</span> <span class="toctext">Requisitos</span></a></li>
<li class="toclevel-1 tocsection-3">
<a href="#Uso"><span class="tocnumber">3</span> <span class="toctext">Uso</span></a>
<ul>
<li class="toclevel-2 tocsection-4">
<a href="#Usando_arch-chroot"><span class="tocnumber">3.1</span> <span class="toctext">Usando arch-chroot</span></a>
<ul>
<li class="toclevel-3 tocsection-5"><a href="#Entrar_em_um_chroot"><span class="tocnumber">3.1.1</span> <span class="toctext">Entrar em um chroot</span></a></li>
<li class="toclevel-3 tocsection-6"><a href="#Executar_um_%C3%BAnico_comando_e_sair"><span class="tocnumber">3.1.2</span> <span class="toctext">Executar um único comando e sair</span></a></li>
</ul>
</li>
<li class="toclevel-2 tocsection-7"><a href="#Usando_chroot"><span class="tocnumber">3.2</span> <span class="toctext">Usando chroot</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-8"><a href="#Executar_aplicativos_gr%C3%A1ficos_a_partir_do_chroot"><span class="tocnumber">4</span> <span class="toctext">Executar aplicativos gráficos a partir do chroot</span></a></li>
<li class="toclevel-1 tocsection-9">
<a href="#Sem_privil%C3%A9gios_de_root"><span class="tocnumber">5</span> <span class="toctext">Sem privilégios de root</span></a>
<ul>
<li class="toclevel-2 tocsection-10"><a href="#PRoot"><span class="tocnumber">5.1</span> <span class="toctext">PRoot</span></a></li>
<li class="toclevel-2 tocsection-11"><a href="#Fakechroot"><span class="tocnumber">5.2</span> <span class="toctext">Fakechroot</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-12"><a href="#Veja_tamb%C3%A9m"><span class="tocnumber">6</span> <span class="toctext">Veja também</span></a></li>
</ul>
</div>

<h2>
<span id="Motiva.C3.A7.C3.A3o"></span><span class="mw-headline" id="Motivação">Motivação</span>
</h2>
<p>Alterar a raiz geralmente é feito para executar a manutenção do sistema em sistemas onde a inicialização e/ou a autenticação não são mais possíveis. Exemplos comuns são:
</p>
<ul>
<li>Reinstalação do <a href="../pt/Arch_boot_process.html#Gerenciador_de_boot" class="mw-redirect" title="Gerenciador de boot">gerenciador de boot</a>.</li>
<li>Reconstrução da <a href="../pt/Mkinitcpio.html" title="Mkinitcpio (Português)">imagem de initramfs</a>.</li>
<li>Atualizar ou <a href="../pt/Downgrading_packages.html" class="mw-redirect" title="Fazer downgrade de pacote">fazer downgrade de pacotes</a>.</li>
<li>Redefinir uma <a href="../pt/Reset_lost_root_password.html" class="mw-redirect" title="Recuperação de senha">senha esquecida</a>.</li>
<li>Compilar pacotes em um <i>chroot</i> limpo, veja <a href="../DeveloperWiki:Building_in_a_clean_chroot.html" title="DeveloperWiki:Building in a clean chroot">DeveloperWiki:Building in a clean chroot</a>.</li>
</ul>
<p>Veja também <a href="https://en.wikipedia.org/wiki/Chroot#Limitations" class="extiw" title="wikipedia:Chroot">Wikipedia:Chroot#Limitations</a>.
</p>
<h2><span class="mw-headline" id="Requisitos">Requisitos</span></h2>
<ul>
<li>Privilégio de <i>root</i>.</li>
<li>Outro ambiente Linux, como um LiveCD ou mídia flash USB (ex.: pendrive), ou outra distribuição Linux.</li>
<li>Ambientes com igual arquitetura; i.e. o chroot de e chroot para. A arquitetura do ambiente atual pode ser descoberta com: <code>uname -m</code> (ex.: i686 ou x86_64).</li>
<li>Módulos de kernel carregados que são necessários no ambiente chroot.</li>
<li>
<a href="../pt/Swap.html" title="Swap (Português)">Swap</a> habilitado se necessário: <pre># swapon /dev/sd<i>xY</i></pre>
</li>
<li>Conexão com a Internet estabelecida, se necessário.</li>
</ul>
<h2><span class="mw-headline" id="Uso">Uso</span></h2>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Nota:</strong> 
<ul>
<li>Algumas ferramentas do <a href="../pt/Systemd.html" title="Systemd (Português)">systemd</a>, tal como <i>hostnamectl</i>, <i>localectl</i> e <i>timedatectl</i>, não podem ser usados dentro de um chroot, pois eles exigem uma conexão <a href="../en/D-Bus.html" class="mw-redirect" title="Dbus">dbus</a> ativa. <a rel="nofollow" class="external autonumber" href="https://github.com/systemd/systemd/issues/798#issuecomment-126568596">[1]</a>
</li>
<li>O sistema de arquivos que vai servir como uma nova raiz (<code>/</code>) de seu chroot deve estar acessível (i.e., descriptografado, montado).</li>
</ul>
</div>
<p>Há duas opções principais para usar chroot, descritas abaixo.
</p>
<h3><span class="mw-headline" id="Usando_arch-chroot">Usando arch-chroot</span></h3>
<p>O script bash <code>arch-chroot</code> é parte do pacote <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=arch-install-scripts">arch-install-scripts</a></span>.  Antes que ele execute <code>/usr/bin/chroot</code>, o script monta sistemas de arquivos de api como <code>/proc</code> e torna o <code>/etc/resolv.conf</code> disponível no chroot.
</p>
<h4><span class="mw-headline" id="Entrar_em_um_chroot">Entrar em um chroot</span></h4>
<p>Execute <i>arch-chroot</i> com o novo diretório raiz como o primeiro argumento:
</p>
<pre># arch-chroot <i>/local/da/nova/raiz</i>
</pre>
<p>Por exemplo, no <a href="../pt/Installation_guide.html" class="mw-redirect" title="Guia de instalação">guia de instalação</a> esse diretório seria o <code>/mnt</code>:
</p>
<pre># arch-chroot /mnt
</pre>
<p>Para sair do chroot, basta usar:
</p>
<pre># exit
</pre>
<h4>
<span id="Executar_um_.C3.BAnico_comando_e_sair"></span><span class="mw-headline" id="Executar_um_único_comando_e_sair">Executar um único comando e sair</span>
</h4>
<p>Para executar um comando a partir do chroot e sair novamente, anexe o comando ao final da linha:
</p>
<pre># arch-chroot <i>/local/da/nova/raiz</i> <i>meucomando</i>
</pre>
<p>Por exemplo, para executar <code>mkinitcpio -p linux</code> para um chroot localizado em <code>/mnt/arch</code> faça:
</p>
<pre># arch-chroot /mnt/arch mkinitcpio -p linux
</pre>
<h3><span class="mw-headline" id="Usando_chroot">Usando chroot</span></h3>
<div class="archwiki-template-box archwiki-template-box-warning">
<strong>Atenção:</strong> Ao usar <code>--rbind</code>, alguns subdiretório de <code>dev/</code> e <code>sys/</code> não serão desmontáveis. Tentar desmontar com <code>umount -l</code> nesta situação vai quebrar a sua sessão, exigindo um <i>reboot</i>. Se possível, use <code>-o bind</code>.</div>
<p>No exemplo a seguir, <code>/local/da/nova/raiz</code> é o diretório no qual a nova raiz reside.
</p>
<p>Primeiro, monte os sistemas de arquivos de API temporários:
</p>
<pre># cd <i>/local/da/nova/raiz</i>
# mount -t proc /proc proc/
# mount --rbind /sys sys/
# mount --rbind /dev dev/
</pre>
<p>E opcionalmente:
</p>
<pre># mount --rbind /run run/
</pre>
<p>Em seguida, para usar uma conexão com a internet no ambiente <i>chroot</i> copie os detalhes do DNS:
</p>
<pre># cp /etc/resolv.conf etc/resolv.conf
</pre>
<p>Finalmente, para alterar a raiz para <code>/local/da/nova/raiz</code> usando um shell do bash:
</p>
<pre># chroot <i>/local/da/nova/raiz</i> /bin/bash
</pre>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Nota:</strong> Se você vir o erro:
<ul>
<li>
<code>chroot: não foi possível executar o comando '/usr/bin/bash': Erro no formato exec</code>, é provável que as arquiteturas do ambiente hospedeiro e do ambiente <i>chroot</i> não sejam iguais.</li>
<li>
<code>chroot: '/usr/bin/bash': permissão negada</code>, remote com a permissão de execução: <code>mount -o remount,exec <i>/local/da/nova/raiz</i></code>.</li>
</ul>
</div>
<p>Após fazer o <i>chroot</i> pode ser necessário carregar a configuração local do bash:
</p>
<pre># source /etc/profile
# source ~/.bashrc
</pre>
<div class="archwiki-template-box archwiki-template-box-tip">
<strong>Dica:</strong> Opcionalmente, crie um prompt único ser possível diferenciar seu ambiente <i>chroot</i>:
<pre># export PS1="(chroot) $PS1"</pre>
</div>
<p>Ao finalizar com o <i>chroot</i>, você pode sair dele via:
</p>
<pre># exit
</pre>
<p>Então, desmonte os sistemas de arquivos temporários:
</p>
<pre># cd /
# umount --recursive <i>/local/da/nova/raiz</i>
</pre>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Nota:</strong> Se houver um erro mencionando algo como: <code>umount: /caminho: dispositivo está ocupado</code> isso geralmente significa que: um programa (até mesmo um shell) foi mantido em execução no chroot ou que uma submontagem ainda existe. Saia do programa e use <code>findmnt -R /local/da/nova/raiz</code> para localizar e então desmontar (com <code>umount</code>) as submontagens. Pode ser complicado desmontar algumas coisas e pode-se ter sorte com o <code>umount --force</code>. Como um último recurso, use <code>umount --lazy</code> para apenas liberá-los. Em ambos casos, para ter segurança, reinicialize (com <code>reboot</code>) assim que possível se essas coisas ficarem não resolvidas para evitar possíveis conflitos futuros.</div>
<h2>
<span id="Executar_aplicativos_gr.C3.A1ficos_a_partir_do_chroot"></span><span class="mw-headline" id="Executar_aplicativos_gráficos_a_partir_do_chroot">Executar aplicativos gráficos a partir do chroot</span>
</h2>
<p>Se você tiver um <a href="../pt/Xorg.html" class="mw-redirect" title="Servidor X">servidor X</a> funcionando em seu sistema, você pode iniciar aplicativos gráficos a partir do ambiente chroot.
</p>
<p>Para permitir que o ambiente <i>chroot</i> se conecte a um servidor X, abra um terminal virtual dentro do servidor X (i.e. dentro do computador do usuário que está atualmente autenticado), então execute o comando <a href="../pt/Xhost.html" title="Xhost (Português)">xhost</a>, que dá a permissão para qualquer um se conectar ao servidor X do usuário (veja também <a href="../pt/Xhost.html" title="Xhost (Português)">Xhost</a>):
</p>
<pre>$ xhost +local:
</pre>
<p>Então, para direcionar os aplicativos para o servidor X do <i>chroot</i>, defina a variável de ambiente DISPLAY dentro do <i>chroot</i> para corresponder a variável DISPLAY do usuário que possui o servidor X. Então, por exemplo, execute
</p>
<pre>$ echo $DISPLAY
</pre>
<p>como o usuário que possui o servidor X para ver o valor de DISPLAY. Se o valor for ": 0" (por exemplo), em seguida, no ambiente <i>chroot</i> é executado
</p>
<pre># export DISPLAY=:0
</pre>
<h2>
<span id="Sem_privil.C3.A9gios_de_root"></span><span class="mw-headline" id="Sem_privilégios_de_root">Sem privilégios de root</span>
</h2>
<p>O <i>chroot</i> requer privilégios de root, o que pode não ser desejável ou possível para o usuário obter em determinadas situações. Há, no entanto, várias maneiras de simular o comportamento de <i>chroot</i> com implementações alternativas.
</p>
<h3><span class="mw-headline" id="PRoot">PRoot</span></h3>
<p><a href="../pt/PRoot.html" title="PRoot (Português)">PRoot</a> pode ser usado para alterar o diretório raiz aparente e usar <code>mount --bind</code> sem privilégios de root. Isso é útil para confinar aplicativos para um único diretório ou executar programas criados para uma arquitetura de CPU diferente, mas tem limitações devido ao fato de que todos os arquivos são de propriedade do usuário no sistema hospedeiro. O PRoot fornece um argumento <code>--root-id</code> que pode ser usado como uma solução alternativa para algumas dessas limitações de maneira semelhante (embora mais limitada) para <i>fakeroot</i>.
</p>
<h3><span class="mw-headline" id="Fakechroot">Fakechroot</span></h3>
<p><span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=fakechroot">fakechroot</a></span> é uma camada de biblioteca que intercepta a chamada do <i>chroot</i> e falsifica os resultados. Ele pode ser usado em conjunto com <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=fakeroot">fakeroot</a></span> para simular um <i>chroot</i> como usuário comum.
</p>
<pre># fakechroot fakeroot chroot ~/meu-chroot bash
</pre>
<h2>
<span id="Veja_tamb.C3.A9m"></span><span class="mw-headline" id="Veja_também">Veja também</span>
</h2>
<ul><li><a rel="nofollow" class="external text" href="https://help.ubuntu.com/community/BasicChroot">Básico de chroot</a></li></ul>
</div>
</div>
<div id="catlinks" class="catlinks" data-mw="interface"><div id="mw-normal-catlinks" class="mw-normal-catlinks">
<a href="../Special:Categories.html" title="Special:Categories">Categories</a>: <ul>
<li><a href="../pt/Category:System_recovery.html" title="Category:System recovery (Português)">System recovery (Português)</a></li>
<li><a href="../pt/Category:Sandboxing.html" title="Category:Sandboxing (Português)">Sandboxing (Português)</a></li>
</ul>
</div></div>
	</div>
</div>

<footer id="footer" class="mw-footer" role="contentinfo" style="margin: 0">
	<ul id="footer-info">
		<li>Retrieved from "<a dir="ltr" href="https://wiki.archlinux.org/index.php?title=Chroot_(Portugu%C3%AAs)&amp;oldid=638322">https://wiki.archlinux.org/index.php?title=Chroot_(Português)&amp;oldid=638322</a>"</li>
		<li id="footer-info-lastmod"> This page was last edited on 14 October 2020, at 07:09.</li>
		<li id="footer-info-copyright">Content is available under <a class="external" rel="nofollow" href="http://www.gnu.org/copyleft/fdl.html">GNU Free Documentation License 1.3 or later</a> unless otherwise noted.</li>
	<br>
</ul>
	<ul id="footer-places">
		<li id="footer-places-privacy"><a href="../en/ArchWiki:Privacy_policy.html" title="ArchWiki:Privacy policy">Privacy policy</a></li>
		<li id="footer-places-about"><a href="../en/ArchWiki:About.html" title="ArchWiki:About">About ArchWiki</a></li>
		<li id="footer-places-disclaimer"><a href="../en/ArchWiki:General_disclaimer.html" title="ArchWiki:General disclaimer">Disclaimers</a></li>
	</ul>
	<ul id="footer-icons" class="noprint">
		<li id="footer-copyrightico">
	</ul>
	<div style="clear: both;"></div>
</footer>



</body>
</html>
