<!DOCTYPE html>
<html class="client-nojs" lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<title>NFS (Español) - ArchWiki</title>
<link rel="stylesheet" href="../ArchWikiOffline.css">
<meta name="ResourceLoaderDynamicStyles" content="">
<meta name="generator" content="MediaWiki 1.35.0">
<meta name="referrer" content="no-referrer-when-downgrade">
<meta name="robots" content="noindex,follow">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="shortcut icon" href="/favicon.ico">
<link rel="search" type="application/opensearchdescription+xml" href="/opensearch_desc.php" title="ArchWiki (en)">
<link rel="EditURI" type="application/rsd+xml" href="https://wiki.archlinux.org/api.php?action=rsd">
<link rel="license" href="http://www.gnu.org/copyleft/fdl.html">
<link rel="alternate" type="application/atom+xml" title="ArchWiki Atom feed" href="/index.php?title=Special:RecentChanges&amp;feed=atom">
</head>
<body class="mediawiki ltr sitedir-ltr mw-hide-empty-elt ns-0 ns-subject page-NFS_Español rootpage-NFS_Español skin-vector action-view skin-vector-legacy">
<div id="content" class="mw-body" role="main" style="margin: 0">
	<a id="top"></a>
	<div id="siteNotice" class="mw-body-content"></div>
	<div class="mw-indicators mw-body-content">
	</div>
	<h1 id="firstHeading" class="firstHeading" lang="en">NFS (Español)</h1>
	<div id="bodyContent" class="mw-body-content">
		<div id="siteSub" class="noprint">From ArchWiki</div>
		<div id="contentSub"></div>
		<div id="contentSub2"></div>
		
		<div id="jump-to-nav"></div>
		<a class="mw-jump-link" href="#mw-head">Jump to navigation</a>
		<a class="mw-jump-link" href="#searchInput">Jump to search</a>
		<div id="mw-content-text" lang="en" dir="ltr" class="mw-content-ltr">
<div class="warningbox">The printable version is no longer supported and may have rendering errors. Please update your browser bookmarks and please use the default browser print function instead.</div>
<div class="mw-parser-output">
<div class="archwiki-template-meta-related-articles-start">
<p>Artículos relacionados</p>
<ul>
<li><a href="../en/NFS/Troubleshooting.html" class="mw-redirect" title="NFS Troubleshooting">NFS Troubleshooting</a></li>
</ul>
</div>
<p>Según la <a href="https://en.wikipedia.org/wiki/es:Network_File_System" class="extiw" title="wikipedia:es:Network File System">Wikipedia</a>: 
</p>
<dl><dd><i>El Network File System (Sistema de archivos de red), o NFS, es un protocolo de nivel de aplicación, desarrollado originariamente por Sun Microsystems en 1984, que permite a un usuario de un equipo cliente acceder a archivos remotos a través de una red, de una manera similar a como se accede a los archivos almacenados localmente.</i></dd></dl>
<div id="toc" class="toc" role="navigation" aria-labelledby="mw-toc-heading">
<input type="checkbox" role="button" id="toctogglecheckbox" class="toctogglecheckbox" style="display:none"><div class="toctitle" lang="en" dir="ltr">
<h2 id="mw-toc-heading">Contents</h2>
<span class="toctogglespan"><label class="toctogglelabel" for="toctogglecheckbox"></label></span>
</div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Instalaci%C3%B3n"><span class="tocnumber">1</span> <span class="toctext">Instalación</span></a></li>
<li class="toclevel-1 tocsection-2">
<a href="#Configuraci%C3%B3n"><span class="tocnumber">2</span> <span class="toctext">Configuración</span></a>
<ul>
<li class="toclevel-2 tocsection-3"><a href="#Servidor"><span class="tocnumber">2.1</span> <span class="toctext">Servidor</span></a></li>
<li class="toclevel-2 tocsection-4">
<a href="#Iniciar/Habilitar_servicios"><span class="tocnumber">2.2</span> <span class="toctext">Iniciar/Habilitar servicios</span></a>
<ul>
<li class="toclevel-3 tocsection-5"><a href="#Mapeo_de_ID"><span class="tocnumber">2.2.1</span> <span class="toctext">Mapeo de ID</span></a></li>
<li class="toclevel-3 tocsection-6"><a href="#Sistema_de_archivos"><span class="tocnumber">2.2.2</span> <span class="toctext">Sistema de archivos</span></a></li>
<li class="toclevel-3 tocsection-7"><a href="#Exportaci%C3%B3n"><span class="tocnumber">2.2.3</span> <span class="toctext">Exportación</span></a></li>
<li class="toclevel-3 tocsection-8"><a href="#Arrancando_el_servidor"><span class="tocnumber">2.2.4</span> <span class="toctext">Arrancando el servidor</span></a></li>
<li class="toclevel-3 tocsection-9"><a href="#Configuraci%C3%B3n_del_cortafuegos"><span class="tocnumber">2.2.5</span> <span class="toctext">Configuración del cortafuegos</span></a></li>
</ul>
</li>
<li class="toclevel-2 tocsection-10">
<a href="#Cliente"><span class="tocnumber">2.3</span> <span class="toctext">Cliente</span></a>
<ul>
<li class="toclevel-3 tocsection-11">
<a href="#Montaje_en_Linux"><span class="tocnumber">2.3.1</span> <span class="toctext">Montaje en Linux</span></a>
<ul>
<li class="toclevel-4 tocsection-12"><a href="#Ajustes_en_/etc/fstab"><span class="tocnumber">2.3.1.1</span> <span class="toctext">Ajustes en /etc/fstab</span></a></li>
<li class="toclevel-4 tocsection-13"><a href="#Uso_de_autofs"><span class="tocnumber">2.3.1.2</span> <span class="toctext">Uso de autofs</span></a></li>
</ul>
</li>
<li class="toclevel-3 tocsection-14"><a href="#Montaje_en_Windows"><span class="tocnumber">2.3.2</span> <span class="toctext">Montaje en Windows</span></a></li>
<li class="toclevel-3 tocsection-15"><a href="#Montaje_en_OS_X"><span class="tocnumber">2.3.3</span> <span class="toctext">Montaje en OS X</span></a></li>
</ul>
</li>
</ul>
</li>
<li class="toclevel-1 tocsection-16">
<a href="#Consejos_y_trucos"><span class="tocnumber">3</span> <span class="toctext">Consejos y trucos</span></a>
<ul>
<li class="toclevel-2 tocsection-17"><a href="#Ajustar_el_rendimiento"><span class="tocnumber">3.1</span> <span class="toctext">Ajustar el rendimiento</span></a></li>
<li class="toclevel-2 tocsection-18">
<a href="#Manejar_el_montaje_autom%C3%A1tico"><span class="tocnumber">3.2</span> <span class="toctext">Manejar el montaje automático</span></a>
<ul>
<li class="toclevel-3 tocsection-19"><a href="#NetworkManager_dispatcher"><span class="tocnumber">3.2.1</span> <span class="toctext">NetworkManager dispatcher</span></a></li>
</ul>
</li>
<li class="toclevel-2 tocsection-20"><a href="#Configurar_puertos_fijos_para_NFS"><span class="tocnumber">3.3</span> <span class="toctext">Configurar puertos fijos para NFS</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-21"><a href="#Soluci%C3%B3n_de_problemas"><span class="tocnumber">4</span> <span class="toctext">Solución de problemas</span></a></li>
<li class="toclevel-1 tocsection-22"><a href="#V%C3%A9ase_tambi%C3%A9n"><span class="tocnumber">5</span> <span class="toctext">Véase también</span></a></li>
</ul>
</div>

<h2>
<span id="Instalaci.C3.B3n"></span><span class="mw-headline" id="Instalación">Instalación</span>
</h2>
<p>Tanto el cliente como el servidor necesitan únicamente de la <a href="../es/Help:Reading.html#Instalaci.C3.B3n_de_paquetes" title="Help:Reading (Español)">instalación</a> del paquete <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=nfs-utils">nfs-utils</a></span>.
</p>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Nota:</strong> Es SUMAMENTE recomendable el uso de un demonio de sincronización horaria en TODOS los nodos de su red para mantener sincronizados los relojes de cliente y servidor. ¡Si no hay un ajuste preciso en los relojes de todos los nodos, el NFS puede presentar retrasos indeseados! El sistema <a href="../en/Network_Time_Protocol_daemon.html" title="Network Time Protocol daemon">NTP</a> es recomendable para sincronizar tanto el servidor como los clientes con los servidores NTP extremadamente precisos disponibles en Internet.</div>
<h2>
<span id="Configuraci.C3.B3n"></span><span class="mw-headline" id="Configuración">Configuración</span>
</h2>
<h3><span class="mw-headline" id="Servidor">Servidor</span></h3>
<h3>
<span id="Iniciar.2FHabilitar_servicios"></span><span class="mw-headline" id="Iniciar/Habilitar_servicios">Iniciar/Habilitar servicios</span>
</h3>
<p>Para hacer uso del servidor sera necesario iniciar el servicio de nfs-server y habilitarlo si se desea dejar permanente.
</p>
<p>Iniciar
</p>
<pre># systemctl start nfs-server.service
</pre>
<p>Habilitar
</p>
<pre># systemctl enable nfs-server.service
</pre>
<h4><span class="mw-headline" id="Mapeo_de_ID">Mapeo de ID</span></h4>
<p>Edite <code>/etc/idmapd.conf</code> y establezca el campo <code>Domain</code> con su nombre de dominio.
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/idmapd.conf</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">[General]
 
Verbosity = 1
Pipefs-Directory = /var/lib/nfs/rpc_pipefs
Domain = atomic

[Mapping]

Nobody-User = nobody
Nobody-Group = nobody
</pre>
<h4><span class="mw-headline" id="Sistema_de_archivos">Sistema de archivos</span></h4>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Nota:</strong> Por razones de seguridad, es recomendable que use una raíz de exportación NFS con lo que mantendrá a los usuarios únicamente dentro de ese punto de montaje. El siguiente ejemplo ilustrará esta idea.</div>
<p>Defina los archivos de NFS compartidos en <code>/etc/exports</code> con una ruta relativa a la raíz de NFS.  En este ejemplo, la raíz NFS será <code>/srv/nfs4</code> y el recurso compartido será <code>/mnt/music</code>.
</p>
<pre># mkdir -p /srv/nfs4/music</pre>
<p>Deberá otorgar permisos de lectura/escritura al directorio music para que los clientes puedan escribir en él. 
</p>
<p>Ahora monte el directorio que desea compartir, en este caso <code>/mnt/music</code>, en el directorio compartido de NFS a través de la instrucción de montaje:
</p>
<pre># mount --bind /mnt/music /srv/nfs4/music</pre>
<p>Para hacer que los cambios sean permanentes en cada reinicio del servidor, añada el enlace de montaje a <code>fstab</code>:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/fstab</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">/mnt/music /srv/nfs4/music  none   bind   0   0
</pre>
<h4>
<span id="Exportaci.C3.B3n"></span><span class="mw-headline" id="Exportación">Exportación</span>
</h4>
<p>Añada los directorios que se compartirán y la dirección IP o nombre de servidor de las máquinas cliente a las que les estará permitido montarlas en <code>exports</code>:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/exports</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">/srv/nfs4/ 192.168.0.1/24(rw,fsid=root,no_subtree_check)
/srv/nfs4/music 192.168.0.1/24(rw,no_subtree_check,nohide) # note the nohide option which is applied to mounted directories on the file system.
</pre>
<p>Los usuarios no necesitan abrir el material compartido a la subred completa; se puede especificar solo una dirección IP o un nombre de servidor.
</p>
<p>Para más información sobre todas las opciones disponibles vea <span class="plainlinks archwiki-template-man" title="$ man 5 exports"><a rel="nofollow" class="external text" href="https://man.archlinux.org/man/exports.5">exports(5)</a></span>.
</p>
<p>Si usted modifica <code>/etc/exports</code> mientras el servidor está funcionando, debe volver a exportarlos para que los cambios surtan efecto:
</p>
<pre># exportfs -rav</pre>
<h4><span class="mw-headline" id="Arrancando_el_servidor">Arrancando el servidor</span></h4>
<p><a href="../en/Daemons.html" title="Daemons">Encienda/habilite</a> los servicios <code>rpcbind.service</code> y <code>nfs-client.target</code>:
</p>
<pre># systemctl start rpcbind nfs-client.target
</pre>
<p>Observe que esas unidades requieren de otros servicios, que serán lanzados automáticamente por <a href="../es/Systemd.html" title="Systemd (Español)">systemd</a>.
</p>
<h4>
<span id="Configuraci.C3.B3n_del_cortafuegos"></span><span class="mw-headline" id="Configuración_del_cortafuegos">Configuración del cortafuegos</span>
</h4>
<p>Para activar el acceso a través de un cortafuegos, necesita abrir los puertos 111, 2049, y 20048 para tcp y udp. Para configurar dichos puertos para <a href="../es/Iptables.html" title="Iptables (Español)">iptables</a>, edite <code>/etc/iptables/iptables.rules</code> para incluir las líneas siguientes:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/iptables/iptables.rules</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">-A INPUT -p tcp -m tcp --dport 111 -j ACCEPT
-A INPUT -p tcp -m tcp --dport 2049 -j ACCEPT
-A INPUT -p tcp -m tcp --dport 20048 -j ACCEPT
-A INPUT -p udp -m udp --dport 111 -j ACCEPT
-A INPUT -p udp -m udp --dport 2049 -j ACCEPT
-A INPUT -p udp -m udp --dport 20048 -j ACCEPT
</pre>
<p>Para aplicar los cambios, reinicie el servicio <code>iptables</code>.
</p>
<h3><span class="mw-headline" id="Cliente">Cliente</span></h3>
<p>Los clientes necesitan de <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=nfs-utils">nfs-utils</a></span> para conectarse, y para evitar una demora aproximadamente de 15 segundos a la que acompaña un error que dice: «RPC: AUTH_GSS upcall timed out», obligando a los usuarios a iniciar el servicio <code>rpc-gssd</code> en cualquier equipo cliente.  
</p>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Nota:</strong> Los servidores NFS4 no necesitan ejecutar este servicio.</div>
<h4><span class="mw-headline" id="Montaje_en_Linux">Montaje en Linux</span></h4>
<p>Muestre los sistemas de archivos exportados por el servidor:
</p>
<pre>$ showmount -e servername</pre>
<p>A continuación móntelos omitiendo la raíz de exportación del servidor NFS: 
</p>
<pre># mount -t nfs4 servername:/music /mountpoint/on/client</pre>
<h5>
<span id="Ajustes_en_.2Fetc.2Ffstab"></span><span class="mw-headline" id="Ajustes_en_/etc/fstab">Ajustes en /etc/fstab</span>
</h5>
<p>El uso de <a href="../es/Fstab.html" title="Fstab (Español)">fstab</a> es útil para un servidor que siempre esté operativo, y los recursos compartidos a través de NFS estén disponible en cualquier lugar que arranque el cliente. Edite el archivo <code>/etc/fstab</code>, y añada la línea de configuración apropiada. De nuevo, deberá omitir la ruta de la raíz de exportación del servidor NFS.
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/fstab</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">servername:/music   /mountpoint/on/client   nfs4   rsize=8192,wsize=8192,timeo=14,intr,_netdev	0 0
</pre>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Nota:</strong> Consulte la página principal de NFS para obtener más información.</div>
<p>Algunas opciones de montaje adicionales que puede tener en cuenta para incluir son:
</p>
<dl>
<dt>rsize y wsize</dt>
<dd>El valor <code>rsize</code> es el número de bytes usados cuando se lee desde el servidor. El valor <code>wsize</code> es el número de bytes usados cuando se escribe en el servidor. El valor predeterminado para ambos es 1024, pero si se usan valores mayores como 8192 puede mejorar el rendimiento.  Esto no es así de manera general. Es recomendable hacer pruebas antes de hacer definitivos estos cambios, véase <a href="#Ajustar_el_rendimiento">#Ajustar el rendimiento</a>.</dd>
</dl>
<dl>
<dt>timeo</dt>
<dd>El valor <code>timeo</code> es la cantidad de tiempo, en décimas de segundo, que se debe esperar antes de volver a enviar una transmisión después de un tiempo de espera RPC. Después del primer tiempo de espera, este valor se doblará en cada reintento hasta alcanzar un máximo de 60 segundos o hasta que se produzca un tiempo de espera mayor. Si la conexión se realiza con un servidor lento o en una red muy concurrida, puede conseguir un mayor rendimiento si aumenta este tiempo de espera.</dd>
</dl>
<dl>
<dt>intr</dt>
<dd>La opción <code>intr</code> permite enviar señales para interrumpir las operación de los archivos si ocurre un tiempo de espera mayor en la partición compartida.</dd>
</dl>
<dl>
<dt>_netdev</dt>
<dd>La opción <code>_netdev</code> le dice al sistema que espere hasta que la red esté operativa después de intentar montar el recurso compartido. systemd lo hace de manera predeterminada para NFS, pero de todas formas es una buena práctica usarlo para todos los tipos de sistemas de archivos en red.</dd>
</dl>
<h5><span class="mw-headline" id="Uso_de_autofs">Uso de autofs</span></h5>
<p>El uso de <a href="../en/Autofs.html" title="Autofs">autofs</a> es útil cuando varías máquinas se quieren conectar a través de NFS; ya sean clientes o servidores. La razón por la cual este método es perferible a los más actuales es que si el servidor se apaga, el cliente no mostrará mensajes de error al ser incapaz de encontrar los archivos compartidos. Revise <a href="../en/Autofs.html#NFS_network_mounts" title="Autofs">autofs#NFS network mounts</a> para obtener mayor información.
</p>
<h4><span class="mw-headline" id="Montaje_en_Windows">Montaje en Windows</span></h4>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Nota:</strong> Solo las ediciones Ultimate y Enterprise de Windows 7 y la edición Enterprise de Windows 8 incluyen «Cliente de NFS».</div>
<p>Los archivos compartidos a través de NFS pueden ser montados desde Windows si el servicio «Cliente de NFS» está activo (no lo está de manera predeterminada).
Para instalar el servicio vaya a «Programas y características» en el Panel de Control y pulse en «Encender o apagar las características de Windows». Busque los «Servicios de NFS» y actívelos conjuntamente con los subservicios («Herramientas administrativas» y «Cliente de NFS»).
</p>
<p>Puede seleccionar algunas opciones generales abriendo los «Servicios para Network File System» (localícelo con la caja de búsquedas) y pulse con el botón secundario del ratón en cliente → propiedades. 
</p>
<div class="archwiki-template-box archwiki-template-box-warning">
<strong>Advertencia:</strong> Pueden producirse problemas graves de rendimiento (de forma aleatoria tarda 30-60 segundos en mostrar la carpeta, velocidades de copia de 2 MB/s en una red LAN Gigabit, ...) para lo cual, Microsoft no tiene aún una solución.<a rel="nofollow" class="external autonumber" href="https://social.technet.microsoft.com/Forums/en-CA/w7itpronetworking/thread/40cc01e3-65e4-4bb6-855e-cef1364a60ac">[1]</a>
</div>
<p>Para montar un recurso compartido mediante Explorer:
</p>
<p><code>Mi PC</code> &gt; <code>Conectar una unidad de red</code> &gt; <code>nombre de servidor:/srv/nfs4/music</code>
</p>
<h4><span class="mw-headline" id="Montaje_en_OS_X">Montaje en OS X</span></h4>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Nota:</strong> OS X usa de forma predeterminada un puerto inseguro (&gt;1024) para montar los recursos compartidos.</div>
<p>O bien exporte del recurso compartido con la marca <code>insecure</code>, y monte usando Finder:
</p>
<p><code>Go</code> &gt; <code>Connect to Server</code> &gt; <code>nfs://servername/</code>
</p>
<p>O, monte el recurso compartido usando un puerto seguro usando la terminal:
</p>
<pre># sudo mount -t nfs -o resvport servername:/srv/nfs4 /Volumes/servername</pre>
<h2><span class="mw-headline" id="Consejos_y_trucos">Consejos y trucos</span></h2>
<h3><span class="mw-headline" id="Ajustar_el_rendimiento">Ajustar el rendimiento</span></h3>
<p>Con el fin de obtener el máximo rendimiento de NFS, es necesario ajustar las opciones de montaje de <code>rsize</code> y <code>wsize</code> para satisfacer los requisitos de la configuración de la red.
</p>
<h3>
<span id="Manejar_el_montaje_autom.C3.A1tico"></span><span class="mw-headline" id="Manejar_el_montaje_automático">Manejar el montaje automático</span>
</h3>
<p>Este consejo es muy útil para los portátiles que requieren compartir NFS desde una red inalámbrica local. Si el equipo NFS se vuelve inaccesible, el recurso compartido NFS se desmontará para evitar que el sistema se bloquea cuando usemos la opción <code>hard mount</code>. Véase <a rel="nofollow" class="external free" href="https://bbs.archlinux.org/viewtopic.php?pid=1260240#p1260240">https://bbs.archlinux.org/viewtopic.php?pid=1260240#p1260240</a>
</p>
<p>Asegúrese de que los puntos de montaje NFS están indicados correctamente en <code>/etc/fstab</code>:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">$ cat /etc/fstab</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">lithium:/mnt/data           /mnt/data	        nfs noauto,noatime,rsize=32768,wsize=32768,intr,hard 0 0
lithium:/var/cache/pacman   /var/cache/pacman	nfs noauto,noatime,rsize=32768,wsize=32768,intr,hard 0 0
</pre>
<p>La opción de montaje <code> noauto</code> le dice a systemd que no monte automáticamente los recursos compartidos en el arranque. De otro modo, systemd intentará montar los recursos compartidos nfs, que puedan o no existir en la red, demorando el proceso de arranque con una pantalla en blanco.
</p>
<p>Con el fin de poder montar el recurso compartido NFS por un usuario normal, puede ser necesario añadir la opción <code>user</code> a la entrada fstab. También le posibilitará que active rpc-statd.service.
</p>
<p>Cree el script <code>auto_share</code>, que será utilizado por <i>cron</i> para comprobar si el equipo NFS está accesible:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/root/bin/auto_share</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">#!/bin/bash

SERVER="YOUR_NFS_HOST"

MOUNT_POINTS=$(sed -e '/^.*#/d' -e '/^.*:/!d' -e 's/\t/ /g' /etc/fstab | tr -s " " | cut -f2 -d" ")

ping -c 1 "${SERVER}" &amp;&gt;/dev/null

if [ $? -ne 0 ]; then
    # The server could not be reached, unmount the shares
    for umntpnt in ${MOUNT_POINTS}; do
        umount -l -f $umntpnt &amp;&gt;/dev/null
    done
else
    # The server is up, make sure the shares are mounted
    for mntpnt in ${MOUNT_POINTS}; do
        mountpoint -q $mntpnt || mount $mntpnt
    done
fi
</pre>
<pre># chmod +x /root/bin/auto_share
</pre>
<p>Cree la entrada cron de root para ejecutar <code>auto_share</code> en todo momento:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;"># crontab -e</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">* * * * * /root/bin/auto_share
</pre>
<p>Un archivo de unidad de systemd también puede ser utilizado para montar los recursos compartidos NFS en el arranque. El archivo de unidad no es necesario si NetworkManager está instalado y configurado en el sistema cliente. Véase <a href="#NetworkManager_dispatcher">#NetworkManager dispatcher</a>.
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/systemd/system/auto_share.service</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">[Unit]
Description=NFS automount

[Service]
Type=oneshot
RemainAfterExit=yes
ExecStart=/root/bin/auto_share

[Install]
WantedBy=multi-user.target
</pre>
<p>Ahora active <code>auto_share</code>.
</p>
<h4><span class="mw-headline" id="NetworkManager_dispatcher">NetworkManager dispatcher</span></h4>
<p>Además del método descrito anteriormente, NetworkManager también se puede configurar para ejecutar un script para cuando cambie el estado de la conexión de red.
</p>
<p>Active e inicie el servicio <code>NetworkManager-dispatcher</code>.
</p>
<p>El método más fácil para montar recursos compartidos al cambiar el estado de la red es creando un enlace simbólico al script <code>auto_share</code>:
</p>
<pre># ln -s /root/bin/auto_share /etc/NetworkManager/dispatcher.d/30_nfs.sh
</pre>
<p>O, usando el script de montaje siguiente, que comprueba la disponibilidad de la red:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/NetworkManager/dispatcher.d/30_nfs.sh</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">#!/bin/bash

SSID="CHANGE_ME"

MOUNT_POINTS=$(sed -e '/^.*#/d' -e '/^.*:/!d' -e 's/\t/ /g' /etc/fstab | tr -s " " | cut -f2 -d" ")

ISNETUP=$(nmcli dev wifi | \grep $SSID | tr -s ' ' | cut -f 10 -d ' ') 2&gt;/dev/null

# echo "$ISNETUP" &gt;&gt; /tmp/nm_dispatch_log

if [[ "$ISNETUP" == "yes" ]]; then
    for mntpnt in ${MOUNT_POINTS}; do
        mountpoint -q $mntpnt || mount $mntpnt
    done
else
    for srvexp in ${MOUNT_POINTS}; do
        umount -l -f $srvexp &amp;&gt;/dev/null
    done
fi
</pre>
<p>Ahora, cuando el SSID inalámbrico "CHANGE_ME" se encienda o se apaque, el script <code>nfs.sh</code> será llamado para montar o desmontar los recursos compartidos, tan pronto le sea posible.
</p>
<h3><span class="mw-headline" id="Configurar_puertos_fijos_para_NFS">Configurar puertos fijos para NFS</span></h3>
<div class="noprint archwiki-template-message">
<p><a href="../File:Tango-view-refresh-red.png" class="image"><img alt="Tango-view-refresh-red.png" src="../File:Tango-view-refresh-red.png" decoding="async" width="48" height="48"></a><b>This article or section is out of date.</b><a href="../File:Tango-view-refresh-red.png" class="image"><img alt="Tango-view-refresh-red.png" src="../File:Tango-view-refresh-red.png" decoding="async" width="48" height="48"></a></p>
<div>
<b>Reason:</b> Está sección está referida originariamente a la versión 3 de NFS. (Discuss in <a rel="nofollow" class="external text" href="https://wiki.archlinux.org/index.php/Talk:NFS_(Espa%C3%B1ol)">Talk:NFS (Español)#</a>)</div>
</div>
<p>Si tiene un <a href="../es/Category:Firewalls.html" class="mw-redirect" title="Firewalls (Español)">cortafuegos</a> configurado a través de un puerto, es posible que desee establecer puertos fijos. Para <code>rpc.statd</code> y <code>rpc.mountd</code> debe configurar los ajustes siguientes en <code>/etc/conf.d/nfs-common</code> y <code>/etc/conf.d/nfs-server</code> (los puertos pueden ser diferentes):
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/conf.d/nfs-common</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">STATD_OPTS="-p 4000 -o 4003"</pre>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/conf.d/nfs-server</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">MOUNTD_OPTS="--no-nfs-version 2 -p 4002"</pre>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/modprobe.d/lockd.conf</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;"># Static ports for NFS lockd
options lockd nlm_udpport=4001 nlm_tcpport=4001</pre>
<p>Después de reiniciar los demonios <code>nfs-common</code>, <code>nfs-server</code> y recargar los módulos <code>lockd</code>, puede comprobar los puertos utilizados con la siguiente orden:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">$ rpcinfo -p</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">   program vers proto   port  service
    100000    4   tcp    111  portmapper
    100000    3   tcp    111  portmapper
    100000    2   tcp    111  portmapper
    100000    4   udp    111  portmapper
    100000    3   udp    111  portmapper
    100000    2   udp    111  portmapper
    100024    1   udp   4000  status
    100024    1   tcp   4000  status
    100021    1   udp   4001  nlockmgr
    100021    3   udp   4001  nlockmgr
    100021    4   udp   4001  nlockmgr
    100021    1   tcp   4001  nlockmgr
    100021    3   tcp   4001  nlockmgr
    100021    4   tcp   4001  nlockmgr
    100003    2   tcp   2049  nfs
    100003    3   tcp   2049  nfs
    100003    4   tcp   2049  nfs
    100003    2   udp   2049  nfs
    100003    3   udp   2049  nfs
    100003    4   udp   2049  nfs
    100005    3   udp   4002  mountd
    100005    3   tcp   4002  mountd
</pre>
<p>A continuación, es necesario abrir los puertos 111-2049-4000-4001-4002-4003 TCP y UDP.
</p>
<h2>
<span id="Soluci.C3.B3n_de_problemas"></span><span class="mw-headline" id="Solución_de_problemas">Solución de problemas</span>
</h2>
<p><i>Hay un artículo dedicado a la solución de problemas: <a href="../en/NFS/Troubleshooting.html" class="mw-redirect" title="NFS Troubleshooting">NFS Troubleshooting</a>.</i>
</p>
<h2>
<span id="V.C3.A9ase_tambi.C3.A9n"></span><span class="mw-headline" id="Véase_también">Véase también</span>
</h2>
<ul>
<li>Véase también <a href="../en/Avahi.html" title="Avahi">Avahi</a>, una implementación  de Zeroconf que permite la detección automática de recursos compartidos NFS.</li>
<li>HOWTO: <a href="../en/Diskless_system.html" class="mw-redirect" title="Diskless network boot NFS root">Diskless network boot NFS root</a>
</li>
<li><a rel="nofollow" class="external text" href="http://publib.boulder.ibm.com/infocenter/pseries/v5r3/index.jsp?topic=/com.ibm.aix.prftungd/doc/prftungd/nfs_perf.htm">Very helpful</a></li>
<li>Si va a configurar el servidor NFS con Arch Linux para ser usado por clientes con Windows mediante el SFU de Microsoft, sería aconsejable mirar <a rel="nofollow" class="external text" href="https://web.archive.org/web/20100707013552/https://bbs.archlinux.org/viewtopic.php?pid=523934#p523934">este mensaje del foro</a> primero.</li>
<li><a rel="nofollow" class="external text" href="https://docs.microsoft.com/en-us/archive/blogs/msdn/sfu/all-well-almost-about-client-for-nfs-configuration-and-performance">Microsoft Services for Unix NFS Client info</a></li>
<li>
<a rel="nofollow" class="external text" href="https://web.archive.org/web/20151105224148/http://blogs.msdn.com/b/sfu/archive/2007/05/01/unix-interoperability-and-windows-vista.aspx">Unix interoperability and Windows Vista</a> Requisitos previos para conectarse a NFS con Windows Vista.</li>
</ul>
</div>
</div>
<div id="catlinks" class="catlinks" data-mw="interface">
<div id="mw-normal-catlinks" class="mw-normal-catlinks">
<a href="../Special:Categories.html" title="Special:Categories">Categories</a>: <ul>
<li><a href="../es/Category:File_systems.html" title="Category:File systems (Español)">File systems (Español)</a></li>
<li><a href="../es/Category:Network_sharing.html" title="Category:Network sharing (Español)">Network sharing (Español)</a></li>
<li><a href="../es/Category:Servers.html" title="Category:Servers (Español)">Servers (Español)</a></li>
</ul>
</div>
<div id="mw-hidden-catlinks" class="mw-hidden-catlinks mw-hidden-cats-hidden">Hidden category: <ul><li><a href="../en/Category:Pages_or_sections_flagged_with_Template:Out_of_date.html" title="Category:Pages or sections flagged with Template:Out of date">Pages or sections flagged with Template:Out of date</a></li></ul>
</div>
</div>
	</div>
</div>

<footer id="footer" class="mw-footer" role="contentinfo" style="margin: 0">
	<ul id="footer-info">
		<li>Retrieved from "<a dir="ltr" href="https://wiki.archlinux.org/index.php?title=NFS_(Espa%C3%B1ol)&amp;oldid=663646">https://wiki.archlinux.org/index.php?title=NFS_(Español)&amp;oldid=663646</a>"</li>
		<li id="footer-info-lastmod"> This page was last edited on 22 April 2021, at 17:19.</li>
		<li id="footer-info-copyright">Content is available under <a class="external" rel="nofollow" href="http://www.gnu.org/copyleft/fdl.html">GNU Free Documentation License 1.3 or later</a> unless otherwise noted.</li>
	<br>
</ul>
	<ul id="footer-places">
		<li id="footer-places-privacy"><a href="../en/ArchWiki:Privacy_policy.html" title="ArchWiki:Privacy policy">Privacy policy</a></li>
		<li id="footer-places-about"><a href="../en/ArchWiki:About.html" title="ArchWiki:About">About ArchWiki</a></li>
		<li id="footer-places-disclaimer"><a href="../en/ArchWiki:General_disclaimer.html" title="ArchWiki:General disclaimer">Disclaimers</a></li>
	</ul>
	<ul id="footer-icons" class="noprint">
		<li id="footer-copyrightico">
	</ul>
	<div style="clear: both;"></div>
</footer>



</body>
</html>
