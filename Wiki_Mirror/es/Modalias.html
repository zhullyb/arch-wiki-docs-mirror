<!DOCTYPE html>
<html class="client-nojs" lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<title>Modalias (Español) - ArchWiki</title>
<link rel="stylesheet" href="../ArchWikiOffline.css">
<meta name="ResourceLoaderDynamicStyles" content="">
<meta name="generator" content="MediaWiki 1.35.0">
<meta name="robots" content="noindex,follow">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="shortcut icon" href="/favicon.ico">
<link rel="search" type="application/opensearchdescription+xml" href="/opensearch_desc.php" title="ArchWiki (en)">
<link rel="EditURI" type="application/rsd+xml" href="https://wiki.archlinux.org/api.php?action=rsd">
<link rel="license" href="http://www.gnu.org/copyleft/fdl.html">
<link rel="alternate" type="application/atom+xml" title="ArchWiki Atom feed" href="/index.php?title=Special:RecentChanges&amp;feed=atom">
</head>
<body class="mediawiki ltr sitedir-ltr mw-hide-empty-elt ns-0 ns-subject page-Modalias_Español rootpage-Modalias_Español skin-vector action-view skin-vector-legacy">
<div id="content" class="mw-body" role="main" style="margin: 0">
	<a id="top"></a>
	<div id="siteNotice" class="mw-body-content"></div>
	<div class="mw-indicators mw-body-content">
	</div>
	<h1 id="firstHeading" class="firstHeading" lang="en">Modalias (Español)</h1>
	<div id="bodyContent" class="mw-body-content">
		<div id="siteSub" class="noprint">From ArchWiki</div>
		<div id="contentSub"></div>
		<div id="contentSub2"></div>
		
		<div id="jump-to-nav"></div>
		<a class="mw-jump-link" href="#mw-head">Jump to navigation</a>
		<a class="mw-jump-link" href="#searchInput">Jump to search</a>
		<div id="mw-content-text" lang="en" dir="ltr" class="mw-content-ltr">
<div class="warningbox">The printable version is no longer supported and may have rendering errors. Please update your browser bookmarks and please use the default browser print function instead.</div>
<div class="mw-parser-output">
<div class="noprint archwiki-template-message">
<p><a href="../File:Tango-preferences-desktop-locale-modified.png" class="image"><img alt="Tango-preferences-desktop-locale-modified.png" src="../File:Tango-preferences-desktop-locale-modified.png" decoding="async" width="48" height="48"></a><b>La <a href="../es/ArchWiki:Contributing.html#Tareas_avanzadas" title="ArchWiki:Contributing (Español)">traducción</a> de este artículo o sección no refleja el texto original.</b><a href="../File:Tango-preferences-desktop-locale-modified.png" class="image"><img alt="Tango-preferences-desktop-locale-modified.png" src="../File:Tango-preferences-desktop-locale-modified.png" decoding="async" width="48" height="48"></a></p>
<div>
<b>Motivos:</b> Desactualizado. (Discusión en <a rel="nofollow" class="external text" href="https://wiki.archlinux.org/index.php/Talk:Modalias_(Espa%C3%B1ol)">Talk:Modalias (Español)#</a>)</div>
</div>
<div id="toc" class="toc" role="navigation" aria-labelledby="mw-toc-heading">
<input type="checkbox" role="button" id="toctogglecheckbox" class="toctogglecheckbox" style="display:none"><div class="toctitle" lang="en" dir="ltr">
<h2 id="mw-toc-heading">Contents</h2>
<span class="toctogglespan"><label class="toctogglelabel" for="toctogglecheckbox"></label></span>
</div>
<ul>
<li class="toclevel-1 tocsection-1">
<a href="#Introducci%C3%B3n_a_Modalias"><span class="tocnumber">1</span> <span class="toctext">Introducción a Modalias</span></a>
<ul>
<li class="toclevel-2 tocsection-2"><a href="#%C2%BFQu%C3%A9_es_ese_'modalias'_del_que_habla?"><span class="tocnumber">1.1</span> <span class="toctext">¿Qué es ese 'modalias' del que habla?</span></a></li>
<li class="toclevel-2 tocsection-3"><a href="#%C2%BFQu%C3%A9_es_un_archivo_modalias?"><span class="tocnumber">1.2</span> <span class="toctext">¿Qué es un archivo modalias?</span></a></li>
<li class="toclevel-2 tocsection-4"><a href="#%C2%BFC%C3%B3mo_se_usa_esta_informaci%C3%B3n?"><span class="tocnumber">1.3</span> <span class="toctext">¿Cómo se usa esta información?</span></a></li>
<li class="toclevel-2 tocsection-5"><a href="#%C2%BFDe_d%C3%B3nde_viene_este_archivo_modules.alias?"><span class="tocnumber">1.4</span> <span class="toctext">¿De dónde viene este archivo modules.alias?</span></a></li>
<li class="toclevel-2 tocsection-6"><a href="#%C2%BFC%C3%B3mo_funciona_hwdetect?"><span class="tocnumber">1.5</span> <span class="toctext">¿Cómo funciona hwdetect?</span></a></li>
<li class="toclevel-2 tocsection-7"><a href="#%C2%BFC%C3%B3mo_funciona_udev?"><span class="tocnumber">1.6</span> <span class="toctext">¿Cómo funciona udev?</span></a></li>
<li class="toclevel-2 tocsection-8"><a href="#Vea_tambi%C3%A9n"><span class="tocnumber">1.7</span> <span class="toctext">Vea también</span></a></li>
</ul>
</li>
</ul>
</div>

<h1>
<span id="Introducci.C3.B3n_a_Modalias"></span><span class="mw-headline" id="Introducción_a_Modalias">Introducción a Modalias</span>
</h1>
<p>Este documento servirá como introducción acerca de cómo el núcleo Linux y sus módulos detectan y reconocen el hardware, y de cómo se traduce esto a un archivo virtual de sysfs llamado 'modalias'
</p>
<h2>
<span id=".C2.BFQu.C3.A9_es_ese_.27modalias.27_del_que_habla.3F"></span><span class="mw-headline" id="¿Qué_es_ese_'modalias'_del_que_habla?">¿Qué es ese 'modalias' del que habla?</span>
</h2>
<p>Modalias es un pequeño truco por parte de sysfs para exportar información acerca del hardware a un archivo llamado 'modalias'. Este archivo contiene simplemente la información que presenta el hardware normal con un determinado formato. Echemos un vistazo antes de continuar a este ejemplo:
</p>
<pre>$ cat /sys/devices/pci0000:00/0000:00:1f.1/modalias
     pci:v00008086d000024DBsv0000103Csd0000006Abc01sc01i8A
</pre>
<p>No se preocupe, todo se aclarará pronto.
</p>
<h2>
<span id=".C2.BFQu.C3.A9_es_un_archivo_modalias.3F"></span><span class="mw-headline" id="¿Qué_es_un_archivo_modalias?">¿Qué es un archivo modalias?</span>
</h2>
<p>Como se describió antes, un archivo modalias simplemente expone la información que un determinado elemento de hardware le comunica al núcleo. Este archivo especifica una estructura para mostrar dicha información. Volvamos al ejemplo anterior:
</p>
<pre>$ cat /sys/devices/pci0000:00/0000:00:1f.1/modalias
  pci:v00008086d000024DBsv0000103Csd0000006Abc01sc01i8A
</pre>
<p>¿Qué diablos es esto? ¿Qué significa? Analicémoslo por partes. Primero, el nombre del archivo.
</p>
<pre>/sys/devices/pci0000:00/0000:00:1f.1/modalias
</pre>
<ul>
<li>
<b>pci0000:00</b> es la id para el primer bus PCI. En la mayoría de los casos será el único bus PCI que tenga, pero es posible que se pueda extender a <b>pci0000:01</b> o <b>pci0000:02</b> - los datos exactos no son importantes, ya que es una apuesta bastante segura lo de que sólo tenga un bus PCI (<i>PISTA:</i> ejecute ls /sys/devices/pci* para comprobarlo)</li>
<li>
<b>0000:00:1f.1</b> es el índice del dispositivo dado en el bus PCI. Específicamente, se trata del bus 0000:00 y tiene un índice <b>1f.1</b>
</li>
<li>Todo esto es muy poco importante, a menos que quiera saber de donde vienen todos esos números. Por completar, si analiza la salida de <i>lspci</i> verá la misma información:</li>
</ul>
<pre>$ lspci
  00:1f.1 IDE interface: Intel Corp.: Unknown device 24db (rev 02)
</pre>
<p>Ahora, echemos una mirada al contenido del archivo modalias para el dispositivo 00:1f.1:
</p>
<pre>pci:v00008086d000024DBsv0000103Csd0000006Abc01sc01i8A
</pre>
<p>Bien, ¡podemos ver pci! Recocemos eso, pero qué es todo ese galimatías del final?
Ese galimatías son en realidad datos estructurados. Reconocerá un esquema repetitivo letra/número. Troceemos los datos para que sean más fáciles de leer:
</p>
<pre>v  00008086
d  000024DB
sv 0000103C
sd 0000006A
bc 01
sc 01
i  8A
</pre>
<p>Cada uno de estos identificadores, y sus correspondientes números hexadecimales representan parte de la información que un dispositivo dado expone. Para empezar, <b>v</b> es la <i>id del fabricante</i> y <b>d</b> es la <i>id del dispositivo</i> - estos son números muy estandarizados, y son esos mismos números los que utilizan <b>hwd</b> y otras herramientas similares para consultar un dispositivo. Incluso puede encontrar sitios web para hacer consultas sobre hardware específico basadas en las id del fabricante y del dispositivo, por ejemplo <a rel="nofollow" class="external free" href="http://www.pcidatabase.com/">http://www.pcidatabase.com/</a><sup>[<a href="https://en.wikipedia.org/wiki/Wikipedia:Link_rot" class="extiw" title="wikipedia:Wikipedia:Link rot">enlace roto</a> 2020-08-04]</sup>
</p>
<p>También se pueden ver estos números aquí:
</p>
<pre>$ lspci -n
  00:1f.1 Class 0101: 8086:24db (rev 02)
</pre>
<p>¿Ve cómo 8086:24db coincide con los <i>v</i> y <i>d</i> anteriores?
</p>
<p>Para más exactitud, <b>sv</b> y <b>sd</b> son las versiones de "subsistema" de tanto el fabricante como del dispositivo. La mayor parte de las veces estos son ignorados. Se utilizan principalmente por los desarrolladores de hardware para distinguir pequeñas diferencias en el funcionamiento interno que no suponen cambios en el dispositivo entendido como un todo.
</p>
<p><b>bc</b> (clase base) y <b>sc</b> (sub clase) se utilizan para crear la "Class" listada por lspci, y ordenados "bcsc". Se trata de la clase de dispositivo, que es bastante genérica. En este caso, la "clase" es consultada en la salida normal de lspci. Podemos ver que "Class 0101" se corresponde con "Interfaz IDE" (lspci también consulta los id del fabricante y del dispositivo - 8086 se corresponde con "Intel Corp." y 24DB con 'Dispositivo desconocido ("Unknown Device").
</p>
<p><b>i</b> es el "Interfaz de programación", y solamente tienen sentido para un reducido número de clases de dispositivos.
</p>
<h2>
<span id=".C2.BFC.C3.B3mo_se_usa_esta_informaci.C3.B3n.3F"></span><span class="mw-headline" id="¿Cómo_se_usa_esta_información?">¿Cómo se usa esta información?</span>
</h2>
<p>Bien, ahora sabemos qué es toda esta información. Un puñado de números intrigantes que expone cada dispositivo. Todo correcto. ¿Pero qué importancia tiene esto cuando hablamos de módulos?
</p>
<p>Una cosa que la gente tiende a dejar de lado, es todo el trabajo que hace <b>depmod</b>. Cuando ejecuta depmod, éste construye una serie de archivos de "mapeado" en /lib/modules/`uname -r` que le dicen a modprobe cómo manejar ciertas cosas que tiene que hacer. En este caso podemos ignorar casi todas ellas. La importante es <b>modules.alias</b>. Este archivo contiene alias, o nombres secundarios para los módulos. Como muestra, veamos los alias de por ejemplo, snd_intel8x0m:
</p>
<pre>$ grep snd_intel8x0m /lib/modules/`uname -r`/modules.alias
  alias pci:v00008086d00002416sv*sd*bc*sc*i* snd_intel8x0m
  alias pci:v00008086d00002426sv*sd*bc*sc*i* snd_intel8x0m
  alias pci:v00008086d00002446sv*sd*bc*sc*i* snd_intel8x0m
  alias pci:v00008086d00002486sv*sd*bc*sc*i* snd_intel8x0m
  alias pci:v00008086d000024C6sv*sd*bc*sc*i* snd_intel8x0m
  alias pci:v00008086d000024D6sv*sd*bc*sc*i* snd_intel8x0m
  alias pci:v00008086d0000266Dsv*sd*bc*sc*i* snd_intel8x0m
  alias pci:v00008086d000027DDsv*sd*bc*sc*i* snd_intel8x0m
  alias pci:v00008086d00007196sv*sd*bc*sc*i* snd_intel8x0m
  alias pci:v00001022d00007446sv*sd*bc*sc*i* snd_intel8x0m
  alias pci:v00001039d00007013sv*sd*bc*sc*i* snd_intel8x0m
  alias pci:v000010DEd000001C1sv*sd*bc*sc*i* snd_intel8x0m
  alias pci:v000010DEd00000069sv*sd*bc*sc*i* snd_intel8x0m
  alias pci:v000010DEd00000089sv*sd*bc*sc*i* snd_intel8x0m
  alias pci:v000010DEd000000D9sv*sd*bc*sc*i* snd_intel8x0m
</pre>
<p>¡Hey, un momento! ¡Sabemos qué es eso! ¡Es la información sobre las id del fabricante/dispositivo de antes!
</p>
<p>Sí, así es. Es un formato bastante sencillo "alias &lt;algo&gt; &lt;modulo real&gt;". De hecho, puede crear alias para todo lo que quiera. Se puede añadir "alias boogabooga snd_intel8x0m" y hacer después "modprobe boogabooga" con seguridad.
</p>
<p>El "*" indica que coincidirá con cualquier cosa, de forma muy parecida a la expansión de nombres de archivo (<i>ls somedir/*</i>). Como se dijo antes, la mayor parte de los alias ignoran sv, sd, bc, sc, e i usando la coincidencia con "*".
</p>
<h2>
<span id=".C2.BFDe_d.C3.B3nde_viene_este_archivo_modules.alias.3F"></span><span class="mw-headline" id="¿De_dónde_viene_este_archivo_modules.alias?">¿De dónde viene este archivo modules.alias?</span>
</h2>
<p>Vale, ahora puede estar pensando "Bien, hwd consulta las cosas basándose en una tabla de dispositivos, ¿qué hace diferente a esto?"
</p>
<p>La diferencia estriba en que esta tabla de consulta no es estática. No se mantiene a mano. De hecho, se construye dinámicamente cuando ejecuta depmod. "De dónde viene esta información?", preguntará?  Pues desde los <b>propios módulos</b>.  Si lo piensa, cada módulo específico debería saber cuál es el hardware que conoce, ya que ha sido programado específicamente para dicho hardware. Esto es, los desarrolladores del módulo <i>nvidia</i> saben que su módulo sólo funciona para las tarjetas gráficas ("clase") de Nvidia ("fabricante"). De hecho, exporta en realidad esta información. Dice "Hey, yo puedo trabajar con esto:".
</p>
<pre>$ modinfo nvidia
  filename:       /lib/modules/2.6.14-ARCH/kernel/drivers/video/nvidia.ko
  license:        NVIDIA
  alias:          char-major-195-*
  vermagic:       2.6.14-ARCH SMP preempt 686 gcc-4.1
  depends:        agpgart
  alias:          pci:v000010DEd*sv*sd*bc03sc00i00*
</pre>
<p>Como puede ver por los alias listados, busca específicamente por el fabricante "10DE" (Nvidia) y bc/sc 0300 (que lo más probable es que sea 'graphics cards'). De hecho, si consulta el modinfo de <b>snd_intel8x0m</b>:
</p>
<pre>$ modinfo snd_intel8x0m
  filename:       /lib/modules/2.6.14-ARCH/kernel/sound/pci/snd-intel8x0m.ko
  author:         Jaroslav Kysela &lt;perex@suse.cz&gt;
  description:    Intel 82801AA,82901AB,i810,i820,i830,i840,i845,MX440; SiS 7013; NVidia MCP/2/2S/3 modems
  license:        GPL
  vermagic:       2.6.14-ARCH SMP preempt 686 gcc-4.1
  depends:        snd-ac97-codec,snd-pcm,snd-page-alloc,snd
  alias:          pci:v00008086d00002416sv*sd*bc*sc*i*
  alias:          pci:v00008086d00002426sv*sd*bc*sc*i*
  alias:          pci:v00008086d00002446sv*sd*bc*sc*i*
  alias:          pci:v00008086d00002486sv*sd*bc*sc*i*
  alias:          pci:v00008086d000024C6sv*sd*bc*sc*i*
  alias:          pci:v00008086d000024D6sv*sd*bc*sc*i*
  alias:          pci:v00008086d0000266Dsv*sd*bc*sc*i*
  alias:          pci:v00008086d000027DDsv*sd*bc*sc*i*
  alias:          pci:v00008086d00007196sv*sd*bc*sc*i*
  alias:          pci:v00001022d00007446sv*sd*bc*sc*i*
  alias:          pci:v00001039d00007013sv*sd*bc*sc*i*
  alias:          pci:v000010DEd000001C1sv*sd*bc*sc*i*
  alias:          pci:v000010DEd00000069sv*sd*bc*sc*i*
  alias:          pci:v000010DEd00000089sv*sd*bc*sc*i*
  alias:          pci:v000010DEd000000D9sv*sd*bc*sc*i*
</pre>
<p>Muestra los alias encontrados anteriormente mediante grep en el archivo de alias. Estos alias exportados por cada módulo, son recogidos por depmod y mezclados dinámicamente en el archivo modules.alias. No hay cambios manuales en una tabla de consulta, si no que se construye al vuelo. Cada módulo sabe con exactitud con qué puede trabajar, y en consecuencia depmod puede utilizar esa información para ayudar en la carga de módulos.
</p>
<h2>
<span id=".C2.BFC.C3.B3mo_funciona_hwdetect.3F"></span><span class="mw-headline" id="¿Cómo_funciona_hwdetect?">¿Cómo funciona hwdetect?</span>
</h2>
<p>hwdetect es la herramienta específica de Arch que carga módulos en base a estos modalias. Todo lo que hacer es volcar estos modalias en el sistema, y ejecutar "modprobe --show-depends &lt;alias&gt;" para cada uno de ellos. Esto construye una lista con todos los módulos con los que puede trabajar su hardware. Es así de simple. Por supuesto, hay correcciones hechas para ciertas cositas que no son detectadas correctamente.
</p>
<p>En esencia, se hace lo siguiente:
</p>
<pre>modprobe -a $(find /sys/devices -name modalias -exec cat {} +)
</pre>
<p>Por supuesto, esto no es *exacto*, ya que hwdetect carga también dispositivos pnp y módulos de disco, que no son exportados mediante modalias. No obstante, la configuración de modalias hace que todo esto sea sencillo y directo.
</p>
<h2>
<span id=".C2.BFC.C3.B3mo_funciona_udev.3F"></span><span class="mw-headline" id="¿Cómo_funciona_udev?">¿Cómo funciona udev?</span>
</h2>
<p>Ahora, puede estar usted pensando, "Eso tiene sentido, encuentras simplemente todos los modalias del sistema y los cargas, pero ¿cómo funciona esto cuando insertas un nuevo dispositivo? ¿Tengo que recorrer todo el sistema de nuevo?"
</p>
<p>No.  udev está estrechamente ligado a sysfs (el sistema de ficheros que expone los modalias en primer lugar). De hecho, cargar módulos basándose en los modalias cuando se inserta un nuevo dispositivo (o cuando udev se inicia por primera vez en el arranque), es extremadamente sencillo:
</p>
<pre>DRIVER!="?*", ENV{MODALIAS}=="?*", RUN{builtin}="kmod load $env{MODALIAS}"
</pre>
<p>Sí, eso es todo. Es una sola línea. Esta sencilla línea, que forma parte de las reglas udev por defecto que reemplazan a hotplug. Sorprendente, ¿no es verdad?
</p>
<h2>
<span id="Vea_tambi.C3.A9n"></span><span class="mw-headline" id="Vea_también">Vea también</span>
</h2>
<p>Este artículo muestra otras plantillas modalias, por ejemplo para usb, dmi y subtipos acpy (en Inglés)
</p>
<ul><li>
<a rel="nofollow" class="external text" href="http://people.skolelinux.org/pere/blog/Modalias_strings___a_practical_way_to_map__stuff__to_hardware.html">Modalias strings - a practical way to map "stuff" to hardware</a> por Petter Reinholdtsen</li></ul>
</div>
</div>
<div id="catlinks" class="catlinks" data-mw="interface">
<div id="mw-normal-catlinks" class="mw-normal-catlinks">
<a href="../Special:Categories.html" title="Special:Categories">Category</a>: <ul><li><a href="../es/Category:Kernel.html" title="Category:Kernel (Español)">Kernel (Español)</a></li></ul>
</div>
<div id="mw-hidden-catlinks" class="mw-hidden-catlinks mw-hidden-cats-hidden">Hidden categories: <ul>
<li><a href="../es/Category:Pages_or_sections_flagged_with_Template:Bad_translation.html" title="Category:Pages or sections flagged with Template:Bad translation (Español)">Pages or sections flagged with Template:Bad translation (Español)</a></li>
<li><a href="../en/Category:Pages_with_dead_links.html" title="Category:Pages with dead links">Pages with dead links</a></li>
</ul>
</div>
</div>
	</div>
</div>

<footer id="footer" class="mw-footer" role="contentinfo" style="margin: 0">
	<ul id="footer-info">
		<li>Retrieved from "<a dir="ltr" href="https://wiki.archlinux.org/index.php?title=Modalias_(Espa%C3%B1ol)&amp;oldid=644890">https://wiki.archlinux.org/index.php?title=Modalias_(Español)&amp;oldid=644890</a>"</li>
		<li id="footer-info-lastmod"> This page was last edited on 12 December 2020, at 22:15.</li>
		<li id="footer-info-copyright">Content is available under <a class="external" rel="nofollow" href="http://www.gnu.org/copyleft/fdl.html">GNU Free Documentation License 1.3 or later</a> unless otherwise noted.</li>
	<br>
</ul>
	<ul id="footer-places">
		<li id="footer-places-privacy"><a href="../en/ArchWiki:Privacy_policy.html" title="ArchWiki:Privacy policy">Privacy policy</a></li>
		<li id="footer-places-about"><a href="../en/ArchWiki:About.html" title="ArchWiki:About">About ArchWiki</a></li>
		<li id="footer-places-disclaimer"><a href="../en/ArchWiki:General_disclaimer.html" title="ArchWiki:General disclaimer">Disclaimers</a></li>
	</ul>
	<ul id="footer-icons" class="noprint">
		<li id="footer-copyrightico">
	</ul>
	<div style="clear: both;"></div>
</footer>



</body>
</html>
