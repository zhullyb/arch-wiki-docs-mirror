<!DOCTYPE html>
<html class="client-nojs" lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<title>Apache HTTP Server (Español) - ArchWiki</title>
<link rel="stylesheet" href="../ArchWikiOffline.css">
<meta name="ResourceLoaderDynamicStyles" content="">
<meta name="generator" content="MediaWiki 1.35.0">
<meta name="robots" content="noindex,follow">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="shortcut icon" href="/favicon.ico">
<link rel="search" type="application/opensearchdescription+xml" href="/opensearch_desc.php" title="ArchWiki (en)">
<link rel="EditURI" type="application/rsd+xml" href="https://wiki.archlinux.org/api.php?action=rsd">
<link rel="license" href="http://www.gnu.org/copyleft/fdl.html">
<link rel="alternate" type="application/atom+xml" title="ArchWiki Atom feed" href="/index.php?title=Special:RecentChanges&amp;feed=atom">
</head>
<body class="mediawiki ltr sitedir-ltr mw-hide-empty-elt ns-0 ns-subject page-Apache_HTTP_Server_Español rootpage-Apache_HTTP_Server_Español skin-vector action-view skin-vector-legacy">
<div id="content" class="mw-body" role="main" style="margin: 0">
	<a id="top"></a>
	<div id="siteNotice" class="mw-body-content"></div>
	<div class="mw-indicators mw-body-content">
	</div>
	<h1 id="firstHeading" class="firstHeading" lang="en">Apache HTTP Server (Español)</h1>
	<div id="bodyContent" class="mw-body-content">
		<div id="siteSub" class="noprint">From ArchWiki</div>
		<div id="contentSub"></div>
		<div id="contentSub2"></div>
		
		<div id="jump-to-nav"></div>
		<a class="mw-jump-link" href="#mw-head">Jump to navigation</a>
		<a class="mw-jump-link" href="#searchInput">Jump to search</a>
		<div id="mw-content-text" lang="en" dir="ltr" class="mw-content-ltr">
<div class="warningbox">The printable version is no longer supported and may have rendering errors. Please update your browser bookmarks and please use the default browser print function instead.</div>
<div class="mw-parser-output">
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Estado de la traducción:</strong> este artículo es una traducción de <a href="../en/Apache_HTTP_Server.html" title="Apache HTTP Server">Apache HTTP Server</a> revisada por última vez el <b>2020-12-02</b>. Si advierte que la versión inglesa <a rel="nofollow" class="external text" href="https://wiki.archlinux.org/index.php?title=Apache_HTTP_Server&amp;diff=0&amp;oldid=641001">ha cambiado</a> puede actualizar la traducción <a href="../es/ArchWiki:f6ecee2fb17812f6654b3a6ff807d392.html" class="mw-redirect" title="ArchWiki:Translation Team/Contributing (Español)">usted mismo</a> o avisar al <a href="../es/ArchWiki:Translation_Team.html" title="ArchWiki:Translation Team (Español)">equipo de traducción</a>.</div>
<div class="archwiki-template-meta-related-articles-start">
<p>Related articles</p>
<ul>
<li><a href="../es/XAMPP.html" title="XAMPP (Español)">XAMPP (Español)</a></li>
<li><a href="../es/ab852a3e42547dbd93cf8f6ef0028cdf.html" title="Apache HTTP Server (Español)/mod perl (Español)">/mod_perl (Español)</a></li>
<li><a href="../es/71a81589b144b06568aa6b1f6c538a56.html" title="Apache HTTP Server (Español)/mod fcgid (Español)">/mod_fcgid (Español)</a></li>
<li><a href="../es/90a81dc10c3fbe1a94078c678b06b4ef.html" title="Apache HTTP Server (Español)/mod gnutls (Español)">/mod_gnutls (Español)</a></li>
<li><a href="../es/449884c3cfea9eaa0816b0e2ed6d4248.html" title="Apache HTTP Server (Español)/mod python (Español)">/mod_python (Español)</a></li>
<li><a href="../es/8d0f5daff2206cbeb67999a4965be64b.html" title="Apache HTTP Server (Español)/mod wsgi (Español)">/mod_wsgi (Español)</a></li>
</ul>
</div>
<p>El <a rel="nofollow" class="external text" href="https://es.wikipedia.org/wiki/Servidor_HTTP_Apache">Servidor HTTP Apache</a> o solamente Apache, es un servidor web muy popular, desarrollado por la Apache Software Foundation.
</p>
<p>Este articulo describe como configurar Apache y como integrarlo opcionalmente con <a href="../es/PHP.html" title="PHP (Español)">PHP</a>.
</p>
<div id="toc" class="toc" role="navigation" aria-labelledby="mw-toc-heading">
<input type="checkbox" role="button" id="toctogglecheckbox" class="toctogglecheckbox" style="display:none"><div class="toctitle" lang="en" dir="ltr">
<h2 id="mw-toc-heading">Contents</h2>
<span class="toctogglespan"><label class="toctogglelabel" for="toctogglecheckbox"></label></span>
</div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Instalaci%C3%B3n"><span class="tocnumber">1</span> <span class="toctext">Instalación</span></a></li>
<li class="toclevel-1 tocsection-2">
<a href="#Configuraci%C3%B3n"><span class="tocnumber">2</span> <span class="toctext">Configuración</span></a>
<ul>
<li class="toclevel-2 tocsection-3"><a href="#Opciones_avanzadas"><span class="tocnumber">2.1</span> <span class="toctext">Opciones avanzadas</span></a></li>
<li class="toclevel-2 tocsection-4"><a href="#Directorios_de_usuario"><span class="tocnumber">2.2</span> <span class="toctext">Directorios de usuario</span></a></li>
<li class="toclevel-2 tocsection-5"><a href="#TSL"><span class="tocnumber">2.3</span> <span class="toctext">TSL</span></a></li>
<li class="toclevel-2 tocsection-6">
<a href="#Hosts_virtuales"><span class="tocnumber">2.4</span> <span class="toctext">Hosts virtuales</span></a>
<ul>
<li class="toclevel-3 tocsection-7"><a href="#Administrar_varios_hosts_virtuales"><span class="tocnumber">2.4.1</span> <span class="toctext">Administrar varios hosts virtuales</span></a></li>
</ul>
</li>
</ul>
</li>
<li class="toclevel-1 tocsection-8">
<a href="#Extensiones"><span class="tocnumber">3</span> <span class="toctext">Extensiones</span></a>
<ul>
<li class="toclevel-2 tocsection-9">
<a href="#PHP"><span class="tocnumber">3.1</span> <span class="toctext">PHP</span></a>
<ul>
<li class="toclevel-3 tocsection-10"><a href="#Usando_libphp"><span class="tocnumber">3.1.1</span> <span class="toctext">Usando libphp</span></a></li>
<li class="toclevel-3 tocsection-11"><a href="#Utilizando_apache2-mpm-worker_y_mod_fcgid"><span class="tocnumber">3.1.2</span> <span class="toctext">Utilizando apache2-mpm-worker y mod_fcgid</span></a></li>
<li class="toclevel-3 tocsection-12"><a href="#Utilizando_php-fpm_y_mod_proxy_fcgi"><span class="tocnumber">3.1.3</span> <span class="toctext">Utilizando php-fpm y mod_proxy_fcgi</span></a></li>
<li class="toclevel-3 tocsection-13"><a href="#Pruebe_si_PHP_funciona"><span class="tocnumber">3.1.4</span> <span class="toctext">Pruebe si PHP funciona</span></a></li>
</ul>
</li>
<li class="toclevel-2 tocsection-14"><a href="#HTTP2"><span class="tocnumber">3.2</span> <span class="toctext">HTTP2</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-15">
<a href="#Soluci%C3%B3n_de_problemas"><span class="tocnumber">4</span> <span class="toctext">Solución de problemas</span></a>
<ul>
<li class="toclevel-2 tocsection-16"><a href="#Estado_de_Apache_y_registros"><span class="tocnumber">4.1</span> <span class="toctext">Estado de Apache y registros</span></a></li>
<li class="toclevel-2 tocsection-17"><a href="#Error:PID_file_/run/httpd/httpd.pid_not_readable_(yet?)_after_start"><span class="tocnumber">4.2</span> <span class="toctext">Error:PID file /run/httpd/httpd.pid not readable (yet?) after start</span></a></li>
<li class="toclevel-2 tocsection-18"><a href="#/run/httpd_no_es_creado_al_arrancar"><span class="tocnumber">4.3</span> <span class="toctext">/run/httpd no es creado al arrancar</span></a></li>
<li class="toclevel-2 tocsection-19"><a href="#Apache_is_running_a_threaded_MPM,_but_your_PHP_Module_is_not_compiled_to_be_threadsafe."><span class="tocnumber">4.4</span> <span class="toctext">Apache is running a threaded MPM, but your PHP Module is not compiled to be threadsafe.</span></a></li>
<li class="toclevel-2 tocsection-20"><a href="#AH00534:_httpd:_Configuration_error:_No_MPM_loaded."><span class="tocnumber">4.5</span> <span class="toctext">AH00534: httpd: Configuration error: No MPM loaded.</span></a></li>
<li class="toclevel-2 tocsection-21"><a href="#AH00072:_make_sock:_could_not_bind_to_address"><span class="tocnumber">4.6</span> <span class="toctext">AH00072: make_sock: could not bind to address</span></a></li>
<li class="toclevel-2 tocsection-22"><a href="#AH01071:_Got_error_'Primary_script_unknown"><span class="tocnumber">4.7</span> <span class="toctext">AH01071: Got error 'Primary script unknown</span></a></li>
<li class="toclevel-2 tocsection-23"><a href="#Cambiar_el_valor_de_max_execution_time_en_php.ini_no_tiene_efecto"><span class="tocnumber">4.8</span> <span class="toctext">Cambiar el valor de max_execution_time en php.ini no tiene efecto</span></a></li>
<li class="toclevel-2 tocsection-24"><a href="#PHP-FPM:_los_errores_de_cada_host_virtual_no_son_registrados_por_separado"><span class="tocnumber">4.9</span> <span class="toctext">PHP-FPM: los errores de cada host virtual no son registrados por separado</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-25"><a href="#V%C3%A9ase_tambi%C3%A9n"><span class="tocnumber">5</span> <span class="toctext">Véase también</span></a></li>
</ul>
</div>

<h2>
<span id="Instalaci.C3.B3n"></span><span class="mw-headline" id="Instalación">Instalación</span>
</h2>
<p><a href="../es/Help:Reading.html#Instalaci%C3%B3n_de_paquetes" class="mw-redirect" title="Install (Español)">Instale</a> el paquete <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=apache">apache</a></span>.
</p>
<h2>
<span id="Configuraci.C3.B3n"></span><span class="mw-headline" id="Configuración">Configuración</span>
</h2>
<p>Los archivos de configuración de Apache están ubicados en <code>/etc/httpd/conf</code>. El archivo de configuración principal es <code>/etc/httpd/conf/httpd.conf</code>, el cual incluye varios otro archivos de configuración.
El archivo de configuración por defecto debiera servir para una configuración simple. Por defecto, servirá el directorio <code>/srv/http</code> a cualquiera que visite su pagina.
</p>
<p>Para iniciar Apache, inicie el <code>httpd.service</code> usando <a href="../es/Systemd.html#Utilizar_las_unidades" title="Systemd (Español)">systemd</a>.
</p>
<p>Ahora, Apache debería estar ejecutándose. Pruebelo visitando <a rel="nofollow" class="external free" href="http://localhost/">http://localhost/</a> en un navegador web. Debería mostrar una pagina simple de indice.
</p>
<p>Para una configuración opcional adicional, véase las siguientes secciones.
</p>
<h3><span class="mw-headline" id="Opciones_avanzadas">Opciones avanzadas</span></h3>
<p>Véase la <a rel="nofollow" class="external text" href="https://httpd.apache.org/docs/trunk/es/mod/directives.html">lista completa de directivas de configuración de Apache</a> y la <a rel="nofollow" class="external text" href="https://httpd.apache.org/docs/trunk/es/mod/quickreference.html">guía rápida de referencias de directivas</a>.
</p>
<p>Estas opciones en <code>/etc/httpd/conf/httpd.conf</code> pueden serle de interés:
</p>
<pre>User http
</pre>
<dl><dd>Por razones de seguridad, tan pronto como es iniciado Apache por el usuario <i>root</i> (directamente o por <i>scripts</i> de inicio) cambia a esta UID <i>(User ID, Identificación de usuario)</i>. El usuario por defecto es <i>http</i>, el cual es creado automáticamente durante la instalación.</dd></dl>
<pre>Listen 80
</pre>
<dl><dd>Este el el puerto en donde Apache va a escuchar. Para acceso desde el internet con un router, tendrá que redirigirlo al puerto.</dd></dl>
<dl><dd>Si quiere configurar Apache para desarrollo local, puede querer que sea solo accesible desde su computador. Cambie esta linea a <code>Listen 127.0.0.1:80</code>.</dd></dl>
<pre>ServerAdmin you@example.com
</pre>
<dl><dd>Este el es correo del administrador que puede ser encontrado, p.ej. en paginas de error.</dd></dl>
<pre>DocumentRoot "/srv/http"
</pre>
<dl><dd>Este es el directorio donde tiene que poner sus paginas web.</dd></dl>
<dl><dd>Cámbielo, si quiere, pero no olvide de cambiar también <code>&lt;Directory "/srv/http"&gt;</code> al valor de su <code>DocumentRoot</code>, o lo más probable que obtenga un <b>Error 403</b> (falta de privilegios) cuando intente acceder a la nueva raíz del documento. No olvide cambiar la linea <code>Require all denied</code> a <code>Require all granted</code>, si no, obtendrá un <b>Error 403</b>. Recuerde que el directorio <code>DocumentRoot</code> y sus carpetas padres deben permitir permisos de ejecución por otros (se puede establecer con <code>chmod o+x /path/to/DocumentRoot</code>), sino, obtendrá un <b>Error 403</b>.</dd></dl>
<pre>AllowOverride None
</pre>
<dl><dd>Esta directiva en las secciones <code>&lt;Directory&gt;</code> provoca que Apache ignore completamente los archivos <code>.htaccess</code>. Tome en cuenta que este es ahora el valor por defecto en Apache 2.4, así que tendrá que permitir explícitamente anulaciones si planea usar los archivos <code>.htaccess</code>. Si tiene la intención de usar <code>mod_rewrite</code> u otras configuraciones en los archivos <code>.htaccess</code>, puede permitir que directivas declaradas en ese archivo pueden anular la configuración del servidor. Para más información, refiérase a la <a rel="nofollow" class="external text" href="http://httpd.apache.org/docs/current/es/mod/core.html#allowoverride">documentación de Apache</a>.</dd></dl>
<div class="archwiki-template-box archwiki-template-box-tip">
<strong>Sugerencia:</strong> Si tiene problemas con su configuración, puede hacer que Apache la revise con: <code>apachectl configtest</code>.</div>
<p>Puede encontrar más opciones de configuración en <code>/etc/httpd/conf/extra/httpd-default.conf</code>:
</p>
<p>Para desactivar la firma del servidor:
</p>
<pre>ServerSignature Off
</pre>
<p>Para ocultar información como las versiones de Apache y PHP:
</p>
<pre>ServerTokens Prod
</pre>
<h3><span class="mw-headline" id="Directorios_de_usuario">Directorios de usuario</span></h3>
<p>Los directorios de usuario están disponibles por defecto a través de <a rel="nofollow" class="external free" href="http://localhost/~tunombredeusuario/">http://localhost/~tunombredeusuario/</a> y muestran los contenidos de <code>~/public_html</code> (esto puede ser cambiado en <code>/etc/httpd/conf/extra/httpd-userdir.conf</code>).
</p>
<p>Si no quiere que los directorios de usuario estén disponibles en la web, comente la siguiente linea en <code>/etc/httpd/conf/httpd.conf</code>:
</p>
<pre>Include conf/extra/httpd-userdir.conf
</pre>
<p>Debe asegurarse que los permisos en su directorio <i>home</i> estén correctamente establecidos para que Apache pueda accederlo. Su directorio <i>home</i> y <code>~/public_html</code> deben ser ejecutables para otros («el resto del mundo»):
</p>
<pre>$ chmod o+x ~
$ chmod o+x ~/public_html
$ chmod -R o+r ~/public_html
</pre>
<p>Reinicie <code>httpd.service</code> para aplicar los cambios. Véase también <a href="../en/Umask.html#Set_the_mask_value" title="Umask">Umask#Set the mask value</a>.
</p>
<h3><span class="mw-headline" id="TSL">TSL</span></h3>
<div class="archwiki-template-box archwiki-template-box-warning">
<strong>Advertencia:</strong> Si emplea <a rel="nofollow" class="external text" href="https://es.wikipedia.org/wiki/Seguridad_de_la_capa_de_transporte"><i>TLS</i></a>, asegúrese de seguir <a rel="nofollow" class="external text" href="https://weakdh.org/sysadmin.html">la guia de weakdh.org</a> para prevenir vulnerabilidades. Para más información véase <a href="../en/Transport_Layer_Security.html#Server-side_recommendations" class="mw-redirect" title="Server-side TLS">Server-side TLS</a>.</div>
<p>Primero <a href="../en/Transport_Layer_Security.html#Obtaining_a_certificate" class="mw-redirect" title="Obtain a certificate">obtenga un certificado</a>. Si posee un dominio publico, puede usar <a href="../en/Certbot.html" class="mw-redirect" title="Let's Encrypt">Let's Encrypt</a>.
</p>
<p>En <code>/etc/httpd/conf/httpd.conf</code>, saque las marcas de comentario en las siguientes tres lineas:
</p>
<pre>LoadModule ssl_module modules/mod_ssl.so
LoadModule socache_shmcb_module modules/mod_socache_shmcb.so
Include conf/extra/httpd-ssl.conf
</pre>
<p>Si esta usando <code>certbot --apache</code>, la siguiente linea tampoco debe comentarse:
</p>
<pre>LoadModule rewrite_module modules/mod_rewrite.so
</pre>
<p>Después de obtener una llave y un certificado, asegúrese que las lineas <code>SSLCertificateFile</code> y <code>SSLCertificateKeyFile</code> en <code>/etc/httpd/conf/extra/httpd-ssl.conf</code> apunten a la llave y el certificado. Si también es generada una cadena concatenada de certificados <i>CA</i>, añada el nombre del archivo a <code>SSLCertificateChainFile</code>.
</p>
<p>Finalmente, reinicie <code>httpd.service</code> para aplicar los cambios.
</p>
<div class="archwiki-template-box archwiki-template-box-tip">
<strong>Sugerencia:</strong> Mozilla tiene un útil <a href="https://wiki.mozilla.org/Security/Server_Side_TLS" class="extiw" title="mozillawiki:Security/Server Side TLS">SSL/TLS articulo</a> y una <a rel="nofollow" class="external text" href="https://mozilla.github.io/server-side-tls/ssl-config-generator/">herramienta automatizada</a> para ayudar a crear una configuración más segura.</div>
<h3><span class="mw-headline" id="Hosts_virtuales">Hosts virtuales</span></h3>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Nota:</strong> Tendrá que añadir una sección aparte de <code>&lt;VirtualHost *:443&gt;</code> para soporte de <i>Virtual Hosts</i> SSL.
Véase <a href="#Administrar_varios_hosts_virtuales">#Administrar varios hosts virtuales</a> para un archivo de ejemplo.</div>
<p>Si quiere tener más de un host, saque las marcas de comentario en la siguiente linea en <code>/etc/httpd/conf/httpd.conf</code>:
</p>
<pre>Include conf/extra/httpd-vhosts.conf
</pre>
<p>Establezca sus hosts virtuales en <code>/etc/httpd/conf/extra/httpd-vhosts.conf</code>. El archivo por defecto contiene un elaborado ejemplo que debería ayudarle al iniciar.
</p>
<p>Para probar los hosts virtuales en su maquina local, añada los nombres virtuales a su archivo <code>/etc/hosts</code>:
</p>
<pre>127.0.0.1 domainname1.dom
127.0.0.1 domainname2.dom
</pre>
<p>Reinicie <code>httpd.service</code> para aplicar los cambios.
</p>
<h4><span class="mw-headline" id="Administrar_varios_hosts_virtuales">Administrar varios hosts virtuales</span></h4>
<p>Si tiene una gran cantidad de hosts virtuales, puede querer activarlos y desactivarlos fácilmente. Es recomendado crear un archivo de configuración por host virtual y guardarlos en una sola carpeta, ej. <code>/etc/httpd/conf/vhosts</code>.
</p>
<p>Primero cree la carpeta:
</p>
<pre># mkdir /etc/httpd/conf/vhosts
</pre>
<p>Y guarde cada archivo de configuración en ella:
</p>
<pre># nano /etc/httpd/conf/vhosts/domainname1.dom
# nano /etc/httpd/conf/vhosts/domainname2.dom
...
</pre>
<p>En el ultimo paso, <code>Include</code> <i>(Incluya)</i> los archivos de configuración en su <code>/etc/httpd/conf/httpd.conf</code>:
</p>
<pre>#Vhosts permitidos:
Include conf/vhosts/domainname1.dom
Include conf/vhosts/domainname2.dom
</pre>
<p>Puede activar o desactivar cada host virtual comentándolo o no comentándolo.
</p>
<p>Un archivo <i>vhost</i> básico se parecerá a esto:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/httpd/conf/vhosts/domainname1.dom</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">&lt;VirtualHost *:80&gt;
    ServerAdmin webmaster@domainname1.dom
    DocumentRoot "/home/user/http/domainname1.dom"
    ServerName domainname1.dom
    ServerAlias domainname1.dom
    ErrorLog "/var/log/httpd/domainname1.dom-error_log"
    CustomLog "/var/log/httpd/domainname1.dom-access_log" common

    &lt;Directory "/home/user/http/domainname1.dom"&gt;
        Require all granted
    &lt;/Directory&gt;
&lt;/VirtualHost&gt;

&lt;VirtualHost *:443&gt;
    ServerAdmin webmaster@domainname1.dom
    DocumentRoot "/home/user/http/domainname1.dom"
    ServerName domainname1.dom:443
    ServerAlias domainname1.dom:443
    SSLEngine on
    SSLCertificateFile "/etc/httpd/conf/server.crt"
    SSLCertificateKeyFile "/etc/httpd/conf/server.key"
    ErrorLog "/var/log/httpd/domainname1.dom-error_log"
    CustomLog "/var/log/httpd/domainname1.dom-access_log" common

    &lt;Directory "/home/user/http/domainname1.dom"&gt;
        Require all granted
    &lt;/Directory&gt;
&lt;/VirtualHost&gt;</pre>
<h2><span class="mw-headline" id="Extensiones">Extensiones</span></h2>
<h3><span class="mw-headline" id="PHP">PHP</span></h3>
<p>Primero <a href="../en/PHP.html#Installation" title="PHP">instale PHP</a>, después, siga alguna de las tres subsecciones siguientes. Finalmente, pruebe la instalación como se describe en la subsección final.
</p>
<h4><span class="mw-headline" id="Usando_libphp">Usando libphp</span></h4>
<p>Este método es probablemente el más fácil, pero el menos escalable: es apropiado para una carga de solicitudes ligera. También requiere que cambie el modulo mpm, lo cual puede causar problemas con otras extensiones (ej. no es compatible con <a href="#HTTP2">#HTTP2</a>).
</p>
<p><a href="../es/Help:Reading.html#Instalaci%C3%B3n_de_paquetes" class="mw-redirect" title="Install (Español)">Instale</a> <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=php-apache">php-apache</a></span>.
</p>
<p>En <code>/etc/httpd/conf/httpd.conf</code> comente la linea:
</p>
<pre>#LoadModule mpm_event_module modules/mod_mpm_event.so
</pre>
<p>y no comente la linea:
</p>
<pre>LoadModule mpm_prefork_module modules/mod_mpm_prefork.so
</pre>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Nota:</strong> Lo anterior es necesario, porque <code>libphp7.so</code> que esta incluido con <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=php-apache">php-apache</a></span> no funciona con <code>mod_mpm_event</code>, pero solo va a funcionar con <code>mod_mpm_prefork</code>. (<a rel="nofollow" class="external text" href="https://bugs.archlinux.org/task/39218">FS#39218</a>)
<p>Si no, obtendrá el siguiente error:
</p>
<pre>Apache is running a threaded MPM, but your PHP Module is not compiled to be threadsafe.  You need to recompile PHP.
AH00013: Pre-configuration failed
httpd.service: control process exited, code=exited status=1</pre>
Como alternativa, puede usar <code>mod_proxy_fcgi</code> (Véase <a href="#Utilizando_php-fpm_y_mod_proxy_fcgi">#Utilizando php-fpm y mod_proxy_fcgi</a> más abajo).</div>
<p>Para habilitar PHP, añada estas lineas a <code>/etc/httpd/conf/httpd.conf</code>:
</p>
<ul><li>Ponga esto al final de la lista <code>LoadModule</code>:</li></ul>
<pre>LoadModule php7_module modules/libphp7.so
AddHandler php7-script .php
</pre>
<ul><li>Ponga esto al final de la lista <code>Include</code>:</li></ul>
<pre>Include conf/extra/php7_module.conf
</pre>
<p>Reinicie <code>httpd.service</code> usando <a href="../es/Systemd.html#Utilizar_las_unidades" title="Systemd (Español)">systemd</a>.
</p>
<h4><span class="mw-headline" id="Utilizando_apache2-mpm-worker_y_mod_fcgid">Utilizando apache2-mpm-worker y mod_fcgid</span></h4>
<p>Este método provee un uso de memoria y rendimiento mejorado al servir múltiples peticiones.
</p>
<p><a href="../es/Help:Reading.html#Instalaci%C3%B3n_de_paquetes" class="mw-redirect" title="Install (Español)">Instale</a> <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=mod_fcgid">mod_fcgid</a></span> y <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=php-cgi">php-cgi</a></span>.
</p>
<p>Cree el directorio necesario y enlacelo <i>(symlink)</i> a el <i>wrapper</i> de PHP:
</p>
<pre># mkdir /srv/http/fcgid-bin
# ln -s /usr/bin/php-cgi /srv/http/fcgid-bin/php-fcgid-wrapper
</pre>
<p>Cree <code>/etc/httpd/conf/extra/php-fcgid.conf</code> con el siguiente contenido:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/httpd/conf/extra/php-fcgid.conf</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;"># Modulos requeridos: fcgid_module

&lt;IfModule fcgid_module&gt;
    AddHandler php-fcgid .php
    AddType application/x-httpd-php .php
    Action php-fcgid /fcgid-bin/php-fcgid-wrapper
    ScriptAlias /fcgid-bin/ /srv/http/fcgid-bin/
    SocketPath /var/run/httpd/fcgidsock
    SharememPath /var/run/httpd/fcgid_shm
        # Si no permite peticiones más grandes, varias aplicaciones pueden fallar (como el WordPress login)
        FcgidMaxRequestLen 536870912
        # Ruta a php.ini – por defecto en /etc/phpX/cgi
        DefaultInitEnv PHPRC=/etc/php/
        # Numero de hijos de PHP a ejecutar. No lo defina para dejar que PHP decida.
        #DefaultInitEnv PHP_FCGI_CHILDREN 3
        # Peticiones máximas antes que un proceso sea detenido y uno nuevo sea iniciado
        #DefaultInitEnv PHP_FCGI_MAX_REQUESTS 5000
    &lt;Location /fcgid-bin/&gt;
        SetHandler fcgid-script
        Options +ExecCGI
    &lt;/Location&gt;
&lt;/IfModule&gt;
</pre>
<p>Edite <code>/etc/httpd/conf/httpd.conf</code>:
</p>
<ul><li>Quite las marcas de comentario en la carga del modulo <i>actions</i>:</li></ul>
<pre>LoadModule actions_module modules/mod_actions.so</pre>
<ul><li>Cargue el modulo FCGID <i>después</i> de haber cargado el modulo <i>unixd</i> (de el cual es dependiente) —ubiquelo en el bloque <code>&lt;IfModule unixd_module&gt;</code> —:</li></ul>
<pre>LoadModule fcgid_module modules/mod_fcgid.so</pre>
<ul><li>Asegúrese que el <code>Include</code> de la configuración de MPM no este comentado (no esta comentado por defecto en la versión instalada de este archivo):</li></ul>
<pre>Include conf/extra/httpd-mpm.conf</pre>
<ul><li>Incluya su nueva configuración de FCGID:</li></ul>
<pre>Include conf/extra/php-fcgid.conf</pre>
<p><a href="../es/Systemd.html#Utilizar_las_unidades" title="Systemd (Español)">Reinicie</a> <code>httpd.service</code>.
</p>
<h4><span class="mw-headline" id="Utilizando_php-fpm_y_mod_proxy_fcgi">Utilizando php-fpm y mod_proxy_fcgi</span></h4>
<p>Este método provee «una implementación alternativa al PHP FastCGI con algunas características adicionales (la mayoría) útiles para sitios web con mucho tráfico.» <a rel="nofollow" class="external autonumber" href="https://www.php.net/manual/es/install.fpm.php">[1]</a>.
</p>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Nota:</strong> A diferencia de la difundida configuración con ProxyPass, el proxy de la configuración con SetHandler respeta otras directivas de Apache como DirectoryIndex. Esto asegura mejor compatibilidad con software diseñado para libphp7, mod_fastcgi y mod_fcgid.
<p>Si aun quiere probar ProxyPass, experimente con una linea como esta:
</p>
<pre>ProxyPassMatch ^/(.*\.php(/.*)?)$ unix:/run/php-fpm/php-fpm.sock|fcgi://localhost/srv/http/$1</pre>
</div>
<p><a href="../es/Help:Reading.html#Instalaci%C3%B3n_de_paquetes" class="mw-redirect" title="Install (Español)">Instale</a> <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=php-fpm">php-fpm</a></span>.
</p>
<p>Habilite los módulos de proxy:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/httpd/conf/httpd.conf</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">LoadModule proxy_module modules/mod_proxy.so
LoadModule proxy_fcgi_module modules/mod_proxy_fcgi.so
</pre>
<p>Cree <code>/etc/httpd/conf/extra/php-fpm.conf</code> con el siguiente contenido:
</p>
<pre>DirectoryIndex index.php index.html
&lt;FilesMatch \.php$&gt;
    SetHandler "proxy:unix:/run/php-fpm/php-fpm.sock|fcgi://localhost/"
&lt;/FilesMatch&gt;
</pre>
<p>E incluyalo al final de <code>/etc/httpd/conf/httpd.conf</code>:
</p>
<pre>Include conf/extra/php-fpm.conf
</pre>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Nota:</strong> No esta permitido que la tubería (<code>|</code>) entre <code>sock</code> y <code>fcgi</code> este rodeada por un espacio. <code>localhost</code> puede ser remplazado por cualquier cadena. Mas información <a rel="nofollow" class="external text" href="https://httpd.apache.org/docs/2.4/mod/mod_proxy_fcgi.html">here</a>.</div>
<p>Puede configurar PHP-FPM en <code>/etc/php/php-fpm.d/www.conf</code>, pero la configuración por defecto debería funcionar bien.
</p>
<p>Inicie y habilite <code>php-fpm.service</code>. <a href="../es/Systemd.html#Utilizar_las_unidades" title="Systemd (Español)">Reinicie</a> <code>httpd.service</code>.
</p>
<h4><span class="mw-headline" id="Pruebe_si_PHP_funciona">Pruebe si PHP funciona</span></h4>
<p>Para probar si PHP fue correctamente configurado, cree un archivo llamado <code>prueba.php</code> en su directorio <code>DocumentRoot</code> de Apache (ej. <code>/srv/http/</code> o <code>~&lt;username&gt;/public_html/</code>) con los siguientes contenidos:
</p>
<pre>&lt;?php phpinfo(); ?&gt;
</pre>
<p>Y vaya a <a rel="nofollow" class="external free" href="http://localhost/prueba.php">http://localhost/prueba.php</a> o http://localhost/~&lt;username&gt;/prueba.php.
</p>
<h3><span class="mw-headline" id="HTTP2">HTTP2</span></h3>
<p>Para habilitar el soporte a HTTP/2, saque las marcas de comentario de la siguiente linea en <code>httpd.conf</code>:
</p>
<pre>LoadModule http2_module modules/mod_http2.so
</pre>
<p>Y añada la siguiente linea:
</p>
<pre>Protocols h2 http/1.1
</pre>
<p>Para más información, véase la documentación de <a rel="nofollow" class="external text" href="https://httpd.apache.org/docs/2.4/mod/mod_http2.html">mod_http2</a>.
</p>
<p>Tome en cuenta que http2_module no es compatible con mpm_prefork_module que es ampliamente usado en la configuración de PHP. Considere usar <a href="#Utilizando_php-fpm_y_mod_proxy_fcgi">php-fpm</a>.
</p>
<h2>
<span id="Soluci.C3.B3n_de_problemas"></span><span class="mw-headline" id="Solución_de_problemas">Solución de problemas</span>
</h2>
<h3><span class="mw-headline" id="Estado_de_Apache_y_registros">Estado de Apache y registros</span></h3>
<p>Vea el estado del demonio de Apache con <a href="../es/Systemd.html#Utilizaci%C3%B3n_b%C3%A1sica_de_systemctl" class="mw-redirect" title="Systemctl (Español)">systemctl</a>.
</p>
<p>Los registros de Apache pueden ser encontrados en <code>/var/log/httpd/</code>.
</p>
<h3>
<span id="Error:PID_file_.2Frun.2Fhttpd.2Fhttpd.pid_not_readable_.28yet.3F.29_after_start"></span><span class="mw-headline" id="Error:PID_file_/run/httpd/httpd.pid_not_readable_(yet?)_after_start">Error:PID file /run/httpd/httpd.pid not readable (yet?) after start</span>
</h3>
<p>Comente la linea <code>unique_id_module</code> en <code>httpd.conf</code>:
<code>#LoadModule unique_id_module modules/mod_unique_id.so</code>
</p>
<h3>
<span id=".2Frun.2Fhttpd_no_es_creado_al_arrancar"></span><span class="mw-headline" id="/run/httpd_no_es_creado_al_arrancar">/run/httpd no es creado al arrancar</span>
</h3>
<p>Si al ejecutar <code>systemd-tmpfiles --create</code> como <i>root</i> arroja «unsafe path transition», compruebe la posesión de su directorio raíz.
</p>
<pre>ls -la /
chown root:root /
</pre>
<h3>
<span id="Apache_is_running_a_threaded_MPM.2C_but_your_PHP_Module_is_not_compiled_to_be_threadsafe."></span><span class="mw-headline" id="Apache_is_running_a_threaded_MPM,_but_your_PHP_Module_is_not_compiled_to_be_threadsafe.">Apache is running a threaded MPM, but your PHP Module is not compiled to be threadsafe.</span>
</h3>
<p>Si al cargar <code>php7_module</code> el <code>httpd.service</code> falla, y obtiene un error como este en el <a href="../es/9c9ac504efb80051d62a211b0444a532.html" title="Systemd (Español)/Journal (Español)"><i>journal</i></a>:
</p>
<pre>Apache is running a threaded MPM, but your PHP Module is not compiled to be threadsafe.  You need to recompile PHP.
</pre>
<p>Es porque PHP incluye soporte para un modulo que no es <a rel="nofollow" class="external text" href="https://es.wikipedia.org/wiki/Seguridad_en_hilos"><i>threadsafe</i></a>, y usted esta intentando usar un MPM hilado. Una solución para esto es usar un MPM no hilado. Intente remplazar <code>mpm_event_module</code> con <code>mpm_prefork_module</code>:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/httpd/conf/httpd.conf</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;"><s>LoadModule mpm_event_module modules/mod_mpm_event.so</s>
LoadModule mpm_prefork_module modules/mod_mpm_prefork.so
</pre>
<p>Y reinicie <code>httpd.service</code>.
</p>
<h3><span class="mw-headline" id="AH00534:_httpd:_Configuration_error:_No_MPM_loaded.">AH00534: httpd: Configuration error: No MPM loaded.</span></h3>
<p>Puede encontrar este error después de una actualización reciente. Esto es solo el resultado de un cambio reciente en <code>httpd.conf</code> que no ha reproducido en su configuración local.
Para arreglarlo, no comente la siguiente linea:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/httpd/conf/httpd.conf</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">LoadModule mpm_prefork_module modules/mod_mpm_prefork.so
</pre>
<p>Y reinicie <code>httpd.service</code>.
</p>
<h3><span class="mw-headline" id="AH00072:_make_sock:_could_not_bind_to_address">AH00072: make_sock: could not bind to address</span></h3>
<p>Esto puede ser causado por varias cosas. El problema más común es que algo ya esta escuchando en el puerto dado, compruebe que no este sucediendo con netstat:
</p>
<pre># netstat -lnp | grep -e :80 -e :443
</pre>
<p>Si obtiene alguna salida, detenga el servicio que esta ocupando el puerto o mate el proceso desbocado <i>(runaway)</i> que esta causando que el puerto este ocupado, e intente de nuevo.
</p>
<p>Otro problema puede ser que Apache no esta iniciando como <i>root</i> por alguna razón —intente iniciarlo manualmente y vea si aun obtiene el error AH0072—.
</p>
<pre># httpd -k start
</pre>
<p>Finalmente, también puede tener un error con su configuración y esté escuchando dos veces en el puerto dado. Lo siguiente es un ejemplo de una mala configuración que puede desencadenar este problema:
</p>
<pre>Listen 0.0.0.0:80
Listen [::]:80
</pre>
<h3>
<span id="AH01071:_Got_error_.27Primary_script_unknown"></span><span class="mw-headline" id="AH01071:_Got_error_'Primary_script_unknown">AH01071: Got error 'Primary script unknown</span>
</h3>
<p>Este error puede ser causado por <code>ProtectHome=true</code> en el archivo de unidad de systemd de php-fpm si esta sirviendo archivos en <code>/home</code> como es un entorno de host virtual. Puede desactivar esta característica con <a href="../es/Systemd.html#Archivos_insertados" title="Systemd (Español)">editando el archivo de unidad de php-fpm</a> y reiniciandolo. Alternativamente, mueva su raíz de documento.
</p>
<h3><span class="mw-headline" id="Cambiar_el_valor_de_max_execution_time_en_php.ini_no_tiene_efecto">Cambiar el valor de max_execution_time en php.ini no tiene efecto</span></h3>
<p>Si cambió el valor de <code>max_execution_time</code> en <code>php.ini</code> a un valor mayor de 30 (segundos), aun puede que obtenga una respuesta de <code>503 Service Unavailable</code> de Apache después de treinta segundos. Para arreglarlo, añada una directiva <code>ProxyTimeout</code> a su configuración http justo después del bloque <code>&lt;FilesMatch \.php$&gt;</code>:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/httpd/conf/httpd.conf</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">ProxyTimeout 300
</pre>
<p>Y reinicie <code>httpd.service</code>.
</p>
<h3><span class="mw-headline" id="PHP-FPM:_los_errores_de_cada_host_virtual_no_son_registrados_por_separado">PHP-FPM: los errores de cada host virtual no son registrados por separado</span></h3>
<p>Si tiene múltiples hosts virtuales, puede ser deseable que cada uno registre sus errores en archivos separados (usando la directiva de Apache ErrorLog). Si esto no le esta funcionando, confirmen que PHP-FPM esta configurado para que registre los errores a syslog:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/php/php-fpm.conf</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">error_log = syslog</pre>
<p>También es posible que la configuración de reserva la haya anulado. Asegúrese que la siguiente linea este comentada:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/php/php-fpm.d/www.conf</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">;php_admin_value[error_log] = /var/log/fpm-php.www.log</pre>
<h2>
<span id="V.C3.A9ase_tambi.C3.A9n"></span><span class="mw-headline" id="Véase_también">Véase también</span>
</h2>
<ul>
<li><a rel="nofollow" class="external text" href="https://www.apache.org/">Pagina oficial de Apache</a></li>
<li><a rel="nofollow" class="external text" href="https://httpd.apache.org/docs/2.4/es/">Documentación en español de Apache</a></li>
<li><a rel="nofollow" class="external text" href="https://wiki.apache.org/httpd/">Apache Wiki</a></li>
<li><a rel="nofollow" class="external text" href="https://httpd.apache.org/docs/current/misc/security_tips.html">Documentacion de Apache - Consejos de seguridad</a></li>
<li><a rel="nofollow" class="external text" href="https://wiki.apache.org/httpd/CommonMisconfigurations">Apache Wiki - Solución de problemas</a></li>
<li>
<a href="https://wiki.debian.org/Apache" class="extiw" title="debian:Apache">Apache</a> en wiki.debian.org</li>
</ul>
</div>
</div>
<div id="catlinks" class="catlinks" data-mw="interface"><div id="mw-normal-catlinks" class="mw-normal-catlinks">
<a href="../Special:Categories.html" title="Special:Categories">Categories</a>: <ul>
<li><a href="../es/Category:Web_server.html" title="Category:Web server (Español)">Web server (Español)</a></li>
<li><a href="../es/Category:Apache.html" title="Category:Apache (Español)">Apache (Español)</a></li>
</ul>
</div></div>
	</div>
</div>

<footer id="footer" class="mw-footer" role="contentinfo" style="margin: 0">
	<ul id="footer-info">
		<li>Retrieved from "<a dir="ltr" href="https://wiki.archlinux.org/index.php?title=Apache_HTTP_Server_(Espa%C3%B1ol)&amp;oldid=643056">https://wiki.archlinux.org/index.php?title=Apache_HTTP_Server_(Español)&amp;oldid=643056</a>"</li>
		<li id="footer-info-lastmod"> This page was last edited on 3 December 2020, at 02:05.</li>
		<li id="footer-info-copyright">Content is available under <a class="external" rel="nofollow" href="http://www.gnu.org/copyleft/fdl.html">GNU Free Documentation License 1.3 or later</a> unless otherwise noted.</li>
	<br>
</ul>
	<ul id="footer-places">
		<li id="footer-places-privacy"><a href="../en/ArchWiki:Privacy_policy.html" title="ArchWiki:Privacy policy">Privacy policy</a></li>
		<li id="footer-places-about"><a href="../en/ArchWiki:About.html" title="ArchWiki:About">About ArchWiki</a></li>
		<li id="footer-places-disclaimer"><a href="../en/ArchWiki:General_disclaimer.html" title="ArchWiki:General disclaimer">Disclaimers</a></li>
	</ul>
	<ul id="footer-icons" class="noprint">
		<li id="footer-copyrightico">
	</ul>
	<div style="clear: both;"></div>
</footer>



</body>
</html>
