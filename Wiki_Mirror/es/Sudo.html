<!DOCTYPE html>
<html class="client-nojs" lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<title>Sudo (Español) - ArchWiki</title>
<link rel="stylesheet" href="../ArchWikiOffline.css">
<meta name="ResourceLoaderDynamicStyles" content="">
<meta name="generator" content="MediaWiki 1.35.0">
<meta name="robots" content="noindex,follow">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="shortcut icon" href="/favicon.ico">
<link rel="search" type="application/opensearchdescription+xml" href="/opensearch_desc.php" title="ArchWiki (en)">
<link rel="EditURI" type="application/rsd+xml" href="https://wiki.archlinux.org/api.php?action=rsd">
<link rel="license" href="http://www.gnu.org/copyleft/fdl.html">
<link rel="alternate" type="application/atom+xml" title="ArchWiki Atom feed" href="/index.php?title=Special:RecentChanges&amp;feed=atom">
</head>
<body class="mediawiki ltr sitedir-ltr mw-hide-empty-elt ns-0 ns-subject page-Sudo_Español rootpage-Sudo_Español skin-vector action-view skin-vector-legacy">
<div id="content" class="mw-body" role="main" style="margin: 0">
	<a id="top"></a>
	<div id="siteNotice" class="mw-body-content"></div>
	<div class="mw-indicators mw-body-content">
	</div>
	<h1 id="firstHeading" class="firstHeading" lang="en">Sudo (Español)</h1>
	<div id="bodyContent" class="mw-body-content">
		<div id="siteSub" class="noprint">From ArchWiki</div>
		<div id="contentSub"></div>
		<div id="contentSub2"></div>
		
		<div id="jump-to-nav"></div>
		<a class="mw-jump-link" href="#mw-head">Jump to navigation</a>
		<a class="mw-jump-link" href="#searchInput">Jump to search</a>
		<div id="mw-content-text" lang="en" dir="ltr" class="mw-content-ltr">
<div class="warningbox">The printable version is no longer supported and may have rendering errors. Please update your browser bookmarks and please use the default browser print function instead.</div>
<div class="mw-parser-output">
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Estado de la traducción:</strong> este artículo es una traducción de <a href="../en/Sudo.html" title="Sudo">sudo</a> revisada por última vez el <b>2020-12-12</b>. Si advierte que la versión inglesa <a rel="nofollow" class="external text" href="https://wiki.archlinux.org/index.php?title=Sudo&amp;diff=0&amp;oldid=637979">ha cambiado</a> puede actualizar la traducción <a href="../es/ArchWiki:f6ecee2fb17812f6654b3a6ff807d392.html" class="mw-redirect" title="ArchWiki:Translation Team/Contributing (Español)">usted mismo</a> o avisar al <a href="../es/ArchWiki:Translation_Team.html" title="ArchWiki:Translation Team (Español)">equipo de traducción</a>.</div>
<div class="archwiki-template-meta-related-articles-start">
<p>Artículos relacionados</p>
<ul>
<li><a href="../es/Users_and_groups.html" class="mw-redirect" title="Users and Groups (Español)">Usuarios y grupos</a></li>
<li><a href="../es/Su.html" title="Su (Español)">su</a></li>
</ul>
</div>
<p><a rel="nofollow" class="external text" href="https://www.sudo.ws/sudo/">Sudo</a> permite al administrador del sistema delegar autoridad para otorgar a ciertos usuarios (o grupos de usuarios) la capacidad de ejecutar comandos como superusuario <i>(root)</i> u otro mientras proporciona un registro de auditoría de los comandos y sus argumentos.
</p>
<p>Sudo es una alternativa a <a href="../es/Su.html" title="Su (Español)">su</a> para ejecutar comandos como superusuario. A diferencia de <b>su</b>, que lanza un shell de superusuario que permite que todos los demás comandos tengan acceso de superusuario, sudo ofrece una escalada temporal de privilegios a un solo comando. Al activar los privilegios de superusuario solo cuando es necesario, el uso de sudo reduce la probabilidad de que un error tipográfico o en un comando invocado arruine el sistema.
</p>
<p>Sudo también se puede usar para ejecutar comandos como otros usuarios; además, sudo registra todos los comandos y los intentos de acceso fallidos para la auditoría de seguridad.
</p>
<div id="toc" class="toc" role="navigation" aria-labelledby="mw-toc-heading">
<input type="checkbox" role="button" id="toctogglecheckbox" class="toctogglecheckbox" style="display:none"><div class="toctitle" lang="en" dir="ltr">
<h2 id="mw-toc-heading">Contents</h2>
<span class="toctogglespan"><label class="toctogglelabel" for="toctogglecheckbox"></label></span>
</div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Instalaci%C3%B3n"><span class="tocnumber">1</span> <span class="toctext">Instalación</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#Utilizaci%C3%B3n"><span class="tocnumber">2</span> <span class="toctext">Utilización</span></a></li>
<li class="toclevel-1 tocsection-3">
<a href="#Configuraci%C3%B3n"><span class="tocnumber">3</span> <span class="toctext">Configuración</span></a>
<ul>
<li class="toclevel-2 tocsection-4"><a href="#Estructura_por_defecto"><span class="tocnumber">3.1</span> <span class="toctext">Estructura por defecto</span></a></li>
<li class="toclevel-2 tocsection-5"><a href="#Ver_la_configuraci%C3%B3n_actual"><span class="tocnumber">3.2</span> <span class="toctext">Ver la configuración actual</span></a></li>
<li class="toclevel-2 tocsection-6"><a href="#Utilizando_visudo"><span class="tocnumber">3.3</span> <span class="toctext">Utilizando visudo</span></a></li>
<li class="toclevel-2 tocsection-7"><a href="#Ejemplos_de_entradas"><span class="tocnumber">3.4</span> <span class="toctext">Ejemplos de entradas</span></a></li>
<li class="toclevel-2 tocsection-8"><a href="#Permisos_de_archivo_predeterminados_de_sudoers"><span class="tocnumber">3.5</span> <span class="toctext">Permisos de archivo predeterminados de sudoers</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-9">
<a href="#Consejos_y_trucos"><span class="tocnumber">4</span> <span class="toctext">Consejos y trucos</span></a>
<ul>
<li class="toclevel-2 tocsection-10"><a href="#Desactivar_el_tiempo_de_espera_al_solicitar_la_contrase%C3%B1a"><span class="tocnumber">4.1</span> <span class="toctext">Desactivar el tiempo de espera al solicitar la contraseña</span></a></li>
<li class="toclevel-2 tocsection-11"><a href="#A%C3%B1adir_una_campana_en_el_terminal_a_la_solicitud_de_la_contrase%C3%B1a"><span class="tocnumber">4.2</span> <span class="toctext">Añadir una campana en el terminal a la solicitud de la contraseña</span></a></li>
<li class="toclevel-2 tocsection-12"><a href="#Transferir_alias"><span class="tocnumber">4.3</span> <span class="toctext">Transferir alias</span></a></li>
<li class="toclevel-2 tocsection-13"><a href="#Desactivar_sudo_por_cada_terminal"><span class="tocnumber">4.4</span> <span class="toctext">Desactivar sudo por cada terminal</span></a></li>
<li class="toclevel-2 tocsection-14"><a href="#Reducir_la_cantidad_de_veces_que_tiene_que_escribir_una_contrase%C3%B1a"><span class="tocnumber">4.5</span> <span class="toctext">Reducir la cantidad de veces que tiene que escribir una contraseña</span></a></li>
<li class="toclevel-2 tocsection-15"><a href="#Variables_de_entorno"><span class="tocnumber">4.6</span> <span class="toctext">Variables de entorno</span></a></li>
<li class="toclevel-2 tocsection-16"><a href="#Contrase%C3%B1a_de_superusuario"><span class="tocnumber">4.7</span> <span class="toctext">Contraseña de superusuario</span></a></li>
<li class="toclevel-2 tocsection-17">
<a href="#Desactivar_el_acceso_de_superusuario"><span class="tocnumber">4.8</span> <span class="toctext">Desactivar el acceso de superusuario</span></a>
<ul>
<li class="toclevel-3 tocsection-18"><a href="#kdesu"><span class="tocnumber">4.8.1</span> <span class="toctext">kdesu</span></a></li>
</ul>
</li>
<li class="toclevel-2 tocsection-19"><a href="#Ejemplo_de_protecci%C3%B3n_con_sudo"><span class="tocnumber">4.9</span> <span class="toctext">Ejemplo de protección con sudo</span></a></li>
<li class="toclevel-2 tocsection-20"><a href="#Configurar_sudo_mediante_archivos_complementarios_en_/etc/sudoers.d"><span class="tocnumber">4.10</span> <span class="toctext">Configurar sudo mediante archivos complementarios en /etc/sudoers.d</span></a></li>
<li class="toclevel-2 tocsection-21"><a href="#Edici%C3%B3n_de_archivos"><span class="tocnumber">4.11</span> <span class="toctext">Edición de archivos</span></a></li>
<li class="toclevel-2 tocsection-22"><a href="#Activar_insultos"><span class="tocnumber">4.12</span> <span class="toctext">Activar insultos</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-23">
<a href="#Soluci%C3%B3n_de_problemas"><span class="tocnumber">5</span> <span class="toctext">Solución de problemas</span></a>
<ul>
<li class="toclevel-2 tocsection-24"><a href="#Problemas_de_SSH_sin_TTY"><span class="tocnumber">5.1</span> <span class="toctext">Problemas de SSH sin TTY</span></a></li>
<li class="toclevel-2 tocsection-25"><a href="#Umask_permisiva"><span class="tocnumber">5.2</span> <span class="toctext">Umask permisiva</span></a></li>
</ul>
</li>
</ul>
</div>

<h2>
<span id="Instalaci.C3.B3n"></span><span class="mw-headline" id="Instalación">Instalación</span>
</h2>
<p><a href="../es/Help:Reading.html#Instalaci%C3%B3n_de_paquetes" title="Help:Reading (Español)">Instale</a> el paquete <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=sudo">sudo</a></span>.
</p>
<h2>
<span id="Utilizaci.C3.B3n"></span><span class="mw-headline" id="Utilización">Utilización</span>
</h2>
<p>Para comenzar a usar <code>sudo</code> como un usuario sin privilegios, debe estar configurado correctamente. Véase la sección <a href="#Configuraci%C3%B3n">configuración</a>.
</p>
<p>Para usar <i>sudo</i>, simplemente anteponga <code>sudo</code> y un espacio al comando y sus argumentos:
</p>
<pre>$ sudo <i>comando</i>
</pre>
<p>Por ejemplo, para usar pacman:
</p>
<pre>$ sudo pacman -Syu
</pre>
<p>Véase <span class="plainlinks archwiki-template-man" title="$ man 8 sudo"><a rel="nofollow" class="external text" href="https://man.archlinux.org/man/sudo.8">sudo(8)</a></span> para más información.
</p>
<h2>
<span id="Configuraci.C3.B3n"></span><span class="mw-headline" id="Configuración">Configuración</span>
</h2>
<h3><span class="mw-headline" id="Estructura_por_defecto">Estructura por defecto</span></h3>
<p>La página de los autores tiene una <a rel="nofollow" class="external text" href="http://www.sudo.ws/sudo/sudoers.man.html#x5355444f455253204f5054494f4e53">lista de todas las opciones</a> que se puede usar con el comando <code>Defaults</code> en el archivo <code>/etc/sudoers</code>.
</p>
<p>Véase <a rel="nofollow" class="external autonumber" href="https://gist.github.com/AladW/7eca9799b9ea624eca31">[1]</a> para obtener una lista de opciones (analizadas desde el código fuente de la versión 1.8.7) en un formato optimizado para <code>sudoers</code>.
</p>
<p>Véase <span class="plainlinks archwiki-template-man" title="$ man 5 sudoers"><a rel="nofollow" class="external text" href="https://man.archlinux.org/man/sudoers.5">sudoers(5)</a></span> para más información, como configurar el tiempo de espera de la contraseña.
</p>
<h3>
<span id="Ver_la_configuraci.C3.B3n_actual"></span><span class="mw-headline" id="Ver_la_configuración_actual">Ver la configuración actual</span>
</h3>
<p>Ejecute <code>sudo -ll</code> para visualizar la configuración actual de sudo, o <code>sudo -lU <i>usuario</i></code> para un usuario específico.
</p>
<h3><span class="mw-headline" id="Utilizando_visudo">Utilizando visudo</span></h3>
<p>El archivo de configuración de sudo es <code>/etc/sudoers</code>. <b>Siempre</b> debe editarse con el comando <span class="plainlinks archwiki-template-man" title="$ man 8 visudo"><a rel="nofollow" class="external text" href="https://man.archlinux.org/man/visudo.8">visudo(8)</a></span>. <i>visudo</i> bloquea el archivo <code>sudoers</code>, guarda los cambios en un archivo temporal y comprueba los errores sintácticos antes de copiarlo en <code>/etc/sudoers</code>.
</p>
<div class="archwiki-template-box archwiki-template-box-warning">
<strong>Advertencia:</strong> 
<ul>
<li>¡Es imperativo que el archivo <code>sudoers</code> no tenga errores de sintaxis! Cualquier error hará sudo inutilizable. Modifíquelo <b>siempre</b>  con <i>visudo</i> para evitar errores.</li>
<li>
<span class="plainlinks archwiki-template-man" title="$ man 8 visudo"><a rel="nofollow" class="external text" href="https://man.archlinux.org/man/visudo.8">visudo(8)</a></span> advierte que configurar <i>visudo</i> para respetar las variables de entorno del usuario para su editor de elección puede ser un agujero de seguridad, ya que permite al usuario con privilegios <i>visudo</i> ejecutar arbitrariamente órdenes como superusuario sin iniciar sesión simplemente estableciendo esa variable con cualquier cosa.</li>
</ul>
</div>
<p>El editor predeterminado para <i>visudo</i> es <i>vi</i>. El paquete <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=sudo">sudo</a></span> se compila con <code>--with-env-editor</code> de forma predeterminada y respeta el uso de las variables <code>SUDO_EDITOR</code> y <code>EDITOR</code>. <code>EDITOR</code> no se usa cuando se establece <code>VISUAL</code>.
</p>
<p>Para establecer <a href="../es/Nano.html" title="Nano (Español)">nano</a> como el editor de <i>visudo</i> durante la sesión actual de shell exporte <code>EDITOR=nano</code>; para usar un editor diferente una vez, simplemente configure la variable antes de llamar a <i>visudo</i>:
</p>
<pre># EDITOR=nano visudo
</pre>
<p>Alternativamente, puede editar una copia del archivo <code>/etc/sudoers</code> y verificarlo utilizando <code>visudo -c -f <i>/copy/of/sudoers</i></code>. Esto podría ser útil en caso de que quiera eludir el bloqueo del archivo con <i>visudo</i>.
</p>
<p>Para cambiar el editor permanentemente, véase la sección <a href="../es/Environment_variables.html#Por_usuario" title="Environment variables (Español)">variables de entorno por usuario</a>. Para cambiar el editor elegido solo para <i>visudo</i> de forma permanente en todo el sistema, añada lo siguiente a <code>/etc/sudoers</code> (suponiendo que <a href="../es/Nano.html" title="Nano (Español)">nano</a> es su editor preferido):
</p>
<pre># Restablece el entorno predeterminado
Defaults      env_reset
# Establece el EDITOR predeterminado a nano, y no permite a visudo usar EDITOR/VISUAL.
Defaults      editor=/usr/bin/nano, !env_editor
</pre>
<h3><span class="mw-headline" id="Ejemplos_de_entradas">Ejemplos de entradas</span></h3>
<p>Para permitir a un usuario normal obtener privilegios de superusuario <i>(root)</i> cuando anteponga <code>sudo</code> a una orden, añada la siguiente línea:
</p>
<pre>NOMBRE_DE_USUARIO   ALL=(ALL) ALL
</pre>
<p>Para permitir a un usuario ejecutar todas los comandos como cualquier usuario, pero únicamente en la máquina con el nombre <code>NOMBRE_DEL_EQUIPO</code>:
</p>
<pre>NOMBRE_DE_USUARIO   NOMBRE_DE_EQUIPO=(ALL) ALL
</pre>
<p>Para permitir que los miembros del grupo <code>wheel</code> tengan acceso a sudo:
</p>
<pre>%wheel      ALL=(ALL) ALL
</pre>
<div class="archwiki-template-box archwiki-template-box-tip">
<strong>Sugerencia:</strong> Al crear nuevos administradores, a menudo es conveniente activar el acceso sudo para el grupo <code>wheel</code> y <a href="../es/Users_and_groups.html#Otros_ejemplos_de_administraci%C3%B3n_de_usuarios" title="Users and groups (Español)">añadir el usuario a él</a>, ya que por defecto <a href="../en/Polkit.html#Administrator_identities" title="Polkit">Polkit</a> trata a los miembros del grupo <code>wheel</code> como administradores. Si el usuario no es miembro de <code>wheel</code>, el programa que utiliza Polkit puede solicitar la autenticación mediante la contraseña del superusuario en lugar de la contraseña del usuario.</div>
<p>Para desactivar la solicitud de contraseña para el usuario <code>NOMBRE_DE_USUARIO</code>:
</p>
<div class="archwiki-template-box archwiki-template-box-warning">
<strong>Advertencia:</strong> Esto permitirá que cualquier proceso que se ejecute con su nombre de usuario use sudo sin solicitar permiso.</div>
<pre>Defaults:NOMBRE_DE_USUARIO      !authenticate
</pre>
<p>Para activar las órdenes definidas explícitamente solo para el usuario <code>NOMBRE_DE_USUARIO</code> en el equipo <code>NOMBRE_DEL_EQUIPO</code>:
</p>
<pre>NOMBRE_DE_USUARIO NOMBRE_DEL_EQUIPO=/usr/bin/halt,/usr/bin/poweroff,/usr/bin/reboot,/usr/bin/pacman -Syu
</pre>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Nota:</strong> La opción más personalizada debe ir al final del archivo, ya que las líneas posteriores anulan las anteriores. En particular, una línea de este tipo debe estar después de la línea <code>%wheel</code> si su usuario está en este grupo.</div>
<p>Para activar, sin necesidad de contraseña, los comandos definidos explícitamente solo para el usuario <code>NOMBRE_DE_USUARIO</code> en el equipo <code>NOMBRE_DEL_EQUIPO</code>:
</p>
<pre>NOMBRE_DE_USUARIO NOMBRE_DEL_EQUIPO= NOPASSWD: /usr/bin/halt,/usr/bin/poweroff,/usr/bin/reboot,/usr/bin/pacman -Syu
</pre>
<p>Un ejemplo detallado de <code>sudoers</code> está disponible en <code>/usr/share/doc/sudo/examples/sudoers</code>. Por otro lado, véase <span class="plainlinks archwiki-template-man" title="$ man 5 sudoers"><a rel="nofollow" class="external text" href="https://man.archlinux.org/man/sudoers.5">sudoers(5)</a></span> para obtener información detallada.
</p>
<h3><span class="mw-headline" id="Permisos_de_archivo_predeterminados_de_sudoers">Permisos de archivo predeterminados de sudoers</span></h3>
<p>El propietario y el grupo para el archivo <code>sudoers</code> deben ser ambos 0. Los permisos de los archivos deben establecerse en 0440. Estos permisos se establecen de forma predeterminada, pero si los cambia accidentalmente, deberían ser cambiados de nuevo inmediatamente o sudo fallará.
</p>
<pre># chown -c root:root /etc/sudoers
# chmod -c 0440 /etc/sudoers
</pre>
<h2><span class="mw-headline" id="Consejos_y_trucos">Consejos y trucos</span></h2>
<h3>
<span id="Desactivar_el_tiempo_de_espera_al_solicitar_la_contrase.C3.B1a"></span><span class="mw-headline" id="Desactivar_el_tiempo_de_espera_al_solicitar_la_contraseña">Desactivar el tiempo de espera al solicitar la contraseña</span>
</h3>
<p>Una molestia común es un proceso de larga duración que se ejecuta con permisos normales en segundo plano en un terminal y se eleva solo cuando es necesario. Esto lleva a una solicitud de contraseña de sudo que pasa desapercibida y se agota el tiempo, en cuyo caso el proceso muere y el trabajo realizado se pierde o, en el mejor de los casos, se almacena en caché. Un consejo común es activar sudo sin contraseña o extender el tiempo de espera de sudo para recordar una contraseña. Ambos tienen implicaciones negativas de seguridad. El tiempo de espera para introducir la contraseña también se puede desactivar y, dado que eso no sirve para ningún propósito de seguridad razonable, debería ser la solución aquí:
</p>
<pre>Defaults passwd_timeout=0
</pre>
<h3>
<span id="A.C3.B1adir_una_campana_en_el_terminal_a_la_solicitud_de_la_contrase.C3.B1a"></span><span class="mw-headline" id="Añadir_una_campana_en_el_terminal_a_la_solicitud_de_la_contraseña">Añadir una campana en el terminal a la solicitud de la contraseña</span>
</h3>
<p>Para llamar la atención sobre un indicador de sudo en un terminal en segundo plano, los usuarios pueden hacer simplemente que muestre un <a href="https://en.wikipedia.org/wiki/Bell_character" class="extiw" title="wikipedia:Bell character">carácter de campana</a>:
</p>
<pre>Defaults passprompt="^G[sudo] password for %p: "
</pre>
<p>Tenga en cuenta que ^G es literalmente un carácter de campana. En vim se introduce mediante la secuencia ^V ^G.
</p>
<h3><span class="mw-headline" id="Transferir_alias">Transferir alias</span></h3>
<p>Si utiliza muchos alias, es posible que haya notado que no se transfieren a la cuenta de superusuairo cuando utiliza sudo. Sin embargo, existe una forma sencilla de hacer que funcionen. Simplemente añada lo siguiente a su <code>~/.bashrc</code> o <code>/etc/bash.bashrc</code>:
</p>
<pre>alias sudo='sudo '
</pre>
<h3><span class="mw-headline" id="Desactivar_sudo_por_cada_terminal">Desactivar sudo por cada terminal</span></h3>
<div class="archwiki-template-box archwiki-template-box-warning">
<strong>Advertencia:</strong> Esto permitirá que cualquier proceso use su sesión sudo.</div>
<p>Si le molesta que sudo, de forma predeterminada, requiera introducir la contraseña cada vez que abra un nuevo terminal, configure <code>timestamp_type</code> a <code>global</code>:
</p>
<pre>Defaults timestamp_type=global
</pre>
<h3>
<span id="Reducir_la_cantidad_de_veces_que_tiene_que_escribir_una_contrase.C3.B1a"></span><span class="mw-headline" id="Reducir_la_cantidad_de_veces_que_tiene_que_escribir_una_contraseña">Reducir la cantidad de veces que tiene que escribir una contraseña</span>
</h3>
<p>Si le molesta tener que volver a escribir su contraseña cada 5 minutos (predeterminado), puede cambiar esto estableciendo un valor más largo para <code>timestamp_timeout</code> (en minutos):
</p>
<pre>Defaults timestamp_timeout=10
</pre>
<p>Si está utilizando muchas órdenes sudo en una línea, es más lógico actualizar el tiempo de espera cada vez que utilice sudo que aumentar <code>timestamp_timeout</code>. Se puede actualizar el tiempo de espera con <code>sudo -v</code> (mientras que <code>sudo -K</code> se revoca inmediatamente).
</p>
<p>Es posible que quiera automatizar esto añadiendo lo siguiente a su <code>.bashrc</code>:
</p>
<pre>alias sudo='sudo -v; sudo '
</pre>
<p>También es posible utilizar una función bash; para obtener más detalles, véase <a rel="nofollow" class="external text" href="https://unix.stackexchange.com/questions/584725/expand-certain-aliases-from-within-sudo-bash-function">stackexchange</a>.
</p>
<h3><span class="mw-headline" id="Variables_de_entorno">Variables de entorno</span></h3>
<p>Si se tienen muchas variables de entorno, o exporta la configuración del proxy a través de <code>export http_proxy="..."</code>, al usar sudo estas variables no se pasan a la cuenta de superusuario, a menos que ejecute sudo con la opción <code>-E</code>.
</p>
<pre>$ sudo -E pacman -Syu
</pre>
<p>La forma recomendada de preservar las variables de entorno es añadiendo a <code>env_keep</code>:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/sudoers</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">Defaults env_keep += "ftp_proxy http_proxy https_proxy no_proxy"
</pre>
<h3>
<span id="Contrase.C3.B1a_de_superusuario"></span><span class="mw-headline" id="Contraseña_de_superusuario">Contraseña de superusuario</span>
</h3>
<p>Los usuarios pueden configurar sudo para solicitar la contraseña del superusuario en lugar de la contraseña de usuario añadiendo <code>targetpw</code> (usuario de destino, predeterminado a superusuario) o <code>rootpw</code> a la línea Defaults en <code>/etc/sudoers</code>:
</p>
<pre>Defaults targetpw
</pre>
<p>Para evitar exponer su contraseña de superusuario a los usuarios, puede restringirla a un grupo específico:
</p>
<pre>Defaults:%wheel targetpw
%wheel ALL=(ALL) ALL
</pre>
<h3><span class="mw-headline" id="Desactivar_el_acceso_de_superusuario">Desactivar el acceso de superusuario</span></h3>
<p>Los usuarios pueden querer desactivar el inicio de sesión del superusuario. Sin este, los atacantes deben primero adivinar un nombre de usuario configurado como sudoer, así como su contraseña. Véase por ejemplo <a href="../es/OpenSSH.html#Denegar" title="OpenSSH (Español)">Denegar</a>.
</p>
<div class="archwiki-template-box archwiki-template-box-warning">
<strong>Advertencia:</strong> 
<ul>
<li>Tenga cuidado, puede bloquearse al desactivar el inicio de sesión del superusuario. Sudo no se instala automáticamente y su configuración predeterminada no permite el acceso al superusuario sin contraseña ni con su propia contraseña. Asegúrese de que el usuario esté configurado correctamente como un sudoer <i>antes</i> de desactivar la cuenta de superusuario.</li>
<li>Si ha cambiado su archivo sudoers para utilizar rootpw como predeterminado, entonces no desactive el inicio de sesión del superusuario con ninguno de los siguientes comandos.</li>
<li>Si ya está bloqueado, véase como <a href="../en/Reset_lost_root_password.html" class="mw-redirect" title="Reset root password">reiniciar la contraseña del superusuario</a> para obtener ayuda.</li>
</ul>
</div>
<p>La cuenta puede ser bloqueada mediante <code>passwd</code>:
</p>
<pre># passwd -l root
</pre>
<p>Una orden similar desbloquea al superusuario.
</p>
<pre>$ sudo passwd -u root
</pre>
<p>Alternativamente, edite <code>/etc/shadow</code> y reemplace la contraseña cifrada del superusuario <i>(root)</i> con «!»:
</p>
<pre>root:!:12345::::::
</pre>
<p>Para activar de nuevo el acceso del superusuario:
</p>
<pre>$ sudo passwd root
</pre>
<div class="archwiki-template-box archwiki-template-box-tip">
<strong>Sugerencia:</strong> Para acceder a un shell de superusuario, incluso después de desactivar la cuenta del superusuario, utilice <code>sudo -i</code>.</div>
<h4><span class="mw-headline" id="kdesu">kdesu</span></h4>
<p>kdesu puede ser utilizado bajo <a href="../es/KDE.html" title="KDE (Español)">KDE</a> para lanzar aplicaciones gráficas con privilegios de superusuario. Es posible que, por defecto, kdesu trate de usar su incluso si la cuenta de superusuario está desactivada. Afortunadamente se puede invocar kdesu para usar sudo en lugar de su. Cree/modifique el archivo <code>~/.config/kdesurc</code>:
</p>
<pre>[super-user-command]
super-user-command=sudo
</pre>
<p>o use el siguiente comando:
</p>
<pre>$ kwriteconfig5 --file kdesurc --group super-user-command --key super-user-command sudo
</pre>
<p>Alternativamente, instale <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://aur.archlinux.org/packages/kdesudo/">kdesudo</a></span><sup><small>AUR</small></sup>, que tiene la ventaja adicional de autocompletar con tabulador el comando siguiente.
</p>
<h3>
<span id="Ejemplo_de_protecci.C3.B3n_con_sudo"></span><span class="mw-headline" id="Ejemplo_de_protección_con_sudo">Ejemplo de protección con sudo</span>
</h3>
<p>Digamos que crea 3 usuarios: admin, devel y joe. El usuario «admin» se usa para journalctl, systemctl, mount, kill e iptables; «devel» se usa para instalar paquetes y editar archivos de configuración; y «joe» es el usuario con el que inicia sesión. Para permitir a «joe» reiniciar, apagar y usar netctl, haríamos lo siguiente:
</p>
<p>Edite <code>/etc/pam.d/su</code> y <code>/etc/pam.d/su-l</code>
Requiere que el usuario esté en el grupo wheel, pero no ponga a nadie en él.
</p>
<pre>#%PAM-1.0
auth            sufficient      pam_rootok.so
# Descomente la siguiente línea para confiar implícitamente en los usuarios del grupo "wheel".
#auth           sufficient      pam_wheel.so trust use_uid
# Descomente la siguiente línea para requerir que un usuario esté en el grupo "wheel".
auth            required        pam_wheel.so use_uid
auth            required        pam_unix.so
account         required        pam_unix.so
session         required        pam_unix.so
</pre>
<p>Limite el inicio de sesión de SSH al grupo 'ssh'. Solo «joe» será parte de este grupo.
</p>
<pre>groupadd -r ssh
gpasswd -a joe ssh
echo 'AllowGroups ssh' &gt;&gt; /etc/ssh/sshd_config
</pre>
<p><a href="../en/Systemd.html#Using_units" class="mw-redirect" title="Restart">Reinicie</a> <code>sshd.service</code>.
</p>
<p>Añada usuarios a otros grupos.
</p>
<pre>for g in power network ;do ;gpasswd -a joe $g ;done
for g in network power storage ;do ;gpasswd -a admin $g ;done
</pre>
<p>Ajuste los permisos en las configuraciones para que «devel» pueda editarlos.
</p>
<pre>chown -R devel:root /etc/{http,openvpn,cups,zsh,vim,screenrc}
</pre>
<pre>Cmnd_Alias  POWER       =   /usr/bin/shutdown -h now, /usr/bin/halt, /usr/bin/poweroff, /usr/bin/reboot
Cmnd_Alias  STORAGE     =   /usr/bin/mount -o nosuid\,nodev\,noexec, /usr/bin/umount
Cmnd_Alias  SYSTEMD     =   /usr/bin/journalctl, /usr/bin/systemctl
Cmnd_Alias  KILL        =   /usr/bin/kill, /usr/bin/killall
Cmnd_Alias  PKGMAN      =   /usr/bin/pacman
Cmnd_Alias  NETWORK     =   /usr/bin/netctl
Cmnd_Alias  FIREWALL    =   /usr/bin/iptables, /usr/bin/ip6tables
Cmnd_Alias  SHELL       =   /usr/bin/zsh, /usr/bin/bash
%power      ALL         =   (root)  NOPASSWD: POWER
%network    ALL         =   (root)  NETWORK
%storage    ALL         =   (root)  STORAGE
root        ALL         =   (ALL)   ALL
admin       ALL         =   (root)  SYSTEMD, KILL, FIREWALL
devel       ALL         =   (root)  PKGMAN
joe         ALL         =   (devel) SHELL, (admin) SHELL 
</pre>
<p>Con esta configuración, casi nunca necesitará iniciar sesión como superusuario.
</p>
<p>«joe» se puede conectar a una red inalámbrica doméstica:
</p>
<pre>sudo netctl start home
sudo poweroff
</pre>
<p>«joe» no puede utilizar netctl como cualquier otro usuario.
</p>
<pre>sudo -u admin -- netctl start home
</pre>
<p>Cuando «joe» necesite utilizar journalctl o terminar la ejecución de un proceso puede cambiar a dicho usuario:
</p>
<pre>sudo -i -u devel
sudo -i -u admin
</pre>
<p>Pero «joe» no puede cambiar a superusuario:
</p>
<pre>sudo -i -u root
</pre>
<p>Si «joe» quiere iniciar una sesión gnu-screen como «admin» puede hacerlo así:
</p>
<pre>sudo -i -u admin
admin% chown admin:tty `echo $TTY`
admin% screen
</pre>
<h3>
<span id="Configurar_sudo_mediante_archivos_complementarios_en_.2Fetc.2Fsudoers.d"></span><span class="mw-headline" id="Configurar_sudo_mediante_archivos_complementarios_en_/etc/sudoers.d">Configurar sudo mediante archivos complementarios en /etc/sudoers.d</span>
</h3>
<p><i>sudo</i> analiza los archivos contenidos en el directorio <code>/etc/sudoers.d/</code>. Esto significa que en lugar de editar <code>/etc/sudoers</code>, puede cambiar la configuración mediante archivos independientes y soltarlos en ese directorio. Esto tiene dos ventajas:
</p>
<ul>
<li>No hay necesidad de editar un archivo <code>sudoers.pacnew</code>;</li>
<li>Si hay un problema con una nueva entrada, puede eliminar el archivo afectado en lugar de editar <code>/etc/sudoers</code> (pero véase la advertencia a continuación).</li>
</ul>
<p>El formato para las entradas en estos archivos complementarios es el mismo que para <code>/etc/sudoers</code>. Para editarlos directamente, utilice <code>visudo -f /etc/sudoers.d/<i>nombre_archivo</i></code>. Véase <span class="plainlinks archwiki-template-man" title="$ man 5 sudoers"><a rel="nofollow" class="external text" href="https://man.archlinux.org/man/sudoers.5#Incluir_otros_archivos_desde_sudoers">sudoers(5) § Incluir otros archivos desde sudoers</a></span> para más información.
</p>
<p>Los archivos en el directorio <code>/etc/sudoers.d/</code> se analizan en orden lexicográfico, los nombres de archivo que contienen <code>.</code> o <code>~</code> se omiten. Para evitar problemas de clasificación, los nombres de los archivos deben comenzar con dos dígitos, por ejemplo <code>01_foo</code>.
</p>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Nota:</strong> El orden de las entradas en los archivos complementarios es importante: asegúrese de que las declaraciones no se anulan a sí mismas.</div>
<div class="archwiki-template-box archwiki-template-box-warning">
<strong>Advertencia:</strong> Los archivos en <code>/etc/sudoers.d/</code> son tan frágiles como el mismo <code>/etc/sudoers</code>: cualquier archivo incorrectamente formateado evitará el funcionamiento de <code>sudo</code>. Por lo tanto, por esta misma razón, se recomienda encarecidamente usar <code>visudo</code>
</div>
<h3>
<span id="Edici.C3.B3n_de_archivos"></span><span class="mw-headline" id="Edición_de_archivos">Edición de archivos</span>
</h3>
<p><code>sudo -e</code> o <code>sudoedit</code> le permite editar un archivo como otro usuario mientras ejecuta el editor de texto como su usuario.
</p>
<p>Esto es especialmente útil para editar archivos como superusuario sin elevar el privilegio de su editor de texto. Véase <span class="plainlinks archwiki-template-man" title="$ man 8 sudo"><a rel="nofollow" class="external text" href="https://man.archlinux.org/man/sudo.8#e">sudo(8) § e</a></span> para más detalles.
</p>
<p>Tenga en cuenta que puede configurar el editor para cualquier programa, por lo que, por ejemplo, uno puede usar <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=meld">meld</a></span> para administrar archivos <a href="../es/96d02da33d97d6c6ee5a67949d73d055.html" class="mw-redirect" title="Pacman/Pacnew and Pacsave (Español)">pacnew</a>:
</p>
<pre>$ SUDO_EDITOR=meld sudo -e /etc/<i>file</i>{,.pacnew<i>}</i>
</pre>
<h3><span class="mw-headline" id="Activar_insultos">Activar insultos</span></h3>
<p>Los usuarios pueden activar el huevo de Pascua de insultos en sudo añadiendo la siguiente línea en el archivo sudoers con <code>visudo</code>.
</p>
<p>Al introducir una contraseña incorrecta se reemplazará el mensaje <code>Inténtelo de nuevo.</code> por insultos en tono de humor.
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/sudoers</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">Defaults insults</pre>
<h2>
<span id="Soluci.C3.B3n_de_problemas"></span><span class="mw-headline" id="Solución_de_problemas">Solución de problemas</span>
</h2>
<h3><span class="mw-headline" id="Problemas_de_SSH_sin_TTY">Problemas de SSH sin TTY</span></h3>
<p>SSH no asigna una tty de forma predeterminada cuando ejecuta un comando remoto. Sin una tty asignada, sudo no puede evitar que se muestre la contraseña. Puede utilizar la opción de ssh <code>-t</code> para forzar la asignación de una tty.
</p>
<p>La opción <code>requiretty</code> de <code>Defaults</code> permite al usuario ejecutar sudo solo si tiene una tty.
</p>
<pre># Desactive "ssh hostname sudo &lt;cmd&gt;", ya que mostrará la contraseña en texto claro. Se tiene que ejecutar "ssh -t hostname sudo &lt;cmd&gt;".
#
#Defaults    requiretty
</pre>
<h3><span class="mw-headline" id="Umask_permisiva">Umask permisiva</span></h3>
<p>Sudo unirá el valor <a href="../es/Umask.html" title="Umask (Español)">umask</a> del usuario con su propia umask (que por defecto es 0022). Esto evita que sudo cree archivos con permisos más abiertos que los que permite el umask del usuario. Si bien este es un valor predeterminado cuando no se usa umask personalizada, esto puede llevar a situaciones en las que una utilidad ejecutada por sudo puede crear archivos con permisos diferentes que si se ejecutara directamente desde el superusuario <i>(root)</i>. Si surgen errores a partir de esto, sudo proporciona un medio para reparar la umask, incluso si la umask deseada es más permisiva que la umask que el usuario ha especificado. Añadir esto (usando <code>visudo</code>) anulará el comportamiento predeterminado de sudo:
</p>
<pre>Defaults umask = 0022
Defaults umask_override
</pre>
<p>Esto establece el umask de sudo en umask predeterminado del superusuario (0022) y anula el comportamiento predefinido, utilizando siempre la umask indicada, independientemente de la umask definida del usuario.
</p>
</div>
</div>
<div id="catlinks" class="catlinks" data-mw="interface"><div id="mw-normal-catlinks" class="mw-normal-catlinks">
<a href="../Special:Categories.html" title="Special:Categories">Categories</a>: <ul>
<li><a href="../es/Category:Security.html" title="Category:Security (Español)">Security (Español)</a></li>
<li><a href="../es/Category:Commands.html" title="Category:Commands (Español)">Commands (Español)</a></li>
</ul>
</div></div>
	</div>
</div>

<footer id="footer" class="mw-footer" role="contentinfo" style="margin: 0">
	<ul id="footer-info">
		<li>Retrieved from "<a dir="ltr" href="https://wiki.archlinux.org/index.php?title=Sudo_(Espa%C3%B1ol)&amp;oldid=644879">https://wiki.archlinux.org/index.php?title=Sudo_(Español)&amp;oldid=644879</a>"</li>
		<li id="footer-info-lastmod"> This page was last edited on 12 December 2020, at 21:09.</li>
		<li id="footer-info-copyright">Content is available under <a class="external" rel="nofollow" href="http://www.gnu.org/copyleft/fdl.html">GNU Free Documentation License 1.3 or later</a> unless otherwise noted.</li>
	<br>
</ul>
	<ul id="footer-places">
		<li id="footer-places-privacy"><a href="../en/ArchWiki:Privacy_policy.html" title="ArchWiki:Privacy policy">Privacy policy</a></li>
		<li id="footer-places-about"><a href="../en/ArchWiki:About.html" title="ArchWiki:About">About ArchWiki</a></li>
		<li id="footer-places-disclaimer"><a href="../en/ArchWiki:General_disclaimer.html" title="ArchWiki:General disclaimer">Disclaimers</a></li>
	</ul>
	<ul id="footer-icons" class="noprint">
		<li id="footer-copyrightico">
	</ul>
	<div style="clear: both;"></div>
</footer>



</body>
</html>
