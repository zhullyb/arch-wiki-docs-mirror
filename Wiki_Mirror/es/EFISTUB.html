<!DOCTYPE html>
<html class="client-nojs" lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<title>EFISTUB (Español) - ArchWiki</title>
<link rel="stylesheet" href="../ArchWikiOffline.css">
<meta name="ResourceLoaderDynamicStyles" content="">
<meta name="generator" content="MediaWiki 1.35.0">
<meta name="referrer" content="no-referrer-when-downgrade">
<meta name="robots" content="noindex,follow">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="shortcut icon" href="/favicon.ico">
<link rel="search" type="application/opensearchdescription+xml" href="/opensearch_desc.php" title="ArchWiki (en)">
<link rel="EditURI" type="application/rsd+xml" href="https://wiki.archlinux.org/api.php?action=rsd">
<link rel="license" href="http://www.gnu.org/copyleft/fdl.html">
<link rel="alternate" type="application/atom+xml" title="ArchWiki Atom feed" href="/index.php?title=Special:RecentChanges&amp;feed=atom">
</head>
<body class="mediawiki ltr sitedir-ltr mw-hide-empty-elt ns-0 ns-subject page-EFISTUB_Español rootpage-EFISTUB_Español skin-vector action-view skin-vector-legacy">
<div id="content" class="mw-body" role="main" style="margin: 0">
	<a id="top"></a>
	<div id="siteNotice" class="mw-body-content"></div>
	<div class="mw-indicators mw-body-content">
	</div>
	<h1 id="firstHeading" class="firstHeading" lang="en">EFISTUB (Español)</h1>
	<div id="bodyContent" class="mw-body-content">
		<div id="siteSub" class="noprint">From ArchWiki</div>
		<div id="contentSub"></div>
		<div id="contentSub2"></div>
		
		<div id="jump-to-nav"></div>
		<a class="mw-jump-link" href="#mw-head">Jump to navigation</a>
		<a class="mw-jump-link" href="#searchInput">Jump to search</a>
		<div id="mw-content-text" lang="en" dir="ltr" class="mw-content-ltr">
<div class="warningbox">The printable version is no longer supported and may have rendering errors. Please update your browser bookmarks and please use the default browser print function instead.</div>
<div class="mw-parser-output">
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Estado de la traducción:</strong> esta traducción de <a href="/title/EFISTUB" title="EFISTUB">EFISTUB</a> fue revisada el <b>2018-11-27</b>. Si existen <a rel="nofollow" class="external text" href="https://wiki.archlinux.org/index.php?title=EFISTUB&amp;diff=0&amp;oldid=544457">cambios</a> puede <a href="/title/ArchWiki:Translation_Team/Contributing_(Espa%C3%B1ol)" class="mw-redirect" title="ArchWiki:Translation Team/Contributing (Español)">actualizarla</a> o avisar al <a href="/title/ArchWiki:Translation_Team_(Espa%C3%B1ol)" title="ArchWiki:Translation Team (Español)">equipo de traducción</a>.</div>
<div class="archwiki-template-meta-related-articles-start">
<p>Artículos relacionados</p>
<ul>
<li><a href="/title/Arch_boot_process_(Espa%C3%B1ol)" title="Arch boot process (Español)">Arch boot process (Español)</a></li>
<li><a href="/title/Unified_Extensible_Firmware_Interface_(Espa%C3%B1ol)" title="Unified Extensible Firmware Interface (Español)">Unified Extensible Firmware Interface (Español)</a></li>
</ul>
</div>
<p>El kernel de Linux admite arrancar con EFISTUB (EFI BOOT STUB). Esta característica permite que el firmware EFI cargue el kernel como un ejecutable EFI. La opción está activada de forma predeterminada en los kernels de Arch Linux o se puede activar mediante el establecimiento de la variable <code>CONFIG_EFI_STUB=y</code> en la configuración del kernel. Vea <a rel="nofollow" class="external text" href="https://www.kernel.org/doc/Documentation/efi-stub.txt">The EFI Boot Stub</a> para más información.
</p>
<p>Con EFISTUB un kernel se puede arrancar directamente por una placa base UEFI o indirectamente usando un <a href="/title/Boot_loader_(Espa%C3%B1ol)" class="mw-redirect" title="Boot loader (Español)">gestor de arranque</a>. Este último es recomendado si se tienen múltiples pares de kernel/initramfs y el menú de inicio UEFI de su placa base no es fácil de usar.
</p>
<div id="toc" class="toc" role="navigation" aria-labelledby="mw-toc-heading">
<input type="checkbox" role="button" id="toctogglecheckbox" class="toctogglecheckbox" style="display:none"><div class="toctitle" lang="en" dir="ltr">
<h2 id="mw-toc-heading">Contents</h2>
<span class="toctogglespan"><label class="toctogglelabel" for="toctogglecheckbox"></label></span>
</div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Prepararse_para_EFISTUB"><span class="tocnumber">1</span> <span class="toctext">Prepararse para EFISTUB</span></a></li>
<li class="toclevel-1 tocsection-2">
<a href="#Arrancar_EFISTUB"><span class="tocnumber">2</span> <span class="toctext">Arrancar EFISTUB</span></a>
<ul>
<li class="toclevel-2 tocsection-3"><a href="#Utilizar_un_gestor_de_arranque"><span class="tocnumber">2.1</span> <span class="toctext">Utilizar un gestor de arranque</span></a></li>
<li class="toclevel-2 tocsection-4">
<a href="#Utilizar_directamente_UEFI"><span class="tocnumber">2.2</span> <span class="toctext">Utilizar directamente UEFI</span></a>
<ul>
<li class="toclevel-3 tocsection-5"><a href="#efibootmgr"><span class="tocnumber">2.2.1</span> <span class="toctext">efibootmgr</span></a></li>
<li class="toclevel-3 tocsection-6"><a href="#efibootmgr_con_el_archivo_.efi"><span class="tocnumber">2.2.2</span> <span class="toctext">efibootmgr con el archivo .efi</span></a></li>
<li class="toclevel-3 tocsection-7"><a href="#Int%C3%A9rprete_de_%C3%B3rdenes_de_UEFI"><span class="tocnumber">2.2.3</span> <span class="toctext">Intérprete de órdenes de UEFI</span></a></li>
<li class="toclevel-3 tocsection-8"><a href="#Utilizar_un_script_startup.nsh"><span class="tocnumber">2.2.4</span> <span class="toctext">Utilizar un script startup.nsh</span></a></li>
</ul>
</li>
</ul>
</li>
<li class="toclevel-1 tocsection-9"><a href="#V%C3%A9ase_tambi%C3%A9n"><span class="tocnumber">3</span> <span class="toctext">Véase también</span></a></li>
</ul>
</div>

<h2><span class="mw-headline" id="Prepararse_para_EFISTUB">Prepararse para EFISTUB</span></h2>
<p>Primero, debe crear una <a href="/title/EFI_system_partition_(Espa%C3%B1ol)" title="EFI system partition (Español)">EFI system partition (Español)</a>  y elegir cómo se monta. Vea <a href="/title/EFI_system_partition_(Espa%C3%B1ol)#Montar_la_partici%C3%B3n" title="EFI system partition (Español)">EFI system partition (Español)#Montar la partición</a> para todas las opciones de montaje disponibles.
</p>
<div class="archwiki-template-box archwiki-template-box-tip">
<strong>Sugerencia:</strong> 
<ul>
<li>
<a href="/title/Pacman_(Espa%C3%B1ol)" title="Pacman (Español)">pacman (Español)</a> actualizará directamente el kernel que leerá el firmware EFI si monta la partición ESP en <code>/boot</code>.</li>
<li>Puede mantener el kernel e initramfs fuera de la partición ESP si utiliza un gestor de arranque que tenga un controlador de sistema de archivos para la partición donde residan, por ejemplo <a href="/title/REFInd" title="REFInd">rEFInd</a>.</li>
</ul>
</div>
<h2><span class="mw-headline" id="Arrancar_EFISTUB">Arrancar EFISTUB</span></h2>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Nota:</strong> la ruta a initramfs para EFISTUB debe ser relativa con respecto a la raíz de la «<i>EFI System Partition</i>» y usar barras invertidas (de acuerdo con los estándares de EFI). Por ejemplo, si initramfs se encuentra en <code><i>esp</i>/EFI/arch/initramfs-linux.img</code>, la línea correspondiente a UEFI debe ser <code>initrd=\EFI\arch\initramfs-linux.img</code>. En los siguientes ejemplos asumiremos que todo está en <code><i>esp</i>/</code>.</div>
<h3><span class="mw-headline" id="Utilizar_un_gestor_de_arranque">Utilizar un gestor de arranque</span></h3>
<p>Existen varios gestores de arranque UEFI que pueden proporcionar opciones adicionales o simplificar el proceso de arranque UEFI —especialmente si tiene múltiples kernels/sistemas operativos—. Vea <a href="/title/Arch_boot_process_(Espa%C3%B1ol)#Gestor_de_arranque" title="Arch boot process (Español)">Arch boot process (Español)#Gestor de arranque</a> para más información.
</p>
<p>Es posible lanzar un kernel EFISTUB desde el intérprete de órdenes de UEFI como si fuera una aplicación normal UEFI. En este caso, los parámetros del kernel se pasan como parámetros normales al archivo del kernel EFISTUB lanzado.
</p>
<pre>&gt; fs0:
&gt; \vmlinuz-linux root=PARTUUID=3518bb68-d01e-45c9-b973-0b5d918aae96 rw initrd=\initramfs-linux.img
</pre>
<p>Para evitar tener que recordar todos los parámetros del kernel una y otra vez, puede guardar la orden ejecutable como un script de intérprete de órdenes (por ejemplo, como <code>archlinux.nsh</code>) en la partición del sistema UEFI, luego ejecútelo con:
</p>
<pre>&gt; fs0:
&gt; archlinux
</pre>
<h3><span class="mw-headline" id="Utilizar_directamente_UEFI">Utilizar directamente UEFI</span></h3>
<p>UEFI está  diseñado para eliminar la necesidad de tener un gestor de arranque intermediario como, por ejemplo, <a href="/title/GRUB_(Espa%C3%B1ol)" title="GRUB (Español)">GRUB (Español)</a>. Si su placa base tiene una buena implementación UEFI, es posible incluir los parámetros del kernel dentro de una entrada de arranque UEFI para que la placa base arranque Arch directamente. Puede utilizar <code>efibootmgr</code> o UEFI Shell v2 para modificar las entradas de arranque de su placa base (para que incluya a Arch).
</p>
<h4><span class="mw-headline" id="efibootmgr">efibootmgr</span></h4>
<p>La orden sería como sigue:
</p>
<pre># efibootmgr --disk <i>/dev/sdX</i> --part <i>Y</i> --create --label "Arch Linux" --loader /vmlinuz-linux --unicode 'root=PARTUUID=<i>XXXXXXXX-XXXX-XXXX-XXXX-XXXXXXXXXXXX</i> rw initrd=\initramfs-linux.img' --verbose
</pre>
<p>Donde <code><i>/dev/sdX</i></code> and <code><i>Y</i></code> se deben cambiar para reflejar el disco y la partición donde se encuentra la ESP. Cambie el parámetro <code>root=</code> para reflejar la raiz de Linux. Tenga en cuenta que el argumento <code>-u</code>/<code>--unicode</code> entre comillas es solo un ejemplo de la lista de los <a href="/title/Kernel_parameters_(Espa%C3%B1ol)" title="Kernel parameters (Español)">parámetros del kernel</a>, por lo que es posible que deba agregar parámetros adicionales (por ejemplo, para <a href="/title/Suspend_and_hibernate#Required_kernel_parameters" class="mw-redirect" title="Suspend and hibernate">suspender en disco</a> o <a href="/title/Microcode_(Espa%C3%B1ol)" title="Microcode (Español)">Microcode (Español)</a>).
</p>
<div class="archwiki-template-box archwiki-template-box-tip">
<strong>Sugerencia:</strong> guarde la orden para crear su entrada de arranque en un script de intérprete de órdenes en algún lugar, lo que facilitará su modificación (por ejemplo, al cambiar los parámetros del kernel</div>
<p>Después de agregar la entrada de inicio, puede verificar que dicha entrada se añadió correctamente con:
</p>
<pre># efibootmgr --verbose
</pre>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Nota:</strong> algunas combinaciones de kernel y <code>efibootmgr</code> podrían negarse a crear nuevas entradas de inicio. Esto podría ser debido a la falta de espacio libre en la memoria NVRAM. Podría tratar de eliminar cualquier archivo de volcado de EFI:
<pre># rm /sys/firmware/efi/efivars/dump-*
</pre>
O, como último recurso, arrancar con el parámetro del kermel <code>efi_no_storage_paranoia</code>. También puede intentar degradar su instalación de efibootmgr a la versión 0.11.0 si la tiene disponible en su memoria caché. Esta versión funciona con la versión 4.0.6 de Linux. Véase el bug de la discusión <a rel="nofollow" class="external text" href="https://bugs.archlinux.org/task/34641">FS#34641</a> para más información.</div>
<p>Para establecer el orden de arranque, ejecute:
</p>
<pre># efibootmgr --bootorder <i>XXXX</i>,<i>XXXX</i> --verbose
</pre>
<p>donde <i>XXXX</i> es el número que aparece en la salida de la orden <code>efibootmgr</code> de cada entrada.
</p>
<p>Más información sobre efibootmgr en <a href="/title/Unified_Extensible_Firmware_Interface_(Espa%C3%B1ol)#efibootmgr" title="Unified Extensible Firmware Interface (Español)">Unified Extensible Firmware Interface (Español)#efibootmgr</a>. Publicación del foro: <a rel="nofollow" class="external free" href="https://bbs.archlinux.org/viewtopic.php?pid=1090040#p1090040">https://bbs.archlinux.org/viewtopic.php?pid=1090040#p1090040</a> .
</p>
<h4><span class="mw-headline" id="efibootmgr_con_el_archivo_.efi">efibootmgr con el archivo .efi</span></h4>
<p>Si usa <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://aur.archlinux.org/packages/cryptboot/">cryptboot</a></span><sup><small>AUR</small></sup> y <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://aur.archlinux.org/packages/sbupdate-git/">sbupdate-git</a></span><sup><small>AUR</small></sup> para generar sus propias claves para <a href="/title/Secure_Boot#Using_your_own_keys" class="mw-redirect" title="Secure Boot">Secure Boot</a> y firma con ellas initramfs y el kernel, cree, luego, una imagen <i>.efi</i> de arranque, <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=efibootmgr">efibootmgr</a></span> puede usarse directamente para arrancar el archivo  <i>.efi</i> file:
</p>
<pre># efibootmgr --create --disk /dev/sdX --part <i>partition_number</i> --label "<i>label</i>" --loader "EFI\<i>folder</i>\<i>file</i>.efi" --verbose
</pre>
<p>Véase <span class="plainlinks archwiki-template-man" title="$ man 8 efibootmgr"><a rel="nofollow" class="external text" href="https://man.archlinux.org/man/efibootmgr.8">efibootmgr(8)</a></span> para obtener una explicación de las opciones.
</p>
<h4>
<span id="Int.C3.A9rprete_de_.C3.B3rdenes_de_UEFI"></span><span class="mw-headline" id="Intérprete_de_órdenes_de_UEFI">Intérprete de órdenes de UEFI</span>
</h4>
<p>Algunas implementaciones de UEFI hacen que sea difícil modificar la NVRAM con éxito usando efibootmgr. Si efibootmgr no puede crear una entrada con éxito, puede usar la orden <a href="/title/UEFI#bcfg" class="mw-redirect" title="UEFI">bcfg</a> en UEFI Shell v2 (es decir, desde la imagen iso live de Arch Linux).
</p>
<p>Primero, averigüe el número de dispositivo donde reside la <a href="/title/EFI_system_partition_(Espa%C3%B1ol)" title="EFI system partition (Español)">EFI system partition (Español)</a>, usando:
</p>
<pre>Shell&gt; map
</pre>
<p>En este ejemplo, <code>1</code> se utiliza como número de dispositivo. Para listar los contenidos de <a href="/title/EFI_system_partition_(Espa%C3%B1ol)" title="EFI system partition (Español)">EFI system partition (Español)</a> escriba:
</p>
<pre>Shell&gt; ls fs1:
</pre>
<p>Para ver las entradas de arranque actuales escriba:
</p>
<pre>Shell&gt; bcfg boot dump
</pre>
<p>Para agregar una entrada para el kernel, utilice:
</p>
<pre>Shell&gt; bcfg boot add <i>N</i> fs1:\vmlinuz-linux "Arch Linux"
</pre>
<p>donde <code><i>N</i></code> es la ubicación donde se agregará la entrada en el menú de inicio. 0 es el primer elemento del menú. Los elementos de menú ya existentes se desplazarán en el menú sin que se descarten.
</p>
<p>Para agregar las opciones de kernel necesarias, primero cree un archivo en la ESP:
</p>
<pre>Shell&gt; edit fs1:\options.txt
</pre>
<p>En el archivo agregue la línea de arranque. Por ejemplo:
</p>
<pre>root=/dev/sda2 ro initrd=\initramfs-linux.img
</pre>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Nota:</strong> añada espacios adicionales al principio de la línea en el archivo. Hay una marca de demanda de bytes al principio de la línea que captará cualquier carácter que esté a su lado, lo que causará un error al iniciar.</div>
<p>Presione <code>F2</code> para guardar y luego <code>F3</code> para salir.
</p>
<p>Para agregar estas opciones a su entrada anterior, haga lo siguiente:
</p>
<pre>Shell&gt; bcfg boot -opt <i>N</i> fs1:\options.txt
</pre>
<p>Repita este proceso para cualquier entrada adicional.
</p>
<p>Para eliminar un elemento previamente agregado, escriba:
</p>
<pre>Shell&gt; bcfg boot rm <i>N</i>
</pre>
<h4><span class="mw-headline" id="Utilizar_un_script_startup.nsh">Utilizar un script startup.nsh</span></h4>
<p>Algunas implementaciones de UEFI no retienen las variables de EFI entre los arranques en frío (por ejemplo, <a href="/title/VirtualBox_(Espa%C3%B1ol)" title="VirtualBox (Español)">VirtualBox (Español)</a>) y cualquier cosa que se haya configurado a través de la interfaz del firmware de UEFI se perderá durante el apagado.
</p>
<p>La <a rel="nofollow" class="external text" href="https://www.uefi.org/sites/default/files/resources/UEFI_Shell_Spec_2_0.pdf">UEFI Shell Specification 2.0</a> establece que un script llamado <code>startup.nsh</code> en la raíz de la partición de ESP siempre debe interpretarse y puede contener instrucciones arbitrarias; entre las que se puede establecer una línea de carga de arranque. Asegúrese de montar la partición ESP en <code>/boot</code> y cree un script <code>startup.nsh</code> que contenga una línea de carga de arranque del kernel. Por ejemplo:
</p>
<pre>vmlinuz-linux rw root=/dev/sdX [rootfs=myfs] [rootflags=myrootflags] \
 [kernel.flag=foo] [mymodule.flag=bar] \
 [initrd=\intel-ucode.img] initrd=\initramfs-linux.img
</pre>
<p>Este método funcionará con casi todas las versiones de firmware UEFI que pueda encontrar en hardware real, por lo que puede usarlo como último recurso. <b>El script debe ser una única línea larga.</b> Las secciones entre paréntesis son opcionales y se ofrecen solo como una guía. Los saltos de línea de estilo shell son solo para clarificación visual. Los sistemas de archivos FAT utilizan la barra invertida como separador de ruta y, en este caso, la barra diagonal inversa declara que el initramfs se encuentra en la raíz de la partición ESP. Solo se carga el microcódigo de Intel en la línea de parámetros de arranque; El microcódigo de AMD se lee del disco más tarde durante el proceso de arranque; Esto se hace automáticamente por el kernel.
</p>
<h2>
<span id="V.C3.A9ase_tambi.C3.A9n"></span><span class="mw-headline" id="Véase_también">Véase también</span>
</h2>
<ul>
<li><a rel="nofollow" class="external text" href="https://www.kernel.org/doc/Documentation/efi-stub.txt">Linux Kernel Documentation on EFISTUB</a></li>
<li><a rel="nofollow" class="external text" href="https://git.kernel.org/?p=linux/kernel/git/torvalds/linux.git;a=commitdiff;h=291f36325f9f252bd76ef5f603995f37e453fc60;hp=55839d515495e766605d7aaabd9c2758370a8d27">Linux Kernel EFISTUB Git Commit</a></li>
<li><a rel="nofollow" class="external text" href="https://www.rodsbooks.com/efi-bootloaders/efistub.html">Rod Smith's page on EFISTUB</a></li>
</ul>
</div>
</div>
<div id="catlinks" class="catlinks" data-mw="interface"><div id="mw-normal-catlinks" class="mw-normal-catlinks">
<a href="/title/Special:Categories" title="Special:Categories">Category</a>: <ul><li><a href="/title/Category:Boot_loaders_(Espa%C3%B1ol)" title="Category:Boot loaders (Español)">Boot loaders (Español)</a></li></ul>
</div></div>
	</div>
</div>

<footer id="footer" class="mw-footer" role="contentinfo" style="margin: 0">
	<ul id="footer-info">
		<li>Retrieved from "<a dir="ltr" href="https://wiki.archlinux.org/index.php?title=EFISTUB_(Espa%C3%B1ol)&amp;oldid=668696">https://wiki.archlinux.org/index.php?title=EFISTUB_(Español)&amp;oldid=668696</a>"</li>
		<li id="footer-info-lastmod"> This page was last edited on 8 May 2021, at 10:38.</li>
		<li id="footer-info-copyright">Content is available under <a class="external" rel="nofollow" href="http://www.gnu.org/copyleft/fdl.html">GNU Free Documentation License 1.3 or later</a> unless otherwise noted.</li>
	<br>
</ul>
	<ul id="footer-places">
		<li id="footer-places-privacy"><a href="/title/ArchWiki:Privacy_policy" title="ArchWiki:Privacy policy">Privacy policy</a></li>
		<li id="footer-places-about"><a href="/title/ArchWiki:About" title="ArchWiki:About">About ArchWiki</a></li>
		<li id="footer-places-disclaimer"><a href="/title/ArchWiki:General_disclaimer" title="ArchWiki:General disclaimer">Disclaimers</a></li>
	</ul>
	<ul id="footer-icons" class="noprint">
		<li id="footer-copyrightico">
	</ul>
	<div style="clear: both;"></div>
</footer>



</body>
</html>
