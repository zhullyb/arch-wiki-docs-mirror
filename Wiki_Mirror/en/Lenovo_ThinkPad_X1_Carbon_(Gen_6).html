<!DOCTYPE html>
<html class="client-nojs" lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<title>Lenovo ThinkPad X1 Carbon (Gen 6) - ArchWiki</title>
<link rel="stylesheet" href="../ArchWikiOffline.css">
<meta name="ResourceLoaderDynamicStyles" content="">
<meta name="generator" content="MediaWiki 1.35.0">
<meta name="referrer" content="no-referrer-when-downgrade">
<meta name="robots" content="noindex,follow">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="shortcut icon" href="/favicon.ico">
<link rel="search" type="application/opensearchdescription+xml" href="/opensearch_desc.php" title="ArchWiki (en)">
<link rel="EditURI" type="application/rsd+xml" href="https://wiki.archlinux.org/api.php?action=rsd">
<link rel="license" href="http://www.gnu.org/copyleft/fdl.html">
<link rel="alternate" type="application/atom+xml" title="ArchWiki Atom feed" href="/index.php?title=Special:RecentChanges&amp;feed=atom">
</head>
<body class="mediawiki ltr sitedir-ltr mw-hide-empty-elt ns-0 ns-subject page-Lenovo_ThinkPad_X1_Carbon_Gen_6 rootpage-Lenovo_ThinkPad_X1_Carbon_Gen_6 skin-vector action-view skin-vector-legacy">
<div id="content" class="mw-body" role="main" style="margin: 0">
	<a id="top"></a>
	<div id="siteNotice" class="mw-body-content"></div>
	<div class="mw-indicators mw-body-content">
	</div>
	<h1 id="firstHeading" class="firstHeading" lang="en">Lenovo ThinkPad X1 Carbon (Gen 6)</h1>
	<div id="bodyContent" class="mw-body-content">
		<div id="siteSub" class="noprint">From ArchWiki</div>
		<div id="contentSub"></div>
		<div id="contentSub2"></div>
		
		<div id="jump-to-nav"></div>
		<a class="mw-jump-link" href="#mw-head">Jump to navigation</a>
		<a class="mw-jump-link" href="#searchInput">Jump to search</a>
		<div id="mw-content-text" lang="en" dir="ltr" class="mw-content-ltr">
<div class="warningbox">The printable version is no longer supported and may have rendering errors. Please update your browser bookmarks and please use the default browser print function instead.</div>
<div class="mw-parser-output">
<div class="archwiki-template-meta-related-articles-start">
<p>Related articles</p>
<ul>
<li><a href="../en/Lenovo_ThinkPad_X1_Carbon.html" title="Lenovo ThinkPad X1 Carbon">Lenovo ThinkPad X1 Carbon</a></li>
<li><a href="../en/Lenovo_ThinkPad_X1_Carbon_(Gen_2).html" title="Lenovo ThinkPad X1 Carbon (Gen 2)">Lenovo ThinkPad X1 Carbon (Gen 2)</a></li>
<li><a href="../en/Lenovo_ThinkPad_X1_Carbon_(Gen_3).html" title="Lenovo ThinkPad X1 Carbon (Gen 3)">Lenovo ThinkPad X1 Carbon (Gen 3)</a></li>
<li><a href="../en/Lenovo_ThinkPad_X1_Carbon_(Gen_4).html" title="Lenovo ThinkPad X1 Carbon (Gen 4)">Lenovo ThinkPad X1 Carbon (Gen 4)</a></li>
<li><a href="../en/Lenovo_ThinkPad_X1_Carbon_(Gen_5).html" title="Lenovo ThinkPad X1 Carbon (Gen 5)">Lenovo ThinkPad X1 Carbon (Gen 5)</a></li>
<li><a href="../en/Lenovo_ThinkPad_X1_Carbon_(Gen_7).html" title="Lenovo ThinkPad X1 Carbon (Gen 7)">Lenovo ThinkPad X1 Carbon (Gen 7)</a></li>
<li><a href="../en/Lenovo_ThinkPad_X1_Carbon_(Gen_8).html" title="Lenovo ThinkPad X1 Carbon (Gen 8)">Lenovo ThinkPad X1 Carbon (Gen 8)</a></li>
<li><a href="../en/Lenovo_ThinkPad_X1_Yoga_(Gen_3).html" title="Lenovo ThinkPad X1 Yoga (Gen 3)">Lenovo ThinkPad X1 Yoga (Gen 3)</a></li>
</ul>
</div>
<div class="archwiki-template-box archwiki-template-box-tip">
<strong>Tip:</strong>  A great resource for thinkpads is <a rel="nofollow" class="external free" href="https://www.thinkwiki.org/wiki/ThinkWiki">https://www.thinkwiki.org/wiki/ThinkWiki</a>
</div>
<p>The Lenovo ThinkPad X1 Carbon, 6th generation is an ultrabook introduced in early 2018. It comes in several variants(<code>20KH*</code> and <code>20KG*</code>) and features a 14" screen, 8th-gen Intel Core processors and integrated <a href="../en/Intel_graphics.html" title="Intel graphics">Intel UHD 620 graphics</a>.
</p>
<p>To ensure you have this version, <a href="../en/Help:Reading.html#Installation_of_packages" class="mw-redirect" title="Install">install</a> the package <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=dmidecode">dmidecode</a></span> and run:
</p>
<pre># dmidecode -s system-version
ThinkPad X1 Carbon 6th
</pre>
<table class="wikitable" style="float: right; clear: right; margin: 0 0 0.5em 0.5em; max-width: 420px; width: 100%;">
<tbody>
<tr>
<th>Device</th>
<th>Working?</th>
<th>Modules
</th>
</tr>
<tr>
<td><a href="../en/Intel_graphics.html" title="Intel graphics">Intel graphics</a></td>
<td data-sort-value="5" style="background: #afa; color: inherit; vertical-align: middle; text-align: center;">Yes</td>
<td>i915, (intel_agp)
</td>
</tr>
<tr>
<td><a href="../en/Network_configuration/Wireless.html#iwlwifi" class="mw-redirect" title="Wireless network configuration">Wireless network</a></td>
<td data-sort-value="5" style="background: #afa; color: inherit; vertical-align: middle; text-align: center;">Yes</td>
<td>iwlmvm
</td>
</tr>
<tr>
<td>Native Ethernet with <a rel="nofollow" class="external text" href="https://www3.lenovo.com/us/en/accessories-and-monitors/cables-and-adapters/adapters/CABLE-BO-TP-OneLink%2B-to-RJ45-Adapter/p/4X90K06975">included dongle</a>
</td>
<td data-sort-value="5" style="background: #afa; color: inherit; vertical-align: middle; text-align: center;">Yes</td>
<td>?
</td>
</tr>
<tr>
<td>Mobile broadband Fibocom L850-GL</td>
<td data-sort-value="5" style="background: #afa; color: inherit; vertical-align: middle; text-align: center;">Yes¹</td>
<td>cdc_mbim after MBIM-switch (from PCIe)
</td>
</tr>
<tr>
<td>Mobile broadband Sierra EM7455</td>
<td data-sort-value="5" style="background: #afa; color: inherit; vertical-align: middle; text-align: center;">Yes</td>
<td>cdc_mbim, cdc_wcm, cdc_ncm
</td>
</tr>
<tr>
<td>Audio</td>
<td data-sort-value="5" style="background: #afa; color: inherit; vertical-align: middle; text-align: center;">Yes</td>
<td>snd_hda_intel
</td>
</tr>
<tr>
<td><a href="../en/Laptop.html#Touchpad" class="mw-redirect" title="Touchpad">Touchpad</a></td>
<td data-sort-value="5" style="background: #afa; color: inherit; vertical-align: middle; text-align: center;">Yes</td>
<td>psmouse, rmi_smbus, i2c_i801
</td>
</tr>
<tr>
<td><a href="../en/TrackPoint.html" title="TrackPoint">TrackPoint</a></td>
<td data-sort-value="5" style="background: #afa; color: inherit; vertical-align: middle; text-align: center;">Yes</td>
<td>psmouse, rmi_smbus, i2c_i801
</td>
</tr>
<tr>
<td>Camera</td>
<td data-sort-value="5" style="background: #afa; color: inherit; vertical-align: middle; text-align: center;">Yes</td>
<td>uvcvideo
</td>
</tr>
<tr>
<td>Fingerprint Reader</td>
<td data-sort-value="5" style="background: #afa; color: inherit; vertical-align: middle; text-align: center;">Yes²</td>
<td>?
</td>
</tr>
<tr>
<td><a href="../en/Power_management.html" title="Power management">Power management</a></td>
<td data-sort-value="5" style="background: #afa; color: inherit; vertical-align: middle; text-align: center;">Yes³</td>
<td>?
</td>
</tr>
<tr>
<td><a href="../en/Bluetooth.html" title="Bluetooth">Bluetooth</a></td>
<td data-sort-value="5" style="background: #afa; color: inherit; vertical-align: middle; text-align: center;">Yes⁴</td>
<td>btusb
</td>
</tr>
<tr>
<td>NFC</td>
<td data-sort-value="1" style="background: #faa; color: inherit; vertical-align: middle; text-align: center;">No⁶</td>
<td>?
</td>
</tr>
<tr>
<td>microSD card reader</td>
<td data-sort-value="5" style="background: #afa; color: inherit; vertical-align: middle; text-align: center;">Yes</td>
<td>scsi_mod
</td>
</tr>
<tr>
<td>Keyboard Backlight</td>
<td data-sort-value="5" style="background: #afa; color: inherit; vertical-align: middle; text-align: center;">Yes</td>
<td>thinkpad_acpi
</td>
</tr>
<tr>
<td>Function/Multimedia Keys</td>
<td data-sort-value="5" style="background: #afa; color: inherit; vertical-align: middle; text-align: center;">Yes</td>
<td>?
</td>
</tr>
<tr>
<td>Thunderbolt 3 eGPU</td>
<td data-sort-value="5" style="background: #afa; color: inherit; vertical-align: middle; text-align: center;">Yes⁵</td>
<td>nvidia
</td>
</tr>
<tr>
<td colspan="3" style="font-size: 70%; border: none;"><ol>
<li>
<s>No working Linux driver for Fibocom L850-GL. See <a rel="nofollow" class="external text" href="https://forums.lenovo.com/t5/Linux-Discussion/X1C-gen-6-Fibocom-L850-GL-Ubuntu-18-04/m-p/4078413">this thread</a> and <a rel="nofollow" class="external text" href="https://forums.lenovo.com/t5/Linux-Discussion/Linux-support-for-WWAN-LTE-L850-GL-on-T580-T480/td-p/4067969">this thread</a> for more info.</s> <a rel="nofollow" class="external text" href="https://github.com/abrasive/xmm7360">MBIM-Switch</a><br><a rel="nofollow" class="external text" href="https://github.com/juhovh/xmm7360_usb">kernel-module</a><br><a rel="nofollow" class="external text" href="https://forums.lenovo.com/t5/Other-Linux-Discussions/WWAN-Fibocom-L850-GL-and-Linux-support/td-p/4318903">Discussion</a>
</li>
<li>The <a rel="nofollow" class="external text" href="https://aur.archlinux.org/packages/python-validity-git/">python-validity</a> driver available via AUR allows to use the fingerprint reader as usual using fprintd.</li>
<li>S3 suspend requires changes to BIOS settings - see section on <a href="#Suspend_issues">suspend issues</a>.</li>
<li>See <a rel="nofollow" class="external text" href="https://200ok.ch/posts/2018-12-17_making_bluetooth_work_on_lenovo_x1_carbon_6th_gen_with_linux.html">this blog post</a> for improvements to reliability.</li>
<li>Internal monitor acceleration does not appear to be supported.</li>
<li>Connected via I2C, support was discussed in the <a rel="nofollow" class="external text" href="https://github.com/nfc-tools/libnfc/issues/455">libnfc project</a>.</li>
</ol></td>
</tr>
</tbody>
</table>
<p><br>
</p>
<div id="toc" class="toc" role="navigation" aria-labelledby="mw-toc-heading">
<input type="checkbox" role="button" id="toctogglecheckbox" class="toctogglecheckbox" style="display:none"><div class="toctitle" lang="en" dir="ltr">
<h2 id="mw-toc-heading">Contents</h2>
<span class="toctogglespan"><label class="toctogglelabel" for="toctogglecheckbox"></label></span>
</div>
<ul>
<li class="toclevel-1 tocsection-1">
<a href="#BIOS"><span class="tocnumber">1</span> <span class="toctext">BIOS</span></a>
<ul>
<li class="toclevel-2 tocsection-2">
<a href="#Updates"><span class="tocnumber">1.1</span> <span class="toctext">Updates</span></a>
<ul>
<li class="toclevel-3 tocsection-3"><a href="#Automatic_(Linux_Vendor_Firmware_Service)"><span class="tocnumber">1.1.1</span> <span class="toctext">Automatic (Linux Vendor Firmware Service)</span></a></li>
<li class="toclevel-3 tocsection-4"><a href="#Manual_(fwupdmgr)"><span class="tocnumber">1.1.2</span> <span class="toctext">Manual (fwupdmgr)</span></a></li>
<li class="toclevel-3 tocsection-5"><a href="#Manual_(El_Torito)"><span class="tocnumber">1.1.3</span> <span class="toctext">Manual (El Torito)</span></a></li>
</ul>
</li>
</ul>
</li>
<li class="toclevel-1 tocsection-6"><a href="#Battery_Stats_and_Charge_Limit"><span class="tocnumber">2</span> <span class="toctext">Battery Stats and Charge Limit</span></a></li>
<li class="toclevel-1 tocsection-7">
<a href="#Suspend_issues"><span class="tocnumber">3</span> <span class="toctext">Suspend issues</span></a>
<ul>
<li class="toclevel-2 tocsection-8"><a href="#Enabling_S3"><span class="tocnumber">3.1</span> <span class="toctext">Enabling S3</span></a></li>
<li class="toclevel-2 tocsection-9"><a href="#Verifying_S3"><span class="tocnumber">3.2</span> <span class="toctext">Verifying S3</span></a></li>
<li class="toclevel-2 tocsection-10"><a href="#S3_Suspend_Bug_with_Bluetooth_Devices"><span class="tocnumber">3.3</span> <span class="toctext">S3 Suspend Bug with Bluetooth Devices</span></a></li>
<li class="toclevel-2 tocsection-11"><a href="#Disabling_the_memory_card_reader"><span class="tocnumber">3.4</span> <span class="toctext">Disabling the memory card reader</span></a></li>
<li class="toclevel-2 tocsection-12"><a href="#BIOS_configurations"><span class="tocnumber">3.5</span> <span class="toctext">BIOS configurations</span></a></li>
<li class="toclevel-2 tocsection-13"><a href="#Failed_to_start_Suspend"><span class="tocnumber">3.6</span> <span class="toctext">Failed to start Suspend</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-14">
<a href="#Power_management/Throttling_issues"><span class="tocnumber">4</span> <span class="toctext">Power management/Throttling issues</span></a>
<ul>
<li class="toclevel-2 tocsection-15"><a href="#Throttling_fix_in_thermald"><span class="tocnumber">4.1</span> <span class="toctext">Throttling fix in <span>thermald</span></span></a></li>
<li class="toclevel-2 tocsection-16"><a href="#Alternative_workarounds"><span class="tocnumber">4.2</span> <span class="toctext">Alternative workarounds</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-17"><a href="#Audio_crackling"><span class="tocnumber">5</span> <span class="toctext">Audio crackling</span></a></li>
<li class="toclevel-1 tocsection-18"><a href="#Microphone_distorted_due_to_automatic_adjustment"><span class="tocnumber">6</span> <span class="toctext">Microphone distorted due to automatic adjustment</span></a></li>
<li class="toclevel-1 tocsection-19"><a href="#Built-in_speakers_low_volume_workaround"><span class="tocnumber">7</span> <span class="toctext">Built-in speakers low volume workaround</span></a></li>
<li class="toclevel-1 tocsection-20">
<a href="#Wireless_WAN_/_LTE"><span class="tocnumber">8</span> <span class="toctext">Wireless WAN / LTE</span></a>
<ul>
<li class="toclevel-2 tocsection-21"><a href="#WWAN/LTE_GUI"><span class="tocnumber">8.1</span> <span class="toctext">WWAN/LTE GUI</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-22">
<a href="#Configuration"><span class="tocnumber">9</span> <span class="toctext">Configuration</span></a>
<ul>
<li class="toclevel-2 tocsection-23"><a href="#Keyboard_Fn_Shortcuts"><span class="tocnumber">9.1</span> <span class="toctext">Keyboard Fn Shortcuts</span></a></li>
<li class="toclevel-2 tocsection-24"><a href="#Special_buttons"><span class="tocnumber">9.2</span> <span class="toctext">Special buttons</span></a></li>
<li class="toclevel-2 tocsection-25"><a href="#Disabling_red_LED_in_Thinkpad_logo"><span class="tocnumber">9.3</span> <span class="toctext">Disabling red LED in Thinkpad logo</span></a></li>
<li class="toclevel-2 tocsection-26"><a href="#HDR_Display_Color_Calibration"><span class="tocnumber">9.4</span> <span class="toctext">HDR Display Color Calibration</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-27">
<a href="#Intel_Graphics_UHD_620_issues"><span class="tocnumber">10</span> <span class="toctext">Intel Graphics UHD 620 issues</span></a>
<ul>
<li class="toclevel-2 tocsection-28"><a href="#GNOME_Wayland_not_available"><span class="tocnumber">10.1</span> <span class="toctext">GNOME Wayland not available</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-29"><a href="#TrackPoint_and_Touchpad_issues"><span class="tocnumber">11</span> <span class="toctext">TrackPoint and Touchpad issues</span></a></li>
<li class="toclevel-1 tocsection-30">
<a href="#Thunderbolt_dock"><span class="tocnumber">12</span> <span class="toctext">Thunderbolt dock</span></a>
<ul>
<li class="toclevel-2 tocsection-31">
<a href="#Plugable_USB-C_Mini_Docking_Station_with_85W_Power_Delivery_UD-CAM"><span class="tocnumber">12.1</span> <span class="toctext">Plugable USB-C Mini Docking Station with 85W Power Delivery UD-CAM</span></a>
<ul>
<li class="toclevel-3 tocsection-32"><a href="#Bios_settings"><span class="tocnumber">12.1.1</span> <span class="toctext">Bios settings</span></a></li>
<li class="toclevel-3 tocsection-33"><a href="#TLP_blacklisting_devices_from_USB_autosuspend"><span class="tocnumber">12.1.2</span> <span class="toctext">TLP blacklisting devices from USB autosuspend</span></a></li>
</ul>
</li>
<li class="toclevel-2 tocsection-34"><a href="#Lenovo_dock"><span class="tocnumber">12.2</span> <span class="toctext">Lenovo dock</span></a></li>
<li class="toclevel-2 tocsection-35"><a href="#DisplayLink"><span class="tocnumber">12.3</span> <span class="toctext">DisplayLink</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-36">
<a href="#Full-disk_encryption"><span class="tocnumber">13</span> <span class="toctext">Full-disk encryption</span></a>
<ul>
<li class="toclevel-2 tocsection-37"><a href="#LUKS:_Ramdisk_module"><span class="tocnumber">13.1</span> <span class="toctext">LUKS: Ramdisk module</span></a></li>
<li class="toclevel-2 tocsection-38"><a href="#OPAL:_Hardware_based_full-disk_encryption"><span class="tocnumber">13.2</span> <span class="toctext">OPAL: Hardware based full-disk encryption</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-39">
<a href="#Tools"><span class="tocnumber">14</span> <span class="toctext">Tools</span></a>
<ul>
<li class="toclevel-2 tocsection-40"><a href="#Diagnostics"><span class="tocnumber">14.1</span> <span class="toctext">Diagnostics</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-41"><a href="#nvme_issues"><span class="tocnumber">15</span> <span class="toctext">nvme issues</span></a></li>
<li class="toclevel-1 tocsection-42"><a href="#References"><span class="tocnumber">16</span> <span class="toctext">References</span></a></li>
<li class="toclevel-1 tocsection-43"><a href="#Additional_resources"><span class="tocnumber">17</span> <span class="toctext">Additional resources</span></a></li>
</ul>
</div>

<h2><span class="mw-headline" id="BIOS">BIOS</span></h2>
<p>The most convenient way to install Arch Linux is by disabling "Secure Boot" <code>Security -&gt; Secure Boot - Set to "Disabled"</code>. However it is possible to self-sign your kernel and boot with it enabled. For further information, have a look at the <a href="../en/Unified_Extensible_Firmware_Interface/Secure_Boot.html" class="mw-redirect" title="Secure Boot">Secure Boot</a> article.
</p>
<p>In case your <code>efivars</code> are not properly set it is most likely due to you not being booted into <a href="../en/Unified_Extensible_Firmware_Interface.html" class="mw-redirect" title="UEFI">UEFI</a>. Should the problem persist be sure to consult the <a href="../en/Unified_Extensible_Firmware_Interface.html#UEFI_variables" class="mw-redirect" title="UEFI">UEFI#UEFI variables</a> section.
</p>
<h3><span class="mw-headline" id="Updates">Updates</span></h3>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Note:</strong> In the BIOS setup menu under <code>Security -&gt; UEFI BIOS Update Option</code>, both <code>Flash BIOS Updating by End-Users</code> and <code>Windows UEFI Firmware Update</code> <a rel="nofollow" class="external text" href="https://github.com/fwupd/fwupd/issues/856#issuecomment-440967709">must be enabled</a> at the time of an update.</div>
<h4>
<span id="Automatic_.28Linux_Vendor_Firmware_Service.29"></span><span class="mw-headline" id="Automatic_(Linux_Vendor_Firmware_Service)">Automatic (Linux Vendor Firmware Service)</span>
</h4>
<p><a rel="nofollow" class="external text" href="https://blogs.gnome.org/hughsie/2018/08/06/please-welcome-lenovo-to-the-lvfs/">In August of 2018 Lenovo has joined</a> the <a rel="nofollow" class="external text" href="https://fwupd.org/">Linux Vendor Firmware Service(LVFS)</a> project, which enables firmware updates from within the OS.
BIOS updates (and other firmware such as the Thunderbolt controller) can be queried for and installed through <a href="../en/Fwupd.html" title="Fwupd">fwupd</a>.
</p>
<h4>
<span id="Manual_.28fwupdmgr.29"></span><span class="mw-headline" id="Manual_(fwupdmgr)">Manual (fwupdmgr)</span>
</h4>
<p>Lenovo provides a cabinet file that can be directly installed with fwupdmgr.
Take the most recent <code>.cab</code> file from the <a rel="nofollow" class="external text" href="https://pcsupport.lenovo.com/fr/en/products/laptops-and-netbooks/thinkpad-x-series-laptops/thinkpad-x1-carbon-6th-gen-type-20kh-20kg/downloads">Lenovo ThinkPad X1 Carbon (Gen 6) driver website</a>.
</p>
<ol>
<li>Make sure the AC adapter is firmly connected to the target computer.</li>
<li>Launch Terminal.</li>
<li>Move to the directory where the cabinet file was placed.</li>
<li>Run <code>fwupdmgr install xxxxxxxx.cab</code> to schedule firmware update.</li>
<li>Restart the system.</li>
<li>The computer will be restarted and the UEFI BIOS will be updated.</li>
</ol>
<h4>
<span id="Manual_.28El_Torito.29"></span><span class="mw-headline" id="Manual_(El_Torito)">Manual (El Torito)</span>
</h4>
<p>Download the <a rel="nofollow" class="external text" href="https://pcsupport.lenovo.com/fr/en/products/LAPTOPS-AND-NETBOOKS/THINKPAD-X-SERIES-LAPTOPS/THINKPAD-X1-CARBON-6TH-GEN-TYPE-20KH-20KG/downloads/DS502281">latest BIOS update ISO</a>. Obtain <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://aur.archlinux.org/packages/geteltorito/">geteltorito</a></span><sup><small>AUR</small></sup> and run <code>geteltorito.pl -o bios-update.img n23ur12w.iso</code> on the downloaded ISO file to create a valid <a href="https://en.wikipedia.org/wiki/El_Torito_(CD-ROM_standard)" class="extiw" title="wikipedia:El Torito (CD-ROM standard)">El Torito</a> image file, then flash this file on a USB drive via <code>dd</code> like you would flash <a href="../en/USB_flash_installation_medium.html" class="mw-redirect" title="USB flash installation media">Arch installation media</a>. For further information see <a href="../en/Flashing_BIOS_from_Linux.html#Bootable_optical_disk_emulation" title="Flashing BIOS from Linux">flashing BIOS from Linux</a>.
</p>
<p>The ThinkPad X1 Carbon supports setting a custom splash image at the earliest boot stage (instead of the red "Lenovo" logo), more information can be found in the <code>README.TXT</code> located in the <code>FLASH</code> folder of the update image. This only needs to be done once, as subsequent UEFI upgrades will ask whether you wish to keep your custom logo.
</p>
<p>Once the USB drive is flashed, the logo file can be placed in to the root directory of the flash drive.
</p>
<h2><span class="mw-headline" id="Battery_Stats_and_Charge_Limit">Battery Stats and Charge Limit</span></h2>
<p><a href="../en/Help:Reading.html#Installation_of_packages" class="mw-redirect" title="Install">Install</a> the <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=tlp">tlp</a></span> package and show battery stats from command line:
</p>
<pre>$ sudo tlp-stat -b
</pre>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Note:</strong> <code>cycle_count</code> will show <code>unsupported</code> for a brand new battery until it has completed at least 1 full discharge/charge cycle.</div>
<p>To prolong battery lifetime, you can limit battery charging to a maximum of 80% and start charging only if SoC (state of charge) is below 79%:
</p>
<pre>$ sudo tpacpi-bat -s ST 1 79 # Start charging if battery below 79%
$ sudo tpacpi-bat -s SP 1 80 # Stop charging if battery above 80%
$ sudo tpacpi-bat -s IC 1 0 # Disable charging entirely
</pre>
<p>For making the changes permanent, you can edit <code>/etc/tlp.conf</code>. Please refer to the <a href="../en/TLP.html" title="TLP">TLP</a> article for more information and GUI tools.
</p>
<h2><span class="mw-headline" id="Suspend_issues">Suspend issues</span></h2>
<p>Since BIOS version 1.30, the X1 Carbon supports S3 mode when enabled in the BIOS menu (choose "Linux" sleep mode instead of the default "Windows 10"). See <a href="#Automatic_(Linux_Vendor_Firmware_Service)">#Automatic (Linux Vendor Firmware Service)</a> for instructions to update and verify your BIOS version.
</p>
<h3><span class="mw-headline" id="Enabling_S3">Enabling S3</span></h3>
<p>To enable S3 support, make sure you have at least BIOS version 1.30 installed. Then, go into the BIOS configuration, and <code>Config -&gt; Power -&gt; Sleep State - Set to "Linux"</code>. This should make S3 available. To verify, after making the changes in the BIOS configuration, boot into Linux, and run:
</p>
<pre> dmesg | grep -i "acpi: (supports"
</pre>
<p>to make sure that S3 is now available.
</p>
<h3><span class="mw-headline" id="Verifying_S3">Verifying S3</span></h3>
<p>To check whether S3 is recognized and usable by Linux, run:
</p>
<pre>dmesg | grep -i "acpi: (supports"
</pre>
<p>and check for <code>S3</code> in the list.
</p>
<h3><span class="mw-headline" id="S3_Suspend_Bug_with_Bluetooth_Devices">S3 Suspend Bug with Bluetooth Devices</span></h3>
<p>Occasionally your Thinkpad will wake up immediately or a few seconds after suspending with certain <a href="../en/Bluetooth.html" title="Bluetooth">bluetooth</a> devices added. To prevent this, remove the devices or disable <a href="../en/Bluetooth.html" title="Bluetooth">bluetooth</a> before suspending.
</p>
<h3><span class="mw-headline" id="Disabling_the_memory_card_reader">Disabling the memory card reader</span></h3>
<p>You might also need to disable the Realtek memory card reader (which appears to use a constant 2-3 W) either via the BIOS or via
</p>
<pre># echo "2-3" | tee /sys/bus/usb/drivers/usb/unbind
</pre>
<h3><span class="mw-headline" id="BIOS_configurations">BIOS configurations</span></h3>
<ul><li>
<code>Config -&gt; Thunderbolt BIOS Assist Mode - Set to "Enabled"</code>. When disabled, on Linux, power usage appears to be significantly higher because of a substantial number of CPU wakeups during s2idle.</li></ul>
<h3><span class="mw-headline" id="Failed_to_start_Suspend">Failed to start Suspend</span></h3>
<p><b>Symptom:</b> The machine starts entering suspend but comes back online immediately when phone charges through USB-C.
</p>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Note:</strong> Just a plain USB-C cable - without any attached external device - can cause that, too.</div>
<pre># journalctl -p err -u systemd-suspend
Failed to suspend system. System resumed again: Device or resource busy
</pre>
<pre>$ dmesg -Tl err
[Mon Nov 11 20:18:03 2019] PM: pci_pm_suspend(): hcd_pci_suspend+0x0/0x30 returns -16
[Mon Nov 11 20:18:03 2019] PM: dpm_run_callback(): pci_pm_suspend+0x0/0x130 returns -16
[Mon Nov 11 20:18:03 2019] PM: Device 0000:00:14.0 failed to suspend async: error -16
[Mon Nov 11 20:18:04 2019] PM: Some devices failed to suspend, or early wake event detected 
</pre>
<p><b>Solution:</b> Block USB devices from waking up the computer.
</p>
<p>Check that <code>grep XHC /proc/acpi/wakeup</code> shows <code>enabled</code>. If yes, disable XHC wakeup with:
</p>
<pre> echo XHC | sudo tee /proc/acpi/wakeup
</pre>
<p>Now, test your computer. If your problem is solved then you have to persist the change as it would get lost on reboot.
</p>
<p><b>Persistent Solution</b>
</p>
<p>There is no way to persist the config through a configuration file. So create the following systemd unit file and enable the service.
</p>
<pre>[Unit]
Description=Fixes failing suspend by disabling wakeup through USB

[Service]
ExecStart=/bin/bash -c 'grep --silent '^XHC.*disabled' /proc/acpi/wakeup || echo XHC &gt; /proc/acpi/wakeup'
Type=oneshot
RemainAfterExit=yes

[Install]
WantedBy=multi-user.target
</pre>
<h2>
<span id="Power_management.2FThrottling_issues"></span><span class="mw-headline" id="Power_management/Throttling_issues">Power management/Throttling issues</span>
</h2>
<p>Due to wrong configured power management registers the CPU may consume a lot less power than under windows and the thermal throttling occurs at 80°C (97°C when using Windows, see <a rel="nofollow" class="external text" href="https://www.reddit.com/r/thinkpad/comments/870u0a/t480s_linux_throttling_bug/">T480s throttling bug</a>).
</p>
<p>There is a <a rel="nofollow" class="external text" href="https://forums.lenovo.com/t5/Linux-Discussion/T480s-low-cTDP-and-trip-temperature-in-Linux/td-p/4028489">post in the official Lenovo forum</a> to inform Lenovo about this issue.
</p>
<h3><span class="mw-headline" id="Throttling_fix_in_thermald">Throttling fix in <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=thermald">thermald</a></span></span></h3>
<p>A fix has reportedly been applied in <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=thermald">thermald</a></span> 2.4.3 according to <a rel="nofollow" class="external text" href="https://forums.lenovo.com/t5/Other-Linux-Discussions/X1C6-T480s-low-cTDP-and-trip-temperature-in-Linux/m-p/4028489?page=47#5273704">this long running discussion</a>. The aforementioned thread also contains links to the patch which was developed by Lenovo.
</p>
<h3><span class="mw-headline" id="Alternative_workarounds">Alternative workarounds</span></h3>
<p>Alternatively, an easy package has been written to address the problem until Lenovo completes the <a rel="nofollow" class="external text" href="https://www.notebookcheck.net/Lenovo-admits-ThinkPad-CPU-throttling-problem-when-running-Linux-fix-in-development.435549.0.html">OS agnostic fix</a> for the X1C6.
</p>
<p>Install <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=throttled">throttled</a></span>, then run:
</p>
<pre># systemctl enable --now lenovo_fix.service
</pre>
<p>The script also supports more advance thermal/performance features including CPU undervolting. See the <a rel="nofollow" class="external text" href="https://github.com/erpalma/throttled">repository</a> <code>README.md</code> for details.
</p>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Note:</strong> If you installed <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=thermald">thermald</a></span>, it may conflict with the throttling fix in this package. Consider disabling thermald or otherwise work around this.</div>
<h2><span class="mw-headline" id="Audio_crackling">Audio crackling</span></h2>
<p>When charging you may hear crackling noise while listening to audio. <a rel="nofollow" class="external text" href="https://www.reddit.com/r/thinkpad/comments/8j8208/audio_crackling_through_both_headphone_jack_and/">The work around</a> for this issue is to disable one of the PINs:
</p>
<pre># hda-verb /dev/snd/hwC0D0 0x1d SET_PIN_WIDGET_CONTROL 0x0
</pre>
<p>There is also a kernel patch for this issue, which can be found <a rel="nofollow" class="external text" href="https://bugs.launchpad.net/ubuntu/+source/linux/+bug/1805079">here</a>. 
</p>
<h2><span class="mw-headline" id="Microphone_distorted_due_to_automatic_adjustment">Microphone distorted due to automatic adjustment</span></h2>
<p>If your microphone volume creeps up automatically and causes the sound to be distorted, you can fix it by disabling mic boost.
See <a href="../en/PulseAudio/Troubleshooting.html#Microphone_distorted_due_to_automatic_adjustment" title="PulseAudio/Troubleshooting">Pulse Audio</a> for details.
</p>
<h2><span class="mw-headline" id="Built-in_speakers_low_volume_workaround">Built-in speakers low volume workaround</span></h2>
<p>If your ThinkPad X1 Carbon (Gen 6) built-in speakers are limited to a maximum of about 20% volume even though the volume is set at 100%, try adding the following parameter to the <code>snd_hda_intel</code> module, which can be set through a file in <code>/etc/modprobe.d/</code>, e.g.: 
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/modprobe.d/alsa-base.conf</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">options snd-hda-intel model=nofixup</pre>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Note:</strong> This stops the LEDs on the mute and mic-mute buttons from working.</div>
<h2>
<span id="Wireless_WAN_.2F_LTE"></span><span class="mw-headline" id="Wireless_WAN_/_LTE">Wireless WAN / LTE</span>
</h2>
<p>ThinkPad X1 Carbon (Gen 6) is exclusively shipped with a Fibocom L850-GL LTE modem, which is currently not supported out of the box under Linux.
</p>
<p>It is normally impossible to swap the LTE modem for a supported one due to BIOS-level restrictions ("whitelists" of allowed M.2 expansion cards) implemented in all modern Lenovo laptops. However, a method has been found to configure any Sierra Wireless EM73xx/EM74xx modem to "evade" the whitelist checks, so these modems can be used normally.
</p>
<p>Take a look at <a href="../en/ThinkPad_mobile_Internet.html#Getting_around_BIOS-level_whitelist_restrictions" title="ThinkPad mobile Internet">ThinkPad mobile internet: Getting around BIOS-level whitelist restrictions</a> for instructions.
</p>
<p>See also the work done in <a rel="nofollow" class="external text" href="https://github.com/abrasive/xmm7360">github: Tools for the Fibocom L850-GL / Intel XMM7360 LTE modem</a>, <a rel="nofollow" class="external text" href="https://github.com/juhovh/xmm7360_usb">github: Kernel module for Fibocom L850-GL / Intel XMM7360 LTE modem</a> and <a rel="nofollow" class="external text" href="https://forums.lenovo.com/t5/Other-Linux-Discussions/WWAN-Fibocom-L850-GL-and-Linux-support/td-p/4318903">Lenovo Forums: WWAN Fibocom L850-GL and Linux support</a>.
</p>
<h3>
<span id="WWAN.2FLTE_GUI"></span><span class="mw-headline" id="WWAN/LTE_GUI">WWAN/LTE GUI</span>
</h3>
<p>Install <a href="../en/NetworkManager.html" title="NetworkManager">NetworkManager</a> and <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=network-manager-applet">network-manager-applet</a></span> to make your life easier founding the correct APN for your SIM card.
</p>
<h2><span class="mw-headline" id="Configuration">Configuration</span></h2>
<h3><span class="mw-headline" id="Keyboard_Fn_Shortcuts">Keyboard Fn Shortcuts</span></h3>
<ul>
<li>Fn+4 sends XF86Sleep (puts computer to sleep by default)</li>
<li>Fn+S sends Alt_L+Sys_Req</li>
<li>Fn+P sends Pause</li>
<li>Fn+B sends Control_L+Break</li>
<li>Fn+K sends Scroll_Lock</li>
<li>Fn+Space toggles the keyboard backlight</li>
<li>Fn by itself sends XF86WakeUp (wakes computer from sleep by default)</li>
</ul>
<h3><span class="mw-headline" id="Special_buttons">Special buttons</span></h3>
<p>Some special buttons are not supported by X server due to keycode number limit.
</p>
<table class="wikitable" style="text-align:center">

<tbody>
<tr>
<th>Key combination</th>
<th>Scancode</th>
<th>Keycode</th>
<th>Note
</th>
</tr>
<tr>
<td><code>Fn+F11</code></td>
<td><code>0x49</code></td>
<td>
<code>374</code> <code>KEY_KEYBOARD</code>
</td>
<td>Not recognized in <a href="../en/Wayland.html" title="Wayland">Wayland</a>
</td>
</tr>
<tr>
<td><code>Fn+F12</code></td>
<td><code>0x45</code></td>
<td>
<code>364</code> <code>KEY_FAVORITES</code>
</td>
<td>Recognized correctly on <a href="../en/Wayland.html" title="Wayland">Wayland</a>
</td>
</tr>
</tbody>
</table>
<p>You can remap unsupported keys so that they can be detected and mapped in X using <a href="../en/Map_scancodes_to_keycodes.html" title="Map scancodes to keycodes">udev hwdb</a>:
</p>
<p>Note that <code>prog1</code> and <code>prog2</code> map to <code>KEY_PROG1</code> and <code>KEY_PROG2</code> in <code>/usr/include/linux/input-event-codes.h</code>. You can use any key code with a defined value less than 255. The keycode hwdb expects is the lowercased text following <code>KEY_</code> in the above input event codes header file. eg: <code>KEY_COFFEE</code> would be <code>coffee</code>.
</p>
<p><br>
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/udev/hwdb.d/90-thinkpad-keyboard.hwdb</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">evdev:name:ThinkPad Extra Buttons:dmi:bvn*:bvr*:bd*:svnLENOVO*:pn*
 KEYBOARD_KEY_49=prog1
 KEYBOARD_KEY_45=prog2
</pre>
<p>To make the changes take effect:
</p>
<pre># udevadm hwdb --update
# udevadm trigger --sysname-match="event*"
</pre>
<h3><span class="mw-headline" id="Disabling_red_LED_in_Thinkpad_logo">Disabling red LED in Thinkpad logo</span></h3>
<p>To disable the red LED in the ThinkPad logo on the cover:
</p>
<p>1. Enable writing to the embedded controller registers by adding the kernel parameter <code>ec_sys.write_support=1</code>.  
If you use UEFI boot, you can add this parameter in <code>/boot/efi/loader/entries/arch.conf</code> under "options".
</p>
<p>2. Then, you can disable directly the LED with this command: 
</p>
<pre># echo -n -e "\x0a" | dd of="/sys/kernel/debug/ec/ec0/io" bs=1 seek=12 count=1 conv=notrunc 2&gt; /dev/null
</pre>
<p><b>To disable the LED at startup, you can create a systemd service:</b> 
</p>
<p>1. Create a sh script (/root/disable_led.sh for instance) and put this : 
</p>
<pre>#!/bin/bash
echo -n -e "\x0a" | dd of="/sys/kernel/debug/ec/ec0/io" bs=1 seek=12 count=1 conv=notrunc 2&gt; /dev/null
</pre>
<p>2. Create a new service unit file in <code>/etc/systemd/system</code> called "led.service", and insert the following: 
</p>
<pre>Description=Disabling thinkpad led

[Service]
ExecStart=/root/disable_led.sh

[Install]
WantedBy=multi-user.target
</pre>
<p>3. Start and enable this service:
</p>
<pre># systemctl start led.service
# systemctl enable led.service
</pre>
<h3><span class="mw-headline" id="HDR_Display_Color_Calibration">HDR Display Color Calibration</span></h3>
<p>For models with the 1440p HDR display, the default color profile can be corrected under Gnome using an ICC calibration provided by <a rel="nofollow" class="external text" href="https://www.notebookcheck.net/Lenovo-ThinkPad-X1-Carbon-2018-WQHD-HDR-i7-Laptop-Review.284682.0.html">notebookcheck.net's review</a>.
</p>
<pre> wget <a rel="nofollow" class="external free" href="https://www.notebookcheck.net/uploads/tx_nbc2/B140QAN02_0.icm">https://www.notebookcheck.net/uploads/tx_nbc2/B140QAN02_0.icm</a>
 colormgr import-profile B140QAN02_0.icm
</pre>
<p>This will import the ICC profile, and next you'll need to activate it for your display. Find your display's object path:
</p>
<pre> colormgr get-devices | sed -rn 's/Object Path:\s*(.*eDP1.*)/\1/p'
</pre>
<p>And your new color profile object path:
</p>
<pre> colormgr get-profiles | grep -4 -i B140QAN02
</pre>
<p>And finally activate the profile and set it as the default for this display:
</p>
<pre> colormgr device-add-profile &lt;device object id&gt; &lt;profile object id&gt;
 colormgr device-make-profile-default &lt;device object id&gt; &lt;profile object id&gt;
</pre>
<p>You can verify the profile is active by running <code>colormgr get-devices</code>.
</p>
<h2><span class="mw-headline" id="Intel_Graphics_UHD_620_issues">Intel Graphics UHD 620 issues</span></h2>
<ul><li>
<a href="../en/Intel_graphics.html#Enable_GuC_/_HuC_firmware_loading" title="Intel graphics">Enable GuC/HuC firmware loading</a> suggests to load GPU firmware with warning. However, on Wayland for Carbon X1 gen 6 it cause GPU hang problem. Issues can be reflected as: a) crashing GPU process of Chrome / Chromium / Electron apps and subsequent host freezing; b) crashing of Gnome / Wayland with possibility to reboot via second virtual terminal; c) just host freezing. In dmesg the following can be observed:</li></ul>
<pre> kernel: [drm] GPU HANG: ecode 9:0:0x85dffffd, in chrome [18418], reason: hang on rcs0, action: reset
 kernel: [drm] GPU hangs can indicate a bug anywhere in the entire gfx stack, including userspace.
 kernel: [drm] Please file a _new_ bug report on bugs.freedesktop.org against DRI -&gt; DRM/Intel
 kernel: [drm] drm/i915 developers can then reassign to the right component if it's not a kernel issue.
 kernel: [drm] The gpu crash dump is required to analyze gpu hangs, so please always attach it.
 kernel: [drm] GPU crash dump saved to /sys/class/drm/card0/error
 kernel: i915 0000:00:02.0: Resetting rcs0 for hang on rcs0
</pre>
<p>Note that, first line changes depending on the source of crashing application, but the result is the same, so issue is with GPU / firmware. Basically don't enable GuC / HuC firmware loading, at least if on Wayland. There are a number of similar issues reported including <a rel="nofollow" class="external text" href="https://bugs.freedesktop.org/show_bug.cgi?id=108717">#108717</a>.
</p>
<ul><li>The <code>modesetting</code> driver causes <a href="../en/Intel_graphics.html#Tearing" title="Intel graphics">tearing</a> in some situations. You can install the <code>xf86-video-intel</code> driver instead and enable the <code>"TearFree"</code> option in your configuration file:</li></ul>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/X11/xorg.conf.d/20-intel.conf</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">Section "Device"
  Identifier  "Intel Graphics"
  Driver      "intel"
  Option      "TearFree" "true"
EndSection</pre>
<h4><span class="mw-headline" id="GNOME_Wayland_not_available">GNOME Wayland not available</span></h4>
<p>If you haven't added the i915 to the MODULES list in /etc/mkinitcpio.conf (e.g. following the full disk encryption requirements below), you may be unable to run Wayland on kernel 4.20 (the gnome on Wayland option might not be present on GDM). Adding i915 to the MODULES list in /etc/mkinitcpio.conf and regenerating the ramdisk solves this issue.
</p>
<h2><span class="mw-headline" id="TrackPoint_and_Touchpad_issues">TrackPoint and Touchpad issues</span></h2>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Note:</strong> Some models of the 6th generation X1 Carbon seem to have issues with the TrackPoint and Touchpad working at the same time.</div>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Note:</strong> The following parameter will only work for kernel versions <i>after</i> v4.14. Fore more information, see <a href="../en/Lenovo_ThinkPad_X1_Carbon_(Gen_5).html#Trackpoint/Trackpad_not_working" title="Lenovo ThinkPad X1 Carbon (Gen 5)">Lenovo ThinkPad X1 Carbon (Gen 5)#Trackpoint/Trackpad not working</a>.</div>
<p>To get the TrackPoint and Touchpad to work at the same time, add <code>synaptics_intertouch=1</code> to the <code>psmouse</code> <a href="../en/Kernel_module.html" title="Kernel module">kernel module</a> options, for example in the cmdline of the <a href="../en/Arch_boot_process.html#Boot_loader" class="mw-redirect" title="Boot loader">boot loader</a>:
</p>
<pre> [...] root=/dev/sda1 rw psmouse.synaptics_intertouch=1 [...]
</pre>
<p>or by editing <code>/etc/modprobe.d/psmouse.conf</code>:
</p>
<pre> options psmouse synaptics_intertouch=1
</pre>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Note:</strong> When using <a href="../en/TLP.html" title="TLP">TLP</a> with default powersaving settings, there might be occasional hiccups such as dropouts of tap-to-click functionality for the Touchpad, as well as the TrackPoint not surviving suspends and needing to be re-initialized.</div>
<p>Reconnecting a dead trackpad can be done via the following command, as the root user:
</p>
<pre>echo -n "none" | tee /sys/bus/serio/devices/serio1/drvctl
echo -n "reconnect" | tee /sys/bus/serio/devices/serio1/drvctl</pre>
<p>A <a rel="nofollow" class="external text" href="https://gitlab.freedesktop.org/libinput/libinput/issues/46">bug</a> in the libinput library that caused dropouts of the tap-to-click functionality of the touchpad on the X1 Carbon 6th Gen has been fixed in libinput 1.11.2, which was released on <a rel="nofollow" class="external text" href="https://lists.freedesktop.org/archives/wayland-devel/2018-July/038782.html">3 July 2018</a>.
</p>
<h2><span class="mw-headline" id="Thunderbolt_dock">Thunderbolt dock</span></h2>
<h3><span class="mw-headline" id="Plugable_USB-C_Mini_Docking_Station_with_85W_Power_Delivery_UD-CAM">Plugable USB-C Mini Docking Station with 85W Power Delivery UD-CAM</span></h3>
<p>If you are using an external plugable <a rel="nofollow" class="external text" href="https://plugable.com/products/ud-cam/">UD-CAM</a> thunderbolt dock connected to the laptop through its USB-C thunderbolt port, you might experience random disconnections (external monitor, bluetooth and ethernet) with this kind of error in dmesg : 
</p>
<pre>pcieport 0000:05:00.0: BAR 13: no space for [io  size 0x3000]</pre> 
<p>It should be noted that <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=bolt">bolt</a></span> is not working with this <a rel="nofollow" class="external text" href="https://plugable.com/products/ud-cam/">UD-CAM</a> dock.
</p>
<p>To avoid random disconnection, proceed as followed by editing the bios and <a href="../en/TLP.html" title="TLP">TLP</a>
</p>
<h4><span class="mw-headline" id="Bios_settings">Bios settings</span></h4>
<p>You should then look at your bios settings : 
</p>
<ul>
<li>Wake by thunderbolt : enable</li>
<li>Security level : no security</li>
<li>Pre-boot ACL option : enable</li>
</ul>
<h4><span class="mw-headline" id="TLP_blacklisting_devices_from_USB_autosuspend">TLP blacklisting devices from USB autosuspend</span></h4>
<p>If you are using <a href="../en/TLP.html" title="TLP">TLP</a> you have to edit /etc/default/tlp and make sure that you exclude all dock devices from USB autosuspend as followed :
</p>
<pre>USB_BLACKLIST="0000:1111 2222:3333 4444:5555"</pre>
<p>Then reboot and your dock should work correctly.
</p>
<h3><span class="mw-headline" id="Lenovo_dock">Lenovo dock</span></h3>
<p>Some problems can be caused by outdated dock firmware. Updates are not supplied by LVFS, use "Firmware for Windows" from the dock support page.
</p>
<h3><span class="mw-headline" id="DisplayLink">DisplayLink</span></h3>
<p>If you want to continue using the <a href="../en/Intel_graphics.html" title="Intel graphics">Intel graphics</a>  for your primary and HDMI displays, Name the intel config file with a numerical prefix that precedes the <a href="../en/DisplayLink.html" title="DisplayLink">DisplayLink</a> Driver configuration. For example, rather than naming it <code>/etc/X11/xorg.conf.d/20-intel.conf</code> instead name it <code>/usr/share/X11/xorg.conf.d/19-intel.conf</code>. This ensures that the driver is parsed by xserver before the modesetting driver, and is therefore utilized with intel integrated graphics by default. Placing it in the same folder as the <a href="../en/DisplayLink.html" title="DisplayLink">DisplayLink</a> drivers also ensures that it'll be parsed first if a user session of <a href="../en/Xorg.html" title="Xorg">Xorg</a> is initiated (e.g.via <code>$ startx</code>).
</p>
<h2><span class="mw-headline" id="Full-disk_encryption">Full-disk encryption</span></h2>
<h3><span class="mw-headline" id="LUKS:_Ramdisk_module">LUKS: Ramdisk module</span></h3>
<p>With LUKS for root, i915 needs to be loaded in ramdisk in order to access the password prompt.
Add i915 to MODULES list in <code>/etc/mkinitcpio.conf</code> and regenerate the ramdisk.
</p>
<h3><span class="mw-headline" id="OPAL:_Hardware_based_full-disk_encryption">OPAL: Hardware based full-disk encryption</span></h3>
<p>See <a href="../en/Self-encrypting_drives.html" title="Self-encrypting drives">Self-encrypting drives</a> (Confirmed working)
</p>
<h2><span class="mw-headline" id="Tools">Tools</span></h2>
<h3><span class="mw-headline" id="Diagnostics">Diagnostics</span></h3>
<p><code>s-tui</code> (<span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=s-tui">s-tui</a></span>): an aesthetically pleasing and useful curses-style interface that shows graphs of CPU frequency, utilization, temperature, and power consumption. It also has a built in stress tester.
</p>
<p><code>intel_gpu_top</code> (<span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=intel-gpu-tools">intel-gpu-tools</a></span>): gives you some top-like info for the integrated GPU. This can be quite useful in diagnosing GPU acceleration issues.
</p>
<p><code>powertop</code> (<span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=powertop">powertop</a></span>): provides detailed information about CPU power consumption and recommendations on how to improve it.
</p>
<p><code>tlp-stat</code> (<span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=tlp">tlp</a></span>): a much simpler alternative to remembering which <code>cat /sys/devices/system/*</code> to run in many cases. It can give very detailed, structured information about components like the battery, processor, graphics card, etc.
</p>
<h2><span class="mw-headline" id="nvme_issues">nvme issues</span></h2>
<p>There is an <a rel="nofollow" class="external text" href="https://pcsupport.lenovo.com/us/en/products/laptops-and-netbooks/thinkpad-x-series-laptops/thinkpad-x1-carbon-6th-gen-type-20kh-20kg/solutions/HT508405">issue</a> with nvme installed in ThinkPad X1 Carbon (Gen 6) resulting in device failure. Be sure to update firmware or reach out to lenovo support for replacement. 
</p>
<h2><span class="mw-headline" id="References">References</span></h2>
<ul>
<li>
<a rel="nofollow" class="external text" href="https://www.reddit.com/r/thinkpad/comments/870u0a/t480s_linux_throttling_bug/">T480s throttling bug</a>, affects X1C6 as well</li>
<li><a rel="nofollow" class="external text" href="https://forums.lenovo.com/t5/Linux-Discussion/T480s-low-cTDP-and-trip-temperature-in-Linux/td-p/4028489">Lenovo forums: T480s low cTDP and trip temperature in Linux</a></li>
<li><a rel="nofollow" class="external text" href="https://bbs.archlinux.org/viewtopic.php?id=236367">Thread: TrackPoint/Touchpad issues, 20KG model</a></li>
<li><a rel="nofollow" class="external text" href="https://unix.stackexchange.com/a/431820">StackExchange: Success with enabling RMI4 config flags for Touchpad and TrackPoint</a></li>
<li><a rel="nofollow" class="external text" href="https://patchwork.kernel.org/patch/10324633/">Kernel patch - Input: elantech - add support for SMBus devices</a></li>
<li><a rel="nofollow" class="external text" href="https://patchwork.kernel.org/patch/10330857/">Kernel patch - Input: synaptics - add Lenovo 80 series ids to SMBus</a></li>
<li>
<a href="../en/Kernel_mode_setting.html#Early_KMS_start" title="Kernel mode setting">Early KMS start</a>: Adding i915 to ramdisk</li>
</ul>
<h2><span class="mw-headline" id="Additional_resources">Additional resources</span></h2>
<ul>
<li><a rel="nofollow" class="external text" href="https://www.thinkwiki.org/wiki/Category:X1_Carbon_(6th_Gen)">ThinkWiki X1 Carbon 6th Gen page</a></li>
<li>Benjamin Tissoires, kernel maintainer of peripherals, has explained how input bugs get fixed in his talk <a rel="nofollow" class="external text" href="https://www.youtube.com/watch?v=Bl_0xYxcYd8">Tools to debug a broken input device</a> (<a rel="nofollow" class="external text" href="https://www.x.org/wiki/Events/XDC2015/Program/tissoires_input_debug_tools.html">Slides</a>), especially interesting are slides 16 onward.</li>
<li>
<a rel="nofollow" class="external text" href="https://gist.github.com/greigdp/bb70fbc331a0aaf447c2d38eacb85b8f">Dell XPS 13 9370 quirks</a>: Some pointers on getting Watt usage down to ~2W, Intel video powersaving features might be interesting, see also the <a href="../en/Intel_graphics.html" title="Intel graphics">Intel graphics</a> page for interesting power-saving options.</li>
<li>
<a href="../en/Dell_XPS_13_(9360).html" title="Dell XPS 13 (9360)">Dell XPS 13 (9360)</a>: Shares some hardware with the X1C6</li>
<li>
<a rel="nofollow" class="external text" href="https://01.org/blogs/rzhang/2015/best-practice-debug-linux-suspend/hibernate-issues">Intel Blog: Best practice to debug Linux* suspend/hibernate issues</a>, including the <a rel="nofollow" class="external text" href="https://github.com/01org/pm-graph">pm-graph</a> tool to analyze power usage during suspend</li>
<li><a rel="nofollow" class="external text" href="https://github.com/ejmg/an-idiots-guide-to-installing-arch-on-a-lenovo-carbon-x1-gen-6">A comprehensive example Arch install for the X1C6</a></li>
</ul>
</div>
</div>
<div id="catlinks" class="catlinks" data-mw="interface"><div id="mw-normal-catlinks" class="mw-normal-catlinks">
<a href="../Special:Categories.html" title="Special:Categories">Category</a>: <ul><li><a href="../en/Category:Lenovo.html" title="Category:Lenovo">Lenovo</a></li></ul>
</div></div>
	</div>
</div>

<footer id="footer" class="mw-footer" role="contentinfo" style="margin: 0">
	<ul id="footer-info">
		<li>Retrieved from "<a dir="ltr" href="https://wiki.archlinux.org/index.php?title=Lenovo_ThinkPad_X1_Carbon_(Gen_6)&amp;oldid=654843">https://wiki.archlinux.org/index.php?title=Lenovo_ThinkPad_X1_Carbon_(Gen_6)&amp;oldid=654843</a>"</li>
		<li id="footer-info-lastmod"> This page was last edited on 14 March 2021, at 04:01.</li>
		<li id="footer-info-copyright">Content is available under <a class="external" rel="nofollow" href="http://www.gnu.org/copyleft/fdl.html">GNU Free Documentation License 1.3 or later</a> unless otherwise noted.</li>
	<br>
</ul>
	<ul id="footer-places">
		<li id="footer-places-privacy"><a href="../en/ArchWiki:Privacy_policy.html" title="ArchWiki:Privacy policy">Privacy policy</a></li>
		<li id="footer-places-about"><a href="../en/ArchWiki:About.html" title="ArchWiki:About">About ArchWiki</a></li>
		<li id="footer-places-disclaimer"><a href="../en/ArchWiki:General_disclaimer.html" title="ArchWiki:General disclaimer">Disclaimers</a></li>
	</ul>
	<ul id="footer-icons" class="noprint">
		<li id="footer-copyrightico">
	</ul>
	<div style="clear: both;"></div>
</footer>



</body>
</html>
