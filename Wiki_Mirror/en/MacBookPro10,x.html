<!DOCTYPE html>
<html class="client-nojs" lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<title>MacBookPro10,x - ArchWiki</title>
<link rel="stylesheet" href="../ArchWikiOffline.css">
<meta name="ResourceLoaderDynamicStyles" content="">
<meta name="generator" content="MediaWiki 1.35.0">
<meta name="robots" content="noindex,follow">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="shortcut icon" href="/favicon.ico">
<link rel="search" type="application/opensearchdescription+xml" href="/opensearch_desc.php" title="ArchWiki (en)">
<link rel="EditURI" type="application/rsd+xml" href="https://wiki.archlinux.org/api.php?action=rsd">
<link rel="license" href="http://www.gnu.org/copyleft/fdl.html">
<link rel="alternate" type="application/atom+xml" title="ArchWiki Atom feed" href="/index.php?title=Special:RecentChanges&amp;feed=atom">
</head>
<body class="mediawiki ltr sitedir-ltr mw-hide-empty-elt ns-0 ns-subject page-MacBookPro10_x rootpage-MacBookPro10_x skin-vector action-view skin-vector-legacy">
<div id="content" class="mw-body" role="main" style="margin: 0">
	<a id="top"></a>
	<div id="siteNotice" class="mw-body-content"></div>
	<div class="mw-indicators mw-body-content">
	</div>
	<h1 id="firstHeading" class="firstHeading" lang="en">MacBookPro10,x</h1>
	<div id="bodyContent" class="mw-body-content">
		<div id="siteSub" class="noprint">From ArchWiki</div>
		<div id="contentSub"></div>
		<div id="contentSub2"></div>
		
		<div id="jump-to-nav"></div>
		<a class="mw-jump-link" href="#mw-head">Jump to navigation</a>
		<a class="mw-jump-link" href="#searchInput">Jump to search</a>
		<div id="mw-content-text" lang="en" dir="ltr" class="mw-content-ltr">
<div class="warningbox">The printable version is no longer supported and may have rendering errors. Please update your browser bookmarks and please use the default browser print function instead.</div>
<div class="mw-parser-output">
<div class="archwiki-template-meta-related-articles-start">
<p>Related articles</p>
<ul>
<li><a href="../en/Installation_guide.html" title="Installation guide">Installation guide</a></li>
<li><a href="../en/General_recommendations.html" title="General recommendations">General recommendations</a></li>
<li><a href="../en/Mac.html" title="Mac">Mac</a></li>
</ul>
</div>
<p>This page should help you set up Arch Linux on a <a href="https://en.wikipedia.org/wiki/MacBook_Pro#Third_generation_.28Retina.29" class="extiw" title="wikipedia:MacBook Pro">MacBook Pro 10,1 with Retina display</a>. Most of the steps are the same or very similar to the regular Arch Linux installation. However, because this is very new hardware, the setup requires a few different steps.
</p>
<p>The general installation guidelines are described in <a href="../en/Mac.html" title="Mac">Mac</a>.
</p>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Note:</strong> To have all hardware supported, you should run this Notebook with Kernel 3.7 or newer.</div>
<div id="toc" class="toc" role="navigation" aria-labelledby="mw-toc-heading">
<input type="checkbox" role="button" id="toctogglecheckbox" class="toctogglecheckbox" style="display:none"><div class="toctitle" lang="en" dir="ltr">
<h2 id="mw-toc-heading">Contents</h2>
<span class="toctogglespan"><label class="toctogglelabel" for="toctogglecheckbox"></label></span>
</div>
<ul>
<li class="toclevel-1 tocsection-1">
<a href="#Preparing_for_the_Installation"><span class="tocnumber">1</span> <span class="toctext">Preparing for the Installation</span></a>
<ul>
<li class="toclevel-2 tocsection-2"><a href="#Preparing_the_Hard_drive"><span class="tocnumber">1.1</span> <span class="toctext">Preparing the Hard drive</span></a></li>
<li class="toclevel-2 tocsection-3"><a href="#Using_the_Thunderbolt_to_Ethernet_adapter"><span class="tocnumber">1.2</span> <span class="toctext">Using the Thunderbolt to Ethernet adapter</span></a></li>
<li class="toclevel-2 tocsection-4"><a href="#Using_a_USB-to-Ethernet_adapter"><span class="tocnumber">1.3</span> <span class="toctext">Using a USB-to-Ethernet adapter</span></a></li>
<li class="toclevel-2 tocsection-5"><a href="#Getting_wireless_firmware"><span class="tocnumber">1.4</span> <span class="toctext">Getting wireless firmware</span></a></li>
<li class="toclevel-2 tocsection-6"><a href="#USB_Tethering"><span class="tocnumber">1.5</span> <span class="toctext">USB Tethering</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-7">
<a href="#Installation"><span class="tocnumber">2</span> <span class="toctext">Installation</span></a>
<ul>
<li class="toclevel-2 tocsection-8"><a href="#Booting_the_live_image"><span class="tocnumber">2.1</span> <span class="toctext">Booting the live image</span></a></li>
<li class="toclevel-2 tocsection-9"><a href="#Connecting_to_Wi-Fi"><span class="tocnumber">2.2</span> <span class="toctext">Connecting to Wi-Fi</span></a></li>
<li class="toclevel-2 tocsection-10"><a href="#The_installation"><span class="tocnumber">2.3</span> <span class="toctext">The installation</span></a></li>
<li class="toclevel-2 tocsection-11">
<a href="#Bootloader"><span class="tocnumber">2.4</span> <span class="toctext">Bootloader</span></a>
<ul>
<li class="toclevel-3 tocsection-12"><a href="#Direct_EFI_booting"><span class="tocnumber">2.4.1</span> <span class="toctext">Direct EFI booting</span></a></li>
<li class="toclevel-3 tocsection-13"><a href="#GRUB"><span class="tocnumber">2.4.2</span> <span class="toctext">GRUB</span></a></li>
</ul>
</li>
</ul>
</li>
<li class="toclevel-1 tocsection-14">
<a href="#Post_installation"><span class="tocnumber">3</span> <span class="toctext">Post installation</span></a>
<ul>
<li class="toclevel-2 tocsection-15"><a href="#Wi-Fi"><span class="tocnumber">3.1</span> <span class="toctext">Wi-Fi</span></a></li>
<li class="toclevel-2 tocsection-16">
<a href="#Graphics"><span class="tocnumber">3.2</span> <span class="toctext">Graphics</span></a>
<ul>
<li class="toclevel-3 tocsection-17"><a href="#General_Notes"><span class="tocnumber">3.2.1</span> <span class="toctext">General Notes</span></a></li>
<li class="toclevel-3 tocsection-18"><a href="#Nouveau_backlight"><span class="tocnumber">3.2.2</span> <span class="toctext">Nouveau backlight</span></a></li>
<li class="toclevel-3 tocsection-19"><a href="#NVIDIA_backlight"><span class="tocnumber">3.2.3</span> <span class="toctext">NVIDIA backlight</span></a></li>
<li class="toclevel-3 tocsection-20">
<a href="#Switching_to/from_GPUs_with_gpu-switch"><span class="tocnumber">3.2.4</span> <span class="toctext">Switching to/from GPUs with gpu-switch</span></a>
<ul>
<li class="toclevel-4 tocsection-21"><a href="#Switch_to_Intel_integrated_GPU_and_turn_off_discrete_Nvidia_GPU"><span class="tocnumber">3.2.4.1</span> <span class="toctext">Switch to Intel integrated GPU and turn off discrete Nvidia GPU</span></a></li>
<li class="toclevel-4 tocsection-22"><a href="#Keeping_the_discrete_GPU_off_at_boot"><span class="tocnumber">3.2.4.2</span> <span class="toctext">Keeping the discrete GPU off at boot</span></a></li>
</ul>
</li>
<li class="toclevel-3 tocsection-23"><a href="#Graphic_artifacting_under_b43-firmware"><span class="tocnumber">3.2.5</span> <span class="toctext">Graphic artifacting under b43-firmware</span></a></li>
</ul>
</li>
<li class="toclevel-2 tocsection-24"><a href="#Enable_Vsync"><span class="tocnumber">3.3</span> <span class="toctext">Enable Vsync</span></a></li>
<li class="toclevel-2 tocsection-25"><a href="#Sound_and_microphone"><span class="tocnumber">3.4</span> <span class="toctext">Sound and microphone</span></a></li>
<li class="toclevel-2 tocsection-26"><a href="#Touchpad"><span class="tocnumber">3.5</span> <span class="toctext">Touchpad</span></a></li>
<li class="toclevel-2 tocsection-27"><a href="#Memory_Card_(SDHCI/SDX)_Reader"><span class="tocnumber">3.6</span> <span class="toctext">Memory Card (SDHCI/SDX) Reader</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-28">
<a href="#What_does_not_work_(early_August_2013,_3.10.3-1)"><span class="tocnumber">4</span> <span class="toctext">What does not work (early August 2013, 3.10.3-1)</span></a>
<ul>
<li class="toclevel-2 tocsection-29"><a href="#Graphics_2"><span class="tocnumber">4.1</span> <span class="toctext">Graphics</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-30"><a href="#Discussions"><span class="tocnumber">5</span> <span class="toctext">Discussions</span></a></li>
<li class="toclevel-1 tocsection-31"><a href="#See_also"><span class="tocnumber">6</span> <span class="toctext">See also</span></a></li>
</ul>
</div>

<h2><span class="mw-headline" id="Preparing_for_the_Installation">Preparing for the Installation</span></h2>
<h3><span class="mw-headline" id="Preparing_the_Hard_drive">Preparing the Hard drive</span></h3>
<p>Assuming you want to dual boot with OS X, you have to shrink its partition with the Disk Utility. You can either create your Linux partition directly here, or do that later in Linux during the installation (using <code>parted</code> and <code>mkfs</code>).
</p>
<h3><span class="mw-headline" id="Using_the_Thunderbolt_to_Ethernet_adapter">Using the Thunderbolt to Ethernet adapter</span></h3>
<p>As of late 2014, Thunderbolt hotplugging has been included in the mainline Linux kernel. Ethernet cables can now be used as usual through the Thunderbolt adapter.
<a rel="nofollow" class="external autonumber" href="https://plus.google.com/+gregkroahhartman/posts/bzx6EJnwMMf">[1]</a>
</p>
<h3><span class="mw-headline" id="Using_a_USB-to-Ethernet_adapter">Using a USB-to-Ethernet adapter</span></h3>
<p>No special configuration is necessary to get this to work.
</p>
<h3><span class="mw-headline" id="Getting_wireless_firmware">Getting wireless firmware</span></h3>
<p>In order for the Wi-Fi chipset to work, you need to get the firmware for it. You can just copy it from another b43-enabled Arch, extract it from Broadcom's driver using <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=b43-fwcutter">b43-fwcutter</a></span>, or get the firmware through the <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://aur.archlinux.org/packages/b43-firmware/">b43-firmware</a></span><sup><small>AUR</small></sup> package available in the <a href="../en/Arch_User_Repository.html" class="mw-redirect" title="AUR">AUR</a>. In the end, you should have a folder named <code>b43</code> with a lot of <code>.fw</code> files in it.
</p>
<h3><span class="mw-headline" id="USB_Tethering">USB Tethering</span></h3>
<p>If you have a smartphone, you can also try tethering your device to get connected to the internet. This should work out of the box.
</p>
<h2><span class="mw-headline" id="Installation">Installation</span></h2>
<h3><span class="mw-headline" id="Booting_the_live_image">Booting the live image</span></h3>
<p>Download the latest ISO from the download page and prepare a live USB as outlined in <a href="../en/USB_flash_installation_medium.html" class="mw-redirect" title="USB flash installation media">USB flash installation media</a>.
</p>
<p>Shut down the MacBook. Plug in the USB drive. Hold the option key, then press the power button. After a few seconds, you should see Apple's boot loader display the choice of either starting up the built-in drive with OS X or the USB drive you plugged in. 
</p>
<p>Select the live USB with the arrow keys, and press Enter to boot into the live Arch Linux environment.
</p>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Note:</strong> You should not need to pass in any kernel parameters to boot successfully into the live environment.</div>
<h3><span class="mw-headline" id="Connecting_to_Wi-Fi">Connecting to Wi-Fi</span></h3>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Note:</strong> You can skip this if you use the Thunderbolt or USB-to-Ethernet adapter for the installation.</div>
<p>After it has finished booting, enter a command line. Copy the entire folder with the firmware for your wireless card to <code>/usr/lib/firmware/</code>. 
</p>
<p>Now you should be able to use wifi-menu to connect to your Wi-Fi network.
</p>
<h3><span class="mw-headline" id="The_installation">The installation</span></h3>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Note:</strong> Refer to the <a href="../en/Mac.html" title="Mac">Mac</a> page if you do not want to have a separate partition for GRUB but rather prefer to use <a rel="nofollow" class="external text" href="http://www.rodsbooks.com/refind/">rEFInd</a> (or <a href="../en/Mac.html#rEFIt" title="Mac">rEFIt</a>).</div>
<p>Run the installation wizard. When asked to partition your hard drive, create a small HFS partition. This is where you put the standalone GRUB package after the installation.
The rest of the installation is pretty much the same as usual. When choosing the bootloader, select GRUB, and install it. Do not worry about any errors; we will create the bootable EFI image on our own afterwards.
</p>
<p>After the installation has completed, directly copy the Wi-Fi firmware to the installed system to <code>/tmp/install/usr/lib/firmware/</code>.
</p>
<p>Alternatively, install <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=broadcom-wl-dkms">broadcom-wl-dkms</a></span> from the <a href="../en/Arch_User_Repository.html" class="mw-redirect" title="AUR">AUR</a> to improve Wi-Fi.
</p>
<h3><span class="mw-headline" id="Bootloader">Bootloader</span></h3>
<h4><span class="mw-headline" id="Direct_EFI_booting">Direct EFI booting</span></h4>
<p>See <a href="../en/Arch_boot_process.html#Boot_loader" title="Arch boot process">Arch boot process#Boot loader</a>.
</p>
<p>As of August 2013, refind can autodetect the Arch kernel, removing the need for copying the kernel into the EFI partition. Simply install refind and enable the "scan_all_linux_kernels" and "also_scan_dirs" options in refind.conf (see link above for instructions.)
</p>
<h4><span class="mw-headline" id="GRUB">GRUB</span></h4>
<p>Another solution is to install <a href="../en/GRUB.html" title="GRUB">GRUB</a>. Edit <code>/tmp/install/boot/grub/grub.cfg</code> and edit the boot entry to load Linux mainline instead of the normal one. Also append <code>noapic</code> to the kernel line again.
</p>
<p>Now cd into <code>/tmp/install/</code> and create the GRUB image by calling:
</p>
<pre>grub-mkstandalone -o grub-standalone-x86_64.efi -d usr/lib/grub/x86_64-efi -O x86_64-efi -C xz boot/grub/grub.cfg
</pre>
<p>This will create file called <code>grub-standalone-x86_64.efi</code> which contains GRUB and the config file. It is important to <code>cd</code> into the right directory to make it pick up the config file and put it into the right place within the image.
Copy this file to the HFS partition you have created earlier. Downside of this method is that you need to repeat this step whenever you want to change the GRUB config.
</p>
<p>Reboot the machine and boot into OS X. The HFS partition should be mounted and the GRUB standalone image in there. Follow the steps on this page to create the files needed to make the Apple boot loader pick up GRUB: <a rel="nofollow" class="external free" href="http://mjg59.dreamwidth.org/7468.html">http://mjg59.dreamwidth.org/7468.html</a>.
After creating the files, use <code>bless</code> on the GRUB image on the partition. If you want to boot automatically to Arch, append <code>--setBoot</code>.
</p>
<p>After another reboot, you should be able to select your installed Arch Linux by keeping the alt button pressed while booting in case you have not used <code> --setBoot</code> while blessing.
</p>
<h2><span class="mw-headline" id="Post_installation">Post installation</span></h2>
<h3><span class="mw-headline" id="Wi-Fi">Wi-Fi</span></h3>
<p>The Macbook Pro 10,x comes with the Broadcom BCM4331 Wireless Chipset.
</p>
<p>There are two major options to get this chipset working in Arch Linux:
</p>
<p>The <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://aur.archlinux.org/packages/b43-firmware/">b43-firmware</a></span><sup><small>AUR</small></sup> package contains the open-source, reverse-engineered firmware for the chipset. 
</p>
<p>The <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=broadcom-wl">broadcom-wl</a></span> and <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=broadcom-wl-dkms">broadcom-wl-dkms</a></span> packages ship with the propriety, restricted-license drivers for the chipset. 
</p>
<p>See <a href="../en/Broadcom_wireless.html" title="Broadcom wireless">Broadcom wireless</a> for more information.
</p>
<h3><span class="mw-headline" id="Graphics">Graphics</span></h3>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Note:</strong> In order to plug in an external display, you will need to have the NVIDIA card powered on as the HDMI and thunderbolt outputs are hardwired to use the NVIDIA card.</div>
<h4><span class="mw-headline" id="General_Notes">General Notes</span></h4>
<p>The Laptop comes with an nVidia and an Intel chip. The Nouveau <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=xf86-video-nouveau">xf86-video-nouveau</a></span>, the intel <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=xf86-video-intel">xf86-video-intel</a></span> (from 3.6-rc5) and proprietary nvidia (from 302.17) drivers work.
You can install the nvidia driver through <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=nvidia">nvidia</a></span> or the AUR package <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://aur.archlinux.org/packages/nvidia-beta-all/">nvidia-beta-all</a></span><sup><small>AUR</small></sup><sup>[<a href="../en/Help:Procedures.html#Fix_broken_package_links" title="Help:Procedures">broken link</a>: package not found]</sup>.
</p>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Note:</strong> As of September, 2013 the current nvidia driver (325.15-5) does not work with the current 3.10 series kernels; X will die with an error about "Failed to allocate EVO core DMA push buffer" and leave you with a black screen (but able to SSH in to the machine). Your best current bet is to use a 3.9-series kernel and the older 319.32-series nvidia driver.</div>
<p>Since this device comes with a Retina (HiDPI) display, things may be really small with native resolution for some desktop environments. There are different ways to work around this "issue":
</p>
<ol>
<li>Increase the DPI value to get larger fonts (other things like icons may not look great that way)
<ul><li>KDM is a great choice because the stock UI elements are vectors (not rasters which look terrible on Retina and do not scale infinitely). In addition the <a href="../en/Wayland.html" title="Wayland">KWin compositor</a> does a remarkable job on the Retina display.</li></ul>
</li>
<li>Lower the screen resolution to 1680x1050 (works fine at least with nouveau drivers), but things look a little bit blurry, of course</li>
<li>Use xrandr scale option with nvidia driver to scale the resolution down to what you want. Take a look at:  <a rel="nofollow" class="external free" href="http://linuxmacbookproretina.blogspot.no/">http://linuxmacbookproretina.blogspot.no/</a>
</li>
<li>See <a href="../en/HiDPI.html" title="HiDPI">HiDPI</a> for more tweaks.</li>
</ol>
<h4><span class="mw-headline" id="Nouveau_backlight">Nouveau backlight</span></h4>
<p>If you are using the open-source Nouveau drivers and the active GPU is the Nvidia card, backlight levels can be adjusted by echoing a value to a file (as root):
</p>
<pre>echo 500 &gt; /sys/class/backlight/gmux_backlight/brightness
</pre>
<p>To bring the backlight to its maximum level:
</p>
<pre>echo $(cat /sys/class/backlight/gmux_backlight/max_brightness) &gt; /sys/class/backlight/gmux_backlight/brightness
</pre>
<h4><span class="mw-headline" id="NVIDIA_backlight">NVIDIA backlight</span></h4>
<p>If you are using the propriety nvidia drivers, note that the backlight adjustment will not work out of the box.
</p>
<p>To enable backlight control (run as root):
</p>
<pre>setpci -v -H1 -s 00:01.00 BRIDGE_CONTROL=0
</pre>
<h4>
<span id="Switching_to.2Ffrom_GPUs_with_gpu-switch"></span><span class="mw-headline" id="Switching_to/from_GPUs_with_gpu-switch">Switching to/from GPUs with gpu-switch</span>
</h4>
<p>You can switch the display output to and from the discrete or integrated intel GPU from <i>within</i> Arch Linux with <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://aur.archlinux.org/packages/gpu-switch/">gpu-switch</a></span><sup><small>AUR</small></sup> if you are using the open-source <code>xf86-video-nouveau</code> and <code>xf86-video-intel</code> drivers.
</p>
<p><b>Installation</b>
</p>
<p>You can install <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://aur.archlinux.org/packages/gpu-switch/">gpu-switch</a></span><sup><small>AUR</small></sup> from the AUR.
</p>
<p>Then, just run the script as root.
</p>
<p><b>Usage</b>
</p>
<p>The command switches are <code>-i</code>, to switch to the integrated card, and <code>-d</code> for switching to the discrete GPU. In order to have the changes take effect, you will need to reboot.
</p>
<h5><span class="mw-headline" id="Switch_to_Intel_integrated_GPU_and_turn_off_discrete_Nvidia_GPU">Switch to Intel integrated GPU and turn off discrete Nvidia GPU</span></h5>
<p>To switch to intel card and poweroff the discrete GPU:
</p>
<pre>cd /path/to/gpu-switch
./gpu-switch -i
</pre>
<p>Then reboot.
</p>
<p>Poweroff the discrete GPU using <code>vgaswitcheroo</code> as root:
</p>
<pre>echo OFF &gt; /sys/kernel/debug/vgaswitcheroo/switch
</pre>
<p>This will take a second or to complete.
</p>
<p>Then, check whether the discrete GPU is still on:
</p>
<pre>cat /sys/kernel/debug/vgaswitcheroo/switch
</pre>
<p>The output should look like this:
</p>
<pre>0:IGD:+:Pwr:0000:00:02.0
1:DIS: :Off:0000:01:00.0
2:DIS-Audio: :Off:0000:01:00.1

</pre>
<p>This is useful if you have opted to have an Arch Linux-only installation and cannot access the OS X-only tool iGPU.
</p>
<h5><span class="mw-headline" id="Keeping_the_discrete_GPU_off_at_boot">Keeping the discrete GPU off at boot</span></h5>
<p>If you want to keep the discrete GPU off at boot, see <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://aur.archlinux.org/packages/systemd-vgaswitcheroo-units/">systemd-vgaswitcheroo-units</a></span><sup><small>AUR</small></sup>.
</p>
<h4><span class="mw-headline" id="Graphic_artifacting_under_b43-firmware">Graphic artifacting under b43-firmware</span></h4>
<p>While on integrated graphics with the b43-firmware package, you might encounter moderate to severe graphic artifacting that appears to be correlated to wireless network traffic. (disconnected-&gt;no artifacting, connected-&gt;periodic artifacting, large transfer-&gt;severe artifacting/unusuable) This can be resolved by removing/blacklisting <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://aur.archlinux.org/packages/b43-firmware/">b43-firmware</a></span><sup><small>AUR</small></sup> and using either <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=broadcom-wl">broadcom-wl</a></span> or <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=broadcom-wl-dkms">broadcom-wl-dkms</a></span>.
</p>
<h3><span class="mw-headline" id="Enable_Vsync">Enable Vsync</span></h3>
<p>to prevent screen tearing,
add this to /etc/X11/xorg.conf.d/20-intel.conf (create the file if it is not there already)
</p>
<pre> Section "Device"
   Identifier "Intel Graphics"
   Driver     "intel"
   Option     "TearFree" "true"
 EndSection
</pre>
<p>and reboot
</p>
<h3><span class="mw-headline" id="Sound_and_microphone">Sound and microphone</span></h3>
<p>On the MacBookPro10,2 you may need to use the 'snd_hda_intel' driver with the model option 'mbp101'. This model option goes in the modprobe configuration; for example, add the following to /etc/modprobe.d/alsa-base.conf (<a rel="nofollow" class="external text" href="https://bbs.archlinux.org/viewtopic.php?pid=1195946#p1195946">forum post</a>):
</p>
<pre> options snd-hda-intel model=mbp101
</pre>
<p>Note this model option is undocumented in the list of models available online, but it works admirably. (Until you do this, the sound may seem fine through HDMI, but the built-in speakers and internal microphone may not work properly.)
</p>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Note:</strong> Reports <b>as of September 2013</b> suggest this model option is no longer required and should work automatically; but <b>as of October 2017</b> it still appears to be required for the microphone (but not the speakers).</div>
<p>For additional microphone troubleshooting tips, see <a href="../en/Advanced_Linux_Sound_Architecture/Troubleshooting.html#Microphone" title="Advanced Linux Sound Architecture/Troubleshooting">Advanced Linux Sound Architecture/Troubleshooting#Microphone</a>.
</p>
<h3><span class="mw-headline" id="Touchpad">Touchpad</span></h3>
<p>While <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=xf86-input-synaptics">xf86-input-synaptics</a></span> will work, the integrated button of the touchpad may cause issues. Using the <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://aur.archlinux.org/packages/xf86-input-mtrack-git/">xf86-input-mtrack-git</a></span><sup><small>AUR</small></sup> driver, with a tweaked configuration should lead to a better end result:
</p>
<p>The following config uses a single touch for left, two for middle, three for right:
</p>
<pre>Section "InputClass"
    MatchIsTouchpad "on"
    Identifier      "Touchpads"
    Driver          "mtrack"
    Option          "Sensitivity" "0.65"
    Option          "IgnoreThumb" "true"
    Option          "IgnorePalm" "true"
    Option          "TapButton1" "1"  
    Option          "TapButton2" "3"
    Option          "TapButton3" "2"
    Option          "ClickFinger1" "1"
    Option          "ClickFinger2" "3"
    Option          "ClickFinger3" "2"
    Option          "BottomEdge" "25"
EndSection
</pre>
<p>To use natural scrolling, also add the following inside this section:
</p>
<pre>    Option          "ScrollDownButton"  "4"
    Option          "ScrollUpButton"    "5"
    Option          "ScrollLeftButton"  "7"
    Option          "ScrollRightButton" "6"
</pre>
<p>For more configurations, check the document of <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://aur.archlinux.org/packages/xf86-input-mtrack-git/">xf86-input-mtrack-git</a></span><sup><small>AUR</small></sup>.
</p>
<p>To disable the trackpad when typing, install the <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://aur.archlinux.org/packages/dispad-git/">dispad-git</a></span><sup><small>AUR</small></sup> utility.
</p>
<h3>
<span id="Memory_Card_.28SDHCI.2FSDX.29_Reader"></span><span class="mw-headline" id="Memory_Card_(SDHCI/SDX)_Reader">Memory Card (SDHCI/SDX) Reader</span>
</h3>
<p>There is currently a bug in the kernel (4.7.x) where the internal SD card reader times out.
</p>
<p>As a workaround you will need to reload the sdhci kernel modules, as per: <a rel="nofollow" class="external free" href="https://bugzilla.kernel.org/show_bug.cgi?id=73241#c55">https://bugzilla.kernel.org/show_bug.cgi?id=73241#c55</a>
</p>
<pre> sudo rmmod sdhci-pci sdhci
 sudo modprobe sdhci debug_quirks2=4
 sudo modprobe sdhci-pci
</pre>
<h2>
<span id="What_does_not_work_.28early_August_2013.2C_3.10.3-1.29"></span><span class="mw-headline" id="What_does_not_work_(early_August_2013,_3.10.3-1)">What does not work (early August 2013, 3.10.3-1)</span>
</h2>
<h3><span class="mw-headline" id="Graphics_2">Graphics</span></h3>
<ul>
<li>
Using vgaswitcheroo to switch between iGPU / dGPU on the 15" version will result in a black screen. The system is still running and can be rebooted safely.
<ul>
<li>
The dGPU/nouveau is active on boot. As of 3.10.3-1, the only known way to switch to the iGPU/intel is to force this through gfxCardStatus v2.2.1 on MacOS (later versions of gfxCardStatus do *not* work.) This setting will survive reboots. To revert it, you must reboot into MacOS *twice* and/or reset the SMC (shutdown and press shift+control+alt+power at the same time. Press power again to boot.)
</li>
<li>
Another way to force iGPU/intel is to add following commands into one of the <code>menuentry</code> in <code>grub.cfg</code>,
<pre>outb 0x7c2 1
outb 0x7d4 0x28
outb 0x7c2 2
outb 0x7d4 0x10
outb 0x7c2 2
outb 0x7d4 0x40

# Power down dGPU (will not work)
#outb 0x7c2 1
#outb 0x7d4 0x50
#outb 0x7c2 0
#outb 0x7d4 0x50
</pre>
<p>The screen will remain blank until intel driver is fully loaded. Notice that dGPU will not be powered down (adding code above will prevent the system from booting up). Workaround is to compile and run following program (need <code>sudo</code>) after system is fully booted up.
</p>
<pre>#include &lt;stdio.h&gt;
#include &lt;sys/io.h&gt;

#define GMUX_PORT_SWITCH_DISPLAY	0x10
#define GMUX_PORT_SWITCH_DDC		0x28
#define GMUX_PORT_SWITCH_EXTERNAL	0x40
#define GMUX_PORT_DISCRETE_POWER	0x50
#define GMUX_PORT_VALUE			0xc2
#define GMUX_PORT_READ			0xd0
#define GMUX_PORT_WRITE			0xd4

#define GMUX_IOSTART		0x700

typedef unsigned char u8;

enum discrete_state {STATE_ON, STATE_OFF};
enum gpu_id {IGD, DIS};

static void index_write8(int port, u8 val)
{
	outb(val, GMUX_IOSTART + GMUX_PORT_VALUE);
	outb((port &amp; 0xff), GMUX_IOSTART + GMUX_PORT_WRITE);
}

static u8 index_read8(int port)
{
	u8 val;
	outb((port &amp; 0xff), GMUX_IOSTART + GMUX_PORT_READ);
	val = inb(GMUX_IOSTART + GMUX_PORT_VALUE);

	return val;
}

static void set_discrete_state(enum discrete_state state)
{
	if (state == STATE_ON) {	// switch on dGPU
		index_write8(GMUX_PORT_DISCRETE_POWER, 1);
		index_write8(GMUX_PORT_DISCRETE_POWER, 3);
	} else {			// switch off dGPU
		index_write8(GMUX_PORT_DISCRETE_POWER, 1);
		index_write8(GMUX_PORT_DISCRETE_POWER, 0);
	}
}

static u8 get_discrete_state()
{
	return index_read8(GMUX_PORT_DISCRETE_POWER);
}

static void switchto(enum gpu_id id)
{
	if (id == IGD) {	// switch to iGPU
		index_write8(GMUX_PORT_SWITCH_DDC, 1);
		index_write8(GMUX_PORT_SWITCH_DISPLAY, 2);
		index_write8(GMUX_PORT_SWITCH_EXTERNAL, 2);
	} else {		// switch to dGPU
		index_write8(GMUX_PORT_SWITCH_DDC, 2);
		index_write8(GMUX_PORT_SWITCH_DISPLAY, 3);
		index_write8(GMUX_PORT_SWITCH_EXTERNAL, 3);
	}
}

int main(int argc, char **argv)
{
	if (iopl(3) &lt; 0) {
		perror("No IO permissions");
		return 1;
	}

	//switchto(IGD);
	set_discrete_state(STATE_OFF);
	//printf("Discrete state: 0x%X\n", get_discrete_state());

	return 0;
}</pre>
<p>For further information, please read <a rel="nofollow" class="external text" href="https://git.kernel.org/cgit/linux/kernel/git/torvalds/linux.git/tree/drivers/platform/x86/apple-gmux.c">apple-gmux</a> driver inside linux kernel tree.
</p>
</li>
<li>
"rmmod nouveau" will crash if the dGPU is manually powered off via vgaswitcheroo. Once this happens, it will be impossible to shutdown / reboot cleanly. Fresh patches (2 August) will hopefully fix this in the future. (Note: to enter this failure state, you must use gfxCardStatus to force the iGPU, then use vgaswitcheroo explicitly. This is rather uncommon.)
</li>
<li>
The dGPU / iGPU issues do not affect the 13" rmbp, which only has an intel adapter. Much simpler!
</li>
</ul>
</li>
<li>
Nvidia drivers 319.32 fail to suspend / resume or control the backlight out of the box.
<ul>
<li>
Nouveau and intel work fine.
</li>
</ul>
</li>
<li>
If you are experiencing problems with Nvidia drivers, try using emulated BIOS boot instead of EFI boot.
</li>
</ul>
<p><br>
</p>
<h2><span class="mw-headline" id="Discussions">Discussions</span></h2>
<p>Here are a couple of interesting threads:
</p>
<ul>
<li><a rel="nofollow" class="external free" href="http://ubuntuforums.org/showthread.php?t=2006475">http://ubuntuforums.org/showthread.php?t=2006475</a></li>
<li><a rel="nofollow" class="external free" href="https://bbs.archlinux.org/viewtopic.php?id=144255&amp;p=1">https://bbs.archlinux.org/viewtopic.php?id=144255&amp;p=1</a></li>
</ul>
<h2><span class="mw-headline" id="See_also">See also</span></h2>
<ul><li>A <a href="../en/Puppet.html" title="Puppet">Puppet</a> module for installing and configuring Arch (optionally with KDE) on the MBP Retina 10,2, along with initial install instructions, is available at <a rel="nofollow" class="external autonumber" href="https://github.com/jantman/puppet-archlinux-macbookretina">[2]</a>. It is updated quite frequently, and run daily on its author's laptop.</li></ul>
</div>
</div>
<div id="catlinks" class="catlinks" data-mw="interface">
<div id="mw-normal-catlinks" class="mw-normal-catlinks">
<a href="../Special:Categories.html" title="Special:Categories">Category</a>: <ul><li><a href="../en/Category:Apple.html" title="Category:Apple">Apple</a></li></ul>
</div>
<div id="mw-hidden-catlinks" class="mw-hidden-catlinks mw-hidden-cats-hidden">Hidden category: <ul><li><a href="../en/Category:Pages_with_broken_package_links.html" title="Category:Pages with broken package links">Pages with broken package links</a></li></ul>
</div>
</div>
	</div>
</div>

<footer id="footer" class="mw-footer" role="contentinfo" style="margin: 0">
	<ul id="footer-info">
		<li>Retrieved from "<a dir="ltr" href="https://wiki.archlinux.org/index.php?title=MacBookPro10,x&amp;oldid=635936">https://wiki.archlinux.org/index.php?title=MacBookPro10,x&amp;oldid=635936</a>"</li>
		<li id="footer-info-lastmod"> This page was last edited on 20 September 2020, at 07:15.</li>
		<li id="footer-info-copyright">Content is available under <a class="external" rel="nofollow" href="http://www.gnu.org/copyleft/fdl.html">GNU Free Documentation License 1.3 or later</a> unless otherwise noted.</li>
	<br>
</ul>
	<ul id="footer-places">
		<li id="footer-places-privacy"><a href="../en/ArchWiki:Privacy_policy.html" title="ArchWiki:Privacy policy">Privacy policy</a></li>
		<li id="footer-places-about"><a href="../en/ArchWiki:About.html" title="ArchWiki:About">About ArchWiki</a></li>
		<li id="footer-places-disclaimer"><a href="../en/ArchWiki:General_disclaimer.html" title="ArchWiki:General disclaimer">Disclaimers</a></li>
	</ul>
	<ul id="footer-icons" class="noprint">
		<li id="footer-copyrightico">
	</ul>
	<div style="clear: both;"></div>
</footer>



</body>
</html>
