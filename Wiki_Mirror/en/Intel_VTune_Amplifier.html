<!DOCTYPE html>
<html class="client-nojs" lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<title>Intel VTune Amplifier - ArchWiki</title>
<link rel="stylesheet" href="../ArchWikiOffline.css">
<meta name="ResourceLoaderDynamicStyles" content="">
<meta name="generator" content="MediaWiki 1.35.0">
<meta name="robots" content="noindex,follow">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="shortcut icon" href="/favicon.ico">
<link rel="search" type="application/opensearchdescription+xml" href="/opensearch_desc.php" title="ArchWiki (en)">
<link rel="EditURI" type="application/rsd+xml" href="https://wiki.archlinux.org/api.php?action=rsd">
<link rel="license" href="http://www.gnu.org/copyleft/fdl.html">
<link rel="alternate" type="application/atom+xml" title="ArchWiki Atom feed" href="/index.php?title=Special:RecentChanges&amp;feed=atom">
</head>
<body class="mediawiki ltr sitedir-ltr mw-hide-empty-elt ns-0 ns-subject page-Intel_VTune_Amplifier rootpage-Intel_VTune_Amplifier skin-vector action-view skin-vector-legacy">
<div id="content" class="mw-body" role="main" style="margin: 0">
	<a id="top"></a>
	<div id="siteNotice" class="mw-body-content"></div>
	<div class="mw-indicators mw-body-content">
	</div>
	<h1 id="firstHeading" class="firstHeading" lang="en">Intel VTune Amplifier</h1>
	<div id="bodyContent" class="mw-body-content">
		<div id="siteSub" class="noprint">From ArchWiki</div>
		<div id="contentSub"></div>
		<div id="contentSub2"></div>
		
		<div id="jump-to-nav"></div>
		<a class="mw-jump-link" href="#mw-head">Jump to navigation</a>
		<a class="mw-jump-link" href="#searchInput">Jump to search</a>
		<div id="mw-content-text" lang="en" dir="ltr" class="mw-content-ltr">
<div class="warningbox">The printable version is no longer supported and may have rendering errors. Please update your browser bookmarks and please use the default browser print function instead.</div>
<div class="mw-parser-output">
<p><a rel="nofollow" class="external text" href="https://software.intel.com/intel-vtune-amplifier-xe/">Intel VTune Amplifier</a> is a commercial software performance profiler for Intel processors. There is a free 30 day trial.
</p>
<div id="toc" class="toc" role="navigation" aria-labelledby="mw-toc-heading">
<input type="checkbox" role="button" id="toctogglecheckbox" class="toctogglecheckbox" style="display:none"><div class="toctitle" lang="en" dir="ltr">
<h2 id="mw-toc-heading">Contents</h2>
<span class="toctogglespan"><label class="toctogglelabel" for="toctogglecheckbox"></label></span>
</div>
<ul>
<li class="toclevel-1 tocsection-1">
<a href="#Linux_4.0"><span class="tocnumber">1</span> <span class="toctext">Linux 4.0</span></a>
<ul>
<li class="toclevel-2 tocsection-2"><a href="#Compiling_the_Kernel_Modules"><span class="tocnumber">1.1</span> <span class="toctext">Compiling the Kernel Modules</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-3">
<a href="#VTune_Amplifier_XE_2013"><span class="tocnumber">2</span> <span class="toctext">VTune Amplifier XE 2013</span></a>
<ul>
<li class="toclevel-2 tocsection-4"><a href="#Missing_asm/system.h"><span class="tocnumber">2.1</span> <span class="toctext">Missing asm/system.h</span></a></li>
<li class="toclevel-2 tocsection-5"><a href="#Implicit_declaration_of_this_cpu_read"><span class="tocnumber">2.2</span> <span class="toctext">Implicit declaration of this_cpu_read</span></a></li>
<li class="toclevel-2 tocsection-6"><a href="#kmap_atomic_and_kunmap_atomic_deprecated"><span class="tocnumber">2.3</span> <span class="toctext">kmap_atomic and kunmap_atomic deprecated</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-7">
<a href="#VTune_Amplifier_XE_2011"><span class="tocnumber">3</span> <span class="toctext">VTune Amplifier XE 2011</span></a>
<ul>
<li class="toclevel-2 tocsection-8"><a href="#Installing_VTune"><span class="tocnumber">3.1</span> <span class="toctext">Installing VTune</span></a></li>
</ul>
</li>
</ul>
</div>

<h2><span class="mw-headline" id="Linux_4.0">Linux 4.0</span></h2>
<p>VTune 2015 currently does not work with Linux 4.0, due to changes in the kernel that prevent the sepdk module from building.  You need VTune 2016 which was released in August 2015. 
</p>
<h3><span class="mw-headline" id="Compiling_the_Kernel_Modules">Compiling the Kernel Modules</span></h3>
<p>To build the kernel modules on Arch you should follow the 4th part of the README on sepdk folder. You can follow the <a href="../en/Compile_kernel_module.html" title="Compile kernel module">Compile kernel module</a> with <a href="../en/Kernel/Traditional_compilation.html#Download_the_kernel_source" class="mw-redirect" title="Kernels/Traditional compilation">Kernels/Traditional compilation#Download the kernel source</a>, downloading the source code to <code>/usr/src/</code>, extracting it with the name following the README and following the steps to unpack the kernel source. 
</p>
<p>There is a problem on the script <code>./build-driver</code> that some users could not run the funcion <code>get_absolute_path()</code> so you should hardcode the variables <code>DRIVER_DIRECTORY</code> and <code>KERNEL_SRC_DIR</code>.
</p>
<p>Also, there is a bug when trying to compile the kernel modules with kernel 4.10. <a rel="nofollow" class="external text" href="https://software.intel.com/en-us/forums/intel-vtune-amplifier-xe/topic/722656">Intel forum post</a>
</p>
<h2><span class="mw-headline" id="VTune_Amplifier_XE_2013">VTune Amplifier XE 2013</span></h2>
<p>Follow the instructions for 2011. If you see errors while building the driver, 
it may be because intel is using deprecated functionality subsections. In the following 
sections, lines beginning with "-" indicates code that should be removed, lines beginning 
with "+" should be added.
</p>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Note:</strong> The following steps should not be need as of update5.</div>
<h3>
<span id="Missing_asm.2Fsystem.h"></span><span class="mw-headline" id="Missing_asm/system.h">Missing asm/system.h</span>
</h3>
<p>Edit <code>lwpmudrv.c</code> as follows:
</p>
<pre>-#include &lt;asm/system.h&gt;
+#include &lt;linux/version.h&gt;
</pre>
<h3><span class="mw-headline" id="Implicit_declaration_of_this_cpu_read">Implicit declaration of this_cpu_read</span></h3>
<p>Edit <code>eventmux.c</code> as follows:
</p>
<pre>+#include &lt;linux/percpu.h&gt;
</pre>
<h3><span class="mw-headline" id="kmap_atomic_and_kunmap_atomic_deprecated">kmap_atomic and kunmap_atomic deprecated</span></h3>
<p>Edit <code>vtssp/user_vm.c</code> as follows:
</p>
<pre>-this-&gt;m_maddr = kmap_atomic(this-&gt;m_page, in_nmi() ? KM_NMI : KM_IRQ0);
+this-&gt;m_maddr = kmap_atomic(this-&gt;m_page);
-kunmap_atomic(this-&gt;m_maddr, in_nmi() ? KM_NMI : KM_IRQ0);
+kunmap_atomic(this-&gt;m_maddr);
</pre>
<h2><span class="mw-headline" id="VTune_Amplifier_XE_2011">VTune Amplifier XE 2011</span></h2>
<p>Starting with update 7 of the VTune Amplifier XE 2011, you can now use it on Linux 3.x and hence on Arch Linux, even though the latter is not officially supported. See also: <a rel="nofollow" class="external text" href="http://software.intel.com/en-us/forums/showthread.php?t=102037&amp;p=1#171754">VTune on Archlinux</a><sup title="Last check status: too many redirects">[<a href="https://en.wikipedia.org/wiki/Wikipedia:Link_rot" class="extiw" title="wikipedia:Wikipedia:Link rot">dead link</a> 2020-03-29 ⓘ]</sup>
</p>
<h3><span class="mw-headline" id="Installing_VTune">Installing VTune</span></h3>
<p>Using the following HOWTO you "install" VTune locally and can run it. Vtune requires a kernel module for all functionality. Nevertheless, VTune in user mode is very powerful and comes with lots of possibilities for profiling. Have fun!
</p>
<p>Preparation:
</p>
<ul>
<li>download VTune Amplifier XE 2011 (there is a <a rel="nofollow" class="external text" href="https://software.intel.com/en-us/qualify-for-free-software">free version</a> for non-commercial use on linux)</li>
<li>unpack the tarball</li>
<li>install <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=libpng12">libpng12</a></span>
</li>
<li>install <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://aur.archlinux.org/packages/libjpeg6/">libjpeg6</a></span><sup><small>AUR</small></sup><sup>[<a href="../en/Help:Procedures.html#Fix_broken_package_links" title="Help:Procedures">broken link</a>: package not found]</sup>
</li>
<li>install <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=rpmextract">rpmextract</a></span>
</li>
<li>Install the appropriate headers package(s) for your installed kernel(s), such as <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=linux-headers">linux-headers</a></span> or <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=linux-lts-headers">linux-lts-headers</a></span>.</li>
<li>if using a custom kernel, ensure that your kernel is compiled with the following options:
<ul>
<li><code>CONFIG_MODULES=y</code></li>
<li><code>CONFIG_MODULE_UNLOAD=y</code></li>
<li><code>CONFIG_SMP=y</code></li>
<li><code>CONFIG_KPROBES=y</code></li>
<li><code>CONFIG_PROFILING=y</code></li>
<li><code>CONFIG_OPROFILE=y</code></li>
</ul>
</li>
</ul>
<p>Now to "install" <i>vtune</i>:
</p>
<pre>cd vtune_amplifier_xe_2011_update7
find -name "*.rpm" -exec rpmextract.sh {} \;
</pre>
<p>Kernel module:
</p>
<ul>
<li>Create the group <code>vtune</code> and add yourself.</li>
<li>Build and load the driver in <code>/opt/intel/vtune_amplifier_xe_2011/sepdk/src/</code>
</li>
</ul>
<pre>./build-driver
./insmod-sep3 -g vtune
</pre>
<ul><li>Add your license file to <code>/opt/intel/licenses/</code>
</li></ul>
<p>You can now start <i>vtune</i>:
</p>
<pre>./opt/intel/vtune_amplifier_xe_2011/bin64/amplxe-gui
</pre>
<p>For ease-of-use, it is recommended that you move the <code>./opt/intel/vtune_amplifier_xe_2011</code> to your homefolder or similar and add a symlink to the <code>amplxe-gui</code> binary to one of your PATH folders or similar.
</p>
</div>
</div>
<div id="catlinks" class="catlinks" data-mw="interface">
<div id="mw-normal-catlinks" class="mw-normal-catlinks">
<a href="../Special:Categories.html" title="Special:Categories">Category</a>: <ul><li><a href="../en/Category:Development.html" title="Category:Development">Development</a></li></ul>
</div>
<div id="mw-hidden-catlinks" class="mw-hidden-catlinks mw-hidden-cats-hidden">Hidden categories: <ul>
<li><a href="../en/Category:Pages_with_dead_links.html" title="Category:Pages with dead links">Pages with dead links</a></li>
<li><a href="../en/Category:Pages_with_broken_package_links.html" title="Category:Pages with broken package links">Pages with broken package links</a></li>
</ul>
</div>
</div>
	</div>
</div>

<footer id="footer" class="mw-footer" role="contentinfo" style="margin: 0">
	<ul id="footer-info">
		<li>Retrieved from "<a dir="ltr" href="https://wiki.archlinux.org/index.php?title=Intel_VTune_Amplifier&amp;oldid=632214">https://wiki.archlinux.org/index.php?title=Intel_VTune_Amplifier&amp;oldid=632214</a>"</li>
		<li id="footer-info-lastmod"> This page was last edited on 17 August 2020, at 09:37.</li>
		<li id="footer-info-copyright">Content is available under <a class="external" rel="nofollow" href="http://www.gnu.org/copyleft/fdl.html">GNU Free Documentation License 1.3 or later</a> unless otherwise noted.</li>
	<br>
</ul>
	<ul id="footer-places">
		<li id="footer-places-privacy"><a href="../en/ArchWiki:Privacy_policy.html" title="ArchWiki:Privacy policy">Privacy policy</a></li>
		<li id="footer-places-about"><a href="../en/ArchWiki:About.html" title="ArchWiki:About">About ArchWiki</a></li>
		<li id="footer-places-disclaimer"><a href="../en/ArchWiki:General_disclaimer.html" title="ArchWiki:General disclaimer">Disclaimers</a></li>
	</ul>
	<ul id="footer-icons" class="noprint">
		<li id="footer-copyrightico">
	</ul>
	<div style="clear: both;"></div>
</footer>



</body>
</html>
