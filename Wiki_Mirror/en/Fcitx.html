<!DOCTYPE html>
<html class="client-nojs" lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<title>Fcitx - ArchWiki</title>
<link rel="stylesheet" href="../ArchWikiOffline.css">
<meta name="ResourceLoaderDynamicStyles" content="">
<meta name="generator" content="MediaWiki 1.35.0">
<meta name="referrer" content="no-referrer-when-downgrade">
<meta name="robots" content="noindex,follow">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="shortcut icon" href="/favicon.ico">
<link rel="search" type="application/opensearchdescription+xml" href="/opensearch_desc.php" title="ArchWiki (en)">
<link rel="EditURI" type="application/rsd+xml" href="https://wiki.archlinux.org/api.php?action=rsd">
<link rel="license" href="http://www.gnu.org/copyleft/fdl.html">
<link rel="alternate" type="application/atom+xml" title="ArchWiki Atom feed" href="/index.php?title=Special:RecentChanges&amp;feed=atom">
</head>
<body class="mediawiki ltr sitedir-ltr mw-hide-empty-elt ns-0 ns-subject page-Fcitx rootpage-Fcitx skin-vector action-view skin-vector-legacy">
<div id="content" class="mw-body" role="main" style="margin: 0">
	<a id="top"></a>
	<div id="siteNotice" class="mw-body-content"></div>
	<div class="mw-indicators mw-body-content">
	</div>
	<h1 id="firstHeading" class="firstHeading" lang="en">Fcitx</h1>
	<div id="bodyContent" class="mw-body-content">
		<div id="siteSub" class="noprint">From ArchWiki</div>
		<div id="contentSub"></div>
		<div id="contentSub2"></div>
		
		<div id="jump-to-nav"></div>
		<a class="mw-jump-link" href="#mw-head">Jump to navigation</a>
		<a class="mw-jump-link" href="#searchInput">Jump to search</a>
		<div id="mw-content-text" lang="en" dir="ltr" class="mw-content-ltr">
<div class="warningbox">The printable version is no longer supported and may have rendering errors. Please update your browser bookmarks and please use the default browser print function instead.</div>
<div class="mw-parser-output">
<div class="archwiki-template-meta-related-articles-start">
<p>Related articles</p>
<ul>
<li><a href="/title/Fcitx5" title="Fcitx5">Fcitx5</a></li>
<li><a href="/title/IBus" title="IBus">IBus</a></li>
<li><a href="/title/SCIM" class="mw-redirect" title="SCIM">SCIM</a></li>
<li><a href="/title/Uim" title="Uim">uim</a></li>
</ul>
</div>
<p><a href="https://en.wikipedia.org/wiki/Fcitx" class="extiw" title="wikipedia:Fcitx">Fcitx</a> is a lightweight <a href="/title/Input_method" title="Input method">input method</a> framework aimed at providing environment independent language support for Linux. It supports a lot of different languages and also provides many useful non-CJK features.
</p>
<div id="toc" class="toc" role="navigation" aria-labelledby="mw-toc-heading">
<input type="checkbox" role="button" id="toctogglecheckbox" class="toctogglecheckbox" style="display:none"><div class="toctitle" lang="en" dir="ltr">
<h2 id="mw-toc-heading">Contents</h2>
<span class="toctogglespan"><label class="toctogglelabel" for="toctogglecheckbox"></label></span>
</div>
<ul>
<li class="toclevel-1 tocsection-1">
<a href="#Installation"><span class="tocnumber">1</span> <span class="toctext">Installation</span></a>
<ul>
<li class="toclevel-2 tocsection-2">
<a href="#Input_method_engines"><span class="tocnumber">1.1</span> <span class="toctext">Input method engines</span></a>
<ul>
<li class="toclevel-3 tocsection-3"><a href="#Chinese"><span class="tocnumber">1.1.1</span> <span class="toctext">Chinese</span></a></li>
<li class="toclevel-3 tocsection-4"><a href="#Japanese"><span class="tocnumber">1.1.2</span> <span class="toctext">Japanese</span></a></li>
<li class="toclevel-3 tocsection-5"><a href="#Other_languages"><span class="tocnumber">1.1.3</span> <span class="toctext">Other languages</span></a></li>
</ul>
</li>
<li class="toclevel-2 tocsection-6"><a href="#Input_method_module"><span class="tocnumber">1.2</span> <span class="toctext">Input method module</span></a></li>
<li class="toclevel-2 tocsection-7"><a href="#Others"><span class="tocnumber">1.3</span> <span class="toctext">Others</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-8">
<a href="#Usage"><span class="tocnumber">2</span> <span class="toctext">Usage</span></a>
<ul>
<li class="toclevel-2 tocsection-9"><a href="#Desktop_Environment_Autostart"><span class="tocnumber">2.1</span> <span class="toctext">Desktop Environment Autostart</span></a></li>
<li class="toclevel-2 tocsection-10"><a href="#Set_environment_variables_for_IM_modules"><span class="tocnumber">2.2</span> <span class="toctext">Set environment variables for IM modules</span></a></li>
<li class="toclevel-2 tocsection-11"><a href="#XIM"><span class="tocnumber">2.3</span> <span class="toctext">XIM</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-12">
<a href="#Configuration"><span class="tocnumber">3</span> <span class="toctext">Configuration</span></a>
<ul>
<li class="toclevel-2 tocsection-13"><a href="#GUI_configuration_tools"><span class="tocnumber">3.1</span> <span class="toctext">GUI configuration tools</span></a></li>
<li class="toclevel-2 tocsection-14"><a href="#Input_methods_configuration"><span class="tocnumber">3.2</span> <span class="toctext">Input methods configuration</span></a></li>
<li class="toclevel-2 tocsection-15"><a href="#Change_default_UI"><span class="tocnumber">3.3</span> <span class="toctext">Change default UI</span></a></li>
<li class="toclevel-2 tocsection-16"><a href="#Extend_pinyin_dictionary"><span class="tocnumber">3.4</span> <span class="toctext">Extend pinyin dictionary</span></a></li>
<li class="toclevel-2 tocsection-17"><a href="#Skins"><span class="tocnumber">3.5</span> <span class="toctext">Skins</span></a></li>
<li class="toclevel-2 tocsection-18"><a href="#Cloud_Pinyin_configuration"><span class="tocnumber">3.6</span> <span class="toctext">Cloud Pinyin configuration</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-19">
<a href="#Tips_and_tricks"><span class="tocnumber">4</span> <span class="toctext">Tips and tricks</span></a>
<ul>
<li class="toclevel-2 tocsection-20"><a href="#Shortcut_keys"><span class="tocnumber">4.1</span> <span class="toctext">Shortcut keys</span></a></li>
<li class="toclevel-2 tocsection-21"><a href="#Vim"><span class="tocnumber">4.2</span> <span class="toctext">Vim</span></a></li>
<li class="toclevel-2 tocsection-22"><a href="#Clipboard"><span class="tocnumber">4.3</span> <span class="toctext">Clipboard</span></a></li>
<li class="toclevel-2 tocsection-23"><a href="#Special_symbols"><span class="tocnumber">4.4</span> <span class="toctext">Special symbols</span></a></li>
<li class="toclevel-2 tocsection-24"><a href="#Clipboard_Access"><span class="tocnumber">4.5</span> <span class="toctext">Clipboard Access</span></a></li>
<li class="toclevel-2 tocsection-25"><a href="#fcitx-remote"><span class="tocnumber">4.6</span> <span class="toctext">fcitx-remote</span></a></li>
<li class="toclevel-2 tocsection-26"><a href="#Input_special_character"><span class="tocnumber">4.7</span> <span class="toctext">Input special character</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-27">
<a href="#Troubleshooting"><span class="tocnumber">5</span> <span class="toctext">Troubleshooting</span></a>
<ul>
<li class="toclevel-2 tocsection-28"><a href="#Disable_or_change_Extra_key_for_trigger_input_method_%5Bsic%5D"><span class="tocnumber">5.1</span> <span class="toctext">Disable or change <i>Extra key for trigger input method</i> [sic]</span></a></li>
<li class="toclevel-2 tocsection-29"><a href="#Diagnose_the_problem"><span class="tocnumber">5.2</span> <span class="toctext">Diagnose the problem</span></a></li>
<li class="toclevel-2 tocsection-30">
<a href="#Emacs"><span class="tocnumber">5.3</span> <span class="toctext">Emacs</span></a>
<ul>
<li class="toclevel-3 tocsection-31"><a href="#Emacs_Daemon"><span class="tocnumber">5.3.1</span> <span class="toctext">Emacs Daemon</span></a></li>
</ul>
</li>
<li class="toclevel-2 tocsection-32"><a href="#Ctrl+Space_fail_to_work_in_GTK_programs"><span class="tocnumber">5.4</span> <span class="toctext">Ctrl+Space fail to work in GTK programs</span></a></li>
<li class="toclevel-2 tocsection-33"><a href="#Buildin_Chinese_Pinyin_Default_NOT_ACTIVE"><span class="tocnumber">5.5</span> <span class="toctext">Buildin Chinese Pinyin Default NOT ACTIVE</span></a></li>
<li class="toclevel-2 tocsection-34"><a href="#fcitx_and_KDE"><span class="tocnumber">5.6</span> <span class="toctext">fcitx and KDE</span></a></li>
<li class="toclevel-2 tocsection-35"><a href="#Input_method_switched_to_English_unintentionally"><span class="tocnumber">5.7</span> <span class="toctext">Input method switched to English unintentionally</span></a></li>
<li class="toclevel-2 tocsection-36"><a href="#xmodmap_settings_being_overwritten"><span class="tocnumber">5.8</span> <span class="toctext">xmodmap settings being overwritten</span></a></li>
<li class="toclevel-2 tocsection-37"><a href="#Fcitx_preedit_box_is_too_small_with_HiDPI"><span class="tocnumber">5.9</span> <span class="toctext">Fcitx preedit box is too small with HiDPI</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-38"><a href="#See_also"><span class="tocnumber">6</span> <span class="toctext">See also</span></a></li>
</ul>
</div>

<h2><span class="mw-headline" id="Installation">Installation</span></h2>
<p><a href="/title/Install" class="mw-redirect" title="Install">Install</a> the <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=fcitx">fcitx</a></span> package.
</p>
<h3><span class="mw-headline" id="Input_method_engines">Input method engines</span></h3>
<p>Fcitx provides built-in input methods for Chinese <a href="https://en.wikipedia.org/wiki/Pinyin" class="extiw" title="wikipedia:Pinyin">Pinyin</a> and table-based input (for example <a href="https://en.wikipedia.org/wiki/Wubi_method" class="extiw" title="wikipedia:Wubi method">Wubi</a>).
</p>
<p>Depending on the language you wish to type, other input method engines are available:
</p>
<h4><span class="mw-headline" id="Chinese">Chinese</span></h4>
<ul>
<li>
<span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://aur.archlinux.org/packages/fcitx-baidupinyin/">fcitx-baidupinyin</a></span><sup><small>AUR</small></sup>, fcitx wrapper for Baidu Pinyin IM engine.</li>
<li>
<span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=fcitx-chewing">fcitx-chewing</a></span> is a popular Zhuyin input engine for Traditional Chinese based on <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=libchewing">libchewing</a></span>.</li>
<li>
<span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=fcitx-cloudpinyin">fcitx-cloudpinyin</a></span> uses internet sources to provide input candidates. The selected cloud result will be added to local dictionary. It support all fcitx pinyin input method except <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=fcitx-rime">fcitx-rime</a></span>.</li>
<li>
<span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=fcitx-googlepinyin">fcitx-googlepinyin</a></span>, Googlepinyin wrapper for fcitx.</li>
<li>
<span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=fcitx-libpinyin">fcitx-libpinyin</a></span>, based on <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=libpinyin">libpinyin</a></span>. It has a better algorithm than <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=fcitx-sunpinyin">fcitx-sunpinyin</a></span>.</li>
<li>
<span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=fcitx-rime">fcitx-rime</a></span>, based on schemas from the <a href="/title/Rime_IME" class="mw-redirect" title="Rime IME">Rime IME</a> project.</li>
<li>
<span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://aur.archlinux.org/packages/fcitx-sogoupinyin/">fcitx-sogoupinyin</a></span><sup><small>AUR</small></sup>, <a rel="nofollow" class="external text" href="https://pinyin.sogou.com/linux/">Sogou input method</a> supporting Jianpin, fuzzy sound, cloud input, English input, and mixed skin.</li>
<li>
<span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=fcitx-sunpinyin">fcitx-sunpinyin</a></span>, based on <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=sunpinyin">sunpinyin</a></span>. It strikes a good balance between speed and accuracy.</li>
</ul>
<h4><span class="mw-headline" id="Japanese">Japanese</span></h4>
<ul>
<li>
<span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=fcitx-anthy">fcitx-anthy</a></span>, a popular Japanese input engine. However, it is not actively developed anymore.</li>
<li>
<span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=fcitx-mozc">fcitx-mozc</a></span>, based on <a href="/title/Mozc" title="Mozc">Mozc</a>, the Open Source Edition of Google Japanese Input.</li>
<li>
<span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=fcitx-kkc">fcitx-kkc</a></span>, a Japanese Kana Kanji input engine, based on <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=libkkc">libkkc</a></span>.</li>
<li>
<span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=fcitx-skk">fcitx-skk</a></span>, a Japanese Kana Kanji input engine, based on <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=libskk">libskk</a></span>.</li>
</ul>
<h4><span class="mw-headline" id="Other_languages">Other languages</span></h4>
<ul>
<li>
<span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=fcitx-hangul">fcitx-hangul</a></span>, for typing Korean hangul, based on <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=libhangul">libhangul</a></span>.</li>
<li>
<span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=fcitx-m17n">fcitx-m17n</a></span>, for other languages provided by <a rel="nofollow" class="external text" href="https://www.nongnu.org/m17n/">M17n</a>.</li>
<li>
<span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=fcitx-sayura">fcitx-sayura</a></span>, for typing Sinhalese.</li>
<li>
<span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=fcitx-unikey">fcitx-unikey</a></span>, for typing Vietnamese characters.</li>
</ul>
<h3><span class="mw-headline" id="Input_method_module">Input method module</span></h3>
<p>To obtain a better experience in Qt programs, install the <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://aur.archlinux.org/packages/fcitx-qt4/">fcitx-qt4</a></span><sup><small>AUR</small></sup> and <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=fcitx-qt5">fcitx-qt5</a></span> input method modules as your need, or the <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/groups/x86_64/fcitx-im/">fcitx-im</a></span> group to install <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=fcitx">fcitx</a></span> and <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=fcitx-qt5">fcitx-qt5</a></span>. Without those modules, the input method may work on most applications but you may experience input method hang up, preview window screen location error or no preview error. 
</p>
<p>Applications below do not use GTK/Qt input module: 
</p>
<ul>
<li>Applications use Tk, motif or xlib</li>
<li>Emacs, Opera, OpenOffice, LibreOffice, Skype, Wine, Java, Xterm, urxvt, WPS</li>
</ul>
<h3><span class="mw-headline" id="Others">Others</span></h3>
<ul>
<li>
<span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=fcitx-ui-light">fcitx-ui-light</a></span>, light UI for fcitx.</li>
<li>
<span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=fcitx-table-extra">fcitx-table-extra</a></span> adds <a href="https://en.wikipedia.org/wiki/Cangjie_input_method" class="extiw" title="wikipedia:Cangjie input method">Cangjie</a>, <a href="https://en.wikipedia.org/wiki/Zhengma_method" class="extiw" title="wikipedia:Zhengma method">Zhengma</a>, <a href="https://en.wikipedia.org/wiki/Boshiamy_method" class="extiw" title="wikipedia:Boshiamy method">Boshiamy</a> support.</li>
<li>
<span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=fcitx-table-other">fcitx-table-other</a></span>, tables for Latex, Emoji and others.</li>
<li><a href="#GUI_configuration_tools">#GUI configuration tools</a></li>
</ul>
<p>Others packages (including git version) are also available in the <a href="/title/AUR" class="mw-redirect" title="AUR">AUR</a>. All components of fcitx will requires fcitx to restart after install.
</p>
<h2><span class="mw-headline" id="Usage">Usage</span></h2>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Note:</strong> You need to have <a href="/title/Fonts#Chinese,_Japanese,_Korean,_Vietnamese" title="Fonts">Chinese, Japanese, Korean or Vietnamese font</a> installed to be able to enter the corresponding characters.</div>
<h3><span class="mw-headline" id="Desktop_Environment_Autostart">Desktop Environment Autostart</span></h3>
<p>If you are using any XDG compatible desktop environment such as <a href="/title/KDE" title="KDE">KDE</a>, <a href="/title/GNOME" title="GNOME">GNOME</a>, <a href="/title/Xfce" title="Xfce">Xfce</a>, <a href="/title/LXDE" title="LXDE">LXDE</a>, after you re-login, the autostart should work out of box. If not run the <i>fcitx</i> executable. To see if fcitx is working correctly, open an application and press <code>Ctrl+Space</code> (the default shortcut for switching the input method) to invoke fcitx and input some words.
</p>
<p>If fcitx failed to start with your desktop automatically or if you want to change the parameters to start fcitx, configure <a href="/title/Autostarting#On_Xorg_startup" title="Autostarting">autostart</a> or edit the <code>fcitx-autostart.desktop</code> file in your <code>~/.config/autostart/</code> directory (copy it from <code>/etc/xdg/autostart/</code> if it does not exist yet).
</p>
<p>When other input methods with xim support are also running, fcitx may fail to start due to an xim error. Ensure that no other input methods are running before you start fcitx.
</p>
<p>Also please set the following environment variables to prefer IM modules for GTK/Qt applications.
</p>
<h3><span class="mw-headline" id="Set_environment_variables_for_IM_modules">Set environment variables for IM modules</span></h3>
<p><a href="/title/Define" class="mw-redirect" title="Define">Define</a> the environment variables to register the input method modules.
Without these variables, applications may fallback to XIM protocol, except for qt5 applications which do not have XIM support and require an IM module in place.
</p>
<p>As a general recommendation, define the following environment variables in <code>~/.pam_environment</code>.
This file will be read by the <a href="/title/PAM" title="PAM">pam_env</a> module for all logins, including both X11 and Wayland sessions.
See <span class="plainlinks archwiki-template-man" title="$ man 8 pam_env"><a rel="nofollow" class="external text" href="https://man.archlinux.org/man/pam_env.8">pam_env(8)</a></span> and <span class="plainlinks archwiki-template-man" title="$ man 5 pam_env.conf"><a rel="nofollow" class="external text" href="https://man.archlinux.org/man/pam_env.conf.5">pam_env.conf(5)</a></span> for details of its syntax and usage.
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">~/.pam_environment</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">GTK_IM_MODULE DEFAULT=fcitx
QT_IM_MODULE  DEFAULT=fcitx
XMODIFIERS    DEFAULT=\@im=fcitx
</pre>
<p>In case you do not want to define the above variables in <code>~/.pam_environment</code> for all your login sessions, please consider adding them to one of the start files for your X11 session.
Most <a href="/title/Display_manager" title="Display manager">Display manager</a> such as <a href="/title/GDM" title="GDM">GDM</a> and <a href="/title/SDDM" title="SDDM">SDDM</a> will source <code>~/.xprofile</code> for X11 sessions (but not for Wayland sessions).
The syntax of <code>~/.xprofile</code> may depend on the specific <a href="/title/Display_manager" title="Display manager">Display manager</a> and your login shell, consider the following example and modify it to suit your shell syntax:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">~/.xprofile</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">export GTK_IM_MODULE=fcitx
export QT_IM_MODULE=fcitx
export XMODIFIERS=@im=fcitx
</pre>
<p>For <a href="/title/SLiM" title="SLiM">SLiM</a> or <a href="/title/Startx" class="mw-redirect" title="Startx">startx</a> users, they do NOT source <code>~/.xprofile</code>, but instead run <code>~/.xinitrc</code> to start your X11 session. Add the export lines to your <code>~/.xinitrc</code> before the <code>exec YOUR_WM</code> line:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">~/.xinitrc</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">export GTK_IM_MODULE=fcitx
export QT_IM_MODULE=fcitx
export XMODIFIERS=@im=fcitx
...
exec YOUR_WM
</pre>
<p><a href="/title/XDM" title="XDM">XDM</a> sources neither <code>~/.xprofile</code> nor <code>~/.xinitrc</code>, but rather by default will source <code>~/.xsession</code>. The syntax is much the same as for <code>~/.xinitrc</code>, except the final line should just be <code>YOUR_WM</code> instead of <code>exec YOUR_WM</code>.
</p>
<p>Re-login or reboot to make these environment changes effective.
</p>
<p>If <i>fcitx</i> process does not start automatically, you might need to add <code>fcitx &amp;</code> in your <code>~/.xinitrc</code>.
If <code>fcitx &amp;</code> does not start, type <code>sleep 2</code> after it
</p>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Note:</strong> 
<ul>
<li>Avoid <code>.bashrc</code> for this, see <a href="https://mywiki.wooledge.org/DotFiles" class="extiw" title="gregswiki:DotFiles">GregsWiki:DotFiles</a>.</li>
<li>If all Qt apps have problem with fcitx, run <i>qtconfig</i> (<i>qtconfig-qt4</i>), and go to the third tab, make sure <i>fcitx</i> is in the <i>Default Input Method</i> combo-box.</li>
</ul>
</div>
<h3><span class="mw-headline" id="XIM">XIM</span></h3>
<p>Optionally, you can use the <a href="https://en.wikipedia.org/wiki/X_Input_Method" class="extiw" title="wikipedia:X Input Method">X Input Method</a> (XIM) in your GTK and/or Qt programs without installing the above modules in which case you need to change the corresponding lines above as following:
</p>
<pre>GTK_IM_MODULE DEFAULT=xim
QT_IM_MODULE  DEFAULT=xim
</pre>
<p>If you change it in <code>~/.xprofile</code> or <code>~/.xinitrc</code>, add <code>export</code>.
</p>
<div class="archwiki-template-box archwiki-template-box-warning">
<strong>Warning:</strong>  Using XIM can sometimes cause problems including not being able to input, no cursor following, word selection window issue, application freeze on input method restart. For these XIM related problems, Fcitx cannot provide any fix or support. This is the same with any other input method framework, so please use the GTK and Qt input method modules instead of xim whenever possible</div>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Note:</strong> Gtk2 uses <code>/usr/lib/gtk-2.0/2.10.0/immodules.cache</code> as immodule cache file since 2.24.20. If you have set <code>GTM_IM_MODULE_FILE</code> environment variable or do not use install script of official packages to update the cache, please change/clear the environment variable and use <code>/usr/bin/gtk-query-immodules-2.0 --update-cache</code> to update immodule cache.</div>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Note:</strong>  Qt5 applications no longer support XIM protocol as Qt4 did, and rely on IM modules entirely for communicating with fcitx.</div>
<h2><span class="mw-headline" id="Configuration">Configuration</span></h2>
<h3><span class="mw-headline" id="GUI_configuration_tools">GUI configuration tools</span></h3>
<p>fcitx provides a <a href="/title/KDE" title="KDE">KDE</a> configuration module (<span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=kcm-fcitx">kcm-fcitx</a></span>) and a GTK3 configuration tool (<span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=fcitx-configtool">fcitx-configtool</a></span>).
</p>
<p>Run <i>fcitx-config-gtk3</i> after <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=fcitx-configtool">fcitx-configtool</a></span> is installed. Unset <i>Only Show Current Language</i> if you want to enable an input method for a different language.
</p>
<p>Stop fcitx manually before changing configuration, or the change may be lost.  
</p>
<p>In order to enable spell checking, press <code>Ctrl+Alt+h</code> when fcitx is on an input method provided by fcitx-keyboard.
</p>
<h3><span class="mw-headline" id="Input_methods_configuration">Input methods configuration</span></h3>
<p>You can add/remove input methods in the GUI tools. Note that the search is case sensitive.
</p>
<p>The first set input method is the inactive state, while all the rest will be active states. You generally want the inactive state to be one of the <i>Keyboard</i> options (e.g. "Keyboard - English (US)"). These options just input based on the keyboard layout in the name.
</p>
<p>Under <i>Global Config</i>, the <i>Trigger Input Method</i> shortcut will only switch between the inactive and last used active state. The <i>Scroll between Input Methods</i> will by default only scroll between different active states, but can also be set to include the inactive state in the advanced settings. Furthermore, the <i>Scroll between Input Methods</i> shortcut has to be pressed in order, e.g. <code>ALT_SHIFT</code> will only activate if <code>alt</code> is pressed before <code>shift</code>.
</p>
<p>Configuration settings for IME's can be found by by setting the keyboard to the desired IME and right-clicking the tray icon.
</p>
<h3><span class="mw-headline" id="Change_default_UI">Change default UI</span></h3>
<p>Fcitx support kimpanel protocol to provide better desktop integration.
</p>
<ul>
<li>Gnome-Shell: You can install kimpanel from extensions.gnome.org or <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://aur.archlinux.org/packages/gnome-shell-extension-kimpanel-git/">gnome-shell-extension-kimpanel-git</a></span><sup><small>AUR</small></sup>, which provides a similar user experience as ibus-gjs.</li>
<li>KDE: <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=kimtoy">kimtoy</a></span> could use skin from Sogou and fcitx.</li>
</ul>
<h3><span class="mw-headline" id="Extend_pinyin_dictionary">Extend pinyin dictionary</span></h3>
<p>Pinyin dictionary is located at <code>~/.config/fcitx/pinyin</code>. File <code>pybase.mb</code> is for single characters and file <code>pyphrase.mb</code> defines pinyin phrases. To extend them, put your file into <code>/usr/share/fcitx/pinyin</code> and restart fcitx.
</p>
<h3><span class="mw-headline" id="Skins">Skins</span></h3>
<p>You can download skins and extract them to one of the following directories, you can create the directory if it does not exist:
</p>
<pre>/usr/share/fcitx/skin   #Global settings
~/.config/fcitx/skin    #User settings
</pre>
<h3><span class="mw-headline" id="Cloud_Pinyin_configuration">Cloud Pinyin configuration</span></h3>
<p>After installing the <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=fcitx-cloudpinyin">fcitx-cloudpinyin</a></span> input method, restart fcitx. If you could not find it in configuration GUI, enable advanced settings. The cloud query result will be added to current input method dictionary automatically. 
</p>
<p>If your network prevents you from accessing Google, change Cloud Pinyin source to Baidu.
</p>
<p>The query result from cloud will list as secondary candidate by default and it is configurable. If the result already exists, only one item is shown. 
</p>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Note:</strong> Set query result as first candidate is not recommend because the dictionary order will be changed if query returns an empty result</div>
<h2><span class="mw-headline" id="Tips_and_tricks">Tips and tricks</span></h2>
<h3><span class="mw-headline" id="Shortcut_keys">Shortcut keys</span></h3>
<p>Some commonly used default shortcut keys:
</p>
<ul>
<li>
<code>Ctrl+Space</code> - activates the input method</li>
<li>
<code>Left Shift</code> - temporarily switches to English</li>
<li>
<code>Ctrl+Shift</code> - switch between input methods</li>
<li>
<code>-</code>/<code>=</code> - page forward/backward</li>
<li>
<code>Shift+Space</code> - Full-width, half-width switching</li>
</ul>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Note:</strong> You can modify these shortcut keys in the global configuration of the configuration interface.</div>
<h3><span class="mw-headline" id="Vim">Vim</span></h3>
<p>If you often use Fcitx under Vim, you can install the <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://aur.archlinux.org/packages/vim-fcitx/">vim-fcitx</a></span><sup><small>AUR</small></sup> plugin, or add the following code to <code>~/.vimrc</code>. When exiting insert mode, Fcitx is automatically closed, otherwise the reverse:
</p>
<pre>"##### auto fcitx  ###########
let g:input_toggle = 1
function! Fcitx2en()
   let s:input_status = system("fcitx-remote")
   if s:input_status == 2
      let g:input_toggle = 1
      let l:a = system("fcitx-remote -c")
   endif
endfunction

function! Fcitx2zh()
   let s:input_status = system("fcitx-remote")
   if s:input_status != 2 &amp;&amp; g:input_toggle == 1
      let l:a = system("fcitx-remote -o")
      let g:input_toggle = 0
   endif
endfunction

set ttimeoutlen=150
"Exit insert mode
autocmd InsertLeave * call Fcitx2en()
"Enter insert mode
autocmd InsertEnter * call Fcitx2zh()
"##### auto fcitx end ######
</pre>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Note:</strong> Due to calling external programs, this will significantly slow down the mapping that will repeatedly enter and exit insert mode. It is recommended to rewrite the relevant mapping, and use Vim with Python support in conjunction with fcitx.vim to improve efficiency.</div>
<h3><span class="mw-headline" id="Clipboard">Clipboard</span></h3>
<p><a rel="nofollow" class="external text" href="https://www.csslayer.info/wordpress/fcitx-dev/fcitx-clipboard/">Fcitx comes with a clipboard</a>, the shortcut key is <code>Ctrl+;</code>, a small function to save the world.
</p>
<h3><span class="mw-headline" id="Special_symbols">Special symbols</span></h3>
<p>Create <code>~/.config/fcitx/data/pySym.mb</code>, the content of the file is as follows:
</p>
<pre> #The first line with "#" is a comment
 #Format: coding symbol
 #Code can only be lowercase letters, after pinyin analysis, the longest is 10 (such as py is 2, pinyin is also 2)
 #Mathematics symbols
 sxfh ＋
 sxfh －
 sxfh ＜
 sxfh ＝
 sxfh ＞
 sxfh ±
 sxfh ×
 sxfh ÷
 sxfh ∈
 sxfh ∏
 sxfh ∑
 sxfh ∕
 sxfh √
 sxfh ∝
</pre>
<p>Enter a code directly to match the corresponding special symbol.
</p>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Note:</strong> The encoding can only be expressed with twenty-six lowercase letters; starting with v is invalid.</div>
<h3><span class="mw-headline" id="Clipboard_Access">Clipboard Access</span></h3>
<p>You can use fcitx to input text in you clipboard (as well as a short clipboard history and primary selection). The default trigger key is <code>Ctrl-;</code>. You can change the trigger key as well as other options in the Clipboard addon configure page.
</p>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Note:</strong> This is NOT a clipboard manager, it does not hold the selection or change its content as what a clipboard manager is supposed to do. It can only be used to input from the clipboard.</div>
<div class="archwiki-template-box archwiki-template-box-warning">
<strong>Warning:</strong>  Some clients do not support multi-line input, so you may see the multi-line clipboard content pasted as a single line using fcitx-clipboard. This is either a bug or feature of the program being used and it is not something fcitx is able to help with.</div>
<h3><span class="mw-headline" id="fcitx-remote">fcitx-remote</span></h3>
<p><i>fcitx-remote</i> is a commandline tool that can be used to control the fcitx state. It is installed with the <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=fcitx">fcitx</a></span> package.
</p>
<p>One option worth elaborating upon here is <code>fcitx-remote -s <i>imname</i></code>, which switches to the input method identified by <code><i>imname</i></code>. The correct <code><i>imname</i></code> for an in use input method can be found by executing <i>fcitx-diagnose</i>, and looking under the "## Input Methods:" section.
</p>
<h3><span class="mw-headline" id="Input_special_character">Input special character</span></h3>
<p>See <a href="/title/Fcitx5#Input_special_character" title="Fcitx5">Fcitx5#Input special character</a>, this content also applies to Fcitx.
</p>
<h2><span class="mw-headline" id="Troubleshooting">Troubleshooting</span></h2>
<h3>
<span id="Disable_or_change_Extra_key_for_trigger_input_method_.5Bsic.5D"></span><span class="mw-headline" id="Disable_or_change_Extra_key_for_trigger_input_method_[sic]">Disable or change <i>Extra key for trigger input method</i> [sic]</span>
</h3>
<p>This setting is under the <i>Global Config</i> tab and defaults to <i>SHIFT Both</i>, meaning that pressing <i>either</i> shift key will immediately change input methods. Although it should only apply when a shift key is pressed individually, it tends to randomly interrupt typing capital letters, selecting text with the keyboard, etc. while using standard keyboard input.
</p>
<p>In addition, this setting may revert to default without warning at any time. To ensure fcitx's config cannot be modified, you must make fcitx's config file immutable: <code>chattr +i ~/.config/fcitx/config</code> (as the root user).
</p>
<h3><span class="mw-headline" id="Diagnose_the_problem">Diagnose the problem</span></h3>
<p>If you have problems using fcitx, eg. Ctrl+Space fail to work in all applications, then the first thing you should try is to diagnose using <code>fcitx-diagnose</code>.
The output of <code>fcitx-diagnose</code> should contain the clue to most common problems.
Providing the output of it will also help when you consult other people(eg. in IRC or forums).
</p>
<h3><span class="mw-headline" id="Emacs">Emacs</span></h3>
<p>If your <code>LC_CTYPE</code> is English, you may not be able to use input method in emacs due to an old emacs bug. You can set your <code>LC_CTYPE</code> to something else such as <code>zh_CN.UTF-8</code> before emacs starts to get rid of this problem. 
</p>
<p>Note that the corresponding <a href="/title/Locale" title="Locale">locale</a> should be <a href="/title/Locale#Generating_locales" title="Locale">generated</a> on your your system.
</p>
<p>The default fontset will use `-*-*-*-r-normal--14-*-*-*-*-*-*-*' as basefont (in <code>src/xfns.c</code>), if you do not have one matched (like terminus or 75dpi things, you can look the output of `xlsfonts'), XIM can not be activated. According to <a rel="nofollow" class="external text" href="https://fcitx-im.org/wiki/FAQ#Emacs">FAQ</a> and <a href="/title/Fonts#Bitmap" title="Fonts">Fonts</a>, it's likely that <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://aur.archlinux.org/packages/xorg-fonts-misc-otb/">xorg-fonts-misc-otb</a></span><sup><small>AUR</small></sup> is the one that should be installed since <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=xorg-fonts-misc">xorg-fonts-misc</a></span> no longer provides the required fontset.
</p>
<h4><span class="mw-headline" id="Emacs_Daemon">Emacs Daemon</span></h4>
<p>If you are using <a href="/title/Emacs#As_a_daemon" title="Emacs">emacs daemon/client mode</a>, <code>LC_CTYPE</code> should be set when starting the daemon. For example, by running emacs daemon with <code>LC_CTYPE=zh_CN.UTF-8 emacs --daemon</code>.
</p>
<p>If starting emacs daemon from <a href="/title/Systemd" title="Systemd">systemd</a>, <a href="/title/Systemd#Editing_provided_units" title="Systemd">set</a> <code>Environment="LC_CTYPE=zh_CN.UTF-8" "XMODIFIERS=@im=fcitx"</code> in the unit file.
</p>
<p>(<code>XMODIFIERS</code> may need to be set explicitly here as systemd does not load <code>.xprofile</code>. Check the <code>initial-environment</code> variable in emacs to verify both variables are set correctly.)
</p>
<h3>
<span id="Ctrl.2BSpace_fail_to_work_in_GTK_programs"></span><span class="mw-headline" id="Ctrl+Space_fail_to_work_in_GTK_programs">Ctrl+Space fail to work in GTK programs</span>
</h3>
<p>This problem sometimes happens especially when the locale is set as English. Please make sure your <code>GTK_IM_MODULE</code> is set correctly.
</p>
<p>See also <a rel="nofollow" class="external text" href="https://fcitx-im.org/wiki/FAQ#When_use_Ctrl_.2B_Space.2C_Fcitx_cannot_be_triggered_on">FAQ</a>
</p>
<p>If you have set the <code>*_IM_MODULE</code> environment variables to fcitx but cannot activate fcitx, please check if you have installed the corresponding input method modules.
</p>
<p>Some programs can only use xim, if you are using these programs, please make sure your <code>XMODIFIERS</code> is set properly and be aware of the problems you may have. These programs include all programs that are not using GTK or Qt (e.g. programs that use tk, motif, or xlib directly), emacs, opera, openoffice, libreoffice, skype.
</p>
<p>If you cannot enable fcitx in <i>gnome-terminal</i> under Gnome and the above way does not work, try:
</p>
<pre>$ gsettings set org.gnome.settings-daemon.plugins.xsettings overrides "{'Gtk/IMModule':&lt;'fcitx'&gt;}"
</pre>
<h3><span class="mw-headline" id="Buildin_Chinese_Pinyin_Default_NOT_ACTIVE">Buildin Chinese Pinyin Default NOT ACTIVE</span></h3>
<p>If your locale is <code>en_US.UTF-8</code>, fcitx did NOT enable the buildin Chinese Pinyin input method by default. There is only <code>fcitx-keyboard-us</code> input method enabled. You can get a notice by <code>fcitx-diagnose</code> command like this:
</p>
<pre>   ## Input Methods:
       1.  Found 1 enabled input methods:
               fcitx-keyboard-us
       2.  Default input methods:
           **You only have one input method enabled, please add a keyboard input method as the first one and your main input method as the second one.**
</pre>
<p>Then you should add <code>Pinyin</code> or <code>Shuangpin</code> input method to actived input methods by the GUI configure tool.
</p>
<h3><span class="mw-headline" id="fcitx_and_KDE">fcitx and KDE</span></h3>
<p>For some reasons, <a href="/title/KDE" title="KDE">KDE</a> does not handle keyboard layouts properly. For example, if you switch from US (English) to LT (Lithuanian), all numbers on the keyboard should produce Lithuanian letters, but they still produce numbers as the output. This can be fixed by these steps:
</p>
<ol>
<li>Turn off <i>fcitx</i> if it is running in the background.</li>
<li>Disable stuff related to KDE:
<ol>
<li>At <i>System settings &gt; Input devices &gt; Layouts (tab)</i> make sure that <i>Configure layouts</i> is unchecked.</li>
<li>At <i>System settings &gt; Input devices &gt; Advanced (tab)</i> make sure that <i>Configure keyboard options</i> is unchecked.</li>
</ol>
</li>
<li>Start <i>fcitx</i> to start it. You can close the terminal - <i>fcitx</i> will still be running in the background.</li>
<li>Set up your needed layouts (right click on the system tray icon, then <i>Configure</i>).</li>
<li>Right click on the system tray icon, then <i>Exit</i>
</li>
</ol>
<p>At this point you should have working layouts, native KDE layouts switch icon should appear and you can switch them by mouse scroll or click on it.
</p>
<h3><span class="mw-headline" id="Input_method_switched_to_English_unintentionally">Input method switched to English unintentionally</span></h3>
<p>For instance, in XMind, when the user presses <code>Enter</code> to create a node, input method is always switched to English, and has to be switched back to Chinese manually.
</p>
<p>To fix this issue, open the <i>fcitx</i> GUI configuration tool (provided by <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=fcitx-configtool">fcitx-configtool</a></span>), switch to tab <i>Global Config</i>, in dropdown menu <i>Share State Among Window</i>, select <i>PerProgram</i> or <i>All</i>.
</p>
<h3><span class="mw-headline" id="xmodmap_settings_being_overwritten">xmodmap settings being overwritten</span></h3>
<p>fcitx controls keyboard layout, so your <a href="/title/Xmodmap" title="Xmodmap">xmodmap</a> settings will be overwritten.
Since 4.2.7, Fcitx will try to load <code>~/.Xmodmap</code> if it exists.
</p>
<p>For more details on how you can save your xmodmap changes see <a rel="nofollow" class="external text" href="https://fcitx-im.org/wiki/FAQ#xmodmap_settings_being_overwritten">FAQ</a>
</p>
<h3><span class="mw-headline" id="Fcitx_preedit_box_is_too_small_with_HiDPI">Fcitx preedit box is too small with HiDPI</span></h3>
<p>See <a href="/title/HiDPI#Fcitx" title="HiDPI">HiDPI#Fcitx</a>
</p>
<h2><span class="mw-headline" id="See_also">See also</span></h2>
<ul>
<li><a rel="nofollow" class="external text" href="https://gitlab.com/fcitx/fcitx">Fcitx GitLab</a></li>
<li><a rel="nofollow" class="external text" href="https://fcitx-im.org/">Fcitx Wiki</a></li>
</ul>
</div>
</div>
<div id="catlinks" class="catlinks" data-mw="interface"><div id="mw-normal-catlinks" class="mw-normal-catlinks">
<a href="/title/Special:Categories" title="Special:Categories">Category</a>: <ul><li><a href="/title/Category:Input_methods" title="Category:Input methods">Input methods</a></li></ul>
</div></div>
	</div>
</div>

<footer id="footer" class="mw-footer" role="contentinfo" style="margin: 0">
	<ul id="footer-info">
		<li>Retrieved from "<a dir="ltr" href="https://wiki.archlinux.org/index.php?title=Fcitx&amp;oldid=668730">https://wiki.archlinux.org/index.php?title=Fcitx&amp;oldid=668730</a>"</li>
		<li id="footer-info-lastmod"> This page was last edited on 8 May 2021, at 10:40.</li>
		<li id="footer-info-copyright">Content is available under <a class="external" rel="nofollow" href="http://www.gnu.org/copyleft/fdl.html">GNU Free Documentation License 1.3 or later</a> unless otherwise noted.</li>
	<br>
</ul>
	<ul id="footer-places">
		<li id="footer-places-privacy"><a href="/title/ArchWiki:Privacy_policy" title="ArchWiki:Privacy policy">Privacy policy</a></li>
		<li id="footer-places-about"><a href="/title/ArchWiki:About" title="ArchWiki:About">About ArchWiki</a></li>
		<li id="footer-places-disclaimer"><a href="/title/ArchWiki:General_disclaimer" title="ArchWiki:General disclaimer">Disclaimers</a></li>
	</ul>
	<ul id="footer-icons" class="noprint">
		<li id="footer-copyrightico">
	</ul>
	<div style="clear: both;"></div>
</footer>



</body>
</html>
