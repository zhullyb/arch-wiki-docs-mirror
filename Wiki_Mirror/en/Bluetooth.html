<!DOCTYPE html>
<html class="client-nojs" lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<title>Bluetooth - ArchWiki</title>
<link rel="stylesheet" href="../ArchWikiOffline.css">
<meta name="ResourceLoaderDynamicStyles" content="">
<meta name="generator" content="MediaWiki 1.35.0">
<meta name="referrer" content="no-referrer-when-downgrade">
<meta name="robots" content="noindex,follow">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="shortcut icon" href="/favicon.ico">
<link rel="search" type="application/opensearchdescription+xml" href="/opensearch_desc.php" title="ArchWiki (en)">
<link rel="EditURI" type="application/rsd+xml" href="https://wiki.archlinux.org/api.php?action=rsd">
<link rel="license" href="http://www.gnu.org/copyleft/fdl.html">
<link rel="alternate" type="application/atom+xml" title="ArchWiki Atom feed" href="/index.php?title=Special:RecentChanges&amp;feed=atom">
</head>
<body class="mediawiki ltr sitedir-ltr mw-hide-empty-elt ns-0 ns-subject page-Bluetooth rootpage-Bluetooth skin-vector action-view skin-vector-legacy">
<div id="content" class="mw-body" role="main" style="margin: 0">
	<a id="top"></a>
	<div id="siteNotice" class="mw-body-content"></div>
	<div class="mw-indicators mw-body-content">
	</div>
	<h1 id="firstHeading" class="firstHeading" lang="en">Bluetooth</h1>
	<div id="bodyContent" class="mw-body-content">
		<div id="siteSub" class="noprint">From ArchWiki</div>
		<div id="contentSub"></div>
		<div id="contentSub2"></div>
		
		<div id="jump-to-nav"></div>
		<a class="mw-jump-link" href="#mw-head">Jump to navigation</a>
		<a class="mw-jump-link" href="#searchInput">Jump to search</a>
		<div id="mw-content-text" lang="en" dir="ltr" class="mw-content-ltr">
<div class="warningbox">The printable version is no longer supported and may have rendering errors. Please update your browser bookmarks and please use the default browser print function instead.</div>
<div class="mw-parser-output">
<div class="archwiki-template-meta-related-articles-start">
<p>Related articles</p>
<ul>
<li><a href="../en/Bluetooth_mouse.html" title="Bluetooth mouse">Bluetooth mouse</a></li>
<li><a href="../en/Bluetooth_keyboard.html" title="Bluetooth keyboard">Bluetooth keyboard</a></li>
<li><a href="../en/Bluetooth_headset.html" title="Bluetooth headset">Bluetooth headset</a></li>
<li><a href="../en/Blueman.html" title="Blueman">Blueman</a></li>
<li><a href="../en/ObexFTP.html" title="ObexFTP">ObexFTP</a></li>
</ul>
</div>
<p><a href="https://en.wikipedia.org/wiki/Bluetooth" class="extiw" title="wikipedia:Bluetooth">Bluetooth</a> is a standard for the short-range wireless interconnection of cellular phones, computers, and other electronic devices. In Linux, the canonical implementation of the Bluetooth protocol stack is <a rel="nofollow" class="external text" href="http://www.bluez.org/">BlueZ</a>.
</p>
<div id="toc" class="toc" role="navigation" aria-labelledby="mw-toc-heading">
<input type="checkbox" role="button" id="toctogglecheckbox" class="toctogglecheckbox" style="display:none"><div class="toctitle" lang="en" dir="ltr">
<h2 id="mw-toc-heading">Contents</h2>
<span class="toctogglespan"><label class="toctogglelabel" for="toctogglecheckbox"></label></span>
</div>
<ul>
<li class="toclevel-1 tocsection-1">
<a href="#Installation"><span class="tocnumber">1</span> <span class="toctext">Installation</span></a>
<ul>
<li class="toclevel-2 tocsection-2">
<a href="#Front-ends"><span class="tocnumber">1.1</span> <span class="toctext">Front-ends</span></a>
<ul>
<li class="toclevel-3 tocsection-3"><a href="#Console"><span class="tocnumber">1.1.1</span> <span class="toctext">Console</span></a></li>
<li class="toclevel-3 tocsection-4"><a href="#Graphical"><span class="tocnumber">1.1.2</span> <span class="toctext">Graphical</span></a></li>
</ul>
</li>
</ul>
</li>
<li class="toclevel-1 tocsection-5">
<a href="#Pairing"><span class="tocnumber">2</span> <span class="toctext">Pairing</span></a>
<ul>
<li class="toclevel-2 tocsection-6">
<a href="#Dual_boot_pairing"><span class="tocnumber">2.1</span> <span class="toctext">Dual boot pairing</span></a>
<ul>
<li class="toclevel-3 tocsection-7"><a href="#Setup"><span class="tocnumber">2.1.1</span> <span class="toctext">Setup</span></a></li>
<li class="toclevel-3 tocsection-8"><a href="#For_Windows"><span class="tocnumber">2.1.2</span> <span class="toctext">For Windows</span></a></li>
<li class="toclevel-3 tocsection-9"><a href="#For_macOS"><span class="tocnumber">2.1.3</span> <span class="toctext">For macOS</span></a></li>
<li class="toclevel-3 tocsection-10"><a href="#Finishing_up"><span class="tocnumber">2.1.4</span> <span class="toctext">Finishing up</span></a></li>
</ul>
</li>
</ul>
</li>
<li class="toclevel-1 tocsection-11">
<a href="#Configuration"><span class="tocnumber">3</span> <span class="toctext">Configuration</span></a>
<ul>
<li class="toclevel-2 tocsection-12"><a href="#Auto_power-on_after_boot"><span class="tocnumber">3.1</span> <span class="toctext">Auto power-on after boot</span></a></li>
<li class="toclevel-2 tocsection-13"><a href="#Discoverable_on_startup"><span class="tocnumber">3.2</span> <span class="toctext">Discoverable on startup</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-14">
<a href="#Audio"><span class="tocnumber">4</span> <span class="toctext">Audio</span></a>
<ul>
<li class="toclevel-2 tocsection-15"><a href="#PulseAudio"><span class="tocnumber">4.1</span> <span class="toctext">PulseAudio</span></a></li>
<li class="toclevel-2 tocsection-16"><a href="#PipeWire"><span class="tocnumber">4.2</span> <span class="toctext">PipeWire</span></a></li>
<li class="toclevel-2 tocsection-17"><a href="#ALSA"><span class="tocnumber">4.3</span> <span class="toctext">ALSA</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-18"><a href="#Bluetooth_serial"><span class="tocnumber">5</span> <span class="toctext">Bluetooth serial</span></a></li>
<li class="toclevel-1 tocsection-19">
<a href="#Troubleshooting"><span class="tocnumber">6</span> <span class="toctext">Troubleshooting</span></a>
<ul>
<li class="toclevel-2 tocsection-20"><a href="#Debugging"><span class="tocnumber">6.1</span> <span class="toctext">Debugging</span></a></li>
<li class="toclevel-2 tocsection-21"><a href="#Deprecated_BlueZ_tools"><span class="tocnumber">6.2</span> <span class="toctext">Deprecated BlueZ tools</span></a></li>
<li class="toclevel-2 tocsection-22"><a href="#gnome-bluetooth"><span class="tocnumber">6.3</span> <span class="toctext">gnome-bluetooth</span></a></li>
<li class="toclevel-2 tocsection-23">
<a href="#Bluetooth_USB_Dongle"><span class="tocnumber">6.4</span> <span class="toctext">Bluetooth USB Dongle</span></a>
<ul>
<li class="toclevel-3 tocsection-24"><a href="#Audio_devices_start_to_skip_at_short_distance_from_dongle"><span class="tocnumber">6.4.1</span> <span class="toctext">Audio devices start to skip at short distance from dongle</span></a></li>
<li class="toclevel-3 tocsection-25"><a href="#CSR_Dongle_0a12:0001"><span class="tocnumber">6.4.2</span> <span class="toctext">CSR Dongle 0a12:0001</span></a></li>
</ul>
</li>
<li class="toclevel-2 tocsection-26"><a href="#Logitech_Bluetooth_USB_Dongle"><span class="tocnumber">6.5</span> <span class="toctext">Logitech Bluetooth USB Dongle</span></a></li>
<li class="toclevel-2 tocsection-27"><a href="#hcitool_scan:_Device_not_found"><span class="tocnumber">6.6</span> <span class="toctext">hcitool scan: Device not found</span></a></li>
<li class="toclevel-2 tocsection-28"><a href="#bluetoothctl:_No_default_controller_available"><span class="tocnumber">6.7</span> <span class="toctext">bluetoothctl: No default controller available</span></a></li>
<li class="toclevel-2 tocsection-29"><a href="#systemd:_Condition_check_resulted_in_Bluetooth_service_being_skipped"><span class="tocnumber">6.8</span> <span class="toctext">systemd: Condition check resulted in Bluetooth service being skipped</span></a></li>
<li class="toclevel-2 tocsection-30"><a href="#rfkill_unblock:_Do_not_unblock"><span class="tocnumber">6.9</span> <span class="toctext">rfkill unblock: Do not unblock</span></a></li>
<li class="toclevel-2 tocsection-31"><a href="#My_computer_is_not_visible"><span class="tocnumber">6.10</span> <span class="toctext">My computer is not visible</span></a></li>
<li class="toclevel-2 tocsection-32"><a href="#Logitech_keyboard_does_not_pair"><span class="tocnumber">6.11</span> <span class="toctext">Logitech keyboard does not pair</span></a></li>
<li class="toclevel-2 tocsection-33"><a href="#Foxconn_/_Hon_Hai_/_Lite-On_Broadcom_device"><span class="tocnumber">6.12</span> <span class="toctext">Foxconn / Hon Hai / Lite-On Broadcom device</span></a></li>
<li class="toclevel-2 tocsection-34"><a href="#Intel_combined_wifi_and_bluetooth_cards"><span class="tocnumber">6.13</span> <span class="toctext">Intel combined wifi and bluetooth cards</span></a></li>
<li class="toclevel-2 tocsection-35"><a href="#Device_connects,_then_disconnects_after_a_few_moments"><span class="tocnumber">6.14</span> <span class="toctext">Device connects, then disconnects after a few moments</span></a></li>
<li class="toclevel-2 tocsection-36"><a href="#Device_does_not_connect_with_an_error_in_journal"><span class="tocnumber">6.15</span> <span class="toctext">Device does not connect with an error in journal</span></a></li>
<li class="toclevel-2 tocsection-37"><a href="#Device_does_not_show_up_in_scan"><span class="tocnumber">6.16</span> <span class="toctext">Device does not show up in scan</span></a></li>
<li class="toclevel-2 tocsection-38"><a href="#Interference_between_Headphones_and_Mouse"><span class="tocnumber">6.17</span> <span class="toctext">Interference between Headphones and Mouse</span></a></li>
<li class="toclevel-2 tocsection-39"><a href="#Bluetooth_mouse_laggy_movements"><span class="tocnumber">6.18</span> <span class="toctext">Bluetooth mouse laggy movements</span></a></li>
<li class="toclevel-2 tocsection-40"><a href="#Adapter_disappears_after_suspend/resume"><span class="tocnumber">6.19</span> <span class="toctext">Adapter disappears after suspend/resume</span></a></li>
<li class="toclevel-2 tocsection-41"><a href="#Problems_with_all_BLE_devices_on_kernel_5.9+"><span class="tocnumber">6.20</span> <span class="toctext">Problems with all BLE devices on kernel 5.9+</span></a></li>
<li class="toclevel-2 tocsection-42"><a href="#Problems_with_some_Bluetooth_drivers_in_kernel_5.10"><span class="tocnumber">6.21</span> <span class="toctext">Problems with some Bluetooth drivers in kernel 5.10</span></a></li>
</ul>
</li>
</ul>
</div>

<h2><span class="mw-headline" id="Installation">Installation</span></h2>
<ol>
<li>
<a href="../en/Help:Reading.html#Installation_of_packages" class="mw-redirect" title="Install">Install</a> the <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=bluez">bluez</a></span> package, providing the Bluetooth protocol stack.</li>
<li>
<a href="../en/Help:Reading.html#Installation_of_packages" class="mw-redirect" title="Install">Install</a> the <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=bluez-utils">bluez-utils</a></span> package, providing the <code>bluetoothctl</code> utility. Alternatively install <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://aur.archlinux.org/packages/bluez-utils-compat/">bluez-utils-compat</a></span><sup><small>AUR</small></sup> to additionally have the <a href="#Deprecated_BlueZ_tools">deprecated BlueZ tools</a>.</li>
<li>The generic Bluetooth driver is the <code>btusb</code> kernel module. <a href="../en/Kernel_module.html#Obtaining_information" title="Kernel module">Check</a> whether that module is loaded. If it's not, then <a href="../en/Kernel_module.html#Manual_module_handling" title="Kernel module">load the module</a>.</li>
<li>
<a href="../en/Systemd.html#Using_units" class="mw-redirect" title="Start/enable">Start/enable</a> <code>bluetooth.service</code>.</li>
</ol>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Note:</strong> 
<ul>
<li>By default the bluetooth daemon will only give out bnep0 devices to users that are a member of the <code>lp</code> <a href="../en/Users_and_groups.html#System_groups" title="Users and groups">group</a>. Make sure to add your user to that group if you intend to connect to a bluetooth tether. You can change the group that is required in the file <code>/usr/share/dbus-1/system.d/bluetooth.conf</code>.</li>
<li>Some Bluetooth adapters are bundled with a Wi-Fi card (e.g. <a rel="nofollow" class="external text" href="http://www.intel.com/content/www/us/en/wireless-products/centrino-advanced-n-6235.html">Intel Centrino</a>). These require that the Wi-Fi card is firstly enabled (typically a keyboard shortcut on a laptop) in order to make the Bluetooth adapter visible to the kernel.</li>
<li>Some Bluetooth cards (e.g. Broadcom) conflict with the network adapter. Thus, you need to make sure that your Bluetooth device gets connected before the network service boot.</li>
<li>Some tools such as hcitool and hciconfig have been deprecated upstream, and are no longer included in <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=bluez-utils">bluez-utils</a></span>. Since these tools will no longer be updated, it is recommended that scripts be updated to avoid using them. If you still desire to use them, install <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://aur.archlinux.org/packages/bluez-utils-compat/">bluez-utils-compat</a></span><sup><small>AUR</small></sup>. See <a rel="nofollow" class="external text" href="https://bugs.archlinux.org/task/53110">FS#53110</a> and <a rel="nofollow" class="external text" href="https://www.spinics.net/lists/linux-bluetooth/msg69239.html">the Bluez mailing list</a> for more information. </li>
</ul>
</div>
<h3><span class="mw-headline" id="Front-ends">Front-ends</span></h3>
<h4><span class="mw-headline" id="Console">Console</span></h4>
<ul><li>
<b>bluetoothctl</b> — Pairing a device from the shell is one of the simplest and most reliable options.</li></ul>
<dl><dd>
<a rel="nofollow" class="external free" href="http://www.bluez.org/">http://www.bluez.org/</a> || <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=bluez-utils">bluez-utils</a></span>
</dd></dl>
<div class="archwiki-template-box archwiki-template-box-tip">
<strong>Tip:</strong> To automate bluetoothctl commands, use <code>echo -e "&lt;command1&gt;\n&lt;command2&gt;\n" | bluetoothctl</code> or <code>bluetoothctl -- command</code>
</div>
<h4><span class="mw-headline" id="Graphical">Graphical</span></h4>
<p>The following packages allow for a graphical interface to customize Bluetooth.
</p>
<ul><li>
<b>GNOME Bluetooth</b> — <a href="../en/GNOME.html" title="GNOME">GNOME</a>'s Bluetooth tool.
<ul>
<li>
<span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=gnome-bluetooth">gnome-bluetooth</a></span> provides the back-end</li>
<li>
<span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=gnome-shell">gnome-shell</a></span> provides the status monitor applet</li>
<li>
<span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=gnome-control-center">gnome-control-center</a></span> provides the configuration front-end GUI that can be accessed by typing Bluetooth on the Activities overview, or with the <code>gnome-control-center bluetooth</code> command.</li>
<li>You can also launch the <code>bluetooth-sendto</code> command directly to send files to a remote device.</li>
<li>
<span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://aur.archlinux.org/packages/nautilus-bluetooth/">nautilus-bluetooth</a></span><sup><small>AUR</small></sup> adds a "Send via Bluetooth" entry to Nautilus' right-click menu</li>
<li>To receive files, open the Bluetooth settings panel; you can only receive whilst the Bluetooth panel is open.</li>
<li>To add a Bluetooth entry to the <i>Send To</i> menu in Thunar's file properties menu, see instructions <a rel="nofollow" class="external text" href="http://docs.xfce.org/xfce/thunar/send-to">here</a>. (The command that needs to be configured is <code>bluetooth-sendto %F</code>).</li>
</ul>
</li></ul>
<dl><dd>
<a rel="nofollow" class="external free" href="https://wiki.gnome.org/Projects/GnomeBluetooth">https://wiki.gnome.org/Projects/GnomeBluetooth</a> ||</dd></dl>
<ul><li>
<b>Bluedevil</b> — <a href="../en/KDE.html" title="KDE">KDE</a>'s Bluetooth tool. If there is no Bluetooth icon visible in Dolphin and in the system tray, enable it in the system tray options or add a widget. You can configure Bluedevil and detect Bluetooth devices by clicking the icon. An interface is also available from the KDE System Settings.</li></ul>
<dl><dd>
<a rel="nofollow" class="external free" href="https://invent.kde.org/plasma/bluedevil">https://invent.kde.org/plasma/bluedevil</a> || <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=bluedevil">bluedevil</a></span>
</dd></dl>
<ul><li>
<b>Blueberry</b> — Linux Mint's spin-off of GNOME Bluetooth, which works in all desktop environments. <i>Blueberry</i> does not support receiving files through Obex Object Push.</li></ul>
<dl><dd>
<a rel="nofollow" class="external free" href="https://github.com/linuxmint/blueberry">https://github.com/linuxmint/blueberry</a> || <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=blueberry">blueberry</a></span>
</dd></dl>
<ul><li>
<b><a href="../en/Blueman.html" title="Blueman">Blueman</a></b> — A full featured Bluetooth manager.</li></ul>
<dl><dd>
<a rel="nofollow" class="external free" href="https://github.com/blueman-project/blueman">https://github.com/blueman-project/blueman</a> || <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=blueman">blueman</a></span>
</dd></dl>
<ul><li>
<b><a href="../en/ObexFTP.html" title="ObexFTP">ObexFTP</a></b> — A tool for transferring files to/from any OBEX enabled device.</li></ul>
<dl><dd>
<a rel="nofollow" class="external free" href="http://dev.zuckschwerdt.org/openobex/wiki/ObexFtp">http://dev.zuckschwerdt.org/openobex/wiki/ObexFtp</a> || <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://aur.archlinux.org/packages/obexftp/">obexftp</a></span><sup><small>AUR</small></sup>
</dd></dl>
<h2><span class="mw-headline" id="Pairing">Pairing</span></h2>
<div class="noprint archwiki-template-message">
<p><a href="../File:Tango-view-fullscreen.png" class="image"><img alt="Tango-view-fullscreen.png" src="../File:Tango-view-fullscreen.png" decoding="async" width="48" height="48"></a><b>This article or section needs expansion.</b><a href="../File:Tango-view-fullscreen.png" class="image"><img alt="Tango-view-fullscreen.png" src="../File:Tango-view-fullscreen.png" decoding="async" width="48" height="48"></a></p>
<div>
<b>Reason:</b> Step 5 is unclear. What are Bluetooth agents? (Discuss in <a rel="nofollow" class="external text" href="https://wiki.archlinux.org/index.php/Talk:Bluetooth">Talk:Bluetooth#</a>)</div>
</div>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Note:</strong> Before using the bluetooth device, make sure that it is not blocked by <a href="../en/Network_configuration/Wireless.html#Rfkill_caveat" class="mw-redirect" title="Rfkill">rfkill</a>.</div>
<p>This section describes directly configuring <i>bluez5</i> via the <i>bluetoothctl</i> CLI, which might not be necessary if you are using  an alternative front-end tool (such as GNOME Bluetooth).
</p>
<p>The exact procedure depends on the devices involved and their input functionality.  What follows is a general outline of pairing a device using <code>bluetoothctl</code>.
</p>
<p>Start the <code>bluetoothctl</code> interactive command. Input <code>help</code> to get a list of available commands.
</p>
<ol>
<li>(optional) Select a default controller with <code>select <i>MAC_address</i></code>.</li>
<li>Enter <code>power on</code> to turn the power to the controller on. It is off by default and will turn off again each reboot, see <a href="#Auto_power-on_after_boot">#Auto power-on after boot</a>.</li>
<li>Enter <code>devices</code> to get the MAC Address of the device with which to pair.</li>
<li>Enter device discovery mode with <code>scan on</code> command if device is not yet on the list.</li>
<li>Turn the agent on with <code>agent on</code> or choose a specific agent: if you press tab twice after <code>agent</code> you should see a list of available agents, e.g. DisplayOnly KeyboardDisplay NoInputNoOutput DisplayYesNo KeyboardOnly off on.</li>
<li>Enter <code>pair <i>MAC_address</i></code> to do the pairing (tab completion works).</li>
<li>If using a device without a PIN, one may need to manually trust the device before it can reconnect successfully. Enter <code>trust <i>MAC_address</i></code> to do so.</li>
<li>Enter <code>connect <i>MAC_address</i></code> to establish a connection.</li>
</ol>
<p>An example session may look this way:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;"># bluetoothctl</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">[NEW] Controller 00:10:20:30:40:50 pi [default]
</pre>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">[bluetooth]# agent KeyboardOnly</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">Agent registered
</pre>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">[bluetooth]# default-agent</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">Default agent request successful
</pre>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">[bluetooth]# power on</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">Changing power on succeeded
[CHG] Controller 00:10:20:30:40:50 Powered: yes
</pre>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">[bluetooth]# scan on</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">Discovery started
[CHG] Controller 00:10:20:30:40:50 Discovering: yes
[NEW] Device 00:12:34:56:78:90 myLino
[CHG] Device 00:12:34:56:78:90 LegacyPairing: yes
</pre>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">[bluetooth]# pair 00:12:34:56:78:90</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">Attempting to pair with 00:12:34:56:78:90
[CHG] Device 00:12:34:56:78:90 Connected: yes
[CHG] Device 00:12:34:56:78:90 Connected: no
[CHG] Device 00:12:34:56:78:90 Connected: yes
Request PIN code
[agent] Enter PIN code: 1234
[CHG] Device 00:12:34:56:78:90 Paired: yes
Pairing successful
[CHG] Device 00:12:34:56:78:90 Connected: no
</pre>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">[bluetooth]# connect 00:12:34:56:78:90</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">Attempting to connect to 00:12:34:56:78:90
[CHG] Device 00:12:34:56:78:90 Connected: yes
Connection successful
</pre>
<h3><span class="mw-headline" id="Dual_boot_pairing">Dual boot pairing</span></h3>
<p>To pair devices on dual boot setups you need to change the pairing keys manually on your Linux install, so that they match in both systems.
</p>
<h4><span class="mw-headline" id="Setup">Setup</span></h4>
<p>To do this, first pair your device on your Arch Linux install. Then reboot into the other OS and pair the device. Now you need to extract the pairing keys, but first switch off the bluetooth devices to prevent any connection attempts. 
</p>
<h4><span class="mw-headline" id="For_Windows">For Windows</span></h4>
<p>Reboot into Arch. Install <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=chntpw">chntpw</a></span>. Mount your windows system drive.
</p>
<pre>$ cd <i>/path/to/windows/system</i>/Windows/System32/config <br>$ chntpw -e SYSTEM</pre>
<p>Inside the <code>chntpw</code> environment, run 
</p>
<pre>&gt; cd ControlSet001\Services\BTHPORT\Parameters\Keys</pre>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Note:</strong> Your path might start with <code>CurrentControlSet</code> on an older Windows install.</div>
<p>Then get your Bluetooth adapter's MAC address and enter its folder
</p>
<pre>&gt; ls
&gt; cd <i>your-device's-mac-address</i></pre>
<p>Do the same for your paired devices 
</p>
<pre>&gt; ls</pre>
<p>example output
</p>
<pre>Node has 0 subkeys and 1 values
size  type        value name    [value if type DWORD]
16    REG_BINARY &lt;123456789876&gt;</pre>
<p>Now get your device's key through <code>hex</code>
</p>
<pre> &gt; hex 123456789876</pre>
<p>example output
</p>
<pre>:00000 XX XX XX XX XX XX XX XX XX XX XX XX XX XX XX XX (some other chars)</pre>
<p>The "XX"s are the pairing key. Make note of which keys map to which MAC addresses.
</p>
<h4><span class="mw-headline" id="For_macOS">For macOS</span></h4>
<p>Boot into macOS, then open a terminal.
</p>
<ul><li>If you are on Sierra or older, run</li></ul>
<pre>$ sudo defaults read /private/var/root/Library/Preferences/blued.plist LinkKeys &gt; ~/bt_keys.txt</pre>
<ul><li>If you are on High Sierra or newer, run</li></ul>
<pre>$ sudo defaults read /private/var/root/Library/Preferences/com.apple.bluetoothd.plist LinkKeys &gt; ~/bt_keys.txt</pre>
<p>Copy the <code>bt_keys.txt</code> file to a drive that can be read from Arch Linux. Reboot into Arch Linux.
</p>
<h4><span class="mw-headline" id="Finishing_up">Finishing up</span></h4>
<p>Now that you have the keys change user to root, then continue with:
</p>
<pre># cd /var/lib/bluetooth/<i>BT-Adapter-MAC-address</i></pre>
<p>Here you will find folders for each paired bluetooth device. For each device you want to pair with Arch and your dual boot, do the following:
</p>
<pre># cd <i>device-MAC-address</i></pre>
<p>Edit the <code>info</code> file and change the key under <code>[LinkKey]</code>. E.g.: 
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">info</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">[LinkKey]
Key=XXXXXXXXXXXXXXX</pre>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Note:</strong> You will have to make sure that all the letters are in capital case. Remove any spaces.</div>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Note:</strong> For older versions of macOS (High Sierra and older) you will have to reverse the key like so:
<p><code>98 54 2f aa bb cc dd ee ff gg hh ii jj kk ll mm</code> becomes <code>MM LL KK JJ GG FF EE DD CC BB AA 2F 54 98</code>.
</p>
This reversal is not necessary for newer versions of macOS.</div>
<p>Then <a href="../en/Systemd.html#Using_units" class="mw-redirect" title="Restart">restart</a> <code>bluetooth.service</code> and <code>pulseaudio</code> (with <code>pulseaudio -k &amp;&amp; pulseaudio --start</code>).
</p>
<p>You should be able to connect to your device now. 
</p>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Note:</strong> Depending on your bluetooth manager, you may need to perform a full reboot in order to reconnect to the device.</div>
<h2><span class="mw-headline" id="Configuration">Configuration</span></h2>
<h3><span class="mw-headline" id="Auto_power-on_after_boot">Auto power-on after boot</span></h3>
<p>By default, the Bluetooth adapter does not power on after a reboot, you need to add the line <code>AutoEnable=true</code> in the configuration file <code>/etc/bluetooth/main.conf</code> at the bottom in the <code>[Policy]</code> section:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/bluetooth/main.conf</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">[Policy]
AutoEnable=true</pre>
<h3><span class="mw-headline" id="Discoverable_on_startup">Discoverable on startup</span></h3>
<p>If the device should always be visible and directly connectable:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/bluetooth/main.conf</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">[General]
DiscoverableTimeout = 0</pre>
<h2><span class="mw-headline" id="Audio">Audio</span></h2>
<p>You will typically need to take an additional step to integrate the audio server with bluetooth. This is detailed in the below sections.
</p>
<p>See the <a href="../en/Bluetooth_headset.html" title="Bluetooth headset">Bluetooth headset</a> page for more information about bluetooth audio and bluetooth headsets.
</p>
<h3><span class="mw-headline" id="PulseAudio">PulseAudio</span></h3>
<p>In order to be able to use audio equipment like bluetooth headphones or speakers, you need to install the additional <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=pulseaudio-bluetooth">pulseaudio-bluetooth</a></span> package. With a default PulseAudio installation you should immediately be able to stream audio from a bluetooth device to your speakers.
</p>
<p>If you have a system-wide PulseAudio setup make sure the user running the daemon (usually <code>pulse</code>) is in the <code>lp</code> group and you load the bluetooth modules in your PulseAudio config:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/pulse/system.pa</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">...
load-module module-bluetooth-policy
load-module module-bluetooth-discover
...</pre>
<h3><span class="mw-headline" id="PipeWire">PipeWire</span></h3>
<p>PipeWire as of v0.3.19 enables its Bluetooth support by default, see <a rel="nofollow" class="external text" href="https://gitlab.freedesktop.org/pipewire/pipewire/-/wikis/Configuration#bluetooth">bluetooth</a>.
</p>
<h3><span class="mw-headline" id="ALSA">ALSA</span></h3>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Note:</strong> Bluez5 has dropped direct integration for <a href="../en/Advanced_Linux_Sound_Architecture.html" class="mw-redirect" title="ALSA">ALSA</a> and supports <a href="../en/PulseAudio.html" title="PulseAudio">PulseAudio</a> only. Follow the instructions below if you cannot or do not want to use PulseAudio.</div>
<p>First, ensure that your bluetooth audio device is correctly paired and connected to the system.
</p>
<p>Then, install <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://aur.archlinux.org/packages/bluez-alsa-git/">bluez-alsa-git</a></span><sup><small>AUR</small></sup>, start (and enable) the <code>bluealsa</code> service, and add your user to the <code>audio</code> group.
</p>
<p>Run the following command to check if everything is working as intended (replace <code><i>XX:XX:XX:XX:XX:XX</i></code> and <code><i>FILE.wav</i></code> below):
</p>
<pre>$ aplay -D bluealsa:SRV=org.bluealsa,DEV=<i>XX:XX:XX:XX:XX:XX</i>,PROFILE=a2dp <i>FILE.wav</i>
</pre>
<p>Finally, add the following lines to your <code>~/.asoundrc</code>:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">~/.asoundrc</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">defaults.bluealsa {
    service "org.bluealsa"
    device "XX:XX:XX:XX:XX:XX"
    profile "a2dp"
}
</pre>
<p>You can now use the <code>bluealsa</code> device to reach your bluetooth audio device. Volume management is conducted normally via <code>alsamixer</code> with the option <code>-D bluealsa</code>.
</p>
<h2><span class="mw-headline" id="Bluetooth_serial">Bluetooth serial</span></h2>
<p>To get bluetooth serial communication working on Bluetooth-to-Serial modules (HC-05, HC-06) do the following steps:
</p>
<p><b>Pair</b> your bluetooth device using <code>bluetoothctl</code> as described <a href="#Pairing">above</a>.
</p>
<p>Install <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://aur.archlinux.org/packages/bluez-rfcomm/">bluez-rfcomm</a></span><sup><small>AUR</small></sup> and <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://aur.archlinux.org/packages/bluez-utils-compat/">bluez-utils-compat</a></span><sup><small>AUR</small></sup>, as they provide certain functionality which is missing from newer tools.
</p>
<p>Bind paired device MAC address to tty terminal:
</p>
<pre># rfcomm bind rfcomm0 &lt;MAC address of bluetooth device&gt;
</pre>
<p>Now you can open <code>/dev/rfcomm0</code> for serial communication:
</p>
<pre>picocom /dev/rfcomm0 -b 115200
</pre>
<h2><span class="mw-headline" id="Troubleshooting">Troubleshooting</span></h2>
<div class="noprint archwiki-template-message">
<p><a href="../File:Tango-view-refresh-red.png" class="image"><img alt="Tango-view-refresh-red.png" src="../File:Tango-view-refresh-red.png" decoding="async" width="48" height="48"></a><b>This article or section is out of date.</b><a href="../File:Tango-view-refresh-red.png" class="image"><img alt="Tango-view-refresh-red.png" src="../File:Tango-view-refresh-red.png" decoding="async" width="48" height="48"></a></p>
<div>
<b>Reason:</b> Replace hciconfig with newer commands. (Discuss in <a rel="nofollow" class="external text" href="https://wiki.archlinux.org/index.php/Talk:Bluetooth">Talk:Bluetooth#</a>)</div>
</div>
<h3><span class="mw-headline" id="Debugging">Debugging</span></h3>
<p>In order to debug, first <a href="../en/Systemd.html#Using_units" class="mw-redirect" title="Stop">stop</a> <code>bluetooth.service</code>.
</p>
<p>And then start it with the <code>-d</code> parameter:
</p>
<pre># /usr/lib/bluetooth/bluetoothd -n -d
</pre>
<p>Another option is via the <code>btmon</code> tool.
</p>
<h3><span class="mw-headline" id="Deprecated_BlueZ_tools">Deprecated BlueZ tools</span></h3>
<p>Eight BlueZ tools <a rel="nofollow" class="external text" href="https://git.kernel.org/pub/scm/bluetooth/bluez.git/commit/?id=b1eb2c4cd057624312e0412f6c4be000f7fc3617">were deprecated</a> and removed from <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=bluez-utils">bluez-utils</a></span>, although not all of them were superseded by newer tools. The <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://aur.archlinux.org/packages/bluez-utils-compat/">bluez-utils-compat</a></span><sup><small>AUR</small></sup> package provides an alternative version of <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=bluez-utils">bluez-utils</a></span> with the deprecated tools.
</p>
<table class="wikitable" style="max-width: 50em;">

<tbody>
<tr>
<th>Deprecated tool
</th>
<th>Most likely replacement
</th>
</tr>
<tr>
<td><a rel="nofollow" class="external text" href="https://manpages.debian.org/stretch/bluez/gatttool.1.en.html">gatttool</a></td>
<td>btgatt-client, <a rel="nofollow" class="external text" href="https://git.kernel.org/cgit/bluetooth/bluez.git/tree/doc/gatt-api.txt">D-Bus Gatt API</a>
</td>
</tr>
<tr>
<td><a rel="nofollow" class="external text" href="https://manpages.debian.org/stretch/bluez/hciattach.1.en.html">hciattach</a></td>
<td>btattach
</td>
</tr>
<tr>
<td><a rel="nofollow" class="external text" href="https://manpages.debian.org/stretch/bluez/hciconfig.1.en.html">hciconfig</a></td>
<td>btmgmt (and bluetoothctl?)
</td>
</tr>
<tr>
<td><a rel="nofollow" class="external text" href="https://manpages.debian.org/stretch/bluez-hcidump/hcidump.1.en.html">hcidump</a></td>
<td>btmon (and btsnoop)
</td>
</tr>
<tr>
<td><a rel="nofollow" class="external text" href="https://manpages.debian.org/stretch/bluez/hcitool.1.en.html">hcitool</a></td>
<td>missing, <a rel="nofollow" class="external text" href="https://git.kernel.org/cgit/bluetooth/bluez.git/tree/doc/device-api.txt">D-Bus Device API</a> available
</td>
</tr>
<tr>
<td>
<a rel="nofollow" class="external text" href="https://manpages.debian.org/stretch/bluez/rfcomm.1.en.html">rfcomm</a>
</td>
<td rowspan="2">missing, implement with <a rel="nofollow" class="external text" href="https://git.kernel.org/cgit/bluetooth/bluez.git/tree/doc/profile-api.txt">D-Bus Profile1 API</a>?
</td>
</tr>
<tr>
<td>
<a rel="nofollow" class="external text" href="https://manpages.debian.org/stretch/bluez/ciptool.1.en.html">ciptool</a>
</td>
</tr>
<tr>
<td style="vertical-align: top;">
<a rel="nofollow" class="external text" href="https://manpages.debian.org/stretch/bluez/sdptool.1.en.html">sdptool</a>
</td>
<td>missing, functionality seems to be scattered over different D-Bus objects: <a rel="nofollow" class="external text" href="https://git.kernel.org/cgit/bluetooth/bluez.git/tree/doc/profile-api.txt">Profile</a>, <a rel="nofollow" class="external text" href="https://git.kernel.org/cgit/bluetooth/bluez.git/tree/doc/advertising-api.txt">Advertising</a>, and the UUIDs arrays in <a rel="nofollow" class="external text" href="https://git.kernel.org/cgit/bluetooth/bluez.git/tree/doc/device-api.txt">device</a> and <a rel="nofollow" class="external text" href="https://git.kernel.org/cgit/bluetooth/bluez.git/tree/doc/adapter-api.txt">adapter</a>.
</td>
</tr>
</tbody>
</table>
<h3><span class="mw-headline" id="gnome-bluetooth">gnome-bluetooth</span></h3>
<p>If you see this when trying to enable receiving files in bluetooth-properties:
</p>
<pre>Bluetooth OBEX start failed: Invalid path
Bluetooth FTP start failed: Invalid path
</pre>
<p>Then make sure that the <a href="../en/XDG_user_directories.html" title="XDG user directories">XDG user directories</a> exist.
</p>
<h3><span class="mw-headline" id="Bluetooth_USB_Dongle">Bluetooth USB Dongle</span></h3>
<p>If you are using a USB dongle, you should check that your Bluetooth dongle is recognized. You can do that by running <code>journalctl -f</code> when you have plugged in the USB dongle (or inspecting <code>/var/log/messages.log</code>). It should look something like the following (look out for hci):
</p>
<pre>Feb 20 15:00:24 hostname kernel: [ 2661.349823] usb 4-1: new full-speed USB device number 3 using uhci_hcd
Feb 20 15:00:24 hostname bluetoothd[4568]: HCI dev 0 registered
Feb 20 15:00:24 hostname bluetoothd[4568]: Listening for HCI events on hci0
Feb 20 15:00:25 hostname bluetoothd[4568]: HCI dev 0 up
Feb 20 15:00:25 hostname bluetoothd[4568]: Adapter /org/bluez/4568/hci0 has been enabled
</pre>
<p>If you only get the first two lines, you may see that it found the device but you need to bring it up.
Example:
</p>
<pre># btmgmt
</pre>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">[mgmt]# info</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">Index list with 1 item
hci0:	Primary controller
	addr 00:1A:7D:DA:71:10 version 6 manufacturer 10 class 0x000000
	supported settings: powered connectable fast-connectable discoverable bondable link-security ssp br/edr hs le advertising secure-conn debug-keys privacy static-addr 
	<b>current settings:</b> connectable discoverable bondable ssp br/edr le secure-conn 
	name Mozart
	short name 
</pre>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">[mgmt]# select hci0</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">Selected index 0
</pre>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">[hci0]# power up</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">hci0 Set Powered complete, settings: <b>powered</b> connectable discoverable bondable ssp br/edr le secure-conn
</pre>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">[hci0]# info</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">hci0:	Primary controller
	addr 00:1A:7D:DA:71:10 version 6 manufacturer 10 class 0x1c0104
	supported settings: powered connectable fast-connectable discoverable bondable link-security ssp br/edr hs le advertising secure-conn debug-keys privacy static-addr 
	<b>current settings: powered</b> connectable discoverable bondable ssp br/edr le secure-conn
</pre>
<p>Or
</p>
<pre># bluetoothctl
</pre>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">[bluetooth]# show</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">Controller 00:1A:7D:DA:71:10 (public)
	Name: Mozart
	Alias: Mozart
	Class: 0x0000095c
	<b>Powered: no</b>
	Discoverable: yes
	Pairable: yes
</pre>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">[bluetooth]# power on<b></b></pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">[CHG] Controller 00:1A:7D:DA:71:10 Class: 0x001c0104
Changing power on succeeded
[CHG] Controller 00:1A:7D:DA:71:10 <b>Powered: yes</b>
</pre>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">[bluetooth]# show</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">Controller 00:1A:7D:DA:71:10 (public)
	Name: Mozart
	Alias: Mozart
	Class: 0x001c0104
	<b>Powered: yes</b>
	Discoverable: yes
	Pairable: yes
</pre>
<p>To verify that the device was detected you can use <code>btmgmt</code> which is part of the <code>bluez-utils</code>. You can get a list of available devices and their identifiers and their MAC address by issuing:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">$ btmgmt info</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">Index list with 1 item
hci0:	Primary controller
	addr 00:1A:7D:DA:71:10 <b>version 6</b> manufacturer 10 class 0x1c0104
	supported settings: powered connectable fast-connectable discoverable bondable link-security ssp br/edr hs le advertising secure-conn debug-keys privacy static-addr 
	current settings: powered connectable discoverable bondable ssp br/edr le secure-conn
</pre>
<p>It is possible to check the Bluetooth version as mapped to the HCI version according to the table in the <a rel="nofollow" class="external text" href="https://www.bluetooth.com/specifications/assigned-numbers/host-controller-interface/">official specification</a>. For example, in the previous output, HCI <b>version 6</b> is Bluetooth version 4.0.
</p>
<p>More detailed information about the device can be retrieved by using the deprecated <code>hciconfig</code>. (<span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://aur.archlinux.org/packages/bluez-utils-compat/">bluez-utils-compat</a></span><sup><small>AUR</small></sup>)
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">$ hciconfig -a hci0</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">hci0:   Type: USB
        BD Address: 00:1B:DC:0F:DB:40 ACL MTU: 310:10 SCO MTU: 64:8
        UP RUNNING PSCAN ISCAN
        RX bytes:1226 acl:0 sco:0 events:27 errors:0
        TX bytes:351 acl:0 sco:0 commands:26 errors:0
        Features: 0xff 0xff 0x8f 0xfe 0x9b 0xf9 0x00 0x80
        Packet type: DM1 DM3 DM5 DH1 DH3 DH5 HV1 HV2 HV3
        Link policy: RSWITCH HOLD SNIFF PARK
        Link mode: SLAVE ACCEPT 
        Name: 'BlueZ (0)'
        Class: 0x000100
        Service Classes: Unspecified
        Device Class: Computer, Uncategorized
        HCI Ver: 2.0 (0x3) HCI Rev: 0xc5c LMP Ver: 2.0 (0x3) LMP Subver: 0xc5c
        Manufacturer: Cambridge Silicon Radio (10)
</pre>
<h4><span class="mw-headline" id="Audio_devices_start_to_skip_at_short_distance_from_dongle">Audio devices start to skip at short distance from dongle</span></h4>
<p>If other devices share the same USB host, they can <a rel="nofollow" class="external text" href="https://bbs.archlinux.org/viewtopic.php?pid=1440161#p1440161">interrupt communication with audio devices</a>. Make sure it is the only device attached to its bus. For example:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">$ lsusb</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">Bus 002 Device 002: ID 0a12:0001 Cambridge Silicon Radio, Ltd Bluetooth Dongle (HCI mode)
Bus 002 Device 001: ID 1d6b:0002 Linux Foundation 2.0 root hub
Bus 001 Device 004: ID 048d:1345 Integrated Technology Express, Inc. Multi Cardreader
Bus 001 Device 003: ID 0424:a700 Standard Microsystems Corp. 2 Port Hub
Bus 001 Device 002: ID 8087:0024 Intel Corp. Integrated Rate Matching Hub
Bus 001 Device 001: ID 1d6b:0002 Linux Foundation 2.0 root hub
</pre>
<h4><span class="mw-headline" id="CSR_Dongle_0a12:0001">CSR Dongle 0a12:0001</span></h4>
<p>The device <code>ID 0a12:0001 Cambridge Silicon Radio, Ltd Bluetooth Dongle (HCI mode)</code> has a regression bug, and currently only works in the kernel version ≤ 3.9.11. There is a patch available for newer versions. For more information, see <a rel="nofollow" class="external text" href="https://bugzilla.kernel.org/show_bug.cgi?id=60824">Kernel Bug 60824</a>.
</p>
<h3><span class="mw-headline" id="Logitech_Bluetooth_USB_Dongle">Logitech Bluetooth USB Dongle</span></h3>
<p>There are Logitech dongles (ex. Logitech MX5000) that can work in two modes: Embedded and HCI. In embedded mode dongle emulates a USB device so it seems to your PC that you are using a normal USB mouse/keyoard.
</p>
<p>If you hold the little red Button on the USB BT mini-receiver it will enable the other mode. Hold the red button on the BT dongle and plug it into the computer, and after 3-5 seconds of holding the button, the Bluetooth icon will appear in the system tray. <a rel="nofollow" class="external text" href="http://ubuntuforums.org/showthread.php?t=1332197">Discussion</a>
</p>
<p>Alternatively, you can install the <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=bluez-hid2hci">bluez-hid2hci</a></span> package. When you connect your Logitech dongle it will automatically switch.
</p>
<h3><span class="mw-headline" id="hcitool_scan:_Device_not_found">hcitool scan: Device not found</span></h3>
<ul><li>On some laptops (e.g. Dell Studio 15, Lenovo Thinkpad X1) you have to switch the Bluetooth mode from HID to HCI. Install the <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=bluez-hid2hci">bluez-hid2hci</a></span> package, then <a href="../en/Udev.html" title="Udev">udev</a> should do this automatically. Alternatively, you can run this command to switch to HCI manually:</li></ul>
<pre># /usr/lib/udev/hid2hci
</pre>
<ul><li>If the device will not show up and you have a Windows operating system on your machine, try booting it and enable the bluetooth adapter from windows.</li></ul>
<ul><li>Sometimes also this simple command helps:</li></ul>
<pre># bluetoothctl power on
</pre>
<h3><span class="mw-headline" id="bluetoothctl:_No_default_controller_available">bluetoothctl: No default controller available</span></h3>
<p>This error may happen if the device is blocked by <a href="../en/Network_configuration/Wireless.html#Rfkill_caveat" class="mw-redirect" title="Rfkill">rfkill</a>.
</p>
<p>It might also happen with some intel cards (such as the 8260) to not be picked up correctly by the bluetooth service. In some cases, using the deprecated <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://aur.archlinux.org/packages/bluez-utils-compat/">bluez-utils-compat</a></span><sup><small>AUR</small></sup> in lieu of <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=bluez-utils">bluez-utils</a></span> have reportedly fixed the issue.
</p>
<p>This might also be caused by power saving measures, in which case adding the <a href="../en/Kernel_parameters.html#Configuration" title="Kernel parameters">kernel parameter</a> <code>btusb.enable_autosuspend=n</code> is a potential solution. See also <a rel="nofollow" class="external text" href="https://bugzilla.redhat.com/show_bug.cgi?id=1573562">Red Hat Bugzilla – Bug 1573562</a>.
</p>
<h3><span class="mw-headline" id="systemd:_Condition_check_resulted_in_Bluetooth_service_being_skipped">systemd: Condition check resulted in Bluetooth service being skipped</span></h3>
<p><code>bluetooth.service</code> only requires the directory <code>/sys/class/bluetooth</code> to exist, which should be created by kernel module <code>bluetooth</code>, which is only autoloaded by <code>systemd-udev</code> if it actually finds a working bluetooth hardware device. 
</p>
<p>If your <code>/sys/class/bluetooth</code> does not exist, check if your kernel bluetooth module is loaded by <code>lsmod</code>. If not, and you believe you have a bluetooth device, you can try manually starting them:
</p>
<pre># modprobe bluetooth
# systemctl restart bluetooth.service
</pre>
<p>You should also load your corresponding kernel bluetooth driver when you <code>modprobe bluetooth</code>, most likely <code>btusb</code>, but can also be <code>btrtl,btintel,btbcm,bnep,btusb</code> etc.
</p>
<p>Check your <code>systemctl status bluetooth.service</code> and see whether it started.
</p>
<p>See also <a rel="nofollow" class="external text" href="https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=853207">Debian Bug report logs - #853207</a>.
</p>
<p>If <code>bluetooth.service</code> started successfully, but there is chance that you still cannot use bluetooth normally (e.g. <code>bluetoothctl</code> says something like <code>org.Bluez.Error.NotReady</code> when you <code>scan on</code>). If this happens, try rebooting your computer, and double-check: whether directory <code>/sys/class/bluetooth</code> exists; whether <code>lsmod</code> includes correct bluetooth modules; log messages in <code>journalctl</code>; etc. <code>systemd-udev</code> should pickup your bluetooth hardware automatically without manual changes again.
</p>
<h3><span class="mw-headline" id="rfkill_unblock:_Do_not_unblock">rfkill unblock: Do not unblock</span></h3>
<p>If your device still soft blocked and you run <a href="../en/ConnMan.html" title="ConnMan">ConnMan</a>, try this:
</p>
<pre>$ connmanctl enable bluetooth
</pre>
<h3><span class="mw-headline" id="My_computer_is_not_visible">My computer is not visible</span></h3>
<p>Cannot discover computer from your phone? Enable discoverable mode:
</p>
<pre># bluetoothctl discoverable on
</pre>
<p>to check if it worked:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;"># bluetoothctl show</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">	Powered: yes
	Discoverable: yes
	Pairable: yes
</pre>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Note:</strong> Check DiscoverableTimeout and PairableTimeout in <code>/etc/bluetooth/main.conf</code>
</div>
<p>If even so it does not show up, try changing the device class in <code>/etc/bluetooth/main.conf</code> as following:
</p>
<pre># Default device class. Only the major and minor device class bits are
# considered.
#Class = 0x000100 (from default config)
Class = 0x100100
</pre>
<p>A user reported that this was the only solution to make his computer visible for his phone.
</p>
<h3><span class="mw-headline" id="Logitech_keyboard_does_not_pair">Logitech keyboard does not pair</span></h3>
<p>If you do not get the passkey when you try to pair your Logitech keyboard, type the following command:
</p>
<pre># btmgmt ssp off
</pre>
<p>If after pairing, the keyboard still does not connect, check the output of <code>hcidump -at</code>. If the latter indicates repeatedly connections-disconnections like the following message:
</p>
<pre>   status 0x00 handle 11 reason 0x13
   Reason: Remote User Terminated Connection
</pre>
<p>then, the only solution for now is to install <a href="../en/ArchWiki:Archive.html" class="mw-redirect" title="Bluez4">the old Bluetooth stack</a>.
</p>
<h3>
<span id="Foxconn_.2F_Hon_Hai_.2F_Lite-On_Broadcom_device"></span><span class="mw-headline" id="Foxconn_/_Hon_Hai_/_Lite-On_Broadcom_device">Foxconn / Hon Hai / Lite-On Broadcom device</span>
</h3>
<p>Some of these devices require the firmware to be flashed into the device at boot. The firmware is not provided but can converted from a Microsoft Windows <i>.hex</i> file into a <i>.hcd</i> using <a rel="nofollow" class="external text" href="https://github.com/jessesung/hex2hcd">hex2hcd</a> (which is installed with <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=bluez-utils">bluez-utils</a></span>).
</p>
<p>In order to get the right <i>.hex</i> file, try searching the device vendor:product code obtained with <i>lsusb</i>, for example:
</p>
<pre>   ...
   Bus 002 Device 004: ID <b>04ca:2006</b> Lite-On Technology Corp. Broadcom BCM43142A0 Bluetooth Device
   ...
</pre>
<p>or
</p>
<pre>   Bus 004 Device 004: Id <b>0489:e031</b> Foxconn / Hon Hai
</pre>
<p>Alternatively, boot into Windows (a virtual machine installation will suffice) and get the firmware name from the Device Manager utility. If you want to know the model of your device but cannot see it in <i>lsusb</i>, you might see it in <i>lsusb -v</i> as <code>iProduct</code>.
</p>
<p>The <i>.hex</i> file can be extracted from the downloaded Windows driver without having to run Windows for it. Download the right driver, for example <a rel="nofollow" class="external text" href="http://www.fujitsupc.com/downloads/mobile/BLUETOOTH_WIDCOMM_V6.5.0.3100_WIN7-32_FPC46-1771-01.EXE">Bluetooth Widcomm</a> (listed among the drivers for <a rel="nofollow" class="external text" href="http://support.fujitsupc.com/CS/Portal/supportsearch.do?srch=DOWNLOADS&amp;Series=P%20Series&amp;Model=P771&amp;ProductType=Notebook%20PC">Lifebook P771</a>), which contains the drivers for many Broadcomm devices. In case of Bluetooth Widcomm, the driver is a self-extracting RAR archive, so it can be extracted using <i><span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=unrar">unrar</a></span> x</i>. To find out which of the many <i>.hex</i> files is the right one for you, look in the file <code>Win32/bcbtums-win7x86-brcm.inf</code> and search for <code>[RAMUSB<b>E031</b>.CopyList]</code>, where <code>E031</code> should be replaced with the product code (the second hex number in <i>lsusb</i>) of your device in upper-case. Underneath you should see the file name of the right <i>.hex</i> file.
</p>
<p>Once you have the <i>.hcd</i> file, copy it into <code>/lib/firmware/brcm/BCM.hcd</code> - this filename is suggested by <code>dmesg</code> and it may change in your case so check your <i>dmesg</i> output in order to verify. Then reload the <i>btusb</i> module:
</p>
<pre># rmmod btusb
# modprobe btusb
</pre>
<p>The device should now be available. See <a rel="nofollow" class="external text" href="https://bbs.archlinux.org/viewtopic.php?id=162688">BBS#162688</a> for information on making these changes persistent.
</p>
<h3><span class="mw-headline" id="Intel_combined_wifi_and_bluetooth_cards">Intel combined wifi and bluetooth cards</span></h3>
<p>See <a href="../en/Network_configuration/Wireless.html#Bluetooth_coexistence" class="mw-redirect" title="Wireless network configuration">Wireless network configuration#Bluetooth coexistence</a>.
</p>
<h3>
<span id="Device_connects.2C_then_disconnects_after_a_few_moments"></span><span class="mw-headline" id="Device_connects,_then_disconnects_after_a_few_moments">Device connects, then disconnects after a few moments</span>
</h3>
<p>If you see messages like the following in <code>journalctl</code> output, and your device fails to connect or disconnects shortly after connecting:
</p>
<pre>bluetoothd: Unable to get connect data for Headset Voice gateway: getpeername: Transport endpoint is not connected (107)
bluetoothd: connect error: Connection refused (111)
</pre>
<p>This may be because you have already paired the device with another operating system using the same bluetooth adapter (e.g., dual-booting).  Some devices cannot handle multiple pairings associated with the same MAC address (i.e., bluetooth adapters). Follow instructions on <a href="#Dual_boot_pairing">#Dual boot pairing</a> for solving this issue.
</p>
<h3><span class="mw-headline" id="Device_does_not_connect_with_an_error_in_journal">Device does not connect with an error in journal</span></h3>
<p>If you see a message like the following in <code>journalctl</code> output while trying to connect to a device:
</p>
<pre>a2dp-source profile connect failed for 9C:64:40:22:E1:3F: Protocol not available
</pre>
<p>try installing <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=pulseaudio-bluetooth">pulseaudio-bluetooth</a></span> and restarting <a href="../en/PulseAudio.html" title="PulseAudio">PulseAudio</a>. This error can manifest even while using only file transfer.
</p>
<h3><span class="mw-headline" id="Device_does_not_show_up_in_scan">Device does not show up in scan</span></h3>
<p>Some devices using bluetooth low energy do not appear when scanning with bluetoothctl, for example the Logitech MX Master. The simplest way I have found to connect them is by installing <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://aur.archlinux.org/packages/bluez-utils-compat/">bluez-utils-compat</a></span><sup><small>AUR</small></sup>, then <a href="../en/Systemd.html#Using_units" class="mw-redirect" title="Start">start</a> <code>bluetooth.service</code> and do:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;"># bluetoothctl</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">[NEW] Controller (MAC) myhostname [default]
</pre>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">[bluetooth]# power on</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">[CHG] Controller (MAC) Class: 0x0c010c
Changing power on succeeded
[CHG] Controller (MAC) Powered: yes
</pre>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">[bluetooth]# scan on</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">Discovery started
[CHG] Controller (MAC) Discovering: yes
</pre>
<p>In another terminal:
</p>
<pre># hcitool lescan
</pre>
<p>Wait until your device shows up, then <code>Ctrl+c</code> hcitool. bluetoothctl should now see your device and pair normally.
</p>
<h3><span class="mw-headline" id="Interference_between_Headphones_and_Mouse">Interference between Headphones and Mouse</span></h3>
<p>If you experience audio stuttering while using a bluetooth mouse and keyboard simultaneously, you can try the following as referenced in #23 <a rel="nofollow" class="external free" href="https://bugs.launchpad.net/ubuntu/+source/bluez/+bug/424215">https://bugs.launchpad.net/ubuntu/+source/bluez/+bug/424215</a>
</p>
<pre># hciconfig hci0 lm ACCEPT,MASTER
# hciconfig hci0 lp HOLD,SNIFF,PARK
</pre>
<h3><span class="mw-headline" id="Bluetooth_mouse_laggy_movements">Bluetooth mouse laggy movements</span></h3>
<p>Try edit the file <code>/var/lib/bluetooth/XX:XX:XX:XX:XX:XX/YY:YY:YY:YY:YY:YY/info</code> (<code>XX:XX:XX:XX:XX:XX</code> - your Bluetooth adapter MAC-address, <code>YY:YY:YY:YY:YY:YY</code> - your mouse MAC-address) and add those lines:
</p>
<pre>[ConnectionParameters]
MinInterval=6
MaxInterval=9
Latency=44
Timeout=216
</pre>
<p>You can see your local adapter MAC address by running command <code>hcitool dev</code>, your can see MAC addresses of currently connected remote devices by running command <code>hcitool con</code>
</p>
<h3>
<span id="Adapter_disappears_after_suspend.2Fresume"></span><span class="mw-headline" id="Adapter_disappears_after_suspend/resume">Adapter disappears after suspend/resume</span>
</h3>
<p>First, find vendor and product ID of the adapter. For example:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">lsusb -tv</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">/:  Bus 01.Port 1: Dev 1, Class=root_hub, Driver=xhci_hcd/12p, 480M
    ID 1d6b:0002 Linux Foundation 2.0 root hub
    ...
    |__ Port 3: Dev 3, If 0, Class=Wireless, Driver=btusb, 12M
        ID 8087:0025 Intel Corp. 
    |__ Port 3: Dev 3, If 1, Class=Wireless, Driver=btusb, 12M
        ID 8087:0025 Intel Corp. 
    ...
</pre>
<p>In this case, the vendor ID is 8087 and the product ID is 0025.
</p>
<p>Then, use <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=usb_modeswitch">usb_modeswitch</a></span> to reset the adapter:
</p>
<pre># usb_modeswitch -R -v &lt;vendor ID&gt; -p &lt;product ID&gt;
</pre>
<h3>
<span id="Problems_with_all_BLE_devices_on_kernel_5.9.2B"></span><span class="mw-headline" id="Problems_with_all_BLE_devices_on_kernel_5.9+">Problems with all BLE devices on kernel 5.9+</span>
</h3>
<p>Starting with v5.9, the kernel Bluetooth stack tries to use link-layer privacy on BLE connections. If the device works after pairing but does not survive a reboot or suspend, it is probably because of this.
</p>
<p>To workaround <a rel="nofollow" class="external autonumber" href="https://lkml.kernel.org/lkml/D577711C-4AF5-4E82-8A17-E766B64E15A9@holtmann.org/">[1]</a> this issue, open <code>/var/lib/bluetooth/&lt;adapter mac&gt;/&lt;device mac&gt;/info</code>, remove the following lines, and restart <code>bluetooth.service</code>:
</p>
<pre>[IdentityResolvingKey]
Key=...</pre>
<p>See the relevant <a rel="nofollow" class="external text" href="https://bbs.archlinux.org/viewtopic.php?id=259954">discussion</a> on the Arch forum.
</p>
<h3><span class="mw-headline" id="Problems_with_some_Bluetooth_drivers_in_kernel_5.10">Problems with some Bluetooth drivers in kernel 5.10</span></h3>
<p>Starting with v5.10, some Qualcomm Atheros bluetooth chipset drivers have stopped working with the following error:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">journalctl | grep hci0 </pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">Feb 22 18:40:24 user kernel: Bluetooth: hci0: don't support firmware rome 0x31010000
</pre>
<p>See the relevant <a rel="nofollow" class="external text" href="https://bugzilla.kernel.org/show_bug.cgi?id=210681">bug report</a> on the Linux.org Bugzilla.
</p>
<p>You can either rebuild the modules with the applied patches (<a rel="nofollow" class="external text" href="https://github.com/BrandomRobor/btusb-210681-fix">btusb-210681-fix</a>), or use an old (5.9.x) kernel. This bug was fixed in <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=linux">linux</a></span> 5.11.arch2-1.
</p>
</div>
</div>
<div id="catlinks" class="catlinks" data-mw="interface">
<div id="mw-normal-catlinks" class="mw-normal-catlinks">
<a href="../Special:Categories.html" title="Special:Categories">Category</a>: <ul><li><a href="../en/Category:Bluetooth.html" title="Category:Bluetooth">Bluetooth</a></li></ul>
</div>
<div id="mw-hidden-catlinks" class="mw-hidden-catlinks mw-hidden-cats-hidden">Hidden categories: <ul>
<li><a href="../en/Category:Pages_or_sections_flagged_with_Template:Expansion.html" title="Category:Pages or sections flagged with Template:Expansion">Pages or sections flagged with Template:Expansion</a></li>
<li><a href="../en/Category:Pages_or_sections_flagged_with_Template:Out_of_date.html" title="Category:Pages or sections flagged with Template:Out of date">Pages or sections flagged with Template:Out of date</a></li>
</ul>
</div>
</div>
	</div>
</div>

<footer id="footer" class="mw-footer" role="contentinfo" style="margin: 0">
	<ul id="footer-info">
		<li>Retrieved from "<a dir="ltr" href="https://wiki.archlinux.org/index.php?title=Bluetooth&amp;oldid=654089">https://wiki.archlinux.org/index.php?title=Bluetooth&amp;oldid=654089</a>"</li>
		<li id="footer-info-lastmod"> This page was last edited on 6 March 2021, at 12:49.</li>
		<li id="footer-info-copyright">Content is available under <a class="external" rel="nofollow" href="http://www.gnu.org/copyleft/fdl.html">GNU Free Documentation License 1.3 or later</a> unless otherwise noted.</li>
	<br>
</ul>
	<ul id="footer-places">
		<li id="footer-places-privacy"><a href="../en/ArchWiki:Privacy_policy.html" title="ArchWiki:Privacy policy">Privacy policy</a></li>
		<li id="footer-places-about"><a href="../en/ArchWiki:About.html" title="ArchWiki:About">About ArchWiki</a></li>
		<li id="footer-places-disclaimer"><a href="../en/ArchWiki:General_disclaimer.html" title="ArchWiki:General disclaimer">Disclaimers</a></li>
	</ul>
	<ul id="footer-icons" class="noprint">
		<li id="footer-copyrightico">
	</ul>
	<div style="clear: both;"></div>
</footer>



</body>
</html>
