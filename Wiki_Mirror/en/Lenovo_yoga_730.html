<!DOCTYPE html>
<html class="client-nojs" lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<title>Lenovo yoga 730 - ArchWiki</title>
<link rel="stylesheet" href="../ArchWikiOffline.css">
<meta name="ResourceLoaderDynamicStyles" content="">
<meta name="generator" content="MediaWiki 1.35.0">
<meta name="robots" content="noindex,follow">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="shortcut icon" href="/favicon.ico">
<link rel="search" type="application/opensearchdescription+xml" href="/opensearch_desc.php" title="ArchWiki (en)">
<link rel="EditURI" type="application/rsd+xml" href="https://wiki.archlinux.org/api.php?action=rsd">
<link rel="license" href="http://www.gnu.org/copyleft/fdl.html">
<link rel="alternate" type="application/atom+xml" title="ArchWiki Atom feed" href="/index.php?title=Special:RecentChanges&amp;feed=atom">
</head>
<body class="mediawiki ltr sitedir-ltr mw-hide-empty-elt ns-0 ns-subject page-Lenovo_yoga_730 rootpage-Lenovo_yoga_730 skin-vector action-view skin-vector-legacy">
<div id="content" class="mw-body" role="main" style="margin: 0">
	<a id="top"></a>
	<div id="siteNotice" class="mw-body-content"></div>
	<div class="mw-indicators mw-body-content">
	</div>
	<h1 id="firstHeading" class="firstHeading" lang="en">Lenovo yoga 730</h1>
	<div id="bodyContent" class="mw-body-content">
		<div id="siteSub" class="noprint">From ArchWiki</div>
		<div id="contentSub"></div>
		<div id="contentSub2"></div>
		
		<div id="jump-to-nav"></div>
		<a class="mw-jump-link" href="#mw-head">Jump to navigation</a>
		<a class="mw-jump-link" href="#searchInput">Jump to search</a>
		<div id="mw-content-text" lang="en" dir="ltr" class="mw-content-ltr">
<div class="warningbox">The printable version is no longer supported and may have rendering errors. Please update your browser bookmarks and please use the default browser print function instead.</div>
<div class="mw-parser-output">
<div id="toc" class="toc" role="navigation" aria-labelledby="mw-toc-heading">
<input type="checkbox" role="button" id="toctogglecheckbox" class="toctogglecheckbox" style="display:none"><div class="toctitle" lang="en" dir="ltr">
<h2 id="mw-toc-heading">Contents</h2>
<span class="toctogglespan"><label class="toctogglelabel" for="toctogglecheckbox"></label></span>
</div>
<ul>
<li class="toclevel-1 tocsection-1">
<a href="#Install"><span class="tocnumber">1</span> <span class="toctext">Install</span></a>
<ul>
<li class="toclevel-2 tocsection-2"><a href="#Packages"><span class="tocnumber">1.1</span> <span class="toctext">Packages</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-3"><a href="#Suspend"><span class="tocnumber">2</span> <span class="toctext">Suspend</span></a></li>
<li class="toclevel-1 tocsection-4">
<a href="#Backlight"><span class="tocnumber">3</span> <span class="toctext">Backlight</span></a>
<ul>
<li class="toclevel-2 tocsection-5"><a href="#Fingerprint_reader"><span class="tocnumber">3.1</span> <span class="toctext">Fingerprint reader</span></a></li>
<li class="toclevel-2 tocsection-6">
<a href="#Thunderbolt_3"><span class="tocnumber">3.2</span> <span class="toctext">Thunderbolt 3</span></a>
<ul>
<li class="toclevel-3 tocsection-7"><a href="#eGPU"><span class="tocnumber">3.2.1</span> <span class="toctext">eGPU</span></a></li>
<li class="toclevel-3 tocsection-8"><a href="#Dock_Stations"><span class="tocnumber">3.2.2</span> <span class="toctext">Dock Stations</span></a></li>
</ul>
</li>
<li class="toclevel-2 tocsection-9"><a href="#Tablet_mode"><span class="tocnumber">3.3</span> <span class="toctext">Tablet mode</span></a></li>
<li class="toclevel-2 tocsection-10"><a href="#Pen"><span class="tocnumber">3.4</span> <span class="toctext">Pen</span></a></li>
<li class="toclevel-2 tocsection-11"><a href="#External_display"><span class="tocnumber">3.5</span> <span class="toctext">External display</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-12">
<a href="#Issues"><span class="tocnumber">4</span> <span class="toctext">Issues</span></a>
<ul>
<li class="toclevel-2 tocsection-13"><a href="#USB-C_Charging"><span class="tocnumber">4.1</span> <span class="toctext">USB-C Charging</span></a></li>
</ul>
</li>
</ul>
</div>

<h2><span class="mw-headline" id="Install">Install</span></h2>
<h3><span class="mw-headline" id="Packages">Packages</span></h3>
<table class="wikitable">
<caption>Packages to install
</caption>
<tbody>
<tr>
<th>Package</th>
<th>purpose
</th>
</tr>
<tr>
<td><span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=iio-sensor-proxy">iio-sensor-proxy</a></span></td>
<td>Auto brightness
</td>
</tr>
<tr>
<td><span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=bolt">bolt</a></span></td>
<td>Thunderbolt 3
</td>
</tr>
<tr>
<td><span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=xf86-input-wacom">xf86-input-wacom</a></span></td>
<td>Digitiser/Pen support
</td>
</tr>
<tr>
<td><span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=nvidia">nvidia</a></span></td>
<td>For external GPU
</td>
</tr>
<tr>
<td><span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=intel-compute-runtime">intel-compute-runtime</a></span></td>
<td>For OpenCL CPU support
</td>
</tr>
</tbody>
</table>
<h2><span class="mw-headline" id="Suspend">Suspend</span></h2>
<p>If closing the lid doesn't suspend. In <code>/etc/systemd/logind.conf</code> uncomment the following:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/systemd/logind.conf/etc/systemd/logind.conf</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">HandleSuspendKey=suspend
HandleLidSwitch=suspend</pre>
<h2><span class="mw-headline" id="Backlight">Backlight</span></h2>
<p>Works in gnome but can be reduced so far that it goes off, leaving the screen black.
</p>
<p>One of these kernel parameters might fix this:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">kernel parameters</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">acpi_backlight=video
acpi_backlight=vendor
acpi_backlight=native</pre>
<p>Installing <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=iio-sensor-proxy">iio-sensor-proxy</a></span> does auto brightness.
</p>
<h3><span class="mw-headline" id="Fingerprint_reader">Fingerprint reader</span></h3>
<p>The device is <code>Bus 001 Device 005: ID 06cb:0081 Synaptics, Inc. </code>
Nether <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/groups/x86_64/fprint/">fprint</a></span> nor <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://aur.archlinux.org/packages/thinkfinger/">thinkfinger</a></span><sup><small>AUR</small></sup> work, but there is a prototype driver <a rel="nofollow" class="external text" href="https://github.com/nmikhailov/Validity90">here</a>.
</p>
<h3><span class="mw-headline" id="Thunderbolt_3">Thunderbolt 3</span></h3>
<p>
Works once you install <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=bolt">bolt</a></span>.  </p>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Note:</strong> TODO: Add links to authoritative information on tb3</div>
<p> This can be temperamental, it may require unplugging and re-plugging the eGPU.
</p>
<h4><span class="mw-headline" id="eGPU">eGPU</span></h4>
<p>This was tested with a Gigabyte Aorus 1070. <a href="../en/Bumblebee.html" title="Bumblebee">Bumblebee</a> might blacklist the nvidia module, comment out the nvidia modules in <code>/usr/lib/modprobe.d/bumblebee.conf</code> so that it looks like this:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/usr/lib/modprobe.d/bumblebee.conf</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">#blacklist nvidia
#blacklist nvidia-drm
#blacklist nvidia-modeset
#blacklist nvidia-uvm
blacklist nouveau</pre>
<p>The following allows Xorg to use the GPU if it exists - you'll need to ether delay the Xorg startup or restart it once the device is fully active.
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">xorg.conf for both external and internal graphics</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">Section "ServerLayout"
    Identifier  "eGPU"
    # The two screens allow the server to start in one of two modes
    Screen 0 "eGPUScreen"
    Inactive "Intel"   
    Screen 1 "IntelScreen"
EndSection

Section "Device"
    Identifier  "eGPU"
    Driver      "nvidia"
    VendorName  "NVIDIA Corporation"
    Option "NoLogo" "true"
    Option "AllowEmptyInitialConfiguration"
    Option "AllowExternalGpus"
EndSection

Section "Device"
    Identifier   "Intel"
    Driver       "intel"
    VendorName   "Intel"
EndSection

Section "Screen"
    Identifier "eGPUScreen"
    Device     "eGPU"
EndSection

Section "Screen"
    Identifier "IntelScreen"
    Device     "Intel"
EndSection
</pre>
<p>You can use this script to delay the display manager until the device is fully configured.
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/usr/local/bin/wait-for-egpu.sh</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">#!/bin/bash
DEVICE=/dev/dri/card1

# switch to our vt to see the messages
chvt 2
delay=30
wait=1

#while [ \( ! -c "$DEVICE" \) -a $delay -gt 1 -a `cat /sys/class/power_supply/AC*/online` != "1" ] ; do
while [ $wait -gt 0 -a $delay -gt 1 ]; do

        if [ \( -c "$DEVICE" \) -a `cat /sys/class/power_supply/AC*/online` == "1" ] ; then
                echo $'\e[32;1meGPU present, on AC power.\e[0m'
        elif [ -c "$DEVICE" ]; then
                echo $'\e[33;1meGPU present but no power.\e[0m'
        else
                echo $'\e[31;1mNo eGPU.\e[0m'
        fi

        echo "Press 'Y' to continue to Login. Press 'W' to wait forever. Any other key to rescan."

        if read -r -s -n 1 -t 5 key ; then

                if [ "$key" == "y" -o "$key" == "Y" ]; then
                        wait=0
                elif [ "$key" == "w" -o "$key" == "W" ]; then
                        wait=2
                fi
        elif [ $wait -eq 1 ]; then
                let "delay -= 5"
                echo "Waiting for ${delay} more seconds for eGPU."
        fi

done</pre>
<p>Add the <a href="../en/Systemd.html" title="Systemd">systemd</a> setup file below and activate it with <code>systemctl daemon-reload</code> and <code>systemctl enable wait-for-egpu</code>
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/systemd/system/wait-for-egpu.service</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">[Unit]
Description=Simple interactive dialog window
After=getty@tty2.service
Before=display-manager.service

[Service]
Type=oneshot
ExecStart=/usr/local/bin/wait-for-egpu.sh
StandardInput=tty
TTYPath=/dev/tty2
TTYReset=yes
TTYVHangup=yes

[Install]
WantedBy=multi-user.target</pre>
<h4><span class="mw-headline" id="Dock_Stations">Dock Stations</span></h4>
<table class="wikitable">
<caption>Wavlink USB-C Ultra 5K Universal Docking Station
</caption>
<tbody>
<tr>
<th>Feature</th>
<th>Status
</th>
</tr>
<tr>
<td>USB-C</td>
<td data-sort-value="5" style="background: #afa; color: inherit; vertical-align: middle; text-align: center;">Working
</td>
</tr>
<tr>
<td>USB 3.0</td>
<td data-sort-value="5" style="background: #afa; color: inherit; vertical-align: middle; text-align: center;">Working
</td>
</tr>
<tr>
<td>Audio Jack</td>
<td data-sort-value="5" style="background: #afa; color: inherit; vertical-align: middle; text-align: center;">Working
</td>
</tr>
<tr>
<td>Gigabit Ethernet</td>
<td data-sort-value="5" style="background: #afa; color: inherit; vertical-align: middle; text-align: center;">Working
</td>
</tr>
<tr>
<td>HDMI 1 &amp; 2</td>
<td data-sort-value="3" style="background: #ffa; color: inherit; vertical-align: middle; text-align: center;">Only X11, requires <a href="../en/DisplayLink.html" title="DisplayLink">DisplayLink</a>
</td>
</tr>
<tr>
<td>DisplayPort 1 &amp; 2</td>
<td data-sort-value="1" style="background: #faa; color: inherit; vertical-align: middle; text-align: center;">Untested
</td>
</tr>
<tr>
<td>5K Combo (Joined DisplayPorts)</td>
<td data-sort-value="1" style="background: #faa; color: inherit; vertical-align: middle; text-align: center;">Untested
</td>
</tr>
</tbody>
</table>
<div class="archwiki-template-box archwiki-template-box-warning">
<strong>Warning:</strong> Some Windows Managers running in Wayland will freeze your system completely if there is a display connected to the dock station, requiring a reboot. This is the case of SwayWM.</div>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Note:</strong> DisplayLink has stated <a rel="nofollow" class="external text" href="https://support.displaylink.com/forums/287786-displaylink-feature-suggestions/suggestions/16639654-linux-wayland-support">here</a> that they are working to bring eGPU/DisplayLink multimonitor support to Wayland through GNOME and a <a rel="nofollow" class="external text" href="https://gitlab.gnome.org/GNOME/mutter/commit/d4bea60e1aab8e58bd2925d24256ddfdd125dbdb">patch was submitted for GNOME 3.32</a>
</div>
<h3><span class="mw-headline" id="Tablet_mode">Tablet mode</span></h3>
<p>Try gnome extension slide-for-keyboard, keyboard automatically disables under gnome.
</p>
<h3><span class="mw-headline" id="Pen">Pen</span></h3>
<p>install <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=xf86-input-wacom">xf86-input-wacom</a></span>
</p>
<h3><span class="mw-headline" id="External_display">External display</span></h3>
<p>HDMI on USB-C adapter just works
</p>
<h2><span class="mw-headline" id="Issues">Issues</span></h2>
<h3><span class="mw-headline" id="USB-C_Charging">USB-C Charging</span></h3>
<p>With the Gigabyte Aorus 1070 Gaming box, the charging sometimes stops. Doesn't seem to happen in Windows.
</p>
</div>
</div>
<div id="catlinks" class="catlinks" data-mw="interface"><div id="mw-normal-catlinks" class="mw-normal-catlinks">
<a href="../Special:Categories.html" title="Special:Categories">Category</a>: <ul><li><a href="../en/Category:Lenovo.html" title="Category:Lenovo">Lenovo</a></li></ul>
</div></div>
	</div>
</div>

<footer id="footer" class="mw-footer" role="contentinfo" style="margin: 0">
	<ul id="footer-info">
		<li>Retrieved from "<a dir="ltr" href="https://wiki.archlinux.org/index.php?title=Lenovo_yoga_730&amp;oldid=571643">https://wiki.archlinux.org/index.php?title=Lenovo_yoga_730&amp;oldid=571643</a>"</li>
		<li id="footer-info-lastmod"> This page was last edited on 20 April 2019, at 08:35.</li>
		<li id="footer-info-copyright">Content is available under <a class="external" rel="nofollow" href="http://www.gnu.org/copyleft/fdl.html">GNU Free Documentation License 1.3 or later</a> unless otherwise noted.</li>
	<br>
</ul>
	<ul id="footer-places">
		<li id="footer-places-privacy"><a href="../en/ArchWiki:Privacy_policy.html" title="ArchWiki:Privacy policy">Privacy policy</a></li>
		<li id="footer-places-about"><a href="../en/ArchWiki:About.html" title="ArchWiki:About">About ArchWiki</a></li>
		<li id="footer-places-disclaimer"><a href="../en/ArchWiki:General_disclaimer.html" title="ArchWiki:General disclaimer">Disclaimers</a></li>
	</ul>
	<ul id="footer-icons" class="noprint">
		<li id="footer-copyrightico">
	</ul>
	<div style="clear: both;"></div>
</footer>



</body>
</html>
