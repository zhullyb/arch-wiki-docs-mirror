<!DOCTYPE html>
<html class="client-nojs" lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<title>Network configuration (Čeština) - ArchWiki</title>
<link rel="stylesheet" href="../ArchWikiOffline.css">
<meta name="ResourceLoaderDynamicStyles" content="">
<meta name="generator" content="MediaWiki 1.35.0">
<meta name="referrer" content="no-referrer-when-downgrade">
<meta name="robots" content="noindex,follow">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="shortcut icon" href="/favicon.ico">
<link rel="search" type="application/opensearchdescription+xml" href="/opensearch_desc.php" title="ArchWiki (en)">
<link rel="EditURI" type="application/rsd+xml" href="https://wiki.archlinux.org/api.php?action=rsd">
<link rel="license" href="http://www.gnu.org/copyleft/fdl.html">
<link rel="alternate" type="application/atom+xml" title="ArchWiki Atom feed" href="/index.php?title=Special:RecentChanges&amp;feed=atom">
</head>
<body class="mediawiki ltr sitedir-ltr mw-hide-empty-elt ns-0 ns-subject page-Network_configuration_Čeština rootpage-Network_configuration_Čeština skin-vector action-view skin-vector-legacy">
<div id="content" class="mw-body" role="main" style="margin: 0">
	<a id="top"></a>
	<div id="siteNotice" class="mw-body-content"></div>
	<div class="mw-indicators mw-body-content">
	</div>
	<h1 id="firstHeading" class="firstHeading" lang="en">Network configuration (Čeština)</h1>
	<div id="bodyContent" class="mw-body-content">
		<div id="siteSub" class="noprint">From ArchWiki</div>
		<div id="contentSub"></div>
		<div id="contentSub2"></div>
		
		<div id="jump-to-nav"></div>
		<a class="mw-jump-link" href="#mw-head">Jump to navigation</a>
		<a class="mw-jump-link" href="#searchInput">Jump to search</a>
		<div id="mw-content-text" lang="en" dir="ltr" class="mw-content-ltr">
<div class="warningbox">The printable version is no longer supported and may have rendering errors. Please update your browser bookmarks and please use the default browser print function instead.</div>
<div class="mw-parser-output">
<div class="noprint archwiki-template-message">
<p><a href="/title/File:Tango-view-refresh-red.png" class="image"><img alt="Tango-view-refresh-red.png" src="../File:Tango-view-refresh-red.png" decoding="async" width="48" height="48"></a><b>This article or section is out of date.</b><a href="/title/File:Tango-view-refresh-red.png" class="image"><img alt="Tango-view-refresh-red.png" src="../File:Tango-view-refresh-red.png" decoding="async" width="48" height="48"></a></p>
<div>
<b>Reason:</b> <span style="color:red;">please use the first argument of the template to provide a brief explanation.</span> (Discuss in <a rel="nofollow" class="external text" href="https://wiki.archlinux.org/title/Talk:Network_configuration_(%C4%8Ce%C5%A1tina)">Talk:Network configuration (Čeština)#</a>)</div>
</div>
<div class="noprint archwiki-template-message">
<p><a href="/title/File:Tango-preferences-desktop-locale.png" class="image"><img alt="Tango-preferences-desktop-locale.png" src="../File:Tango-preferences-desktop-locale.png" decoding="async" width="48" height="48"></a><b>This article or section needs to be <a href="/title/ArchWiki:Contributing#Translating" title="ArchWiki:Contributing">translated</a>.</b><a href="/title/File:Tango-preferences-desktop-locale.png" class="image"><img alt="Tango-preferences-desktop-locale.png" src="../File:Tango-preferences-desktop-locale.png" decoding="async" width="48" height="48"></a></p>
<div>
<b>Notes:</b> <span style="color:red;">please use the first argument of the template to provide more detailed indications.</span> (Discuss in <a rel="nofollow" class="external text" href="https://wiki.archlinux.org/title/Talk:Network_configuration_(%C4%8Ce%C5%A1tina)">Talk:Network configuration (Čeština)#</a>)</div>
</div>
<div id="toc" class="toc" role="navigation" aria-labelledby="mw-toc-heading">
<input type="checkbox" role="button" id="toctogglecheckbox" class="toctogglecheckbox" style="display:none"><div class="toctitle" lang="en" dir="ltr">
<h2 id="mw-toc-heading">Contents</h2>
<span class="toctogglespan"><label class="toctogglelabel" for="toctogglecheckbox"></label></span>
</div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Nastaven%C3%AD_hostname"><span class="tocnumber">1</span> <span class="toctext">Nastavení hostname</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#Nahr%C3%A1n%C3%AD_ovlada%C4%8De_(modulu)_za%C5%99%C3%ADzeni"><span class="tocnumber">2</span> <span class="toctext">Nahrání ovladače (modulu) zařízeni</span></a></li>
<li class="toclevel-1 tocsection-3">
<a href="#Nastaven%C3%AD_IP_adresy"><span class="tocnumber">3</span> <span class="toctext">Nastavení IP adresy</span></a>
<ul>
<li class="toclevel-2 tocsection-4"><a href="#DHCP"><span class="tocnumber">3.1</span> <span class="toctext">DHCP</span></a></li>
<li class="toclevel-2 tocsection-5"><a href="#Statick%C3%A1_IP"><span class="tocnumber">3.2</span> <span class="toctext">Statická IP</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-6"><a href="#Aktualizace_konfigurace"><span class="tocnumber">4</span> <span class="toctext">Aktualizace konfigurace</span></a></li>
<li class="toclevel-1 tocsection-7">
<a href="#N%C4%9Bkter%C3%A1_dal%C5%A1%C3%AD_nastaven%C3%AD"><span class="tocnumber">5</span> <span class="toctext">Některá další nastavení</span></a>
<ul>
<li class="toclevel-2 tocsection-8"><a href="#Bezdr%C3%A1tov%C3%A9_s%C3%ADt%C4%9B"><span class="tocnumber">5.1</span> <span class="toctext">Bezdrátové sítě</span></a></li>
<li class="toclevel-2 tocsection-9"><a href="#Firewall"><span class="tocnumber">5.2</span> <span class="toctext">Firewall</span></a></li>
<li class="toclevel-2 tocsection-10"><a href="#Ifplugd"><span class="tocnumber">5.3</span> <span class="toctext">Ifplugd</span></a></li>
<li class="toclevel-2 tocsection-11">
<a href="#OpenVPN"><span class="tocnumber">5.4</span> <span class="toctext">OpenVPN</span></a>
<ul>
<li class="toclevel-3 tocsection-12"><a href="#P%C5%99%C3%ADprava"><span class="tocnumber">5.4.1</span> <span class="toctext">Příprava</span></a></li>
<li class="toclevel-3 tocsection-13"><a href="#Generov%C3%A1n%C3%AD_certifik%C3%A1t%C5%AF"><span class="tocnumber">5.4.2</span> <span class="toctext">Generování certifikátů</span></a></li>
<li class="toclevel-3 tocsection-14"><a href="#Konfigurace_serveru"><span class="tocnumber">5.4.3</span> <span class="toctext">Konfigurace serveru</span></a></li>
<li class="toclevel-3 tocsection-15"><a href="#Spusteni_OpenVPN_serveru"><span class="tocnumber">5.4.4</span> <span class="toctext">Spusteni OpenVPN serveru</span></a></li>
<li class="toclevel-3 tocsection-16"><a href="#Konfigurace_Klienta"><span class="tocnumber">5.4.5</span> <span class="toctext">Konfigurace Klienta</span></a></li>
</ul>
</li>
</ul>
</li>
<li class="toclevel-1 tocsection-17">
<a href="#%C5%98e%C5%A1en%C3%AD_probl%C3%A9m%C5%AF"><span class="tocnumber">6</span> <span class="toctext">Řešení problémů</span></a>
<ul>
<li class="toclevel-2 tocsection-18">
<a href="#Probl%C3%A9m_se_%C5%A1k%C3%A1lov%C3%A1n%C3%ADm_TCP_ok%C3%A9nka_(Window)"><span class="tocnumber">6.1</span> <span class="toctext">Problém se škálováním  TCP okénka (Window)</span></a>
<ul>
<li class="toclevel-3 tocsection-19"><a href="#Jak_diagnostikovat_probl%C3%A9m?"><span class="tocnumber">6.1.1</span> <span class="toctext">Jak diagnostikovat problém?</span></a></li>
<li class="toclevel-3 tocsection-20"><a href="#Jak_to_opravit?_(%C5%A1patn%C3%A1_cesta)"><span class="tocnumber">6.1.2</span> <span class="toctext">Jak to opravit? (špatná cesta)</span></a></li>
<li class="toclevel-3 tocsection-21"><a href="#Jak_to_opravit?_(dobr%C3%A1_cesta)"><span class="tocnumber">6.1.3</span> <span class="toctext">Jak to opravit? (dobrá cesta)</span></a></li>
<li class="toclevel-3 tocsection-22"><a href="#Jak_to_opravit?_(nejlep%C5%A1%C3%AD_cesta)"><span class="tocnumber">6.1.4</span> <span class="toctext">Jak to opravit? (nejlepší cesta)</span></a></li>
<li class="toclevel-3 tocsection-23"><a href="#V%C3%ADce?"><span class="tocnumber">6.1.5</span> <span class="toctext">Více?</span></a></li>
</ul>
</li>
<li class="toclevel-2 tocsection-24">
<a href="#Probl%C3%A9m_s_Realteky_bez_spojen%C3%AD/WOL"><span class="tocnumber">6.2</span> <span class="toctext">Problém s Realteky bez spojení/WOL</span></a>
<ul>
<li class="toclevel-3 tocsection-25"><a href="#Metoda_1_-_Vr%C3%A1cen%C3%AD_/_zm%C4%9Bna_Win_ovlada%C4%8De"><span class="tocnumber">6.2.1</span> <span class="toctext">Metoda 1 - Vrácení / změna Win ovladače</span></a></li>
<li class="toclevel-3 tocsection-26"><a href="#Metoda_2_-_Povolen%C3%AD_WOL_ve_Win_ovlada%C4%8Di"><span class="tocnumber">6.2.2</span> <span class="toctext">Metoda 2 - Povolení WOL ve Win ovladači</span></a></li>
<li class="toclevel-3 tocsection-27"><a href="#Metoda_3_-_Nov%C4%9Bj%C5%A1%C3%AD_ovlada%C4%8De_Realtek_pro_Linux"><span class="tocnumber">6.2.3</span> <span class="toctext">Metoda 3 - Novější ovladače Realtek pro Linux</span></a></li>
</ul>
</li>
<li class="toclevel-2 tocsection-28">
<a href="#DLink_G604T/DLink_G502T:_probl%C3%A9m_DNS"><span class="tocnumber">6.3</span> <span class="toctext">DLink G604T/DLink G502T: problém DNS</span></a>
<ul>
<li class="toclevel-3 tocsection-29"><a href="#Jak_diagnostikovat_tento_problem?"><span class="tocnumber">6.3.1</span> <span class="toctext">Jak diagnostikovat tento problem?</span></a></li>
<li class="toclevel-3 tocsection-30"><a href="#Jak_jej_odstranit?"><span class="tocnumber">6.3.2</span> <span class="toctext">Jak jej odstranit?</span></a></li>
<li class="toclevel-3 tocsection-31"><a href="#N%C4%9Bco_v%C3%ADce?"><span class="tocnumber">6.3.3</span> <span class="toctext">Něco více?</span></a></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>

<h2>
<span id="Nastaven.C3.AD_hostname"></span><span class="mw-headline" id="Nastavení_hostname">Nastavení hostname</span>
</h2>
<p>Hostname (název hostitele/počítače) je jedinečné jméno vytvořené pro účel identifikace stroje na síti. V Arch Linuxu se hostname stroje dá nastavit buď v souboru <code>/etc/rc.conf</code> nebo dočasně až do restartu pomocí příkazu <i>hostname</i>. Hostname je omezen na alfanumerické znaky; je povoleno použít pomlčku (–), ale nesmí jí začínat ani končit. Délka je omezena na 63 znaků.
</p>
<p>Otevřete <code>/etc/rc.conf</code> a nastavte <code>HOSTNAME</code> na vámi požadované jméno počítače (v tomto případě "archlinux"):
</p>
<pre>HOSTNAME="archlinux"
</pre>
<p>Po jeho nastavení je také dobrý nápad vložit stejný název do souboru <code>/etc/hosts</code>. Tím pomůžete najít IP počítače procesům, které na váš počítač odkazují právě pomocí jeho hostname.
</p>
<p>Otevřete <code>/etc/hosts</code> a přidejte na konec řádku pro localhost stejný hostname, jaký jste zadali do souboru <code>/etc/rc.conf</code>:
</p>
<pre>127.0.0.1      localhost.localdomain      localhost    archlinux
</pre>
<p>Obdobně můžete přidávat i další záznamy.
</p>
<p>Pro dočasné nastavení hostname (do příštího startu systému) použijte jako root příkaz <i>hostname</i>:
</p>
<pre># hostname archlinux
</pre>
<h2>
<span id="Nahr.C3.A1n.C3.AD_ovlada.C4.8De_.28modulu.29_za.C5.99.C3.ADzeni"></span><span class="mw-headline" id="Nahrání_ovladače_(modulu)_zařízeni">Nahrání ovladače (modulu) zařízeni</span>
</h2>
<p>Pokud používáte udev, měl by být schopen rozpoznat vaši síťovou kartu a automaticky po startu zavést odpovídající moduly. V opačném případě potřebujete vědět název modulu potřebného pro chod vaší karty. Hledejte na webu výrobce vaší karty, ve vyhledávačích nebo zkuste některou z Live distribucí a podívejte se jaký modul používa – spusťte příkaz lsmod, který zobrazí všechny aktuálně načtené moduly.
</p>
<p>Nyní předpokládejme, že znáte název potřebného modulu. Můžete ho do jádra zavést následujícím příkazem:
</p>
<pre># modprobe jmenomodulu
</pre>
<p>Jestliže nechcete nebo nemůžete použít auto-loader jako například hwdetect, můžete přidat názvy potřebných modulů do /etc/rc.conf, potom už nebude potřeba zavádět moduly příkazem modprobe po každém startu počítače. Např. pokud se modul jemenuje tg3:
</p>
<pre>MODULES=(!usbserial tg3 snd-cmipci)
</pre>
<p>Další běžné moduly jsou 8139too pro karty s čipy od RealTek nebo sis900 pro SiS karty.
</p>
<h2>
<span id="Nastaven.C3.AD_IP_adresy"></span><span class="mw-headline" id="Nastavení_IP_adresy">Nastavení IP adresy</span>
</h2>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Note:</strong> U základních desek s integrovanými síťovými kartami je důležité vědět, která karta se považuje za primární (např. eth0) a která za sekundární (např. eth1). Mnoho problémů s konfigurací je způsobeno tím, že uživatelé nesprávně konfigurují v /etc/rc.conf rozhraní eth0 a přitom mají do lokální LAN sítě připojené rozhraní eth1.</div>
<h3><span class="mw-headline" id="DHCP">DHCP</span></h3>
<p>DCHP je služba, která dokáže dynamicky na požádání přidělovat klientům IP adresu (a nejen ji). Pokud dhcp používáte, upravte <a href="/title/Rc.conf" class="mw-redirect" title="Rc.conf">rc.conf</a> následovně:
</p>
<pre> eth0="dhcp"
 INTERFACES=(eth0)
 ROUTES=(!gateway)
</pre>
<p>Pokud z nějakého důvodu dhcpcd eth0 selhává, nainstalujte dhclienta (<code>pacman -S dhclient</code>) a použijte příkaz dhclient eth0 (samozřejmě pokud vaše síťová karta je označena jako eth0).
</p>
<h3>
<span id="Statick.C3.A1_IP"></span><span class="mw-headline" id="Statická_IP">Statická IP</span>
</h3>
<p>Jestliže sdílíte internetové připojeni z windowsovského boxu bez routeru, použijte na statickou IP adresu jinak můžete mít problémy se sítí.
</p>
<p>Pro konfiguraci statické IP potřebujete znát:
</p>
<ul>
<li>svoji statickou IP</li>
<li>masku sítě</li>
<li>adresu broadcastu (poslední možná IP v rozsahu vaší sítě)</li>
<li>bránu (gateway)</li>
<li>IP adresy jmenných serverů</li>
<li>jméno vaší domény</li>
</ul>
<p>Pokud pracujete v soukromé síti, je bezpečné používat IP adresy v rozsahu 192.168.*.* , s maskou 255.255.0.0 a adresou všesměrového vysílání (broadcast) 192.168.255.255. Dokud vaše síť nemá router, na adrese brány nezáleží. Upravte <a href="/title/Rc.conf" class="mw-redirect" title="Rc.conf">rc.conf</a> následovně, avšak nahraďte IP, masku sítě, broadcast a bránu svými vlastními hodnotami:
</p>
<pre> eth0="eth0 192.168.10.1 netmask 255.255.0.0 broadcast 192.168.255.255"
 INTERFACES=(eth0)
 gateway="default gw 192.168.10.20"
 ROUTES=(gateway)
</pre>
<p>V souboru <code>/etc/resolv.conf</code> potom nahraďte IP nameserveru a jméno domény vašimi vlastními. Jméno domény pro vzhledávání není vždy podmínkou:
</p>
<pre> nameserver 61.23.173.5
 nameserver 61.95.849.8
 search example.com
</pre>
<p>Můžete zadat tolik nameserverů, kolik chcete.
</p>
<p>Pokud používáte DHCP a nechcete, aby se váš DNS server měnil při každém spuštění sítě, přidejte volbu <code>-R</code> do <code>DHCPCD_ARGS</code> v souboru <code>/etc/conf.d/dhcpcd</code> (používaném v /etc/rc.d/network). Tímto se zabrání, aby za každým spuštěním DHCP přepisoval váš <code>/etc/resolv.conf</code>:
</p>
<pre>DHCPCD_ARGS="-R -t 30 -h $HOSTNAME"
</pre>
<h2><span class="mw-headline" id="Aktualizace_konfigurace">Aktualizace konfigurace</span></h2>
<p>K otestování konfigurace nemusíte restartovat počítač, stačí jako root spustit <code>/etc/rc.d/network restart</code>. Nyní zkuste příkazem ping otestovat spojení na vaši bránu, DNS servery, ISP a jiné internetové servery.
</p>
<h2>
<span id="N.C4.9Bkter.C3.A1_dal.C5.A1.C3.AD_nastaven.C3.AD"></span><span class="mw-headline" id="Některá_další_nastavení">Některá další nastavení</span>
</h2>
<h3>
<span id="Bezdr.C3.A1tov.C3.A9_s.C3.ADt.C4.9B"></span><span class="mw-headline" id="Bezdrátové_sítě">Bezdrátové sítě</span>
</h3>
<p>Konfigurace bezdrátových sítí je probírána v <a href="/title/Wireless_network_configuration" class="mw-redirect" title="Wireless network configuration">Wireless network configuration</a>.
</p>
<h3><span class="mw-headline" id="Firewall">Firewall</span></h3>
<p>Abyste se cítili bezpečněji, nainstalujte a nakonfigurujte si <a href="/title/Firewall" class="mw-redirect" title="Firewall">firewall</a>.
</p>
<h3><span class="mw-headline" id="Ifplugd">Ifplugd</span></h3>
<p>Ifplugd je služba, která automaticky konfiguruje vaše síťová rozhraní, když zapojíte kabel a poté i konfiguraci vynuluje, pokud kabel zase odpojíte. To je velmi použitelné na laptopech s integrovanou síťovou kartou, protože se bude síť konfigurovat až opravdu v okamžiku, kdy je připojen kabel.
</p>
<p>Instalace je velmi jednoduchá. Baliček se nachází v [extra]:
</p>
<pre># pacman -S ifplugd
</pre>
<p>Ve výchozím stavu je služba nastavena pro spolupráci s eth0. Toto a jiné nastavení se konfiguruje v <code>/etc/ifplugd/ifplugd.conf</code>.
</p>
<p>ifplugd spusťte příkazem:
</p>
<pre># /etc/rc.d/ifplugd start
</pre>
<p>nebo jej přidejte do výčtu DAEMONS v <code>/etc/rc.conf</code>.
</p>
<h3><span class="mw-headline" id="OpenVPN">OpenVPN</span></h3>
<h4>
<span id="P.C5.99.C3.ADprava"></span><span class="mw-headline" id="Příprava">Příprava</span>
</h4>
<p>Instalace 
</p>
<pre># pacman -S openvpn openssl
</pre>
<h4>
<span id="Generov.C3.A1n.C3.AD_certifik.C3.A1t.C5.AF"></span><span class="mw-headline" id="Generování_certifikátů">Generování certifikátů</span>
</h4>
<p>Zkopírujeme skripty pro jednoduché vytváření certifikátů:
</p>
<pre>cp -r /usr/share/openvpn/easy-rsa /etc/openvpn/easy-rsa/
</pre>
<p>Generování za pomoci Easy-RSA
</p>
<pre>cd /etc/openvpn/easy-rsa/
</pre>
<p>Doporučuji v souboru vars a vyplnit následující položky:
</p>
<pre>export KEY_COUNTRY="CZ"
export KEY_PROVINCE="NA" (NA znamená Not Applicable)
export KEY_CITY="Mesto"
export KEY_ORG="firma"
export KEY_EMAIL="me@myhost.cz"
</pre>
<p>Vygenerujeme certifikáty potřebné pro server:
</p>
<pre>source ./vars
./build-ca
./build-key-server MYSERVER
./build-dh
</pre>
<p>Vygenerujeme certifikáty pro uživatele:
</p>
<pre>./build-key FRANTA
./build-key PEPA
</pre>
<p>Veškeré vygenerované soubory jsou uložené v:
</p>
<pre>/etc/openvpn/easy-rsa/keys
</pre>
<p>Výsledek by měl zhruba vypadat takto:
</p>
<pre>ls -l /etc/openvpn/easy-rsa/keys/
total 84
-rw-r--r-- 1 root root 4079 May 21 09:53 01.pem
-rw-r--r-- 1 root root 3943 May 21 09:54 02.pem
-rw-r--r-- 1 root root 3958 May 21 09:54 03.pem
-rw-r--r-- 1 root root 1354 May 21 09:51 ca.crt
-rw------- 1 root root  916 May 21 09:51 ca.key
-rw-r--r-- 1 root root  245 May 21 09:54 dh1024.pem
-rw-r--r-- 1 root root 3958 May 21 09:54 FRANTA.crt
-rw-r--r-- 1 root root  716 May 21 09:54 FRANTA.csr
-rw------- 1 root root  916 May 21 09:54 FRANTA.key
-rw-r--r-- 1 root root 4079 May 21 09:53 MYSERVER.crt
-rw-r--r-- 1 root root  716 May 21 09:52 MYSERVER.csr
-rw------- 1 root root  916 May 21 09:52 MYSERVER.key
-rw-r--r-- 1 root root  395 May 21 09:54 index.txt
-rw-r--r-- 1 root root   21 May 21 09:54 index.txt.attr
-rw-r--r-- 1 root root   21 May 21 09:54 index.txt.attr.old
-rw-r--r-- 1 root root  261 May 21 09:54 index.txt.old
-rw-r--r-- 1 root root 3943 May 21 09:54 PEPA.crt
-rw-r--r-- 1 root root  708 May 21 09:54 PEPA.csr
-rw------- 1 root root  912 May 21 09:54 PEPA.key
-rw-r--r-- 1 root root    3 May 21 09:54 serial
-rw-r--r-- 1 root root    3 May 21 09:54 serial.old

</pre>
<p>Špatně jste něco vyplnili a chcete to celé udělat znovu? Pozor, následující příkaz vymaže všechny certifikáty vytvořené předcházejícími příkazy.
</p>
<pre>source ./vars
./clean-all
</pre>
<p><b>Zdroje:</b>
</p>
<ol>
<li><a rel="nofollow" class="external free" href="https://www.openvpn.net/index.php/open-source/documentation/howto.html">https://www.openvpn.net/index.php/open-source/documentation/howto.html</a></li>
<li><a href="/title/OpenVPN" title="OpenVPN">OpenVPN</a></li>
<li><a rel="nofollow" class="external free" href="https://openvpn.net/index.php/open-source/documentation/miscellaneous/77-rsa-key-management.html">https://openvpn.net/index.php/open-source/documentation/miscellaneous/77-rsa-key-management.html</a></li>
</ol>
<h4><span class="mw-headline" id="Konfigurace_serveru">Konfigurace serveru</span></h4>
<p>Vytvořte novou konfiguraci:
</p>
<pre>nano /etc/openvpn/vpn.conf 
</pre>
<pre>port 1194
proto tcp
dev tun

ca /etc/openvpn/easy-rsa/keys/ca.crt
cert /etc/openvpn/easy-rsa/keys/MYSERVER.crt
key /etc/openvpn/easy-rsa/keys/MYSERVER.key
dh /etc/openvpn/easy-rsa/keys/dh1024.pem

server 10.8.0.0 255.255.255.0
ifconfig-pool-persist ipp.txt
keepalive 10 120
comp-lzo
user nobody
group nobody
persist-key
persist-tun
status openvpn-status.log
verb 3

log-append /var/log/openvpn
status /tmp/vpn.status 10
</pre>
<h4><span class="mw-headline" id="Spusteni_OpenVPN_serveru">Spusteni OpenVPN serveru</span></h4>
<p>/etc/rc.d/openvpn start
Ať už všechno jde, jak má, nebo ne, překontrolujte log.
</p>
<pre>cat /var/log/openvpn
</pre>
<pre>Fri May 21 09:58:59 2010 OpenVPN 2.1.1 x86_64-unknown-linux-gnu [SSL] [LZO2] [EPOLL] built on Apr  1 2010
Fri May 21 09:58:59 2010 NOTE: OpenVPN 2.1 requires '--script-security 2' or higher to call user-defined scripts or executables
Fri May 21 09:58:59 2010 Diffie-Hellman initialized with 1024 bit key
Fri May 21 09:58:59 2010 TLS-Auth MTU parms [ L:1544 D:140 EF:40 EB:0 ET:0 EL:0 ]
Fri May 21 09:58:59 2010 ROUTE default_gateway=10.0.0.1
Fri May 21 09:58:59 2010 TUN/TAP device tun0 opened
Fri May 21 09:58:59 2010 TUN/TAP TX queue length set to 100
Fri May 21 09:58:59 2010 /sbin/ifconfig tun0 10.8.0.1 pointopoint 10.8.0.2 mtu 1500
Fri May 21 09:58:59 2010 /sbin/route add -net 10.8.0.0 netmask 255.255.255.0 gw 10.8.0.2
Fri May 21 09:58:59 2010 Data Channel MTU parms [ L:1544 D:1450 EF:44 EB:135 ET:0 EL:0 AF:3/1 ]
Fri May 21 09:58:59 2010 GID set to nobody
Fri May 21 09:58:59 2010 UID set to nobody
Fri May 21 09:58:59 2010 Listening for incoming TCP connection on [undef]:1194
Fri May 21 09:58:59 2010 Socket Buffers: R=[87380-&gt;131072] S=[16384-&gt;131072]
Fri May 21 09:58:59 2010 TCPv4_SERVER link local (bound): [undef]:1194
Fri May 21 09:58:59 2010 TCPv4_SERVER link remote: [undef]
Fri May 21 09:58:59 2010 MULTI: multi_init called, r=256 v=256
Fri May 21 09:58:59 2010 IFCONFIG POOL: base=10.8.0.4 size=62
Fri May 21 09:58:59 2010 IFCONFIG POOL LIST
Fri May 21 09:58:59 2010 MULTI: TCP INIT maxclients=1024 maxevents=1028
Fri May 21 09:58:59 2010 Initialization Sequence Completed</pre>
<h4><span class="mw-headline" id="Konfigurace_Klienta">Konfigurace Klienta</span></h4>
<p>Bezpečnou cestou přeneseme certifikáty ze serveru na klienta, v tomto případě Windows 7.
</p>
<pre>/etc/openvpn/easy-rsa/keys/ca.crt
/etc/openvpn/easy-rsa/keys/FRANTA.crt
/etc/openvpn/easy-rsa/keys/FRANTA.key
</pre>
<p>Nahrajeme je do adresáře:
</p>
<pre>C:\Program Files (x86)\OpenVPN\config\
</pre>
<p>pro 32bitový systém:
</p>
<pre>C:\Program Files\OpenVPN\config\
</pre>
<p>Vytvoříme textový soubor s příponou .ovpn. Do něj vložíme vzorovou konfiguraci pro uživatele FRANTA a uložíme jej do stejného umístění jako certifikáty.
</p>
<pre>client
remote 10.0.0.102 1194
dev tun
proto tcp
resolv-retry infinite
nobind
persist-key
persist-tun
verb 2
ca ca.crt
cert FRANTA.crt
key FRANTA.key
comp-lzo
</pre>
<p>Doporučuji zadat u volby <b>verb</b> vyšší číslo kvůli podrobnějším logům. Až bude vše fungovat, přepište ji na 3.
</p>
<p>Takovýto soubor OpenVPN automaticky načte. Pokud chcete mít na ploše ikonu OpenVPN, která se po spuštění sama připojí na server, upravte zástupce následovně:
</p>
<pre>"C:\Program Files (x86)\OpenVPN\bin\openvpn-gui-1.0.3.exe" --connect franta.ovpn
</pre>
<h2>
<span id=".C5.98e.C5.A1en.C3.AD_probl.C3.A9m.C5.AF"></span><span class="mw-headline" id="Řešení_problémů">Řešení problémů</span>
</h2>
<h3>
<span id="Probl.C3.A9m_se_.C5.A1k.C3.A1lov.C3.A1n.C3.ADm_TCP_ok.C3.A9nka_.28Window.29"></span><span class="mw-headline" id="Problém_se_škálováním_TCP_okénka_(Window)">Problém se škálováním  TCP okénka (Window)</span>
</h3>
<p>TCP segmentu obsahují hodnoty "okének" ve hlavičkách indikujících kolik dat je schopný přijímací uzel akceptovat od vysílajícího. Okénka se definují v segmentech ACK, kdy přijímací uzel potvrzuje přijetí segmentů. Velikost okénka reprezentuje 16bitů a z tohoto důvodu je maximálně 64Kb. TCP segmenty jsou ukládány v cache (kde se zarovnávají).Cache je omezená a přijímací uzel by jí lehce mohl vyčerpat, pokud by neměl mechanizmus jak korigovat tok dat.
</p>
<p>V roce 1992 rostlo množství dostupné paměti v počítačích. Bylo nepsán <a rel="nofollow" class="external text" href="http://www.faqs.org/rfcs/rfc1323.html">RFC 1323</a> , aby zlepšil situaci škálování okénka. Hodnota okénka implementovaná do všech segmentů bude modifikována tzv. škálovacím faktorem (Scale Factor) definovaným jednou na počátku komunikace.
</p>
<p>8-bitový Škálovací faktor umožňuje okénku být 32-krát vyšší než původních 64Kb.
</p>
<p>Občas nastává problém v tom, že některé chybné routery a firewally na internetu přepisují škálovací faktor na 0, čímž způsobují nedorozumění mezi hosty.
</p>
<p>Linuxové jádro 2.6.17 představilo nové kalkulační schéma generující vyšší škálovací faktor. Uměle zviditelňuje následky chyb routerů a firewallů. 
</p>
<p>Výsledné spojení je při nejlepším velmi pomalé, nebo nelze navázat.
</p>
<h4>
<span id="Jak_diagnostikovat_probl.C3.A9m.3F"></span><span class="mw-headline" id="Jak_diagnostikovat_problém?">Jak diagnostikovat problém?</span>
</h4>
<p>Tento problém nastává zřídka kdy. V některých případech nebudete schopní použít TCP spojení (HTTP,FTP,...) vůbec a v jiných budete schopni pouze s některými hosty.
</p>
<p><b>Varování</b>: výstup z <code>dmesg</code> musí být v pořádku, logy čisté, <code>ifconfig</code> ukazuje normální stav — vše se jeví v pořádku.
</p>
<p>Pokud nemůžete prohlížet zádnou webovou stránku, ale můžete pingnout některé hosty, šance jsou velké. Ping používá ICMP protokol a není ovlivněn TCP protokolem.
</p>
<p>K detekci problému můžete vyzkoušet program WireShark. Je to výborný nástroj pro zkoumání síťové komunikace. Například můžete objevit úspěšné UDP a ICMP komunikace, ale neúspěšné TCP komunikace.
</p>
<h4>
<span id="Jak_to_opravit.3F_.28.C5.A1patn.C3.A1_cesta.29"></span><span class="mw-headline" id="Jak_to_opravit?_(špatná_cesta)">Jak to opravit? (špatná cesta)</span>
</h4>
<p>Můžete změnit hodnotu <i>tcp_rmem</i>, na které je založen škálovací faktor. Přestože by to mohlo pomoci většine hostů, není zaručeno, že to bude funkční i na ty velmi vzdálené.
</p>
<pre>echo "4096 87380 174760" &gt; /proc/sys/net/ipv4/tcp_rmem
</pre>
<h4>
<span id="Jak_to_opravit.3F_.28dobr.C3.A1_cesta.29"></span><span class="mw-headline" id="Jak_to_opravit?_(dobrá_cesta)">Jak to opravit? (dobrá cesta)</span>
</h4>
<p>Jednoduše vypněte škálování okének. Přestože je škálování příjemná vlastnost TCP, může být dosti nepohodlná. Zvláště pokud nemůžete upravit chybný router. Je několik cest jak vypnout škálování a vypadá to, že pracují na většině kernelů.
Přidejte dásledující řádek do <code>/etc/rc.local</code>:
</p>
<pre>echo 0 &gt; /proc/sys/net/ipv4/tcp_window_scaling
</pre>
<h4>
<span id="Jak_to_opravit.3F_.28nejlep.C5.A1.C3.AD_cesta.29"></span><span class="mw-headline" id="Jak_to_opravit?_(nejlepší_cesta)">Jak to opravit? (nejlepší cesta)</span>
</h4>
<p>Tento problém je způsoben chybným routerem/firewallem, tak jej vyměňte. Někteří uživatelé totiž nalezli problém na jejich vlastních DSL routerech.
</p>
<h4>
<span id="V.C3.ADce.3F"></span><span class="mw-headline" id="Více?">Více?</span>
</h4>
<p>Tato sekce je založena na LWN článku <a rel="nofollow" class="external text" href="https://lwn.net/Articles/92727/">TCP window scaling and broken routers</a> a Kernel Trap článku: <a rel="nofollow" class="external text" href="http://kerneltrap.org/node/6723">Window Scaling on the Internet</a>.
</p>
<p>A v poslední době se některým uživatelům Archu hodilo:
</p>
<ul>
<li><a rel="nofollow" class="external text" href="https://www.archlinux.org/pipermail/arch/2006-June/011250.html">Odd network issue</a></li>
<li>
<a rel="nofollow" class="external text" href="https://www.archlinux.org/pipermail/arch/2006-September/011943.html">Kernel 2.6.17 and TCP window scaling</a> — téma, které inicializovalo teto článek</li>
</ul>
<p>Několik dobrých vláken naleznete také na LKML.
</p>
<h3>
<span id="Probl.C3.A9m_s_Realteky_bez_spojen.C3.AD.2FWOL"></span><span class="mw-headline" id="Problém_s_Realteky_bez_spojení/WOL">Problém s Realteky bez spojení/WOL</span>
</h3>
<p>Uživatelé se síťovými kartami založenými na čipech Realtek 8168 8169 8101 8111 mohou zaznamenat problém, při kterém se karta po startu tváří jako vypnutá a nesvítí vůbec kontrolka Link. Toto se obvykle stává na systémech s duálním bootem, kde jsou nainstalovány Windows. Zdá se, že je příčinou používání oficiálních ovladačů Realteku (novějších než květen 2007). Tyto novější ovladače vypínají Wake-On-Lan tím, že během vypínání Windows vypnou síťovou kartu, přičemž zůstává vypnutá až do příštího spuštění Windows. To, zda se tento problém týká i vás, zjistíte podle kontrolky Link, která zůstává zhasnutá do té doby, než spustíte Windows, a po jejich vypnutí opět setrváva zhaslá. Za normálního stavu by měla tato kontrolka svítit po celou dobu, kdy je počítač zapnutý, a to i během POST. Tento problém postihuje též další operační systémy bez novějších ovladačů (např. Live CD). Zde následuje několik řešení tohoto problému.
</p>
<h4>
<span id="Metoda_1_-_Vr.C3.A1cen.C3.AD_.2F_zm.C4.9Bna_Win_ovlada.C4.8De"></span><span class="mw-headline" id="Metoda_1_-_Vrácení_/_změna_Win_ovladače">Metoda 1 - Vrácení / změna Win ovladače</span>
</h4>
<p>Odinstalujte váš ovladač síťové karty pro Windows a vraťte se k ovladači, který poskytl Microsoft (je-li k dispozici), nebo nainstalujte původní oficiální ovladač Realtek vydaný před květnem 2007 (snad by měl být na CD, které bylo přiloženo k vašemu hardware).
</p>
<h4>
<span id="Metoda_2_-_Povolen.C3.AD_WOL_ve_Win_ovlada.C4.8Di"></span><span class="mw-headline" id="Metoda_2_-_Povolení_WOL_ve_Win_ovladači">Metoda 2 - Povolení WOL ve Win ovladači</span>
</h4>
<p>Pravděpodobně nejlepší a nejrychlejší oprava je změnit nastavení v ovladači ve Windows. Touto cestou by měl být síťový systém fixován nejenom pro Arch ale i např. pro live CD nebo jiné OS. Ve Správci zařízení pod Windows najděte váš Realtek Network adapter a dvakrát na něj klikněte. V kartě Rozšířené povolte možnost "wake-on-lan po vypnutí".
</p>
<pre> In Windows XP (příklad)
 Pravým tlačítkem myši na ikonu Tento počítač
 --&gt; Hardware tab
   --&gt; Device Manager
     --&gt; Network Adapters
       --&gt; "double click" Realtek ...
         --&gt; Advanced tab
           --&gt; Wake-On-Lan After Shutdown
             --&gt; Enable.
</pre>
<h4>
<span id="Metoda_3_-_Nov.C4.9Bj.C5.A1.C3.AD_ovlada.C4.8De_Realtek_pro_Linux"></span><span class="mw-headline" id="Metoda_3_-_Novější_ovladače_Realtek_pro_Linux">Metoda 3 - Novější ovladače Realtek pro Linux</span>
</h4>
<p>Všechny novější linuxové ovladače pro tyto karty Realtek je možno stáhnout z webové stránky Realtek (netestováno ale snad by také měly vyřešit problém).
</p>
<h3>
<span id="DLink_G604T.2FDLink_G502T:_probl.C3.A9m_DNS"></span><span class="mw-headline" id="DLink_G604T/DLink_G502T:_problém_DNS">DLink G604T/DLink G502T: problém DNS</span>
</h3>
<p>Uživatelé routerů DLink G604T/DLink G502T, kteří používají DHCP a mají firmware v2.00+ (typicky uživatelé AUS firmware) mohou mít problémy, že některé programy nerozpoznají DNS. Jeden z těchto programů je naneštěstí pacman. V zásadě je problém v tom, že router v jistých situacích neposílá DNS přesně na DHCP, což způsobuje, že programy se pokoušejí se spojit se servery s IP adresou 1.0.0.0 a spojení se díky překročení časového limitu nepodaří.
</p>
<h4>
<span id="Jak_diagnostikovat_tento_problem.3F"></span><span class="mw-headline" id="Jak_diagnostikovat_tento_problem?">Jak diagnostikovat tento problem?</span>
</h4>
<p>Nejlepší metodou, jak zjistit tento problém je použití firefox/konqueror/links/seamonkey a povolení wget pro pacman. Jedná -li se o novou instalaci Arch Linuxu, pak byste měli chtít vzít v úvahu instalační linky z live CD.
</p>
<p>Nejprve povolte wget pro pacman (protože wget nás informuje když pacman stahuje balíčky).
Otevřete /etc/pacman.conf ve vašem oblíbeném editoru a odkomentujte následující řádek (odstraňte # ,jestli se tam nachází)
</p>
<pre>XferCommand = /usr/bin/wget --passive-ftp -c -O %o %u
</pre>
<p>Zatímco jste v pacman.conf, zkontrolujte implicitní zrcadlo, které pacman používá pro download balíčků.
</p>
<p>Otevřte stránku se zrcadlem v internetovém prohlížeči a podívejte se, zda zrcadlo opravdu funguje. Je-li tomu tak, potom zadejte příkaz pacman -Syy (pokud je zrcadlo mimo provoz, vezměte jiné a nastavte ho v pacmanu jako implicitní), a podívejte se, zdali se neobjeví něco podobného, co je popsáno níže (všimněte si IP 1.0.0.0)
</p>
<pre>ftp://mirror.pacific.net.au/linux/archlinux/extra/os/i686/extra.db.tar.gz                                                            
           =&gt; `/var/lib/pacman/community.db.tar.gz.part'                            
Resolving mirror.pacific.net.au... 1.0.0.0
</pre>
<p>Potom máte s největší pravděpodobností tento problém. IP 1.0.0.0 znamená, že pacman nemůže rozpoznat DNS, takže jej musíte přidat do souboru resolv.conf.
</p>
<h4>
<span id="Jak_jej_odstranit.3F"></span><span class="mw-headline" id="Jak_jej_odstranit?">Jak jej odstranit?</span>
</h4>
<p>V podstatě, jde o to, abyste přidali manuálně DNS do souboru <code>/etc/resolv.conf</code> . DHCP však stále ještě automaticky maže a mění tento soubor po startu systému, je tedy nutno ještě editovat <code>/etc/conf.d/dhcpcd</code> a změnit jej, aby se toto přes DHCP nedělo.
</p>
<p>Po otvření souboru <code>/etc/conf.d/dhcpcd</code>, byste měli vidět něco podobného následujícímu řádku:
</p>
<pre>DHCPCD_ARGS="-t 30 -h $HOSTNAME"
</pre>
<p>přidejte flag <code>-R</code> do argumentů, tedy:
</p>
<pre>DHCPCD_ARGS="-R -t 30 -h $HOSTNAME"
</pre>
<p><b>POZN.</b>: Používáte-li dhcpcd &gt;= 4.0.2, flag -R byl potlačen, prosím přečtěte si informace na těchto stránkách: (<a href="/title/Configuring_network#For_DHCP_IP" class="mw-redirect" title="Configuring network">Configuring network#For_DHCP_IP</a><sup>[<a href="/title/Help:Procedures#Fix_broken_section_links" title="Help:Procedures">broken link</a>: invalid section]</sup>) sekce How to use a custom resolv.conf file
</p>
<p>Uložte soubor a zavřete jej, potom znovu otevřete /etc/resolv.conf. Měli byste vidět jednu IP (nejpravděpodobněji 10.1.1.1), což je brána vašeho  routeru, kterou potřebujete připojit, abyste dostali DNS vašeho ISP. Vložte IP do vašeho internetového prohlížeče a přihlaste se do routeru. V sekci DNS byste měli vidět IP preferovaného DNS serveru, zkopírujte ji a vložte do souboru NAD IP adresu brány.
</p>
<p>T.zn., že resolv.conf by měl vypadat před změnou takto:
</p>
<pre>namespace 10.1.1.1
</pre>
<p>A pokud např. máte primární DNS Server 211.29.132.12 tak upravte resolv.conf následovně:
</p>
<pre>namespace 211.29.132.12
namespace 10.1.1.1
</pre>
<p>Teď restartujte síť následujícím příkazem: <code>/etc/rc.d/network restart</code> a proveďte <code>pacman -Syy</code>, jestliže se synchronizace se serverem zdařila.
</p>
<h4>
<span id="N.C4.9Bco_v.C3.ADce.3F"></span><span class="mw-headline" id="Něco_více?">Něco více?</span>
</h4>
<p>Fórum whirlpool (australská komunita ISP), ve kterém se o tomto problému hovoří a poskytuje totéž řešení:
</p>
<pre><a rel="nofollow" class="external free" href="https://forums.whirlpool.net.au/forum-replies-archive.cfm/461625.html">https://forums.whirlpool.net.au/forum-replies-archive.cfm/461625.html</a>
</pre>
</div>
</div>
<div id="catlinks" class="catlinks" data-mw="interface">
<div id="mw-normal-catlinks" class="mw-normal-catlinks">
<a href="/title/Special:Categories" title="Special:Categories">Categories</a>: <ul>
<li><a href="/title/Category:Networking_(%C4%8Ce%C5%A1tina)" title="Category:Networking (Čeština)">Networking (Čeština)</a></li>
<li><a href="/title/Category:Installation_process_(%C4%8Ce%C5%A1tina)" title="Category:Installation process (Čeština)">Installation process (Čeština)</a></li>
</ul>
</div>
<div id="mw-hidden-catlinks" class="mw-hidden-catlinks mw-hidden-cats-hidden">Hidden categories: <ul>
<li><a href="/title/Category:Pages_or_sections_flagged_with_Template:Out_of_date" title="Category:Pages or sections flagged with Template:Out of date">Pages or sections flagged with Template:Out of date</a></li>
<li><a href="/title/Category:Pages_or_sections_flagged_with_Template:Translateme" title="Category:Pages or sections flagged with Template:Translateme">Pages or sections flagged with Template:Translateme</a></li>
<li><a href="/title/Category:Pages_with_broken_section_links" title="Category:Pages with broken section links">Pages with broken section links</a></li>
</ul>
</div>
</div>
	</div>
</div>

<footer id="footer" class="mw-footer" role="contentinfo" style="margin: 0">
	<ul id="footer-info">
		<li>Retrieved from "<a dir="ltr" href="https://wiki.archlinux.org/index.php?title=Network_configuration_(%C4%8Ce%C5%A1tina)&amp;oldid=670146">https://wiki.archlinux.org/index.php?title=Network_configuration_(Čeština)&amp;oldid=670146</a>"</li>
		<li id="footer-info-lastmod"> This page was last edited on 9 May 2021, at 21:46.</li>
		<li id="footer-info-copyright">Content is available under <a class="external" rel="nofollow" href="http://www.gnu.org/copyleft/fdl.html">GNU Free Documentation License 1.3 or later</a> unless otherwise noted.</li>
	<br>
</ul>
	<ul id="footer-places">
		<li id="footer-places-privacy"><a href="/title/ArchWiki:Privacy_policy" title="ArchWiki:Privacy policy">Privacy policy</a></li>
		<li id="footer-places-about"><a href="/title/ArchWiki:About" title="ArchWiki:About">About ArchWiki</a></li>
		<li id="footer-places-disclaimer"><a href="/title/ArchWiki:General_disclaimer" title="ArchWiki:General disclaimer">Disclaimers</a></li>
	</ul>
	<ul id="footer-icons" class="noprint">
		<li id="footer-copyrightico">
	</ul>
	<div style="clear: both;"></div>
</footer>



</body>
</html>
