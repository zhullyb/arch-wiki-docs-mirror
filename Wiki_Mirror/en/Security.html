<!DOCTYPE html>
<html class="client-nojs" lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<title>Security - ArchWiki</title>
<link rel="stylesheet" href="../ArchWikiOffline.css">
<meta name="ResourceLoaderDynamicStyles" content="">
<meta name="generator" content="MediaWiki 1.35.0">
<meta name="robots" content="noindex,follow">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="shortcut icon" href="/favicon.ico">
<link rel="search" type="application/opensearchdescription+xml" href="/opensearch_desc.php" title="ArchWiki (en)">
<link rel="EditURI" type="application/rsd+xml" href="https://wiki.archlinux.org/api.php?action=rsd">
<link rel="license" href="http://www.gnu.org/copyleft/fdl.html">
<link rel="alternate" type="application/atom+xml" title="ArchWiki Atom feed" href="/index.php?title=Special:RecentChanges&amp;feed=atom">
</head>
<body class="mediawiki ltr sitedir-ltr mw-hide-empty-elt ns-0 ns-subject page-Security rootpage-Security skin-vector action-view skin-vector-legacy">
<div id="content" class="mw-body" role="main" style="margin: 0">
	<a id="top"></a>
	<div id="siteNotice" class="mw-body-content"></div>
	<div class="mw-indicators mw-body-content">
	</div>
	<h1 id="firstHeading" class="firstHeading" lang="en">Security</h1>
	<div id="bodyContent" class="mw-body-content">
		<div id="siteSub" class="noprint">From ArchWiki</div>
		<div id="contentSub"></div>
		<div id="contentSub2"></div>
		
		<div id="jump-to-nav"></div>
		<a class="mw-jump-link" href="#mw-head">Jump to navigation</a>
		<a class="mw-jump-link" href="#searchInput">Jump to search</a>
		<div id="mw-content-text" lang="en" dir="ltr" class="mw-content-ltr">
<div class="warningbox">The printable version is no longer supported and may have rendering errors. Please update your browser bookmarks and please use the default browser print function instead.</div>
<div class="mw-parser-output">
<div class="archwiki-template-meta-related-articles-start">
<p>Related articles</p>
<ul>
<li><a href="../en/Arch_Security_Team.html" title="Arch Security Team">Arch Security Team</a></li>
<li><a href="../en/General_recommendations.html" title="General recommendations">General recommendations</a></li>
<li><a href="../en/PAM.html" title="PAM">PAM</a></li>
<li><a href="../en/Capabilities.html" title="Capabilities">Capabilities</a></li>
<li><a href="../en/List_of_applications/Security.html" class="mw-redirect" title="List of Applications/Security">List of Applications/Security</a></li>
<li><a href="../en/Arch_package_guidelines/Security.html" title="Arch package guidelines/Security">Arch package guidelines/Security</a></li>
</ul>
</div>
<p>This article contains recommendations and best practices for <a href="https://en.wikipedia.org/wiki/Hardening_(computing)" class="extiw" title="wikipedia:Hardening (computing)">hardening</a> an Arch Linux system.
</p>
<div id="toc" class="toc" role="navigation" aria-labelledby="mw-toc-heading">
<input type="checkbox" role="button" id="toctogglecheckbox" class="toctogglecheckbox" style="display:none"><div class="toctitle" lang="en" dir="ltr">
<h2 id="mw-toc-heading">Contents</h2>
<span class="toctogglespan"><label class="toctogglelabel" for="toctogglecheckbox"></label></span>
</div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Concepts"><span class="tocnumber">1</span> <span class="toctext">Concepts</span></a></li>
<li class="toclevel-1 tocsection-2">
<a href="#Passwords"><span class="tocnumber">2</span> <span class="toctext">Passwords</span></a>
<ul>
<li class="toclevel-2 tocsection-3"><a href="#Choosing_secure_passwords"><span class="tocnumber">2.1</span> <span class="toctext">Choosing secure passwords</span></a></li>
<li class="toclevel-2 tocsection-4"><a href="#Maintaining_passwords"><span class="tocnumber">2.2</span> <span class="toctext">Maintaining passwords</span></a></li>
<li class="toclevel-2 tocsection-5"><a href="#Password_hashes"><span class="tocnumber">2.3</span> <span class="toctext">Password hashes</span></a></li>
<li class="toclevel-2 tocsection-6"><a href="#Enforcing_strong_passwords_with_pam_pwquality"><span class="tocnumber">2.4</span> <span class="toctext">Enforcing strong passwords with pam_pwquality</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-7">
<a href="#CPU"><span class="tocnumber">3</span> <span class="toctext">CPU</span></a>
<ul>
<li class="toclevel-2 tocsection-8"><a href="#Microcode"><span class="tocnumber">3.1</span> <span class="toctext">Microcode</span></a></li>
<li class="toclevel-2 tocsection-9">
<a href="#Hardware_vulnerabilities"><span class="tocnumber">3.2</span> <span class="toctext">Hardware vulnerabilities</span></a>
<ul>
<li class="toclevel-3 tocsection-10"><a href="#Simultaneous_multithreading_(hyper-threading)"><span class="tocnumber">3.2.1</span> <span class="toctext">Simultaneous multithreading (hyper-threading)</span></a></li>
</ul>
</li>
</ul>
</li>
<li class="toclevel-1 tocsection-11">
<a href="#Memory"><span class="tocnumber">4</span> <span class="toctext">Memory</span></a>
<ul>
<li class="toclevel-2 tocsection-12"><a href="#Hardened_malloc"><span class="tocnumber">4.1</span> <span class="toctext">Hardened malloc</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-13">
<a href="#Storage"><span class="tocnumber">5</span> <span class="toctext">Storage</span></a>
<ul>
<li class="toclevel-2 tocsection-14"><a href="#Data-at-rest_encryption"><span class="tocnumber">5.1</span> <span class="toctext">Data-at-rest encryption</span></a></li>
<li class="toclevel-2 tocsection-15">
<a href="#File_systems"><span class="tocnumber">5.2</span> <span class="toctext">File systems</span></a>
<ul>
<li class="toclevel-3 tocsection-16"><a href="#Mount_options"><span class="tocnumber">5.2.1</span> <span class="toctext">Mount options</span></a></li>
</ul>
</li>
<li class="toclevel-2 tocsection-17"><a href="#File_access_permissions"><span class="tocnumber">5.3</span> <span class="toctext">File access permissions</span></a></li>
<li class="toclevel-2 tocsection-18"><a href="#Backups"><span class="tocnumber">5.4</span> <span class="toctext">Backups</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-19">
<a href="#User_setup"><span class="tocnumber">6</span> <span class="toctext">User setup</span></a>
<ul>
<li class="toclevel-2 tocsection-20"><a href="#Do_not_use_the_root_account_for_daily_use"><span class="tocnumber">6.1</span> <span class="toctext">Do not use the root account for daily use</span></a></li>
<li class="toclevel-2 tocsection-21"><a href="#Enforce_a_delay_after_a_failed_login_attempt"><span class="tocnumber">6.2</span> <span class="toctext">Enforce a delay after a failed login attempt</span></a></li>
<li class="toclevel-2 tocsection-22"><a href="#Lock_out_user_after_three_failed_login_attempts"><span class="tocnumber">6.3</span> <span class="toctext">Lock out user after three failed login attempts</span></a></li>
<li class="toclevel-2 tocsection-23"><a href="#Limit_amount_of_processes"><span class="tocnumber">6.4</span> <span class="toctext">Limit amount of processes</span></a></li>
<li class="toclevel-2 tocsection-24"><a href="#Run_Xorg_rootless"><span class="tocnumber">6.5</span> <span class="toctext">Run Xorg rootless</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-25">
<a href="#Restricting_root"><span class="tocnumber">7</span> <span class="toctext">Restricting root</span></a>
<ul>
<li class="toclevel-2 tocsection-26">
<a href="#Use_sudo_instead_of_su"><span class="tocnumber">7.1</span> <span class="toctext">Use sudo instead of su</span></a>
<ul>
<li class="toclevel-3 tocsection-27"><a href="#Editing_files_using_sudo"><span class="tocnumber">7.1.1</span> <span class="toctext">Editing files using sudo</span></a></li>
</ul>
</li>
<li class="toclevel-2 tocsection-28">
<a href="#Restricting_root_login"><span class="tocnumber">7.2</span> <span class="toctext">Restricting root login</span></a>
<ul>
<li class="toclevel-3 tocsection-29"><a href="#Allow_only_certain_users"><span class="tocnumber">7.2.1</span> <span class="toctext">Allow only certain users</span></a></li>
<li class="toclevel-3 tocsection-30"><a href="#Denying_SSH_login"><span class="tocnumber">7.2.2</span> <span class="toctext">Denying SSH login</span></a></li>
<li class="toclevel-3 tocsection-31"><a href="#Specify_acceptable_login_combinations_with_access.conf"><span class="tocnumber">7.2.3</span> <span class="toctext">Specify acceptable login combinations with access.conf</span></a></li>
</ul>
</li>
</ul>
</li>
<li class="toclevel-1 tocsection-32">
<a href="#Mandatory_access_control"><span class="tocnumber">8</span> <span class="toctext">Mandatory access control</span></a>
<ul>
<li class="toclevel-2 tocsection-33"><a href="#Pathname_MAC"><span class="tocnumber">8.1</span> <span class="toctext">Pathname MAC</span></a></li>
<li class="toclevel-2 tocsection-34"><a href="#Labels_MAC"><span class="tocnumber">8.2</span> <span class="toctext">Labels MAC</span></a></li>
<li class="toclevel-2 tocsection-35"><a href="#Access_Control_Lists"><span class="tocnumber">8.3</span> <span class="toctext">Access Control Lists</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-36">
<a href="#Kernel_hardening"><span class="tocnumber">9</span> <span class="toctext">Kernel hardening</span></a>
<ul>
<li class="toclevel-2 tocsection-37">
<a href="#Kernel_self-protection_/_exploit_mitigation"><span class="tocnumber">9.1</span> <span class="toctext">Kernel self-protection / exploit mitigation</span></a>
<ul>
<li class="toclevel-3 tocsection-38">
<a href="#Userspace_ASLR_comparison"><span class="tocnumber">9.1.1</span> <span class="toctext">Userspace ASLR comparison</span></a>
<ul>
<li class="toclevel-4 tocsection-39"><a href="#64-bit_processes"><span class="tocnumber">9.1.1.1</span> <span class="toctext">64-bit processes</span></a></li>
<li class="toclevel-4 tocsection-40"><a href="#32-bit_processes_(on_an_x86_64_kernel)"><span class="tocnumber">9.1.1.2</span> <span class="toctext">32-bit processes (on an x86_64 kernel)</span></a></li>
</ul>
</li>
</ul>
</li>
<li class="toclevel-2 tocsection-41"><a href="#Restricting_access_to_kernel_logs"><span class="tocnumber">9.2</span> <span class="toctext">Restricting access to kernel logs</span></a></li>
<li class="toclevel-2 tocsection-42"><a href="#Restricting_access_to_kernel_pointers_in_the_proc_filesystem"><span class="tocnumber">9.3</span> <span class="toctext">Restricting access to kernel pointers in the proc filesystem</span></a></li>
<li class="toclevel-2 tocsection-43"><a href="#BPF_hardening"><span class="tocnumber">9.4</span> <span class="toctext">BPF hardening</span></a></li>
<li class="toclevel-2 tocsection-44"><a href="#ptrace_scope"><span class="tocnumber">9.5</span> <span class="toctext">ptrace scope</span></a></li>
<li class="toclevel-2 tocsection-45"><a href="#hidepid"><span class="tocnumber">9.6</span> <span class="toctext">hidepid</span></a></li>
<li class="toclevel-2 tocsection-46"><a href="#Restricting_module_loading"><span class="tocnumber">9.7</span> <span class="toctext">Restricting module loading</span></a></li>
<li class="toclevel-2 tocsection-47"><a href="#Disable_kexec"><span class="tocnumber">9.8</span> <span class="toctext">Disable kexec</span></a></li>
<li class="toclevel-2 tocsection-48"><a href="#Kernel_lockdown_mode"><span class="tocnumber">9.9</span> <span class="toctext">Kernel lockdown mode</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-49">
<a href="#Sandboxing_applications"><span class="tocnumber">10</span> <span class="toctext">Sandboxing applications</span></a>
<ul>
<li class="toclevel-2 tocsection-50"><a href="#Firejail"><span class="tocnumber">10.1</span> <span class="toctext">Firejail</span></a></li>
<li class="toclevel-2 tocsection-51"><a href="#bubblewrap"><span class="tocnumber">10.2</span> <span class="toctext">bubblewrap</span></a></li>
<li class="toclevel-2 tocsection-52"><a href="#chroots"><span class="tocnumber">10.3</span> <span class="toctext">chroots</span></a></li>
<li class="toclevel-2 tocsection-53"><a href="#Linux_containers"><span class="tocnumber">10.4</span> <span class="toctext">Linux containers</span></a></li>
<li class="toclevel-2 tocsection-54"><a href="#Other_virtualization_options"><span class="tocnumber">10.5</span> <span class="toctext">Other virtualization options</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-55">
<a href="#Network_and_firewalls"><span class="tocnumber">11</span> <span class="toctext">Network and firewalls</span></a>
<ul>
<li class="toclevel-2 tocsection-56">
<a href="#Firewalls"><span class="tocnumber">11.1</span> <span class="toctext">Firewalls</span></a>
<ul>
<li class="toclevel-3 tocsection-57"><a href="#Open_ports"><span class="tocnumber">11.1.1</span> <span class="toctext">Open ports</span></a></li>
</ul>
</li>
<li class="toclevel-2 tocsection-58"><a href="#Kernel_parameters"><span class="tocnumber">11.2</span> <span class="toctext">Kernel parameters</span></a></li>
<li class="toclevel-2 tocsection-59"><a href="#SSH"><span class="tocnumber">11.3</span> <span class="toctext">SSH</span></a></li>
<li class="toclevel-2 tocsection-60"><a href="#DNS"><span class="tocnumber">11.4</span> <span class="toctext">DNS</span></a></li>
<li class="toclevel-2 tocsection-61"><a href="#Proxies"><span class="tocnumber">11.5</span> <span class="toctext">Proxies</span></a></li>
<li class="toclevel-2 tocsection-62"><a href="#Managing_SSL_certificates"><span class="tocnumber">11.6</span> <span class="toctext">Managing SSL certificates</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-63">
<a href="#Physical_security"><span class="tocnumber">12</span> <span class="toctext">Physical security</span></a>
<ul>
<li class="toclevel-2 tocsection-64"><a href="#Locking_down_BIOS"><span class="tocnumber">12.1</span> <span class="toctext">Locking down BIOS</span></a></li>
<li class="toclevel-2 tocsection-65">
<a href="#Boot_loaders"><span class="tocnumber">12.2</span> <span class="toctext">Boot loaders</span></a>
<ul>
<li class="toclevel-3 tocsection-66"><a href="#Syslinux"><span class="tocnumber">12.2.1</span> <span class="toctext">Syslinux</span></a></li>
<li class="toclevel-3 tocsection-67"><a href="#GRUB"><span class="tocnumber">12.2.2</span> <span class="toctext">GRUB</span></a></li>
</ul>
</li>
<li class="toclevel-2 tocsection-68"><a href="#Secure_Boot"><span class="tocnumber">12.3</span> <span class="toctext">Secure Boot</span></a></li>
<li class="toclevel-2 tocsection-69"><a href="#Trusted_Platform_Module_(TPM)"><span class="tocnumber">12.4</span> <span class="toctext">Trusted Platform Module (TPM)</span></a></li>
<li class="toclevel-2 tocsection-70"><a href="#Boot_partition_on_removable_flash_drive"><span class="tocnumber">12.5</span> <span class="toctext">Boot partition on removable flash drive</span></a></li>
<li class="toclevel-2 tocsection-71"><a href="#Automatic_logout"><span class="tocnumber">12.6</span> <span class="toctext">Automatic logout</span></a></li>
<li class="toclevel-2 tocsection-72"><a href="#Protect_against_rogue_USB_devices"><span class="tocnumber">12.7</span> <span class="toctext">Protect against rogue USB devices</span></a></li>
<li class="toclevel-2 tocsection-73"><a href="#Volatile_data_collection"><span class="tocnumber">12.8</span> <span class="toctext">Volatile data collection</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-74">
<a href="#Packages"><span class="tocnumber">13</span> <span class="toctext">Packages</span></a>
<ul>
<li class="toclevel-2 tocsection-75"><a href="#Authentication"><span class="tocnumber">13.1</span> <span class="toctext">Authentication</span></a></li>
<li class="toclevel-2 tocsection-76"><a href="#Upgrades"><span class="tocnumber">13.2</span> <span class="toctext">Upgrades</span></a></li>
<li class="toclevel-2 tocsection-77"><a href="#Follow_vulnerability_alerts"><span class="tocnumber">13.3</span> <span class="toctext">Follow vulnerability alerts</span></a></li>
<li class="toclevel-2 tocsection-78"><a href="#Rebuilding_packages"><span class="tocnumber">13.4</span> <span class="toctext">Rebuilding packages</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-79"><a href="#See_also"><span class="tocnumber">14</span> <span class="toctext">See also</span></a></li>
</ul>
</div>

<h2><span class="mw-headline" id="Concepts">Concepts</span></h2>
<ul>
<li>It <i>is</i> possible to tighten security to the point where the system is unusable. Security and convenience must be balanced. The trick is to create a secure <i>and</i> useful system.</li>
<li>The biggest threat is, and will always be, the user.</li>
<li>The <a href="https://en.wikipedia.org/wiki/Principle_of_least_privilege" class="extiw" title="wikipedia:Principle of least privilege">principle of least privilege</a>: Each part of a system should only be able to access what is strictly required, and nothing more.</li>
<li>Defense in depth: Security works better in independent layers. When one layer is breached, another should stop the attack.</li>
<li>Be a little paranoid. And be suspicious. If anything sounds too good to be true, it probably is!</li>
<li>You can never make a system 100% secure unless you unplug the machine from all networks, turn it off, lock it in a safe, smother it in concrete and never use it.</li>
<li>Prepare for failure. Create a plan ahead of time to follow when your security is broken.</li>
</ul>
<h2><span class="mw-headline" id="Passwords">Passwords</span></h2>
<p>Passwords are key to a secure Linux system. They secure your <a href="../en/Users_and_groups.html" title="Users and groups">user accounts</a>, <a href="../en/Data-at-rest_encryption.html" title="Data-at-rest encryption">encrypted filesystems</a>, and <a href="../en/SSH_keys.html" title="SSH keys">SSH</a>/<a href="../en/GnuPG.html" class="mw-redirect" title="GPG">GPG</a> keys. They are the main way a computer chooses to trust the person using it, so a big part of security is just about picking secure passwords and protecting them.
</p>
<h3><span class="mw-headline" id="Choosing_secure_passwords">Choosing secure passwords</span></h3>
<p>Passwords must be complex enough to not be easily guessed from e.g. personal information, or <a href="https://en.wikipedia.org/wiki/Password_cracking" class="extiw" title="wikipedia:Password cracking">cracked</a> using methods like social engineering or brute-force attacks. The tenets of strong passwords are based on <i>length</i> and <i>randomness</i>. In cryptography the quality of a password is referred to as its <a href="https://en.wikipedia.org/wiki/Entropic_security" class="extiw" title="wikipedia:Entropic security">entropic security</a>. 
</p>
<p>Insecure passwords include those containing:
</p>
<ul>
<li>Personally identifiable information (e.g., your dog's name, date of birth, area code, favorite video game)</li>
<li>Simple character substitutions on words (e.g., <code>k1araj0hns0n</code>), as modern dictionary attacks can easily work with these</li>
<li>Root "words" or common strings followed or preceded by added numbers, symbols, or characters (e.g., <code>DG091101%</code>)</li>
<li>Common phrases or strings of dictionary words (e.g. <code>photocopyhauntbranchexpose</code>) including with character substitution (e.g. <code>Ph0toc0pyh4uN7br@nch3xp*se</code>)</li>
<li>Any of the <a href="https://en.wikipedia.org/wiki/List_of_the_most_common_passwords" class="extiw" title="wikipedia:List of the most common passwords">most common passwords</a>
</li>
</ul>
<p>The best choice for a password is something long (the longer, the better) and generated from a random source. It is important to use a long password. <a rel="nofollow" class="external text" href="https://www.theregister.com/2019/02/14/password_length">Weak hash algorithms allow an 8-character password hash to be compromised in just a few hours.</a>
</p>
<p>Tools like <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=pwgen">pwgen</a></span> or <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://aur.archlinux.org/packages/apg/">apg</a></span><sup><small>AUR</small></sup> can generate random passwords. However, these passwords can be difficult to memorize. One memorization technique (for ones typed often) is to generate a long password and memorize a minimally secure number of characters, temporarily writing down the full generated string. Over time, increase the number of characters typed - until the password is ingrained in muscle memory and need not be remembered. This technique is more difficult, but can provide confidence that a password will not turn up in wordlists or "intelligent" brute force attacks that combine words and substitute characters.
</p>
<p>One technique for memorizing a password is to use a mnemonic phase, where each word in the phase reminds you of the next character in the password.
Take for instance “the girl is walking down the rainy street” could be translated to <code>t6!WdtR5</code> or, less simply, <code>t&amp;6!RrlW@dtR,57</code>.
This approach could make it easier to remember a password, but note that the various letters have very different probabilities of being found at the start of words (<a href="https://en.wikipedia.org/wiki/Letter_frequency#Relative_frequencies_of_the_first_letters_of_a_word_in_the_English_language" class="extiw" title="wikipedia:Letter frequency">Wikipedia:Letter frequency</a>). 
</p>
<p>Another effective technique can be to write randomly generated passwords down and store them in a <i>safe</i> place, such as in a wallet, purse or document safe. Most people do a generally good job of protecting their physical valuables from attack, and it is easier for most people to understand physical security best practices compared to digital security practices. <a rel="nofollow" class="external text" href="https://www.schneier.com/news/archives/2010/11/bruce_schneier_write.html">Bruce Schneier has endorsed this technique</a>.
</p>
<p>It is also very effective to combine the mnemonic and random technique by saving long randomly generated passwords with a <a href="../en/List_of_applications/Security.html#Password_managers" class="mw-redirect" title="Password manager">password manager</a>, which will be in turn accessed with a memorable "master password" that must be used only for that purpose. The master password must be memorized and never saved. This requires the password manager to be installed on a system to easily access the password (which could be seen as an inconvenience or a security feature, depending on the situation). Some password managers also have smartphone apps which can be used to display passwords for manual entry on systems without that password manager installed. Note that a password manager introduces a single point of failure if you ever forget the master password.
</p>
<p>Formerly, it was effective to use a memorable long series of unrelated words as a password. The theory is that if a sufficiently long phrase is used, the gained entropy from the password's length can counter the lost entropy from the use of dictionary words. This <a rel="nofollow" class="external text" href="https://xkcd.com/936/">XKCD comic</a> demonstrates the entropy tradeoff of this method. However, password crackers have caught on to this trick and will generate wordlists containing billions of permutations and variants of dictionary words, reducing the effective entropy of the password.
</p>
<p>See Bruce Schneier's article <a rel="nofollow" class="external text" href="https://www.schneier.com/blog/archives/2014/03/choosing_secure_1.html">Choosing Secure Passwords</a>, <a rel="nofollow" class="external text" href="https://www.iusmentis.com/security/passphrasefaq/">The passphrase FAQ</a> or <a href="https://en.wikipedia.org/wiki/Password_strength" class="extiw" title="wikipedia:Password strength">Wikipedia:Password strength</a> for some additional background.
</p>
<h3><span class="mw-headline" id="Maintaining_passwords">Maintaining passwords</span></h3>
<p>Once you pick a strong password, be sure to keep it safe. Watch out for <a href="https://en.wikipedia.org/wiki/Keylogger" class="extiw" title="wikipedia:Keylogger">keyloggers</a> (software and hardware), screen loggers, <a href="https://en.wikipedia.org/wiki/Social_engineering_(security)" class="extiw" title="wikipedia:Social engineering (security)">social engineering</a>, <a href="https://en.wikipedia.org/wiki/Shoulder_surfing_(computer_security)" class="extiw" title="wikipedia:Shoulder surfing (computer security)">shoulder surfing</a>, and avoid reusing passwords so insecure servers cannot leak more information than necessary. <a href="../en/List_of_applications/Security.html#Password_managers" title="List of applications/Security">Password managers</a> can help manage large numbers of complex passwords: if you are copy-pasting the stored passwords from the manager to the applications that need them, make sure to clear the copy buffer every time, and ensure they are not saved in any kind of log (e.g. do not paste them in plain terminal commands, which would store them in files like <code>.bash_history</code>).
</p>
<p>As a rule, do not pick insecure passwords just because secure ones are harder to remember. Passwords are a balancing act. It is better to have an encrypted database of secure passwords, guarded behind a key and one strong master password, than it is to have many similar weak passwords. Writing passwords down is perhaps equally effective <a rel="nofollow" class="external autonumber" href="https://www.schneier.com/blog/archives/2005/06/write_down_your.html">[1]</a>, avoiding potential vulnerabilities in software solutions while requiring physical security.
</p>
<p>Another aspect of the strength of the passphrase is that it must not be easily recoverable from other places.
</p>
<p>If you use the same passphrase for disk encryption as you use for your login password (useful e.g. to auto-mount the encrypted partition or folder on login), make sure that <code>/etc/shadow</code> either also ends up on an encrypted partition, or uses a strong hash algorithm (i.e. sha512/bcrypt, not md5) for the stored password hash (see <a href="../en/SHA_password_hashes.html" title="SHA password hashes">SHA password hashes</a> for more information).
</p>
<p>If you are backing up your password database, make sure that each copy is not stored behind any other passphrase which in turn is stored in it, e.g. an encrypted drive or an authenticated remote storage service, or you will not be able to access it in case of need; a useful trick is to protect the drives or accounts where the database is backed up using a simple cryptographic hash of the master password. Maintain a list of all the backup locations: if one day you fear that the master passphrase has been compromised you will have to change it immediately on all the database backups and the locations protected with keys derived from the master password.
</p>
<p>Version-controlling the database in a secure way can be very complicated: if you choose to do it, you must have a way to update the master password of all the database versions. It may not always be immediately clear when the master password is leaked: to reduce the risk of somebody else discovering your password before you realize that it leaked, you may choose to change it on a periodical basis. If you fear that you have lost control over a copy of the database, you will need to change all the passwords contained in it within the time that it may take to brute-force the master password, according to its entropy.
</p>
<h3><span class="mw-headline" id="Password_hashes">Password hashes</span></h3>
<div class="noprint archwiki-template-message">
<p><a href="../File:Tango-view-fullscreen.png" class="image"><img alt="Tango-view-fullscreen.png" src="../File:Tango-view-fullscreen.png" decoding="async" width="48" height="48"></a><b>This article or section needs expansion.</b><a href="../File:Tango-view-fullscreen.png" class="image"><img alt="Tango-view-fullscreen.png" src="../File:Tango-view-fullscreen.png" decoding="async" width="48" height="48"></a></p>
<div>
<b>Reason:</b> Mention <a href="https://en.wikipedia.org/wiki/Key_derivation_function" class="extiw" title="wikipedia:Key derivation function">key derivation functions</a>, in particular PBKDF2, bcrypt and scrypt, how to use them, advantages and disadvantages, especially regarding custom-hardware-based brute-force attacks. (Discuss in <a rel="nofollow" class="external text" href="https://wiki.archlinux.org/index.php/Talk:Security#Removal_of_incorrect_warning">Talk:Security#Removal of incorrect warning</a>)</div>
</div>
<p>By default, Arch stores the hashed user passwords in the root-only-readable <code>/etc/shadow</code> file, separated from the other user parameters stored in the world-readable <code>/etc/passwd</code> file, see <a href="../en/Users_and_groups.html#User_database" title="Users and groups">Users and groups#User database</a>. See also <a href="#Restricting_root">#Restricting root</a>.
</p>
<p>Passwords are set with the <b>passwd</b> command, which <a href="https://en.wikipedia.org/wiki/Key_stretching" class="extiw" title="wikipedia:Key stretching">stretches</a> them with the <a href="https://en.wikipedia.org/wiki/Crypt_(C)" class="extiw" title="wikipedia:Crypt (C)">crypt</a> function and then saves them in <code>/etc/shadow</code>. See also <a href="../en/SHA_password_hashes.html" title="SHA password hashes">SHA password hashes</a>. The passwords are also <a href="https://en.wikipedia.org/wiki/Salt_(cryptography)" class="extiw" title="wikipedia:Salt (cryptography)">salted</a> in order to defend them against <a href="https://en.wikipedia.org/wiki/Rainbow_table" class="extiw" title="wikipedia:Rainbow table">rainbow table</a> attacks.
</p>
<p>See also <a rel="nofollow" class="external text" href="http://www.slashroot.in/how-are-passwords-stored-linux-understanding-hashing-shadow-utils">How are passwords stored in Linux (Understanding hashing with shadow utils)</a>.
</p>
<h3><span class="mw-headline" id="Enforcing_strong_passwords_with_pam_pwquality">Enforcing strong passwords with pam_pwquality</span></h3>
<p><i>pam_pwquality</i> provides protection against <a href="https://en.wikipedia.org/wiki/Dictionary_attack" class="extiw" title="wikipedia:Dictionary attack">Dictionary attacks</a> and helps configure a password policy that can be enforced throughout the system. It is based on <i>pam_cracklib</i>, so it is backwards compatible with its options.
</p>
<p><a href="../en/Help:Reading.html#Installation_of_packages" class="mw-redirect" title="Install">Install</a> the <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=libpwquality">libpwquality</a></span> package.
</p>
<div class="archwiki-template-box archwiki-template-box-warning">
<strong>Warning:</strong> The <i>root</i> account is not affected by this policy by default.</div>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Note:</strong> You can use the <i>root</i> account to set a password for a user that bypasses the desired/configured policy. This is useful when setting temporary passwords.</div>
<p>If for example you want to enforce this policy:
</p>
<ul>
<li>prompt 2 times for password in case of an error (retry option)</li>
<li>10 characters minimum length (minlen option)</li>
<li>at least 6 characters should be different from old password when entering a new one (difok option)</li>
<li>at least 1 digit (dcredit option)</li>
<li>at least 1 uppercase (ucredit option)</li>
<li>at least 1 lowercase (lcredit option)</li>
<li>at least 1 other character (ocredit option)</li>
<li>cannot contain the words "myservice" and "mydomain"</li>
<li>enforce the policy for root</li>
</ul>
<p>Edit the <code>/etc/pam.d/passwd</code> file to read as:
</p>
<pre>#%PAM-1.0
password required pam_pwquality.so retry=2 minlen=10 difok=6 dcredit=-1 ucredit=-1 ocredit=-1 lcredit=-1 [badwords=myservice mydomain] enforce_for_root
password required pam_unix.so use_authtok sha512 shadow</pre>
<p>The <code>password required pam_unix.so use_authtok</code> instructs the <i>pam_unix</i> module to not prompt for a password but rather to use the one provided by <i>pam_pwquality</i>.
</p>
<p>You can refer to the <span class="plainlinks archwiki-template-man" title="$ man 8 pam_pwquality"><a rel="nofollow" class="external text" href="https://man.archlinux.org/man/pam_pwquality.8">pam_pwquality(8)</a></span> and <span class="plainlinks archwiki-template-man" title="$ man 8 pam_unix"><a rel="nofollow" class="external text" href="https://man.archlinux.org/man/pam_unix.8">pam_unix(8)</a></span> man pages for more information.
</p>
<h2><span class="mw-headline" id="CPU">CPU</span></h2>
<h3><span class="mw-headline" id="Microcode">Microcode</span></h3>
<p>See <a href="../en/Microcode.html" title="Microcode">microcode</a> for information on how to install important security updates for your CPU's microcode.
</p>
<h3><span class="mw-headline" id="Hardware_vulnerabilities">Hardware vulnerabilities</span></h3>
<p>Some CPUs contain hardware vulnerabilities. See the <a rel="nofollow" class="external text" href="https://www.kernel.org/doc/html/latest/admin-guide/hw-vuln/">kernel documentation on hardware vulnerabilities</a> for a list of these vulnerabilities, as well as mitigation selection guides to help customize the kernel to mitigate these vulnerabilities for specific usage scenarios.
</p>
<p>To check if you are affected by a known vulnerability, run the following:
</p>
<pre>$ grep -r . /sys/devices/system/cpu/vulnerabilities/
</pre>
<p>In most cases, updating the kernel and microcode will mitigate vulnerabilities.
</p>
<h4>
<span id="Simultaneous_multithreading_.28hyper-threading.29"></span><span class="mw-headline" id="Simultaneous_multithreading_(hyper-threading)">Simultaneous multithreading (hyper-threading)</span>
</h4>
<p><a href="https://en.wikipedia.org/wiki/Simultaneous_multithreading" class="extiw" title="wikipedia:Simultaneous multithreading">Simultaneous multithreading</a> (SMT), also called hyper-threading on Intel CPUs, is a hardware feature that may be a source of <a rel="nofollow" class="external text" href="https://www.kernel.org/doc/html/latest/admin-guide/hw-vuln/l1tf.html">L1 Terminal Fault</a> and <a rel="nofollow" class="external text" href="https://www.kernel.org/doc/html/latest/admin-guide/hw-vuln/mds.html">Microarchitectural Data Sampling</a> vulnerabilities. The Linux kernel and microcode updates contain mitigations for known vulnerabilities, but <a rel="nofollow" class="external text" href="https://www.kernel.org/doc/html/latest/admin-guide/hw-vuln/l1tf.html#virtualization-with-untrusted-guests">disabling SMT may still be required on certain CPUs if untrusted virtualization guests are present</a>.
</p>
<p>SMT can often be disabled in your system's firmware. Consult your motherboard or system documentation for more information. You can also disable SMT in the kernel by adding the following <a href="../en/Kernel_parameters.html" title="Kernel parameters">kernel parameters</a>:
</p>
<pre>l1tf=full,force mds=full,nosmt mitigations=auto,nosmt nosmt=force
</pre>
<h2><span class="mw-headline" id="Memory">Memory</span></h2>
<h3><span class="mw-headline" id="Hardened_malloc">Hardened malloc</span></h3>
<p><a rel="nofollow" class="external text" href="https://github.com/GrapheneOS/hardened_malloc">hardened_malloc</a> (<span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://aur.archlinux.org/packages/hardened_malloc/">hardened_malloc</a></span><sup><small>AUR</small></sup>, <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://aur.archlinux.org/packages/hardened-malloc-git/">hardened-malloc-git</a></span><sup><small>AUR</small></sup>) is a hardened replacement for <a href="https://en.wikipedia.org/wiki/GNU_C_Library" class="extiw" title="wikipedia:GNU C Library">glibc</a>'s malloc(). The project was originally developed for integration into Android's <a href="https://en.wikipedia.org/wiki/Bionic_(software)" class="extiw" title="wikipedia:Bionic (software)">Bionic</a> and <a href="https://en.wikipedia.org/wiki/musl" class="extiw" title="wikipedia:musl">musl</a> by Daniel Micay, of GrapheneOS, but he has also built in support for standard Linux distributions on the x86_64 architecture.
</p>
<p>While hardened_malloc is not yet integrated into glibc (assistance and pull requests welcome) it can be used easily with LD_PRELOAD. In testing so far, it only causes issues with a handful of applications if enabled globally in <code>/etc/ld.so.preload</code>. For example, <code>man</code> fails to work properly unless its <code>seccomp</code> environment flag is disabled due to not having <code>getrandom</code> in the standard whitelist, although this can be easily fixed by rebuilding it with the system call added. Since hardened_malloc has a performance cost, you may want to decide which implementation to use on a case-by-case basis based on attack surface and performance needs.
</p>
<p>To try it out in a standalone manner, use the hardened-malloc-preload wrapper script, or manually start an application with the proper preload value:
</p>
<pre>LD_PRELOAD="/usr/lib/libhardened_malloc.so" /usr/bin/firefox
</pre>
<p>Proper usage with <a href="../en/Firejail.html" title="Firejail">Firejail</a> can be found on its wiki page, and some configurable build options for hardened_malloc can be found on the github repo.
</p>
<h2><span class="mw-headline" id="Storage">Storage</span></h2>
<h3><span class="mw-headline" id="Data-at-rest_encryption">Data-at-rest encryption</span></h3>
<p><a href="../en/Data-at-rest_encryption.html" title="Data-at-rest encryption">Data-at-rest encryption</a>, preferably full-disk encryption with a <a href="#Passwords">strong passphrase</a>, is the only way to guard data against physical recovery. This provides complete security when the computer is turned off or the disks in question are unmounted.
</p>
<p>Once the computer is powered on and the drive is mounted, however, its data becomes just as vulnerable as an unencrypted drive. It is therefore best practice to unmount data partitions as soon as they are no longer needed.
</p>
<p>Certain programs, like <a href="../en/Dm-crypt.html" title="Dm-crypt">dm-crypt</a>, allow the user to encrypt a loop file as a virtual volume. This is a reasonable alternative to full-disk encryption when only certain parts of the system need be secure.
</p>
<h3><span class="mw-headline" id="File_systems">File systems</span></h3>
<p>The kernel now prevents security issues related to hardlinks and symlinks if the <code>fs.protected_hardlinks</code> and <code>fs.protected_symlinks</code> sysctl switches are enabled, so there is no longer a major security benefit from separating out world-writable directories.
</p>
<p>File systems containing world-writable directories can still be kept separate as a coarse way of limiting the damage from disk space exhaustion. However, filling <code>/var</code> or <code>/tmp</code> is enough to take down services. More flexible mechanisms for dealing with this concern exist (like <a href="../en/Disk_quota.html" title="Disk quota">quotas</a>), and some <a href="../en/File_systems.html" title="File systems">file systems</a> include related features themselves (Btrfs has quotas on subvolumes).
</p>
<h4><span class="mw-headline" id="Mount_options">Mount options</span></h4>
<p>Following the principle of least privilege, file systems should be mounted with the most restrictive mount options possible (without losing functionality).
</p>
<p>Relevant mount options are:
</p>
<ul>
<li>
<code>nodev</code>: Do not interpret character or block special devices on the file system.</li>
<li>
<code>nosuid</code>: Do not allow set-user-identifier or set-group-identifier bits to take effect.</li>
<li>
<code>noexec</code>: Do not allow direct execution of any  binaries on the mounted file system.
<ul>
<li>Setting <code>noexec</code> on <code>/home</code> disallows executable scripts and breaks <a href="../en/Wine.html" title="Wine">Wine</a>*, <a href="../en/Steam.html" title="Steam">Steam</a>, PyCharm, etc.</li>
<li>Some packages (building <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=nvidia-dkms">nvidia-dkms</a></span> for example) may require <code>exec</code> on <code>/var</code>.</li>
</ul>
</li>
</ul>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Note:</strong> Wine does not need the <code>exec</code> flag for opening Windows executables. It is only needed when Wine itself is installed in <code>/home</code>.</div>
<p>File systems used for data should always be mounted with <code>nodev</code>, <code>nosuid</code> and <code>noexec</code>.
</p>
<p>Potential file system mounts to consider:
</p>
<ul>
<li><code>/var</code></li>
<li><code>/home</code></li>
<li><code>/dev/shm</code></li>
<li><code>/tmp</code></li>
<li><code>/boot</code></li>
</ul>
<h3><span class="mw-headline" id="File_access_permissions">File access permissions</span></h3>
<p>The default <a href="../en/File_permissions_and_attributes.html" class="mw-redirect" title="File permissions">file permissions</a> allow read access to almost everything and changing the permissions can hide valuable information from an attacker who gains access to a non-root account such as the <code>http</code> or <code>nobody</code> users.
</p>
<p>For example:
</p>
<pre># chmod 700 /boot /etc/{iptables,arptables}
</pre>
<p>The default <a href="../en/Umask.html" title="Umask">Umask</a> <code>0022</code> can be changed to improve security for newly created files. The <a rel="nofollow" class="external text" href="https://apps.nsa.gov/iaarchive/library/ia-guidance/security-configuration/operating-systems/guide-to-the-secure-configuration-of-red-hat-enterprise.cfm">NSA RHEL5 Security Guide</a> suggests a umask of <code>0077</code> for maximum security, which makes new files not readable by users other than the owner. To change this, see <a href="../en/Umask.html#Set_the_mask_value" title="Umask">Umask#Set the mask value</a>.
</p>
<h3><span class="mw-headline" id="Backups">Backups</span></h3>
<div class="noprint archwiki-template-message">
<p><a href="../File:Merge-arrows-2.png" class="image"><img alt="Merge-arrows-2.png" src="../File:Merge-arrows-2.png" decoding="async" width="48" height="48"></a><b>This article or section is a candidate for merging with <a href="../en/System_backup.html" title="System backup">System backup</a>.</b><a href="../File:Merge-arrows-2.png" class="image"><img alt="Merge-arrows-2.png" src="../File:Merge-arrows-2.png" decoding="async" width="48" height="48"></a></p>
<div>
<b>Notes:</b> There is a dedicated page for system backups. (Discuss in <a rel="nofollow" class="external text" href="https://wiki.archlinux.org/index.php/Talk:Security">Talk:Security#</a>)</div>
</div>
<p>Regularly create backups of important data. Regularly test the integrity of the backups. Regularly test that the backups can be restored.
</p>
<p>Make sure that at least one copy of the data is stored offline, i.e. not connected to the system under threat in any way. <a href="https://en.wikipedia.org/wiki/Ransomware" class="extiw" title="wikipedia:Ransomware">Ransomware</a> and other destructive attacks may also attack any connected backup systems.
</p>
<h2><span class="mw-headline" id="User_setup">User setup</span></h2>
<h3><span class="mw-headline" id="Do_not_use_the_root_account_for_daily_use">Do not use the root account for daily use</span></h3>
<p>Following the principle of least privilege, do not use the root user for daily use. Create a non-privileged user account for each person using the system. Use <a href="../en/Sudo.html" title="Sudo">sudo</a> as necessary for temporary privileged access.
</p>
<h3><span class="mw-headline" id="Enforce_a_delay_after_a_failed_login_attempt">Enforce a delay after a failed login attempt</span></h3>
<p>Add the following line to <code>/etc/pam.d/system-login</code> to add a delay of at least 4 seconds between failed login attempts:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/pam.d/system-login</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">auth optional pam_faildelay.so delay=4000000</pre>
<p><code>4000000</code> is the time in microseconds to delay.
</p>
<h3><span class="mw-headline" id="Lock_out_user_after_three_failed_login_attempts">Lock out user after three failed login attempts</span></h3>
<p>As of <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=pambase">pambase</a></span> 20200721.1-2, <code>pam_faillock.so</code> is enabled by default to lock out users for 10 minutes after 3 failed login attempts in a 15 minute period (see <a rel="nofollow" class="external text" href="https://bugs.archlinux.org/task/67644">FS#67644</a>). The lockout only applies to password authentication (e.g. login and sudo), public key authentication over SSH is still accepted.  To prevent complete denial-of-service, this lockout is disabled on root.
</p>
<p>To unlock a user, do:
</p>
<pre>$ faillock --reset --user <i>username</i>
</pre>
<p>By default, the lock mechanism is a file per-user located at <code>/run/faillock/</code>.  Deleting or emptying the file unlocks that user - the directory is owned by root, but the file is owned by the user, so the <code>faillock</code> command only empties the file, therefore does not require root.
</p>
<p>The module <code>pam_faillock.so</code> can be configured with the file <code>/etc/security/faillock.conf</code>. The lockout parameters:
</p>
<ul>
<li>
<code>unlock_time</code> — the lockout time (in seconds, default 10 minutes).</li>
<li>
<code>fail_interval</code> — the time in which failed logins can cause a lockout (in seconds, default 15 minutes).</li>
<li>
<code>deny</code> — the number of failed logins before lockout (default 3).</li>
</ul>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Note:</strong> <code>deny = 0</code> will disable the lockout.</div>
<p>No restart is required for changes to take effect.  See <span class="plainlinks archwiki-template-man" title="$ man 5 faillock.conf"><a rel="nofollow" class="external text" href="https://man.archlinux.org/man/faillock.conf.5">faillock.conf(5)</a></span> for further configuration options, such as enabling lockout for the root account, disabling for centralized login (e.g. LDAP), etc.
</p>
<h3><span class="mw-headline" id="Limit_amount_of_processes">Limit amount of processes</span></h3>
<p>On systems with many, or untrusted users, it is important to limit the number of processes each can run at once, therefore preventing <a href="https://en.wikipedia.org/wiki/Fork_bomb" class="extiw" title="wikipedia:Fork bomb">fork bombs</a> and other denial of service attacks. <code>/etc/security/limits.conf</code> determines how many processes each user, or group can have open, and is empty (except for useful comments) by default. Adding the following lines to this file will limit all users to 100 active processes, unless they use the <code>prlimit</code> command to explicitly raise their maximum to 200 for that session. These values can be changed according to the appropriate number of processes a user should have running, or the hardware of the box you are administrating. 
</p>
<pre>* soft nproc 100
* hard nproc 200
</pre>
<p>The current number of threads for each user can be found with <code>ps --no-headers -Leo user | sort | uniq --count</code>. This may help with determining appropriate values for the limits.
</p>
<h3><span class="mw-headline" id="Run_Xorg_rootless">Run Xorg rootless</span></h3>
<p><a href="../en/Xorg.html" title="Xorg">Xorg</a> is commonly <a rel="nofollow" class="external text" href="https://security.stackexchange.com/questions/4641/why-are-people-saying-that-the-x-window-system-is-not-secure/4646#4646">considered insecure</a> because of its architecture and dated design. Thus it is recommended to avoid running it as root.
</p>
<p>See <a href="../en/Xorg.html#Rootless_Xorg" title="Xorg">Xorg#Rootless Xorg</a> for more details how to run it without root privileges. Alternatively, use <a href="../en/Wayland.html" title="Wayland">Wayland</a> instead of Xorg.
</p>
<h2><span class="mw-headline" id="Restricting_root">Restricting root</span></h2>
<p>The root user is, by definition, the most powerful user on a system. It is also difficult to audit the root user account. It is therefore important to restrict usage of the root user account as much as possible. There are a number of ways to keep the power of the root user while limiting its ability to cause harm.
</p>
<h3><span class="mw-headline" id="Use_sudo_instead_of_su">Use sudo instead of su</span></h3>
<div class="noprint archwiki-template-message">
<p><a href="../File:Merge-arrows-2.png" class="image"><img alt="Merge-arrows-2.png" src="../File:Merge-arrows-2.png" decoding="async" width="48" height="48"></a><b>This article or section is a candidate for merging with <a href="../en/Sudo.html" title="Sudo">sudo</a>.</b><a href="../File:Merge-arrows-2.png" class="image"><img alt="Merge-arrows-2.png" src="../File:Merge-arrows-2.png" decoding="async" width="48" height="48"></a></p>
<div>
<b>Notes:</b> There is a dedicated article. (Discuss in <a rel="nofollow" class="external text" href="https://wiki.archlinux.org/index.php/Talk:Security">Talk:Security#</a>)</div>
</div>
<p>Using <a href="../en/Sudo.html" title="Sudo">sudo</a> for privileged access is preferable to <a href="../en/Su.html" title="Su">su</a> for <a href="../en/Su.html#Sudo,_an_alternative" title="Su">a number of reasons</a>.
</p>
<ul>
<li>It keeps a log of which normal privilege user has run each privileged command.</li>
<li>The root user password need not be given out to each user who requires root access.</li>
<li>
<code>sudo</code> prevents users from accidentally running commands as <i>root</i> that do not need root access, because a full root terminal is not created. This aligns with the <a href="https://en.wikipedia.org/wiki/Principle_of_least_privilege" class="extiw" title="wikipedia:Principle of least privilege">principle of least privilege</a>.</li>
<li>Individual programs may be enabled per user, instead of offering complete root access just to run one command. For example, to give the user <i>alice</i> access to a particular program:</li>
</ul>
<pre># visudo
</pre>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/sudoers</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">alice ALL = NOPASSWD: /path/to/program</pre>
<p>Or, individual commands can be allowed for all users. To mount Samba shares from a server as a regular user:
</p>
<pre>%users ALL=/sbin/mount.cifs,/sbin/umount.cifs
</pre>
<p>This allows all users who are members of the group users to run the commands <code>/sbin/mount.cifs</code> and <code>/sbin/umount.cifs</code> from any machine (ALL).
</p>
<div class="archwiki-template-box archwiki-template-box-tip">
<strong>Tip:</strong> 
<p>To use restricted version of <code>nano</code> instead of <code>vi</code> with <code>visudo</code>,
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/sudoers</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">Defaults editor=/usr/bin/rnano</pre>
<p>Exporting <code>EDITOR=nano visudo</code> is regarded as a severe security risk since everything can be used as an <code>EDITOR</code>.
</p>
</div>
<h4><span class="mw-headline" id="Editing_files_using_sudo">Editing files using sudo</span></h4>
<p>See <a href="../en/Sudo.html#Editing_files" title="Sudo">Sudo#Editing files</a>. Alternatively, you can use an editor like <code>rvim</code> or <code>rnano</code> which has restricted capabilities in order to be safe to run as root.
</p>
<h3><span class="mw-headline" id="Restricting_root_login">Restricting root login</span></h3>
<p>Once <a href="../en/Sudo.html" title="Sudo">sudo</a> is properly configured, full root access can be heavily restricted or denied without losing much usability. To disable root, but still allowing to use <a href="../en/Sudo.html" title="Sudo">sudo</a>, you can use <code>passwd --lock root</code>.
</p>
<h4><span class="mw-headline" id="Allow_only_certain_users">Allow only certain users</span></h4>
<p>The <a href="../en/PAM.html" title="PAM">PAM</a> <code>pam_wheel.so</code> lets you allow only users in the group <code>wheel</code> to login using <a href="../en/Su.html" title="Su">su</a>. See <a href="../en/Su.html#su_and_wheel" title="Su">su#su and wheel</a>.
</p>
<h4><span class="mw-headline" id="Denying_SSH_login">Denying SSH login</span></h4>
<p>Even if you do not wish to deny root login for local users, it is always good practice to <a href="../en/OpenSSH.html#Deny" title="OpenSSH">deny root login via SSH</a>. The purpose of this is to add an additional layer of security before a user can completely compromise your system remotely.
</p>
<h4><span class="mw-headline" id="Specify_acceptable_login_combinations_with_access.conf">Specify acceptable login combinations with access.conf</span></h4>
<p>When someone attempts to log in with <a href="../en/PAM.html" title="PAM">PAM</a>, <code>/etc/security/access.conf</code> is checked for the first combination that matches their login properties. Their attempt then fails or succeeds based on the rule for that combination. 
</p>
<pre>+:root:LOCAL
-:root:ALL
</pre>
<p>Rules can be set for specific groups and users. In this example, the user archie is allowed to login locally, as are all users in the wheel and adm groups. All other logins are rejected:
</p>
<pre>+:archie:LOCAL
+:(wheel):LOCAL
+:(adm):LOCAL
-:ALL:ALL
</pre>
<p>Read more at <span class="plainlinks archwiki-template-man" title="$ man 5 access.conf"><a rel="nofollow" class="external text" href="https://man.archlinux.org/man/access.conf.5">access.conf(5)</a></span>
</p>
<h2><span class="mw-headline" id="Mandatory_access_control">Mandatory access control</span></h2>
<p><a href="https://en.wikipedia.org/wiki/Mandatory_Access_Control" class="extiw" title="wikipedia:Mandatory Access Control">Mandatory access control</a> (MAC) is a type of security policy that differs significantly from the <a href="https://en.wikipedia.org/wiki/Discretionary_Access_Control" class="extiw" title="wikipedia:Discretionary Access Control">discretionary access control</a> (DAC) used by default in Arch and most Linux distributions. MAC essentially means that every action a program could perform that affects the system in any way is checked against a security ruleset. This ruleset, in contrast to DAC methods, cannot be modified by users. Using virtually any mandatory access control system will significantly improve the security of your computer, although there are differences in how it can be implemented.
</p>
<h3><span class="mw-headline" id="Pathname_MAC">Pathname MAC</span></h3>
<p>Pathname-based access control is a simple form of access control that offers permissions based on the path of a given file. The downside to this style of access control is that permissions are not carried with files if they are moved about the system. On the positive side, pathname-based MAC can be implemented on a much wider range of filesystems, unlike labels-based alternatives.
</p>
<ul>
<li>
<a href="../en/AppArmor.html" title="AppArmor">AppArmor</a> is a <a href="https://en.wikipedia.org/wiki/Canonical_(company)" class="extiw" title="wikipedia:Canonical (company)">Canonical</a>-maintained MAC implementation seen as an "easier" alternative to SELinux.</li>
<li>
<a href="../en/TOMOYO_Linux.html" class="mw-redirect" title="Tomoyo">Tomoyo</a> is another simple, easy-to-use system offering mandatory access control. It is designed to be both simple in usage and in implementation, requiring very few dependencies.</li>
</ul>
<h3><span class="mw-headline" id="Labels_MAC">Labels MAC</span></h3>
<p>Labels-based access control means the extended attributes of a file are used to govern its security permissions. While this system is arguably more flexible in its security offerings than pathname-based MAC, it only works on filesystems that support these extended attributes.
</p>
<ul><li>
<a href="../en/SELinux.html" title="SELinux">SELinux</a>, based on a <a href="https://en.wikipedia.org/wiki/NSA" class="extiw" title="wikipedia:NSA">NSA</a> project to improve Linux security, implements MAC completely separate from system users and roles. It offers an extremely robust multi-level MAC policy implementation that can easily maintain control of a system that grows and changes past its original configuration.</li></ul>
<h3><span class="mw-headline" id="Access_Control_Lists">Access Control Lists</span></h3>
<p><a href="../en/Access_Control_Lists.html" title="Access Control Lists">Access Control Lists</a> (ACLs) are an alternative to attaching rules directly to the filesystem in some way. ACLs implement access control by checking program actions against a list of permitted behavior.
</p>
<h2><span class="mw-headline" id="Kernel_hardening">Kernel hardening</span></h2>
<h3>
<span id="Kernel_self-protection_.2F_exploit_mitigation"></span><span class="mw-headline" id="Kernel_self-protection_/_exploit_mitigation">Kernel self-protection / exploit mitigation</span>
</h3>
<p>The <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=linux-hardened">linux-hardened</a></span> package uses a <a rel="nofollow" class="external text" href="https://github.com/anthraxx/linux-hardened">basic kernel hardening patch set</a> and more security-focused compile-time configuration options than the <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=linux">linux</a></span> package. A custom build can be made to choose a different compromise between security and performance than the security-leaning defaults.
</p>
<p>However, it should be noted that several packages will not work when using this kernel. For example:
</p>
<ul>
<li>
<span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://aur.archlinux.org/packages/skypeforlinux-preview-bin/">skypeforlinux-preview-bin</a></span><sup><small>AUR</small></sup>
</li>
<li>
<span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://aur.archlinux.org/packages/skypeforlinux-stable-bin/">skypeforlinux-stable-bin</a></span><sup><small>AUR</small></sup>
</li>
<li><span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=throttled">throttled</a></span></li>
</ul>
<p>If you use an out-of-tree driver such as <a href="../en/NVIDIA.html" title="NVIDIA">NVIDIA</a>, you may need to switch to its <a href="../en/Dynamic_Kernel_Module_Support.html" class="mw-redirect" title="DKMS">DKMS</a> package.
</p>
<h4><span class="mw-headline" id="Userspace_ASLR_comparison">Userspace ASLR comparison</span></h4>
<p>The <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=linux-hardened">linux-hardened</a></span> package provides an improved implementation of Address Space Layout Randomization for userspace processes. The <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=paxtest">paxtest</a></span> command can be used to obtain an estimate of the provided entropy:
</p>
<h5><span class="mw-headline" id="64-bit_processes">64-bit processes</span></h5>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">linux-hardened 5.4.21.a-1-hardened</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">Anonymous mapping randomization test     : 32 quality bits (guessed)
Heap randomization test (ET_EXEC)        : 40 quality bits (guessed)
Heap randomization test (PIE)            : 40 quality bits (guessed)
Main executable randomization (ET_EXEC)  : 32 quality bits (guessed)
Main executable randomization (PIE)      : 32 quality bits (guessed)
Shared library randomization test        : 32 quality bits (guessed)
VDSO randomization test                  : 32 quality bits (guessed)
Stack randomization test (SEGMEXEC)      : 40 quality bits (guessed)
Stack randomization test (PAGEEXEC)      : 40 quality bits (guessed)
Arg/env randomization test (SEGMEXEC)    : 44 quality bits (guessed)
Arg/env randomization test (PAGEEXEC)    : 44 quality bits (guessed)
Offset to library randomisation (ET_EXEC): 34 quality bits (guessed)
Offset to library randomisation (ET_DYN) : 34 quality bits (guessed)
Randomization under memory exhaustion @~0: 32 bits (guessed)
Randomization under memory exhaustion @0 : 32 bits (guessed)
</pre>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">linux 5.5.5-arch1-1</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">Anonymous mapping randomization test     : 28 quality bits (guessed)
Heap randomization test (ET_EXEC)        : 28 quality bits (guessed)
Heap randomization test (PIE)            : 28 quality bits (guessed)
Main executable randomization (ET_EXEC)  : 28 quality bits (guessed)
Main executable randomization (PIE)      : 28 quality bits (guessed)
Shared library randomization test        : 28 quality bits (guessed)
VDSO randomization test                  : 20 quality bits (guessed)
Stack randomization test (SEGMEXEC)      : 30 quality bits (guessed)
Stack randomization test (PAGEEXEC)      : 30 quality bits (guessed)
Arg/env randomization test (SEGMEXEC)    : 22 quality bits (guessed)
Arg/env randomization test (PAGEEXEC)    : 22 quality bits (guessed)
Offset to library randomisation (ET_EXEC): 28 quality bits (guessed)
Offset to library randomisation (ET_DYN) : 28 quality bits (guessed)
Randomization under memory exhaustion @~0: 29 bits (guessed)
Randomization under memory exhaustion @0 : 29 bits (guessed)
</pre>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">linux-lts 4.19.101-1-lts</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">Anonymous mapping randomization test     : 28 quality bits (guessed)
Heap randomization test (ET_EXEC)        : 28 quality bits (guessed)
Heap randomization test (PIE)            : 28 quality bits (guessed)
Main executable randomization (ET_EXEC)  : 28 quality bits (guessed)
Main executable randomization (PIE)      : 28 quality bits (guessed)
Shared library randomization test        : 28 quality bits (guessed)
VDSO randomization test                  : 19 quality bits (guessed)
Stack randomization test (SEGMEXEC)      : 30 quality bits (guessed)
Stack randomization test (PAGEEXEC)      : 30 quality bits (guessed)
Arg/env randomization test (SEGMEXEC)    : 22 quality bits (guessed)
Arg/env randomization test (PAGEEXEC)    : 22 quality bits (guessed)
Offset to library randomisation (ET_EXEC): 28 quality bits (guessed)
Offset to library randomisation (ET_DYN) : 28 quality bits (guessed)
Randomization under memory exhaustion @~0: 28 bits (guessed)
Randomization under memory exhaustion @0 : 28 bits (guessed)
</pre>
<h5>
<span id="32-bit_processes_.28on_an_x86_64_kernel.29"></span><span class="mw-headline" id="32-bit_processes_(on_an_x86_64_kernel)">32-bit processes (on an x86_64 kernel)</span>
</h5>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">linux-hardened</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">Anonymous mapping randomization test     : 16 quality bits (guessed)
Heap randomization test (ET_EXEC)        : 22 quality bits (guessed)
Heap randomization test (PIE)            : 27 quality bits (guessed)
Main executable randomization (ET_EXEC)  : No randomization
Main executable randomization (PIE)      : 18 quality bits (guessed)
Shared library randomization test        : 16 quality bits (guessed)
VDSO randomization test                  : 16 quality bits (guessed)
Stack randomization test (SEGMEXEC)      : 24 quality bits (guessed)
Stack randomization test (PAGEEXEC)      : 24 quality bits (guessed)
Arg/env randomization test (SEGMEXEC)    : 28 quality bits (guessed)
Arg/env randomization test (PAGEEXEC)    : 28 quality bits (guessed)
Offset to library randomisation (ET_EXEC): 18 quality bits (guessed)
Offset to library randomisation (ET_DYN) : 16 quality bits (guessed)
Randomization under memory exhaustion @~0: 18 bits (guessed)
Randomization under memory exhaustion @0 : 18 bits (guessed)
</pre>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">linux</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">Anonymous mapping randomization test     : 8 quality bits (guessed)
Heap randomization test (ET_EXEC)        : 13 quality bits (guessed)
Heap randomization test (PIE)            : 13 quality bits (guessed)
Main executable randomization (ET_EXEC)  : No randomization
Main executable randomization (PIE)      : 8 quality bits (guessed)
Shared library randomization test        : 8 quality bits (guessed)
VDSO randomization test                  : 8 quality bits (guessed)
Stack randomization test (SEGMEXEC)      : 19 quality bits (guessed)
Stack randomization test (PAGEEXEC)      : 19 quality bits (guessed)
Arg/env randomization test (SEGMEXEC)    : 11 quality bits (guessed)
Arg/env randomization test (PAGEEXEC)    : 11 quality bits (guessed)
Offset to library randomisation (ET_EXEC): 8 quality bits (guessed)
Offset to library randomisation (ET_DYN) : 13 quality bits (guessed)
Randomization under memory exhaustion @~0: No randomization
Randomization under memory exhaustion @0 : No randomization
</pre>
<h3><span class="mw-headline" id="Restricting_access_to_kernel_logs">Restricting access to kernel logs</span></h3>
<p>The kernel logs contain useful information for an attacker trying to exploit kernel vulnerabilities, such as sensitive memory addresses. The <code>kernel.dmesg_restrict</code> flag was to forbid access to the logs without the <code>CAP_SYS_ADMIN</code> capability (which only processes running as root have by default).
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/sysctl.d/51-dmesg-restrict.conf</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">kernel.dmesg_restrict = 1</pre>
<div class="archwiki-template-box archwiki-template-box-tip">
<strong>Tip:</strong> This is enabled by default in <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=linux-hardened">linux-hardened</a></span>.</div>
<h3><span class="mw-headline" id="Restricting_access_to_kernel_pointers_in_the_proc_filesystem">Restricting access to kernel pointers in the proc filesystem</span></h3>
<p>Setting <code>kernel.kptr_restrict</code> to 1 will hide kernel symbol addresses in <code>/proc/kallsyms</code> from regular users without <code>CAP_SYSLOG</code>, making it more difficult for kernel exploits to resolve addresses/symbols dynamically. This will not help that much on a pre-compiled Arch Linux kernel, since a determined attacker could just download the kernel package and get the symbols manually from there, but if you are compiling your own kernel, this can help mitigating local root exploits. This will break some <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=perf">perf</a></span> commands when used by non-root users (but many <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=perf">perf</a></span> features require root access anyway). See <a rel="nofollow" class="external text" href="https://bugs.archlinux.org/task/34323">FS#34323</a> for more information.
</p>
<p>Setting  <code>kernel.kptr_restrict</code> to 2 will hide kernel symbol addresses in <code>/proc/kallsyms</code> regardless of privileges.
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/sysctl.d/51-kptr-restrict.conf</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">kernel.kptr_restrict = 1</pre>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Note:</strong> <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=linux-hardened">linux-hardened</a></span> sets <code>kptr_restrict=2</code> by default rather than <code>0</code>.</div>
<h3><span class="mw-headline" id="BPF_hardening">BPF hardening</span></h3>
<p>BPF is a system used to load and execute bytecode within the kernel dynamically during runtime. It is used in a number of Linux kernel subsystems such as networking (e.g. XDP, tc), tracing (e.g. kprobes, uprobes, tracepoints) and security (e.g. seccomp). It is also useful for advanced network security, performance profiling and dynamic tracing.
</p>
<p>BPF was originally an acronym of <a href="https://en.wikipedia.org/wiki/Berkeley_Packet_Filter" class="extiw" title="wikipedia:Berkeley Packet Filter">Berkeley Packet Filter</a> since the original classic BPF was used for packet capture tools for BSD. This eventually evolved into Extended BPF (eBPF), which was shortly afterwards renamed to just BPF (not an acronym). BPF should not be confused with packet filtering tools like iptables or netfilter, although BPF can be used to implement packet filtering tools.
</p>
<p>BPF code may be either interpreted or compiled using a <a href="https://en.wikipedia.org/wiki/Just-in-time_compilation" class="extiw" title="wikipedia:Just-in-time compilation">Just-In-Time (JIT) compiler</a>. The Arch kernel is built with <code>CONFIG_BPF_JIT_ALWAYS_ON</code> which disables the BPF interpreter and forces all BPF to use JIT compilation. This makes it harder for an attacker to use BPF to escalate attacks that exploit SPECTRE-style vulnerabilities. See <a rel="nofollow" class="external text" href="https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/commit/?id=290af86629b25ffd1ed6232c4e9107da031705cb">the kernel patch which introduced CONFIG_BPF_JIT_ALWAYS_ON</a> for more details.
</p>
<p>The kernel includes a hardening feature for JIT-compiled BPF which can mitigate some types of JIT spraying attacks at the cost of performance and the ability to trace and debug many BPF programs. It may be enabled by setting <code>net.core.bpf_jit_harden</code> to <code>1</code> (to enable hardening of unprivileged code) or <code>2</code> (to enable hardening of all code).
</p>
<p>See the <code>net.core.bpf_*</code> settings in the <a rel="nofollow" class="external text" href="https://www.kernel.org/doc/html/latest/admin-guide/sysctl/net.html">kernel documentation</a> for more details.
</p>
<div class="archwiki-template-box archwiki-template-box-tip">
<strong>Tip:</strong> <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=linux-hardened">linux-hardened</a></span> sets <code>net.core.bpf_jit_harden=2</code> by default rather than <code>0</code>.</div>
<h3><span class="mw-headline" id="ptrace_scope">ptrace scope</span></h3>
<p>The <span class="plainlinks archwiki-template-man" title="$ man 2 ptrace"><a rel="nofollow" class="external text" href="https://man.archlinux.org/man/ptrace.2">ptrace(2)</a></span> syscall provides a means by which one process (the "tracer") may observe and control the execution of another process (the "tracee"), and examine and change the tracee's memory and registers. <code>ptrace</code> is commonly used by debugging tools including <i>gdb</i>, <i>strace</i>, <i>perf</i>, <i>reptyr</i> and other debuggers. However, it also provides a means by which a malicious process can read data from and take control of other processes.
</p>
<p>Arch enables the <a rel="nofollow" class="external text" href="https://www.kernel.org/doc/html/latest/admin-guide/LSM/Yama.html">Yama LSM</a> by default, which provides a <code>kernel.yama.ptrace_scope</code> <a href="../en/Kernel_parameters.html" class="mw-redirect" title="Kernel parameter">kernel parameter</a>. This parameter is set to <code>1</code> (restricted) by default which prevents tracers from performing a <code>ptrace</code> call on tracees outside of a restricted scope unless the tracer is privileged or has the <code>CAP_SYS_PTRACE</code> <a href="../en/Capabilities.html" title="Capabilities">capability</a>. This is a significant improvement in security compared to the classic permissions. Without this module, there is no separation between processes running as the same user (in the absence of additional security layers such as <span class="plainlinks archwiki-template-man" title="$ man 7 pid_namespaces"><a rel="nofollow" class="external text" href="https://man.archlinux.org/man/pid_namespaces.7">pid_namespaces(7)</a></span>).
</p>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Note:</strong> By default, you can still use tools which require <code>ptrace</code> by running them as privileged processes, e.g. using <a href="../en/Sudo.html" title="Sudo">sudo</a>.</div>
<p>If you do not need to use debugging tools, consider setting <code>kernel.yama.ptrace_scope</code> to <code>2</code> (admin-only) or <code>3</code> (no <code>ptrace</code> possible) to harden the system.
</p>
<h3><span class="mw-headline" id="hidepid">hidepid</span></h3>
<div class="noprint archwiki-template-message">
<p><a href="../File:Tango-view-fullscreen.png" class="image"><img alt="Tango-view-fullscreen.png" src="../File:Tango-view-fullscreen.png" decoding="async" width="48" height="48"></a><b>This article or section needs expansion.</b><a href="../File:Tango-view-fullscreen.png" class="image"><img alt="Tango-view-fullscreen.png" src="../File:Tango-view-fullscreen.png" decoding="async" width="48" height="48"></a></p>
<div>
<b>Reason:</b> <a rel="nofollow" class="external text" href="https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/commit/?id=0fb5ce62c5920b6e0a8a061f2fe80e0403281e10">Linux 5.8 implemented private instances</a> and new values for <code>hidepid=</code>. (Discuss in <a rel="nofollow" class="external text" href="https://wiki.archlinux.org/index.php/Talk:Security">Talk:Security#</a>)</div>
</div>
<div class="archwiki-template-box archwiki-template-box-warning">
<strong>Warning:</strong> 
<ul>
<li>This may cause issues for certain applications like an application running in a sandbox and <a href="../en/Xorg.html" title="Xorg">Xorg</a> (see workaround).</li>
<li>This causes issues with <a href="../en/D-Bus.html" title="D-Bus">D-Bus</a>, <a href="../en/PulseAudio.html" title="PulseAudio">PulseAudio</a> and <a href="../en/Bluetooth.html" title="Bluetooth">bluetooth</a> when using <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=systemd">systemd</a></span> &gt; 237.64-1.</li>
</ul>
</div>
<p>The kernel has the ability to hide other users' processes, normally accessible via <code>/proc</code>, from unprivileged users by mounting the <code>proc</code> filesystem with the <code>hidepid=</code> and <code>gid=</code> options documented in <a rel="nofollow" class="external free" href="https://www.kernel.org/doc/html/latest/filesystems/proc.html">https://www.kernel.org/doc/html/latest/filesystems/proc.html</a>. 
</p>
<p>This greatly complicates an intruder's task of gathering information about running processes, whether some daemon runs with elevated privileges, whether other user runs some sensitive program, whether other users run any program at all, makes it impossible to learn whether any user runs a specific program (given the program does not reveal itself by its behaviour), and, as an additional bonus, poorly written programs passing sensitive information via program arguments are now protected against local eavesdroppers.
</p>
<p>The <code>proc</code> <a href="../en/Users_and_groups.html#System_groups" title="Users and groups">group</a>, provided by the <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=filesystem">filesystem</a></span> package, acts as a whitelist of users authorized to learn other users' process information. If users or services need access to <code>/proc/&lt;pid&gt;</code> directories beyond their own, <a href="../en/Users_and_groups.html#Group_management" title="Users and groups">add them to the group</a>.
</p>
<p>For example, to hide process information from other users except those in the <code>proc</code> group:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/fstab</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">proc	/proc	proc	nosuid,nodev,noexec,hidepid=2,gid=proc	0	0</pre>
<p>For user sessions to work correctly, an exception needs to be added for <i>systemd-logind</i>:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/systemd/system/systemd-logind.service.d/hidepid.conf</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">[Service]
SupplementaryGroups=proc</pre>
<h3><span class="mw-headline" id="Restricting_module_loading">Restricting module loading</span></h3>
<p>The default Arch kernel has <code>CONFIG_MODULE_SIG_ALL</code> enabled which signs all kernel modules build as part of the <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=linux">linux</a></span> package. This allows the kernel to restrict modules to be only loaded when they are signed with a valid key, in practical terms this means that all out of tree modules compiled locally or provides by packages such as <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=virtualbox-host-modules-arch">virtualbox-host-modules-arch</a></span> cannot be loaded. Kernel module loading can be restricted by setting the <a href="../en/Kernel_parameters.html" class="mw-redirect" title="Kernel parameter">kernel parameter</a> <code>module.sig_enforce=1</code>. More information can be found at the <a rel="nofollow" class="external text" href="https://www.kernel.org/doc/html/latest/admin-guide/module-signing.html">kernel documentation</a>.
</p>
<h3><span class="mw-headline" id="Disable_kexec">Disable kexec</span></h3>
<p>Kexec allows replacing the current running kernel.
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/sysctl.d/51-kexec-restrict.conf</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">kernel.kexec_load_disabled = 1</pre>
<div class="archwiki-template-box archwiki-template-box-tip">
<strong>Tip:</strong> kexec is disabled by default in <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=linux-hardened">linux-hardened</a></span>.</div>
<h3><span class="mw-headline" id="Kernel_lockdown_mode">Kernel lockdown mode</span></h3>
<p>Since Linux 5.4 the kernel <a rel="nofollow" class="external text" href="https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/commit/?id=aefcf2f4b58155d27340ba5f9ddbe9513da8286d">has gained</a> an optional <a rel="nofollow" class="external text" href="https://mjg59.dreamwidth.org/55105.html">lockdown feature</a>, intended to strengthen the boundary between UID 0 (root) and the kernel. When enabled some applications may cease to work who rely on low-level access to either hardware or the kernel.
</p>
<p>To use lockdown, its LSM must be initialized and a lockdown mode must be set.
</p>
<p>All <a href="../en/Kernel.html#Officially_supported_kernels" title="Kernel">officially supported kernels</a> initialize the LSM, but none of them enforce any lockdown mode. 
</p>
<div class="archwiki-template-box archwiki-template-box-tip">
<strong>Tip:</strong> Active LSMs can be verified by running <code>cat /sys/kernel/security/lsm</code>. If the output does not have <code>lockdown</code> in it, set the <a href="../en/Kernel_parameters.html" class="mw-redirect" title="Kernel parameter">kernel parameter</a> <code>lsm=lockdown,yama</code> and reboot.</div>
<p>Lockdown has two modes of operation:
</p>
<ul>
<li>
<code>integrity</code>: kernel features that allow userland to modify the running kernel are disabled (kexec, bpf).</li>
<li>
<code>confidentiality</code>: kernel features that allow userland to extract confidential information from the kernel are also disabled.</li>
</ul>
<p>To enable kernel lockdown at runtime, run:
</p>
<pre># echo <i>mode</i> &gt; /sys/kernel/security/lockdown
</pre>
<p>To enable kernel lockdown on boot, use the <a href="../en/Kernel_parameters.html" class="mw-redirect" title="Kernel parameter">kernel parameter</a> <code>lockdown=<i>mode</i></code>.
</p>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Note:</strong> 
<ul>
<li>Kernel lockdown cannot be disabled at runtime.</li>
<li>Kernel lockdown disables <a href="../en/Power_management/Suspend_and_hibernate.html#Hibernation" class="mw-redirect" title="Hibernation">hibernation</a>.</li>
</ul>
</div>
<p>See also <span class="plainlinks archwiki-template-man" title="$ man 7 kernel_lockdown"><a rel="nofollow" class="external text" href="https://man.archlinux.org/man/kernel_lockdown.7">kernel_lockdown(7)</a></span>.
</p>
<h2><span class="mw-headline" id="Sandboxing_applications">Sandboxing applications</span></h2>
<p>See also <a href="https://en.wikipedia.org/wiki/Sandbox_(computer_security)" class="extiw" title="wikipedia:Sandbox (computer security)">Wikipedia:Sandbox (computer security)</a>.
</p>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Note:</strong> The user namespace configuration item <code>CONFIG_USER_NS</code> is currently enabled in <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=linux">linux</a></span> (4.14.5 or later), <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=linux-lts">linux-lts</a></span> (4.14.15 or later) and <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=linux-hardened">linux-hardened</a></span>. Lack of it may prevent certain sandboxing features from being made available to applications.</div>
<div class="archwiki-template-box archwiki-template-box-warning">
<strong>Warning:</strong> Unprivileged user namespace usage (<code>CONFIG_USER_NS_UNPRIVILEGED</code>) is enabled by default in <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=linux">linux</a></span> (5.1.8 or later), <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=linux-lts">linux-lts</a></span> (4.19.55-2 or later) and <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=linux-zen">linux-zen</a></span> (5.1.14.zen1-2 or later) unless the <code>kernel.unprivileged_userns_clone</code> <a href="../en/Sysctl.html" title="Sysctl">sysctl</a> is set to <code>0</code>. Since this greatly increases the attack surface for local privilege escalation, it is advised to disable this manually, or use the <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=linux-hardened">linux-hardened</a></span> kernel. For more information see <a rel="nofollow" class="external text" href="https://bugs.archlinux.org/task/36969">FS#36969</a>.</div>
<h3><span class="mw-headline" id="Firejail">Firejail</span></h3>
<p><a href="../en/Firejail.html" title="Firejail">Firejail</a> is an easy to use and simple tool for sandboxing applications and servers alike. Firejail is suggested for browsers and internet facing applications, as well as any servers you may be running.
</p>
<h3><span class="mw-headline" id="bubblewrap">bubblewrap</span></h3>
<p><a href="../en/Bubblewrap.html" title="Bubblewrap">bubblewrap</a> is a sandbox application developed from <a href="https://en.wikipedia.org/wiki/Flatpak" class="extiw" title="wikipedia:Flatpak">Flatpak</a> with an even smaller resource footprint than Firejail. While it lacks certain features such as file path whitelisting, bubblewrap does offer bind mounts as well as the creation of user/IPC/PID/network/cgroup namespaces and can support both simple and complex sandboxes.
</p>
<h3><span class="mw-headline" id="chroots">chroots</span></h3>
<p>Manual <a href="../en/Chroot.html" title="Chroot">chroot</a> jails can also be constructed.
</p>
<h3><span class="mw-headline" id="Linux_containers">Linux containers</span></h3>
<p><a href="../en/Linux_Containers.html" title="Linux Containers">Linux Containers</a> are another good option when you need more separation than the other options (short of KVM and VirtualBox) provide. LXC is run on top of the existing kernel in a pseudo-chroot with their own virtual hardware.
</p>
<h3><span class="mw-headline" id="Other_virtualization_options">Other virtualization options</span></h3>
<p>Using full virtualization options such as <a href="../en/VirtualBox.html" title="VirtualBox">VirtualBox</a>, <a href="../en/KVM.html" title="KVM">KVM</a>, <a href="../en/Xen.html" title="Xen">Xen</a> or <a rel="nofollow" class="external text" href="https://www.qubes-os.org/">Qubes OS</a> (based on Xen) can also improve isolation and security in the event you plan on running risky applications or browsing dangerous websites.
</p>
<h2><span class="mw-headline" id="Network_and_firewalls">Network and firewalls</span></h2>
<h3><span class="mw-headline" id="Firewalls">Firewalls</span></h3>
<p>While the stock Arch kernel is capable of using <a href="https://en.wikipedia.org/wiki/Netfilter" class="extiw" title="wikipedia:Netfilter">Netfilter</a>'s <a href="../en/Iptables.html" title="Iptables">iptables</a> and <a href="../en/Nftables.html" title="Nftables">nftables</a>, they are not enabled by default. It is highly recommended to set up some form of firewall to protect the services running on the system. Many resources (including ArchWiki) do not state explicitly which services are worth protecting, so enabling a firewall is a good precaution.
</p>
<ul>
<li>See <a href="../en/Iptables.html" title="Iptables">iptables</a> and <a href="../en/Nftables.html" title="Nftables">nftables</a> for general information.</li>
<li>See <a href="../en/Simple_stateful_firewall.html" title="Simple stateful firewall">Simple stateful firewall</a> for a guide on setting up an iptables firewall.</li>
<li>See <a href="../en/Category:Firewalls.html" title="Category:Firewalls">Category:Firewalls</a> for other ways of setting up netfilter.</li>
<li>See <a href="../en/Ipset.html" title="Ipset">Ipset</a> for blocking lists of ip addresses, such as those from Bluetack.</li>
</ul>
<h4><span class="mw-headline" id="Open_ports">Open ports</span></h4>
<div class="noprint archwiki-template-message">
<p><a href="../File:Tango-edit-clear.png" class="image"><img alt="Tango-edit-clear.png" src="../File:Tango-edit-clear.png" decoding="async" width="48" height="48"></a><b>This article or section needs language, wiki syntax or style improvements. See <a href="../en/Help:Style.html" title="Help:Style">Help:Style</a> for reference.</b><a href="../File:Tango-edit-clear.png" class="image"><img alt="Tango-edit-clear.png" src="../File:Tango-edit-clear.png" decoding="async" width="48" height="48"></a></p>
<div>
<b>Reason:</b> "Open ports" is not a good title since it disregards interfaces and addresses that the application may be bound to. From the firewalls' point of view, ports may be "open" even if no application listens on them at the moment. (Discuss in <a rel="nofollow" class="external text" href="https://wiki.archlinux.org/index.php/Talk:Security">Talk:Security#</a>)</div>
</div>
<p>Some services listen for inbound traffic on open network ports. It is important to only bind these services to the addresses and interfaces that are strictly necessary. It may be possible for a remote attacker to <a rel="nofollow" class="external text" href="https://samy.pl/slipstream/">exploit flawed network protocols to access exposed services</a>. This can even happen with <a rel="nofollow" class="external text" href="https://nvd.nist.gov/vuln/detail/CVE-2019-13450">processes bound to localhost</a>.
</p>
<p>In general, if a service only needs to be accessible to the local system, bind to a Unix domain socket (<span class="plainlinks archwiki-template-man" title="$ man 7 unix"><a rel="nofollow" class="external text" href="https://man.archlinux.org/man/unix.7">unix(7)</a></span>) or a loopback address such as <code>localhost</code> instead of a non-loopback address like <code>0.0.0.0/0</code>.
</p>
<p>If a service needs to be accessible to other systems via the network, control the access with strict <a href="../en/Category:Firewalls.html" class="mw-redirect" title="Firewall">firewall</a> rules and configure authentication, authorization and encryption whenever possible.
</p>
<p>You can list all current open ports with <code>ss -l</code>. To show all <b>l</b>istening <b>p</b>rocesses and their <b>n</b>umeric <b>t</b>cp and <b>u</b>dp port numbers:
</p>
<pre># ss -lpntu
</pre>
<p>See <span class="plainlinks archwiki-template-man" title="$ man 8 ss"><a rel="nofollow" class="external text" href="https://man.archlinux.org/man/ss.8">ss(8)</a></span> for more options.
</p>
<h3><span class="mw-headline" id="Kernel_parameters">Kernel parameters</span></h3>
<p>Kernel parameters which affect networking can be set using <a href="../en/Sysctl.html" title="Sysctl">Sysctl</a>. For how to do this, see <a href="../en/Sysctl.html#TCP/IP_stack_hardening" title="Sysctl">Sysctl#TCP/IP stack hardening</a>.
</p>
<h3><span class="mw-headline" id="SSH">SSH</span></h3>
<p>To mitigate <a href="https://en.wikipedia.org/wiki/Brute-force_attack" class="extiw" title="wikipedia:Brute-force attack">brute-force attacks</a> it is recommended to enforce key-based authentication. For OpenSSH, see <a href="../en/OpenSSH.html#Force_public_key_authentication" title="OpenSSH">OpenSSH#Force public key authentication</a>. Alternatively <a href="../en/Fail2ban.html" title="Fail2ban">Fail2ban</a> or <a href="../en/Sshguard.html" title="Sshguard">Sshguard</a> offer lesser forms of protection by monitoring logs and writing <a href="../en/Category:Firewalls.html" class="mw-redirect" title="Firewall">firewall</a> rules but open up the potential for a denial of service, since an attacker can <a href="https://en.wikipedia.org/wiki/Spoofing_attack#Spoofing_and_TCP.2FIP" class="extiw" title="wikipedia:Spoofing attack">spoof</a> packets as if they came from the administrator after identifying their address. Spoofing IP has lines of defense, such as by <a href="../en/Sysctl.html#Reverse_path_filtering" title="Sysctl">reverse path filtering</a> and <a href="../en/Sysctl.html#Disable_ICMP_redirects" title="Sysctl">disabling ICMP redirects</a>.
</p>
<p>You may want to harden authentication even more by using two-factor authentication. <a href="../en/Google_Authenticator.html" title="Google Authenticator">Google Authenticator</a> provides a two-step authentication procedure using one-time passcodes (OTP).
</p>
<p>Denying root login is also a good practice, both for tracing intrusions and adding an additional layer of security before root access. For OpenSSH, see <a href="../en/OpenSSH.html#Deny" title="OpenSSH">OpenSSH#Deny</a>.
</p>
<h3><span class="mw-headline" id="DNS">DNS</span></h3>
<p>The default domain name resolution (DNS) configuration is highly compatible but has security weaknesses. See <a href="../en/Domain_name_resolution.html#Privacy_and_security" title="Domain name resolution">DNS privacy and security</a> for more information.
</p>
<h3><span class="mw-headline" id="Proxies">Proxies</span></h3>
<p>Proxies are commonly used as an extra layer between applications and the network, sanitizing data from untrusted sources. The attack surface of a small proxy running with lower privileges is significantly smaller than a complex application running with the end user privileges.
</p>
<p>For example the DNS resolver is implemented in <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=glibc">glibc</a></span>, that is linked with the application (that may be running as root), so a bug in the DNS resolver might lead to a remote code execution. This can be prevented by installing a DNS caching server, such as <a href="../en/Dnsmasq.html" title="Dnsmasq">dnsmasq</a>, which acts as a proxy. <a rel="nofollow" class="external autonumber" href="https://googleonlinesecurity.blogspot.it/2016/02/cve-2015-7547-glibc-getaddrinfo-stack.html">[2]</a>
</p>
<h3><span class="mw-headline" id="Managing_SSL_certificates">Managing SSL certificates</span></h3>
<div class="noprint archwiki-template-message">
<p><a href="../File:Merge-arrows-2.png" class="image"><img alt="Merge-arrows-2.png" src="../File:Merge-arrows-2.png" decoding="async" width="48" height="48"></a><b>This article or section is a candidate for merging with <a href="../en/Transport_Layer_Security.html" title="Transport Layer Security">Transport Layer Security</a>.</b><a href="../File:Merge-arrows-2.png" class="image"><img alt="Merge-arrows-2.png" src="../File:Merge-arrows-2.png" decoding="async" width="48" height="48"></a></p>
<div>
<b>Notes:</b> There is a dedicated article. (Discuss in <a rel="nofollow" class="external text" href="https://wiki.archlinux.org/index.php/Talk:Security">Talk:Security#</a>)</div>
</div>
<p>See <a href="../en/OpenSSL.html" title="OpenSSL">OpenSSL</a> and <a href="../en/Network_Security_Services.html" title="Network Security Services">Network Security Services</a> (NSS) for managing custom server-side SSL certificates. Notably, the related <a href="../en/Certbot.html" class="mw-redirect" title="Let’s Encrypt">Let’s Encrypt</a> project is also supported. 
</p>
<p>The default internet SSL certificate trustchains are provided by the <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=ca-certificates">ca-certificates</a></span> package and its dependencies. Note that Arch relies on trust-sources (e.g. <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=ca-certificates-mozilla">ca-certificates-mozilla</a></span>) providing the certificates to be trusted per default by the system. 
</p>
<p>There may be occasions when you want to deviate from the default. For example, you may read some <a rel="nofollow" class="external text" href="https://www.theregister.co.uk/2016/05/27/blue_coat_ca_certs/">news</a> and want to distrust a certificate rather than wait until the trust-source providers do. The Arch infrastructure makes such easy:
</p>
<ol>
<li>Obtain the respective certificate in .crt format (Example: <a rel="nofollow" class="external text" href="https://crt.sh/?id=19538258">view</a>, <a rel="nofollow" class="external text" href="https://crt.sh/?d=19538258">download</a>; in case of an existing trusted root certificate authority, you may also find it extracted in the system path),</li>
<li>Copy it to <code>/etc/ca-certificates/trust-source/blacklist/</code> and</li>
<li>Run <code>update-ca-trust</code> as root.</li>
</ol>
<p>To check the blacklisting works as intended, you may re-open your preferred browser and do so via its GUI, which should show it as <b>untrusted</b> now.
</p>
<h2><span class="mw-headline" id="Physical_security">Physical security</span></h2>
<p>Physical access to a computer is root access given enough time and resources. However, a high <i>practical</i> level of security can be obtained by putting up enough barriers.
</p>
<p>An attacker can gain full control of your computer on the next boot by simply attaching a malicious IEEE 1394 (FireWire), Thunderbolt or PCI Express device as they are given full memory access.<a rel="nofollow" class="external autonumber" href="https://www.breaknenter.org/projects/inception/">[3]</a><sup title="Last check status: SSL error">[<a href="https://en.wikipedia.org/wiki/Wikipedia:Link_rot" class="extiw" title="wikipedia:Wikipedia:Link rot">dead link</a> 2020-04-03 ⓘ]</sup> There is little you can do from preventing this, or modification of the hardware itself - such as flashing malicious firmware onto a drive. However, the vast majority of attackers will not be this knowledgeable and determined.
</p>
<p><a href="#Data-at-rest_encryption">#Data-at-rest encryption</a> will prevent access to your data if the computer is stolen, but malicious firmware can be installed to obtain this data upon your next log in by a resourceful attacker.
</p>
<h3><span class="mw-headline" id="Locking_down_BIOS">Locking down BIOS</span></h3>
<p>Adding a password to the BIOS prevents someone from booting into removable media, which is basically the same as having root access to your computer. You should make sure your drive is first in the boot order and disable the other drives from being bootable if you can.
</p>
<h3><span class="mw-headline" id="Boot_loaders">Boot loaders</span></h3>
<p>It is highly important to protect your <a href="../en/Arch_boot_process.html#Boot_loader" class="mw-redirect" title="Boot loader">boot loader</a>. An unprotected boot loader can bypass any login restrictions, e.g. by setting the <code>init=/bin/sh</code> <a href="../en/Kernel_parameters.html" class="mw-redirect" title="Kernel parameter">kernel parameter</a> to boot directly to a shell.
</p>
<h4><span class="mw-headline" id="Syslinux">Syslinux</span></h4>
<p>Syslinux supports <a href="../en/Syslinux.html#Security" title="Syslinux">password-protecting your bootloader</a>. It allows you to set either a per-menu-item password or a global bootloader password.
</p>
<h4><span class="mw-headline" id="GRUB">GRUB</span></h4>
<p><a href="../en/GRUB.html" title="GRUB">GRUB</a> supports bootloader passwords as well. See <a href="../en/GRUB/Tips_and_tricks.html#Password_protection_of_GRUB_menu" title="GRUB/Tips and tricks">GRUB/Tips and tricks#Password protection of GRUB menu</a> for details. It also has support for <a href="../en/GRUB.html#Encrypted_/boot" title="GRUB">encrypted /boot</a>, which only leaves some parts of the bootloader code unencrypted. GRUB's configuration, <a href="../en/Kernel.html" title="Kernel">kernel</a> and <a href="../en/Arch_boot_process.html#initramfs" class="mw-redirect" title="Initramfs">initramfs</a> are encrypted.
</p>
<h3><span class="mw-headline" id="Secure_Boot">Secure Boot</span></h3>
<p><a href="../en/Unified_Extensible_Firmware_Interface/Secure_Boot.html" class="mw-redirect" title="Secure Boot">Secure Boot</a> is a feature of <a href="../en/Unified_Extensible_Firmware_Interface.html" class="mw-redirect" title="UEFI">UEFI</a> that allows authentication of the files your computer boots. This helps preventing some <a href="https://en.wikipedia.org/wiki/Evil_maid_attack" class="extiw" title="wikipedia:Evil maid attack">evil maid attacks</a> such as replacing files inside the boot partition. Normally computers come with keys that are enrolled by vendors (OEM). However these can be removed and allow the computer to enter <i>Setup Mode</i> which allows the user to enroll and manage their own keys.
</p>
<p>The secure boot page guides you through how to set secure boot up by <a href="../en/Unified_Extensible_Firmware_Interface/Secure_Boot.html#Using_your_own_keys" title="Unified Extensible Firmware Interface/Secure Boot">using your own keys</a>.
</p>
<h3>
<span id="Trusted_Platform_Module_.28TPM.29"></span><span class="mw-headline" id="Trusted_Platform_Module_(TPM)">Trusted Platform Module (TPM)</span>
</h3>
<p><a href="../en/Trusted_Platform_Module.html" title="Trusted Platform Module">TPMs</a> are hardware microprocessors which have cryptographic keys embedded. This forms the fundamental root of trust of most modern computers and allows end-to-end verification of the boot chain. They can be used as internal smartcards, attest the firmware running on the computer and allow users to insert secrets into a tamper-proof and brute-force resistant store.
</p>
<h3><span class="mw-headline" id="Boot_partition_on_removable_flash_drive">Boot partition on removable flash drive</span></h3>
<p>One popular idea is to place the boot partition on a flash drive in order to render the system unbootable without it. Proponents of this idea often use <a href="#Data-at-rest_encryption">full-disk encryption</a> alongside, and some also use <a href="../en/Dm-crypt/Specialties.html#Encrypted_system_using_a_detached_LUKS_header" title="Dm-crypt/Specialties">detached encryption headers</a> placed on the boot partition.
</p>
<p>This method can also be merged with <a href="../en/Dm-crypt/Specialties.html#Encrypted_/boot_and_a_detached_LUKS_header_on_USB" title="Dm-crypt/Specialties">encrypting /boot</a>.
</p>
<h3><span class="mw-headline" id="Automatic_logout">Automatic logout</span></h3>
<p>If you are using <a href="../en/Bash.html" title="Bash">Bash</a> or <a href="../en/Zsh.html" title="Zsh">Zsh</a>, you can set <code>TMOUT</code> for an automatic logout from shells after a timeout.
</p>
<p>For example, the following will automatically log out from virtual consoles (but not terminal emulators in X11):
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/profile.d/shell-timeout.sh</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">TMOUT="$(( 60*10 ))";
[ -z "$DISPLAY" ] &amp;&amp; export TMOUT;
case $( /usr/bin/tty ) in
	/dev/tty[0-9]*) export TMOUT;;
esac
</pre>
<p>If you really want EVERY Bash/Zsh prompt (even within X) to timeout, use:
</p>
<pre>$ export TMOUT="$(( 60*10 ))";
</pre>
<p>Note that this will not work if there is some command running in the shell (eg.: an SSH session or other shell without <code>TMOUT</code> support). But if you are using VC mostly for restarting frozen GDM/Xorg as root, then this is very useful.
</p>
<h3><span class="mw-headline" id="Protect_against_rogue_USB_devices">Protect against rogue USB devices</span></h3>
<p>Install <a href="../en/USBGuard.html" title="USBGuard">USBGuard</a>, which is a software framework that  helps to protect your computer against rogue USB devices (a.k.a. <a rel="nofollow" class="external text" href="https://srlabs.de/badusb">BadUSB</a>, <a rel="nofollow" class="external text" href="https://github.com/samyk/poisontap">PoisonTap</a> or <a rel="nofollow" class="external text" href="https://lanturtle.com/">LanTurtle</a>) by implementing basic whitelisting and blacklisting capabilities based on device attributes.
</p>
<h3><span class="mw-headline" id="Volatile_data_collection">Volatile data collection</span></h3>
<p>A computer that is powered on may be vulnerable to <a rel="nofollow" class="external text" href="https://fedvte.usalearning.gov/courses/CSI/course/videos/pdf/CSI_D01_S05_T01_STEP.pdf">volatile data collection</a>. It is a best practice to turn a computer completely off at times it is not necessary for it to be on, or if the computer's physical security is temporarily compromised (e.g. when passing through a security checkpoint).
</p>
<h2><span class="mw-headline" id="Packages">Packages</span></h2>
<h3><span class="mw-headline" id="Authentication">Authentication</span></h3>
<p><a rel="nofollow" class="external text" href="https://www2.cs.arizona.edu/stork/packagemanagersecurity/attacks-on-package-managers.html#overview">Attacks on package managers</a> are possible without proper use of package signing, and can affect even package managers with <a rel="nofollow" class="external text" href="https://www2.cs.arizona.edu/stork/packagemanagersecurity/faq.html">proper signature systems</a>. Arch uses package signing by default and relies on a web of trust from 5 trusted master keys. See <a href="../en/Pacman/Package_signing.html" class="mw-redirect" title="Pacman-key">Pacman-key</a> for details.
</p>
<h3><span class="mw-headline" id="Upgrades">Upgrades</span></h3>
<p>It is important to regularly <a href="../en/System_maintenance.html#Upgrading_the_system" title="System maintenance">upgrade the system</a>.
</p>
<h3><span class="mw-headline" id="Follow_vulnerability_alerts">Follow vulnerability alerts</span></h3>
<p>Subscribe to the Common Vulnerabilities and Exposure (CVE) Security Alert updates, made available by National Vulnerability Database, and found on the <a rel="nofollow" class="external text" href="https://nvd.nist.gov/download.cfm">NVD Download webpage</a>. The <a rel="nofollow" class="external text" href="https://security.archlinux.org/">Arch Linux Security Tracker</a> serves as a particularly useful resource in that it combines Arch Linux Security Advisory (ASA), Arch Linux Vulnerability Group (AVG) and CVE data sets in tabular format. See also <a href="../en/Arch_Security_Team.html" title="Arch Security Team">Arch Security Team</a>.
</p>
<p>You should also consider subscribing to the release notifications for software you use, especially if you install software through means other than the main repositories or AUR. Some software have mailing lists you can subscribe to for security notifications. Source code hosting sites often offer RSS feeds for new releases.
</p>
<h3><span class="mw-headline" id="Rebuilding_packages">Rebuilding packages</span></h3>
<p>Packages can be rebuilt and stripped of undesired functions and features as a means to reduce attack surface. For example, <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=bzip2">bzip2</a></span> can be rebuilt without <code>bzip2recover</code> in an attempt to circumvent <a rel="nofollow" class="external text" href="https://security.archlinux.org/CVE-2016-3189">CVE-2016-3189</a>. Custom hardening flags can also be applied either manually or via a wrapper.
</p>
<h2><span class="mw-headline" id="See_also">See also</span></h2>
<ul>
<li><a rel="nofollow" class="external text" href="https://security.archlinux.org/">Arch Linux Security Tracker</a></li>
<li><a rel="nofollow" class="external text" href="https://wiki.centos.org/HowTos/OS_Protection">CentOS Wiki: OS Protection</a></li>
<li><a rel="nofollow" class="external text" href="https://www.ibm.com/developerworks/linux/tutorials/l-harden-desktop/index.html">Hardening the Linux desktop</a></li>
<li><a rel="nofollow" class="external text" href="https://www.ibm.com/developerworks/linux/tutorials/l-harden-server/index.html">Hardening the Linux server</a></li>
<li><a rel="nofollow" class="external text" href="https://github.com/lfit/itpol/blob/master/linux-workstation-security.md">Linux Foundation: Linux workstation security checklist</a></li>
<li><a rel="nofollow" class="external text" href="https://www.privacytools.io/">privacytools.io Privacy Resources</a></li>
<li><a rel="nofollow" class="external text" href="https://access.redhat.com/documentation/en-US/Red_Hat_Enterprise_Linux/7/html/Security_Guide/">Red Hat Enterprise Linux 7 Security Guide</a></li>
<li><a rel="nofollow" class="external text" href="https://www.debian.org/doc/manuals/securing-debian-manual/index.en.html">Securing Debian Manual</a></li>
<li><a rel="nofollow" class="external text" href="https://web.archive.org/web/20140220055801/http://crunchbang.org:80/forums/viewtopic.php?id=24722">The paranoid #! Security Guide</a></li>
</ul>
</div>
</div>
<div id="catlinks" class="catlinks" data-mw="interface">
<div id="mw-normal-catlinks" class="mw-normal-catlinks">
<a href="../Special:Categories.html" title="Special:Categories">Categories</a>: <ul>
<li><a href="../en/Category:Security.html" title="Category:Security">Security</a></li>
<li><a href="../en/Category:File_systems.html" title="Category:File systems">File systems</a></li>
<li><a href="../en/Category:Networking.html" title="Category:Networking">Networking</a></li>
</ul>
</div>
<div id="mw-hidden-catlinks" class="mw-hidden-catlinks mw-hidden-cats-hidden">Hidden categories: <ul>
<li><a href="../en/Category:Pages_or_sections_flagged_with_Template:Expansion.html" title="Category:Pages or sections flagged with Template:Expansion">Pages or sections flagged with Template:Expansion</a></li>
<li><a href="../en/Category:Pages_or_sections_flagged_with_Template:Merge.html" title="Category:Pages or sections flagged with Template:Merge">Pages or sections flagged with Template:Merge</a></li>
<li><a href="../en/Category:Pages_or_sections_flagged_with_Template:Style.html" title="Category:Pages or sections flagged with Template:Style">Pages or sections flagged with Template:Style</a></li>
<li><a href="../en/Category:Pages_with_dead_links.html" title="Category:Pages with dead links">Pages with dead links</a></li>
</ul>
</div>
</div>
	</div>
</div>

<footer id="footer" class="mw-footer" role="contentinfo" style="margin: 0">
	<ul id="footer-info">
		<li>Retrieved from "<a dir="ltr" href="https://wiki.archlinux.org/index.php?title=Security&amp;oldid=648075">https://wiki.archlinux.org/index.php?title=Security&amp;oldid=648075</a>"</li>
		<li id="footer-info-lastmod"> This page was last edited on 3 January 2021, at 09:36.</li>
		<li id="footer-info-copyright">Content is available under <a class="external" rel="nofollow" href="http://www.gnu.org/copyleft/fdl.html">GNU Free Documentation License 1.3 or later</a> unless otherwise noted.</li>
	<br>
</ul>
	<ul id="footer-places">
		<li id="footer-places-privacy"><a href="../en/ArchWiki:Privacy_policy.html" title="ArchWiki:Privacy policy">Privacy policy</a></li>
		<li id="footer-places-about"><a href="../en/ArchWiki:About.html" title="ArchWiki:About">About ArchWiki</a></li>
		<li id="footer-places-disclaimer"><a href="../en/ArchWiki:General_disclaimer.html" title="ArchWiki:General disclaimer">Disclaimers</a></li>
	</ul>
	<ul id="footer-icons" class="noprint">
		<li id="footer-copyrightico">
	</ul>
	<div style="clear: both;"></div>
</footer>



</body>
</html>
