<!DOCTYPE html>
<html class="client-nojs" lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<title>Squid - ArchWiki</title>
<link rel="stylesheet" href="../ArchWikiOffline.css">
<meta name="ResourceLoaderDynamicStyles" content="">
<meta name="generator" content="MediaWiki 1.35.0">
<meta name="robots" content="noindex,follow">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="shortcut icon" href="/favicon.ico">
<link rel="search" type="application/opensearchdescription+xml" href="/opensearch_desc.php" title="ArchWiki (en)">
<link rel="EditURI" type="application/rsd+xml" href="https://wiki.archlinux.org/api.php?action=rsd">
<link rel="license" href="http://www.gnu.org/copyleft/fdl.html">
<link rel="alternate" type="application/atom+xml" title="ArchWiki Atom feed" href="/index.php?title=Special:RecentChanges&amp;feed=atom">
</head>
<body class="mediawiki ltr sitedir-ltr mw-hide-empty-elt ns-0 ns-subject page-Squid rootpage-Squid skin-vector action-view skin-vector-legacy">
<div id="content" class="mw-body" role="main" style="margin: 0">
	<a id="top"></a>
	<div id="siteNotice" class="mw-body-content"></div>
	<div class="mw-indicators mw-body-content">
	</div>
	<h1 id="firstHeading" class="firstHeading" lang="en">Squid</h1>
	<div id="bodyContent" class="mw-body-content">
		<div id="siteSub" class="noprint">From ArchWiki</div>
		<div id="contentSub"></div>
		<div id="contentSub2"></div>
		
		<div id="jump-to-nav"></div>
		<a class="mw-jump-link" href="#mw-head">Jump to navigation</a>
		<a class="mw-jump-link" href="#searchInput">Jump to search</a>
		<div id="mw-content-text" lang="en" dir="ltr" class="mw-content-ltr">
<div class="warningbox">The printable version is no longer supported and may have rendering errors. Please update your browser bookmarks and please use the default browser print function instead.</div>
<div class="mw-parser-output">
<div class="noprint archwiki-template-message">
<p><a href="../File:Tango-edit-clear.png" class="image"><img alt="Tango-edit-clear.png" src="../File:Tango-edit-clear.png" decoding="async" width="48" height="48"></a><b>This article or section needs language, wiki syntax or style improvements. See <a href="../en/Help:Style.html" title="Help:Style">Help:Style</a> for reference.</b><a href="../File:Tango-edit-clear.png" class="image"><img alt="Tango-edit-clear.png" src="../File:Tango-edit-clear.png" decoding="async" width="48" height="48"></a></p>
<div>
<b>Reason:</b> bad style (Discuss in <a rel="nofollow" class="external text" href="https://wiki.archlinux.org/index.php/Talk:Squid">Talk:Squid#</a>)</div>
</div>
<p><a rel="nofollow" class="external text" href="http://www.squid-cache.org">Squid</a> is a caching proxy for HTTP, HTTPS and FTP, providing extensive access controls.
</p>
<div id="toc" class="toc" role="navigation" aria-labelledby="mw-toc-heading">
<input type="checkbox" role="button" id="toctogglecheckbox" class="toctogglecheckbox" style="display:none"><div class="toctitle" lang="en" dir="ltr">
<h2 id="mw-toc-heading">Contents</h2>
<span class="toctogglespan"><label class="toctogglelabel" for="toctogglecheckbox"></label></span>
</div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Installation"><span class="tocnumber">1</span> <span class="toctext">Installation</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#Configuration"><span class="tocnumber">2</span> <span class="toctext">Configuration</span></a></li>
<li class="toclevel-1 tocsection-3"><a href="#Accessing_services_on_local_hostnames"><span class="tocnumber">3</span> <span class="toctext">Accessing services on local hostnames</span></a></li>
<li class="toclevel-1 tocsection-4"><a href="#Starting"><span class="tocnumber">4</span> <span class="toctext">Starting</span></a></li>
<li class="toclevel-1 tocsection-5"><a href="#Content_Filtering"><span class="tocnumber">5</span> <span class="toctext">Content Filtering</span></a></li>
<li class="toclevel-1 tocsection-6">
<a href="#Frontend"><span class="tocnumber">6</span> <span class="toctext">Frontend</span></a>
<ul>
<li class="toclevel-2 tocsection-7"><a href="#Squid_4.x_not_supported_in_Webmin"><span class="tocnumber">6.1</span> <span class="toctext">Squid 4.x not supported in Webmin</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-8">
<a href="#Ad_blocking_with_adzapper"><span class="tocnumber">7</span> <span class="toctext">Ad blocking with adzapper</span></a>
<ul>
<li class="toclevel-2 tocsection-9"><a href="#Installation_2"><span class="tocnumber">7.1</span> <span class="toctext">Installation</span></a></li>
<li class="toclevel-2 tocsection-10"><a href="#Configuration_2"><span class="tocnumber">7.2</span> <span class="toctext">Configuration</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-11">
<a href="#Transparent_web_proxy"><span class="tocnumber">8</span> <span class="toctext">Transparent web proxy</span></a>
<ul>
<li class="toclevel-2 tocsection-12"><a href="#iptables"><span class="tocnumber">8.1</span> <span class="toctext">iptables</span></a></li>
<li class="toclevel-2 tocsection-13"><a href="#Shorewall"><span class="tocnumber">8.2</span> <span class="toctext">Shorewall</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-14">
<a href="#HTTP_Authentication"><span class="tocnumber">9</span> <span class="toctext">HTTP Authentication</span></a>
<ul>
<li class="toclevel-2 tocsection-15"><a href="#NTLM"><span class="tocnumber">9.1</span> <span class="toctext">NTLM</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-16"><a href="#Hide_Browser%E2%80%99s_Real_IP_Address"><span class="tocnumber">10</span> <span class="toctext">Hide Browserâ€™s Real IP Address</span></a></li>
<li class="toclevel-1 tocsection-17">
<a href="#SSL_Bumping"><span class="tocnumber">11</span> <span class="toctext">SSL Bumping</span></a>
<ul>
<li class="toclevel-2 tocsection-18"><a href="#Create_Self-Signed_Root_CA_Certificate"><span class="tocnumber">11.1</span> <span class="toctext">Create Self-Signed Root CA Certificate</span></a></li>
<li class="toclevel-2 tocsection-19"><a href="#Create_a_DER-encoded_certificate_to_import_into_users'_browsers"><span class="tocnumber">11.2</span> <span class="toctext">Create a DER-encoded certificate to import into users' browsers</span></a></li>
<li class="toclevel-2 tocsection-20"><a href="#Modify_Squid_Configuration_File"><span class="tocnumber">11.3</span> <span class="toctext">Modify Squid Configuration File</span></a></li>
<li class="toclevel-2 tocsection-21"><a href="#Create_and_initialize_TLS_certificates_cache_directory"><span class="tocnumber">11.4</span> <span class="toctext">Create and initialize TLS certificates cache directory</span></a></li>
<li class="toclevel-2 tocsection-22"><a href="#Finally,_Restart_Squid_then_SSL_Bump_will_work"><span class="tocnumber">11.5</span> <span class="toctext">Finally, Restart Squid then SSL Bump will work</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-23">
<a href="#Troubleshooting"><span class="tocnumber">12</span> <span class="toctext">Troubleshooting</span></a>
<ul>
<li class="toclevel-2 tocsection-24"><a href="#Squid_needs_to_be_restarted_after_boot"><span class="tocnumber">12.1</span> <span class="toctext">Squid needs to be restarted after boot</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-25"><a href="#Additional_Resources"><span class="tocnumber">13</span> <span class="toctext">Additional Resources</span></a></li>
</ul>
</div>

<h2><span class="mw-headline" id="Installation">Installation</span></h2>
<p><a href="../en/Help:Reading.html#Installation_of_packages" class="mw-redirect" title="Install">Install</a> the <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=squid">squid</a></span> package.
</p>
<h2><span class="mw-headline" id="Configuration">Configuration</span></h2>
<p>By default, the cache directories will be created in <code>/var/cache/squid</code>, and the appropriate permissions set up for those directories. However, for greater control, we need to delve into <code>/etc/squid/squid.conf</code>.
</p>
<p>The following options might be of some use to you. If you do not have the option present in your configuration file, add it!
</p>
<ul><li>
<code>http_port</code> - Sets the port that Squid binds to on your local machine. You can have Squid bind to multiple ports by specifying multiple <code>http_port</code> lines. By default, Squid binds to port 3128.</li></ul>
<pre>http_port 3128
http_port 3129
</pre>
<ul><li>
<code>http_access</code> - This is an access control list for who is allowed to use the proxy. By default only localhost is allowed to access the proxy. For testing purposes, you may want to change the option <code>http_access deny all</code> to <code>http_access allow all</code>, which will allow anyone to connect to your proxy. If you wanted to just allow access to your subnet, you can do:</li></ul>
<pre>acl ip_acl src 192.168.1.0/24
http_access allow ip_acl
http_access deny all
</pre>
<ul><li>
<code>cache_mgr</code> - This is the email address of the cache manager.</li></ul>
<pre>cache_mgr squid.admin@example.com
</pre>
<ul><li>
<code>shutdown_lifetime</code> - Specifies how long Squid should wait when its service is asked to stop. If you are running squid on your desktop PC, you may want to set this to something short.</li></ul>
<pre>shutdown_lifetime 10 seconds
</pre>
<ul><li>
<code>cache_mem</code> - This is how much memory you want Squid to use to keep objects in memory rather than writing them to disk. Squid's total memory usage will exceed this! By default this is 8MB, so you might want to increase it if you have lots of RAM available.</li></ul>
<pre>cache_mem 64 MB
</pre>
<ul><li>
<code>visible_hostname</code> - hostname that will be shown in status/error messages</li></ul>
<pre>visible_hostname cerberus
</pre>
<ul>
<li>
<code>cache_peer</code> - If you want your Squid to go through another proxy server, rather than directly out to the Internet, you need to specify it here.</li>
<li>
<code>login</code> - Use this option if the parent proxy requires authentication.</li>
<li>
<code>never_direct</code> - Tells the cache to never go direct to the internet to retrieve a page. You will want this if you have set the option above.</li>
</ul>
<pre>cache_peer 10.1.1.100 parent 8080 0 no-query default login=user:password
never_direct allow all
</pre>
<ul><li>
<code>maximum_object_size</code> - The largest size of a cached object. By default this is 4 MB, so if you have a lot of disk space you will want to increase the size of it to something reasonable.</li></ul>
<pre>maximum_object_size 10 MB
</pre>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Note:</strong> After defining a new cache_dir it maybe necessary to initialize the caches directory structure with this command: <code>squid -zN</code> -z for Create missing swap directories and -N for No daemon mode. </div>
<ul><li>
<code>cache_dir</code> - This is your cache directory, where all the cached files are stored. There are many options here, but the format should generally go like:</li></ul>
<pre>cache_dir &lt;storage type&gt; &lt;directory&gt; &lt;size in MB&gt; 16 256
</pre>
<p>So, in the case of a school's internet proxy:
</p>
<pre>cache_dir diskd /cache0 200000 16 256
</pre>
<p>If you change the cache directory from defaults, you must set the correct permissions on the cache directory before starting Squid, else it will not be able to create its cache directories and will fail to start.
</p>
<h2><span class="mw-headline" id="Accessing_services_on_local_hostnames">Accessing services on local hostnames</span></h2>
<p>If you plan to access web servers on the LAN using hostnames that are not fully-defined (e.g. <a rel="nofollow" class="external free" href="http://mywebapp">http://mywebapp</a>), you may need to enable the <code>dns_defnames</code> option.  Without this option, Squid will make a DNS request for the hostname verbatim (<code>mywebapp</code>), which may fail, depending on your LAN's DNS setup.  With the option enabled, Squid will append any domain configured in <code>/etc/resolv.conf</code> when making the request (e.g. <code>mywebapp.company.local</code>).
</p>
<pre>dns_defnames on
</pre>
<h2><span class="mw-headline" id="Starting">Starting</span></h2>
<p>Once you have finished your configuration, you should check that your configuration file is correct:
</p>
<pre># squid -k check
</pre>
<p>Then create your cache directories:
</p>
<pre># squid -z
</pre>
<p>Then you can <a href="../en/Systemd.html#Using_units" class="mw-redirect" title="Start/enable">start/enable</a> <code>squid.service</code>.
</p>
<h2><span class="mw-headline" id="Content_Filtering">Content Filtering</span></h2>
<p>If you are looking for a content filtering solution to work with Squid, you should check out the very powerful <a href="../en/DansGuardian.html" title="DansGuardian">DansGuardian</a>.
</p>
<h2><span class="mw-headline" id="Frontend">Frontend</span></h2>
<p>If you would like a web-based frontend for managing Squid, <a href="../en/Webmin.html" title="Webmin">Webmin</a> is your best bet.
</p>
<h3><span class="mw-headline" id="Squid_4.x_not_supported_in_Webmin">Squid 4.x not supported in Webmin</span></h3>
<p>If you receive an error indicating your version of webmin is unsupported:
</p>
<pre>Your version of Squid is not supported by Webmin. Only versions from 1.1 to 3.4 are supported by this module.
</pre>
<p>you will need to modify the file <code>/opt/webmin/squid/index.cgi</code> (<a rel="nofollow" class="external text" href="https://github.com/webmin/webmin/issues/952">see issue #952</a>)
</p>
<h2><span class="mw-headline" id="Ad_blocking_with_adzapper">Ad blocking with adzapper</span></h2>
<p>Adzapper is a plugin for Squid. It catches ads of all sorts (even Flash animations) and replaces them with an image of your choice, so the layout of the page is not altered very much. 
</p>
<h3><span class="mw-headline" id="Installation_2">Installation</span></h3>
<p>AdZapper is not presently in the official repositories or the AUR. The script itself, and detailed information on configuration and usage, can be found at <a rel="nofollow" class="external free" href="http://adzapper.sourceforge.net">http://adzapper.sourceforge.net</a>.
</p>
<h3><span class="mw-headline" id="Configuration_2">Configuration</span></h3>
<pre>echo "redirect_program /usr/bin/adzapper.wrapper" &gt;&gt; /etc/squid/squid.conf
</pre>
<p>(squid 2.6.STABLE13-1)
</p>
<pre>echo "url_rewrite_program /usr/bin/adzapper.wrapper" &gt;&gt; /etc/squid/squid.conf
echo "url_rewrite_children 10" &gt;&gt; /etc/squid/squid.conf
</pre>
<p>If you want, you can edit <code>/etc/adzapper/adzapper.conf</code> to configure adzapper to your liking. The configuration out of the box works wonderfully well though.
</p>
<h2><span class="mw-headline" id="Transparent_web_proxy">Transparent web proxy</span></h2>
<p>Transparency happens by redirecting all www requests eth0 picks up, to Squid. You will need to add a port with an <code>intercept</code> (for squid 3.2) parameter.  Note that at least one port must be available without the intercept parameter:
</p>
<pre> http_port 3128
 http_port 3129 <b>intercept</b>
</pre>
<h3><span class="mw-headline" id="iptables">iptables</span></h3>
<p>From a terminal with root privileges, run: 
</p>
<pre># gid=`id -g proxy`
# iptables -t nat -A OUTPUT -p tcp --dport 80 -m owner --gid-owner $gid -j ACCEPT
# iptables -t nat -A OUTPUT -p tcp --dport 80 -j DNAT --to-destination SQUIDIP:3129
# iptables-save &gt; /etc/iptables/iptables.rules
</pre>
<p>Then <a href="../en/Systemd.html#Using_units" class="mw-redirect" title="Start">start</a> the <code>iptables.service</code> systemd unit.
</p>
<p>Replace SQUIDIP with the public IP(s) which squid may use for its listening port and outbound connections.
</p>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Note:</strong> If you are using a content filtering solution, you should put the port for it, not the Squid port, and you need to remove the <code>intercept</code> option in the http_port line.</div>
<h3><span class="mw-headline" id="Shorewall">Shorewall</span></h3>
<p><a href="../en/Systemd.html#Editing_provided_units" class="mw-redirect" title="Edit">Edit</a> <code>/etc/shorewall/rules</code> and add
</p>
<pre>REDIRECT	loc	3129	tcp	www # redirect to Squid on port 3128
ACCEPT		$FW	net	tcp	www # allow Squid to fetch the www content
</pre>
<p>Restart the <code>shorewall</code> systemd unit.
</p>
<h2><span class="mw-headline" id="HTTP_Authentication">HTTP Authentication</span></h2>
<p>Squid can be configured to require a user and password in order to use it. We will use <a href="https://en.wikipedia.org/wiki/Digest_access_authentication" class="extiw" title="wikipedia:Digest access authentication">digest http auth</a>
</p>
<p>First create a users file with <code>htdigest -c /etc/squid/users MyRealm username</code>. Enter a password when prompted.
</p>
<p>Then add these lines to your <code>squid.conf</code>:
</p>
<pre>   auth_param digest program /usr/lib/squid/digest_file_auth -c /etc/squid/users
   auth_param digest children 5
   auth_param digest realm MyRealm
   
   acl users proxy_auth REQUIRED
   http_access allow users
</pre>
<p>And restart squid. Now you will be prompted to enter a username and password when accessing the proxy.
</p>
<p>You can add more users with <code>htdigest /etc/squid/users MyRealm newuser</code>. You probably would like to install Apache package, which contains <code>htdigest</code> tool.
</p>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Note:</strong> Be aware that <code>http_access</code> rules cascade, so you need to set them in the desired order.</div>
<h3><span class="mw-headline" id="NTLM">NTLM</span></h3>
<div class="archwiki-template-box archwiki-template-box-warning">
<strong>Warning:</strong> NTLM is deprecated and has security problems.</div>
<p>Set up <a href="../en/Samba.html" title="Samba">samba</a> and winbindd and test it with
</p>
<pre> ntlm_auth --username=DOMAIN\\user
</pre>
<p>Grant r-x access to /var/cache/samba/winbindd_privileged/ directory for squid user/group
</p>
<p>Then add something like this to squid.conf:
</p>
<pre> auth_param ntlm program /usr/bin/ntlm_auth --helper-protocol=squid-2.5-ntlmssp
 auth_param ntlm children 5
 auth_param ntlm max_challenge_reuses 0
 auth_param ntlm max_challenge_lifetime 2 minutes
 auth_param ntlm keep_alive off
</pre>
<pre> acl ntlm_users proxy_auth REQUIRED
 http_access allow ntlm_users
 http_access deny all
</pre>
<h2>
<span id="Hide_Browser.E2.80.99s_Real_IP_Address"></span><span class="mw-headline" id="Hide_Browserâ€™s_Real_IP_Address">Hide Browserâ€™s Real IP Address</span>
</h2>
<p>Reference: <a rel="nofollow" class="external text" href="https://www.cyberciti.biz/faq/squid-proxy-is-not-hiding-client-ip-address/">Squid Proxy Hide Systemâ€™s Real IP Address</a>
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/squid/squid.conf</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;"># Hide client ip
forwarded_for delete
 
# Turn off via header
via off
 
# Deny request for original source of a request
follow_x_forwarded_for deny all
request_header_access X-Forwarded-For deny all</pre>
<h2><span class="mw-headline" id="SSL_Bumping">SSL Bumping</span></h2>
<p>Reference: <a rel="nofollow" class="external text" href="https://wiki.squid-cache.org/ConfigExamples/Intercept/SslBumpExplicit">Intercept HTTPS CONNECT messages with SSL-Bump</a>
</p>
<h3><span class="mw-headline" id="Create_Self-Signed_Root_CA_Certificate">Create Self-Signed Root CA Certificate</span></h3>
<p><code>cd /etc/squid</code>
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">openssl req -new -newkey rsa:2048 -sha256 -days 3650 -nodes -x509 -extensions v3_ca -keyout myCA.pem -out myCA.pem</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">Generating a 2048 bit RSA private key                                                                                                                                                               
.....+++                                                                                                                                                                                            
.............................................................................................................................................+++                                                    
writing new private key to 'myCA.pem'                                                                                                                                                               
<hr>                                                                                                                                                                                               
You are about to be asked to enter information that will be incorporated                              
into your certificate request.                                                                                                                                                                       
What you are about to enter is what is called a Distinguished Name or a DN.                                                                                                                          
There are quite a few fields but you can leave some blank                                                                                                                                            
For some fields there will be a default value,                                                                                                                                                       
If you enter '.', the field will be left blank.                                                                                                                                                      
<hr>                                                                                                                                                                                        
Country Name (2 letter code) [AU]:US
State or Province Name (full name) [Some-State]:Illinois
Locality Name (eg, city) []:Chicago
Organization Name (eg, company) [Internet Widgits Pty Ltd]:Example Company LTD.
Organizational Unit Name (eg, section) []:Information Technology
Common Name (e.g. server FQDN or YOUR name) []:Example Company LTD.
Email Address []:</pre>
<h3>
<span id="Create_a_DER-encoded_certificate_to_import_into_users.27_browsers"></span><span class="mw-headline" id="Create_a_DER-encoded_certificate_to_import_into_users'_browsers">Create a DER-encoded certificate to import into users' browsers</span>
</h3>
<p><code>openssl x509 -in myCA.pem -outform DER -out myCA.der</code>
</p>
<p>The result file (myCA.der) should be imported into the 'Authorities' section of users' browsers.
For example, in FireFox:
</p>
<pre>   Open 'Preferences'
   Go to the 'Privacy and Security' section
   Press the 'View Certificates' button and go to the 'Authorities' tab
   Press the 'Import' button, select the .der file that was created previously and pres 'OK'
</pre>
<h3><span class="mw-headline" id="Modify_Squid_Configuration_File">Modify Squid Configuration File</span></h3>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/squid/squid.conf</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">http_port 3128 ssl-bump tls-cert=/etc/squid/myCA.pem generate-host-certificates=on dynamic_cert_mem_cache_size=4MB options=NO_SSLv3,NO_TLSv1,NO_TLSv1_1,SINGLE_DH_USE,SINGLE_ECDH_USE
ssl_bump stare all
ssl_bump bump all</pre>
<h3><span class="mw-headline" id="Create_and_initialize_TLS_certificates_cache_directory">Create and initialize TLS certificates cache directory</span></h3>
<p><code>/usr/lib/squid/security_file_certgen  -c -s /var/cache/squid/ssl_db -M 4MB</code>
</p>
<h3>
<span id="Finally.2C_Restart_Squid_then_SSL_Bump_will_work"></span><span class="mw-headline" id="Finally,_Restart_Squid_then_SSL_Bump_will_work">Finally, Restart Squid then SSL Bump will work</span>
</h3>
<p><code>systemctl restart squid</code>
</p>
<h2><span class="mw-headline" id="Troubleshooting">Troubleshooting</span></h2>
<h3><span class="mw-headline" id="Squid_needs_to_be_restarted_after_boot">Squid needs to be restarted after boot</span></h3>
<p>If you are using both squid and NetworkManager, the following error means that squid is launched before the wifi connection is enabled by NetworkManager (<code>/etc/resolv.conf</code> is empty).
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/var/log/squid/cache.log</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">Warning: Could not find any nameservers. Trying to use localhost 
Please check your /etc/resolv.conf file
or use the 'dns_nameservers' option in squid.conf.</pre>
<p>You can:
</p>
<ul>
<li>Enable <a href="../en/NetworkManager.html#Enable_NetworkManager_Wait_Online" title="NetworkManager">NetworkManager-wait-online.service</a> systemd unit.</li>
<li>Using <a href="../en/NetworkManager.html#Network_services_with_NetworkManager_dispatcher" title="NetworkManager">NetworkManager dispatcher</a> instead of systemd to start squid</li>
</ul>
<p><a href="../en/Systemd.html#Using_units" class="mw-redirect" title="Disable">Disable</a> the <code>squid.service</code> systemd unit.
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/NetworkManager/dispatcher.d/10_squid</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">if test "$1" = 'wlp2s0'
then
    if test "$2" = 'up'
    then
        systemctl start squid
    else
        systemctl stop squid
    fi
fi</pre>
<p><code>sudo chmod u+x /etc/NetworkManager/dispatcher.d/10_squid</code>
</p>
<h2><span class="mw-headline" id="Additional_Resources">Additional Resources</span></h2>
<ul><li>
<a rel="nofollow" class="external text" href="https://archive.is/oOdiT">Elite Proxy Config Example(cached)</a> (<a rel="nofollow" class="external text" href="https://web.archive.org/web/20130425134032/http://gotux.net/arch-linux/squid-proxy-server/">cache-two</a>)</li></ul>
</div>
</div>
<div id="catlinks" class="catlinks" data-mw="interface">
<div id="mw-normal-catlinks" class="mw-normal-catlinks">
<a href="../Special:Categories.html" title="Special:Categories">Category</a>: <ul><li><a href="../en/Category:Proxy_servers.html" title="Category:Proxy servers">Proxy servers</a></li></ul>
</div>
<div id="mw-hidden-catlinks" class="mw-hidden-catlinks mw-hidden-cats-hidden">Hidden category: <ul><li><a href="../en/Category:Pages_or_sections_flagged_with_Template:Style.html" title="Category:Pages or sections flagged with Template:Style">Pages or sections flagged with Template:Style</a></li></ul>
</div>
</div>
	</div>
</div>

<footer id="footer" class="mw-footer" role="contentinfo" style="margin: 0">
	<ul id="footer-info">
		<li>Retrieved from "<a dir="ltr" href="https://wiki.archlinux.org/index.php?title=Squid&amp;oldid=645864">https://wiki.archlinux.org/index.php?title=Squid&amp;oldid=645864</a>"</li>
		<li id="footer-info-lastmod"> This page was last edited on 18 December 2020, at 10:21.</li>
		<li id="footer-info-copyright">Content is available under <a class="external" rel="nofollow" href="http://www.gnu.org/copyleft/fdl.html">GNU Free Documentation License 1.3 or later</a> unless otherwise noted.</li>
	<br>
</ul>
	<ul id="footer-places">
		<li id="footer-places-privacy"><a href="../en/ArchWiki:Privacy_policy.html" title="ArchWiki:Privacy policy">Privacy policy</a></li>
		<li id="footer-places-about"><a href="../en/ArchWiki:About.html" title="ArchWiki:About">About ArchWiki</a></li>
		<li id="footer-places-disclaimer"><a href="../en/ArchWiki:General_disclaimer.html" title="ArchWiki:General disclaimer">Disclaimers</a></li>
	</ul>
	<ul id="footer-icons" class="noprint">
		<li id="footer-copyrightico">
	</ul>
	<div style="clear: both;"></div>
</footer>



</body>
</html>
