<!DOCTYPE html>
<html class="client-nojs" lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<title>Lenovo ThinkPad T470s - ArchWiki</title>
<link rel="stylesheet" href="../ArchWikiOffline.css">
<meta name="ResourceLoaderDynamicStyles" content="">
<meta name="generator" content="MediaWiki 1.35.0">
<meta name="referrer" content="no-referrer-when-downgrade">
<meta name="robots" content="noindex,follow">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="shortcut icon" href="/favicon.ico">
<link rel="search" type="application/opensearchdescription+xml" href="/opensearch_desc.php" title="ArchWiki (en)">
<link rel="EditURI" type="application/rsd+xml" href="https://wiki.archlinux.org/api.php?action=rsd">
<link rel="license" href="http://www.gnu.org/copyleft/fdl.html">
<link rel="alternate" type="application/atom+xml" title="ArchWiki Atom feed" href="/index.php?title=Special:RecentChanges&amp;feed=atom">
</head>
<body class="mediawiki ltr sitedir-ltr mw-hide-empty-elt ns-0 ns-subject page-Lenovo_ThinkPad_T470s rootpage-Lenovo_ThinkPad_T470s skin-vector action-view skin-vector-legacy">
<div id="content" class="mw-body" role="main" style="margin: 0">
	<a id="top"></a>
	<div id="siteNotice" class="mw-body-content"></div>
	<div class="mw-indicators mw-body-content">
	</div>
	<h1 id="firstHeading" class="firstHeading" lang="en">Lenovo ThinkPad T470s</h1>
	<div id="bodyContent" class="mw-body-content">
		<div id="siteSub" class="noprint">From ArchWiki</div>
		<div id="contentSub"></div>
		<div id="contentSub2"></div>
		
		<div id="jump-to-nav"></div>
		<a class="mw-jump-link" href="#mw-head">Jump to navigation</a>
		<a class="mw-jump-link" href="#searchInput">Jump to search</a>
		<div id="mw-content-text" lang="en" dir="ltr" class="mw-content-ltr">
<div class="warningbox">The printable version is no longer supported and may have rendering errors. Please update your browser bookmarks and please use the default browser print function instead.</div>
<div class="mw-parser-output">
<div class="noprint archwiki-template-message">
<p><a href="../File:Tango-edit-clear.png" class="image"><img alt="Tango-edit-clear.png" src="../File:Tango-edit-clear.png" decoding="async" width="48" height="48"></a><b>This article or section does not follow the <a href="../en/Help:Laptop_page_guidelines.html" title="Help:Laptop page guidelines">Laptop page guidelines</a>.</b><a href="../File:Tango-edit-clear.png" class="image"><img alt="Tango-edit-clear.png" src="../File:Tango-edit-clear.png" decoding="async" width="48" height="48"></a></p>
<div>
<b>Reason:</b> Stub (Discuss in <a rel="nofollow" class="external text" href="https://wiki.archlinux.org/index.php/Talk:Lenovo_ThinkPad_T470s">Talk:Lenovo ThinkPad T470s#</a>)</div>
</div>
<table class="wikitable" style="float: right;">
<tbody>
<tr>
<th>Device</th>
<th>Working?
</th>
</tr>
<tr>
<td><a href="../en/Intel_graphics.html" title="Intel graphics">Intel graphics</a></td>
<td data-sort-value="5" style="background: #afa; color: inherit; vertical-align: middle; text-align: center;">Yes
</td>
</tr>
<tr>
<td><a href="../en/Network_configuration/Wireless.html" class="mw-redirect" title="Wireless">Wireless</a></td>
<td data-sort-value="5" style="background: #afa; color: inherit; vertical-align: middle; text-align: center;">Yes
</td>
</tr>
<tr>
<td>Mobile Broadband</td>
<td data-sort-value="5" style="background: #afa; color: inherit; vertical-align: middle; text-align: center;">Yes
</td>
</tr>
<tr>
<td><a href="../en/Advanced_Linux_Sound_Architecture.html" class="mw-redirect" title="ALSA">ALSA</a></td>
<td data-sort-value="5" style="background: #afa; color: inherit; vertical-align: middle; text-align: center;">Yes
</td>
</tr>
<tr>
<td><a href="../en/TrackPoint.html" title="TrackPoint">TrackPoint</a></td>
<td data-sort-value="5" style="background: #afa; color: inherit; vertical-align: middle; text-align: center;">Yes
</td>
</tr>
<tr>
<td><a href="../en/Laptop.html#Touchpad" class="mw-redirect" title="Touchpad">Touchpad</a></td>
<td data-sort-value="5" style="background: #afa; color: inherit; vertical-align: middle; text-align: center;">Yes
</td>
</tr>
<tr>
<td>Smartcard Reader</td>
<td data-sort-value="5" style="background: #afa; color: inherit; vertical-align: middle; text-align: center;">Yes
</td>
</tr>
<tr>
<td><a href="../en/Bluetooth.html" title="Bluetooth">Bluetooth</a></td>
<td data-sort-value="5" style="background: #afa; color: inherit; vertical-align: middle; text-align: center;">Yes
</td>
</tr>
<tr>
<td>Fingerprint Reader</td>
<td data-sort-value="5" style="background: #afa; color: inherit; vertical-align: middle; text-align: center;">Yes
</td>
</tr>
</tbody>
</table>
<p>This article covers the installation and configuration of Arch Linux on a Lenovo T470s laptop.
</p>
<p>For a general overview of laptop-related articles and recommendations, see <a href="../en/Laptop.html" title="Laptop">Laptop</a>.
</p>
<div id="toc" class="toc" role="navigation" aria-labelledby="mw-toc-heading">
<input type="checkbox" role="button" id="toctogglecheckbox" class="toctogglecheckbox" style="display:none"><div class="toctitle" lang="en" dir="ltr">
<h2 id="mw-toc-heading">Contents</h2>
<span class="toctogglespan"><label class="toctogglelabel" for="toctogglecheckbox"></label></span>
</div>
<ul>
<li class="toclevel-1 tocsection-1">
<a href="#Firmware"><span class="tocnumber">1</span> <span class="toctext">Firmware</span></a>
<ul>
<li class="toclevel-2 tocsection-2">
<a href="#Updating_the_BIOS"><span class="tocnumber">1.1</span> <span class="toctext">Updating the BIOS</span></a>
<ul>
<li class="toclevel-3 tocsection-3"><a href="#Via_a_USB_key"><span class="tocnumber">1.1.1</span> <span class="toctext">Via a USB key</span></a></li>
<li class="toclevel-3 tocsection-4"><a href="#Using_fwupd"><span class="tocnumber">1.1.2</span> <span class="toctext">Using fwupd</span></a></li>
</ul>
</li>
</ul>
</li>
<li class="toclevel-1 tocsection-5"><a href="#Kernel_and_hardware_support"><span class="tocnumber">2</span> <span class="toctext">Kernel and hardware support</span></a></li>
<li class="toclevel-1 tocsection-6"><a href="#Mobile_broadband"><span class="tocnumber">3</span> <span class="toctext">Mobile broadband</span></a></li>
<li class="toclevel-1 tocsection-7">
<a href="#lspci_and_lsusb"><span class="tocnumber">4</span> <span class="toctext">lspci and lsusb</span></a>
<ul>
<li class="toclevel-2 tocsection-8"><a href="#lspci"><span class="tocnumber">4.1</span> <span class="toctext">lspci</span></a></li>
<li class="toclevel-2 tocsection-9"><a href="#lsusb"><span class="tocnumber">4.2</span> <span class="toctext">lsusb</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-10">
<a href="#Configuration"><span class="tocnumber">5</span> <span class="toctext">Configuration</span></a>
<ul>
<li class="toclevel-2 tocsection-11"><a href="#Smartcard_Reader"><span class="tocnumber">5.1</span> <span class="toctext">Smartcard Reader</span></a></li>
<li class="toclevel-2 tocsection-12"><a href="#Fingerprint_reader"><span class="tocnumber">5.2</span> <span class="toctext">Fingerprint reader</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-13">
<a href="#Troubleshooting"><span class="tocnumber">6</span> <span class="toctext">Troubleshooting</span></a>
<ul>
<li class="toclevel-2 tocsection-14"><a href="#Fan_does_not_spin_down_after_suspend-resume"><span class="tocnumber">6.1</span> <span class="toctext">Fan does not spin down after suspend-resume</span></a></li>
<li class="toclevel-2 tocsection-15"><a href="#HDMI_audio_does_not_work_with_Pulseaudio"><span class="tocnumber">6.2</span> <span class="toctext">HDMI audio does not work with Pulseaudio</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-16"><a href="#See_also"><span class="tocnumber">7</span> <span class="toctext">See also</span></a></li>
</ul>
</div>

<h2><span class="mw-headline" id="Firmware">Firmware</span></h2>
<p>As of writing, the current BIOS version is 1.30. By visiting the downloads section (for the type HG/HF T470s) an iso can be downloaded and burned to disk which will perform the update <a rel="nofollow" class="external autonumber" href="http://pcsupport.lenovo.com/us/en/products/laptops-and-netbooks/thinkpad-t-series-laptops/thinkpad-t470s/downloads">[1]</a>
</p>
<p>This laptop is unique in that it retains the thinkpad dock connection as well as provides docking ability over USB-C. We have tested with the <a rel="nofollow" class="external text" href="https://www.thinkwiki.org/wiki/ThinkPad_Ultra_Dock">Thinkpad Ultra Dock</a> and are able to utilize multiple HiDPI monitors via individual connections (e.g. no display port chaining). There are published <a rel="nofollow" class="external text" href="https://support.lenovo.com/us/en/solutions/pd014572">firmware updates</a> for the dock that require windows to install. DisplayPort chaining works via USB-C to DisplayPort adapter.
</p>
<h3><span class="mw-headline" id="Updating_the_BIOS">Updating the BIOS</span></h3>
<h4><span class="mw-headline" id="Via_a_USB_key">Via a USB key</span></h4>
<p>In order to update the BIOS/UEFI using a USB key, follow this procedure (based on <a rel="nofollow" class="external autonumber" href="https://bugzilla.redhat.com/show_bug.cgi?id=1480844#c64">[2]</a>):
</p>
<ol>
<li>Install <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://aur.archlinux.org/packages/geteltorito/">geteltorito</a></span><sup><small>AUR</small></sup>
</li>
<li>Download ISO "BIOS Update (Bootable CD)" from <a rel="nofollow" class="external autonumber" href="https://pcsupport.lenovo.com/at/en/products/LAPTOPS-AND-NETBOOKS/THINKPAD-T-SERIES-LAPTOPS/THINKPAD-T470S/downloads/DS120418">[3]</a>
</li>
<li><code>geteltorito.pl -o bios.img n1wur26w.iso</code></li>
<li>
<code>dd if=bios.img of=&lt;USB key&gt; bs=1M</code> (run as the root user)</li>
</ol>
<h4><span class="mw-headline" id="Using_fwupd">Using fwupd</span></h4>
<ol>
<li>
<a href="../en/Help:Reading.html#Installation_of_packages" class="mw-redirect" title="Install">Install</a> {Pkg|fwupd}</li>
<li>Get the official update utility from <a rel="nofollow" class="external autonumber" href="https://pcsupport.lenovo.com/us/en/products/laptops-and-netbooks/thinkpad-t-series-laptops/thinkpad-t470s/downloads/ds120418-bios-update-utility-bootable-cd-for-windows-10-64-bit-81-64-bit-7-32-bit-64-bit-linux-thinkpad-t470s">[4]</a> and follow the instructions from the same page.</li>
</ol>
<h2><span class="mw-headline" id="Kernel_and_hardware_support">Kernel and hardware support</span></h2>
<p>As advised in <a href="../en/Intel_graphics.html#Enable_early_KMS" title="Intel graphics">Intel graphics#Enable early KMS</a> and <a href="../en/Kernel_mode_setting.html" title="Kernel mode setting">Kernel mode setting</a> you can add i915 to your modules.
</p>
<p><a href="../en/Hardware_video_acceleration.html" title="Hardware video acceleration">Hardware video acceleration</a> with Kaby Lake seems to work fine via va-api.
</p>
<h2><span class="mw-headline" id="Mobile_broadband">Mobile broadband</span></h2>
<p>The mobile broadband card is a <a rel="nofollow" class="external text" href="https://www.sierrawireless.com/products-and-solutions/embedded-solutions/networking-modules/">Sierra EM7455</a>, which can be seen below in the <a href="#lsusb">lsusb output</a>. We have confirmed working with <a rel="nofollow" class="external text" href="https://fi.google.com">Google's Project Fi</a>.
</p>
<h2><span class="mw-headline" id="lspci_and_lsusb">lspci and lsusb</span></h2>
<p>On kernel '4.11.0-rc6-mainline' via <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://aur.archlinux.org/packages/linux-mainline/">linux-mainline</a></span><sup><small>AUR</small></sup> on a <i>20HG</i> T470s
</p>
<h3><span class="mw-headline" id="lspci">lspci</span></h3>
<pre>00:00.0 Host bridge: Intel Corporation Device 5904 (rev 02)
00:02.0 VGA compatible controller: Intel Corporation Device 5916 (rev 02)
00:14.0 USB controller: Intel Corporation Sunrise Point-LP USB 3.0 xHCI Controller (rev 21)
00:14.2 Signal processing controller: Intel Corporation Sunrise Point-LP Thermal subsystem (rev 21)
00:16.0 Communication controller: Intel Corporation Sunrise Point-LP CSME HECI #1 (rev 21)
00:16.3 Serial controller: Intel Corporation Device 9d3d (rev 21)
00:1c.0 PCI bridge: Intel Corporation Device 9d10 (rev f1)
00:1c.2 PCI bridge: Intel Corporation Device 9d12 (rev f1)
00:1d.0 PCI bridge: Intel Corporation Sunrise Point-LP PCI Express Root Port #9 (rev f1)
00:1f.0 ISA bridge: Intel Corporation Device 9d4e (rev 21)
00:1f.2 Memory controller: Intel Corporation Sunrise Point-LP PMC (rev 21)
00:1f.3 Audio device: Intel Corporation Device 9d71 (rev 21)
00:1f.4 SMBus: Intel Corporation Sunrise Point-LP SMBus (rev 21)
00:1f.6 Ethernet controller: Intel Corporation Ethernet Connection (4) I219-LM (rev 21)
3a:00.0 Network controller: Intel Corporation Device 24fd (rev 78)
3c:00.0 Non-Volatile memory controller: Samsung Electronics Co Ltd Device a804
</pre>
<h3><span class="mw-headline" id="lsusb">lsusb</span></h3>
<pre>Bus 002 Device 003: ID 0bda:0316 Realtek Semiconductor Corp. 
Bus 002 Device 001: ID 1d6b:0003 Linux Foundation 3.0 root hub
Bus 001 Device 006: ID 138a:0097 Validity Sensors, Inc. 
Bus 001 Device 005: ID 5986:111c Acer, Inc 
Bus 001 Device 008: ID 1199:9079 Sierra Wireless, Inc. 
Bus 001 Device 002: ID 058f:9540 Alcor Micro Corp. AU9540 Smartcard Reader
Bus 001 Device 001: ID 1d6b:0002 Linux Foundation 2.0 root hub
</pre>
<h2><span class="mw-headline" id="Configuration">Configuration</span></h2>
<h3><span class="mw-headline" id="Smartcard_Reader">Smartcard Reader</span></h3>
<pre>Bus 001 Device 002: ID 058f:9540 Alcor Micro Corp. AU9540 Smartcard Reader
</pre>
<h3><span class="mw-headline" id="Fingerprint_reader">Fingerprint reader</span></h3>
<p>As of writing this, the fingerprint reader is still under <a rel="nofollow" class="external text" href="https://github.com/nmikhailov/Validity90">prototype development</a>, but looks like working fine on the T470s.
</p>
<p>To get the sensor working, it first must be initialized with data. This currently only works with Windows. So if you had used the reader before installing Arch, this should work fine. Otherwise install a Windows version in a virtualbox, connect the Validity Sensor over USB(USB 2.0), install the drivers and use it a few times.
</p>
<p>As soon as this step is completed, the sensor can be used under Linux.
Check out <a rel="nofollow" class="external text" href="https://github.com/nmikhailov/Validity90/tree/master/prototype">Validity90 prototype</a>, build it and check if the sensor is working.
Install <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=fprintd">fprintd</a></span>, <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://aur.archlinux.org/packages/libfprint-vfs009x-git/">libfprint-vfs009x-git</a></span><sup><small>AUR</small></sup> and for testing <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://aur.archlinux.org/packages/fprint_demo/">fprint_demo</a></span><sup><small>AUR</small></sup>.
You can now enroll your fingers. fprintd and fprint_demo might have be started with superuser privileges.
</p>
<p>After setting up the fingerprint sensor is complete, one can use it to login or authenticate for <code>sudo</code> or <code>su</code>(To use this, launch fprintd_enroll prior as root).
</p>
<p>For login edit <code>/etc/pam.d/login</code>
</p>
<p>Add the following and comment out the other entrys
</p>
<pre> auth required pam_env.so
 auth sufficient pam_fprintd.so
 auth sufficient pam_unix.so try_first_pass likeauth nullok
 auth required pam_deny.so
</pre>
<p>Do the same for sudo with <code>/etc/pam.d/sudo</code> or su with <code>/etc/pam.d/su</code>
</p>
<p>For more information visit <a rel="nofollow" class="external text" href="https://github.com/3v1n0/libfprint">libfprint</a> and adapt for the vfs0097 package.
</p>
<h2><span class="mw-headline" id="Troubleshooting">Troubleshooting</span></h2>
<h3><span class="mw-headline" id="Fan_does_not_spin_down_after_suspend-resume">Fan does not spin down after suspend-resume</span></h3>
<p>On <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=gnome-shell">gnome-shell</a></span> via <a href="../en/Wayland.html" title="Wayland">wayland</a>, suspend-resume results in the fan holding at 100% without ever spinning down. Alternatively if you use <a href="../en/Xorg.html" title="Xorg">xorg</a> this does not seem to happen. This issue has been resolved in BIOS/UEFI version 1.20.
</p>
<h3><span class="mw-headline" id="HDMI_audio_does_not_work_with_Pulseaudio">HDMI audio does not work with Pulseaudio</span></h3>
<p>The Intel HD audio module manages both the internal analog audio devices (e.g. speakers, mic, headphone jack) and the HDMI / DisplayPort audio outputs. Which inputs / outputs are used is selectable via the card profile. The profile selection can be changed using the <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=pavucontrol">pavucontrol</a></span> application in the Configuration tab. "Analog Stereo Duplex" is the default, using the internal speakers / headphone jack and the internal microphone. To feed audio out the internal HDMI port while still using the internal microphone for input, select "Digital Stereo (HDMI 2) Output + Analog Stereo Input". Pulseaudio will remember this selection and auto switch to/from it based on the status of the HDMI port.
</p>
<h2><span class="mw-headline" id="See_also">See also</span></h2>
<ul><li><a rel="nofollow" class="external text" href="https://support.lenovo.com/us/en/products/Laptops-and-netbooks/ThinkPad-T-Series-laptops/ThinkPad-T470s?beta=false">Lenovo Support Page</a></li></ul>
</div>
</div>
<div id="catlinks" class="catlinks" data-mw="interface">
<div id="mw-normal-catlinks" class="mw-normal-catlinks">
<a href="../Special:Categories.html" title="Special:Categories">Category</a>: <ul><li><a href="../en/Category:Lenovo.html" title="Category:Lenovo">Lenovo</a></li></ul>
</div>
<div id="mw-hidden-catlinks" class="mw-hidden-catlinks mw-hidden-cats-hidden">Hidden category: <ul><li><a href="../en/Category:Pages_or_sections_flagged_with_Template:Laptop_style.html" title="Category:Pages or sections flagged with Template:Laptop style">Pages or sections flagged with Template:Laptop style</a></li></ul>
</div>
</div>
	</div>
</div>

<footer id="footer" class="mw-footer" role="contentinfo" style="margin: 0">
	<ul id="footer-info">
		<li>Retrieved from "<a dir="ltr" href="https://wiki.archlinux.org/index.php?title=Lenovo_ThinkPad_T470s&amp;oldid=661691">https://wiki.archlinux.org/index.php?title=Lenovo_ThinkPad_T470s&amp;oldid=661691</a>"</li>
		<li id="footer-info-lastmod"> This page was last edited on 18 April 2021, at 11:53.</li>
		<li id="footer-info-copyright">Content is available under <a class="external" rel="nofollow" href="http://www.gnu.org/copyleft/fdl.html">GNU Free Documentation License 1.3 or later</a> unless otherwise noted.</li>
	<br>
</ul>
	<ul id="footer-places">
		<li id="footer-places-privacy"><a href="../en/ArchWiki:Privacy_policy.html" title="ArchWiki:Privacy policy">Privacy policy</a></li>
		<li id="footer-places-about"><a href="../en/ArchWiki:About.html" title="ArchWiki:About">About ArchWiki</a></li>
		<li id="footer-places-disclaimer"><a href="../en/ArchWiki:General_disclaimer.html" title="ArchWiki:General disclaimer">Disclaimers</a></li>
	</ul>
	<ul id="footer-icons" class="noprint">
		<li id="footer-copyrightico">
	</ul>
	<div style="clear: both;"></div>
</footer>



</body>
</html>
