<!DOCTYPE html>
<html class="client-nojs" lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<title>Dell TB16 - ArchWiki</title>
<link rel="stylesheet" href="../ArchWikiOffline.css">
<meta name="ResourceLoaderDynamicStyles" content="">
<meta name="generator" content="MediaWiki 1.35.0">
<meta name="robots" content="noindex,follow">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="shortcut icon" href="/favicon.ico">
<link rel="search" type="application/opensearchdescription+xml" href="/opensearch_desc.php" title="ArchWiki (en)">
<link rel="EditURI" type="application/rsd+xml" href="https://wiki.archlinux.org/api.php?action=rsd">
<link rel="license" href="http://www.gnu.org/copyleft/fdl.html">
<link rel="alternate" type="application/atom+xml" title="ArchWiki Atom feed" href="/index.php?title=Special:RecentChanges&amp;feed=atom">
</head>
<body class="mediawiki ltr sitedir-ltr mw-hide-empty-elt ns-0 ns-subject page-Dell_TB16 rootpage-Dell_TB16 skin-vector action-view skin-vector-legacy">
<div id="content" class="mw-body" role="main" style="margin: 0">
	<a id="top"></a>
	<div id="siteNotice" class="mw-body-content"></div>
	<div class="mw-indicators mw-body-content">
	</div>
	<h1 id="firstHeading" class="firstHeading" lang="en">Dell TB16</h1>
	<div id="bodyContent" class="mw-body-content">
		<div id="siteSub" class="noprint">From ArchWiki</div>
		<div id="contentSub"></div>
		<div id="contentSub2"></div>
		
		<div id="jump-to-nav"></div>
		<a class="mw-jump-link" href="#mw-head">Jump to navigation</a>
		<a class="mw-jump-link" href="#searchInput">Jump to search</a>
		<div id="mw-content-text" lang="en" dir="ltr" class="mw-content-ltr">
<div class="warningbox">The printable version is no longer supported and may have rendering errors. Please update your browser bookmarks and please use the default browser print function instead.</div>
<div class="mw-parser-output">
<p>Dell's <a rel="nofollow" class="external text" href="https://www.dell.com/en-us/shop/dell-business-thunderbolt-dock-tb16-with-240w-adapter/apd/452-bcnu/pc-accessories">TB16</a> is a popular Thunderbolt Dock with power-delivery, ethernet, USB, audio, HDMI, DisplayPort, mini-DP and VGA.  It works well in Linux when configured correctly with up-to-date firmware.
</p>
<div id="toc" class="toc" role="navigation" aria-labelledby="mw-toc-heading">
<input type="checkbox" role="button" id="toctogglecheckbox" class="toctogglecheckbox" style="display:none"><div class="toctitle" lang="en" dir="ltr">
<h2 id="mw-toc-heading">Contents</h2>
<span class="toctogglespan"><label class="toctogglelabel" for="toctogglecheckbox"></label></span>
</div>
<ul>
<li class="toclevel-1 tocsection-1">
<a href="#Configuration"><span class="tocnumber">1</span> <span class="toctext">Configuration</span></a>
<ul>
<li class="toclevel-2 tocsection-2"><a href="#Thunderbolt_Security"><span class="tocnumber">1.1</span> <span class="toctext">Thunderbolt Security</span></a></li>
<li class="toclevel-2 tocsection-3"><a href="#Dell_Type-C_Dock_Configuration"><span class="tocnumber">1.2</span> <span class="toctext">Dell Type-C Dock Configuration</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-4"><a href="#Firmware_Updates"><span class="tocnumber">2</span> <span class="toctext">Firmware Updates</span></a></li>
<li class="toclevel-1 tocsection-5"><a href="#Troubleshooting"><span class="tocnumber">3</span> <span class="toctext">Troubleshooting</span></a></li>
<li class="toclevel-1 tocsection-6"><a href="#External_Links"><span class="tocnumber">4</span> <span class="toctext">External Links</span></a></li>
</ul>
</div>

<h2><span class="mw-headline" id="Configuration">Configuration</span></h2>
<h3><span class="mw-headline" id="Thunderbolt_Security">Thunderbolt Security</span></h3>
<p>You should either:
</p>
<ul>
<li>Disable Thunderbolt security in the BIOS (recommended)</li>
<li>Use <a href="../en/Thunderbolt.html#User_device_authorization" title="Thunderbolt">boltctl</a> to temporarily authorize or permanently enroll the <i>dock</i> <i><b>and</b></i> <i>cable</i>.</li>
</ul>
<p>Thunderbolt security "works" but may result in random instability, particularly system freezes on resume, and USB HID devices (mouse, keyboard) behaving erratically.  It's suggested to ensure your system is completely stable before enabling this.
</p>
<h3><span class="mw-headline" id="Dell_Type-C_Dock_Configuration">Dell Type-C Dock Configuration</span></h3>
<p>The TB16 is commonly used with Dell laptops, which have a special BIOS option which <a rel="nofollow" class="external text" href="https://www.reddit.com/r/sysadmin/comments/9bwqt8/dell_tb16_dock_rant_seriously_dont_buy_this_thing/">may cause stability issues</a>.  You should disable the following option:
</p>
<ul><li>Dell Type-C Dock Configuration
<ul><li>Always Allow Dell Docks (uncheck this)</li></ul>
</li></ul>
<h2><span class="mw-headline" id="Firmware_Updates">Firmware Updates</span></h2>
<p>The firmware updates provided for Windows at Dell's <a rel="nofollow" class="external text" href="https://www.dell.com/support/home/us/en/04/product-support/product/dell-thunderbolt-dock-tb16/drivers">TB16 Support: Drivers</a> page include firmware that cannot be updated in Linux, such as the ASMedia USB Host Controller firmware which fixes numerous instability USB issues and Synaptics controller (DisplayPort).
</p>
<p>To summarize <a rel="nofollow" class="external text" href="https://www.reddit.com/r/Dell/comments/8vjqch/if_dell_pushed_out_firmware_update_v100_for_the/e1sjczx/">jasondclinton's post on reddit</a>:
</p>
<ol>
<li>The NVM updates to the TB controller can be flashed by Linux (using the standard nvm_nonactive nvm_authenticate sysfs interface)</li>
<li>There is no way to install the ASMedia, Synaptics, etc firmwares - so you might as well flash everything from Windows.</li>
<li>You need all the latest updates for the docker firmware updater to even see the TB16.</li>
</ol>
<p>Ensure you have the latest:
</p>
<ol>
<li>BIOS firmware</li>
<li>Windows Update</li>
<li>Dell Update</li>
<li>Thunderbolt NVM firmware (for the Thunberbolt controller on your device) - should be covered by Windows &amp; Dell updates</li>
<li>TB16 firmware updater from the <a rel="nofollow" class="external text" href="https://www.dell.com/support/home/us/en/04/product-support/product/dell-thunderbolt-dock-tb16/drivers">drivers page above</a>.</li>
</ol>
<p>Even after having used the firmware updater, there are still other firmwares from the same Dell support page, which supersede the versions included in the firmware updater, that should be downloaded and installed afterwards, e.g. the ASMedia driver / firmware.  If in doubt, install all updates on the page.
</p>
<p>jasondclinton also notes that the official NVM updates are often far behind Intel's latest releases (e.g. TB16's 1.0.0 firmware includes NVM 16 wherehas Intel had already released NVM 33 at time of writing).  It is unknown if there is an easy way to update these independently.
</p>
<h2><span class="mw-headline" id="Troubleshooting">Troubleshooting</span></h2>
<p>Issues such as the USB bus (and all connected devices) failing when plugging/unplugging devices are improved by following all the instructions above (notably, *disabling* Thunderbolt Security, "Dell Type-C Dock configuration options" and firmware updates).  Read the firmware updates section carefully: not all updates are possible via Linux.
</p>
<p>Issues with the USB bus failing can also be mitigated by disabling PCIE power management in the TLP config. Use the <i>lspci </i> output to identify and add the dock to the <code>RUNTIME_PM_BLACKLIST</code> list in <code>/etc/tlp.conf</code>
</p>
<p>If, when using Nvidia drivers, you get a black screen on boot with the dock and 3 external monitors connected, there is a good chance the machine is trying to use the 3 external displays plus the internal display of the laptop. This can be resolved by writing a block into <code>~/.xinitrc</code> or your display manager's custom xstart scripts e.g. for SDDM the default for KDE. the file is <code>/usr/share/sddm/scripts/Xsetup</code>
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/usr/share/sddm/scripts/Xsetup</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">xrandr --setprovideroutputsource modesetting NVIDIA-0

internaldisp="&lt;name of laptop display&gt;"
if [ `xrandr | grep " connected " | wc -l` -gt 3 ]; then
        xdisplays=`xrandr | grep " connected " | awk '{print $1}'`
        for xdisplay in $xdisplays; do
                if [[ "$xdisplay" == "$internaldisp"* ]]; then
                        xrandr --output $xdisplay --off
                else
                        xrandr --output $xdisplay --auto
                fi
        done
else
        xrandr --auto
fi
</pre>
<p>Some devices behave differently in the dock vs directly on laptop's USB ports, e.g. Microsoft's keyboard receiver is erratically put to sleep, or gets stuck repeating a particular key.  The un-intuitive fix for this is to disable Thunderbolt security (see note about this above).
</p>
<h2><span class="mw-headline" id="External_Links">External Links</span></h2>
<ul>
<li><a rel="nofollow" class="external text" href="https://www.reddit.com/r/sysadmin/comments/9bwqt8/dell_tb16_dock_rant_seriously_dont_buy_this_thing/">Reddit r/sysadmin: Dell TB16 Dock Rant - Seriously don't buy this thing...</a></li>
<li><a rel="nofollow" class="external text" href="https://www.reddit.com/r/Dell/comments/8vjqch/if_dell_pushed_out_firmware_update_v100_for_the/">Reddit r/Dell: If Dell pushed out firmware update v1.00 for the TB16...</a></li>
</ul>
</div>
</div>
<div id="catlinks" class="catlinks" data-mw="interface"><div id="mw-normal-catlinks" class="mw-normal-catlinks">
<a href="../Special:Categories.html" title="Special:Categories">Category</a>: <ul><li><a href="../en/Category:Dell.html" title="Category:Dell">Dell</a></li></ul>
</div></div>
	</div>
</div>

<footer id="footer" class="mw-footer" role="contentinfo" style="margin: 0">
	<ul id="footer-info">
		<li>Retrieved from "<a dir="ltr" href="https://wiki.archlinux.org/index.php?title=Dell_TB16&amp;oldid=626656">https://wiki.archlinux.org/index.php?title=Dell_TB16&amp;oldid=626656</a>"</li>
		<li id="footer-info-lastmod"> This page was last edited on 24 July 2020, at 16:00.</li>
		<li id="footer-info-copyright">Content is available under <a class="external" rel="nofollow" href="http://www.gnu.org/copyleft/fdl.html">GNU Free Documentation License 1.3 or later</a> unless otherwise noted.</li>
	<br>
</ul>
	<ul id="footer-places">
		<li id="footer-places-privacy"><a href="../en/ArchWiki:Privacy_policy.html" title="ArchWiki:Privacy policy">Privacy policy</a></li>
		<li id="footer-places-about"><a href="../en/ArchWiki:About.html" title="ArchWiki:About">About ArchWiki</a></li>
		<li id="footer-places-disclaimer"><a href="../en/ArchWiki:General_disclaimer.html" title="ArchWiki:General disclaimer">Disclaimers</a></li>
	</ul>
	<ul id="footer-icons" class="noprint">
		<li id="footer-copyrightico">
	</ul>
	<div style="clear: both;"></div>
</footer>



</body>
</html>
