<!DOCTYPE html>
<html class="client-nojs" lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<title>GNOME package guidelines - ArchWiki</title>
<link rel="stylesheet" href="../ArchWikiOffline.css">
<meta name="ResourceLoaderDynamicStyles" content="">
<meta name="generator" content="MediaWiki 1.35.0">
<meta name="robots" content="noindex,follow">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="shortcut icon" href="/favicon.ico">
<link rel="search" type="application/opensearchdescription+xml" href="/opensearch_desc.php" title="ArchWiki (en)">
<link rel="EditURI" type="application/rsd+xml" href="https://wiki.archlinux.org/api.php?action=rsd">
<link rel="license" href="http://www.gnu.org/copyleft/fdl.html">
<link rel="alternate" type="application/atom+xml" title="ArchWiki Atom feed" href="/index.php?title=Special:RecentChanges&amp;feed=atom">
</head>
<body class="mediawiki ltr sitedir-ltr mw-hide-empty-elt ns-0 ns-subject page-GNOME_package_guidelines rootpage-GNOME_package_guidelines skin-vector action-view skin-vector-legacy">
<div id="content" class="mw-body" role="main" style="margin: 0">
	<a id="top"></a>
	<div id="siteNotice" class="mw-body-content"></div>
	<div class="mw-indicators mw-body-content">
	</div>
	<h1 id="firstHeading" class="firstHeading" lang="en">GNOME package guidelines</h1>
	<div id="bodyContent" class="mw-body-content">
		<div id="siteSub" class="noprint">From ArchWiki</div>
		<div id="contentSub"></div>
		<div id="contentSub2"></div>
		
		<div id="jump-to-nav"></div>
		<a class="mw-jump-link" href="#mw-head">Jump to navigation</a>
		<a class="mw-jump-link" href="#searchInput">Jump to search</a>
		<div id="mw-content-text" lang="en" dir="ltr" class="mw-content-ltr">
<div class="warningbox">The printable version is no longer supported and may have rendering errors. Please update your browser bookmarks and please use the default browser print function instead.</div>
<div class="mw-parser-output">
<div class="toc" style="display:block; text-align: center; margin-bottom: 1em;">
<b><a href="../en/Arch_package_guidelines.html" title="Arch package guidelines">Arch package guidelines</a></b>
<hr>
<p><a href="../en/32-bit_package_guidelines.html" title="32-bit package guidelines">32-bit</a> – <a href="../en/CLR_package_guidelines.html" title="CLR package guidelines">CLR</a> – <a href="../en/CMake_package_guidelines.html" title="CMake package guidelines">CMake</a> – <a href="../en/Cross-compiling_tools_package_guidelines.html" title="Cross-compiling tools package guidelines">Cross</a> – <a href="../en/DKMS_package_guidelines.html" title="DKMS package guidelines">DKMS</a> – <a href="../en/Eclipse_plugin_package_guidelines.html" title="Eclipse plugin package guidelines">Eclipse</a> – <a href="../en/Electron_package_guidelines.html" title="Electron package guidelines">Electron</a> – <a href="../en/Font_package_guidelines.html" class="mw-redirect" title="Font packaging guidelines">Font</a> – <a href="../en/Free_Pascal_package_guidelines.html" title="Free Pascal package guidelines">Free Pascal</a> – <a class="mw-selflink selflink">GNOME</a> – <a href="../en/Go_package_guidelines.html" title="Go package guidelines">Go</a> – <a href="../en/Haskell_package_guidelines.html" title="Haskell package guidelines">Haskell</a> – <a href="../en/Java_package_guidelines.html" title="Java package guidelines">Java</a> – <a href="../en/KDE_package_guidelines.html" title="KDE package guidelines">KDE</a> – <a href="../en/Kernel_module_package_guidelines.html" title="Kernel module package guidelines">Kernel</a> – <a href="../en/Lisp_package_guidelines.html" title="Lisp package guidelines">Lisp</a> – <a href="../en/Meson_package_guidelines.html" title="Meson package guidelines">Meson</a> – <a href="../en/MinGW_package_guidelines.html" title="MinGW package guidelines">MinGW</a> – <a href="../en/Node.js_package_guidelines.html" title="Node.js package guidelines">Node.js</a> – <a href="../en/Nonfree_applications_package_guidelines.html" title="Nonfree applications package guidelines">Nonfree</a> – <a href="../en/OCaml_package_guidelines.html" title="OCaml package guidelines">OCaml</a> – <a href="../en/Perl_package_guidelines.html" title="Perl package guidelines">Perl</a> – <a href="../en/PHP_package_guidelines.html" title="PHP package guidelines">PHP</a> – <a href="../en/Python_package_guidelines.html" title="Python package guidelines">Python</a> – <a href="../en/R_package_guidelines.html" title="R package guidelines">R</a> – <a href="../en/Ruby_Gem_package_guidelines.html" title="Ruby Gem package guidelines">Ruby</a> – <a href="../en/Rust_package_guidelines.html" title="Rust package guidelines">Rust</a> – <a href="../en/VCS_package_guidelines.html" title="VCS package guidelines">VCS</a> – <a href="../en/Web_application_package_guidelines.html" title="Web application package guidelines">Web</a> – <a href="../en/Wine_package_guidelines.html" title="Wine package guidelines">Wine</a>
</p>
</div>
<p>The <a href="../en/GNOME.html" title="GNOME">GNOME</a> packages on Arch Linux follow a certain schema.
</p>
<div id="toc" class="toc" role="navigation" aria-labelledby="mw-toc-heading">
<input type="checkbox" role="button" id="toctogglecheckbox" class="toctogglecheckbox" style="display:none"><div class="toctitle" lang="en" dir="ltr">
<h2 id="mw-toc-heading">Contents</h2>
<span class="toctogglespan"><label class="toctogglelabel" for="toctogglecheckbox"></label></span>
</div>
<ul>
<li class="toclevel-1 tocsection-1">
<a href="#Source_URL"><span class="tocnumber">1</span> <span class="toctext">Source URL</span></a>
<ul>
<li class="toclevel-2 tocsection-2"><a href="#Using_released_tarball"><span class="tocnumber">1.1</span> <span class="toctext">Using released tarball</span></a></li>
<li class="toclevel-2 tocsection-3"><a href="#Using_a_commit_from_Git_repository"><span class="tocnumber">1.2</span> <span class="toctext">Using a commit from Git repository</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-4"><a href="#GConf_schemas"><span class="tocnumber">2</span> <span class="toctext">GConf schemas</span></a></li>
<li class="toclevel-1 tocsection-5"><a href="#GSettings_schemas"><span class="tocnumber">3</span> <span class="toctext">GSettings schemas</span></a></li>
<li class="toclevel-1 tocsection-6"><a href="#Scrollkeeper_documentation"><span class="tocnumber">4</span> <span class="toctext">Scrollkeeper documentation</span></a></li>
<li class="toclevel-1 tocsection-7"><a href="#GTK_icon_cache"><span class="tocnumber">5</span> <span class="toctext">GTK icon cache</span></a></li>
<li class="toclevel-1 tocsection-8"><a href="#.desktop_files"><span class="tocnumber">6</span> <span class="toctext">.desktop files</span></a></li>
<li class="toclevel-1 tocsection-9"><a href="#.install_files"><span class="tocnumber">7</span> <span class="toctext">.install files</span></a></li>
</ul>
</div>

<h2><span class="mw-headline" id="Source_URL">Source URL</span></h2>
<p>This topic contains the most commonly used source URL used by GNOME packages in both <a href="../en/Official_repositories.html" title="Official repositories">official repositories</a> and <a href="../en/Arch_User_Repository.html" class="mw-redirect" title="AUR">AUR</a>. For examples, search for GNOME packages in the official repositories<a rel="nofollow" class="external autonumber" href="https://archlinux.org/packages/?q=gnome">[1]</a> and in the AUR<a rel="nofollow" class="external autonumber" href="https://aur.archlinux.org/packages/?K=gnome">[2]</a>
</p>
<h3><span class="mw-headline" id="Using_released_tarball">Using released tarball</span></h3>
<p>When downloading a released tarball, you can get it from <a rel="nofollow" class="external free" href="https://download.gnome.org">https://download.gnome.org</a> using the following source array:
</p>
<pre>source=("https://download.gnome.org/sources/$pkgname/${pkgver%.*}/$pkgname-$pkgver.tar.xz")
</pre>
<p>where <i>${pkgver%.*}</i> returns the <i>major</i>.<i>minor</i> package version, by removing the suffix of <code>pkgver</code> (which is the <i>micro</i> package version). E.g., if <i>pkgver=3.28.0</i> then <i>${pkgver%.*}</i> would return <i>3.28</i>.
</p>
<h3><span class="mw-headline" id="Using_a_commit_from_Git_repository">Using a commit from Git repository</span></h3>
<p>Another common practice is to use as source a specific commit from a GNOME software's source code git repository. It does not classify as VCS package because Pacman's feature of setting specific commit (see <span class="plainlinks archwiki-template-man" title="$ man 5 PKGBUILD"><a rel="nofollow" class="external text" href="https://man.archlinux.org/man/PKGBUILD.5#USING_VCS_SOURCES">PKGBUILD(5) § USING VCS SOURCES</a></span>) makes PKGBUILD not follow latest development commits neither update the <code>pkgver</code> field, using the source from the specified commit hash instead.
</p>
<p>See a template below:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">PKGBUILD</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">makedepends=(git)
commit=<i>hash_of_a_commit</i> 
source=("git+https://gitlab.gnome.org/GNOME/$pkgname.git#commit=$_commit")
md5sums=('SKIP')

pkgver() {
  cd $pkgname
  git describe --tags | sed 's/-/+/g'
}</pre>
<p>Replace <i>hash_of_a_commit</i> with the Git commit hash desired.
</p>
<p>Please notice that since the source is downloaded with <i>git</i>, then <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=git">git</a></span> must be in makedepends and checksums must be set to 'SKIP', just like it would happen with any other VCS package. Using <code>pkgver()</code> function is highly recommended, so it sets <code>pkgver</code> accordingly for the commit hash provided.
</p>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Note:</strong> GNOME previously used <a rel="nofollow" class="external free" href="https://git.gnome.org">https://git.gnome.org</a>, but then migrated to <a rel="nofollow" class="external free" href="https://gitlab.gnome.org">https://gitlab.gnome.org</a><a rel="nofollow" class="external autonumber" href="https://www.gnome.org/news/2018/05/gnome-moves-to-gitlab-2/">[3]</a>. Old links should automatically redirect to the new gitlab.gnome.org domain, but it might be wise to manually update your source URL.</div>
<h2><span class="mw-headline" id="GConf_schemas">GConf schemas</span></h2>
<p>Some GNOME packages install <a href="https://en.wikipedia.org/wiki/GConf#Schemas" class="extiw" title="wikipedia:GConf">GConf schemas</a>, even though many others already migrated to GSettings. Those packages should depend on <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://aur.archlinux.org/packages/gconf/">gconf</a></span><sup><small>AUR</small></sup>.
</p>
<p>Gconf schemas get installed in the system GConf database, which has to be avoided.
Some packages provide a <code>--disable-schemas-install</code> switch for <b>./configure</b>, which hardly ever works. However, gconftool-2 has a variable called <code>GCONF_DISABLE_MAKEFILE_SCHEMA_INSTALL</code> which you can set to tell gconftool-2 to not update any databases.
</p>
<p>When creating packages that install GConf schema files, use
</p>
<pre>make GCONF_DISABLE_MAKEFILE_SCHEMA_INSTALL=1 DESTDIR=${pkgdir} install</pre>
<p>for the package installation step in the PKGBUILD.
</p>
<p>Do not call <code>gconfpkg</code> in the .install file, as GConf schemas are automatically installed/removed (while installing/removing the GNOME package) via <a href="../en/Pacman.html#Hooks" class="mw-redirect" title="Pacman hooks">pacman hooks</a> since <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://aur.archlinux.org/packages/gconf/">gconf</a></span><sup><small>AUR</small></sup>=3.2.6-4
</p>
<h2><span class="mw-headline" id="GSettings_schemas">GSettings schemas</span></h2>
<p>The GConf schemas were migrated to GSettings schemas, so many GNOME applications can be found using this new schema file. GSettings uses dconf as backend, so all packages that contain GSettings schemas require <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=dconf">dconf</a></span> as dependency. When a new GSettings schema installed on the system, the GSettings database has to be recompiled, but not when packaging.
</p>
<p>To avoid recompiling GSettings database on packaging, use the <code>--disable-schemas-compile</code> switch for <b>./configure</b>.
</p>
<p>Do not call <code>glib-compile-schemas</code> in the .install file, as GSettings schema databases are automatically recompiled via <a href="../en/Pacman.html#Hooks" class="mw-redirect" title="Pacman hooks">pacman hooks</a> since <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=glib2">glib2</a></span>=2.48.0-2.
</p>
<h2><span class="mw-headline" id="Scrollkeeper_documentation">Scrollkeeper documentation</span></h2>
<p>Starting from GNOME 2.20 there is no need to handle scrollkeeper anymore, as <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://aur.archlinux.org/packages/rarian/">rarian</a></span><sup><small>AUR</small></sup> reads its OMF files directly. Scrollkeeper-update is a dummy these days. The only required thing now is to makedepend on <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://aur.archlinux.org/packages/gnome-doc-utils/">gnome-doc-utils</a></span><sup><small>AUR</small></sup>&gt;=0.11.2.
</p>
<p>It can be disabled using <code>--disable-scrollkeeper</code> switch from <b>./configure</b>.
</p>
<h2><span class="mw-headline" id="GTK_icon_cache">GTK icon cache</span></h2>
<p>Quite some packages install icons in the hicolor icon theme.
</p>
<p>Do not call <code>gtk-update-icon-cache</code> in the .install file, as the icon cache is updated via <a href="../en/Pacman.html#Hooks" class="mw-redirect" title="Pacman hooks">pacman hooks</a> since <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=gtk-update-icon-cache">gtk-update-icon-cache</a></span>=3.20.3-2.  These packages should <i>not</i> depend on <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=gtk-update-icon-cache">gtk-update-icon-cache</a></span>, as any application which makes use of gtk icon caches will install the package with the hook and do a full, retroactive cache update.
</p>
<h2><span class="mw-headline" id=".desktop_files">.desktop files</span></h2>
<p>Many packages install Freedesktop.org compatible <code>.desktop</code> files and register MimeType entries in them.
</p>
<p>Do not call <code>update-desktop-database</code> in the .install file, as the database is automatically updated via <a href="../en/Pacman.html#Hooks" class="mw-redirect" title="Pacman hooks">pacman hooks</a> since <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=desktop-file-utils">desktop-file-utils</a></span>=0.22-2. They should <i>not</i> depend on <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=desktop-file-utils">desktop-file-utils</a></span>, as any desktop which makes use of desktop files will install the package with the hook and do a full, retroactive database update.
</p>
<h2><span class="mw-headline" id=".install_files">.install files</span></h2>
<p>Previously, most of the GNOME packages had a .install file calling commands like <code>glib-compile-schemas</code>, <code>gtk-update-icon-cache</code>, and <code>update-desktop-database</code> in order to install/update local cache or databases.  This is deprecated since pacman 5.0 implemented <a href="../en/Pacman.html#Hooks" title="Pacman">hooks</a> which call those commands automatically when installing the package.
</p>
<p>To avoid being called twice, the above mentioned commands should be removed from .install file.
</p>
</div>
</div>
<div id="catlinks" class="catlinks" data-mw="interface"><div id="mw-normal-catlinks" class="mw-normal-catlinks">
<a href="../Special:Categories.html" title="Special:Categories">Category</a>: <ul><li><a href="../en/Category:Arch_package_guidelines.html" title="Category:Arch package guidelines">Arch package guidelines</a></li></ul>
</div></div>
	</div>
</div>

<footer id="footer" class="mw-footer" role="contentinfo" style="margin: 0">
	<ul id="footer-info">
		<li>Retrieved from "<a dir="ltr" href="https://wiki.archlinux.org/index.php?title=GNOME_package_guidelines&amp;oldid=646775">https://wiki.archlinux.org/index.php?title=GNOME_package_guidelines&amp;oldid=646775</a>"</li>
		<li id="footer-info-lastmod"> This page was last edited on 26 December 2020, at 11:56.</li>
		<li id="footer-info-copyright">Content is available under <a class="external" rel="nofollow" href="http://www.gnu.org/copyleft/fdl.html">GNU Free Documentation License 1.3 or later</a> unless otherwise noted.</li>
	<br>
</ul>
	<ul id="footer-places">
		<li id="footer-places-privacy"><a href="../en/ArchWiki:Privacy_policy.html" title="ArchWiki:Privacy policy">Privacy policy</a></li>
		<li id="footer-places-about"><a href="../en/ArchWiki:About.html" title="ArchWiki:About">About ArchWiki</a></li>
		<li id="footer-places-disclaimer"><a href="../en/ArchWiki:General_disclaimer.html" title="ArchWiki:General disclaimer">Disclaimers</a></li>
	</ul>
	<ul id="footer-icons" class="noprint">
		<li id="footer-copyrightico">
	</ul>
	<div style="clear: both;"></div>
</footer>



</body>
</html>
