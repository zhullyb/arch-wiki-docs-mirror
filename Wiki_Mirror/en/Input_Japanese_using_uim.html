<!DOCTYPE html>
<html class="client-nojs" lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<title>Input Japanese using uim - ArchWiki</title>
<link rel="stylesheet" href="../ArchWikiOffline.css">
<meta name="ResourceLoaderDynamicStyles" content="">
<meta name="generator" content="MediaWiki 1.35.0">
<meta name="referrer" content="no-referrer-when-downgrade">
<meta name="robots" content="noindex,follow">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="shortcut icon" href="/favicon.ico">
<link rel="search" type="application/opensearchdescription+xml" href="/opensearch_desc.php" title="ArchWiki (en)">
<link rel="EditURI" type="application/rsd+xml" href="https://wiki.archlinux.org/api.php?action=rsd">
<link rel="license" href="http://www.gnu.org/copyleft/fdl.html">
<link rel="alternate" type="application/atom+xml" title="ArchWiki Atom feed" href="/index.php?title=Special:RecentChanges&amp;feed=atom">
</head>
<body class="mediawiki ltr sitedir-ltr mw-hide-empty-elt ns-0 ns-subject page-Input_Japanese_using_uim rootpage-Input_Japanese_using_uim skin-vector action-view skin-vector-legacy">
<div id="content" class="mw-body" role="main" style="margin: 0">
	<a id="top"></a>
	<div id="siteNotice" class="mw-body-content"></div>
	<div class="mw-indicators mw-body-content">
	</div>
	<h1 id="firstHeading" class="firstHeading" lang="en">Input Japanese using uim</h1>
	<div id="bodyContent" class="mw-body-content">
		<div id="siteSub" class="noprint">From ArchWiki</div>
		<div id="contentSub"></div>
		<div id="contentSub2"></div>
		
		<div id="jump-to-nav"></div>
		<a class="mw-jump-link" href="#mw-head">Jump to navigation</a>
		<a class="mw-jump-link" href="#searchInput">Jump to search</a>
		<div id="mw-content-text" lang="en" dir="ltr" class="mw-content-ltr">
<div class="warningbox">The printable version is no longer supported and may have rendering errors. Please update your browser bookmarks and please use the default browser print function instead.</div>
<div class="mw-parser-output">
<div class="noprint archwiki-template-message">
<p><a href="../File:Tango-go-next.png" class="image"><img alt="Tango-go-next.png" src="../File:Tango-go-next.png" decoding="async" width="48" height="48"></a><b>This article or section is a candidate for moving to <a href="../en/Uim.html" title="Uim">uim</a>.</b><a href="../File:Tango-go-next.png" class="image"><img alt="Tango-go-next.png" src="../File:Tango-go-next.png" decoding="async" width="48" height="48"></a></p>
<div>
<b>Notes:</b> Move language-independent content to <a href="../en/Uim.html" title="Uim">uim</a> and Japanese-specifics to <a href="../en/Localization/Japanese.html" title="Localization/Japanese">Localization/Japanese</a> (Discuss in <a rel="nofollow" class="external text" href="https://wiki.archlinux.org/index.php/Talk:Input_Japanese_using_uim">Talk:Input Japanese using uim#</a>)</div>
</div>
<div class="archwiki-template-meta-related-articles-start">
<p>Related articles</p>
<ul>
<li><a href="../en/Localization.html" title="Localization">Localization</a></li>
<li><a href="../en/Localization/Japanese.html" title="Localization/Japanese">Localization/Japanese</a></li>
</ul>
</div>
<p>This page explains how to get the Japanese input to work using <a rel="nofollow" class="external text" href="https://github.com/uim/uim">uim</a>.
</p>
<p>If you use SCIM, see <a href="../en/Smart_Common_Input_Method.html" class="mw-redirect" title="Smart Common Input Method platform">Smart Common Input Method platform</a>.
</p>
<p>If you use IBus, see <a href="../en/IBus.html" title="IBus">IBus</a>.
</p>
<div id="toc" class="toc" role="navigation" aria-labelledby="mw-toc-heading">
<input type="checkbox" role="button" id="toctogglecheckbox" class="toctogglecheckbox" style="display:none"><div class="toctitle" lang="en" dir="ltr">
<h2 id="mw-toc-heading">Contents</h2>
<span class="toctogglespan"><label class="toctogglelabel" for="toctogglecheckbox"></label></span>
</div>
<ul>
<li class="toclevel-1 tocsection-1">
<a href="#Installation"><span class="tocnumber">1</span> <span class="toctext">Installation</span></a>
<ul>
<li class="toclevel-2 tocsection-2">
<a href="#Japanese_fonts"><span class="tocnumber">1.1</span> <span class="toctext">Japanese fonts</span></a>
<ul>
<li class="toclevel-3 tocsection-3"><a href="#Sans-serif"><span class="tocnumber">1.1.1</span> <span class="toctext">Sans-serif</span></a></li>
<li class="toclevel-3 tocsection-4"><a href="#Serif_and_Sans-serif"><span class="tocnumber">1.1.2</span> <span class="toctext">Serif and Sans-serif</span></a></li>
</ul>
</li>
<li class="toclevel-2 tocsection-5"><a href="#uim"><span class="tocnumber">1.2</span> <span class="toctext">uim</span></a></li>
<li class="toclevel-2 tocsection-6">
<a href="#Input_method"><span class="tocnumber">1.3</span> <span class="toctext">Input method</span></a>
<ul>
<li class="toclevel-3 tocsection-7">
<a href="#Anthy"><span class="tocnumber">1.3.1</span> <span class="toctext">Anthy</span></a>
<ul>
<li class="toclevel-4 tocsection-8"><a href="#Extra_dictionary"><span class="tocnumber">1.3.1.1</span> <span class="toctext">Extra dictionary</span></a></li>
</ul>
</li>
<li class="toclevel-3 tocsection-9"><a href="#Modified_Anthy_(anthy-ut)"><span class="tocnumber">1.3.2</span> <span class="toctext">Modified Anthy (anthy-ut)</span></a></li>
<li class="toclevel-3 tocsection-10">
<a href="#Mozc"><span class="tocnumber">1.3.3</span> <span class="toctext">Mozc</span></a>
<ul>
<li class="toclevel-4 tocsection-11"><a href="#Mozc_(Vanilla)"><span class="tocnumber">1.3.3.1</span> <span class="toctext">Mozc (Vanilla)</span></a></li>
<li class="toclevel-4 tocsection-12"><a href="#mozc-ut"><span class="tocnumber">1.3.3.2</span> <span class="toctext">mozc-ut</span></a></li>
<li class="toclevel-4 tocsection-13"><a href="#Registering_Mozc"><span class="tocnumber">1.3.3.3</span> <span class="toctext">Registering Mozc</span></a></li>
</ul>
</li>
<li class="toclevel-3 tocsection-14"><a href="#Google_CGI_API_for_Japanese_input"><span class="tocnumber">1.3.4</span> <span class="toctext">Google CGI API for Japanese input</span></a></li>
</ul>
</li>
</ul>
</li>
<li class="toclevel-1 tocsection-15">
<a href="#Settings"><span class="tocnumber">2</span> <span class="toctext">Settings</span></a>
<ul>
<li class="toclevel-2 tocsection-16"><a href="#Environment_variables"><span class="tocnumber">2.1</span> <span class="toctext">Environment variables</span></a></li>
<li class="toclevel-2 tocsection-17">
<a href="#Toolbar_utilities"><span class="tocnumber">2.2</span> <span class="toctext">Toolbar utilities</span></a>
<ul>
<li class="toclevel-3 tocsection-18"><a href="#uim-toolbar-gtk/qt"><span class="tocnumber">2.2.1</span> <span class="toctext">uim-toolbar-gtk/qt</span></a></li>
<li class="toclevel-3 tocsection-19"><a href="#uim-toolbar-gtk-systray"><span class="tocnumber">2.2.2</span> <span class="toctext">uim-toolbar-gtk-systray</span></a></li>
</ul>
</li>
<li class="toclevel-2 tocsection-20"><a href="#Using_systemd"><span class="tocnumber">2.3</span> <span class="toctext">Using systemd</span></a></li>
<li class="toclevel-2 tocsection-21"><a href="#uim_preferences"><span class="tocnumber">2.4</span> <span class="toctext">uim preferences</span></a></li>
<li class="toclevel-2 tocsection-22">
<a href="#Input_Japanese_on_Emacs"><span class="tocnumber">2.5</span> <span class="toctext">Input Japanese on Emacs</span></a>
<ul>
<li class="toclevel-3 tocsection-23">
<a href="#LEIM_or_minor-mode"><span class="tocnumber">2.5.1</span> <span class="toctext">LEIM or minor-mode</span></a>
<ul>
<li class="toclevel-4 tocsection-24"><a href="#Settings_for_the_minor-mode"><span class="tocnumber">2.5.1.1</span> <span class="toctext">Settings for the minor-mode</span></a></li>
<li class="toclevel-4 tocsection-25"><a href="#Settings_for_the_LEIM"><span class="tocnumber">2.5.1.2</span> <span class="toctext">Settings for the LEIM</span></a></li>
</ul>
</li>
<li class="toclevel-3 tocsection-26"><a href="#Preferred_character_encoding"><span class="tocnumber">2.5.2</span> <span class="toctext">Preferred character encoding</span></a></li>
<li class="toclevel-3 tocsection-27"><a href="#Enable_inline_candidates_displaying_mode_by_default"><span class="tocnumber">2.5.3</span> <span class="toctext">Enable inline candidates displaying mode by default</span></a></li>
<li class="toclevel-3 tocsection-28"><a href="#Set_Hiragana_input_mode_by_default"><span class="tocnumber">2.5.4</span> <span class="toctext">Set Hiragana input mode by default</span></a></li>
<li class="toclevel-3 tocsection-29"><a href="#Ignoring_C-SPC_on_uim.el"><span class="tocnumber">2.5.5</span> <span class="toctext">Ignoring C-SPC on uim.el</span></a></li>
<li class="toclevel-3 tocsection-30"><a href="#Disabling_XIM_on_Emacs"><span class="tocnumber">2.5.6</span> <span class="toctext">Disabling XIM on Emacs</span></a></li>
</ul>
</li>
</ul>
</li>
<li class="toclevel-1 tocsection-31">
<a href="#Troubleshooting"><span class="tocnumber">3</span> <span class="toctext">Troubleshooting</span></a>
<ul>
<li class="toclevel-2 tocsection-32"><a href="#Set_the_GTK_IM_MODULE_variable,_but_uim_still_does_not_work_with_GTK_2_applications"><span class="tocnumber">3.1</span> <span class="toctext">Set the GTK_IM_MODULE variable, but uim still does not work with GTK 2 applications</span></a></li>
<li class="toclevel-2 tocsection-33"><a href="#Cannot_input_Japanese_on_Opera"><span class="tocnumber">3.2</span> <span class="toctext">Cannot input Japanese on Opera</span></a></li>
<li class="toclevel-2 tocsection-34"><a href="#Cannot_type_a_consonant_in_Zenkaku_mode"><span class="tocnumber">3.3</span> <span class="toctext">Cannot type a consonant in Zenkaku mode</span></a></li>
<li class="toclevel-2 tocsection-35"><a href="#uim-toolbar-gtk-systray:_tray_icon_is_crushed"><span class="tocnumber">3.4</span> <span class="toctext">uim-toolbar-gtk-systray: tray icon is crushed</span></a></li>
<li class="toclevel-2 tocsection-36"><a href="#I_use_darker_theme,_I_cannot_read_the_uim_mode_icons"><span class="tocnumber">3.5</span> <span class="toctext">I use darker theme, I cannot read the uim mode icons</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-37"><a href="#See_also"><span class="tocnumber">4</span> <span class="toctext">See also</span></a></li>
</ul>
</div>

<h2><span class="mw-headline" id="Installation">Installation</span></h2>
<p>You need the following packages to input Japanese.
</p>
<ul>
<li>Japanese fonts</li>
<li>Japanese input method (Kana to Kanji conversion engine)</li>
<li>Input method framework: uim</li>
</ul>
<h3><span class="mw-headline" id="Japanese_fonts">Japanese fonts</span></h3>
<p><i>see also <a href="../en/Fonts.html" title="Fonts">Fonts</a> and <a href="../en/Font_configuration.html" title="Font configuration">Font configuration</a> for configuration or more detail.</i>
</p>
<p>Recommended Japanese fonts are as follows.
</p>
<h4><span class="mw-headline" id="Sans-serif">Sans-serif</span></h4>
<ul><li>
<a rel="nofollow" class="external text" href="https://github.com/adobe-fonts/source-han-sans">adobe-source-han-sans</a> || <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=adobe-source-han-sans-jp-fonts">adobe-source-han-sans-jp-fonts</a></span> or <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=adobe-source-han-sans-otc-fonts">adobe-source-han-sans-otc-fonts</a></span>
</li></ul>
<dl><dd>Open-source OTF fonts developed by Adobe.</dd></dl>
<h4><span class="mw-headline" id="Serif_and_Sans-serif">Serif and Sans-serif</span></h4>
<ul><li>
<a rel="nofollow" class="external text" href="https://web.archive.org/web/20200429044000/https://ipafont.ipa.go.jp/">IPA fonts</a> || <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=otf-ipafont">otf-ipafont</a></span>
</li></ul>
<dl><dd>An open source OTF font set including sans-serif (Gothic) and serif (Mincho) glyphs provided by Information-technology Promotion Agency, Japan (IPA).</dd></dl>
<p>If you want to show <a href="https://en.wikipedia.org/wiki/2channel_Shift_JIS_art" class="extiw" title="wikipedia:2channel Shift JIS art">2channel Shift JIS art</a> properly, use the following fonts:
</p>
<ul><li>Monapo font (AUR: <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://aur.archlinux.org/packages/ttf-monapo/">ttf-monapo</a></span><sup><small>AUR</small></sup>)</li></ul>
<h3><span class="mw-headline" id="uim">uim</span></h3>
<p><a href="../en/Help:Reading.html#Installation_of_packages" class="mw-redirect" title="Install">Install</a> the <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=uim">uim</a></span> package.
</p>
<h3><span class="mw-headline" id="Input_method">Input method</span></h3>
<h4><span class="mw-headline" id="Anthy">Anthy</span></h4>
<p>Anthy is one of the most popular Japanese input methods in the open source world. However, it has not been maintained for a long time. <a rel="nofollow" class="external text" href="https://wiki.debian.org/Teams/DebianAnthy">Debian succeeds it</a> from May 2010.
</p>
<p>Install <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=anthy">anthy</a></span> from the official repositories.
</p>
<h5><span class="mw-headline" id="Extra_dictionary">Extra dictionary</span></h5>
<p>Anthy's default dictionary does not include several characters which are not specified on EUC-JP (JIS X 0208) such as "①", "♥", etc. <a rel="nofollow" class="external text" href="http://en.sourceforge.jp/projects/alt-cannadic/">alt-cannadic</a> provides extra dictionaries including those characters.
</p>
<p>Get <a rel="nofollow" class="external text" href="http://en.sourceforge.jp/projects/alt-cannadic/releases/?package_id=6129">alt-cannadic dictionary</a> and put them under your <code>~/.anthy/imported_words_default.d</code>.
</p>
<pre>$ tar jxvf alt-cannadic-091230.tar.bz2
$ mkdir ~/.anthy/imported_words_default.d (if not exist)
$ cp alt-cannadic-091230/extra/*.t ~/.anthy/imported_words_default.d/
</pre>
<p>Please see <a rel="nofollow" class="external text" href="https://sourceforge.jp/projects/alt-cannadic/wiki/%E4%BD%BF%E3%81%84%E6%96%B9_Anthy-UTF-8">official wiki</a> for more detail (Japanese).
</p>
<div class="archwiki-template-box archwiki-template-box-warning">
<strong>Warning:</strong> If you will be using this extra dictionary, choose <b>Anthy (UTF-8)</b> for default input method on uim.</div>
<h4>
<span id="Modified_Anthy_.28anthy-ut.29"></span><span class="mw-headline" id="Modified_Anthy_(anthy-ut)">Modified Anthy (anthy-ut)</span>
</h4>
<p><a rel="nofollow" class="external text" href="https://web.archive.org/web/20160815115402/http://www.geocities.jp/ep3797/anthy_dict_01.html">Modified Anthy</a> is a set of patches and huge extended dictionaries which aims to improve the Kana to Kanji conversion quality of original Anthy.
</p>
<p>Modified Anthy consists two different upstreams:
</p>
<ul>
<li>Patched source of Anthy by <a rel="nofollow" class="external text" href="http://www.fenix.ne.jp/~G-HAL/soft/nosettle/#anthy">G-HAL</a>
</li>
<li>Huge extended dictionalies by <a rel="nofollow" class="external text" href="https://web.archive.org/web/20160815115402/http://www.geocities.jp/ep3797/anthy_dict_01.html">UTSUMI</a>
</li>
</ul>
<div class="archwiki-template-box archwiki-template-box-warning">
<strong>Warning:</strong> 
<ul>
<li>Modified Anthy applies to only Anthy (UTF-8). So you have to choose <b>Anthy (UTF-8)</b> for default input method on uim.</li>
<li>Modified Anthy does not have compatibility of the dictionaries and learning data with original Anthy.</li>
</ul>
</div>
<h4><span class="mw-headline" id="Mozc">Mozc</span></h4>
<p><i>See <a href="../en/Mozc.html" title="Mozc">Mozc</a>.</i>
</p>
<p><a rel="nofollow" class="external text" href="https://code.google.com/p/mozc/">Mozc</a> is a Japanese Input Method Editor (IME) designed for multi-platform such as Chromium OS, Windows, Mac and Linux which originates from <a rel="nofollow" class="external text" href="http://www.google.com/intl/ja/ime/">Google Japanese Input</a>.
</p>
<p>Though <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://aur.archlinux.org/packages/Mozc/">Mozc</a></span><sup><small>AUR</small></sup> adapts to only ibus input method framework, <a rel="nofollow" class="external text" href="https://code.google.com/p/macuim/">macuim</a> provides uim-mozc plugin.
</p>
<h5>
<span id="Mozc_.28Vanilla.29"></span><span class="mw-headline" id="Mozc_(Vanilla)">Mozc (Vanilla)</span>
</h5>
<p><span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://aur.archlinux.org/packages/uim-mozc/">uim-mozc</a></span><sup><small>AUR</small></sup> is available on AUR.
</p>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Note:</strong> This does not support the kill_line feature of uim-mozc.</div>
<p>You can install this from the unofficial <a href="../en/Unofficial_user_repositories.html#pnsft-pur" title="Unofficial user repositories">pnsft-pur</a> user repository.
</p>
<p>You can choose to install all packages in the <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/groups/x86_64/mozc-im/">mozc-im</a></span><sup>[<a href="../en/Help:Procedures.html#Fix_broken_package_links" title="Help:Procedures">broken link</a>: package not found]</sup> group by specifying the group name.
</p>
<p>Or, specify the individual package names directly. For example install <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://aur.archlinux.org/packages/uim-mozc/">uim-mozc</a></span><sup><small>AUR</small></sup>.
</p>
<h5><span class="mw-headline" id="mozc-ut">mozc-ut</span></h5>
<p><span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://aur.archlinux.org/packages/mozc-ut2/">mozc-ut2</a></span><sup><small>AUR</small></sup> can be built uim-mozc.
</p>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Note:</strong> mozc-ut can work with <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://aur.archlinux.org/packages/uim-mozc/">uim-mozc</a></span><sup><small>AUR</small></sup>.</div>
<p>To build uim-mozc, edit PKGBUILD like follow, i,e. uncomment <code>_uim_mozc=</code> line:
</p>
<pre>## If you will not be using ibus, comment out below.
_ibus_mozc="yes"
## If you will be using uim, uncomment below.
_uim_mozc="yes"
## If applying patch for uim-mozc fails, try to uncomment below.
#_kill_kill_line="yes"
## This will disable the 'kill-line' function of uim-mozc.
</pre>
<div class="archwiki-template-box archwiki-template-box-tip">
<strong>Tip:</strong> If you will never be using ibus-mozc, comment out the <code>_ibus_mozc=</code> line.</div>
<h5><span class="mw-headline" id="Registering_Mozc">Registering Mozc</span></h5>
<div class="archwiki-template-box archwiki-template-box-warning">
<strong>Warning:</strong> You <b>must</b> run the following command whenever you upgrade or (re-)install uim.<br>
 # uim-module-manager --register mozc</div>
<h4><span class="mw-headline" id="Google_CGI_API_for_Japanese_input">Google CGI API for Japanese input</span></h4>
<p><a rel="nofollow" class="external text" href="https://www.google.co.jp/ime/cgiapi.html">Google CGI API for Japanese Input</a> (Google-CGIAPI-Jp) is CGI service to provide Japanese conversion on the Internet by Google. It can be used on <a rel="nofollow" class="external text" href="http://www.google.com/transliterate">web browser</a>. Its conversion engine seems to be equivalent to Google Japanese Input, so conversion quality is probably better than Mozc.
</p>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Note:</strong> This service sends/receives preedits and candidates as plain text (as of 2012-09).</div>
<p>You can use it via uim. Choose "Google-CGIAPI-Jp" on uim-im-switcher-gtk/gtk3/qt4 or uim-pref-gtk/gtk3/qt4.
</p>
<h2><span class="mw-headline" id="Settings">Settings</span></h2>
<h3><span class="mw-headline" id="Environment_variables">Environment variables</span></h3>
<p>Add the following to ~/.<a href="../en/Xprofile.html" title="Xprofile">xprofile</a>, ~/.<a href="../en/Xinit.html#xinitrc" class="mw-redirect" title="Xinitrc">xinitrc</a> or ~/.xsession:
</p>
<pre>export GTK_IM_MODULE='uim'
export QT_IM_MODULE='uim'
uim-xim &amp;
export XMODIFIERS='@im=uim'
</pre>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Note:</strong> The variables should be exported before starting your desktop environment, i.e. before "exec startxfce4" or similar. <a href="#Using_systemd">See below</a> if you're using systemd to manage your X session. </div>
<h3><span class="mw-headline" id="Toolbar_utilities">Toolbar utilities</span></h3>
<p>If you want to use UimToolbar utilities which shows and controls uim mode, add <b>one</b> of the followings, too.
</p>
<h4>
<span id="uim-toolbar-gtk.2Fqt"></span><span class="mw-headline" id="uim-toolbar-gtk/qt">uim-toolbar-gtk/qt</span>
</h4>
<p>Using toolbar appears as a window.
</p>
<p>For GTK 2:
</p>
<pre>uim-toolbar-gtk &amp;
</pre>
<p>For GTK 3:
</p>
<pre>uim-toolbar-gtk3 &amp;
</pre>
<p>For Qt4:
</p>
<pre>uim-toolbar-qt4 &amp;
</pre>
<h4><span class="mw-headline" id="uim-toolbar-gtk-systray">uim-toolbar-gtk-systray</span></h4>
<p>Using toolbar for system tray.
</p>
<p>For GTK 2:
</p>
<pre>uim-toolbar-gtk-systray &amp;
</pre>
<p>For GTK 3:
</p>
<pre>uim-toolbar-gtk3-systray &amp;
</pre>
<h3><span class="mw-headline" id="Using_systemd">Using systemd</span></h3>
<p>If you are <a href="../en/Systemd/User.html#Xorg_and_systemd" title="Systemd/User">using systemd to manage your X session</a>, you'll need to set the environment variables in your systemd session rather than an init script.
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">~/.config/systemd/user/uim-env.service</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">[Unit]
Description=uim environment initialization
Before=xorg.target

[Service]
Type=oneshot
ExecStart=/usr/bin/systemctl --user set-environment XMODIFIERS=@im=uim
ExecStart=/usr/bin/systemctl --user set-environment GTK_IM_MODULE=uim
ExecStart=/usr/bin/systemctl --user set-environment QT_IM_MODULE=uim
</pre>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">~/.config/systemd/user/uim.service</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">[Unit]
Description=uim daemon
Wants=uim-env.service
After=xorg.target

[Service]
ExecStart=/usr/bin/uim-xim
Restart=on-abort

[Install]
WantedBy=xorg.target
</pre>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">~/.config/systemd/user/uim-toolbar.service</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">[Unit]
Description=uim toolbar
PartOf=uim.service

[Service]
ExecStart=/usr/bin/uim-toolbar-of-your-choice
Restart=on-abort

[Install]
WantedBy=uim.service
</pre>
<p>Lastly, you'll need to enable the services:
</p>
<pre> $ systemctl --user enable uim.service uim-toolbar.service
</pre>
<h3><span class="mw-headline" id="uim_preferences">uim preferences</span></h3>
<p>Configure uim preferences by running :
</p>
<pre>$ uim-pref-gtk (Or, uim-pref-gtk3/uim-pref-qt4)
</pre>
<p>which brings forth a GUI.
</p>
<p>Choose your preferring input method as 'Default input method'.
</p>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Note:</strong> Mozc will be not listed in 'Default input method' at first time so you will need to add it into 'Enabled input methods' to use.</div>
<p>You can run <code>uim-xim</code> or restart X to test your settings.
</p>
<p>Provided everything went well you should be able to input Japanese in X.
</p>
<h3><span class="mw-headline" id="Input_Japanese_on_Emacs">Input Japanese on Emacs</span></h3>
<p>uim provides uim.el the bridge software between Emacs and uim. Here is a sample to use uim on Emacs with utf-8 encoding. 
</p>
<p>Please see <a rel="nofollow" class="external text" href="https://code.google.com/p/uim/wiki/UimEl">Official wiki</a> for more detail.
</p>
<h4><span class="mw-headline" id="LEIM_or_minor-mode">LEIM or minor-mode</span></h4>
<p>You can call uim.el from Emacs in two ways; directly or with the LEIM (Library of Emacs Input Method) framework. Though settings of them are different, basic functions are same. If you want to switch between uim.el and other Emacs IMs frequently, you should use LEIM framework.
</p>
<h5><span class="mw-headline" id="Settings_for_the_minor-mode">Settings for the minor-mode</span></h5>
<p>If you will be using on minor-mode, write the following settings into your <code>.emacs.d/init.el</code> or some other file for Emacs customizing.
</p>
<pre>;; read uim.el
(require 'uim)
;; uncomment next and comment out previous to load uim.el on-demand
;; (autoload 'uim-mode "uim" nil t)

;; key-binding for activate uim (ex. C-\)
(global-set-key "\C-\\" 'uim-mode)
</pre>
<h5><span class="mw-headline" id="Settings_for_the_LEIM">Settings for the LEIM</span></h5>
<p>If you will be using via LEIM, write the following settings into your <code>.emacs.d/init.el</code> or some other file for Emacs customizing and choose default input method.
</p>
<pre>;; read uim.el with LEIM initializing
(require 'uim-leim)

;; set default IM. Uncomment the one of the followings.
;(setq default-input-method "japanese-anthy-utf8-uim")        ; Anthy (UTF-8)
;(setq default-input-method "japanese-google-cgiapi-jp-uim")  ; Google-CGIAPI-Jp
;(setq default-input-method "japanese-mozc-uim")              ; Mozc
</pre>
<h4><span class="mw-headline" id="Preferred_character_encoding">Preferred character encoding</span></h4>
<p>uim.el uses euc-jp character encoding by default. To set UTF-8 as preferred encodings, add the followings into your <code>.emacs.d/init.el</code> or some other file for Emacs customizing.
</p>
<pre>;; Set UTF-8 as preferred character encoding (default is euc-jp).
(setq uim-lang-code-alist
      (cons '("Japanese" "Japanese" utf-8 "UTF-8")
           (delete (assoc "Japanese" uim-lang-code-alist) 
                   uim-lang-code-alist)))
</pre>
<h4><span class="mw-headline" id="Enable_inline_candidates_displaying_mode_by_default">Enable inline candidates displaying mode by default</span></h4>
<p>The inline candidates displaying mode displays conversion candidates just below (or above) preedit text vertically instead of echo area. If you want to enable inline candidates displaying mode by default, write as follows.
</p>
<pre>;; set inline candidates displaying mode as default
(setq uim-candidate-display-inline t)
</pre>
<h4><span class="mw-headline" id="Set_Hiragana_input_mode_by_default">Set Hiragana input mode by default</span></h4>
<p>To set Hiragana input mode at activting uim, add the settings like follows:
</p>
<pre>;; Set Hiragana input mode at activating uim.
(setq uim-default-im-prop '("action_anthy_utf8_hiragana"
                            "action_google-cgiapi-jp_hiragana"
                            "action_mozc_hiragana"))
</pre>
<h4><span class="mw-headline" id="Ignoring_C-SPC_on_uim.el">Ignoring C-SPC on uim.el</span></h4>
<p>When you are assigning activation/deactivation of input method to C-SPC, C-SPC is stolen to switch input mode by uim.el while it is activated. To prevent the stealing and use for set-mark-command, add the followings into your <code>.emacs.d/init.el</code> or some other file for Emacs customizing.
</p>
<pre>(add-hook 'uim-load-hook
          '(lambda ()
             (define-key uim-mode-map [67108896] nil)
             (define-key uim-mode-map [0] nil)))
</pre>
<h4><span class="mw-headline" id="Disabling_XIM_on_Emacs">Disabling XIM on Emacs</span></h4>
<p>When you are using input method on your desktop and assigning activation/deactivation of input method to C-SPC, you will be not able to use C-SPC/C-@ as set-mark-command on Emacs. To avoid this problem, add the following into your <code>~/.Xresources</code> or <code>~/.Xdefaults</code>. xim will be disabled on Emacs.
</p>
<pre>Emacs*UseXIM: false
</pre>
<h2><span class="mw-headline" id="Troubleshooting">Troubleshooting</span></h2>
<h3>
<span id="Set_the_GTK_IM_MODULE_variable.2C_but_uim_still_does_not_work_with_GTK_2_applications"></span><span class="mw-headline" id="Set_the_GTK_IM_MODULE_variable,_but_uim_still_does_not_work_with_GTK_2_applications">Set the GTK_IM_MODULE variable, but uim still does not work with GTK 2 applications</span>
</h3>
<p>In case you already set the GTK_IM_MODULE environmental variable, but uim still does not work with GTK 2 applications, you need to specify the location of gtk.immodules, which is created by and can be generated with <code>gtk-query-immodules-2.0</code>.
</p>
<p>The default location is <code>/etc/gtk-2.0/gtk.immodules</code> for GTK 2.
</p>
<p>You can do this with either the GTK_IM_MODULE_FILE variable (<i>not recommended</i>, it causes GTK 3 applications to see incompatible modules) or the im_module_file setting (<i>recommended</i>).
</p>
<p>Add the following to <code>/etc/gtk-2.0/gtkrc</code> or <code>~/.gtkrc-2.0</code>:
</p>
<pre> im_module_file "/etc/gtk-2.0/gtk.immodules"
</pre>
<h3><span class="mw-headline" id="Cannot_input_Japanese_on_Opera">Cannot input Japanese on Opera</span></h3>
<p>If you use Opera and cannot input Japanese with uim, try to edit environment variable as follows:
Make sure to add the following to the beginning of /usr/bin/opera.
</p>
<pre>export XMODIFIERS='@im=uim'
export QT_IM_MODULE='xim'
</pre>
<h3><span class="mw-headline" id="Cannot_type_a_consonant_in_Zenkaku_mode">Cannot type a consonant in Zenkaku mode</span></h3>
<p>If you cannot type a consonant in Zenkaku mode, add the following to your config file.
</p>
<pre>   e.g.  vi ~/.uim.d/customs/custom-google-cgiapi-jp.scm
    
   (define ja-rk-rule-hoge
   (map
   (lambda (c)
   (list (cons (list c) ()) (list c c c)))
   '("b" "c" "d" "f" "g" "h" "j" "k" "l" "m"
   "p" "q" "r" "s" "t" "v" "w" "x" "y" "z"
   "A" "B" "C" "D" "E" "F" "G" "H" "I" "J" "K" "L" "M"
   "N" "O" "P" "Q" "R" "S" "T" "U" "V" "W" "X" "Y" "Z")))
   (if (symbol-bound? 'ja-rk-rule-hoge)
   (set! ja-rk-rule (append ja-rk-rule-hoge ja-rk-rule)))
</pre>
<h3><span class="mw-headline" id="uim-toolbar-gtk-systray:_tray_icon_is_crushed">uim-toolbar-gtk-systray: tray icon is crushed</span></h3>
<p>Though some of DE, WM or panel application  may provide only one icon space per application on system-tray/notification-area, uim-toolbar-gtk-systray displays some icons on it by default so those icons are crushed. Choose just one of them to solve it. The steps to display only 'Input mode' icon for example as follows:
</p>
<ol>
<li>Run <code>uim-pref-gtk</code>.</li>
<li>Click 'Toolbar' on 'Group' list.</li>
<li>Take the all checkmarks off.</li>
<li>Click 'Anthy', 'Anthy (UTF-8)' or 'Mozc' which you are using on 'Group' list.</li>
<li>Click Edit button in 'Toolbar' box &gt; 'Enable toolbar buttons' line.</li>
<li>Enable only 'Input mode' and click 'Close' button.</li>
<li>Click 'OK' button to close uim-pref-gtk.</li>
</ol>
<p>The tray icon will be displayed "あ" (Hiragana mode) or "ー" (Direct mode).
</p>
<h3>
<span id="I_use_darker_theme.2C_I_cannot_read_the_uim_mode_icons"></span><span class="mw-headline" id="I_use_darker_theme,_I_cannot_read_the_uim_mode_icons">I use darker theme, I cannot read the uim mode icons</span>
</h3>
<p>You can choose icons for darker background (uim 1.6.0 or later).
</p>
<ol>
<li>Run uim-perf-gtk</li>
<li>Click 'Toolbar' on 'Group' list.</li>
<li>Check 'Use icon for dark background'.</li>
</ol>
<h2><span class="mw-headline" id="See_also">See also</span></h2>
<dl>
<dt>uim</dt>
<dd><a rel="nofollow" class="external text" href="https://github.com/uim/uim/wiki/OfficialUserDocument">uim official document</a></dd>
<dd><a rel="nofollow" class="external text" href="https://en.wikibooks.org/wiki/Uim">uim on wikibooks</a></dd>
</dl>
<dl>
<dt>Fonts</dt>
<dd><a rel="nofollow" class="external text" href="http://linuxplayers.g1.xrea.com/japanese_fonts.html">Japanese fonts showcase</a></dd>
<dd><a rel="nofollow" class="external text" href="http://linuxplayers.g1.xrea.com/modified_fonts_01.html">modified Japanese fonts</a></dd>
</dl>
</div>
</div>
<div id="catlinks" class="catlinks" data-mw="interface">
<div id="mw-normal-catlinks" class="mw-normal-catlinks">
<a href="../Special:Categories.html" title="Special:Categories">Category</a>: <ul><li><a href="../en/Category:Localization.html" title="Category:Localization">Localization</a></li></ul>
</div>
<div id="mw-hidden-catlinks" class="mw-hidden-catlinks mw-hidden-cats-hidden">Hidden categories: <ul>
<li><a href="../en/Category:Pages_or_sections_flagged_with_Template:Move.html" title="Category:Pages or sections flagged with Template:Move">Pages or sections flagged with Template:Move</a></li>
<li><a href="../en/Category:Pages_with_broken_package_links.html" title="Category:Pages with broken package links">Pages with broken package links</a></li>
</ul>
</div>
</div>
	</div>
</div>

<footer id="footer" class="mw-footer" role="contentinfo" style="margin: 0">
	<ul id="footer-info">
		<li>Retrieved from "<a dir="ltr" href="https://wiki.archlinux.org/index.php?title=Input_Japanese_using_uim&amp;oldid=661574">https://wiki.archlinux.org/index.php?title=Input_Japanese_using_uim&amp;oldid=661574</a>"</li>
		<li id="footer-info-lastmod"> This page was last edited on 18 April 2021, at 11:06.</li>
		<li id="footer-info-copyright">Content is available under <a class="external" rel="nofollow" href="http://www.gnu.org/copyleft/fdl.html">GNU Free Documentation License 1.3 or later</a> unless otherwise noted.</li>
	<br>
</ul>
	<ul id="footer-places">
		<li id="footer-places-privacy"><a href="../en/ArchWiki:Privacy_policy.html" title="ArchWiki:Privacy policy">Privacy policy</a></li>
		<li id="footer-places-about"><a href="../en/ArchWiki:About.html" title="ArchWiki:About">About ArchWiki</a></li>
		<li id="footer-places-disclaimer"><a href="../en/ArchWiki:General_disclaimer.html" title="ArchWiki:General disclaimer">Disclaimers</a></li>
	</ul>
	<ul id="footer-icons" class="noprint">
		<li id="footer-copyrightico">
	</ul>
	<div style="clear: both;"></div>
</footer>



</body>
</html>
