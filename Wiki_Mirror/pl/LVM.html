<!DOCTYPE html>
<html class="client-nojs" lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<title>LVM (Polski) - ArchWiki</title>
<link rel="stylesheet" href="../ArchWikiOffline.css">
<meta name="ResourceLoaderDynamicStyles" content="">
<meta name="generator" content="MediaWiki 1.35.0">
<meta name="referrer" content="no-referrer-when-downgrade">
<meta name="robots" content="noindex,follow">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="shortcut icon" href="/favicon.ico">
<link rel="search" type="application/opensearchdescription+xml" href="/opensearch_desc.php" title="ArchWiki (en)">
<link rel="EditURI" type="application/rsd+xml" href="https://wiki.archlinux.org/api.php?action=rsd">
<link rel="license" href="http://www.gnu.org/copyleft/fdl.html">
<link rel="alternate" type="application/atom+xml" title="ArchWiki Atom feed" href="/index.php?title=Special:RecentChanges&amp;feed=atom">
</head>
<body class="mediawiki ltr sitedir-ltr mw-hide-empty-elt ns-0 ns-subject page-LVM_Polski rootpage-LVM_Polski skin-vector action-view skin-vector-legacy">
<div id="content" class="mw-body" role="main" style="margin: 0">
	<a id="top"></a>
	<div id="siteNotice" class="mw-body-content"></div>
	<div class="mw-indicators mw-body-content">
	</div>
	<h1 id="firstHeading" class="firstHeading" lang="en">LVM (Polski)</h1>
	<div id="bodyContent" class="mw-body-content">
		<div id="siteSub" class="noprint">From ArchWiki</div>
		<div id="contentSub"></div>
		<div id="contentSub2"></div>
		
		<div id="jump-to-nav"></div>
		<a class="mw-jump-link" href="#mw-head">Jump to navigation</a>
		<a class="mw-jump-link" href="#searchInput">Jump to search</a>
		<div id="mw-content-text" lang="en" dir="ltr" class="mw-content-ltr">
<div class="warningbox">The printable version is no longer supported and may have rendering errors. Please update your browser bookmarks and please use the default browser print function instead.</div>
<div class="mw-parser-output">
<p>From <a href="https://en.wikipedia.org/wiki/Logical_Volume_Manager_(Linux)" class="extiw" title="wikipedia:Logical Volume Manager (Linux)">Wikipedia:Logical Volume Manager (Linux)</a>:
</p>
<dl><dd>LVM is a <a href="https://en.wikipedia.org/wiki/logical_volume_management" class="extiw" title="wikipedia:logical volume management">logicznym menedżerem woluminów</a> dla <a href="https://en.wikipedia.org/wiki/Linux_kernel" class="extiw" title="wikipedia:Linux kernel">Linux kernel</a>; zarządza dyskami i podobnymi urządzeniami pamięci masowej.</dd></dl>
<div id="toc" class="toc" role="navigation" aria-labelledby="mw-toc-heading">
<input type="checkbox" role="button" id="toctogglecheckbox" class="toctogglecheckbox" style="display:none"><div class="toctitle" lang="en" dir="ltr">
<h2 id="mw-toc-heading">Contents</h2>
<span class="toctogglespan"><label class="toctogglelabel" for="toctogglecheckbox"></label></span>
</div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#LVM_Building_Blocks"><span class="tocnumber">1</span> <span class="toctext">LVM Building Blocks</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#Zalety"><span class="tocnumber">2</span> <span class="toctext">Zalety</span></a></li>
<li class="toclevel-1 tocsection-3"><a href="#Wady"><span class="tocnumber">3</span> <span class="toctext">Wady</span></a></li>
<li class="toclevel-1 tocsection-4">
<a href="#Instalowanie_Arch_Linux_na_LVM"><span class="tocnumber">4</span> <span class="toctext">Instalowanie Arch Linux na LVM</span></a>
<ul>
<li class="toclevel-2 tocsection-5"><a href="#Utw%C3%B3rz_partycje"><span class="tocnumber">4.1</span> <span class="toctext">Utwórz partycje</span></a></li>
<li class="toclevel-2 tocsection-6"><a href="#Utw%C3%B3rz_woluminy_fizyczne"><span class="tocnumber">4.2</span> <span class="toctext">Utwórz woluminy fizyczne</span></a></li>
<li class="toclevel-2 tocsection-7"><a href="#Utw%C3%B3rz_grup%C4%99_wolumin%C3%B3w"><span class="tocnumber">4.3</span> <span class="toctext">Utwórz grupę woluminów</span></a></li>
<li class="toclevel-2 tocsection-8"><a href="#Utw%C3%B3rz_PV_i_VG_w_jednym_kroku"><span class="tocnumber">4.4</span> <span class="toctext">Utwórz PV i VG w jednym kroku</span></a></li>
<li class="toclevel-2 tocsection-9"><a href="#Utw%C3%B3rz_woluminy_logiczne"><span class="tocnumber">4.5</span> <span class="toctext">Utwórz woluminy logiczne</span></a></li>
<li class="toclevel-2 tocsection-10"><a href="#Tw%C3%B3rzenie_system%C3%B3w_plik%C3%B3w_i_montowanie_wolumin%C3%B3w_logicznych"><span class="tocnumber">4.6</span> <span class="toctext">Twórzenie systemów plików i montowanie woluminów logicznych</span></a></li>
<li class="toclevel-2 tocsection-11"><a href="#Skonfiguruj_mkinitcpio"><span class="tocnumber">4.7</span> <span class="toctext">Skonfiguruj mkinitcpio</span></a></li>
<li class="toclevel-2 tocsection-12"><a href="#Opcje_j%C4%85dra"><span class="tocnumber">4.8</span> <span class="toctext">Opcje jądra</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-13">
<a href="#Volume_operations"><span class="tocnumber">5</span> <span class="toctext">Volume operations</span></a>
<ul>
<li class="toclevel-2 tocsection-14"><a href="#Zaawansowane_opcje"><span class="tocnumber">5.1</span> <span class="toctext">Zaawansowane opcje</span></a></li>
<li class="toclevel-2 tocsection-15">
<a href="#Zmienianie_wielko%C5%9Bci_wolumin%C3%B3w"><span class="tocnumber">5.2</span> <span class="toctext">Zmienianie wielkości woluminów</span></a>
<ul>
<li class="toclevel-3 tocsection-16">
<a href="#wolumin%C3%B3w_fizycznych"><span class="tocnumber">5.2.1</span> <span class="toctext">woluminów fizycznych</span></a>
<ul>
<li class="toclevel-4 tocsection-17"><a href="#Growing"><span class="tocnumber">5.2.1.1</span> <span class="toctext">Growing</span></a></li>
<li class="toclevel-4 tocsection-18">
<a href="#Shrinking"><span class="tocnumber">5.2.1.2</span> <span class="toctext">Shrinking</span></a>
<ul>
<li class="toclevel-5 tocsection-19"><a href="#Move_physical_extents"><span class="tocnumber">5.2.1.2.1</span> <span class="toctext">Move physical extents</span></a></li>
<li class="toclevel-5 tocsection-20"><a href="#Zmie%C5%84_rozmiar_woluminu_fizycznego"><span class="tocnumber">5.2.1.2.2</span> <span class="toctext">Zmień rozmiar woluminu fizycznego</span></a></li>
<li class="toclevel-5 tocsection-21"><a href="#Zmie%C5%84_rozmiar_partycji"><span class="tocnumber">5.2.1.2.3</span> <span class="toctext">Zmień rozmiar partycji</span></a></li>
</ul>
</li>
</ul>
</li>
<li class="toclevel-3 tocsection-22">
<a href="#Logical_volumes"><span class="tocnumber">5.2.2</span> <span class="toctext">Logical volumes</span></a>
<ul>
<li class="toclevel-4 tocsection-23"><a href="#Growing_or_shrinking_with_lvresize"><span class="tocnumber">5.2.2.1</span> <span class="toctext">Growing or shrinking with lvresize</span></a></li>
<li class="toclevel-4 tocsection-24"><a href="#Rozszerzanie_woluminu_logicznego_i_systemu_plik%C3%B3w_za_jednym_razem"><span class="tocnumber">5.2.2.2</span> <span class="toctext">Rozszerzanie woluminu logicznego i systemu plików za jednym razem</span></a></li>
<li class="toclevel-4 tocsection-25"><a href="#Zmiana_rozmiaru_systemu_plik%C3%B3w_oddzielnie"><span class="tocnumber">5.2.2.3</span> <span class="toctext">Zmiana rozmiaru systemu plików oddzielnie</span></a></li>
</ul>
</li>
</ul>
</li>
<li class="toclevel-2 tocsection-26"><a href="#Remove_logical_volume"><span class="tocnumber">5.3</span> <span class="toctext">Remove logical volume</span></a></li>
<li class="toclevel-2 tocsection-27"><a href="#Dodaj_wolumin_fizyczny_do_grupy_wolumin%C3%B3w"><span class="tocnumber">5.4</span> <span class="toctext">Dodaj wolumin fizyczny do grupy woluminów</span></a></li>
<li class="toclevel-2 tocsection-28"><a href="#Usu%C5%84_partycj%C4%99_z_grupy_wolumin%C3%B3w"><span class="tocnumber">5.5</span> <span class="toctext">Usuń partycję z grupy woluminów</span></a></li>
<li class="toclevel-2 tocsection-29"><a href="#Dezaktywuj_grup%C4%99_wolumin%C3%B3w"><span class="tocnumber">5.6</span> <span class="toctext">Dezaktywuj grupę woluminów</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-30">
<a href="#Typy_wolumin%C3%B3w_logicznych"><span class="tocnumber">6</span> <span class="toctext">Typy woluminów logicznych</span></a>
<ul>
<li class="toclevel-2 tocsection-31">
<a href="#Migawki"><span class="tocnumber">6.1</span> <span class="toctext">Migawki</span></a>
<ul>
<li class="toclevel-3 tocsection-32"><a href="#Konfiguracja"><span class="tocnumber">6.1.1</span> <span class="toctext">Konfiguracja</span></a></li>
</ul>
</li>
<li class="toclevel-2 tocsection-33">
<a href="#LVM_cache"><span class="tocnumber">6.2</span> <span class="toctext">LVM cache</span></a>
<ul>
<li class="toclevel-3 tocsection-34"><a href="#Create_cache"><span class="tocnumber">6.2.1</span> <span class="toctext">Create cache</span></a></li>
<li class="toclevel-3 tocsection-35"><a href="#Usu%C5%84_pami%C4%99%C4%87_podr%C4%99czn%C4%85"><span class="tocnumber">6.2.2</span> <span class="toctext">Usuń pamięć podręczną</span></a></li>
</ul>
</li>
<li class="toclevel-2 tocsection-36">
<a href="#RAID"><span class="tocnumber">6.3</span> <span class="toctext">RAID</span></a>
<ul>
<li class="toclevel-3 tocsection-37"><a href="#Konfiguracja_RAID"><span class="tocnumber">6.3.1</span> <span class="toctext">Konfiguracja RAID</span></a></li>
<li class="toclevel-3 tocsection-38"><a href="#Skonfiguruj_mkinitcpio_dla_RAID"><span class="tocnumber">6.3.2</span> <span class="toctext">Skonfiguruj mkinitcpio dla RAID</span></a></li>
</ul>
</li>
</ul>
</li>
<li class="toclevel-1 tocsection-39"><a href="#Graficzna_konfiguracja"><span class="tocnumber">7</span> <span class="toctext">Graficzna konfiguracja</span></a></li>
<li class="toclevel-1 tocsection-40">
<a href="#Rozwi%C4%85zywanie_problem%C3%B3w"><span class="tocnumber">8</span> <span class="toctext">Rozwiązywanie problemów</span></a>
<ul>
<li class="toclevel-2 tocsection-41"><a href="#Zmiany,_kt%C3%B3re_mog%C4%85_by%C4%87_wymagane_ze_wzgl%C4%99du_na_zmiany_w_domy%C5%9Blnych_ustawieniach_Arch-Linux"><span class="tocnumber">8.1</span> <span class="toctext">Zmiany, które mogą być wymagane ze względu na zmiany w domyślnych ustawieniach Arch-Linux</span></a></li>
<li class="toclevel-2 tocsection-42"><a href="#Komendy_LVM_nie_dzia%C5%82aj%C4%85"><span class="tocnumber">8.2</span> <span class="toctext">Komendy LVM nie działają</span></a></li>
<li class="toclevel-2 tocsection-43"><a href="#Woluminy_logiczne_si%C4%99_nie_wy%C5%9Bwietlaj%C4%85"><span class="tocnumber">8.3</span> <span class="toctext">Woluminy logiczne się nie wyświetlają</span></a></li>
<li class="toclevel-2 tocsection-44"><a href="#LVM_na_no%C5%9Bnikach_wymiennych"><span class="tocnumber">8.4</span> <span class="toctext">LVM na nośnikach wymiennych</span></a></li>
<li class="toclevel-2 tocsection-45"><a href="#Zmiana_rozmiaru_s%C4%85siedniego_woluminu_logicznego_ko%C5%84czy_si%C4%99_niepowodzeniem"><span class="tocnumber">8.5</span> <span class="toctext">Zmiana rozmiaru sąsiedniego woluminu logicznego kończy się niepowodzeniem</span></a></li>
<li class="toclevel-2 tocsection-46"><a href="#Polecenie_%22grub-mkconfig%22_zg%C5%82asza_b%C5%82%C4%99dy_%22unknown_filesystem%22_errors"><span class="tocnumber">8.6</span> <span class="toctext">Polecenie "grub-mkconfig" zgłasza błędy "unknown filesystem" errors</span></a></li>
<li class="toclevel-2 tocsection-47"><a href="#Thinly-provisioned_root_volume_device_times_out"><span class="tocnumber">8.7</span> <span class="toctext">Thinly-provisioned root volume device times out</span></a></li>
<li class="toclevel-2 tocsection-48"><a href="#Op%C3%B3%C5%BAnienie_przy_wy%C5%82%C4%85czaniu"><span class="tocnumber">8.8</span> <span class="toctext">Opóźnienie przy wyłączaniu</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-49"><a href="#Zobacz_te%C5%BC"><span class="tocnumber">9</span> <span class="toctext">Zobacz też</span></a></li>
</ul>
</div>

<h2><span class="mw-headline" id="LVM_Building_Blocks">LVM Building Blocks</span></h2>
<p>Logical Volume Management wykorzystuje jądro <a rel="nofollow" class="external text" href="http://sources.redhat.com/dm/">device-mapper</a> funkcja zapewniająca system partycji niezależny od układu dysku. Za pomocą LVM można zarchiwizować pamięć i utworzyć "wirtualne partycje <a href="#Resizing_volumes">extending/shrinking</a><sup>[<a href="/title/Help:Procedures#Fix_broken_section_links" title="Help:Procedures">broken link</a>: invalid section]</sup> łatwiejsze (z zastrzeżeniem potencjalnych ograniczeń systemu plików).
</p>
<p>Wirtualne partycje umożliwiają dodawanie i usuwanie bez martwienia się o to, czy masz wystarczająco dużo sąsiadującej przestrzeni na danym dysku, oraz o złapanie fdiskowania używanego dysku (i zastanawiasz się, czy jądro używa starej lub nowej tabeli partycji), czy też przeniesienie innego przegródki na uboczu. Jest to rozwiązanie łatwe w zarządzaniu: LVM nie dodaje żadnych zabezpieczeń.
</p>
<p>Basic building blocks of LVM:
</p>
<dl>
<dt>Physical volume (PV)</dt>
<dd>Partycja na dysku twardym (lub nawet sam dysk lub plik sprzężenia zwrotnego), na którym można tworzyć grupy woluminów. Ma specjalny nagłówek i dzieli się na zakres fizyczny. Pomyśl o objętościach fizycznych jako dużych elementach konstrukcyjnych używanych do budowy dysku twardego.</dd>
<dt>Volume group (VG)</dt>
<dd>Grupa woluminów fizycznych używanych jako wolumin pamięci (jako jeden dysk). Zawierają woluminy logiczne. Pomyśl o grupach woluminów jako dyskach twardych.</dd>
<dt>Logical volume (LV)</dt>
<dd>
<i>Partycja wirtualna/logiczna</i>, która znajduje się w grupie woluminów i składa się z obszarów fizycznych. Pomyśl o woluminach logicznych jako normalnych partycjach.</dd>
<dt>Physical extent (PE)</dt>
<dd>Najmniejszy rozmiar woluminu fizycznego, który można przypisać do woluminu logicznego (domyślnie 4 MiB). Pomyśl o rozmiarach fizycznych jako częściach dysków, które można przydzielić do dowolnej partycji.</dd>
</dl>
<p>Przykład:
</p>
<pre><b>Physical disks</b>
                
  Disk1 (/dev/sda):
     _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
    |Partition1 50 GiB (Physical volume) |Partition2 80 GiB (Physical volume)     |
    |/dev/sda1                           |/dev/sda2                               |
    |_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ |_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ |
                                  
  Disk2 (/dev/sdb):
     _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
    |Partition1 120 GiB (Physical volume)                 |
    |/dev/sdb1                                            |
    |_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _|
</pre>
<pre><b>LVM logical volumes</b>

  Volume Group1 (/dev/MyStorage/ = /dev/sda1 + /dev/sda2 + /dev/sdb1):
     _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
    |Logical volume1 15 GiB  |Logical volume2 35 GiB      |Logical volume3 200 GiB              |
    |/dev/MyStorage/rootvol  |/dev/MyStorage/homevol      |/dev/MyStorage/mediavol              |
    |_ _ _ _ _ _ _ _ _ _ _ _ |_ _ _ _ _ _ _ _ _ _ _ _ _ _ |_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _|
</pre>
<h2><span class="mw-headline" id="Zalety">Zalety</span></h2>
<p>LVM zapewnia większą elastyczność niż zwykłe partycje dysku twardego:
</p>
<ul>
<li>Użyj dowolnej liczby dysków jako jednego dużego dysku.</li>
<li>Mieć woluminy logiczne rozciągnięte na kilku dyskach.</li>
<li>Twórz małe woluminy logiczne i zmieniaj ich rozmiar "dynamicznie" w miarę zapełniania.</li>
<li>Zmień wielkość woluminów logicznych, niezależnie od ich kolejności na dysku. Nie zależy od położenia LV w VG, nie ma potrzeby zapewnienia otaczającej dostępnej przestrzeni.</li>
<li>Zmień rozmiar/utwórz/usuń logiczne i fizyczne woluminy online. Systemy plików na nich nadal wymagają zmiany rozmiaru, ale niektóre (takie jak ext4) obsługują zmianę rozmiaru online.</li>
<li>Migracja online/na żywo LV używana przez usługi na różnych dyskach bez konieczności restartowania usług.</li>
<li>Migawki umożliwiają tworzenie kopii zapasowej zamrożonej kopii systemu plików, przy jednoczesnym ograniczeniu przestojów serwisowych do minimum.</li>
<li>Obsługa różnych urządzeń device-mapper, w tym przejrzyste szyfrowanie i buforowanie często używanych danych. Umożliwia to utworzenie systemu z (jednym lub więcej) dyskami fizycznymi (zaszyfrowanymi za pomocą LUKS) i <a href="/title/Dm-crypt/Encrypting_an_entire_system#LVM_on_LUKS" title="Dm-crypt/Encrypting an entire system">LVM on top</a> aby umożliwić łatwą zmianę rozmiaru i zarządzanie oddzielnymi woluminami (np <code>/</code>, <code>/home</code>, <code>/backup</code>, etc.) bez kłopotów z wielokrotnym wprowadzaniem klucza podczas startu.</li>
</ul>
<h2><span class="mw-headline" id="Wady">Wady</span></h2>
<ul>
<li>Dodatkowe kroki w konfiguracji systemu, bardziej skomplikowane.</li>
<li>Jeśli masz podwójne uruchamianie, zwróć uwagę, że system Windows nie obsługuje LVM; nie będzie można uzyskać dostępu do żadnych partycji LVM z systemu Windows.</li>
</ul>
<h2><span class="mw-headline" id="Instalowanie_Arch_Linux_na_LVM">Instalowanie Arch Linux na LVM</span></h2>
<p>Woluminy LVM powinieneś utworzyć między krokami <a href="/title/Partitioning" title="Partitioning">partycjonowania dysków</a>, a <a href="/title/File_systems#Create_a_file_system" title="File systems">formatowania</a> w <a href="/title/Installation_guide" title="Installation guide">procedurze instalacji</a>. Zamiast bezpośrednio formatować partycję, która ma być głównym systemem plików, system plików zostanie utworzony wewnątrz woluminu logicznego (LV).
</p>
<p>Upewnij się, że <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=lvm2">lvm2</a></span> pakiet jest <a href="/title/Install" class="mw-redirect" title="Install">zainstalowany</a>.
</p>
<p>Szybki przegląd: 
</p>
<ul>
<li>Utwórz partycję, która stanie się twoim woluminem fizycznym (PV).
<ul>
<li>Jeśli używasz tabeli partycji Master Boot Record, ustaw opcję  <a href="https://en.wikipedia.org/wiki/Partition_type" class="extiw" title="wikipedia:Partition type">partition type ID</a> na <code>8e</code> (typ partycji <code>Linux LVM</code> w <i>fdisk</i>).</li>
<li>Jeśli używasz tabeli partycji GUID, ustaw opcję <a href="https://en.wikipedia.org/wiki/GUID_Partition_Table#Partition_type_GUIDs" class="extiw" title="wikipedia:GUID Partition Table">partition type GUID</a> do <code>E6D6D379-F507-44C2-A23C-238F2A3DF928</code> (typ partycji <code>Linux LVM</code> w <i>fdisk</i> i <code>8e00</code> w <i>gdisk</i>).</li>
</ul>
</li>
<li>Utwórz swoje woluminy fizyczne (PV). Jeśli masz jeden dysk, najlepiej jest po prostu utworzyć jeden PV w jednej dużej partycji. Jeśli masz wiele dysków, możesz utworzyć partycje na każdym z nich i utworzyć PV na każdej partycji.</li>
<li>Utwórz swoją grupę woluminów (VG) i dodaj do niej wszystkie PV.</li>
<li>Utwórz woluminy logiczne (LVs) wewnątrz tego VG.</li>
<li>Kontynuuj instalację (<a href="/title/Installation_guide#Format_the_partitions" title="Installation guide">Installation guide#Format the partitions</a>).</li>
<li>Po przejściu do “Create initial ramdisk environment” w przewodniku instalacji, dodaj hak (hook) <code>lvm</code> do <code>/etc/mkinitcpio.conf</code> (patrz poniżej, aby uzyskać szczegółowe informacje).</li>
</ul>
<div class="archwiki-template-box archwiki-template-box-warning">
<strong>Warning:</strong> <code>/boot</code> nie może znajdować się w LVM, gdy używa się programu ładującego, który nie obsługuje LVM; musisz utworzyć oddzielną partycję <code>/boot</code> i sformatować ją bezpośrednio. Tylko <a href="/title/GRUB" title="GRUB">GRUB</a> jest znany z obsługi LVM.</div>
<h3>
<span id="Utw.C3.B3rz_partycje"></span><span class="mw-headline" id="Utwórz_partycje">Utwórz partycje</span>
</h3>
<p>Jeśli LVM musi być ustawiony na całym dysku, nie ma potrzeby tworzenia żadnych partycji.
</p>
<p>W przeciwnym razie przed przystąpieniem do konfigurowania LVM <a href="/title/Partition" class="mw-redirect" title="Partition">podziel</a> dysk według potrzeb.
</p>
<h3>
<span id="Utw.C3.B3rz_woluminy_fizyczne"></span><span class="mw-headline" id="Utwórz_woluminy_fizyczne">Utwórz woluminy fizyczne</span>
</h3>
<p>Aby wyświetlić listę wszystkich urządzeń, które można wykorzystać jako wolumin fizyczny:
</p>
<pre># lvmdiskscan
</pre>
<div class="archwiki-template-box archwiki-template-box-warning">
<strong>Warning:</strong> Upewnij się, że wybierasz w odpowiednie urządzenie, poniższe polecenie spowoduje utratę danych!</div>
<p>Utwórz wolumin fizyczny na nich:
</p>
<pre># pvcreate <i>DEVICE</i>
</pre>
<p>To polecenie tworzy nagłówek na każdym urządzeniu, dzięki czemu można go użyć do LVM. Jak określono w <a href="#LVM_Building_Blocks">#LVM Building Blocks</a>, <i>DEVICE</i> może być dyskiemk (na przykład <code>/dev/sda</code>), partycja (np. <code>/dev/sda2</code>) lub urządzenie loop back. Na przykład:
</p>
<pre># pvcreate /dev/sda2
</pre>
<p>Możesz śledzić utworzone woluminy fizyczne za pomocą:
</p>
<pre># pvdisplay
</pre>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Note:</strong> Jeśli używasz dysku SSD bez wcześniejszego partycjonowania, użyj <code>pvcreate --dataalignment 1m /dev/sda</code> (for erase block size &lt; 1 MiB), patrz np. <a rel="nofollow" class="external text" href="https://serverfault.com/questions/356534/ssd-erase-block-size-lvm-pv-on-raw-device-alignment">here</a>
</div>
<h3>
<span id="Utw.C3.B3rz_grup.C4.99_wolumin.C3.B3w"></span><span class="mw-headline" id="Utwórz_grupę_woluminów">Utwórz grupę woluminów</span>
</h3>
<p>Następnym krokiem jest utworzenie grupy woluminów na tym woluminie fizycznym.
</p>
<p>Najpierw musisz utworzyć grupę woluminów na jednym z woluminów fizycznych:
</p>
<pre># vgcreate &lt;<i>volume_group</i>&gt; &lt;<i>physical_volume</i>&gt;
</pre>
<p>Na przykład:
</p>
<pre># vgcreate VolGroup00 /dev/sda2
</pre>
<p>Następnie dodaj do niego wszystkie inne woluminy fizyczne, które chcesz w nim umieścić:
</p>
<pre># vgextend &lt;<i>volume_group</i>&gt; &lt;<i>physical_volume</i>&gt;
# vgextend &lt;<i>volume_group</i>&gt; &lt;<i>another_physical_volume</i>&gt;
# ...
</pre>
<p>Na przykład:
</p>
<pre># vgextend VolGroup00 /dev/sdb1
# vgextend VolGroup00 /dev/sdc
</pre>
<p>Możesz śledzić, jak powiększa się grupa woluminów:
</p>
<pre># vgdisplay
</pre>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Note:</strong> Jeśli chcesz, możesz utworzyć więcej niż jedną grupę woluminów, ale wtedy cała pamięć nie będzie prezentowana jako jeden dysk.</div>
<h3>
<span id="Utw.C3.B3rz_PV_i_VG_w_jednym_kroku"></span><span class="mw-headline" id="Utwórz_PV_i_VG_w_jednym_kroku">Utwórz PV i VG w jednym kroku</span>
</h3>
<p>LVM umożliwia łączenie tworzenia grupy woluminów i woluminów fizycznych w jednym prostym kroku. Na przykład, aby utworzyć grupę VolGroup00 z trzema wymienionymi wyżej urządzeniami, możesz uruchomić:
</p>
<pre># vgcreate VolGroup00 /dev/sda2 /dev/sdb1 /dev/sdc
</pre>
<p>To polecenie najpierw skonfiguruje trzy partycje jako woluminy fizyczne (jeśli to konieczne), a następnie utworzy grupę woluminów z trzema woluminami. Polecenie ostrzeże Cię, wykrywa istniejący system plików na dowolnym urządzeniu.
</p>
<h3>
<span id="Utw.C3.B3rz_woluminy_logiczne"></span><span class="mw-headline" id="Utwórz_woluminy_logiczne">Utwórz woluminy logiczne</span>
</h3>
<div class="archwiki-template-box archwiki-template-box-tip">
<strong>Tip:</strong> Jeśli chcesz używać migawek, buforowania woluminów logicznych, woluminów logicznych lub macierzy lub RAID, zobacz <a href="#Logical_volumes">#Logical volumes</a>.</div>
<p>Teraz musimy utworzyć woluminy logiczne w tej grupie woluminów. Użytkownik tworzy wolumin logiczny za pomocą następnego polecenia, podając nazwę nowego woluminu logicznego, jego rozmiar i grupę woluminów, na której będzie on działał:
</p>
<pre># lvcreate -L &lt;<i>size</i>&gt; &lt;<i>volume_group</i>&gt; -n &lt;<i>logical_volume</i>&gt;
</pre>
<p>Na przykład:
</p>
<pre># lvcreate -L 10G VolGroup00 -n lvolhome
</pre>
<p>Spowoduje to utworzenie woluminu logicznego, do którego można uzyskać dostęp później <code>/dev/mapper/Volgroup00-lvolhome</code> lub <code>/dev/VolGroup00/lvolhome</code>. Podobnie jak w przypadku grup woluminów, podczas tworzenia możesz użyć dowolnej nazwy dla woluminu logicznego.
</p>
<p>Można także określić jeden lub więcej woluminów fizycznych, aby ograniczyć miejsce, w którym LVM przydziela dane. Na przykład możesz utworzyć wolumin logiczny dla głównego systemu plików na małym dysku SSD i wolumin domowy na wolniejszym dysku mechanicznym. Wystarczy dodać urządzenia, na których znajdują się woluminy fizyczne, do wiersza poleceń, na przykład:
</p>
<pre># lvcreate -L 10G VolGroup00 -n lvolhome /dev/sdc1
</pre>
<p>Jeśli chcesz wypełnić całe wolne miejsce w grupie woluminów, użyj następnego polecenia:
</p>
<pre># lvcreate -l 100%FREE  &lt;<i>volume_group</i>&gt; -n &lt;<i>logical_volume</i>&gt;
</pre>
<p>Możesz śledzić utworzone woluminy logiczne za pomocą:
</p>
<pre># lvdisplay
</pre>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Note:</strong> Może być konieczne załadowanie modułu jądra "device-mapper" (<code>modprobe dm_mod'</code>) aby powyższe polecenia odniosły sukces.</div>
<div class="archwiki-template-box archwiki-template-box-tip">
<strong>Tip:</strong> Możesz zacząć od względnie małych woluminów logicznych i rozszerzyć je później, jeśli zajdzie taka potrzeba. Dla uproszczenia pozostaw trochę wolnego miejsca w grupie woluminów, aby było miejsce na rozbudowę.</div>
<h3>
<span id="Tw.C3.B3rzenie_system.C3.B3w_plik.C3.B3w_i_montowanie_wolumin.C3.B3w_logicznych"></span><span class="mw-headline" id="Twórzenie_systemów_plików_i_montowanie_woluminów_logicznych">Twórzenie systemów plików i montowanie woluminów logicznych</span>
</h3>
<p>Twoje woluminy logiczne powinny teraz znajdować się w <code>/dev/mapper/</code> i <code>/dev/<i>YourVolumeGroupName</i></code>. Jeśli nie możesz ich znaleźć, użyj kolejnych poleceń, aby wywołać moduł do tworzenia węzłów urządzeń i udostępnić grupy woluminów:
</p>
<pre># modprobe dm_mod
# vgscan
# vgchange -ay
</pre>
<p>Teraz możesz tworzyć systemy plików na woluminach logicznych i montować je jak normalne partycje (jeśli instalujesz Arch Linuksa, zajrzyj do <a href="/title/Mount" class="mw-redirect" title="Mount">montowania partycji</a> po dodatkowe szczegóły):
</p>
<pre># mkfs.&lt;<i>fstype</i>&gt; /dev/mapper/&lt;<i>volume_group</i>&gt;-&lt;<i>logical_volume</i>&gt;
# mount /dev/mapper/&lt;<i>volume_group</i>&gt;-&lt;<i>logical_volume</i>&gt; /&lt;<i>mountpoint</i>&gt;
</pre>
<p>Na przykład:
</p>
<pre># mkfs.ext4 /dev/mapper/VolGroup00-lvolhome
# mount /dev/mapper/VolGroup00-lvolhome /home
</pre>
<div class="archwiki-template-box archwiki-template-box-warning">
<strong>Warning:</strong> Wybierając punkty montowania, wybierz nowo utworzone woluminy logiczne (użyj: <code>/dev/mapper/Volgroup00-lvolhome</code>). <b>Nie</b> wybieraj rzeczywistych partycji, na których zostały utworzone woluminy logiczne (nie używaj: <code>/dev/sda2</code>).</div>
<h3><span class="mw-headline" id="Skonfiguruj_mkinitcpio">Skonfiguruj mkinitcpio</span></h3>
<p>W przypadku, gdy twój główny system plików jest na LVM, będziesz musiał włączyć odpowiednie haki (hook) <a href="/title/Mkinitcpio" title="Mkinitcpio">mkinitcpio</a>, inaczej twój system może się nie uruchomić. Włącz:
</p>
<ul>
<li>
<code>udev</code> i <code>lvm2</code> dla domyślnych initramfs opartych na busybox</li>
<li>
<code>systemd</code> i <code>sd-lvm2</code> dla initramfs opartych na systemd</li>
</ul>
<p><code>udev</code> jest tam domyślnie. Edytuj plik i wstaw <code>lvm2</code> pomiędzy <code>block</code> i <code>filesystems</code> jak na przykład:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/mkinitcpio.conf</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">HOOKS=(base <b>udev</b> ... block <b>lvm2</b> filesystems)</pre>
<p>Dla initramfs opartych na systemd:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/mkinitcpio.conf</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">HOOKS=(base <b>systemd</b> ... block <b>sd-lvm2</b> filesystems)</pre>
<p>Następnie możesz kontynuować normalną instrukcę instalacji: <a href="/title/Mkinitcpio#Image_creation_and_activation" title="Mkinitcpio">utwórz początkowy ramdysk</a>
</p>
<div class="archwiki-template-box archwiki-template-box-tip">
<strong>Tip:</strong> 
<ul>
<li>Haki <code>lvm2</code> i <code>sd-lvm2</code> są instalowane przez <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=lvm2">lvm2</a></span>, nie <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=mkinitcpio">mkinitcpio</a></span>. Jeśli uruchamiasz <i>mkinitcpio</i> w arch-chroot dla nowej instalacji, <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=lvm2">lvm2</a></span> musi być zainstalowany wewnątrz <i>arch-chroot</i> dla <i>mkinitcpio</i>, aby znaleźć <code>lvm2</code> lub <code>sd-lvm2</code> hak. Jeśli <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=lvm2">lvm2</a></span> istnieje tylko poza <i>arch-chroot</i>, <i>mkinitcpio</i> wyświetli <code>Error: Hook 'lvm2' cannot be found</code>.</li>
<li>Jeśli twój główny system plików jest na LVM RAID, zobacz <a href="#Skonfiguruj_mkinitcpio_dla_RAID">#Skonfiguruj mkinitcpio dla RAID</a>.</li>
</ul>
</div>
<h3>
<span id="Opcje_j.C4.85dra"></span><span class="mw-headline" id="Opcje_jądra">Opcje jądra</span>
</h3>
<p>Jeśli główny system plików znajduje się w woluminie logicznym, to <code>root=</code> <a href="/title/Kernel_parameter" class="mw-redirect" title="Kernel parameter">parametr jądra</a> musi być wskazany na zmapowane urządzenie, np <code>/dev/mapper/<i>vg-name</i>-<i>lv-name</i></code>.
</p>
<h2><span class="mw-headline" id="Volume_operations">Volume operations</span></h2>
<h3><span class="mw-headline" id="Zaawansowane_opcje">Zaawansowane opcje</span></h3>
<p>Jeśli potrzebujesz monitorowania (potrzebne do migawek), możesz włączyć 
lvmetad. Dla tego zestawu <code>use_lvmetad = 1</code> w <code>/etc/lvm/lvm.conf</code>.
To jest teraz domyślne.
</p>
<p>Możesz ograniczyć woluminy, które są aktywowane automatycznie, ustawiając <code>auto_activation_volume_list</code> w <code>/etc/lvm/lvm.conf</code>. W razie wątpliwości pozostaw tę opcję wykomentowaną.
</p>
<h3>
<span id="Zmienianie_wielko.C5.9Bci_wolumin.C3.B3w"></span><span class="mw-headline" id="Zmienianie_wielkości_woluminów">Zmienianie wielkości woluminów</span>
</h3>
<h4>
<span id="wolumin.C3.B3w_fizycznych"></span><span class="mw-headline" id="woluminów_fizycznych">woluminów fizycznych</span>
</h4>
<p>Po wydłużeniu lub zmniejszeniu rozmiaru urządzenia, które ma fizyczną objętość, musisz zwiększyć lub zmniejszyć PV za pomocą <code>pvresize</code>.
</p>
<h5><span class="mw-headline" id="Growing">Growing</span></h5>
<p>Aby rozwinąć PV na <code>/dev/sda1</code> po powiększeniu partycji, uruchom:
</p>
<pre># pvresize /dev/sda1
</pre>
<p>To automatycznie wykryje nowy rozmiar urządzenia i rozszerzy PV do maksimum.
</p>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Note:</strong> To polecenie można wykonać, gdy wolumin jest w trybie online.</div>
<h5><span class="mw-headline" id="Shrinking">Shrinking</span></h5>
<p>Aby zmniejszyć wolumin fizyczny przed zmniejszeniem jego podstawowego urządzenia, dodaj <code>--setphysicalvolumesize <i>size</i></code> parametry do polecenia, <i>np.</i>:
</p>
<pre># pvresize --setphysicalvolumesize 40G /dev/sda1
</pre>
<p>Powyższe polecenie może pozostawić Ci ten błąd:
</p>
<pre> /dev/sda1: cannot resize to 25599 extents as later ones are allocated.
 0 physical volume(s) resized / 1 physical volume(s) not resized
</pre>
<p>Indeed <code>pvresize</code> will refuse to shrink a PV if it has allocated extents after where its new end would be. One needs to run <a href="#Move_physical_extents">pvmove</a> beforehand to relocate these elsewhere in the volume group if there is sufficient free space.
</p>
<h6><span class="mw-headline" id="Move_physical_extents">Move physical extents</span></h6>
<p>Przed przeniesieniem wolnych zakresów do końca woluminu należy uruchomić <code>pvdisplay -v -m</code> aby zobaczyć fizyczne segmenty. W poniższym przykładzie istnieje jeden wolumin fizyczny włączony <code>/dev/sdd1</code>, jedna grupa woluminów <code>vg1</code> i jeden wolumin logiczny <code>backup</code>.
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;"># pvdisplay -v -m</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">    Finding all volume groups.
    Using physical volume(s) on command line.
  --- Physical volume ---
  PV Name               /dev/sdd1
  VG Name               vg1
  PV Size               1.52 TiB / not usable 1.97 MiB
  Allocatable           yes 
  PE Size               4.00 MiB
  Total PE              399669
  Free PE               153600
  Allocated PE          246069
  PV UUID               MR9J0X-zQB4-wi3k-EnaV-5ksf-hN1P-Jkm5mW
   
  --- Physical Segments ---
  Physical extent 0 to 153600:
    FREE
  Physical extent 153601 to 307199:
    Logical volume	/dev/vg1/backup
    Logical extents	1 to 153599
  Physical extent 307200 to 307200:
    FREE
  Physical extent 307201 to 399668:
    Logical volume	/dev/vg1/backup
    Logical extents	153601 to 246068
</pre>
<p>Przestrzeń wolną można podzielić na wolumen. Aby zmniejszyć objętość fizyczną, musimy najpierw przenieść wszystkie używane segmenty na początek.
</p>
<p>Tutaj pierwszy wolny segment ma od 0 do 153600 i pozostawia nam 153601 wolnych zakresów. Możemy teraz przenieść ten numer segmentu z ostatniego zakresu fizycznego do pierwszego zakresu. Polecenie będzie zatem:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;"># pvmove --alloc anywhere /dev/sdd1:307201-399668 /dev/sdd1:0-92466</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">/dev/sdd1: Moved: 0.1 %
/dev/sdd1: Moved: 0.2 %
...
/dev/sdd1: Moved: 99.9 %
/dev/sdd1: Moved: 100,0%
</pre>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Note:</strong> 
<ul>
<li>to polecenie przenosi 92468 PE (399668-307200) <b>z</b> ostatniego segmentu <b>do</b> pierwszego segmentu. Jest to możliwe, ponieważ pierwszy segment obejmuje 153600 wolnych PE, które mogą zawierać przesunięte PE-92467.</li>
<li>opcja <code>--alloc anywhere</code> jest używana podczas przenoszenia PE wewnątrz tej samej partycji. W przypadku różnych partycji polecenie wyglądałoby mniej więcej tak: <pre># pvmove /dev/sdb1:1000-1999 /dev/sdc1:0-999</pre>
</li>
<li>to polecenie może zająć dużo czasu (od jednej do dwóch godzin) w przypadku dużych woluminów. Dobrym pomysłem może być uruchomienie tego polecenia w sesji <a href="/title/Tmux" title="Tmux">Tmux</a> lub <a href="/title/GNU_Screen" title="GNU Screen">GNU Screen</a>. Każde niechciane zatrzymanie procesu może być śmiertelne.</li>
<li>po zakończeniu operacji uruchom program <a href="/title/Fsck" title="Fsck">fsck</a>, aby upewnić się, że system plików jest prawidłowy.</li>
</ul>
</div>
<h6>
<span id="Zmie.C5.84_rozmiar_woluminu_fizycznego"></span><span class="mw-headline" id="Zmień_rozmiar_woluminu_fizycznego">Zmień rozmiar woluminu fizycznego</span>
</h6>
<p>Gdy wszystkie wolne fizyczne segmenty będą w ostatnim fizycznym zakresie, uruchom <code>vgdisplay</code> i zobacz swój wolny PE.
</p>
<p>Następnie możesz teraz ponownie uruchomić polecenie:
</p>
<pre># pvresize --setphysicalvolumesize <i>size</i> <i>PhysicalVolume</i>
</pre>
<p>Zobacz wynik:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;"># pvs</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">  PV         VG   Fmt  Attr PSize    PFree 
  /dev/sdd1  vg1  lvm2 a--     1t     500g
</pre>
<h6>
<span id="Zmie.C5.84_rozmiar_partycji"></span><span class="mw-headline" id="Zmień_rozmiar_partycji">Zmień rozmiar partycji</span>
</h6>
<p>Na koniec, musisz zmniejszyć partycję za pomocą ulubionego <a href="/title/Partitioning#Partitioning_tools" title="Partitioning">narzędzia do partycjonowania</a>.
</p>
<h4><span class="mw-headline" id="Logical_volumes">Logical volumes</span></h4>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Note:</strong>  <i>lvresize</i> zapewnia mniej więcej takie same opcje, jak wyspecjalizowane polecenia <code>lvextend</code> i <code>lvreduce</code> pozwalając jednocześnie na wykonywanie obu typów operacji. Niezależnie od tego, wszystkie te narzędzia oferują <code>-r</code>/<code>--resizefs</code> opcja, która pozwala na zmianę rozmiaru systemu plików wraz z LV za pomocą <span class="plainlinks archwiki-template-man" title="$ man 8 fsadm"><a rel="nofollow" class="external text" href="https://man.archlinux.org/man/fsadm.8">fsadm(8)</a></span> (<i>ext2</i>, <a href="/title/Ext3" title="Ext3">ext3</a>, <a href="/title/Ext4" title="Ext4">ext4</a>, <i>ReiserFS</i> and <a href="/title/XFS" title="XFS">XFS</a> supported). Dlatego może być łatwiej po prostu użyć <code>lvresize</code> dla obu operacji i użyć <code>--resizefs</code> aby trochę uprościć, chyba że masz określone potrzeby lub chcesz mieć pełną kontrolę nad procesem.</div>
<h5><span class="mw-headline" id="Growing_or_shrinking_with_lvresize">Growing or shrinking with lvresize</span></h5>
<div class="archwiki-template-box archwiki-template-box-warning">
<strong>Warning:</strong> Podczas gdy powiększanie systemu plików może często odbywać się w trybie on-line (<i>tj.</i> Podczas instalacji), nawet w przypadku partycji głównej, zmniejszanie prawie zawsze będzie wymagało najpierw odmontowania systemu plików, aby zapobiec utracie danych. Upewnij się, że twój FS obsługuje to, co próbujesz zrobić.</div>
<p>Rozszerz wolumin logiczny <i>lv1</i> w grupie woluminów <i>vg1</i> o 2 GiB bez dotykania jego systemu plików:
</p>
<pre># lvresize -L +2G vg1/lv1
</pre>
<p>Zmniejsz rozmiar <code>vg1/lv1</code> o 500 MB bez zmiany rozmiaru systemu plików
</p>
<pre># lvresize -L -500M vg1/lv1
</pre>
<p>Ustaw <code>vg1/lv1</code> na 15 GiB i zmień jednocześnie rozmiar systemu plików:
</p>
<pre># lvresize -L 15G -r vg1/lv1
</pre>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Note:</strong> Only <i>ext2</i>, <a href="/title/Ext3" title="Ext3">ext3</a>, <a href="/title/Ext4" title="Ext4">ext4</a>, <i>ReiserFS</i> and <a href="/title/XFS" title="XFS">XFS</a> <a href="/title/File_systems" title="File systems">file systems</a> are supported. For a different type of file system look for the <a href="/title/File_systems#Types_of_file_systems" title="File systems">appropriate utility</a>.</div>
<p>Jeśli chcesz wypełnić całe wolne miejsce w grupie woluminów, użyj następującego polecenia:
</p>
<pre># lvresize -l +100%FREE <i>vg</i>/<i>lv</i>
</pre>
<p>Zobacz <span class="plainlinks archwiki-template-man" title="$ man 8 lvresize"><a rel="nofollow" class="external text" href="https://man.archlinux.org/man/lvresize.8">lvresize(8)</a></span> dla bardziej szczegółowych opcji.
</p>
<h5>
<span id="Rozszerzanie_woluminu_logicznego_i_systemu_plik.C3.B3w_za_jednym_razem"></span><span class="mw-headline" id="Rozszerzanie_woluminu_logicznego_i_systemu_plików_za_jednym_razem">Rozszerzanie woluminu logicznego i systemu plików za jednym razem</span>
</h5>
<div class="noprint archwiki-template-message">
<p><a href="/title/File:Merge-arrows-2.png" class="image"><img alt="Merge-arrows-2.png" src="../File:Merge-arrows-2.png" decoding="async" width="48" height="48"></a><b>This article or section is a candidate for merging with <a href="#Growing_or_shrinking_with_lvresize">#Growing or shrinking with lvresize</a>.</b><a href="/title/File:Merge-arrows-2.png" class="image"><img alt="Merge-arrows-2.png" src="../File:Merge-arrows-2.png" decoding="async" width="48" height="48"></a></p>
<div>
<b>Notes:</b> No need to split the sections. (Discuss in <a rel="nofollow" class="external text" href="https://wiki.archlinux.org/title/Talk:LVM_(Polski)">Talk:LVM (Polski)#</a>)</div>
</div>
<div class="archwiki-template-box archwiki-template-box-warning">
<strong>Warning:</strong> Not all file systems support resizing without loss of data and/or resizing online.</div>
<p>Rozszerz domyslny wolumin logiczny w grupie woluminów o 10 GiB
</p>
<pre># lvresize -L +10G /dev/<i>volume-group</i>/<i>home</i> --resizefs
</pre>
<p>Alternatywnie z systemem plików XFS
</p>
<pre># lvextend -L+10G /dev/<i>volume-group</i>/<i>home</i>
# xfs_growfs /home
</pre>
<p>Uwaga: <i>xfs_growfs</i> pobiera argument montowania jako argument. Zobacz <span class="plainlinks archwiki-template-man" title="$ man 8 xfs_growfs"><a rel="nofollow" class="external text" href="https://man.archlinux.org/man/xfs_growfs.8">xfs_growfs(8)</a></span> dla bardziej szczegółowych opcji.
</p>
<h5>
<span id="Zmiana_rozmiaru_systemu_plik.C3.B3w_oddzielnie"></span><span class="mw-headline" id="Zmiana_rozmiaru_systemu_plików_oddzielnie">Zmiana rozmiaru systemu plików oddzielnie</span>
</h5>
<p>Jeśli nie używasz <code>-r</code>/<code>--resizefs</code> opcja do <code>lvresize</code>, <code>lvextend</code> lub <code>lvreduce</code>, lub przy użyciu systemu plików nieobsługiwanego przez <span class="plainlinks archwiki-template-man" title="$ man 8 fsadm"><a rel="nofollow" class="external text" href="https://man.archlinux.org/man/fsadm.8">fsadm(8)</a></span> (np. <a href="/title/Btrfs" title="Btrfs">Btrfs</a>, <a href="/title/ZFS" title="ZFS">ZFS</a>), musisz ręcznie zmienić rozmiar systemu plików przed zmniejszeniem LV lub po jego rozszerzeniu.
</p>
<div class="archwiki-template-box archwiki-template-box-warning">
<strong>Warning:</strong> Nie wszystkie systemy plików obsługują zmianę rozmiaru bez utraty danych i / lub zmiany rozmiaru online.</div>
<p>Na przykład w systemie plików ext2/ext3/ext4:
</p>
<pre># resize2fs <i>vg</i>/<i>lv</i>
</pre>
<p>rozszerzy FS do maksymalnego rozmiaru bazowego LV, podczas gdy
</p>
<pre># resize2fs -M <i>vg</i>/<i>lv</i>
</pre>
<p>zmniejszy go do swojego minimalnego rozmiaru. Aby zmienić rozmiar na określony rozmiar, użyj:
</p>
<pre># resize2fs <i>vg</i>/<i>lv</i> <i>NewSize</i>
</pre>
<h3><span class="mw-headline" id="Remove_logical_volume">Remove logical volume</span></h3>
<div class="archwiki-template-box archwiki-template-box-warning">
<strong>Warning:</strong> Przed usunięciem woluminu logicznego należy przenieść wszystkie dane, które mają pozostać w innym miejscu; w przeciwnym razie zostanie utracone!</div>
<p>Najpierw sprawdź nazwę woluminu logicznego, który chcesz usunąć. Możesz uzyskać listę wszystkich woluminów logicznych za pomocą:
</p>
<pre># lvs
</pre>
<p>Następnie wyszukaj punkt montowania wybranego woluminu logicznego:
</p>
<pre>$ lsblk
</pre>
<p>Następnie odmontuj system plików na woluminie logicznym:
</p>
<pre># umount /&lt;<i>mountpoint</i>&gt;
</pre>
<p>Na koniec usuń wolumin logiczny:
</p>
<pre># lvremove &lt;<i>volume_group</i>&gt;/&lt;<i>logical_volume</i>&gt;
</pre>
<p>Na przykład:
</p>
<pre># lvremove VolGroup00/lvolhome
</pre>
<p>Potwierdź, wpisując <code>y</code>.
</p>
<p>Zaktualizuj <code>/etc/fstab</code>, jeśli to konieczne.
</p>
<p>Możesz zweryfikować usunięcie woluminu logicznego, wpisując ponownie <code>lvs</code> jako root (patrz pierwszy krok tej sekcji).
</p>
<h3>
<span id="Dodaj_wolumin_fizyczny_do_grupy_wolumin.C3.B3w"></span><span class="mw-headline" id="Dodaj_wolumin_fizyczny_do_grupy_woluminów">Dodaj wolumin fizyczny do grupy woluminów</span>
</h3>
<p>Najpierw utwórz nowy wolumin fizyczny na urządzeniu blokowym, którego chcesz użyć, a następnie rozszerz swoją grupę woluminów
</p>
<pre># pvcreate /dev/sdb1
# vgextend VolGroup00 /dev/sdb1
</pre>
<p>To oczywiście zwiększy całkowitą liczbę fizycznych elementów w grupie woluminów, które mogą być przydzielane przez woluminy logiczne według własnego uznania.
</p>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Note:</strong> Za dobrą formę uważa się tablicę partycji na nośniku pamięci poniżej LVM. Użyj odpowiedniego kodu typu: <code>8e</code> dla MBR i <code>8e00</code> dla partycji GPT.</div>
<h3>
<span id="Usu.C5.84_partycj.C4.99_z_grupy_wolumin.C3.B3w"></span><span class="mw-headline" id="Usuń_partycję_z_grupy_woluminów">Usuń partycję z grupy woluminów</span>
</h3>
<p>Jeśli utworzyłeś wolumin logiczny na partycji, <a href="#Remove_logical_volume">usuń</a> go najpierw.
</p>
<p>Wszystkie dane na tej partycji muszą zostać przeniesione na inną partycję. Na szczęście LVM ułatwia to:
</p>
<pre># pvmove /dev/sdb1
</pre>
<p>Jeśli chcesz mieć dane na określonej objętości fizycznej, określ ją jako drugi argument dla <code>pvmove</code>:
</p>
<pre># pvmove /dev/sdb1 /dev/sdf1
</pre>
<p>Następnie należy usunąć wolumin fizyczny z grupy woluminów:
</p>
<pre># vgreduce myVg /dev/sdb1
</pre>
<p>Lub usuń wszystkie puste woluminy fizyczne:
</p>
<pre># vgreduce --all vg0
</pre>
<p>I na koniec, jeśli chcesz użyć partycji na coś innego i chcesz uniknąć LVM myśląc, że partycja jest woluminem fizycznym:
</p>
<pre># pvremove /dev/sdb1
</pre>
<h3>
<span id="Dezaktywuj_grup.C4.99_wolumin.C3.B3w"></span><span class="mw-headline" id="Dezaktywuj_grupę_woluminów">Dezaktywuj grupę woluminów</span>
</h3>
<p>Po prostu wywołaj
</p>
<pre># vgchange -a n my_volume_group
</pre>
<p>Spowoduje to dezaktywację grupy woluminów i umożliwi odmontowanie kontenera, w którym jest przechowywany.
</p>
<h2>
<span id="Typy_wolumin.C3.B3w_logicznych"></span><span class="mw-headline" id="Typy_woluminów_logicznych">Typy woluminów logicznych</span>
</h2>
<div class="noprint archwiki-template-message">
<p><a href="/title/File:Tango-view-fullscreen.png" class="image"><img alt="Tango-view-fullscreen.png" src="../File:Tango-view-fullscreen.png" decoding="async" width="48" height="48"></a><b>This article or section needs expansion.</b><a href="/title/File:Tango-view-fullscreen.png" class="image"><img alt="Tango-view-fullscreen.png" src="../File:Tango-view-fullscreen.png" decoding="async" width="48" height="48"></a></p>
<div>
<b>Reason:</b> Add instructions for thin-provisioned volume creation and RAID volume creation. (Discuss in <a rel="nofollow" class="external text" href="https://wiki.archlinux.org/title/Talk:LVM_(Polski)">Talk:LVM (Polski)#</a>)</div>
</div>
<p>Oprócz prostych woluminów logicznych LVM obsługuje migawki, buforowanie woluminów logicznych, woluminy logiczne o cienkich wersjach i macierze RAID.
</p>
<h3><span class="mw-headline" id="Migawki">Migawki</span></h3>
<p>LVM pozwala wykonać migawkę systemu w znacznie bardziej wydajny sposób niż tradycyjne kopie zapasowe. Robi to skutecznie, stosując zasady COW (copy-on-write). Początkowa migawka zawiera po prostu twarde linki do i-węzłów rzeczywistych danych. Dopóki dane pozostają niezmienione, migawka zawiera jedynie wskaźniki i-węzłów, a nie same dane. Ilekroć modyfikujesz plik lub katalog, na który wskazuje migawka, LVM automatycznie klonuje dane, starą kopię, do której odwołuje się migawka, oraz nową kopię, do której odwołuje się Twój aktywny system. W ten sposób można wykonać migawkę systemu z 35 GiB danych przy użyciu zaledwie 2 GiB wolnej przestrzeni, o ile zmodyfikowano mniej niż 2 GiB (zarówno na oryginale, jak i na migawce). Aby móc tworzyć migawki, musisz mieć nieprzydzielone miejsce w grupie woluminów. Migawka, jak każdy inny wolumen, zajmie miejsce w grupie woluminów. Tak więc, jeśli zamierzasz używać migawek do tworzenia kopii zapasowej partycji root, nie przydzielaj 100% grupy woluminów dla woluminu logicznego root.
</p>
<h4><span class="mw-headline" id="Konfiguracja">Konfiguracja</span></h4>
<p>Buforowanie woluminów logicznych tworzy się podobnie jak normalne.
</p>
<pre># lvcreate --size 100M --snapshot --name snap01 /dev/mapper/vg0-pv
</pre>
<p>Przy takim woluminie można zmodyfikować mniej niż 100 MB danych, zanim objętość migawki się zapełni.
</p>
<p>Przywracanie zmodyfikowanego woluminu logicznego "pv" do stanu po zrobieniu migawki "snap01" można wykonać za pomocą
</p>
<pre># lvconvert --merge /dev/mapper/vg0-snap01
</pre>
<p>W przypadku, gdy początkowy wolumin logiczny jest aktywny, scalanie nastąpi przy następnym ponownym uruchomieniu. (Scalanie można wykonać nawet z LiveCD)
</p>
<p>Migawka nie będzie już istnieć po scaleniu.
</p>
<p>Można również wykonać wiele migawek i każdy z nich można dowolnie łączyć z początkowym woluminem logicznym.
</p>
<p>Migawkę można zamontować i zarchiwizować za pomocą narzędzia <i>dd</i> lub <i>tar</i>. Rozmiar pliku kopii zapasowej wykonanego przy pomocy dd będzie wielkości plików znajdujących się na woluminie migawki. Aby przywrócić, po prostu utwórz migawkę, zamontuj ją i napisz lub wyodrębnij do niej kopię zapasową, a następnie scal ją z punktem początkowym.
</p>
<div class="noprint archwiki-template-message">
<p><a href="/title/File:Tango-view-fullscreen.png" class="image"><img alt="Tango-view-fullscreen.png" src="../File:Tango-view-fullscreen.png" decoding="async" width="48" height="48"></a><b>This article or section needs expansion.</b><a href="/title/File:Tango-view-fullscreen.png" class="image"><img alt="Tango-view-fullscreen.png" src="../File:Tango-view-fullscreen.png" decoding="async" width="48" height="48"></a></p>
<div>
<b>Reason:</b> scripts to automate snapshots of root before updates, to rollback... updating <code>menu.lst</code> to boot snapshots (separate article?) (Discuss in <a rel="nofollow" class="external text" href="https://wiki.archlinux.org/title/Talk:LVM_(Polski)">Talk:LVM (Polski)#</a>)</div>
</div>
<p>Migawki są używane przede wszystkim do zapewnienia zamrożonej kopii systemu plików do tworzenia kopii zapasowych; wykonanie kopii zapasowej trwającej dwie godziny zapewnia bardziej spójny obraz systemu plików niż bezpośrednie tworzenie kopii zapasowej partycji.
</p>
<p>Zobacz <a href="/title/Create_root_filesystem_snapshots_with_LVM" title="Create root filesystem snapshots with LVM">Create root filesystem snapshots with LVM</a> do automatyzacji tworzenia czystych migawek systemu plików root podczas uruchamiania systemu w celu tworzenia kopii zapasowych i przywracania.
</p>
<p><a href="/title/Dm-crypt/Encrypting_an_entire_system#LVM_on_LUKS" title="Dm-crypt/Encrypting an entire system">dm-crypt/Encrypting an entire system#LVM on LUKS</a> i <a href="/title/Dm-crypt/Encrypting_an_entire_system#LUKS_on_LVM" title="Dm-crypt/Encrypting an entire system">dm-crypt/Encrypting an entire system#LUKS on LVM</a>.
</p>
<p>Jeśli masz woluminy LVM nie aktywowane przez <a href="/title/Initramfs" class="mw-redirect" title="Initramfs">initramfs</a>, <a href="/title/Enable" class="mw-redirect" title="Enable">enable</a> <code>lvm-monitoring.service</code>, który jest dostarczany przez <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=lvm2">lvm2</a></span> pakiet.
</p>
<h3><span class="mw-headline" id="LVM_cache">LVM cache</span></h3>
<p>From <span class="plainlinks archwiki-template-man" title="$ man 7 lvmcache"><a rel="nofollow" class="external text" href="https://man.archlinux.org/man/lvmcache.7">lvmcache(7)</a></span>:
</p>
<dl><dd>Typ woluminu logicznego w pamięci podręcznej wykorzystuje mały i szybki LV, aby poprawić wydajność dużego i wolnego LV. Czyni to poprzez przechowywanie często używanych bloków na szybszym LV. LVM odnosi się do małego szybkiego LV jako puli pamięci podręcznej LV. Duża wolna LV nazywana jest początkową LV. Ze względu na wymagania z pamięci podręcznej dm (sterownik jądra), LVM dalej dzieli pulę pamięci podręcznej LV na dwa urządzenia - dane LH pamięci podręcznej i LV pamięci podręcznej. Dane Lache pamięci podręcznej to miejsca, w których kopie bloków danych są przechowywane od punktu początkowego LV w celu zwiększenia prędkości. Metadane pamięci podręcznej LV przechowuje informacje rozliczeniowe, które określają miejsce przechowywania bloków danych (np. W punkcie początkowym LV lub w danych Lache pamięci podręcznej). Użytkownicy powinni być zaznajomieni z tymi LV, jeśli chcą stworzyć najlepsze i najbardziej odporne buforowane woluminy logiczne. Wszystkie te powiązane LV muszą znajdować się w tym samym VG.</dd></dl>
<h4><span class="mw-headline" id="Create_cache">Create cache</span></h4>
<p>Szybka metoda polega na utworzeniu PV (jeśli to konieczne) na szybkim dysku i dodaniu go do istniejącej grupy woluminów:
</p>
<pre># vgextend dataVG /dev/sdx
</pre>
<p>Utwórz pulę pamięci podręcznej z automatycznymi metadanymi na sdb i przekonwertuj istniejący wolumin logiczny (dataLV) na wolumin w pamięci podręcznej, a wszystko to w jednym kroku:
</p>
<pre># lvcreate --type cache --cachemode writethrough -L 20G -n dataLV_cachepool dataVG/dataLV /dev/sdx
</pre>
<p>Oczywiście, jeśli chcesz, aby pamięć podręczna była większa, możesz zmienić parametr <code>-L</code> na inny rozmiar.
</p>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Note:</strong> Cachemode ma dwie możliwe opcje:
<ul>
<li>
<code>writethrough</code> zapewnia, że wszelkie zapisane dane będą przechowywane zarówno w puli pamięci podręcznej LV, jak i w punkcie początkowym LV. Utrata urządzenia związanego z pulą pamięci podręcznej LV w tym przypadku nie oznacza utraty jakichkolwiek danych;</li>
<li>
<code>writeback</code> zapewnia lepszą wydajność, ale kosztem większego ryzyka utraty danych w przypadku awarii dysku używanego do buforowania.</li>
</ul>
<p>Jeśli określony <code>--cachemode</code> nie jest wskazany, system przyjmie <code>writethrough</code> wartość domyśln
</p>
</div>
<h4>
<span id="Usu.C5.84_pami.C4.99.C4.87_podr.C4.99czn.C4.85"></span><span class="mw-headline" id="Usuń_pamięć_podręczną">Usuń pamięć podręczną</span>
</h4>
<p>Jeśli kiedykolwiek zajdzie potrzeba cofnięcia operacji tworzenia o jeden krok powyżej:
</p>
<pre># lvconvert --uncache dataVG/dataLV
</pre>
<p>Spowoduje to zatwierdzenie wszystkich oczekujących zapisów w pamięci podręcznej z powrotem do początkowego LV, a następnie usunięcie pamięci podręcznej. Inne opcje są dostępne i opisane w <span class="plainlinks archwiki-template-man" title="$ man 7 lvmcache"><a rel="nofollow" class="external text" href="https://man.archlinux.org/man/lvmcache.7">lvmcache(7)</a></span>.
</p>
<h3><span class="mw-headline" id="RAID">RAID</span></h3>
<p>From <span class="plainlinks archwiki-template-man" title="$ man 7 lvmraid"><a rel="nofollow" class="external text" href="https://man.archlinux.org/man/lvmraid.7">lvmraid(7)</a></span>:
</p>
<dl><dd>
<span class="plainlinks archwiki-template-man" title="$ man 8 lvm"><a rel="nofollow" class="external text" href="https://man.archlinux.org/man/lvm.8">lvm(8)</a></span> RAID is a way to create a Logical Volume (LV) that uses multiple physical devices to improve performance or tolerate device failures.  In LVM, the physical devices are Physical Volumes (PVs) in a single Volume Group (VG).</dd></dl>
<p>LVM RAID supports RAID 0, RAID 1, RAID 4, RAID 5, RAID 6 and RAID 10. See <a href="https://en.wikipedia.org/wiki/Standard_RAID_levels" class="extiw" title="wikipedia:Standard RAID levels">Wikipedia:Standard RAID levels</a> for details on each level.
</p>
<h4><span class="mw-headline" id="Konfiguracja_RAID">Konfiguracja RAID</span></h4>
<p>Utwórz woluminy fizyczne:
</p>
<pre># pvcreate /dev/sda2 /dev/sdb2
</pre>
<p>Utwórz grupę woluminów na woluminach fizycznych:
</p>
<pre># vgcreate VolGroup00 /dev/sda2 /dev/sdb2
</pre>
<p>Utwórz woluminy logiczne za pomocą <code>lvcreate --type <i>raidlevel</i></code>, Zobacz <span class="plainlinks archwiki-template-man" title="$ man 7 lvmraid"><a rel="nofollow" class="external text" href="https://man.archlinux.org/man/lvmraid.7">lvmraid(7)</a></span> i <span class="plainlinks archwiki-template-man" title="$ man 8 lvcreate"><a rel="nofollow" class="external text" href="https://man.archlinux.org/man/lvcreate.8">lvcreate(8)</a></span> aby uzyskać więcej opcji
</p>
<pre># lvcreate --type RaidLevel [OPTIONS] -n Name -L Size VG [PVs]
</pre>
<p>Na przykład:
</p>
<pre># lvcreate --type raid1 --mirrors 1 -L 20G -n myraid1vol VolGroup00 /dev/sda2 /dev/sdb2
</pre>
<p>utworzy wolumin logiczny o rozmiarze 20 GiB o nazwie "myraid1vol" w VolGroup00 na <code>/dev/sda2</code> i <code>/dev/sdb2</code>.
</p>
<h4><span class="mw-headline" id="Skonfiguruj_mkinitcpio_dla_RAID">Skonfiguruj mkinitcpio dla RAID</span></h4>
<p>Jeśli twój rootowy system plików znajduje się na LVM RAID dodatkowo do haków <code>lvm2</code> lub <code>sd-lvm2</code>, musisz dodać moduł <code>dm-raid</code> i odpowiednie moduły RAID (np. <code>raid0</code>, <code>raid1</code>, <code>raid10</code> i / lub <code>raid456</code>) do tablicy MODULES w pliku <code>mkinitcpio.conf</code>.
</p>
<p>Dla initramfs opartych na busybox
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/mkinitcpio.conf</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">MODULES=(<b>dm-raid raid0 raid1 raid10 raid456</b>)
HOOKS=(base <b>udev</b> ... block <b>lvm2</b> filesystems)</pre>
<p>Dla initramfs opartych na systemd:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/mkinitcpio.conf</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">MODULES=(<b>dm-raid raid0 raid1 raid10 raid456</b>)
HOOKS=(base <b>systemd</b> ... block <b>sd-lvm2</b> filesystems)</pre>
<h2><span class="mw-headline" id="Graficzna_konfiguracja">Graficzna konfiguracja</span></h2>
<p>Nie ma "oficjalnego" narzędzia GUI do zarządzania woluminami LVM, ale <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://aur.archlinux.org/packages/system-config-lvm/">system-config-lvm</a></span><sup><small>AUR</small></sup><sup>[<a href="/title/Help:Procedures#Fix_broken_package_links" title="Help:Procedures">broken link</a>: package not found]</sup> obejmuje większość typowych operacji i zapewnia proste wizualizacje stanu woluminu. Może automatycznie zmieniać rozmiar wielu systemów plików podczas zmiany rozmiaru woluminów logicznych.
</p>
<h2>
<span id="Rozwi.C4.85zywanie_problem.C3.B3w"></span><span class="mw-headline" id="Rozwiązywanie_problemów">Rozwiązywanie problemów</span>
</h2>
<h3>
<span id="Zmiany.2C_kt.C3.B3re_mog.C4.85_by.C4.87_wymagane_ze_wzgl.C4.99du_na_zmiany_w_domy.C5.9Blnych_ustawieniach_Arch-Linux"></span><span class="mw-headline" id="Zmiany,_które_mogą_być_wymagane_ze_względu_na_zmiany_w_domyślnych_ustawieniach_Arch-Linux">Zmiany, które mogą być wymagane ze względu na zmiany w domyślnych ustawieniach Arch-Linux</span>
</h3>
<p>Parametr <code>use_lvmetad = 1</code>  musi być ustawiony w pliku <code>/etc/lvm/lvm.conf</code>. To jest teraz domyślne - jeśli masz plik <code>lvm.conf.pacnew</code>, musisz scalić tę zmianę.
</p>
<h3>
<span id="Komendy_LVM_nie_dzia.C5.82aj.C4.85"></span><span class="mw-headline" id="Komendy_LVM_nie_działają">Komendy LVM nie działają</span>
</h3>
<ul><li>Załaduj odpowiedni moduł:</li></ul>
<pre># modprobe dm_mod
</pre>
<p>Moduł <code>dm_mod</code> powinien zostać załadowany automatycznie. Jeśli nie, możesz spróbować:
</p>
<div class="noprint archwiki-template-message">
<p><a href="/title/File:Tango-inaccurate.png" class="image"><img alt="Tango-inaccurate.png" src="../File:Tango-inaccurate.png" decoding="async" width="48" height="48"></a><b>The factual accuracy of this article or section is disputed.</b><a href="/title/File:Tango-inaccurate.png" class="image"><img alt="Tango-inaccurate.png" src="../File:Tango-inaccurate.png" decoding="async" width="48" height="48"></a></p>
<div>
<b>Reason:</b> Should module loading at boot be done using "/etc/modules-load.d" instead? (Discuss in <a rel="nofollow" class="external text" href="https://wiki.archlinux.org/title/Talk:LVM_(Polski)">Talk:LVM (Polski)#</a>)</div>
</div>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/mkinitcpio.conf</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">MODULES=(dm_mod ...)</pre>
<p>Będziesz musiał <a href="/title/Regenerate_the_initramfs" class="mw-redirect" title="Regenerate the initramfs">zregenerować initramfs,</a> aby zatwierdzić wprowadzone zmiany.
</p>
<ul><li>Wypróbuj wcześniejsze polecenia za pomocą <i>lvm</i>:</li></ul>
<pre># lvm pvdisplay
</pre>
<h3>
<span id="Woluminy_logiczne_si.C4.99_nie_wy.C5.9Bwietlaj.C4.85"></span><span class="mw-headline" id="Woluminy_logiczne_się_nie_wyświetlają">Woluminy logiczne się nie wyświetlają</span>
</h3>
<p>Jeśli próbujesz zamontować istniejące woluminy logiczne, ale nie pojawiają się one w programie <code>lvscan</code>, możesz użyć następujących poleceń, aby je aktywować:
</p>
<pre># vgscan
# vgchange -ay
</pre>
<h3>
<span id="LVM_na_no.C5.9Bnikach_wymiennych"></span><span class="mw-headline" id="LVM_na_nośnikach_wymiennych">LVM na nośnikach wymiennych</span>
</h3>
<p>Objawy
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;"># vgscan</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">  Reading all physical volumes.  This may take a while...
  /dev/backupdrive1/backup: read failed after 0 of 4096 at 319836585984: Input/output error
  /dev/backupdrive1/backup: read failed after 0 of 4096 at 319836643328: Input/output error
  /dev/backupdrive1/backup: read failed after 0 of 4096 at 0: Input/output error
  /dev/backupdrive1/backup: read failed after 0 of 4096 at 4096: Input/output error
  Found volume group "backupdrive1" using metadata type lvm2
  Found volume group "networkdrive" using metadata type lvm2
</pre>
<p>Przyczyna:
</p>
<dl><dd>Usuwanie zewnętrznego napędu LVM bez uprzedniej dezaktywacji grup woluminów. Zanim się rozłączysz, upewnij się, że:</dd></dl>
<pre># vgchange -an <i>volume group name</i>
</pre>
<p>Naprawiono: zakładając, że próbowałeś już aktywować grupę woluminów za pomocą <code>vgchange -ay <i>vg</i></code>, i otrzymujesz błędy Input/output:
</p>
<pre># vgchange -an <i>volume group name</i>
</pre>
<p>Odłącz dysk zewnętrzny i poczekaj kilka minut:
</p>
<pre># vgscan
# vgchange -ay <i>volume group name</i>
</pre>
<h3>
<span id="Zmiana_rozmiaru_s.C4.85siedniego_woluminu_logicznego_ko.C5.84czy_si.C4.99_niepowodzeniem"></span><span class="mw-headline" id="Zmiana_rozmiaru_sąsiedniego_woluminu_logicznego_kończy_się_niepowodzeniem">Zmiana rozmiaru sąsiedniego woluminu logicznego kończy się niepowodzeniem</span>
</h3>
<p>W przypadku próby rozszerzenia błędów woluminu logicznego za pomocą:
</p>
<pre>" Insufficient suitable contiguous allocatable extents for logical volume "
</pre>
<p>Powodem jest to, że wolumin logiczny został utworzony z wyraźną, ciągłą polityką alokacji (opcje <code>-C y</code> lub <code>--alloc contiguous</code>) i brak sąsiadujących sąsiednich zakresów (Zobacz też <a rel="nofollow" class="external text" href="http://www.hostatic.ro/2010/02/15/lvm-inherit-and-contiguous-policies/">reference</a>).
</p>
<p>Aby to naprawić, przed rozszerzeniem woluminu logicznego zmień jego strategię alokacji za pomocą polecenia lvchange <code>lvchange --alloc inherit &lt;logical_volume&gt;</code>. Jeśli chcesz zachować politykę alokacji przyległej, alternatywnym podejściem jest przeniesienie woluminu na obszar dysku z wystarczającymi swobodnymi zakresami (Zobacz <a rel="nofollow" class="external autonumber" href="https://superuser.com/questions/435075/how-to-align-logical-volumes-on-contiguous-physical-extents">[1]</a>).
</p>
<h3>
<span id="Polecenie_.22grub-mkconfig.22_zg.C5.82asza_b.C5.82.C4.99dy_.22unknown_filesystem.22_errors"></span><span class="mw-headline" id='Polecenie_"grub-mkconfig"_zgłasza_błędy_"unknown_filesystem"_errors'>Polecenie "grub-mkconfig" zgłasza błędy "unknown filesystem" errors</span>
</h3>
<p>Pamiętaj, aby wcześniej usunąć woluminy migawek <a href="/title/GRUB#Generate_the_main_configuration_file" title="GRUB">generating grub.cfg</a>.
</p>
<h3><span class="mw-headline" id="Thinly-provisioned_root_volume_device_times_out">Thinly-provisioned root volume device times out</span></h3>
<p>Przy dużej liczbie migawek, <code>thin_check</code> działa przez wystarczająco długi czas, aby wyczekiwać na przekroczenie limitu czasu roota. Aby to zrekompensować, dodaj parametr startowy <code>rootdelay=60</code> jądra do konfiguracji programu ładującego.
</p>
<h3>
<span id="Op.C3.B3.C5.BAnienie_przy_wy.C5.82.C4.85czaniu"></span><span class="mw-headline" id="Opóźnienie_przy_wyłączaniu">Opóźnienie przy wyłączaniu</span>
</h3>
<p>Jeśli używasz RAID, migawek lub alokacji i masz opóźnienie przy wyłączaniu, upewnij się, że uruchomiono <code>lvm2-monitor.service</code>. Zobacz <a rel="nofollow" class="external text" href="https://bugs.archlinux.org/task/50420">FS#50420</a>.
</p>
<h2>
<span id="Zobacz_te.C5.BC"></span><span class="mw-headline" id="Zobacz_też">Zobacz też</span>
</h2>
<ul>
<li>
<a rel="nofollow" class="external text" href="https://sourceware.org/lvm2/">LVM2 Resource Page</a> on SourceWare.org</li>
<li>
<a rel="nofollow" class="external text" href="https://wiki.gentoo.org/wiki/LVM">LVM</a> article at Gentoo wiki</li>
<li>
<a rel="nofollow" class="external text" href="https://www.tutonics.com/2012/11/ubuntu-lvm-guide-part-1.html">Ubuntu LVM Guide Part 1</a><a rel="nofollow" class="external text" href="https://www.tutonics.com/2012/12/lvm-guide-part-2-snapshots.html">Part 2 detals snapshots</a>
</li>
<li><a rel="nofollow" class="external text" href="https://access.redhat.com/documentation/en-US/Red_Hat_Enterprise_Linux/7/html/Logical_Volume_Manager_Administration/index.html">Red Hat: Logical Volume Manager Administration</a></li>
</ul>
</div>
</div>
<div id="catlinks" class="catlinks" data-mw="interface">
<div id="mw-normal-catlinks" class="mw-normal-catlinks">
<a href="/title/Special:Categories" title="Special:Categories">Category</a>: <ul><li><a href="/title/Category:Storage_virtualization_(Polski)" title="Category:Storage virtualization (Polski)">Storage virtualization (Polski)</a></li></ul>
</div>
<div id="mw-hidden-catlinks" class="mw-hidden-catlinks mw-hidden-cats-hidden">Hidden categories: <ul>
<li><a href="/title/Category:Pages_with_broken_section_links" title="Category:Pages with broken section links">Pages with broken section links</a></li>
<li><a href="/title/Category:Pages_or_sections_flagged_with_Template:Merge" title="Category:Pages or sections flagged with Template:Merge">Pages or sections flagged with Template:Merge</a></li>
<li><a href="/title/Category:Pages_or_sections_flagged_with_Template:Expansion" title="Category:Pages or sections flagged with Template:Expansion">Pages or sections flagged with Template:Expansion</a></li>
<li><a href="/title/Category:Pages_with_broken_package_links" title="Category:Pages with broken package links">Pages with broken package links</a></li>
<li><a href="/title/Category:Pages_or_sections_flagged_with_Template:Accuracy" title="Category:Pages or sections flagged with Template:Accuracy">Pages or sections flagged with Template:Accuracy</a></li>
</ul>
</div>
</div>
	</div>
</div>

<footer id="footer" class="mw-footer" role="contentinfo" style="margin: 0">
	<ul id="footer-info">
		<li>Retrieved from "<a dir="ltr" href="https://wiki.archlinux.org/index.php?title=LVM_(Polski)&amp;oldid=668942">https://wiki.archlinux.org/index.php?title=LVM_(Polski)&amp;oldid=668942</a>"</li>
		<li id="footer-info-lastmod"> This page was last edited on 8 May 2021, at 10:56.</li>
		<li id="footer-info-copyright">Content is available under <a class="external" rel="nofollow" href="http://www.gnu.org/copyleft/fdl.html">GNU Free Documentation License 1.3 or later</a> unless otherwise noted.</li>
	<br>
</ul>
	<ul id="footer-places">
		<li id="footer-places-privacy"><a href="/title/ArchWiki:Privacy_policy" title="ArchWiki:Privacy policy">Privacy policy</a></li>
		<li id="footer-places-about"><a href="/title/ArchWiki:About" title="ArchWiki:About">About ArchWiki</a></li>
		<li id="footer-places-disclaimer"><a href="/title/ArchWiki:General_disclaimer" title="ArchWiki:General disclaimer">Disclaimers</a></li>
	</ul>
	<ul id="footer-icons" class="noprint">
		<li id="footer-copyrightico">
	</ul>
	<div style="clear: both;"></div>
</footer>



</body>
</html>
