<!DOCTYPE html>
<html class="client-nojs" lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<title>SSHFS (Русский) - ArchWiki</title>
<link rel="stylesheet" href="../ArchWikiOffline.css">
<meta name="ResourceLoaderDynamicStyles" content="">
<meta name="generator" content="MediaWiki 1.35.0">
<meta name="robots" content="noindex,follow">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="shortcut icon" href="/favicon.ico">
<link rel="search" type="application/opensearchdescription+xml" href="/opensearch_desc.php" title="ArchWiki (en)">
<link rel="EditURI" type="application/rsd+xml" href="https://wiki.archlinux.org/api.php?action=rsd">
<link rel="license" href="http://www.gnu.org/copyleft/fdl.html">
<link rel="alternate" type="application/atom+xml" title="ArchWiki Atom feed" href="/index.php?title=Special:RecentChanges&amp;feed=atom">
</head>
<body class="mediawiki ltr sitedir-ltr mw-hide-empty-elt ns-0 ns-subject page-SSHFS_Русский rootpage-SSHFS_Русский skin-vector action-view skin-vector-legacy">
<div id="content" class="mw-body" role="main" style="margin: 0">
	<a id="top"></a>
	<div id="siteNotice" class="mw-body-content"></div>
	<div class="mw-indicators mw-body-content">
	</div>
	<h1 id="firstHeading" class="firstHeading" lang="en">SSHFS (Русский)</h1>
	<div id="bodyContent" class="mw-body-content">
		<div id="siteSub" class="noprint">From ArchWiki</div>
		<div id="contentSub"></div>
		<div id="contentSub2"></div>
		
		<div id="jump-to-nav"></div>
		<a class="mw-jump-link" href="#mw-head">Jump to navigation</a>
		<a class="mw-jump-link" href="#searchInput">Jump to search</a>
		<div id="mw-content-text" lang="en" dir="ltr" class="mw-content-ltr">
<div class="warningbox">The printable version is no longer supported and may have rendering errors. Please update your browser bookmarks and please use the default browser print function instead.</div>
<div class="mw-parser-output">
<div class="archwiki-template-meta-related-articles-start">
<p>Ссылки по теме</p>
<ul>
<li><a href="../en/SCP_and_SFTP.html" title="SCP and SFTP">SCP and SFTP</a></li>
<li><a href="../en/SFTP_chroot.html" title="SFTP chroot">SFTP chroot</a></li>
<li><a href="../en/Pure-FTPd.html" title="Pure-FTPd">Pure-FTPd</a></li>
<li><a href="../ru/OpenSSH.html" class="mw-redirect" title="Secure Shell (Русский)">Secure Shell (Русский)</a></li>
<li><a href="../en/Sftpman.html" title="Sftpman">sftpman</a></li>
</ul>
</div>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Состояние перевода:</strong> На этой странице представлен перевод статьи <a href="../en/SSHFS.html" title="SSHFS">SSHFS</a>. Дата последней синхронизации: 23 февраля 2018. Вы можете <a href="../ru/ArchWiki:Translation_Team.html" title="ArchWiki:Translation Team (Русский)">помочь</a> синхронизировать перевод, если в английской версии произошли <a rel="nofollow" class="external text" href="https://wiki.archlinux.org/index.php?title=SSHFS&amp;diff=0&amp;oldid=499981">изменения</a>.</div>
<p><a rel="nofollow" class="external text" href="https://github.com/libfuse/sshfs">SSHFS</a> - клиент файловой системы на основе FUSE для монтирования удаленных каталогов через подключение <a href="../ru/OpenSSH.html" class="mw-redirect" title="SSH (Русский)">SSH</a>.
</p>
<div id="toc" class="toc" role="navigation" aria-labelledby="mw-toc-heading">
<input type="checkbox" role="button" id="toctogglecheckbox" class="toctogglecheckbox" style="display:none"><div class="toctitle" lang="en" dir="ltr">
<h2 id="mw-toc-heading">Contents</h2>
<span class="toctogglespan"><label class="toctogglelabel" for="toctogglecheckbox"></label></span>
</div>
<ul>
<li class="toclevel-1 tocsection-1">
<a href="#%D0%A3%D1%81%D1%82%D0%B0%D0%BD%D0%BE%D0%B2%D0%BA%D0%B0"><span class="tocnumber">1</span> <span class="toctext">Установка</span></a>
<ul>
<li class="toclevel-2 tocsection-2"><a href="#%D0%9C%D0%BE%D0%BD%D1%82%D0%B8%D1%80%D0%BE%D0%B2%D0%B0%D0%BD%D0%B8%D0%B5"><span class="tocnumber">1.1</span> <span class="toctext">Монтирование</span></a></li>
<li class="toclevel-2 tocsection-3"><a href="#%D0%A0%D0%B0%D0%B7%D0%BC%D0%BE%D0%BD%D1%82%D0%B8%D1%80%D0%BE%D0%B2%D0%B0%D0%BD%D0%B8%D0%B5"><span class="tocnumber">1.2</span> <span class="toctext">Размонтирование</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-4"><a href="#%D0%9E%D0%BF%D1%86%D0%B8%D0%B8"><span class="tocnumber">2</span> <span class="toctext">Опции</span></a></li>
<li class="toclevel-1 tocsection-5"><a href="#%D0%98%D0%B7%D0%BC%D0%B5%D0%BD%D0%B5%D0%BD%D0%B8%D0%B5_%D0%BA%D0%BE%D1%80%D0%BD%D0%B5%D0%B2%D0%BE%D0%B3%D0%BE_%D0%BA%D0%B0%D1%82%D0%B0%D0%BB%D0%BE%D0%B3%D0%B0"><span class="tocnumber">3</span> <span class="toctext">Изменение корневого каталога</span></a></li>
<li class="toclevel-1 tocsection-6">
<a href="#%D0%90%D0%B2%D1%82%D0%BE%D0%BC%D0%BE%D0%BD%D1%82%D0%B8%D1%80%D0%BE%D0%B2%D0%B0%D0%BD%D0%B8%D0%B5"><span class="tocnumber">4</span> <span class="toctext">Автомонтирование</span></a>
<ul>
<li class="toclevel-2 tocsection-7"><a href="#%D0%9F%D0%BE_%D0%B7%D0%B0%D0%BF%D1%80%D0%BE%D1%81%D1%83"><span class="tocnumber">4.1</span> <span class="toctext">По запросу</span></a></li>
<li class="toclevel-2 tocsection-8"><a href="#%D0%9F%D1%80%D0%B8_%D0%B7%D0%B0%D0%B3%D1%80%D1%83%D0%B7%D0%BA%D0%B5"><span class="tocnumber">4.2</span> <span class="toctext">При загрузке</span></a></li>
<li class="toclevel-2 tocsection-9"><a href="#%D0%91%D0%B5%D0%B7%D0%BE%D0%BF%D0%B0%D1%81%D0%BD%D1%8B%D0%B9_%D0%B4%D0%BE%D1%81%D1%82%D1%83%D0%BF_%D0%BF%D0%BE%D0%BB%D1%8C%D0%B7%D0%BE%D0%B2%D0%B0%D1%82%D0%B5%D0%BB%D0%B5%D0%B9"><span class="tocnumber">4.3</span> <span class="toctext">Безопасный доступ пользователей</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-10">
<a href="#%D0%A0%D0%B5%D1%88%D0%B5%D0%BD%D0%B8%D0%B5_%D0%BF%D1%80%D0%BE%D0%B1%D0%BB%D0%B5%D0%BC"><span class="tocnumber">5</span> <span class="toctext">Решение проблем</span></a>
<ul>
<li class="toclevel-2 tocsection-11"><a href="#%D0%9A%D0%BE%D0%BD%D1%82%D1%80%D0%BE%D0%BB%D1%8C%D0%BD%D1%8B%D0%B9_%D1%81%D0%BF%D0%B8%D1%81%D0%BE%D0%BA"><span class="tocnumber">5.1</span> <span class="toctext">Контрольный список</span></a></li>
<li class="toclevel-2 tocsection-12"><a href="#%D0%A1%D0%B1%D1%80%D0%BE%D1%81_%D1%81%D0%BE%D0%B5%D0%B4%D0%B8%D0%BD%D0%B5%D0%BD%D0%B8%D1%8F_%D0%BF%D0%B8%D1%80%D0%BE%D0%BC"><span class="tocnumber">5.2</span> <span class="toctext">Сброс соединения пиром</span></a></li>
<li class="toclevel-2 tocsection-13"><a href="#%D0%A3%D0%B4%D0%B0%D0%BB%D0%B5%D0%BD%D0%BD%D1%8B%D0%B9_%D1%85%D0%BE%D1%81%D1%82_%D0%BE%D1%82%D0%BA%D0%BB%D1%8E%D1%87%D0%B5%D0%BD"><span class="tocnumber">5.3</span> <span class="toctext">Удаленный хост отключен</span></a></li>
<li class="toclevel-2 tocsection-14"><a href="#%D0%97%D0%B0%D0%B2%D0%B8%D1%81%D0%B0%D0%BD%D0%B8%D0%B5_%D0%BF%D1%80%D0%B8%D0%BB%D0%BE%D0%B6%D0%B5%D0%BD%D0%B8%D0%B9_(%D0%BD%D0%B0%D0%BF%D1%80%D0%B8%D0%BC%D0%B5%D1%80,_Gnome_Files,_Gedit)"><span class="tocnumber">5.4</span> <span class="toctext">Зависание приложений (например, Gnome Files, Gedit)</span></a></li>
<li class="toclevel-2 tocsection-15"><a href="#%D0%9F%D1%80%D0%BE%D0%B1%D0%BB%D0%B5%D0%BC%D1%8B_%D1%81_%D0%BC%D0%BE%D0%BD%D1%82%D0%B8%D1%80%D0%BE%D0%B2%D0%B0%D0%BD%D0%B8%D0%B5%D0%BC_fstab"><span class="tocnumber">5.5</span> <span class="toctext">Проблемы с монтированием fstab</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-16"><a href="#%D0%A1%D0%BC%D0%BE%D1%82%D1%80%D0%B8%D1%82%D0%B5_%D1%82%D0%B0%D0%BA%D0%B6%D0%B5"><span class="tocnumber">6</span> <span class="toctext">Смотрите также</span></a></li>
</ul>
</div>

<h2>
<span id=".D0.A3.D1.81.D1.82.D0.B0.D0.BD.D0.BE.D0.B2.D0.BA.D0.B0"></span><span class="mw-headline" id="Установка">Установка</span>
</h2>
<p><a href="../ru/Help:Reading.html#%D0%A3%D1%81%D1%82%D0%B0%D0%BD%D0%BE%D0%B2%D0%BA%D0%B0_%D0%BF%D0%B0%D0%BA%D0%B5%D1%82%D0%BE%D0%B2" class="mw-redirect" title="Установите">Установите</a> пакет <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=sshfs">sshfs</a></span>
</p>
<div class="archwiki-template-box archwiki-template-box-tip">
<strong>Совет:</strong> 
<ul>
<li>Если часто приходится монтировать файловые системы sshfs, то вас могут заинтересовать помощники sshfs, такие как <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://aur.archlinux.org/packages/qsshfs/">qsshfs</a></span><sup><small>AUR</small></sup>, <a href="../en/Sftpman.html" title="Sftpman">sftpman</a>, <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://aur.archlinux.org/packages/sshmnt/">sshmnt</a></span><sup><small>AUR</small></sup> или <a rel="nofollow" class="external text" href="https://github.com/lahwaacz/Scripts/blob/master/fmount.py">fmount.py</a>.</li>
<li>Можно использовать <a href="../en/Google_Authenticator.html" class="mw-redirect" title="Google Authenticator (Русский)">Google Authenticator</a> c sshfs для дополнительной безопасности.</li>
<li>Также можно использовать <a href="../en/SSH_keys.html" title="SSH keys">SSH keys</a> вместо традиционного ввода пароля.</li>
</ul>
</div>
<h3>
<span id=".D0.9C.D0.BE.D0.BD.D1.82.D0.B8.D1.80.D0.BE.D0.B2.D0.B0.D0.BD.D0.B8.D0.B5"></span><span class="mw-headline" id="Монтирование">Монтирование</span>
</h3>
<p>Для того, чтобы примонтировать каталог, используя SSH, пользователь должен иметь доступ к нему. Монтирование удаленной директории:
</p>
<pre>$ sshfs <i>[user@]host:[dir] mountpoint [options]</i>
</pre>
<p>Например:
</p>
<pre>$ sshfs myuser@mycomputer:/remote/path /local/path -C -p 9876
</pre>
<p>Где <code>-p 9876</code> является номером порта, <code>-C</code> - использование сжатия. Для дополнительных опций смотрите раздел <a href="#%D0%9E%D0%BF%D1%86%D0%B8%D0%B8">#Опции</a>.
</p>
<p>Если не указан путь, то по умолчанию он указывает на удаленную домашнюю директорию пользователя. Имя пользователя по умолчанию и опции могут быть заданы в <code>~/.ssh/config</code>. Смотрите <a href="../ru/OpenSSH.html#%D0%9A%D0%BB%D0%B8%D0%B5%D0%BD%D1%82" title="OpenSSH (Русский)">OpenSSH (Русский)#Клиент</a>.
</p>
<p>SSH запросит пароль, если необходимо. Если вы не хотите постоянно вводить пароль, прочитайте: <a rel="nofollow" class="external text" href="http://linuxmafia.com/~karsten/Linux/FAQs/sshrsakey.html">как использовать ключ аутентификации RSA с SSH</a> или <a href="../ru/SSH_keys.html" title="SSH keys (Русский)">SSH Keys</a>.
</p>
<h3>
<span id=".D0.A0.D0.B0.D0.B7.D0.BC.D0.BE.D0.BD.D1.82.D0.B8.D1.80.D0.BE.D0.B2.D0.B0.D0.BD.D0.B8.D0.B5"></span><span class="mw-headline" id="Размонтирование">Размонтирование</span>
</h3>
<p>Чтобы размонтировать удаленную систему:
</p>
<pre>$ fusermount3 -u <i>mountpoint</i>
</pre>
<p>Например:
</p>
<pre>$ fusermount3 -u /local/path
</pre>
<h2>
<span id=".D0.9E.D0.BF.D1.86.D0.B8.D0.B8"></span><span class="mw-headline" id="Опции">Опции</span>
</h2>
<p><i>sshfs</i> может автоматически конвертировать ваш и удаленный идентификатор пользователя. Используйте параметр <code>idmap=user</code>, чтобы перевести UID подключаемого пользователя к удаленному пользователю <code>myuser</code> (GID остается нетронутым):
</p>
<pre>$ sshfs myuser@mycomputer:/remote/path /local/path -o idmap=user
</pre>
<p>Если вам требуется более точный контроль над переводом идентификаторов между локальным и удаленным пользователем, то обратите внимание на <code>idmap=file</code>, <code>uidfile</code> и <code>gidfile</code>.
</p>
<p>Полный список опций вы можете найти в <span class="plainlinks archwiki-template-man" title="$ man 1 sshfs"><a rel="nofollow" class="external text" href="https://man.archlinux.org/man/sshfs.1">sshfs(1)</a></span>.
</p>
<h2>
<span id=".D0.98.D0.B7.D0.BC.D0.B5.D0.BD.D0.B5.D0.BD.D0.B8.D0.B5_.D0.BA.D0.BE.D1.80.D0.BD.D0.B5.D0.B2.D0.BE.D0.B3.D0.BE_.D0.BA.D0.B0.D1.82.D0.B0.D0.BB.D0.BE.D0.B3.D0.B0"></span><span class="mw-headline" id="Изменение_корневого_каталога">Изменение корневого каталога</span>
</h2>
<p>Вы можете привязать определенного пользователя к конкретной директории на удаленной системе. Это может быть выполнено путем редактирования <code>/etc/ssh/sshd_config</code>:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/ssh/sshd_config</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">.....
Match User "someuser"
       ChrootDirectory "/chroot/%u"
       ForceCommand internal-sftp
       AllowTcpForwarding no
       X11Forwarding no
.....</pre>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Примечание:</strong> Владельцем chroot директории <b>должен</b> быть суперпользователь, иначе вы не сможете подключиться.</div>
<p>Смотрите <a href="../en/SFTP_chroot.html" title="SFTP chroot">SFTP chroot</a>. Также обратите внимание в <span class="plainlinks archwiki-template-man" title="$ man 5 sshd_config"><a rel="nofollow" class="external text" href="https://man.archlinux.org/man/sshd_config.5">sshd_config(5)</a></span> на <code>Match</code>, <code>ChrootDirectory</code> и <code>ForceCommand</code>.
</p>
<h2>
<span id=".D0.90.D0.B2.D1.82.D0.BE.D0.BC.D0.BE.D0.BD.D1.82.D0.B8.D1.80.D0.BE.D0.B2.D0.B0.D0.BD.D0.B8.D0.B5"></span><span class="mw-headline" id="Автомонтирование">Автомонтирование</span>
</h2>
<div class="noprint archwiki-template-message">
<p><a href="../File:Tango-preferences-desktop-locale.png" class="image"><img alt="Tango-preferences-desktop-locale.png" src="../File:Tango-preferences-desktop-locale.png" decoding="async" width="48" height="48"></a><b>Эта статья или раздел нуждается в <a href="../ru/ArchWiki:Contributing.html#%D0%9F%D0%B5%D1%80%D0%B5%D0%B2%D0%BE%D0%B4" title="ArchWiki:Contributing (Русский)">переводе</a></b><a href="../File:Tango-preferences-desktop-locale.png" class="image"><img alt="Tango-preferences-desktop-locale.png" src="../File:Tango-preferences-desktop-locale.png" decoding="async" width="48" height="48"></a></p>
<div>
<b>Примечания:</b> Перевод устарел. Установите <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=fuse2">fuse2</a></span> для <code>mount.fuse</code> или создайте символическую ссылку <code>mount.fuse3</code>. Смотрите <a rel="nofollow" class="external text" href="https://bugs.archlinux.org/task/55564">FS#55564</a> (обсуждение: <a rel="nofollow" class="external text" href="https://wiki.archlinux.org/index.php/Talk:SSHFS_(%D0%A0%D1%83%D1%81%D1%81%D0%BA%D0%B8%D0%B9)">Talk:SSHFS (Русский)#</a>)</div>
</div>
<div class="noprint archwiki-template-message">
<p><a href="../File:Tango-preferences-desktop-locale.png" class="image"><img alt="Tango-preferences-desktop-locale.png" src="../File:Tango-preferences-desktop-locale.png" decoding="async" width="48" height="48"></a><b>Эта статья или раздел нуждается в <a href="../ru/ArchWiki:Contributing.html#%D0%9F%D0%B5%D1%80%D0%B5%D0%B2%D0%BE%D0%B4" title="ArchWiki:Contributing (Русский)">переводе</a></b><a href="../File:Tango-preferences-desktop-locale.png" class="image"><img alt="Tango-preferences-desktop-locale.png" src="../File:Tango-preferences-desktop-locale.png" decoding="async" width="48" height="48"></a></p>
<div>
<b>Примечания:</b> Перевод устарел. API fuse3 больше не принимает параметр _netdev. <a rel="nofollow" class="external text" href="https://bbs.archlinux.org/viewtopic.php?id=230191">Дискуссия</a> (обсуждение: <a rel="nofollow" class="external text" href="https://wiki.archlinux.org/index.php/Talk:SSHFS_(%D0%A0%D1%83%D1%81%D1%81%D0%BA%D0%B8%D0%B9)">Talk:SSHFS (Русский)#</a>)</div>
</div>
<p>Автоматическое монтирование происходит при загрузке или по запросу (для получения доступа к каталогу). В любом случае настройка будет происходить в <code>/etc/<a href="../ru/Fstab.html" title="Fstab (Русский)">fstab</a></code>.
</p>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Примечание:</strong> Запомните, что автоматическое монтирование выполняется с правами суперпользователя, поэтому вы не можете использовать <code>.ssh/config</code> обычного пользователя.
<p>Чтобы разрешить суперпользователю использовать ключ SSH обычного пользователя, нужно указать полный путь в опции <code>IdentityFile</code>.
</p>
<b>Самое главное</b> - используйте хотя бы раз каждую примонтированную файловую систему sshfs <b>в режиме суперпользователя</b>, таким образом подписи хоста будут добавлены в файл <code>/root/.ssh/known_hosts</code>.</div>
<h3>
<span id=".D0.9F.D0.BE_.D0.B7.D0.B0.D0.BF.D1.80.D0.BE.D1.81.D1.83"></span><span class="mw-headline" id="По_запросу">По запросу</span>
</h3>
<div class="noprint archwiki-template-message">
<p><a href="../File:Tango-preferences-desktop-locale.png" class="image"><img alt="Tango-preferences-desktop-locale.png" src="../File:Tango-preferences-desktop-locale.png" decoding="async" width="48" height="48"></a><b>Эта статья или раздел нуждается в <a href="../ru/ArchWiki:Contributing.html#%D0%9F%D0%B5%D1%80%D0%B5%D0%B2%D0%BE%D0%B4" title="ArchWiki:Contributing (Русский)">переводе</a></b><a href="../File:Tango-preferences-desktop-locale.png" class="image"><img alt="Tango-preferences-desktop-locale.png" src="../File:Tango-preferences-desktop-locale.png" decoding="async" width="48" height="48"></a></p>
<div>
<b>Примечания:</b> Возможно ли заставить это работать с приватным ключом, защищенным фразой? Например, при первом доступе выводится запрос фразы. Или ясно укажите, что это невозможно и почему. (обсуждение: <a rel="nofollow" class="external text" href="https://wiki.archlinux.org/index.php/Talk:SSHFS_(%D0%A0%D1%83%D1%81%D1%81%D0%BA%D0%B8%D0%B9)">Talk:SSHFS (Русский)#</a>)</div>
</div>
<p>Посредством systemd можно монтировать по запросу, используя <code>/etc/fstab</code>.
</p>
<p>Например:
</p>
<pre>user@host:/remote/folder /mount/point  fuse.sshfs noauto,x-systemd.automount,_netdev,users,idmap=user,IdentityFile=/home/user/.ssh/id_rsa,allow_other,reconnect 0 0
</pre>
<p>Главные опции - <i>noauto,x-systemd.automount,_netdev</i>.
</p>
<ul>
<li>
<i>noauto</i> - монтирование не будет происходит при загрузке.</li>
<li>
<i>x-systemd.automount</i> - делает магию, связанную с запросом.</li>
<li>
<i>_netdev</i> - показывает, что это сетевое устройство, а не блочное (без этой опции может появится ошибка "No such device")</li>
</ul>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Примечание:</strong> После редактирования <code>/etc/fstab</code>, (пере)запустите соответствующий сервис: <code>systemctl daemon-reload &amp;&amp; systemctl restart &lt;цель&gt;</code>;  можно найти <code>&lt;цель&gt;</code>, используя <code>systemctl list-unit-files --type automount</code>
</div>
<div class="archwiki-template-box archwiki-template-box-tip">
<strong>Совет:</strong> <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://aur.archlinux.org/packages/autosshfs-git/">autosshfs-git</a></span><sup><small>AUR</small></sup><sup>[<a href="../en/ArchWiki:Requests.html#Broken_package_links" class="mw-redirect" title="ArchWiki:Requests">ссылка недействительна</a>: package not found]</sup> не требует редактирования <code>/etc/fstab</code> для создания новой точки монтирования. Обычные пользователи смогут создавать точки монтирования, просто пытаясь получить к ним доступ (например, <code>ls ~/mnt/ssh/[user@]yourremotehost[:port]</code>. <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://aur.archlinux.org/packages/autosshfs-git/">autosshfs-git</a></span><sup><small>AUR</small></sup><sup>[<a href="../en/ArchWiki:Requests.html#Broken_package_links" class="mw-redirect" title="ArchWiki:Requests">ссылка недействительна</a>: package not found]</sup> использует AutoFS. Пользователям нужно включить ее при помощи <code>autosshfs-user</code>.</div>
<h3>
<span id=".D0.9F.D1.80.D0.B8_.D0.B7.D0.B0.D0.B3.D1.80.D1.83.D0.B7.D0.BA.D0.B5"></span><span class="mw-headline" id="При_загрузке">При загрузке</span>
</h3>
<p>Пример того, как использовать sshfs для монтировании удаленной файловой системы при помощи <code>/etc/<a href="../ru/Fstab.html" title="Fstab (Русский)">fstab</a></code>
</p>
<pre>USERNAME@HOSTNAME_OR_IP:/REMOTE/DIRECTORY  /LOCAL/MOUNTPOINT  fuse.sshfs  defaults,_netdev  0  0
</pre>
<p>Для примера возьмите линию из <i>fstab</i>
</p>
<pre>llib@192.168.1.200:/home/llib/FAH  /media/FAH2  fuse.sshfs  defaults,_netdev  0  0
</pre>
<p>Выше приведенная строка будет работать только в том случае, если вы используете SSH ключ. Смотрите <a href="../ru/SSH_keys.html" title="SSH keys (Русский)">SSH keys</a>
</p>
<p>Если вы не единственный пользователь, использующий sshfs:
</p>
<pre>user@domain.org:/home/user  /media/user   fuse.sshfs    defaults,allow_other,_netdev    0  0
</pre>
<p>Очень важно убедится в том, что параметр <i>_netdev</i> установлен, чтобы быть уверенным в доступности сети перед монтированием.
</p>
<h3>
<span id=".D0.91.D0.B5.D0.B7.D0.BE.D0.BF.D0.B0.D1.81.D0.BD.D1.8B.D0.B9_.D0.B4.D0.BE.D1.81.D1.82.D1.83.D0.BF_.D0.BF.D0.BE.D0.BB.D1.8C.D0.B7.D0.BE.D0.B2.D0.B0.D1.82.D0.B5.D0.BB.D0.B5.D0.B9"></span><span class="mw-headline" id="Безопасный_доступ_пользователей">Безопасный доступ пользователей</span>
</h3>
<p>Когда используется автомонтирование через <a href="../en/Fstab.html" title="Fstab">fstab</a>, файловая система будет монтироваться от суперпользователя. По умолчанию, это приводит к нежелательным результатам, если вы хотите получать доступ как обычный пользователь и ограничить доступ другим пользователям.
</p>
<p>Пример конфигурации:
</p>
<pre>USERNAME@HOSTNAME_OR_IP:/REMOTE/DIRECTORY  /LOCAL/MOUNTPOINT  fuse.sshfs noauto,x-systemd.automount,_netdev,user,idmap=user,follow_symlinks,identityfile=/home/USERNAME/.ssh/id_rsa,allow_other,default_permissions,uid=USER_ID_N,gid=USER_GID_N 0 0
</pre>
<p>Описание опций:
</p>
<ul>
<li>
<i>allow_other</i> - позволяет другим пользователям, отличным от монтирующего (то есть обычным пользователям), получать доступ к тому, что монтируется.</li>
<li>
<i>default_permissions</i> - позволяет ядру проверять права, иначе говоря использовать актуальные права на удаленной файловой системе. А также запрещает доступ всем, кроме объявленных в <i>allow_other</i>.</li>
<li>
<i>uid</i>, <i>gid</i> - устанавливает владельца файлов в соответствии с переданными значениями; <i>uid</i> - это числовой идентификатор пользователя, <i>gid</i> - числовой идентификатор группы пользователя.</li>
</ul>
<h2>
<span id=".D0.A0.D0.B5.D1.88.D0.B5.D0.BD.D0.B8.D0.B5_.D0.BF.D1.80.D0.BE.D0.B1.D0.BB.D0.B5.D0.BC"></span><span class="mw-headline" id="Решение_проблем">Решение проблем</span>
</h2>
<h3>
<span id=".D0.9A.D0.BE.D0.BD.D1.82.D1.80.D0.BE.D0.BB.D1.8C.D0.BD.D1.8B.D0.B9_.D1.81.D0.BF.D0.B8.D1.81.D0.BE.D0.BA"></span><span class="mw-headline" id="Контрольный_список">Контрольный список</span>
</h3>
<p>Для начала, прочитайте следующую страницу вики <a href="../ru/OpenSSH.html#%D0%9F%D1%80%D0%BE%D0%B2%D0%B5%D1%80%D0%BA%D0%B0" class="mw-redirect" title="Secure Shell (Русский)">Secure Shell (Русский)#Проверка</a>. Пункты, которые следует проверить:
</p>
<p>1. Получает ли ваш логин SSH дополнительную информацию от сервера, например, файл <code>/etc/issue</code>? Это может запутать SSHFS. Вам следует временно отключить серверный файл <code>/etc/issue</code>:
</p>
<pre>$ mv /etc/issue /etc/issue.orig
</pre>
<p>2. Имейте в виду, что большинство статей по устранению неполадок, связанных с SSH, <b>не</b> связаны с Systemd. Часто определения в <code>/etc/fstab</code> ошибочно начинаются с <code><i>sshfs#</i>user@host:/mnt/server/folder ... fuse ...</code> вместо того, чтобы использовать следующий синтаксис <code>user@host:/mnt/server/folder ... fuse.<i>sshfs</i> ... <i>x-systemd</i>, ...</code>.
</p>
<p>3. Убедитесь в том, что владелец исходной папки и ее содержимого на сервере владеет соответствующий пользователь:
</p>
<pre>$ chown -R USER_S: /mnt/servers/folder
</pre>
<p>4. Серверный идентификатор пользователя может отличаться от соответствующего клиентского. Очевидно, что имена пользователей будут одинаковыми. Вам просто нужно позаботиться о клиентском идентификаторе. SSHFS будет преобразовывать идентификатор пользователя посредством следующего параметра:
</p>
<pre>uid=<i>USER_C_ID</i>,gid=<i>GROUP_C_ID</i>
</pre>
<p>5. Проверьте, чтобы клиент имел права на целевую точку монтирования (каталог). Данная директория должна иметь такой же идентификатор, как в настройках монтирования SSHFS.
</p>
<pre>$ chown -R USER_C: /mnt/client/folder
</pre>
<p>6. Проверьте, что точка монтирования (папка) пуста. По умолчанию, вы не можете монтировать каталоги SSHFS в непустые директории.
</p>
<h3>
<span id=".D0.A1.D0.B1.D1.80.D0.BE.D1.81_.D1.81.D0.BE.D0.B5.D0.B4.D0.B8.D0.BD.D0.B5.D0.BD.D0.B8.D1.8F_.D0.BF.D0.B8.D1.80.D0.BE.D0.BC"></span><span class="mw-headline" id="Сброс_соединения_пиром">Сброс соединения пиром</span>
</h3>
<ul>
<li>Если вы пытаетесь получить доступ к удаленной машине, используя имя хоста, то попробуйте использовать ее адрес или доменной имя, смотря, что исправит проблему. Убедитесь в том, что вы изменили <code>/etc/hosts</code> в соответствии со свойствами сервера.</li>
<li>Если вы используете нестандартные имена ключей и передаете их как <code>-i .ssh/my_key</code>, то это не будет работать. Вам следует использовать <code>-o IdentityFile=/home/user/.ssh/my_key</code> с указанием полного пути к ключу.</li>
<li>Если ваш файл <code>/root/.ssh/config</code> является символической ссылкой, то вы получите сообщение об ошибке. Смотрите <a rel="nofollow" class="external text" href="https://serverfault.com/questions/507748/bad-owner-or-permissions-on-root-ssh-config">эту тему</a>
</li>
<li>Добавление опции '<code>sshfs_debug</code>' (как в '<code>sshfs -o sshfs_debug user@server ...</code>') может помочь в решении проблемы.</li>
<li>Если это не помогло выявить ничего полезного, то вы можете также попробовать добавить опцию '<code>debug</code>'</li>
<li>Если вы пытаетесь использовать sshfs в роутере, работающем на DD-WRT или чем-то подобном, то решение проблемы <a rel="nofollow" class="external text" href="http://www.dd-wrt.com/wiki/index.php/SFTP_with_DD-WRT">здесь</a>. (обратите внимание, что опция osftp_server=/opt/libexec/sftp-server может быть использована в командах SSH вместо патча dropbear)</li>
<li>Старая тема на форуме: <a rel="nofollow" class="external text" href="https://bbs.archlinux.org/viewtopic.php?id=27613">sshfs: Connection reset by peer</a>.</li>
<li>Убедитесь, что ваш пользователь можешь зайти на сервер (особенно при использовании AllowUsers).</li>
<li>Убедитесь в том, что <code>Subsystem sftp /usr/lib/ssh/sftp-server</code> включен в <code>/etc/ssh/sshd_config</code>.</li>
</ul>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Примечание:</strong> Когда вы посылаете больше одного аргумента в sshfs, они должны разделяться запятыми. Например: '<code>sshfs -o sshfs_debug,IdentityFile=&lt;/path/to/key&gt; user@server ...</code>')</div>
<h3>
<span id=".D0.A3.D0.B4.D0.B0.D0.BB.D0.B5.D0.BD.D0.BD.D1.8B.D0.B9_.D1.85.D0.BE.D1.81.D1.82_.D0.BE.D1.82.D0.BA.D0.BB.D1.8E.D1.87.D0.B5.D0.BD"></span><span class="mw-headline" id="Удаленный_хост_отключен">Удаленный хост отключен</span>
</h3>
<p>Если это сообщение появляется непосредственно после попытки использовать <i>sshfs</i>:
</p>
<ul>
<li>Сначала убедитесь, что на удаленном компьютере установлен <i>sftp</i>! Ничего не будет работать, пока пакет не будет установлен.</li>
<li>Затем попробуйте проверить корректность пути к <code>Subsystem sftp</code>, указанного в <code>/etc/ssh/sshd_config</code> на удаленной машине.</li>
</ul>
<h3>
<span id=".D0.97.D0.B0.D0.B2.D0.B8.D1.81.D0.B0.D0.BD.D0.B8.D0.B5_.D0.BF.D1.80.D0.B8.D0.BB.D0.BE.D0.B6.D0.B5.D0.BD.D0.B8.D0.B9_.28.D0.BD.D0.B0.D0.BF.D1.80.D0.B8.D0.BC.D0.B5.D1.80.2C_Gnome_Files.2C_Gedit.29"></span><span class="mw-headline" id="Зависание_приложений_(например,_Gnome_Files,_Gedit)">Зависание приложений (например, Gnome Files, Gedit)</span>
</h3>
<div class="archwiki-template-box archwiki-template-box-warning">
<strong>Важно:</strong> Этот способ предотвращает от загрязнения список последних использованных файлов и может привести к возможным ошибкам записи.</div>
<p>Если у вас зависают (не отвечают) приложения, вам, возможно, придется отключить защиту от записи файлу <code>~/recently-used.xbel</code>.
</p>
<pre># chattr +i /home/USERNAME/.local/share/recently-used.xbel
</pre>
<p>Смотрите следующий <a rel="nofollow" class="external text" href="https://bugs.archlinux.org/task/40260">отчет об ошибке</a> для более подробной информации и/или решения.
</p>
<h3>
<span id=".D0.9F.D1.80.D0.BE.D0.B1.D0.BB.D0.B5.D0.BC.D1.8B_.D1.81_.D0.BC.D0.BE.D0.BD.D1.82.D0.B8.D1.80.D0.BE.D0.B2.D0.B0.D0.BD.D0.B8.D0.B5.D0.BC_fstab"></span><span class="mw-headline" id="Проблемы_с_монтированием_fstab">Проблемы с монтированием fstab</span>
</h3>
<p>Для получения подробной отладочной информации, добавьте следующее в параметры монтирования:
</p>
<pre>ssh_command=ssh\040-vv,sshfs_debug,debug
</pre>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Note:</strong> <code>\040</code> - пробел, используемый fstab для разделения полей.</div>
<p>Чтобы видеть отладочную информацию, запустив при этом <code>mount -av</code>, удалите следующее:
</p>
<pre>noauto,x-systemd.automount
</pre>
<h2>
<span id=".D0.A1.D0.BC.D0.BE.D1.82.D1.80.D0.B8.D1.82.D0.B5_.D1.82.D0.B0.D0.BA.D0.B6.D0.B5"></span><span class="mw-headline" id="Смотрите_также">Смотрите также</span>
</h2>
<ul>
<li>
<a rel="nofollow" class="external text" href="http://wiki.gilug.org/index.php/How_to_mount_SFTP_accesses">Как монтировать файловую систему SSH, находящуюся в chroot-среде</a>, с специальными владельцами и вопросами доступа.</li>
<li>
<a rel="nofollow" class="external text" href="http://www.admin-magazine.com/HPC/Articles/Sharing-Data-with-SSHFS">SSHFS – установка и производительность</a> — сравнение с NFS и подсказки по оптимизации.</li>
</ul>
</div>
</div>
<div id="catlinks" class="catlinks" data-mw="interface">
<div id="mw-normal-catlinks" class="mw-normal-catlinks">
<a href="../Special:Categories.html" title="Special:Categories">Categories</a>: <ul>
<li><a href="../ru/Category:FUSE.html" title="Category:FUSE (Русский)">FUSE (Русский)</a></li>
<li><a href="../ru/Category:Secure_Shell.html" title="Category:Secure Shell (Русский)">Secure Shell (Русский)</a></li>
<li><a href="../ru/Category:Network_sharing.html" title="Category:Network sharing (Русский)">Network sharing (Русский)</a></li>
</ul>
</div>
<div id="mw-hidden-catlinks" class="mw-hidden-catlinks mw-hidden-cats-hidden">Hidden categories: <ul>
<li><a href="../ru/Category:Pages_or_sections_flagged_with_Template:Translateme.html" title="Category:Pages or sections flagged with Template:Translateme (Русский)">Pages or sections flagged with Template:Translateme (Русский)</a></li>
<li><a href="../en/Category:Pages_with_broken_package_links.html" title="Category:Pages with broken package links">Pages with broken package links</a></li>
</ul>
</div>
</div>
	</div>
</div>

<footer id="footer" class="mw-footer" role="contentinfo" style="margin: 0">
	<ul id="footer-info">
		<li>Retrieved from "<a dir="ltr" href="https://wiki.archlinux.org/index.php?title=SSHFS_(%D0%A0%D1%83%D1%81%D1%81%D0%BA%D0%B8%D0%B9)&amp;oldid=638618">https://wiki.archlinux.org/index.php?title=SSHFS_(Русский)&amp;oldid=638618</a>"</li>
		<li id="footer-info-lastmod"> This page was last edited on 14 October 2020, at 07:17.</li>
		<li id="footer-info-copyright">Content is available under <a class="external" rel="nofollow" href="http://www.gnu.org/copyleft/fdl.html">GNU Free Documentation License 1.3 or later</a> unless otherwise noted.</li>
	<br>
</ul>
	<ul id="footer-places">
		<li id="footer-places-privacy"><a href="../en/ArchWiki:Privacy_policy.html" title="ArchWiki:Privacy policy">Privacy policy</a></li>
		<li id="footer-places-about"><a href="../en/ArchWiki:About.html" title="ArchWiki:About">About ArchWiki</a></li>
		<li id="footer-places-disclaimer"><a href="../en/ArchWiki:General_disclaimer.html" title="ArchWiki:General disclaimer">Disclaimers</a></li>
	</ul>
	<ul id="footer-icons" class="noprint">
		<li id="footer-copyrightico">
	</ul>
	<div style="clear: both;"></div>
</footer>



</body>
</html>
