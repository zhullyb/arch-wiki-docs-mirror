<!DOCTYPE html>
<html class="client-nojs" lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<title>nftables (Русский) - ArchWiki</title>
<link rel="stylesheet" href="../ArchWikiOffline.css">
<meta name="ResourceLoaderDynamicStyles" content="">
<meta name="generator" content="MediaWiki 1.35.0">
<meta name="robots" content="noindex,follow">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="shortcut icon" href="/favicon.ico">
<link rel="search" type="application/opensearchdescription+xml" href="/opensearch_desc.php" title="ArchWiki (en)">
<link rel="EditURI" type="application/rsd+xml" href="https://wiki.archlinux.org/api.php?action=rsd">
<link rel="license" href="http://www.gnu.org/copyleft/fdl.html">
<link rel="alternate" type="application/atom+xml" title="ArchWiki Atom feed" href="/index.php?title=Special:RecentChanges&amp;feed=atom">
</head>
<body class="mediawiki ltr sitedir-ltr mw-hide-empty-elt ns-0 ns-subject page-Nftables_Русский rootpage-Nftables_Русский skin-vector action-view skin-vector-legacy">
<div id="content" class="mw-body" role="main" style="margin: 0">
	<a id="top"></a>
	<div id="siteNotice" class="mw-body-content"></div>
	<div class="mw-indicators mw-body-content">
	</div>
	<h1 id="firstHeading" class="firstHeading" lang="en">nftables (Русский)</h1>
	<div id="bodyContent" class="mw-body-content">
		<div id="siteSub" class="noprint">From ArchWiki</div>
		<div id="contentSub"></div>
		<div id="contentSub2"></div>
		
		<div id="jump-to-nav"></div>
		<a class="mw-jump-link" href="#mw-head">Jump to navigation</a>
		<a class="mw-jump-link" href="#searchInput">Jump to search</a>
		<div id="mw-content-text" lang="en" dir="ltr" class="mw-content-ltr">
<div class="warningbox">The printable version is no longer supported and may have rendering errors. Please update your browser bookmarks and please use the default browser print function instead.</div>
<div class="mw-parser-output">
<p><span></span>
</p>
<div class="archwiki-template-meta-related-articles-start">
<p>Ссылки по теме</p>
<ul>
<li><a href="../ru/Iptables.html" title="Iptables (Русский)">iptables (Русский)</a></li>
</ul>
</div>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Состояние перевода:</strong> На этой странице представлен перевод статьи <a href="../en/Nftables.html" title="Nftables">nftables</a>. Дата последней синхронизации: 1 декабря 2020. Вы можете <a href="../ru/ArchWiki:Translation_Team.html" title="ArchWiki:Translation Team (Русский)">помочь</a> синхронизировать перевод, если в английской версии произошли <a rel="nofollow" class="external text" href="https://wiki.archlinux.org/index.php?title=Nftables&amp;diff=0&amp;oldid=642930">изменения</a>.</div>
<p><a rel="nofollow" class="external text" href="https://netfilter.org/projects/nftables/">nftables</a> — проект netfilter, целью которого ставится замена существующего набора межсетевых экранов {ip,ip6,arp,eb}tables. Была разработана новая система фильтрации пакетов, добавлена пользовательская утилита ntf, а также создан слой совместимости с {ip,ip6}tables. nftables использует набор хуков, систему отслеживания соединений, систему очередей и подсистему логирования netfilter.
</p>
<p>nftables состоит из трёх основных частей: низкоуровневая реализация в составе ядра, библиотека libnl и пользовательский интерфейс nftables. Ядро занимается выполнением правил во время работы межсетевого экрана; для настройки правил в ядро добавлен интерфейс <a href="https://en.wikipedia.org/wiki/Netlink" class="extiw" title="wikipedia:Netlink">netlink</a>. Библиотека libnl содержит низкоуровневые функции для взаимодействия с ядром, а в качестве пользовательского интерфейса nftables используется утилита nft.
</p>
<p>Подробную информацию о nftables можно найти на <a rel="nofollow" class="external text" href="https://wiki.nftables.org/wiki-nftables/index.php/Main_Page">вики-странице</a> проекта.
</p>
<div id="toc" class="toc" role="navigation" aria-labelledby="mw-toc-heading">
<input type="checkbox" role="button" id="toctogglecheckbox" class="toctogglecheckbox" style="display:none"><div class="toctitle" lang="en" dir="ltr">
<h2 id="mw-toc-heading">Contents</h2>
<span class="toctogglespan"><label class="toctogglelabel" for="toctogglecheckbox"></label></span>
</div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#%D0%A3%D1%81%D1%82%D0%B0%D0%BD%D0%BE%D0%B2%D0%BA%D0%B0"><span class="tocnumber">1</span> <span class="toctext">Установка</span></a></li>
<li class="toclevel-1 tocsection-2">
<a href="#%D0%98%D1%81%D0%BF%D0%BE%D0%BB%D1%8C%D0%B7%D0%BE%D0%B2%D0%B0%D0%BD%D0%B8%D0%B5"><span class="tocnumber">2</span> <span class="toctext">Использование</span></a>
<ul>
<li class="toclevel-2 tocsection-3"><a href="#%D0%91%D0%B0%D0%B7%D0%BE%D0%B2%D0%B0%D1%8F_%D0%BA%D0%BE%D0%BD%D1%84%D0%B8%D0%B3%D1%83%D1%80%D0%B0%D1%86%D0%B8%D1%8F"><span class="tocnumber">2.1</span> <span class="toctext">Базовая конфигурация</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-4">
<a href="#%D0%9D%D0%B0%D1%81%D1%82%D1%80%D0%BE%D0%B9%D0%BA%D0%B0"><span class="tocnumber">3</span> <span class="toctext">Настройка</span></a>
<ul>
<li class="toclevel-2 tocsection-5">
<a href="#%D0%A2%D0%B0%D0%B1%D0%BB%D0%B8%D1%86%D1%8B"><span class="tocnumber">3.1</span> <span class="toctext">Таблицы</span></a>
<ul>
<li class="toclevel-3 tocsection-6"><a href="#%D0%A1%D0%BE%D0%B7%D0%B4%D0%B0%D0%BD%D0%B8%D0%B5_%D1%82%D0%B0%D0%B1%D0%BB%D0%B8%D1%86%D1%8B"><span class="tocnumber">3.1.1</span> <span class="toctext">Создание таблицы</span></a></li>
<li class="toclevel-3 tocsection-7"><a href="#%D0%9F%D1%80%D0%BE%D1%81%D0%BC%D0%BE%D1%82%D1%80_%D1%82%D0%B0%D0%B1%D0%BB%D0%B8%D1%86"><span class="tocnumber">3.1.2</span> <span class="toctext">Просмотр таблиц</span></a></li>
<li class="toclevel-3 tocsection-8"><a href="#%D0%9F%D1%80%D0%BE%D1%81%D0%BC%D0%BE%D1%82%D1%80_%D1%86%D0%B5%D0%BF%D0%BE%D1%87%D0%B5%D0%BA_%D0%B8_%D0%BF%D1%80%D0%B0%D0%B2%D0%B8%D0%BB"><span class="tocnumber">3.1.3</span> <span class="toctext">Просмотр цепочек и правил</span></a></li>
<li class="toclevel-3 tocsection-9"><a href="#%D0%A3%D0%B4%D0%B0%D0%BB%D0%B5%D0%BD%D0%B8%D0%B5_%D1%82%D0%B0%D0%B1%D0%BB%D0%B8%D1%86%D1%8B"><span class="tocnumber">3.1.4</span> <span class="toctext">Удаление таблицы</span></a></li>
<li class="toclevel-3 tocsection-10"><a href="#%D0%A1%D1%82%D0%B8%D1%80%D0%B0%D0%BD%D0%B8%D0%B5_%D1%82%D0%B0%D0%B1%D0%BB%D0%B8%D1%86%D1%8B"><span class="tocnumber">3.1.5</span> <span class="toctext">Стирание таблицы</span></a></li>
</ul>
</li>
<li class="toclevel-2 tocsection-11">
<a href="#%D0%A6%D0%B5%D0%BF%D0%BE%D1%87%D0%BA%D0%B8"><span class="tocnumber">3.2</span> <span class="toctext">Цепочки</span></a>
<ul>
<li class="toclevel-3 tocsection-12">
<a href="#%D0%A1%D0%BE%D0%B7%D0%B4%D0%B0%D0%BD%D0%B8%D0%B5_%D1%86%D0%B5%D0%BF%D0%BE%D1%87%D0%BA%D0%B8"><span class="tocnumber">3.2.1</span> <span class="toctext">Создание цепочки</span></a>
<ul>
<li class="toclevel-4 tocsection-13"><a href="#%D0%9E%D0%B1%D1%8B%D1%87%D0%BD%D0%B0%D1%8F_%D1%86%D0%B5%D0%BF%D0%BE%D1%87%D0%BA%D0%B0"><span class="tocnumber">3.2.1.1</span> <span class="toctext">Обычная цепочка</span></a></li>
<li class="toclevel-4 tocsection-14"><a href="#%D0%91%D0%B0%D0%B7%D0%BE%D0%B2%D0%B0%D1%8F_%D1%86%D0%B5%D0%BF%D0%BE%D1%87%D0%BA%D0%B0"><span class="tocnumber">3.2.1.2</span> <span class="toctext">Базовая цепочка</span></a></li>
</ul>
</li>
<li class="toclevel-3 tocsection-15"><a href="#%D0%9F%D1%80%D0%BE%D1%81%D0%BC%D0%BE%D1%82%D1%80_%D0%BF%D1%80%D0%B0%D0%B2%D0%B8%D0%BB"><span class="tocnumber">3.2.2</span> <span class="toctext">Просмотр правил</span></a></li>
<li class="toclevel-3 tocsection-16"><a href="#%D0%98%D0%B7%D0%BC%D0%B5%D0%BD%D0%B5%D0%BD%D0%B8%D0%B5_%D1%86%D0%B5%D0%BF%D0%BE%D1%87%D0%BA%D0%B8"><span class="tocnumber">3.2.3</span> <span class="toctext">Изменение цепочки</span></a></li>
<li class="toclevel-3 tocsection-17"><a href="#%D0%A3%D0%B4%D0%B0%D0%BB%D0%B5%D0%BD%D0%B8%D0%B5_%D1%86%D0%B5%D0%BF%D0%BE%D1%87%D0%BA%D0%B8"><span class="tocnumber">3.2.4</span> <span class="toctext">Удаление цепочки</span></a></li>
<li class="toclevel-3 tocsection-18"><a href="#%D0%A1%D1%82%D0%B5%D1%80%D0%B5%D1%82%D1%8C_%D0%BF%D1%80%D0%B0%D0%B2%D0%B8%D0%BB%D0%B0_%D0%B8%D0%B7_%D1%86%D0%B5%D0%BF%D0%BE%D1%87%D0%BA%D0%B8"><span class="tocnumber">3.2.5</span> <span class="toctext">Стереть правила из цепочки</span></a></li>
</ul>
</li>
<li class="toclevel-2 tocsection-19">
<a href="#%D0%9F%D1%80%D0%B0%D0%B2%D0%B8%D0%BB%D0%B0"><span class="tocnumber">3.3</span> <span class="toctext">Правила</span></a>
<ul>
<li class="toclevel-3 tocsection-20">
<a href="#%D0%94%D0%BE%D0%B1%D0%B0%D0%B2%D0%BB%D0%B5%D0%BD%D0%B8%D0%B5_%D0%BF%D1%80%D0%B0%D0%B2%D0%B8%D0%BB%D0%B0"><span class="tocnumber">3.3.1</span> <span class="toctext">Добавление правила</span></a>
<ul>
<li class="toclevel-4 tocsection-21"><a href="#%D0%92%D1%8B%D1%80%D0%B0%D0%B6%D0%B5%D0%BD%D0%B8%D1%8F"><span class="tocnumber">3.3.1.1</span> <span class="toctext">Выражения</span></a></li>
</ul>
</li>
<li class="toclevel-3 tocsection-22"><a href="#%D0%A3%D0%B4%D0%B0%D0%BB%D0%B5%D0%BD%D0%B8%D0%B5"><span class="tocnumber">3.3.2</span> <span class="toctext">Удаление</span></a></li>
</ul>
</li>
<li class="toclevel-2 tocsection-23"><a href="#%D0%9F%D0%BE%D0%BB%D0%BD%D0%B0%D1%8F_%D0%BF%D0%B5%D1%80%D0%B5%D0%B7%D0%B0%D0%B3%D1%80%D1%83%D0%B7%D0%BA%D0%B0_%D0%BF%D1%80%D0%B0%D0%B2%D0%B8%D0%BB"><span class="tocnumber">3.4</span> <span class="toctext">Полная перезагрузка правил</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-24">
<a href="#%D0%9F%D1%80%D0%B8%D0%BC%D0%B5%D1%80%D1%8B"><span class="tocnumber">4</span> <span class="toctext">Примеры</span></a>
<ul>
<li class="toclevel-2 tocsection-25"><a href="#%D0%A0%D0%B0%D0%B1%D0%BE%D1%87%D0%B0%D1%8F_%D1%81%D1%82%D0%B0%D0%BD%D1%86%D0%B8%D1%8F"><span class="tocnumber">4.1</span> <span class="toctext">Рабочая станция</span></a></li>
<li class="toclevel-2 tocsection-26"><a href="#%D0%A1%D0%B5%D1%80%D0%B2%D0%B5%D1%80"><span class="tocnumber">4.2</span> <span class="toctext">Сервер</span></a></li>
<li class="toclevel-2 tocsection-27"><a href="#%D0%9E%D0%B3%D1%80%D0%B0%D0%BD%D0%B8%D1%87%D0%B5%D0%BD%D0%B8%D0%B5_%D1%81%D0%BA%D0%BE%D1%80%D0%BE%D1%81%D1%82%D0%B8_%D0%BF%D0%B5%D1%80%D0%B5%D0%B4%D0%B0%D1%87%D0%B8"><span class="tocnumber">4.3</span> <span class="toctext">Ограничение скорости передачи</span></a></li>
<li class="toclevel-2 tocsection-28"><a href="#%D0%9F%D0%B5%D1%80%D0%B5%D1%85%D0%BE%D0%B4"><span class="tocnumber">4.4</span> <span class="toctext">Переход</span></a></li>
<li class="toclevel-2 tocsection-29"><a href="#%D0%9D%D0%B5%D1%81%D0%BA%D0%BE%D0%BB%D1%8C%D0%BA%D0%BE_%D1%81%D0%B5%D1%82%D0%B5%D0%B2%D1%8B%D1%85_%D0%B8%D0%BD%D1%82%D0%B5%D1%80%D1%84%D0%B5%D0%B9%D1%81%D0%BE%D0%B2_%D1%81_%D1%80%D0%B0%D0%B7%D0%BD%D1%8B%D0%BC%D0%B8_%D0%BF%D1%80%D0%B0%D0%B2%D0%B8%D0%BB%D0%B0%D0%BC%D0%B8"><span class="tocnumber">4.5</span> <span class="toctext">Несколько сетевых интерфейсов с разными правилами</span></a></li>
<li class="toclevel-2 tocsection-30"><a href="#%D0%9C%D0%B0%D1%81%D0%BA%D0%B0%D1%80%D0%B0%D0%B4%D0%B8%D0%BD%D0%B3"><span class="tocnumber">4.6</span> <span class="toctext">Маскарадинг</span></a></li>
<li class="toclevel-2 tocsection-31"><a href="#NAT_%D1%81_%D0%BF%D1%80%D0%BE%D0%B1%D1%80%D0%BE%D1%81%D0%BE%D0%BC_%D0%BF%D0%BE%D1%80%D1%82%D0%BE%D0%B2"><span class="tocnumber">4.7</span> <span class="toctext">NAT с пробросом портов</span></a></li>
<li class="toclevel-2 tocsection-32"><a href="#%D0%A1%D1%87%D1%91%D1%82%D1%87%D0%B8%D0%BA_%D0%BD%D0%BE%D0%B2%D1%8B%D1%85_%D1%81%D0%BE%D0%B5%D0%B4%D0%B8%D0%BD%D0%B5%D0%BD%D0%B8%D0%B9"><span class="tocnumber">4.8</span> <span class="toctext">Счётчик новых соединений</span></a></li>
<li class="toclevel-2 tocsection-33"><a href="#%D0%94%D0%B8%D0%BD%D0%B0%D0%BC%D0%B8%D1%87%D0%B5%D1%81%D0%BA%D0%B0%D1%8F_%D0%B1%D0%BB%D0%BE%D0%BA%D0%B8%D1%80%D0%BE%D0%B2%D0%BA%D0%B0"><span class="tocnumber">4.9</span> <span class="toctext">Динамическая блокировка</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-34">
<a href="#%D0%A1%D0%BE%D0%B2%D0%B5%D1%82%D1%8B_%D0%B8_%D1%80%D0%B5%D0%BA%D0%BE%D0%BC%D0%B5%D0%BD%D0%B4%D0%B0%D1%86%D0%B8%D0%B8"><span class="tocnumber">5</span> <span class="toctext">Советы и рекомендации</span></a>
<ul>
<li class="toclevel-2 tocsection-35"><a href="#%D0%A1%D0%BE%D1%85%D1%80%D0%B0%D0%BD%D0%B5%D0%BD%D0%B8%D0%B5_%D1%82%D0%B5%D0%BA%D1%83%D1%89%D0%B5%D0%B3%D0%BE_%D0%BD%D0%B0%D0%B1%D0%BE%D1%80%D0%B0_%D0%BF%D1%80%D0%B0%D0%B2%D0%B8%D0%BB"><span class="tocnumber">5.1</span> <span class="toctext">Сохранение текущего набора правил</span></a></li>
<li class="toclevel-2 tocsection-36">
<a href="#%D0%9D%D0%B0%D1%81%D1%82%D1%80%D0%BE%D0%B9%D0%BA%D0%B0_%D0%BC%D0%B5%D0%B6%D1%81%D0%B5%D1%82%D0%B5%D0%B2%D0%BE%D0%B3%D0%BE_%D1%8D%D0%BA%D1%80%D0%B0%D0%BD%D0%B0"><span class="tocnumber">5.2</span> <span class="toctext">Настройка межсетевого экрана</span></a>
<ul>
<li class="toclevel-3 tocsection-37"><a href="#%D0%9E%D0%B4%D0%B8%D0%BD%D0%BE%D1%87%D0%BD%D0%B0%D1%8F_%D0%BC%D0%B0%D1%88%D0%B8%D0%BD%D0%B0"><span class="tocnumber">5.2.1</span> <span class="toctext">Одиночная машина</span></a></li>
</ul>
</li>
<li class="toclevel-2 tocsection-38"><a href="#%D0%9F%D1%80%D0%B5%D0%B4%D0%BE%D1%82%D0%B2%D1%80%D0%B0%D1%89%D0%B5%D0%BD%D0%B8%D0%B5_%D0%B0%D1%82%D0%B0%D0%BA_%D0%BF%D0%B5%D1%80%D0%B5%D0%B1%D0%BE%D1%80%D0%BE%D0%BC"><span class="tocnumber">5.3</span> <span class="toctext">Предотвращение атак перебором</span></a></li>
<li class="toclevel-2 tocsection-39"><a href="#%D0%9B%D0%BE%D0%B3_%D1%82%D1%80%D0%B0%D1%84%D0%B8%D0%BA%D0%B0"><span class="tocnumber">5.4</span> <span class="toctext">Лог трафика</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-40">
<a href="#%D0%A0%D0%B5%D1%88%D0%B5%D0%BD%D0%B8%D0%B5_%D0%BF%D1%80%D0%BE%D0%B1%D0%BB%D0%B5%D0%BC"><span class="tocnumber">6</span> <span class="toctext">Решение проблем</span></a>
<ul>
<li class="toclevel-2 tocsection-41"><a href="#%D0%A0%D0%B0%D0%B1%D0%BE%D1%82%D0%B0_%D1%81_Docker"><span class="tocnumber">6.1</span> <span class="toctext">Работа с Docker</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-42"><a href="#%D0%A1%D0%BC%D0%BE%D1%82%D1%80%D0%B8%D1%82%D0%B5_%D1%82%D0%B0%D0%BA%D0%B6%D0%B5"><span class="tocnumber">7</span> <span class="toctext">Смотрите также</span></a></li>
</ul>
</div>

<h2>
<span id=".D0.A3.D1.81.D1.82.D0.B0.D0.BD.D0.BE.D0.B2.D0.BA.D0.B0"></span><span class="mw-headline" id="Установка">Установка</span>
</h2>
<div class="noprint archwiki-template-message">
<p><a href="../File:Tango-view-fullscreen.png" class="image"><img alt="Tango-view-fullscreen.png" src="../File:Tango-view-fullscreen.png" decoding="async" width="48" height="48"></a><b>This article or section needs expansion.</b><a href="../File:Tango-view-fullscreen.png" class="image"><img alt="Tango-view-fullscreen.png" src="../File:Tango-view-fullscreen.png" decoding="async" width="48" height="48"></a></p>
<div>
<b>Reason:</b> Упомянуть <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=iptables-nft">iptables-nft</a></span> <a rel="nofollow" class="external autonumber" href="https://www.redhat.com/en/blog/using-iptables-nft-hybrid-linux-firewall">[1]</a>. (Discuss in <a rel="nofollow" class="external text" href="https://wiki.archlinux.org/index.php/Talk:Nftables_(%D0%A0%D1%83%D1%81%D1%81%D0%BA%D0%B8%D0%B9)">Talk:Nftables (Русский)#</a>)</div>
</div>
<p><a href="../ru/Help:Reading.html#%D0%A3%D1%81%D1%82%D0%B0%D0%BD%D0%BE%D0%B2%D0%BA%D0%B0_%D0%BF%D0%B0%D0%BA%D0%B5%D1%82%D0%BE%D0%B2" class="mw-redirect" title="Установите">Установите</a> пакет <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=nftables">nftables</a></span> из официальных репозиториев или git-версию <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://aur.archlinux.org/packages/nftables-git/">nftables-git</a></span><sup><small>AUR</small></sup> из AUR.
</p>
<div class="archwiki-template-box archwiki-template-box-tip">
<strong>Совет:</strong> Большинство <a href="../ru/Iptables.html#%D0%98%D0%BD%D1%82%D0%B5%D1%80%D1%84%D0%B5%D0%B9%D1%81" title="Iptables (Русский)">интерфейсов</a> iptables не имеет прямой или косвенной поддержки nftables, хотя возможность для этого существует <a rel="nofollow" class="external autonumber" href="https://www.spinics.net/lists/netfilter/msg58215.html">[2]</a>. <a href="../en/Firewalld.html" title="Firewalld">firewalld</a> — единственный графический интерфейс со встроенной поддержкой обеих версий утилит межсетевого экрана, как iptables, так и nftables <a rel="nofollow" class="external autonumber" href="https://firewalld.org/2018/07/nftables-backend">[3]</a>.</div>
<h2>
<span id=".D0.98.D1.81.D0.BF.D0.BE.D0.BB.D1.8C.D0.B7.D0.BE.D0.B2.D0.B0.D0.BD.D0.B8.D0.B5"></span><span class="mw-headline" id="Использование">Использование</span>
</h2>
<p>Для создания и загрузки правил используется утилита <code>nft</code>. Подробнее смотрите раздел <a href="#%D0%9D%D0%B0%D1%81%D1%82%D1%80%D0%BE%D0%B9%D0%BA%D0%B0">#Настройка</a>.
</p>
<p>Действующие правила можно узнать командой:
</p>
<pre># nft list ruleset
</pre>
<h3>
<span id=".D0.91.D0.B0.D0.B7.D0.BE.D0.B2.D0.B0.D1.8F_.D0.BA.D0.BE.D0.BD.D1.84.D0.B8.D0.B3.D1.83.D1.80.D0.B0.D1.86.D0.B8.D1.8F"></span><span class="mw-headline" id="Базовая_конфигурация">Базовая конфигурация</span>
</h3>
<p>В пакет <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=nftables">nftables</a></span> входит простая и безопасная конфигурация экрана, сохранённая в файле <code>/etc/nftables.conf</code>.
</p>
<p>Служба <code>nftables.conf</code> загрузит эти правила при <a href="../ru/Systemd.html#%D0%98%D1%81%D0%BF%D0%BE%D0%BB%D1%8C%D0%B7%D0%BE%D0%B2%D0%B0%D0%BD%D0%B8%D0%B5_%D1%8E%D0%BD%D0%B8%D1%82%D0%BE%D0%B2" class="mw-redirect" title="Запустите">запуске</a> или <a href="../ru/Systemd.html#%D0%98%D1%81%D0%BF%D0%BE%D0%BB%D1%8C%D0%B7%D0%BE%D0%B2%D0%B0%D0%BD%D0%B8%D0%B5_%D1%8E%D0%BD%D0%B8%D1%82%D0%BE%D0%B2" class="mw-redirect" title="Включите">включении</a>.
</p>
<h2>
<span id=".D0.9D.D0.B0.D1.81.D1.82.D1.80.D0.BE.D0.B9.D0.BA.D0.B0"></span><span class="mw-headline" id="Настройка">Настройка</span>
</h2>
<p>Утилита nft выполняет обработку правил перед передачей их ядру. Правила объединяются в цепочки, которые, в свою очередь, входят в состав таблиц. В следующих разделах описано создание и модифицирование этих структур.
</p>
<p>Прочитать правила из файла можно с помощью флага <code>-f</code>/<code>--file</code>
</p>
<pre># nft --file <i>имя-файла</i>
</pre>
<p>Обратите внимание, что уже загруженные правила не будут при этом автоматически стёрты.
</p>
<p>В руководстве <span class="plainlinks archwiki-template-man" title="$ man 8 nft"><a rel="nofollow" class="external text" href="https://man.archlinux.org/man/nft.8">nft(8)</a></span> можно найти полный список команд.
</p>
<h3>
<span id=".D0.A2.D0.B0.D0.B1.D0.BB.D0.B8.D1.86.D1.8B"></span><span class="mw-headline" id="Таблицы">Таблицы</span>
</h3>
<p>Таблицы содержат <a href="#%D0%A6%D0%B5%D0%BF%D0%BE%D1%87%D0%BA%D0%B8">#Цепочки</a>. В отличие от iptables, в nftables отсутствуют встроенные таблицы. Количество и название таблиц определяется пользователем. Однако каждая таблица имеет только одно семейство адресов и применяется к пакетам только этой семьи. Таблицы могут относиться к одному из пяти семейств.
</p>
<table class="wikitable">
<tbody>
<tr>
<th>семейство nftables</th>
<th>утилита iptables
</th>
</tr>
<tr>
<td>ip</td>
<td>iptables
</td>
</tr>
<tr>
<td>ip6</td>
<td>ip6tables
</td>
</tr>
<tr>
<td>inet</td>
<td>iptables and ip6tables
</td>
</tr>
<tr>
<td>arp</td>
<td>arptables
</td>
</tr>
<tr>
<td>bridge</td>
<td>ebtables
</td>
</tr>
</tbody>
</table>
<p><code>ip</code> - семейство по умолчанию; используется, если параметр семейства не был указан.
</p>
<p>Семейство <code>inet</code> используется для создания общих для протоколов IPv4 и IPv6 правил, что позволяет унифицировать семейства <code>ip</code> и <code>ip6</code> и упростить создание правил.
</p>
<p>Описание остальных семейств адресов вы найдёте в руководстве <span class="plainlinks archwiki-template-man" title="$ man 8 nft"><a rel="nofollow" class="external text" href="https://man.archlinux.org/man/nft.8#ADDRESS_FAMILIES">nft(8) § ADDRESS FAMILIES</a></span>.
</p>
<p>В командах ниже параметр <code><i>семейство</i></code> будет указываться не всегда; если его нет, то подразумевается семейство <code>ip</code>.
</p>
<h4>
<span id=".D0.A1.D0.BE.D0.B7.D0.B4.D0.B0.D0.BD.D0.B8.D0.B5_.D1.82.D0.B0.D0.B1.D0.BB.D0.B8.D1.86.D1.8B"></span><span class="mw-headline" id="Создание_таблицы">Создание таблицы</span>
</h4>
<p>Добавить новую таблицу:
</p>
<pre># nft add table <i>семейство</i> <i>таблица</i>
</pre>
<h4>
<span id=".D0.9F.D1.80.D0.BE.D1.81.D0.BC.D0.BE.D1.82.D1.80_.D1.82.D0.B0.D0.B1.D0.BB.D0.B8.D1.86"></span><span class="mw-headline" id="Просмотр_таблиц">Просмотр таблиц</span>
</h4>
<p>Вывести список таблиц:
</p>
<pre># nft list tables
</pre>
<h4>
<span id=".D0.9F.D1.80.D0.BE.D1.81.D0.BC.D0.BE.D1.82.D1.80_.D1.86.D0.B5.D0.BF.D0.BE.D1.87.D0.B5.D0.BA_.D0.B8_.D0.BF.D1.80.D0.B0.D0.B2.D0.B8.D0.BB"></span><span class="mw-headline" id="Просмотр_цепочек_и_правил">Просмотр цепочек и правил</span>
</h4>
<p>Вывести цепочки и правила выбранной таблицы:
</p>
<pre># nft list table <i>семейство</i> <i>таблица</i>
</pre>
<p>Например, чтобы вывести на экран правила таблицы <code>filter</code> семейства <code>inet</code>, выполните команду:
</p>
<pre># nft list table inet filter
</pre>
<h4>
<span id=".D0.A3.D0.B4.D0.B0.D0.BB.D0.B5.D0.BD.D0.B8.D0.B5_.D1.82.D0.B0.D0.B1.D0.BB.D0.B8.D1.86.D1.8B"></span><span class="mw-headline" id="Удаление_таблицы">Удаление таблицы</span>
</h4>
<p>Удалить таблицу со всеми цепочками:
</p>
<pre># nft delete table <i>семейство</i> <i>таблица</i>
</pre>
<h4>
<span id=".D0.A1.D1.82.D0.B8.D1.80.D0.B0.D0.BD.D0.B8.D0.B5_.D1.82.D0.B0.D0.B1.D0.BB.D0.B8.D1.86.D1.8B"></span><span class="mw-headline" id="Стирание_таблицы">Стирание таблицы</span>
</h4>
<p>Стереть все правила таблицы:
</p>
<pre># nft flush table <i>семейство</i> <i>таблица</i>
</pre>
<h3>
<span id=".D0.A6.D0.B5.D0.BF.D0.BE.D1.87.D0.BA.D0.B8"></span><span class="mw-headline" id="Цепочки">Цепочки</span>
</h3>
<p>Цепочка содержит <a href="#%D0%9F%D1%80%D0%B0%D0%B2%D0%B8%D0%BB%D0%B0">#Правила</a>. В отличие от iptables, в nftables отсутствуют встроенные цепочки. Соответственно, если опрелённые типы или хуки фреймворка netfilter не задействованы ни в одном правиле nftables, то проходящие через эти цепочки пакеты обрабатываться не будут.
</p>
<p>Есть два типа цепочек. <i>Базовая</i> цепочка является точкой входа для пакетов из сетевого стека, если указан хук. <i>Обычная</i> цепочка может использоваться в качестве цели перехода (jump).
</p>
<p>В командах ниже параметр <code><i>семейство</i></code> будет указываться не всегда; если его нет, то подразумевается семейство <code>ip</code>.
</p>
<h4>
<span id=".D0.A1.D0.BE.D0.B7.D0.B4.D0.B0.D0.BD.D0.B8.D0.B5_.D1.86.D0.B5.D0.BF.D0.BE.D1.87.D0.BA.D0.B8"></span><span class="mw-headline" id="Создание_цепочки">Создание цепочки</span>
</h4>
<h5>
<span id=".D0.9E.D0.B1.D1.8B.D1.87.D0.BD.D0.B0.D1.8F_.D1.86.D0.B5.D0.BF.D0.BE.D1.87.D0.BA.D0.B0"></span><span class="mw-headline" id="Обычная_цепочка">Обычная цепочка</span>
</h5>
<p>Добавить обычную цепочку <code><i>цепочка</i></code> в таблицу <code><i>таблица</i></code>:
</p>
<pre># nft add chain <i>семейство</i> <i>таблица</i> <i>цепочка</i>
</pre>
<p>Например, чтобы добавить обычную цепочку <code>tcpchain</code> к таблице <code>filter</code> семейства адресов <code>inet</code>, выполните:
</p>
<pre># nft add chain inet filter tcpchain
</pre>
<h5>
<span id=".D0.91.D0.B0.D0.B7.D0.BE.D0.B2.D0.B0.D1.8F_.D1.86.D0.B5.D0.BF.D0.BE.D1.87.D0.BA.D0.B0"></span><span class="mw-headline" id="Базовая_цепочка">Базовая цепочка</span>
</h5>
<p>Чтобы добавить базовую цепочку, укажите хук и значение приоритета:
</p>
<pre># nft add chain <i>семейство</i> <i>таблица</i> <i>цепочка</i> '{ type <i>тип</i> hook <i>хук</i> priority <i>приоритет</i> ; }'
</pre>
<p><code><i>тип</i></code> может принимать значения <code>filter</code>, <code>route</code> или <code>nat</code>.
</p>
<p>Для семейств адресов IPv4/IPv6/Inet <code><i>хук</i></code> может принимать значения <code>prerouting</code>, <code>input</code>, <code>forward</code>, <code>output</code> или <code>postrouting</code>. Описание других возможных хуков вы найдёте в руководстве <span class="plainlinks archwiki-template-man" title="$ man 8 nft"><a rel="nofollow" class="external text" href="https://man.archlinux.org/man/nft.8#ADDRESS_FAMILIES">nft(8) § ADDRESS FAMILIES</a></span>.
</p>
<p>Параметр <code><i>приоритет</i></code> задаётся названием приоритета или его значением (подробнее см. <span class="plainlinks archwiki-template-man" title="$ man 8 nft"><a rel="nofollow" class="external text" href="https://man.archlinux.org/man/nft.8#CHAINS">nft(8) § CHAINS</a></span>). Цепочки с более низкими значениями обрабатываются раньше. Значение приоритета может быть отрицательным <a rel="nofollow" class="external autonumber" href="https://wiki.nftables.org/wiki-nftables/index.php/Configuring_chains#Base_chain_types">[4]</a>.
</p>
<p>Например, добавим базовую цепочку для фильтрации входящих пакетов:
</p>
<pre># nft add chain inet filter input '{ type filter hook input priority 0; }'
</pre>
<p>Если заменить команду <code>add</code> на <code>create</code> в любом из правил выше, то цепочка тоже будет создана, но при этом вы получите сообщение об ошибке, если цепочка с таким названием уже существует.
</p>
<h4>
<span id=".D0.9F.D1.80.D0.BE.D1.81.D0.BC.D0.BE.D1.82.D1.80_.D0.BF.D1.80.D0.B0.D0.B2.D0.B8.D0.BB"></span><span class="mw-headline" id="Просмотр_правил">Просмотр правил</span>
</h4>
<p>Следующая команда выводит на экран все правила в цепочке:
</p>
<pre># nft list chain <i>семейство</i> <i>таблица</i> <i>цепочка</i>
</pre>
<p>Например, следующая команда выведет правила цепочки <code>output</code> таблицы <code>filter</code> семейства <code>inet</code>:
</p>
<pre># nft list chain inet filter output
</pre>
<h4>
<span id=".D0.98.D0.B7.D0.BC.D0.B5.D0.BD.D0.B5.D0.BD.D0.B8.D0.B5_.D1.86.D0.B5.D0.BF.D0.BE.D1.87.D0.BA.D0.B8"></span><span class="mw-headline" id="Изменение_цепочки">Изменение цепочки</span>
</h4>
<p>Для редактирования цепочки укажите её название и правила, которые нужно изменить:
</p>
<pre># nft chain <i>семейство таблица цепочка</i> '{ [ type <i>тип</i> hook <i>хук</i> device <i>устройство</i> priority <i>приоритет</i> ; policy <i>политика</i> ; ] }'
</pre>
<p>Например, для изменения политики обработки входящих пакетов цепочки исходной таблицы с <code>accept</code> на <code>drop</code> выполните команду:
</p>
<pre># nft chain inet filter input '{ policy drop ; }'
</pre>
<h4>
<span id=".D0.A3.D0.B4.D0.B0.D0.BB.D0.B5.D0.BD.D0.B8.D0.B5_.D1.86.D0.B5.D0.BF.D0.BE.D1.87.D0.BA.D0.B8"></span><span class="mw-headline" id="Удаление_цепочки">Удаление цепочки</span>
</h4>
<p>Удалить цепочку:
</p>
<pre># nft delete chain <i>семейство</i> <i>таблица</i> <i>цепочка</i>
</pre>
<p>Цепочка должна быть пустой (не содержать правил) и не должна быть целью перехода из другой цепочки.
</p>
<h4>
<span id=".D0.A1.D1.82.D0.B5.D1.80.D0.B5.D1.82.D1.8C_.D0.BF.D1.80.D0.B0.D0.B2.D0.B8.D0.BB.D0.B0_.D0.B8.D0.B7_.D1.86.D0.B5.D0.BF.D0.BE.D1.87.D0.BA.D0.B8"></span><span class="mw-headline" id="Стереть_правила_из_цепочки">Стереть правила из цепочки</span>
</h4>
<p>Чтобы стереть все правила цепочки, выполните:
</p>
<pre># nft flush chain <i>семейство</i> <i>таблица</i> <i>цепочка</i>
</pre>
<h3>
<span id=".D0.9F.D1.80.D0.B0.D0.B2.D0.B8.D0.BB.D0.B0"></span><span class="mw-headline" id="Правила">Правила</span>
</h3>
<p>Правила конструируются из выражений (expressions) и операторов (statements) и содержатся внутри цепочек.
</p>
<h4>
<span id=".D0.94.D0.BE.D0.B1.D0.B0.D0.B2.D0.BB.D0.B5.D0.BD.D0.B8.D0.B5_.D0.BF.D1.80.D0.B0.D0.B2.D0.B8.D0.BB.D0.B0"></span><span class="mw-headline" id="Добавление_правила">Добавление правила</span>
</h4>
<div class="archwiki-template-box archwiki-template-box-tip">
<strong>Совет:</strong> Утилита <i>iptables-translate</i> поможет преобразовать правила <a href="../ru/Iptables.html" title="Iptables (Русский)">iptables</a> в формат nftables.</div>
<p>Чтобы добавить правило в цепочку, выполните:
</p>
<pre># nft add rule <i>семейство</i> <i>таблица</i> <i>цепочка</i> handle <i>маркер</i> <i>оператор</i>
</pre>
<p>Правило будет прикреплено после <code><i>маркер</i></code>, который можно не указывать. Если маркер (handle) не задать, то правило добавится в конец цепочки.
</p>
<p>Чтобы добавить правило перед определённой позицией, выполните
</p>
<pre># nft insert rule <i>семейство</i> <i>таблица</i> <i>цепочка</i> handle <i>маркер</i> <i>оператор</i>
</pre>
<p>Если <code><i>маркер</i></code> не указан, то правило добавится в начало цепочки.
</p>
<h5>
<span id=".D0.92.D1.8B.D1.80.D0.B0.D0.B6.D0.B5.D0.BD.D0.B8.D1.8F"></span><span class="mw-headline" id="Выражения">Выражения</span>
</h5>
<p>Обычно <code><i>оператор</i></code> включает несколько выражений для сравнений и вынесения решения. Решениями могут быть <code>accept</code>, <code>drop</code>, <code>queue</code>, <code>continue</code>, <code>return</code>, <code>jump <i>цепочка</i></code> и <code>goto <i>цепочка</i></code>. Возможны и другие операторы помимо решений, подробнее смотрите <span class="plainlinks archwiki-template-man" title="$ man 8 nft"><a rel="nofollow" class="external text" href="https://man.archlinux.org/man/nft.8">nft(8)</a></span>.
</p>
<p>В nftables доступен ряд выражений, по большей части совпадающий с аналогичными в iptables. Наиболее важное отличие заключается в том, что здесь нет обобщённых или неявных параметров. Обобщённый параметр (generic match) обычно доступен для всех правил, например, параметры <code>--protocol</code> или <code>--source</code>. Неявные правила (implicit matches) относятся к конкретному протоколу, как параметр <code>--sport</code> для пакетов TCP.
</p>
<p>Ниже представлен неполный список возможных параметров:
</p>
<ul>
<li>meta    (метасущности, напр. интерфейсы)</li>
<li>icmp    (протокол ICMP)</li>
<li>icmpv6  (протокол ICMPv6)</li>
<li>ip      (протокол IP)</li>
<li>ip6     (протокол IPv6)</li>
<li>tcp     (протокол TCP)</li>
<li>udp     (протокол UDP)</li>
<li>sctp    (протокол SCTP)</li>
<li>ct      (отслеживание соединений)</li>
</ul>
<p>Ниже приведён неполный список аргументов для параметров (подробнее см. <span class="plainlinks archwiki-template-man" title="$ man 8 nft"><a rel="nofollow" class="external text" href="https://man.archlinux.org/man/nft.8">nft(8)</a></span>):
</p>
<pre>meta:
  oif &lt;интерфейс-отправитель НОМЕР&gt;
  iif &lt;интерфейс-получатель НОМЕР&gt;
  oifname &lt;интерфейс-отправитель ИМЯ&gt;
  iifname &lt;интерфейс-получатель ИМЯ&gt;

  (параметры oif и iif принимаю строковые значения, которые конвертируются в номер)
  (параметры oifname и iifname более гибкие, но они медленнее из-за необходимости работать со строками-именами)

icmp:
  type &lt;тип icmp&gt;

icmpv6:
  type &lt;тип icmpv6&gt;

ip:
  protocol &lt;протокол&gt;
  daddr &lt;адрес получателя&gt;
  saddr &lt;адрес отправителя&gt;

ip6:
  daddr &lt;адрес получателя&gt;
  saddr &lt;адрес отправителя&gt;

tcp:
  dport &lt;порт получателя&gt;
  sport &lt;порт отправителя&gt;

udp:
  dport &lt;порт получателя&gt;
  sport &lt;порт отправителя&gt;

sctp:
  dport &lt;порт получателя&gt;
  sport &lt;порт отправителя&gt;

ct:
  state &lt;new | established | related | invalid&gt;
</pre>
<h4>
<span id=".D0.A3.D0.B4.D0.B0.D0.BB.D0.B5.D0.BD.D0.B8.D0.B5"></span><span class="mw-headline" id="Удаление">Удаление</span>
</h4>
<p>Отдельные правила могут быть удалены только с помощью маркера. Команда <code>nft --handle list</code> выведет список маркеров.
</p>
<p>Ниже приведён пример правила с маркером и команда для его удаления. Аргумент <code>--numeric</code> позволяет выводить IP-адреса в численном виде.
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;"># nft --handle --numeric list chain inet filter input</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">table inet fltrTable {
     chain input {
          type filter hook input priority 0;
          ip saddr 127.0.0.1 accept # handle 10
     }
}
</pre>
<pre># nft delete rule inet fltrTable input handle 10
</pre>
<p>Стирание всех цепочек таблицы выполняется командой <code>nft flush table</code>. Отдельные цепочки могут быть стёрты командами <code>nft flush chain</code> или <code>nft delete rule</code>.
</p>
<pre># nft flush table foo
# nft flush chain foo bar
# nft delete rule ip6 foo bar
</pre>
<p>Первая команда стирает все цепочки в ip-таблице <code>foo</code>. Вторая - цепочку <code>bar</code> в ip-таблице <code>foo</code>.  Третья удаляет все правила в цепочке <code>bar</code> в ip6-таблице <code>foo</code>.
</p>
<h3>
<span id=".D0.9F.D0.BE.D0.BB.D0.BD.D0.B0.D1.8F_.D0.BF.D0.B5.D1.80.D0.B5.D0.B7.D0.B0.D0.B3.D1.80.D1.83.D0.B7.D0.BA.D0.B0_.D0.BF.D1.80.D0.B0.D0.B2.D0.B8.D0.BB"></span><span class="mw-headline" id="Полная_перезагрузка_правил">Полная перезагрузка правил</span>
</h3>
<p>Создать файл для новых правил:
</p>
<pre># echo "flush ruleset" &gt; /tmp/nftables 
</pre>
<p>Сбросить дамп правил в новый файл:
</p>
<pre># nft -s list ruleset &gt;&gt; /tmp/nftables
</pre>
<p>Теперь можно редактировать файл <code>/tmp/nftables</code>, создавая и изменяя правила. Применить изменения можно командой:
</p>
<pre># nft -f /tmp/nftables
</pre>
<h2>
<span id=".D0.9F.D1.80.D0.B8.D0.BC.D0.B5.D1.80.D1.8B"></span><span class="mw-headline" id="Примеры">Примеры</span>
</h2>
<h3>
<span id=".D0.A0.D0.B0.D0.B1.D0.BE.D1.87.D0.B0.D1.8F_.D1.81.D1.82.D0.B0.D0.BD.D1.86.D0.B8.D1.8F"></span><span class="mw-headline" id="Рабочая_станция">Рабочая станция</span>
</h3>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/nftables.conf</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">flush ruleset

table inet filter {
	chain input {
		type filter hook input priority 0; policy drop;

		iif lo accept comment "Accept any localhost traffic"
		ct state invalid drop comment "Drop invalid connections"
		ct state established,related accept comment "Accept traffic originated from us"

		meta l4proto ipv6-icmp icmpv6 type { destination-unreachable, packet-too-big, time-exceeded, parameter-problem, mld-listener-query, mld-listener-report, mld-listener-reduction, nd-router-solicit, nd-router-advert, nd-neighbor-solicit, nd-neighbor-advert, ind-neighbor-solicit, ind-neighbor-advert, mld2-listener-report } accept comment "Accept ICMPv6"
		meta l4proto icmp icmp type { destination-unreachable, router-solicitation, router-advertisement, time-exceeded, parameter-problem } accept comment "Accept ICMP"
		ip protocol igmp accept comment "Accept IGMP"

		udp dport mdns ip6 daddr ff02::fb accept comment "Accept mDNS"
		udp dport mdns ip daddr 224.0.0.251 accept comment "Accept mDNS"

		udp sport 1900 udp dport &gt;= 1024 ip6 saddr { fd00::/8, fe80::/10 } meta pkttype unicast limit rate 4/second burst 20 packets accept comment "Accept UPnP IGD port mapping reply"
		udp sport 1900 udp dport &gt;= 1024 ip saddr { 10.0.0.0/8, 172.16.0.0/12, 192.168.0.0/16, 169.254.0.0/16 } meta pkttype unicast limit rate 4/second burst 20 packets accept comment "Accept UPnP IGD port mapping reply"

		udp sport netbios-ns udp dport &gt;= 1024 meta pkttype unicast ip6 saddr { fd00::/8, fe80::/10 } accept comment "Accept Samba Workgroup browsing replies"
		udp sport netbios-ns udp dport &gt;= 1024 meta pkttype unicast ip saddr { 10.0.0.0/8, 172.16.0.0/12, 192.168.0.0/16, 169.254.0.0/16 } accept comment "Accept Samba Workgroup browsing replies"

		counter comment "Count any other traffic"
	}

	chain forward {
		type filter hook forward priority 0; policy drop;
	}

	chain output {
		type filter hook output priority 0; policy accept;
	}

}
</pre>
<h3>
<span id=".D0.A1.D0.B5.D1.80.D0.B2.D0.B5.D1.80"></span><span class="mw-headline" id="Сервер">Сервер</span>
</h3>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/nftables.conf</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">flush ruleset

table inet filter {
	chain input {
		type filter hook input priority 0; policy drop;

		iif lo accept comment "Accept any localhost traffic"
		ct state invalid drop comment "Drop invalid connections"
		ct state established,related accept comment "Accept traffic originated from us"

		meta l4proto ipv6-icmp icmpv6 type { destination-unreachable, packet-too-big, time-exceeded, parameter-problem, mld-listener-query, mld-listener-report, mld-listener-reduction, nd-router-solicit, nd-router-advert, nd-neighbor-solicit, nd-neighbor-advert, ind-neighbor-solicit, ind-neighbor-advert, mld2-listener-report } accept comment "Accept ICMPv6"
		meta l4proto icmp icmp type { destination-unreachable, router-solicitation, router-advertisement, time-exceeded, parameter-problem } accept comment "Accept ICMP"
		ip protocol igmp accept comment "Accept IGMP"

		udp dport mdns ip6 daddr ff02::fb accept comment "Accept mDNS"
		udp dport mdns ip daddr 224.0.0.251 accept comment "Accept mDNS"

		tcp dport ssh accept comment "Accept SSH on port 22"

		tcp dport ipp accept comment "Accept IPP/IPPS on port 631"

		tcp dport { http, https, 8008, 8080 } accept comment "Accept HTTP (ports 80, 443, 8008, 8080)"

		meta l4proto { tcp, udp } th dport 2049 ip6 saddr { fd00::/8, fe80::/10 } accept comment "Accept NFS"
		meta l4proto { tcp, udp } th dport 2049 ip saddr { 10.0.0.0/8, 172.16.0.0/12, 192.168.0.0/16, 169.254.0.0/16 } accept comment "Accept NFS"

		udp dport netbios-ns ip6 saddr { fd00::/8, fe80::/10 } accept comment "Accept NetBIOS Name Service (nmbd)"
		udp dport netbios-ns ip saddr { 10.0.0.0/8, 172.16.0.0/12, 192.168.0.0/16, 169.254.0.0/16 } accept comment "Accept NetBIOS Name Service (nmbd)"
		udp dport netbios-dgm ip6 saddr { fd00::/8, fe80::/10 } accept comment "Accept NetBIOS Datagram Service (nmbd)"
		udp dport netbios-dgm ip saddr { 10.0.0.0/8, 172.16.0.0/12, 192.168.0.0/16, 169.254.0.0/16 } accept comment "Accept NetBIOS Datagram Service (nmbd)"
		tcp dport netbios-ssn ip6 saddr { fd00::/8, fe80::/10 } accept comment "Accept NetBIOS Session Service (smbd)"
		tcp dport netbios-ssn ip saddr { 10.0.0.0/8, 172.16.0.0/12, 192.168.0.0/16, 169.254.0.0/16 } accept comment "Accept NetBIOS Session Service (smbd)"
		tcp dport microsoft-ds ip6 saddr { fd00::/8, fe80::/10 } accept comment "Accept Microsoft Directory Service (smbd)"
		tcp dport microsoft-ds ip saddr { 10.0.0.0/8, 172.16.0.0/12, 192.168.0.0/16, 169.254.0.0/16 } accept comment "Accept Microsoft Directory Service (smbd)"

		udp sport bootpc udp dport bootps ip saddr 0.0.0.0 ip daddr 255.255.255.255 accept comment "Accept DHCPDISCOVER (for DHCP-Proxy)"
		udp sport { bootpc, 4011 } udp dport { bootps, 4011 } ip saddr { 10.0.0.0/8, 172.16.0.0/12, 192.168.0.0/16, 169.254.0.0/16 } accept comment "Accept PXE"
		udp dport tftp ip6 saddr { fd00::/8, fe80::/10 } accept comment "Accept TFTP"
		udp dport tftp ip saddr { 10.0.0.0/8, 172.16.0.0/12, 192.168.0.0/16, 169.254.0.0/16 } accept comment "Accept TFTP"

	}

	chain forward {
		type filter hook forward priority 0; policy drop;
	}

	chain output {
		type filter hook output priority 0; policy accept;
	}

}
</pre>
<h3>
<span id=".D0.9E.D0.B3.D1.80.D0.B0.D0.BD.D0.B8.D1.87.D0.B5.D0.BD.D0.B8.D0.B5_.D1.81.D0.BA.D0.BE.D1.80.D0.BE.D1.81.D1.82.D0.B8_.D0.BF.D0.B5.D1.80.D0.B5.D0.B4.D0.B0.D1.87.D0.B8"></span><span class="mw-headline" id="Ограничение_скорости_передачи">Ограничение скорости передачи</span>
</h3>
<pre>table inet filter {
	chain input {
		type filter hook input priority 0; policy drop;

		iif lo accept comment "Accept any localhost traffic"
		ct state invalid drop comment "Drop invalid connections"

		meta l4proto icmp icmp type echo-request limit rate over 10/second burst 4 packets drop comment "No ping floods"
		meta l4proto ipv6-icmp icmpv6 type echo-request limit rate over 10/second burst 4 packets drop comment "No ping floods"

		ct state established,related accept comment "Accept traffic originated from us"

		meta l4proto ipv6-icmp icmpv6 type { destination-unreachable, packet-too-big, time-exceeded, parameter-problem, mld-listener-query, mld-listener-report, mld-listener-reduction, nd-router-solicit, nd-router-advert, nd-neighbor-solicit, nd-neighbor-advert, ind-neighbor-solicit, ind-neighbor-advert, mld2-listener-report } accept comment "Accept ICMPv6"
		meta l4proto icmp icmp type { destination-unreachable, router-solicitation, router-advertisement, time-exceeded, parameter-problem } accept comment "Accept ICMP"
		ip protocol igmp accept comment "Accept IGMP"

		tcp dport ssh ct state new limit rate 15/minute accept comment "Avoid brute force on SSH"

	}

}
</pre>
<h3>
<span id=".D0.9F.D0.B5.D1.80.D0.B5.D1.85.D0.BE.D0.B4"></span><span class="mw-headline" id="Переход">Переход</span>
</h3>
<p>Если вы используете переходы (jumps), то целевая цепочка должна быть описана до перехода. Иначе будет получена ошибка <code>Error: Could not process rule: No such file or directory</code>.
</p>
<pre>table inet filter {
    chain web {
        tcp dport http accept
        tcp dport 8080 accept
    }
    chain input {
        type filter hook input priority 0;
        ip saddr 10.0.2.0/24 jump web
        drop
    }
}
</pre>
<h3>
<span id=".D0.9D.D0.B5.D1.81.D0.BA.D0.BE.D0.BB.D1.8C.D0.BA.D0.BE_.D1.81.D0.B5.D1.82.D0.B5.D0.B2.D1.8B.D1.85_.D0.B8.D0.BD.D1.82.D0.B5.D1.80.D1.84.D0.B5.D0.B9.D1.81.D0.BE.D0.B2_.D1.81_.D1.80.D0.B0.D0.B7.D0.BD.D1.8B.D0.BC.D0.B8_.D0.BF.D1.80.D0.B0.D0.B2.D0.B8.D0.BB.D0.B0.D0.BC.D0.B8"></span><span class="mw-headline" id="Несколько_сетевых_интерфейсов_с_разными_правилами">Несколько сетевых интерфейсов с разными правилами</span>
</h3>
<p>Если у вашей системы несколько сетевых интерфейсов и вы хотите использовать для них разные наборы правил, то создайте фильтрующую цепочку-диспетчер, а после неё опишите цепочки для сетевых интерфейсов. Например, пусть ваша машина выступает в качестве домашнего маршрутизатора и вы желаете запустить веб-сервер, доступный по локальной сети (интерфейс <code>enp3s0</code>), но не из публичного интернета (интерфейс <code>enp2s0</code>). Создайте таблицу вроде этой:
</p>
<pre>table inet filter {
  chain input { # эта цепочка выступает в качестве диспетчера
    type filter hook input priority 0;

    iif lo accept # доступ к петлевому интерфейсу всегда разрешён
    iifname enp2s0 jump input_enp2s0
    iifname enp3s0 jump input_enp3s0

    reject with icmpx type port-unreachable # отклонить трафик от остальных интерфейсов
  }
  chain input_enp2s0 { # правила для публичного интерфейса
    ct state {established,related} accept
    ct state invalid drop
    udp dport bootpc accept
    tcp dport bootpc accept
    reject with icmpx type port-unreachable # весь остальной трафик
  }
  chain input_enp3s0 { # правила для веб-сервера на LAN-интерфейсе
    ct state {established,related} accept
    ct state invalid drop
    udp dport bootpc accept
    tcp dport bootpc accept
    tcp port http accept
    tcp port https accept
    reject with icmpx type port-unreachable # весь остальной трафик
  }
  chain ouput { # все исходящие пакеты - разрешены
    type filter hook output priority 0;
    accept
  }
}
</pre>
<p>Можно поступить иначе - задать только одну строку <code>iifname</code>, например для интерфейса веб-сервера, а правила для остальных интерфейсов вместо диспетчеризации описать в одном месте.
</p>
<h3>
<span id=".D0.9C.D0.B0.D1.81.D0.BA.D0.B0.D1.80.D0.B0.D0.B4.D0.B8.D0.BD.D0.B3"></span><span class="mw-headline" id="Маскарадинг">Маскарадинг</span>
</h3>
<p>В nftables есть специальное ключевое слово <code>masquerade</code>, "позволяющее автоматически изменять адрес источника на адрес интерфейса-отправителя" <a rel="nofollow" class="external autonumber" href="https://wiki.nftables.org/wiki-nftables/index.php/Performing_Network_Address_Translation_%28NAT%29#Masquerading">[5]</a>. Это особенно удобно в ситуациях, когда IP-адрес интерфейса непредсказуем или нестабилен — например, исходящий интерфейс маршрутизатора, подключённого к нескольким интернет-провайдерам. <a href="https://en.wikipedia.org/wiki/ru:%D0%9C%D0%B0%D1%81%D0%BA%D0%B0%D1%80%D0%B0%D0%B4%D0%B8%D0%BD%D0%B3" class="extiw" title="wikipedia:ru:Маскарадинг">Маскарадинг</a> позволяет не переписывать правила межсетевого экрана для трансляции сетевых адресов (NAT) при каждом изменении IP-адреса интерфейса.
</p>
<p>Правила работы маскарадинга:
</p>
<ul>
<li>опция <code>masquerading</code> в ядре Linux должна быть включена (в стандартном ядре она включена по умолчанию); в противном случае задайте параметр ядра <code>CONFIG_NFT_MASQ=m</code>.</li>
<li>ключевое слово <code>masquerade</code> может использоваться только в цепочке типа <code>nat</code>.</li>
<li>masquerading является подвидом <a href="https://en.wikipedia.org/wiki/Network_Address_Translation#SNAT" class="extiw" title="wikipedia:Network Address Translation">SNAT</a>, поэтому работает только исходящих интерфейсов.</li>
</ul>
<p>Пример правил межсетевого экрана для машины с двумя интерфейсами, локальным <code>enp3s0</code> и публичным <code>enp2s0</code>:
</p>
<pre>table inet nat {
  chain masquerade {
    type nat hook postrouting priority 100;
    oifname "enp2s0" masquerade
  }
}
</pre>
<p>Поскольку таблица выше относится к типу <code>inet</code>, то маскарадингу подвергаются пакеты и IPv4, и IPv6. Чтобы ограничить маскарадинг только IPv4-пакетами (т.к. у IPv6 большое пространство адресов и NAT не требуется) либо добавьте выражение <code>meta nfproto ipv4</code> перед <code>oifname "enp2s0" masquerade</code>, либо измените тип таблицы на <code>ip</code>.
</p>
<h3>
<span id="NAT_.D1.81_.D0.BF.D1.80.D0.BE.D0.B1.D1.80.D0.BE.D1.81.D0.BE.D0.BC_.D0.BF.D0.BE.D1.80.D1.82.D0.BE.D0.B2"></span><span class="mw-headline" id="NAT_с_пробросом_портов">NAT с пробросом портов</span>
</h3>
<p>Ниже приведён пример проброса портов 22 и 80 на адрес <code><i>ip-адрес_получателя</i></code>. Необходимо предварительно с помощью <a href="../en/Sysctl.html" title="Sysctl">sysctl</a> установить параметры <code>net.ipv4.ip_forward</code> и <code>net.ipv4.conf.<i>wan_интерфейс</i>.forwarding</code> на <code>1</code>.
</p>
<pre>table ip nat {
  chain prerouting {
    type nat hook prerouting priority -100;

    tcp dport { ssh, http } dnat to <i>ip-адрес_получателя</i>
  }

  chain postrouting {
    type nat hook postrouting priority 100;

    ip daddr <i>ip-адрес_получателя</i> masquerade
  }
}
&lt;/nowiki&gt;</pre>
<h3>
<span id=".D0.A1.D1.87.D1.91.D1.82.D1.87.D0.B8.D0.BA_.D0.BD.D0.BE.D0.B2.D1.8B.D1.85_.D1.81.D0.BE.D0.B5.D0.B4.D0.B8.D0.BD.D0.B5.D0.BD.D0.B8.D0.B9"></span><span class="mw-headline" id="Счётчик_новых_соединений">Счётчик новых соединений</span>
</h3>
<p>Следующий сниппет позволяет считать открытые HTTPS-соединения:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/nftables.conf</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">table inet filter {
    set https {
        type ipv4_addr;
        flags dynamic;
        size 65536;
        timeout 60m;
    }

    chain input {
        type filter hook input priority 0
        ct state new tcp dport 443 update @https { ip saddr counter }
    }
}
</pre>
<p>Текущее значение счётчика можно вывести командой <code>nft list set inet filter https</code>.
</p>
<h3>
<span id=".D0.94.D0.B8.D0.BD.D0.B0.D0.BC.D0.B8.D1.87.D0.B5.D1.81.D0.BA.D0.B0.D1.8F_.D0.B1.D0.BB.D0.BE.D0.BA.D0.B8.D1.80.D0.BE.D0.B2.D0.BA.D0.B0"></span><span class="mw-headline" id="Динамическая_блокировка">Динамическая блокировка</span>
</h3>
<p>Следующий сниппет позволяет в течение минуты отклонять все HTTPS-соединения от адресов, которые превысили лимит в 10 запросов на соединение в секунду:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/nftables.conf</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">table inet dev {
    set blackhole {
        type ipv4_addr;
        flags dynamic, timeout;
        size 65536;
    }

    chain input {
        ct state new tcp dport 443 \
                meter flood size 128000 { ip saddr timeout 10s limit rate over 10/second } \
                add @blackhole { ip saddr timeout 1m }

        ip saddr @blackhole counter drop
    }
}
</pre>
<p>Для вывода заблокированных адресов выполните <code>nft list set inet filter blackhole</code>.
</p>
<h2>
<span id=".D0.A1.D0.BE.D0.B2.D0.B5.D1.82.D1.8B_.D0.B8_.D1.80.D0.B5.D0.BA.D0.BE.D0.BC.D0.B5.D0.BD.D0.B4.D0.B0.D1.86.D0.B8.D0.B8"></span><span class="mw-headline" id="Советы_и_рекомендации">Советы и рекомендации</span>
</h2>
<h3>
<span id=".D0.A1.D0.BE.D1.85.D1.80.D0.B0.D0.BD.D0.B5.D0.BD.D0.B8.D0.B5_.D1.82.D0.B5.D0.BA.D1.83.D1.89.D0.B5.D0.B3.D0.BE_.D0.BD.D0.B0.D0.B1.D0.BE.D1.80.D0.B0_.D0.BF.D1.80.D0.B0.D0.B2.D0.B8.D0.BB"></span><span class="mw-headline" id="Сохранение_текущего_набора_правил">Сохранение текущего набора правил</span>
</h3>
<p>Вывод команды <code>nft list ruleset</code> можно использовать в качестве входных данных для других команд. Текущий набор правил можно сохранить в файл, а позже — загрузить их из него.
</p>
<pre># nft -s list ruleset | tee <i>название_файла</i>
</pre>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Примечание:</strong> Команда <code>nft list</code> не выводит определения переменных. Если в файле <code>/etc/nftables.conf</code> есть какие-либо переменные, то в выводе команды вы их не увидите — все переменные будут заменены на значения.
</div>
<h3>
<span id=".D0.9D.D0.B0.D1.81.D1.82.D1.80.D0.BE.D0.B9.D0.BA.D0.B0_.D0.BC.D0.B5.D0.B6.D1.81.D0.B5.D1.82.D0.B5.D0.B2.D0.BE.D0.B3.D0.BE_.D1.8D.D0.BA.D1.80.D0.B0.D0.BD.D0.B0"></span><span class="mw-headline" id="Настройка_межсетевого_экрана">Настройка межсетевого экрана</span>
</h3>
<p>См. также <a href="../ru/Simple_stateful_firewall.html" class="mw-redirect" title="Настройка межсетевого экрана">Настройка межсетевого экрана</a>.
</p>
<h4>
<span id=".D0.9E.D0.B4.D0.B8.D0.BD.D0.BE.D1.87.D0.BD.D0.B0.D1.8F_.D0.BC.D0.B0.D1.88.D0.B8.D0.BD.D0.B0"></span><span class="mw-headline" id="Одиночная_машина">Одиночная машина</span>
</h4>
<p>Сотрите текущий набор правил:
</p>
<pre># nft flush ruleset
</pre>
<p>Добавьте таблицу:
</p>
<pre># nft add table inet filter
</pre>
<p>Добавьте базовые цепочки input, forward и output. Политика для входящих и пересылаемых пакетов должна быть drop. Политика для исходящих пакетов — accept.
</p>
<pre># nft add chain inet filter input '{ type filter hook input priority 0 ; policy drop ; }'
# nft add chain inet filter forward '{ type filter hook forward priority 0 ; policy drop ; }'
# nft add chain inet filter output '{ type filter hook output priority 0 ; policy accept ; }'
</pre>
<p>Добавьте две обычные цепочки, которые будут обрабатывать пакеты протоколов TCP и UDP:
</p>
<pre># nft add chain inet filter TCP
# nft add chain inet filter UDP
</pre>
<p>Разрешите related и established трафик:
</p>
<pre># nft add rule inet filter input ct state related,established accept
</pre>
<p>Разрешите трафик на петлевой интерфейс:
</p>
<pre># nft add rule inet filter input iif lo accept
</pre>
<p>Заблокируйте invalid трафик:
</p>
<pre># nft add rule inet filter input ct state invalid drop
</pre>
<p>Разрешите пакеты ICMP и IGMP:
</p>
<pre># nft add rule inet filter input meta l4proto ipv6-icmp icmpv6 type '{ destination-unreachable, packet-too-big, time-exceeded, parameter-problem, mld-listener-query, mld-listener-report, mld-listener-reduction, nd-router-solicit, nd-router-advert, nd-neighbor-solicit, nd-neighbor-advert, ind-neighbor-solicit, ind-neighbor-advert, mld2-listener-report }' accept
# nft add rule inet filter input meta l4proto icmp icmp type '{ destination-unreachable, router-solicitation, router-advertisement, time-exceeded, parameter-problem }' accept
# nft add rule inet filter input ip protocol igmp accept
</pre>
<p>Новый UDP-трафик будет передаваться цепочке UDP:
</p>
<pre># nft add rule inet filter input meta l4proto udp ct state new jump UDP
</pre>
<p>Новый TCP-трафик будет передаваться цепочке TCP:
</p>
<pre># nft add rule inet filter input 'meta l4proto tcp tcp flags &amp; (fin|syn|rst|ack) == syn ct state new jump TCP'
</pre>
<p>Заблокировать весь трафик, который не обрабатывается другими правилами:
</p>
<pre># nft add rule inet filter input meta l4proto udp reject
# nft add rule inet filter input meta l4proto tcp reject with tcp reset
# nft add rule inet filter input counter reject with icmpx type port-unreachable
</pre>
<p>В этом месте необходимо выбрать, какие порты будут оставаться открытыми для входящих соединений, обрабатываемых цепочками TCP и UDP. Например, открыть соединения для веб-сервера:
</p>
<pre># nft add rule inet filter TCP tcp dport 80 accept
</pre>
<p>Разрешить HTTPS-соединения для веб-сервера на порте 443:
</p>
<pre># nft add rule inet filter TCP tcp dport 443 accept
</pre>
<p>Разрешить SSH-трафик на порт 22:
</p>
<pre># nft add rule inet filter TCP tcp dport 22 accept
</pre>
<p>Разрешить входящие DNS-запросы:
</p>
<pre># nft add rule inet filter TCP tcp dport 53 accept
# nft add rule inet filter UDP udp dport 53 accept
</pre>
<p>В конце не забудьте сохранить набор правил, чтобы они стали постоянными.
</p>
<h3>
<span id=".D0.9F.D1.80.D0.B5.D0.B4.D0.BE.D1.82.D0.B2.D1.80.D0.B0.D1.89.D0.B5.D0.BD.D0.B8.D0.B5_.D0.B0.D1.82.D0.B0.D0.BA_.D0.BF.D0.B5.D1.80.D0.B5.D0.B1.D0.BE.D1.80.D0.BE.D0.BC"></span><span class="mw-headline" id="Предотвращение_атак_перебором">Предотвращение атак перебором</span>
</h3>
<p><a href="../en/Sshguard.html" title="Sshguard">Sshguard</a> может обнаруживать атаки перебором и модифицировать сетевые экраны, временно помещая IP-адреса в чёрный список. Описание настройки nftables для работы с sshguard можно найти в статье <a href="../en/Sshguard.html#nftables" title="Sshguard">Sshguard#nftables</a>.
</p>
<h3>
<span id=".D0.9B.D0.BE.D0.B3_.D1.82.D1.80.D0.B0.D1.84.D0.B8.D0.BA.D0.B0"></span><span class="mw-headline" id="Лог_трафика">Лог трафика</span>
</h3>
<p>Действие <code>log</code> позволяет вести лог проходящих через сетевой интерфейс пакетов. Простейшее правило для сохранения информации обо всём поступающем трафике:
</p>
<pre># nft add rule inet filter input log
</pre>
<p>Подробнее см. <a rel="nofollow" class="external text" href="https://wiki.nftables.org/wiki-nftables/index.php/Logging_traffic">nftables wiki</a>.
</p>
<h2>
<span id=".D0.A0.D0.B5.D1.88.D0.B5.D0.BD.D0.B8.D0.B5_.D0.BF.D1.80.D0.BE.D0.B1.D0.BB.D0.B5.D0.BC"></span><span class="mw-headline" id="Решение_проблем">Решение проблем</span>
</h2>
<h3>
<span id=".D0.A0.D0.B0.D0.B1.D0.BE.D1.82.D0.B0_.D1.81_Docker"></span><span class="mw-headline" id="Работа_с_Docker">Работа с Docker</span>
</h3>
<p><i>nftables</i> может создавать помехи сетевой работе контейнеров <a href="../ru/Docker.html" title="Docker (Русский)">Docker</a> (возможно, и другим средствам виртуализации тоже). В частности, политика <code>drop</code> цепочки <code>forward</code> блокирует пакеты, источником которых является docker. Если вы не хотите удалять эту цепочку, то сделайте следующее:
</p>
<ol>
<li>
<a href="../ru/Help:Reading.html#%D0%A3%D1%81%D1%82%D0%B0%D0%BD%D0%BE%D0%B2%D0%BA%D0%B0_%D0%BF%D0%B0%D0%BA%D0%B5%D1%82%D0%BE%D0%B2" class="mw-redirect" title="Установите">Установите</a> пакет <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=iptables-nft">iptables-nft</a></span>; он содержит iptables-совместимый интерфейс nftables, который docker сможет использовать.</li>
<li>Модифицируйте цепочку <code>forward</code> таблицы <code>inet</code>:
<dl><dd><pre>chain forward {
  type filter hook forward priority security; policy drop;
  mark 1 accept
}
</pre></dd></dl>
</li>
<li>Добавьте цепочку DOCKER-USER в таблицу <code>ip filter</code>, чтобы помечать (mark) пакеты docker:
<dl><dd><pre>table ip filter {
  chain DOCKER-USER {
    mark set 1
  }
}
</pre></dd></dl>
</li>
</ol>
<p>Теперь сгенерированные контейнером docker пакеты будут маркироваться и пересылаться дальше, поскольку docker уже их отфильтровал (цепочка <code>forward</code> в docker использует политику <code>drop</code>).
</p>
<h2>
<span id=".D0.A1.D0.BC.D0.BE.D1.82.D1.80.D0.B8.D1.82.D0.B5_.D1.82.D0.B0.D0.BA.D0.B6.D0.B5"></span><span class="mw-headline" id="Смотрите_также">Смотрите также</span>
</h2>
<ul>
<li>
<a rel="nofollow" class="external text" href="https://wiki.nftables.org/">netfilter nftables</a> — документация от разработчиков проекта netfilter</li>
<li>
<a href="https://wiki.debian.org/nftables" class="extiw" title="debian:nftables">debian:nftables</a> — статья на Debian-wiki</li>
<li>
<a href="https://wiki.gentoo.org/wiki/nftables" class="extiw" title="gentoo:nftables">gentoo:nftables</a> — статья на Gentoo-wiki</li>
<li>
<a rel="nofollow" class="external text" href="https://lwn.net/Articles/324251/">First release of nftables</a>  — выход nftables (2009)</li>
<li>
<a rel="nofollow" class="external text" href="https://home.regit.org/netfilter-en/nftables-quick-howto/">nftables quick howto</a> — советы и подсказки</li>
<li>
<a rel="nofollow" class="external text" href="https://lwn.net/Articles/564095/">The return of nftables</a> — обновление nftables (2013)</li>
<li>
<a rel="nofollow" class="external text" href="https://developers.redhat.com/blog/2016/10/28/what-comes-after-iptables-its-successor-of-course-nftables/">What comes after "iptables"?</a> — nftables со временем заменит iptables</li>
</ul>
</div>
</div>
<div id="catlinks" class="catlinks" data-mw="interface">
<div id="mw-normal-catlinks" class="mw-normal-catlinks">
<a href="../Special:Categories.html" title="Special:Categories">Category</a>: <ul><li><a href="../ru/Category:Firewalls.html" title="Category:Firewalls (Русский)">Firewalls (Русский)</a></li></ul>
</div>
<div id="mw-hidden-catlinks" class="mw-hidden-catlinks mw-hidden-cats-hidden">Hidden category: <ul><li><a href="../en/Category:Pages_or_sections_flagged_with_Template:Expansion.html" title="Category:Pages or sections flagged with Template:Expansion">Pages or sections flagged with Template:Expansion</a></li></ul>
</div>
</div>
	</div>
</div>

<footer id="footer" class="mw-footer" role="contentinfo" style="margin: 0">
	<ul id="footer-info">
		<li>Retrieved from "<a dir="ltr" href="https://wiki.archlinux.org/index.php?title=Nftables_(%D0%A0%D1%83%D1%81%D1%81%D0%BA%D0%B8%D0%B9)&amp;oldid=644661">https://wiki.archlinux.org/index.php?title=Nftables_(Русский)&amp;oldid=644661</a>"</li>
		<li id="footer-info-lastmod"> This page was last edited on 11 December 2020, at 13:25.</li>
		<li id="footer-info-copyright">Content is available under <a class="external" rel="nofollow" href="http://www.gnu.org/copyleft/fdl.html">GNU Free Documentation License 1.3 or later</a> unless otherwise noted.</li>
	<br>
</ul>
	<ul id="footer-places">
		<li id="footer-places-privacy"><a href="../en/ArchWiki:Privacy_policy.html" title="ArchWiki:Privacy policy">Privacy policy</a></li>
		<li id="footer-places-about"><a href="../en/ArchWiki:About.html" title="ArchWiki:About">About ArchWiki</a></li>
		<li id="footer-places-disclaimer"><a href="../en/ArchWiki:General_disclaimer.html" title="ArchWiki:General disclaimer">Disclaimers</a></li>
	</ul>
	<ul id="footer-icons" class="noprint">
		<li id="footer-copyrightico">
	</ul>
	<div style="clear: both;"></div>
</footer>



</body>
</html>
