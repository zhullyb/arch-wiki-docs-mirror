<!DOCTYPE html>
<html class="client-nojs" lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<title>VirtualBox (Русский) - ArchWiki</title>
<link rel="stylesheet" href="../ArchWikiOffline.css">
<meta name="ResourceLoaderDynamicStyles" content="">
<meta name="generator" content="MediaWiki 1.35.0">
<meta name="referrer" content="no-referrer-when-downgrade">
<meta name="robots" content="noindex,follow">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="shortcut icon" href="/favicon.ico">
<link rel="search" type="application/opensearchdescription+xml" href="/opensearch_desc.php" title="ArchWiki (en)">
<link rel="EditURI" type="application/rsd+xml" href="https://wiki.archlinux.org/api.php?action=rsd">
<link rel="license" href="http://www.gnu.org/copyleft/fdl.html">
<link rel="alternate" type="application/atom+xml" title="ArchWiki Atom feed" href="/index.php?title=Special:RecentChanges&amp;feed=atom">
</head>
<body class="mediawiki ltr sitedir-ltr mw-hide-empty-elt ns-0 ns-subject page-VirtualBox_Русский rootpage-VirtualBox_Русский skin-vector action-view skin-vector-legacy">
<div id="content" class="mw-body" role="main" style="margin: 0">
	<a id="top"></a>
	<div id="siteNotice" class="mw-body-content"></div>
	<div class="mw-indicators mw-body-content">
	</div>
	<h1 id="firstHeading" class="firstHeading" lang="en">VirtualBox (Русский)</h1>
	<div id="bodyContent" class="mw-body-content">
		<div id="siteSub" class="noprint">From ArchWiki</div>
		<div id="contentSub"></div>
		<div id="contentSub2"></div>
		
		<div id="jump-to-nav"></div>
		<a class="mw-jump-link" href="#mw-head">Jump to navigation</a>
		<a class="mw-jump-link" href="#searchInput">Jump to search</a>
		<div id="mw-content-text" lang="en" dir="ltr" class="mw-content-ltr">
<div class="warningbox">The printable version is no longer supported and may have rendering errors. Please update your browser bookmarks and please use the default browser print function instead.</div>
<div class="mw-parser-output">
<div class="archwiki-template-meta-related-articles-start">
<p>Ссылки по теме</p>
<ul>
<li><a href="/title/VirtualBox/Install_Arch_Linux_as_a_guest" title="VirtualBox/Install Arch Linux as a guest">VirtualBox/Install Arch Linux as a guest</a></li>
<li><a href="/title/Category:Hypervisors_(%D0%A0%D1%83%D1%81%D1%81%D0%BA%D0%B8%D0%B9)" title="Category:Hypervisors (Русский)">Category:Hypervisors (Русский)</a></li>
<li><a href="/title/PhpVirtualBox" title="PhpVirtualBox">PhpVirtualBox</a></li>
<li><a href="/title/RemoteBox" title="RemoteBox">RemoteBox</a></li>
<li><a href="/title/Moving_an_existing_install_into_(or_out_of)_a_virtual_machine" title="Moving an existing install into (or out of) a virtual machine">Moving an existing install into (or out of) a virtual machine</a></li>
</ul>
</div>
<p><a rel="nofollow" class="external text" href="https://www.virtualbox.org">VirtualBox</a> — <a href="https://en.wikipedia.org/wiki/ru:%D0%93%D0%B8%D0%BF%D0%B5%D1%80%D0%B2%D0%B8%D0%B7%D0%BE%D1%80" class="extiw" title="wikipedia:ru:Гипервизор">гипервизор</a>, предназначенный для запуска операционных систем в специальной среде, называемой виртуальной машиной, поверх существующей операционной системы. VirtualBox постоянно развивается и внедряет новые возможности. Взаимодействовать с виртуальными машинами можно как через графический интерфейс на базе <a href="/title/Qt_(%D0%A0%D1%83%D1%81%D1%81%D0%BA%D0%B8%D0%B9)" title="Qt (Русский)">Qt</a>, так и с помощью <a href="https://en.wikipedia.org/wiki/Headless_software" class="extiw" title="wikipedia:Headless software">headless</a>- и <a href="https://en.wikipedia.org/wiki/ru:Simple_DirectMedia_Layer" class="extiw" title="wikipedia:ru:Simple DirectMedia Layer">SDL</a>-утилит командной строки.
</p>
<p>Для некоторых гостевых ОС были разработаны <i>гостевые дополнения</i> (guest additions), которые позволяют частично совмещать функциональность хостовой и гостевой операционных систем — совместный доступ к каталогам и буферу обмена, ускорение видео и бесшовная интеграция окон.
</p>
<div id="toc" class="toc" role="navigation" aria-labelledby="mw-toc-heading">
<input type="checkbox" role="button" id="toctogglecheckbox" class="toctogglecheckbox" style="display:none"><div class="toctitle" lang="en" dir="ltr">
<h2 id="mw-toc-heading">Contents</h2>
<span class="toctogglespan"><label class="toctogglelabel" for="toctogglecheckbox"></label></span>
</div>
<ul>
<li class="toclevel-1 tocsection-1">
<a href="#%D0%A3%D1%81%D1%82%D0%B0%D0%BD%D0%BE%D0%B2%D0%BA%D0%B0"><span class="tocnumber">1</span> <span class="toctext">Установка</span></a>
<ul>
<li class="toclevel-2 tocsection-2"><a href="#%D0%A3%D1%81%D1%82%D0%B0%D0%BD%D0%BE%D0%B2%D0%BA%D0%B0_%D0%BE%D1%81%D0%BD%D0%BE%D0%B2%D0%BD%D1%8B%D1%85_%D0%BF%D0%B0%D0%BA%D0%B5%D1%82%D0%BE%D0%B2"><span class="tocnumber">1.1</span> <span class="toctext">Установка основных пакетов</span></a></li>
<li class="toclevel-2 tocsection-3"><a href="#%D0%9F%D0%BE%D0%B4%D0%BF%D0%B8%D1%81%D1%8B%D0%B2%D0%B0%D0%BD%D0%B8%D0%B5_%D0%BC%D0%BE%D0%B4%D1%83%D0%BB%D0%B5%D0%B9"><span class="tocnumber">1.2</span> <span class="toctext">Подписывание модулей</span></a></li>
<li class="toclevel-2 tocsection-4"><a href="#%D0%97%D0%B0%D0%B3%D1%80%D1%83%D0%B7%D0%BA%D0%B0_%D0%BC%D0%BE%D0%B4%D1%83%D0%BB%D0%B5%D0%B9_%D1%8F%D0%B4%D1%80%D0%B0_%D0%B4%D0%BB%D1%8F_VirtualBox"><span class="tocnumber">1.3</span> <span class="toctext">Загрузка модулей ядра для VirtualBox</span></a></li>
<li class="toclevel-2 tocsection-5"><a href="#%D0%94%D0%BE%D1%81%D1%82%D1%83%D0%BF_%D0%BA_USB-%D1%83%D1%81%D1%82%D1%80%D0%BE%D0%B9%D1%81%D1%82%D0%B2%D0%B0%D0%BC_%D1%85%D0%BE%D1%81%D1%82%D0%B0_%D0%B8%D0%B7_%D0%B3%D0%BE%D1%81%D1%82%D0%B5%D0%B2%D0%BE%D0%B9_%D0%9E%D0%A1"><span class="tocnumber">1.4</span> <span class="toctext">Доступ к USB-устройствам хоста из гостевой ОС</span></a></li>
<li class="toclevel-2 tocsection-6"><a href="#%D0%94%D0%B8%D1%81%D0%BA_%D1%81_%D0%B3%D0%BE%D1%81%D1%82%D0%B5%D0%B2%D1%8B%D0%BC%D0%B8_%D0%B4%D0%BE%D0%BF%D0%BE%D0%BB%D0%BD%D0%B5%D0%BD%D0%B8%D1%8F%D0%BC%D0%B8"><span class="tocnumber">1.5</span> <span class="toctext">Диск с гостевыми дополнениями</span></a></li>
<li class="toclevel-2 tocsection-7"><a href="#%D0%A0%D0%B0%D1%81%D1%88%D0%B8%D1%80%D0%B5%D0%BD%D0%B8%D1%8F"><span class="tocnumber">1.6</span> <span class="toctext">Расширения</span></a></li>
<li class="toclevel-2 tocsection-8"><a href="#%D0%98%D0%BD%D1%82%D0%B5%D1%80%D1%84%D0%B5%D0%B9%D1%81%D1%8B"><span class="tocnumber">1.7</span> <span class="toctext">Интерфейсы</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-9">
<a href="#%D0%9F%D0%BE%D1%88%D0%B0%D0%B3%D0%BE%D0%B2%D0%B0%D1%8F_%D1%83%D1%81%D1%82%D0%B0%D0%BD%D0%BE%D0%B2%D0%BA%D0%B0_Arch_Linux_%D0%BA%D0%B0%D0%BA_%D0%B3%D0%BE%D1%81%D1%82%D0%B5%D0%B2%D0%BE%D0%B9_%D0%9E%D0%A1"><span class="tocnumber">2</span> <span class="toctext">Пошаговая установка Arch Linux как гостевой ОС</span></a>
<ul>
<li class="toclevel-2 tocsection-10">
<a href="#%D0%A3%D1%81%D1%82%D0%B0%D0%BD%D0%BE%D0%B2%D0%BA%D0%B0_Arch_Linux_%D0%B2_%D0%B2%D0%B8%D1%80%D1%82%D1%83%D0%B0%D0%BB%D1%8C%D0%BD%D1%83%D1%8E_%D0%BC%D0%B0%D1%88%D0%B8%D0%BD%D1%83"><span class="tocnumber">2.1</span> <span class="toctext">Установка Arch Linux в виртуальную машину</span></a>
<ul>
<li class="toclevel-3 tocsection-11"><a href="#%D0%A3%D1%81%D1%82%D0%B0%D0%BD%D0%BE%D0%B2%D0%BA%D0%B0_%D0%B2_%D1%80%D0%B5%D0%B6%D0%B8%D0%BC%D0%B5_EFI"><span class="tocnumber">2.1.1</span> <span class="toctext">Установка в режиме EFI</span></a></li>
</ul>
</li>
<li class="toclevel-2 tocsection-12"><a href="#%D0%A3%D1%81%D1%82%D0%B0%D0%BD%D0%BE%D0%B2%D0%BA%D0%B0_%D0%B3%D0%BE%D1%81%D1%82%D0%B5%D0%B2%D1%8B%D1%85_%D0%B4%D0%BE%D0%BF%D0%BE%D0%BB%D0%BD%D0%B5%D0%BD%D0%B8%D0%B9"><span class="tocnumber">2.2</span> <span class="toctext">Установка гостевых дополнений</span></a></li>
<li class="toclevel-2 tocsection-13">
<a href="#%D0%A3%D1%81%D1%82%D0%B0%D0%BD%D0%BE%D0%B2%D0%BA%D0%B0_%D0%B3%D0%BE%D1%81%D1%82%D0%B5%D0%B2%D1%8B%D1%85_%D0%BC%D0%BE%D0%B4%D1%83%D0%BB%D0%B5%D0%B9_%D1%8F%D0%B4%D1%80%D0%B0_VirtualBox"><span class="tocnumber">2.3</span> <span class="toctext">Установка гостевых модулей ядра VirtualBox</span></a>
<ul>
<li class="toclevel-3 tocsection-14"><a href="#%D0%97%D0%B0%D0%BF%D1%83%D1%81%D0%BA_%D0%B3%D0%BE%D1%81%D1%82%D0%B5%D0%B2%D0%BE%D0%B9_%D0%9E%D0%A1_%D1%81_%D0%BE%D1%84%D0%B8%D1%86%D0%B8%D0%B0%D0%BB%D1%8C%D0%BD%D1%8B%D0%BC_%D1%8F%D0%B4%D1%80%D0%BE%D0%BC"><span class="tocnumber">2.3.1</span> <span class="toctext">Запуск гостевой ОС с официальным ядром</span></a></li>
<li class="toclevel-3 tocsection-15"><a href="#%D0%97%D0%B0%D0%BF%D1%83%D1%81%D0%BA_%D0%B3%D0%BE%D1%81%D1%82%D0%B5%D0%B2%D0%BE%D0%B9_%D0%9E%D0%A1_%D1%81%D0%BE_%D1%81%D1%82%D0%BE%D1%80%D0%BE%D0%BD%D0%BD%D0%B8%D0%BC_%D1%8F%D0%B4%D1%80%D0%BE%D0%BC"><span class="tocnumber">2.3.2</span> <span class="toctext">Запуск гостевой ОС со сторонним ядром</span></a></li>
</ul>
</li>
<li class="toclevel-2 tocsection-16"><a href="#%D0%97%D0%B0%D0%B3%D1%80%D1%83%D0%B7%D0%BA%D0%B0_%D0%BC%D0%BE%D0%B4%D1%83%D0%BB%D0%B5%D0%B9_%D1%8F%D0%B4%D1%80%D0%B0_VirtualBox"><span class="tocnumber">2.4</span> <span class="toctext">Загрузка модулей ядра VirtualBox</span></a></li>
<li class="toclevel-2 tocsection-17"><a href="#%D0%97%D0%B0%D0%BF%D1%83%D1%81%D0%BA_%D0%B3%D0%BE%D1%81%D1%82%D0%B5%D0%B2%D1%8B%D1%85_%D1%81%D0%B5%D1%80%D0%B2%D0%B8%D1%81%D0%BE%D0%B2_VirtualBox"><span class="tocnumber">2.5</span> <span class="toctext">Запуск гостевых сервисов VirtualBox</span></a></li>
<li class="toclevel-2 tocsection-18">
<a href="#%D0%A0%D0%B0%D1%81%D1%88%D0%B0%D1%80%D0%B8%D0%B2%D0%B0%D0%BD%D0%B8%D0%B5_%D0%B4%D0%B8%D1%80%D0%B5%D0%BA%D1%82%D0%BE%D1%80%D0%B8%D0%B9"><span class="tocnumber">2.6</span> <span class="toctext">Расшаривание директорий</span></a>
<ul>
<li class="toclevel-3 tocsection-19"><a href="#%D0%A0%D1%83%D1%87%D0%BD%D0%BE%D0%B5_%D0%BC%D0%BE%D0%BD%D1%82%D0%B8%D1%80%D0%BE%D0%B2%D0%B0%D0%BD%D0%B8%D0%B5"><span class="tocnumber">2.6.1</span> <span class="toctext">Ручное монтирование</span></a></li>
<li class="toclevel-3 tocsection-20"><a href="#%D0%90%D0%B2%D1%82%D0%BE%D0%BC%D0%BE%D0%BD%D1%82%D0%B8%D1%80%D0%BE%D0%B2%D0%B0%D0%BD%D0%B8%D0%B5"><span class="tocnumber">2.6.2</span> <span class="toctext">Автомонтирование</span></a></li>
<li class="toclevel-3 tocsection-21"><a href="#%D0%9C%D0%BE%D0%BD%D1%82%D0%B8%D1%80%D0%BE%D0%B2%D0%B0%D0%BD%D0%B8%D0%B5_%D0%BF%D1%80%D0%B8_%D0%B7%D0%B0%D0%B3%D1%80%D1%83%D0%B7%D0%BA%D0%B5"><span class="tocnumber">2.6.3</span> <span class="toctext">Монтирование при загрузке</span></a></li>
</ul>
</li>
</ul>
</li>
<li class="toclevel-1 tocsection-22">
<a href="#%D0%98%D0%BC%D0%BF%D0%BE%D1%80%D1%82/%D1%8D%D0%BA%D1%81%D0%BF%D0%BE%D1%80%D1%82_%D0%B2%D0%B8%D1%80%D1%82%D1%83%D0%B0%D0%BB%D1%8C%D0%BD%D1%8B%D1%85_%D0%BC%D0%B0%D1%88%D0%B8%D0%BD_VirtualBox_%D0%B2/%D0%B8%D0%B7_%D0%B4%D1%80%D1%83%D0%B3%D0%B8%D1%85_%D0%B3%D0%B8%D0%BF%D0%B5%D1%80%D0%B2%D0%B8%D0%B7%D0%BE%D1%80%D0%BE%D0%B2"><span class="tocnumber">3</span> <span class="toctext">Импорт/экспорт виртуальных машин VirtualBox в/из других гипервизоров</span></a>
<ul>
<li class="toclevel-2 tocsection-23"><a href="#%D0%A3%D0%B4%D0%B0%D0%BB%D0%B5%D0%BD%D0%B8%D0%B5_%D0%B4%D0%BE%D0%BF%D0%BE%D0%BB%D0%BD%D0%B5%D0%BD%D0%B8%D0%B9_%D0%B3%D0%BE%D1%81%D1%82%D0%B5%D0%B2%D0%BE%D0%B9_%D0%9E%D0%A1"><span class="tocnumber">3.1</span> <span class="toctext">Удаление дополнений гостевой ОС</span></a></li>
<li class="toclevel-2 tocsection-24">
<a href="#%D0%98%D1%81%D0%BF%D0%BE%D0%BB%D1%8C%D0%B7%D0%BE%D0%B2%D0%B0%D0%BD%D0%B8%D0%B5_%D0%BF%D1%80%D0%B0%D0%B2%D0%B8%D0%BB%D1%8C%D0%BD%D0%BE%D0%B3%D0%BE_%D1%84%D0%BE%D1%80%D0%BC%D0%B0%D1%82%D0%B0_%D0%B2%D0%B8%D1%80%D1%82%D1%83%D0%B0%D0%BB%D1%8C%D0%BD%D0%BE%D0%B3%D0%BE_%D0%B4%D0%B8%D1%81%D0%BA%D0%B0"><span class="tocnumber">3.2</span> <span class="toctext">Использование правильного формата виртуального диска</span></a>
<ul>
<li class="toclevel-3 tocsection-25"><a href="#%D0%90%D0%B2%D1%82%D0%BE%D0%BC%D0%B0%D1%82%D0%B8%D1%87%D0%B5%D1%81%D0%BA%D0%B8%D0%B5_%D0%B8%D0%BD%D1%81%D1%82%D1%80%D1%83%D0%BC%D0%B5%D0%BD%D1%82%D1%8B"><span class="tocnumber">3.2.1</span> <span class="toctext">Автоматические инструменты</span></a></li>
<li class="toclevel-3 tocsection-26"><a href="#%D0%A0%D1%83%D1%87%D0%BD%D0%BE%D0%B5_%D0%BF%D1%80%D0%B5%D0%BE%D0%B1%D1%80%D0%B0%D0%B7%D0%BE%D0%B2%D0%B0%D0%BD%D0%B8%D0%B5"><span class="tocnumber">3.2.2</span> <span class="toctext">Ручное преобразование</span></a></li>
</ul>
</li>
<li class="toclevel-2 tocsection-27"><a href="#%D0%A1%D0%BE%D0%B7%D0%B4%D0%B0%D0%BD%D0%B8%D0%B5_%D0%BA%D0%BE%D0%BD%D1%84%D0%B8%D0%B3%D1%83%D1%80%D0%B0%D1%86%D0%B8%D0%B8_VM_%D0%B4%D0%BB%D1%8F_%D0%B3%D0%B8%D0%BF%D0%B5%D1%80%D0%B2%D0%B8%D0%B7%D0%BE%D1%80%D0%B0"><span class="tocnumber">3.3</span> <span class="toctext">Создание конфигурации VM для гипервизора</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-28">
<a href="#%D0%A3%D0%BF%D1%80%D0%B0%D0%B2%D0%BB%D0%B5%D0%BD%D0%B8%D0%B5_%D0%B2%D0%B8%D1%80%D1%82%D1%83%D0%B0%D0%BB%D1%8C%D0%BD%D1%8B%D0%BC%D0%B8_%D0%B4%D0%B8%D1%81%D0%BA%D0%B0%D0%BC%D0%B8"><span class="tocnumber">4</span> <span class="toctext">Управление виртуальными дисками</span></a>
<ul>
<li class="toclevel-2 tocsection-29"><a href="#%D0%A4%D0%BE%D1%80%D0%BC%D0%B0%D1%82%D1%8B,_%D0%BF%D0%BE%D0%B4%D0%B4%D0%B5%D1%80%D0%B6%D0%B8%D0%B2%D0%B0%D0%B5%D0%BC%D1%8B%D0%B5_VirtualBox"><span class="tocnumber">4.1</span> <span class="toctext">Форматы, поддерживаемые VirtualBox</span></a></li>
<li class="toclevel-2 tocsection-30">
<a href="#%D0%9F%D1%80%D0%B5%D0%BE%D0%B1%D1%80%D0%B0%D0%B7%D0%BE%D0%B2%D0%B0%D0%BD%D0%B8%D0%B5_%D0%B2%D0%B8%D1%80%D1%82%D1%83%D0%B0%D0%BB%D1%8C%D0%BD%D1%8B%D1%85_%D0%B4%D0%B8%D1%81%D0%BA%D0%BE%D0%B2_%D1%80%D0%B0%D0%B7%D0%BD%D1%8B%D1%85_%D1%84%D0%BE%D1%80%D0%BC%D0%B0%D1%82%D0%BE%D0%B2"><span class="tocnumber">4.2</span> <span class="toctext">Преобразование виртуальных дисков разных форматов</span></a>
<ul>
<li class="toclevel-3 tocsection-31"><a href="#VMDK_%D0%B2_VDI_%D0%B8_VDI_%D0%B2_VMDK"><span class="tocnumber">4.2.1</span> <span class="toctext">VMDK в VDI и VDI в VMDK</span></a></li>
<li class="toclevel-3 tocsection-32"><a href="#VHD_%D0%B2_VDI_%D0%B8_VDI_%D0%B2_VDH"><span class="tocnumber">4.2.2</span> <span class="toctext">VHD в VDI и VDI в VDH</span></a></li>
<li class="toclevel-3 tocsection-33"><a href="#QCOW2_%D0%B2_VDI_%D0%B8_VDI_%D0%B2_QCOW2"><span class="tocnumber">4.2.3</span> <span class="toctext">QCOW2 в VDI и VDI в QCOW2</span></a></li>
</ul>
</li>
<li class="toclevel-2 tocsection-34">
<a href="#%D0%9C%D0%BE%D0%BD%D1%82%D0%B8%D1%80%D0%BE%D0%B2%D0%B0%D0%BD%D0%B8%D0%B5_%D0%B2%D0%B8%D1%80%D1%82%D1%83%D0%B0%D0%BB%D1%8C%D0%BD%D1%8B%D1%85_%D0%B4%D0%B8%D1%81%D0%BA%D0%BE%D0%B2"><span class="tocnumber">4.3</span> <span class="toctext">Монтирование виртуальных дисков</span></a>
<ul>
<li class="toclevel-3 tocsection-35"><a href="#VDI"><span class="tocnumber">4.3.1</span> <span class="toctext">VDI</span></a></li>
</ul>
</li>
<li class="toclevel-2 tocsection-36"><a href="#%D0%A1%D0%B6%D0%B0%D1%82%D0%B8%D0%B5_%D0%B2%D0%B8%D1%80%D1%82%D1%83%D0%B0%D0%BB%D1%8C%D0%BD%D1%8B%D1%85_%D0%B4%D0%B8%D1%81%D0%BA%D0%BE%D0%B2"><span class="tocnumber">4.4</span> <span class="toctext">Сжатие виртуальных дисков</span></a></li>
<li class="toclevel-2 tocsection-37"><a href="#%D0%A3%D0%B2%D0%B5%D0%BB%D0%B8%D1%87%D0%B5%D0%BD%D0%B8%D0%B5_%D1%80%D0%B0%D0%B7%D0%BC%D0%B5%D1%80%D0%B0_%D0%B2%D0%B8%D1%80%D1%82%D1%83%D0%B0%D0%BB%D1%8C%D0%BD%D1%8B%D1%85_%D0%B4%D0%B8%D1%81%D0%BA%D0%BE%D0%B2"><span class="tocnumber">4.5</span> <span class="toctext">Увеличение размера виртуальных дисков</span></a></li>
<li class="toclevel-2 tocsection-38"><a href="#%D0%97%D0%B0%D0%BC%D0%B5%D0%BD%D0%B0_%D0%B2%D0%B8%D1%80%D1%82%D1%83%D0%B0%D0%BB%D1%8C%D0%BD%D0%BE%D0%B3%D0%BE_%D0%B4%D0%B8%D1%81%D0%BA%D0%B0_%D0%B8%D0%B7_%D1%84%D0%B0%D0%B9%D0%BB%D0%B0_.vbox_%D0%B2%D1%80%D1%83%D1%87%D0%BD%D1%83%D1%8E"><span class="tocnumber">4.6</span> <span class="toctext">Замена виртуального диска из файла .vbox вручную</span></a></li>
<li class="toclevel-2 tocsection-39"><a href="#%D0%9A%D0%BB%D0%BE%D0%BD%D0%B8%D1%80%D0%BE%D0%B2%D0%B0%D0%BD%D0%B8%D0%B5_%D0%B2%D0%B8%D1%80%D1%82%D1%83%D0%B0%D0%BB%D1%8C%D0%BD%D0%BE%D0%B3%D0%BE_%D0%B4%D0%B8%D1%81%D0%BA%D0%B0_%D0%B8_%D0%BD%D0%B0%D0%B7%D0%BD%D0%B0%D1%87%D0%B5%D0%BD%D0%B8%D0%B5_%D0%B5%D0%BC%D1%83_%D0%BD%D0%BE%D0%B2%D0%BE%D0%B3%D0%BE_UUID"><span class="tocnumber">4.7</span> <span class="toctext">Клонирование виртуального диска и назначение ему нового UUID</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-40">
<a href="#%D0%A0%D0%B0%D1%81%D1%88%D0%B8%D1%80%D0%B5%D0%BD%D0%BD%D0%B0%D1%8F_%D0%BD%D0%B0%D1%81%D1%82%D1%80%D0%BE%D0%B9%D0%BA%D0%B0"><span class="tocnumber">5</span> <span class="toctext">Расширенная настройка</span></a>
<ul>
<li class="toclevel-2 tocsection-41">
<a href="#%D0%A3%D0%BF%D1%80%D0%B0%D0%B2%D0%BB%D0%B5%D0%BD%D0%B8%D0%B5_%D0%B7%D0%B0%D0%BF%D1%83%D1%81%D0%BA%D0%BE%D0%BC_%D0%B2%D0%B8%D1%80%D1%82%D1%83%D0%B0%D0%BB%D1%8C%D0%BD%D0%BE%D0%B9_%D0%BC%D0%B0%D1%88%D0%B8%D0%BD%D1%8B"><span class="tocnumber">5.1</span> <span class="toctext">Управление запуском виртуальной машины</span></a>
<ul>
<li class="toclevel-3 tocsection-42"><a href="#%D0%97%D0%B0%D0%BF%D1%83%D1%81%D0%BA_%D0%B2%D0%B8%D1%80%D1%82%D1%83%D0%B0%D0%BB%D1%8C%D0%BD%D1%8B%D0%B9_%D0%BC%D0%B0%D1%88%D0%B8%D0%BD_%D0%BA%D0%B0%D0%BA_%D1%81%D0%B5%D1%80%D0%B2%D0%B8%D1%81%D0%B0_systemd"><span class="tocnumber">5.1.1</span> <span class="toctext">Запуск виртуальный машин как сервиса systemd</span></a></li>
<li class="toclevel-3 tocsection-43"><a href="#%D0%97%D0%B0%D0%BF%D1%83%D1%81%D0%BA_%D0%B2%D0%B8%D1%80%D1%82%D1%83%D0%B0%D0%BB%D1%8C%D0%BD%D0%BE%D0%B9_%D0%BC%D0%B0%D1%88%D0%B8%D0%BD%D1%8B_%D0%BF%D0%BE_%D0%B3%D0%BE%D1%80%D1%8F%D1%87%D0%B5%D0%B9_%D0%BA%D0%BB%D0%B0%D0%B2%D0%B8%D1%88%D0%B5"><span class="tocnumber">5.1.2</span> <span class="toctext">Запуск виртуальной машины по горячей клавише</span></a></li>
</ul>
</li>
<li class="toclevel-2 tocsection-44">
<a href="#%D0%98%D1%81%D0%BF%D0%BE%D0%BB%D1%8C%D0%B7%D0%BE%D0%B2%D0%B0%D0%BD%D0%B8%D0%B5_%D0%BA%D0%BE%D0%BD%D0%BA%D1%80%D0%B5%D1%82%D0%BD%D1%8B%D1%85_%D1%83%D1%81%D1%82%D1%80%D0%BE%D0%B9%D1%81%D1%82%D0%B2_%D0%B2_%D0%B2%D0%B8%D1%80%D1%82%D1%83%D0%B0%D0%BB%D1%8C%D0%BD%D0%BE%D0%B9_%D0%BC%D0%B0%D1%88%D0%B8%D0%BD%D0%B5"><span class="tocnumber">5.2</span> <span class="toctext">Использование конкретных устройств в виртуальной машине</span></a>
<ul>
<li class="toclevel-3 tocsection-45"><a href="#%D0%98%D1%81%D0%BF%D0%BE%D0%BB%D1%8C%D0%B7%D0%BE%D0%B2%D0%B0%D0%BD%D0%B8%D0%B5_USB_%D0%B2%D0%B5%D0%B1-%D0%BA%D0%B0%D0%BC%D0%B5%D1%80%D1%8B/%D0%BC%D0%B8%D0%BA%D1%80%D0%BE%D1%84%D0%BE%D0%BD%D0%B0"><span class="tocnumber">5.2.1</span> <span class="toctext">Использование USB веб-камеры/микрофона</span></a></li>
<li class="toclevel-3 tocsection-46"><a href="#%D0%9E%D0%B1%D0%BD%D0%B0%D1%80%D1%83%D0%B6%D0%B5%D0%BD%D0%B8%D0%B5_%D0%B2%D0%B5%D0%B1-%D0%BA%D0%B0%D0%BC%D0%B5%D1%80_%D0%B8_%D0%BF%D1%80%D0%BE%D1%87%D0%B8%D1%85_USB_%D1%83%D1%81%D1%82%D1%80%D0%BE%D0%B9%D1%81%D1%82%D0%B2"><span class="tocnumber">5.2.2</span> <span class="toctext">Обнаружение веб-камер и прочих USB устройств</span></a></li>
</ul>
</li>
<li class="toclevel-2 tocsection-47"><a href="#%D0%94%D0%BE%D1%81%D1%82%D1%83%D0%BF_%D0%BA_%D0%B3%D0%BE%D1%81%D1%82%D0%B5%D0%B2%D0%BE%D0%BC%D1%83_%D1%81%D0%B5%D1%80%D0%B2%D0%B5%D1%80%D1%83"><span class="tocnumber">5.3</span> <span class="toctext">Доступ к гостевому серверу</span></a></li>
<li class="toclevel-2 tocsection-48"><a href="#D3D_%D1%83%D1%81%D0%BA%D0%BE%D1%80%D0%B5%D0%BD%D0%B8%D0%B5_%D0%B2_%D0%B3%D0%BE%D1%81%D1%82%D0%B5%D0%B2%D0%BE%D0%B9_Windows"><span class="tocnumber">5.4</span> <span class="toctext">D3D ускорение в гостевой Windows</span></a></li>
<li class="toclevel-2 tocsection-49"><a href="#VirtualBox_c_USB-%D0%BA%D0%BB%D1%8E%D1%87%D0%BE%D0%BC"><span class="tocnumber">5.5</span> <span class="toctext">VirtualBox c USB-ключом</span></a></li>
<li class="toclevel-2 tocsection-50">
<a href="#%D0%97%D0%B0%D0%BF%D1%83%D1%81%D0%BA_%D1%83%D1%81%D1%82%D0%B0%D0%BD%D0%BE%D0%B2%D0%BB%D0%B5%D0%BD%D0%BD%D0%BE%D0%B3%D0%BE_Arch_Linux_%D0%B2%D0%BD%D1%83%D1%82%D1%80%D0%B8_VirtualBox"><span class="tocnumber">5.6</span> <span class="toctext">Запуск установленного Arch Linux внутри VirtualBox</span></a>
<ul>
<li class="toclevel-3 tocsection-51"><a href="#%D0%A3%D0%B1%D0%B5%D0%B4%D0%B8%D1%82%D0%B5%D1%81%D1%8C,_%D1%87%D1%82%D0%BE_%D1%81%D0%B8%D1%81%D1%82%D0%B5%D0%BC%D0%B0_%D0%BD%D0%B0%D0%B8%D0%BC%D0%B5%D0%BD%D0%BE%D0%B2%D0%B0%D0%BD%D0%B8%D1%8F_%D1%80%D0%B0%D0%B7%D0%B4%D0%B5%D0%BB%D0%BE%D0%B2_%D0%BD%D0%B5_%D0%B8%D0%B7%D0%BC%D0%B5%D0%BD%D1%8F%D0%B5%D1%82%D1%81%D1%8F"><span class="tocnumber">5.6.1</span> <span class="toctext">Убедитесь, что система наименования разделов не изменяется</span></a></li>
<li class="toclevel-3 tocsection-52"><a href="#%D0%A3%D0%B1%D0%B5%D0%B4%D0%B8%D1%82%D0%B5%D1%81%D1%8C_%D0%B2_%D0%BA%D0%BE%D1%80%D1%80%D0%B5%D0%BA%D1%82%D0%BD%D0%BE%D1%81%D1%82%D0%B8_%D0%BE%D0%B1%D1%80%D0%B0%D0%B7%D0%B0_mkinitcpio"><span class="tocnumber">5.6.2</span> <span class="toctext">Убедитесь в корректности образа mkinitcpio</span></a></li>
<li class="toclevel-3 tocsection-53">
<a href="#%D0%A1%D0%BE%D0%B7%D0%B4%D0%B0%D0%BD%D0%B8%D0%B5_%D0%BA%D0%BE%D0%BD%D1%84%D0%B8%D0%B3%D1%83%D1%80%D0%B0%D1%86%D0%B8%D0%B8_%D0%B2%D0%B8%D1%80%D1%82%D1%83%D0%B0%D0%BB%D1%8C%D0%BD%D0%BE%D0%B9_%D0%BC%D0%B0%D1%88%D0%B8%D0%BD%D1%8B_%D0%B4%D0%BB%D1%8F_%D0%B7%D0%B0%D0%B3%D1%80%D1%83%D0%B7%D0%BA%D0%B8_%D1%81_%D1%84%D0%B8%D0%B7%D0%B8%D1%87%D0%B5%D1%81%D0%BA%D0%BE%D0%B3%D0%BE_%D0%B4%D0%B8%D1%81%D0%BA%D0%B0"><span class="tocnumber">5.6.3</span> <span class="toctext">Создание конфигурации виртуальной машины для загрузки с физического диска</span></a>
<ul>
<li class="toclevel-4 tocsection-54"><a href="#%D0%A1%D0%BE%D0%B7%D0%B4%D0%B0%D0%B9%D1%82%D0%B5_%D0%BF%D0%BE%D1%82%D0%BE%D0%BA%D0%BE%D0%B2%D1%8B%D0%B9(raw)_%D0%BE%D0%B1%D1%80%D0%B0%D0%B7_.vmdk"><span class="tocnumber">5.6.3.1</span> <span class="toctext">Создайте потоковый(raw) образ .vmdk</span></a></li>
<li class="toclevel-4 tocsection-55"><a href="#%D0%A1%D0%BE%D0%B7%D0%B4%D0%B0%D0%BD%D0%B8%D0%B5_%D1%84%D0%B0%D0%B9%D0%BB%D0%B0_%D0%BA%D0%BE%D0%BD%D1%84%D0%B8%D0%B3%D1%83%D1%80%D0%B0%D1%86%D0%B8%D0%B8_%D0%B2%D0%B8%D1%80%D1%82%D1%83%D0%B0%D0%BB%D1%8C%D0%BD%D0%BE%D0%B9_%D0%BC%D0%B0%D1%88%D0%B8%D0%BD%D1%8B"><span class="tocnumber">5.6.3.2</span> <span class="toctext">Создание файла конфигурации виртуальной машины</span></a></li>
</ul>
</li>
<li class="toclevel-3 tocsection-56"><a href="#%D0%A3%D1%81%D1%82%D0%B0%D0%BD%D0%BE%D0%B2%D0%BA%D0%B0_%D0%B4%D0%BE%D0%BF%D0%BE%D0%BB%D0%BD%D0%B5%D0%BD%D0%B8%D0%B9_%D0%B3%D0%BE%D1%81%D1%82%D0%B5%D0%B2%D0%BE%D0%B9_%D0%9E%D0%A1"><span class="tocnumber">5.6.4</span> <span class="toctext">Установка дополнений гостевой ОС</span></a></li>
</ul>
</li>
<li class="toclevel-2 tocsection-57"><a href="#%D0%A4%D0%B8%D0%B7%D0%B8%D1%87%D0%B5%D1%81%D0%BA%D0%B0%D1%8F_%D1%83%D1%81%D1%82%D0%B0%D0%BD%D0%BE%D0%B2%D0%BA%D0%B0_%D1%81%D0%B8%D1%81%D1%82%D0%B5%D0%BC%D1%8B_Arch_Linux_%D0%B8%D0%B7_VirtualBox"><span class="tocnumber">5.7</span> <span class="toctext">Физическая установка системы Arch Linux из VirtualBox</span></a></li>
<li class="toclevel-2 tocsection-58">
<a href="#%D0%9F%D0%B5%D1%80%D0%B5%D0%BC%D0%B5%D1%89%D0%B5%D0%BD%D0%B8%D0%B5_%D1%84%D0%B8%D0%B7%D0%B8%D1%87%D0%B5%D1%81%D0%BA%D0%B8_%D1%83%D1%81%D1%82%D0%B0%D0%BD%D0%BE%D0%B2%D0%BB%D0%B5%D0%BD%D0%BD%D0%BE%D0%B3%D0%BE_Windows_%D0%B2_%D0%B2%D0%B8%D1%80%D1%82%D1%83%D0%B0%D0%BB%D1%8C%D0%BD%D1%83%D1%8E_%D0%BC%D0%B0%D1%88%D0%B8%D0%BD%D1%83"><span class="tocnumber">5.8</span> <span class="toctext">Перемещение физически установленного Windows в виртуальную машину</span></a>
<ul>
<li class="toclevel-3 tocsection-59"><a href="#%D0%97%D0%B0%D0%B4%D0%B0%D1%87%D0%B8_%D0%B2_Windows"><span class="tocnumber">5.8.1</span> <span class="toctext">Задачи в Windows</span></a></li>
<li class="toclevel-3 tocsection-60"><a href="#%D0%97%D0%B0%D0%B4%D0%B0%D1%87%D0%B8_%D0%B2_GNU/Linux"><span class="tocnumber">5.8.2</span> <span class="toctext">Задачи в GNU/Linux</span></a></li>
<li class="toclevel-3 tocsection-61"><a href="#%D0%98%D1%81%D0%BF%D1%80%D0%B0%D0%B2%D0%BB%D0%B5%D0%BD%D0%B8%D0%B5_MBR_%D0%B8_%D0%B7%D0%B0%D0%B3%D1%80%D1%83%D0%B7%D1%87%D0%B8%D0%BA%D0%B0_Microsoft"><span class="tocnumber">5.8.3</span> <span class="toctext">Исправление MBR и загрузчика Microsoft</span></a></li>
<li class="toclevel-3 tocsection-62"><a href="#%D0%98%D0%B7%D0%B2%D0%B5%D1%81%D1%82%D0%BD%D1%8B%D0%B5_%D0%BE%D0%B3%D1%80%D0%B0%D0%BD%D0%B8%D1%87%D0%B5%D0%BD%D0%B8%D1%8F"><span class="tocnumber">5.8.4</span> <span class="toctext">Известные ограничения</span></a></li>
</ul>
</li>
</ul>
</li>
<li class="toclevel-1 tocsection-63">
<a href="#%D0%92%D0%BE%D0%B7%D0%BC%D0%BE%D0%B6%D0%BD%D1%8B%D0%B5_%D0%BF%D1%80%D0%BE%D0%B1%D0%BB%D0%B5%D0%BC%D1%8B"><span class="tocnumber">6</span> <span class="toctext">Возможные проблемы</span></a>
<ul>
<li class="toclevel-2 tocsection-64"><a href="#VERR_ACCESS_DENIED"><span class="tocnumber">6.1</span> <span class="toctext">VERR_ACCESS_DENIED</span></a></li>
<li class="toclevel-2 tocsection-65"><a href="#%D0%9A%D0%BB%D0%B0%D0%B2%D0%B8%D0%B0%D1%82%D1%83%D1%80%D0%B0_%D0%B8_%D0%BC%D1%8B%D1%88%D0%BA%D0%B0_%D0%B7%D0%B0%D0%B1%D0%BB%D0%BE%D0%BA%D0%B8%D1%80%D0%BE%D0%B2%D0%B0%D0%BD%D1%8B_%D0%B2%D0%B8%D1%80%D1%82%D1%83%D0%B0%D0%BB%D1%8C%D0%BD%D0%BE%D0%B9_%D0%BC%D0%B0%D1%88%D0%B8%D0%BD%D0%BE%D0%B9"><span class="tocnumber">6.2</span> <span class="toctext">Клавиатура и мышка заблокированы виртуальной машиной</span></a></li>
<li class="toclevel-2 tocsection-66"><a href="#%D0%9D%D0%B5_%D0%BC%D0%BE%D0%B3%D1%83_%D0%BE%D1%82%D0%BF%D1%80%D0%B0%D0%B2%D0%B8%D1%82%D1%8C_%D0%BA%D0%BE%D0%BC%D0%B1%D0%B8%D0%BD%D0%B0%D1%86%D0%B8%D1%8E_CTRL+ALT+Fn_%D0%B2_%D0%B2%D0%B8%D1%80%D1%82%D1%83%D0%B0%D0%BB%D1%8C%D0%BD%D1%83%D1%8E_%D0%BC%D0%B0%D1%88%D0%B8%D0%BD%D1%83"><span class="tocnumber">6.3</span> <span class="toctext">Не могу отправить комбинацию CTRL+ALT+Fn в виртуальную машину</span></a></li>
<li class="toclevel-2 tocsection-67"><a href="#%D0%98%D1%81%D0%BF%D1%80%D0%B0%D0%B2%D0%BB%D0%B5%D0%BD%D0%B8%D0%B5_%D0%BF%D1%80%D0%BE%D0%B1%D0%BB%D0%B5%D0%BC_%D0%B2_ISO-%D0%BE%D0%B1%D1%80%D0%B0%D0%B7%D0%B0%D1%85"><span class="tocnumber">6.4</span> <span class="toctext">Исправление проблем в ISO-образах</span></a></li>
<li class="toclevel-2 tocsection-68"><a href="#VirtualBox_GUI_%D0%BD%D0%B5_%D0%B2%D0%B8%D0%B4%D0%B8%D1%82_%D0%BC%D0%BE%D1%8E_%D1%82%D0%B5%D0%BC%D1%83_GTK_2x/3x"><span class="tocnumber">6.5</span> <span class="toctext">VirtualBox GUI не видит мою тему GTK 2x/3x</span></a></li>
<li class="toclevel-2 tocsection-69"><a href="#OpenBSD_%D0%BD%D0%B5_%D1%80%D0%B0%D0%B1%D0%BE%D1%82%D0%B0%D0%B5%D1%82_%D0%BF%D1%80%D0%B8_%D0%BD%D0%B5%D0%B4%D0%BE%D1%81%D1%82%D1%83%D0%BF%D0%BD%D1%8B%D1%85_%D0%B8%D0%BD%D1%81%D1%82%D1%80%D1%83%D0%BA%D1%86%D0%B8%D1%8F%D1%85_%D0%B2%D0%B8%D1%80%D1%82%D1%83%D0%B0%D0%BB%D0%B8%D0%B7%D0%B0%D1%86%D0%B8%D0%B8"><span class="tocnumber">6.6</span> <span class="toctext">OpenBSD не работает при недоступных инструкциях виртуализации</span></a></li>
<li class="toclevel-2 tocsection-70"><a href="#VBOX_E_INVALID_OBJECT_STATE_(0x80BB0007)"><span class="tocnumber">6.7</span> <span class="toctext">VBOX_E_INVALID_OBJECT_STATE (0x80BB0007)</span></a></li>
<li class="toclevel-2 tocsection-71"><a href="#%D0%9F%D0%BE%D0%B4%D1%81%D0%B8%D1%81%D1%82%D0%B5%D0%BC%D0%B0_USB_%D0%BD%D0%B5_%D1%80%D0%B0%D0%B1%D0%BE%D1%82%D0%B0%D0%B5%D1%82_%D0%B2_%D1%85%D0%BE%D1%81%D1%82-%D0%BC%D0%B0%D1%88%D0%B8%D0%BD%D0%B5_%D0%B8%D0%BB%D0%B8_%D0%B3%D0%BE%D1%81%D1%82%D0%B5%D0%B2%D0%BE%D0%B9_%D0%9E%D0%A1"><span class="tocnumber">6.8</span> <span class="toctext">Подсистема USB не работает в хост-машине или гостевой ОС</span></a></li>
<li class="toclevel-2 tocsection-72"><a href="#%D0%9E%D1%88%D0%B8%D0%B1%D0%BA%D0%B0_%D1%81%D0%BE%D0%B7%D0%B4%D0%B0%D0%BD%D0%B8%D1%8F_%D1%81%D0%B5%D1%82%D0%B5%D0%B2%D0%BE%D0%B3%D0%BE_%D0%B8%D0%BD%D1%82%D0%B5%D1%80%D1%84%D0%B5%D0%B9%D1%81%D0%B0_%22host-only%22"><span class="tocnumber">6.9</span> <span class="toctext">Ошибка создания сетевого интерфейса "host-only"</span></a></li>
<li class="toclevel-2 tocsection-73"><a href="#WinXP:_%D0%B3%D0%BB%D1%83%D0%B1%D0%B8%D0%BD%D0%B0_%D1%86%D0%B2%D0%B5%D1%82%D0%B0_%D0%BD%D0%B5_%D0%BC%D0%BE%D0%B6%D0%B5%D1%82_%D0%BF%D1%80%D0%B5%D0%B2%D1%8B%D1%88%D0%B0%D1%82%D1%8C_16_%D1%86%D0%B2%D0%B5%D1%82%D0%BE%D0%B2"><span class="tocnumber">6.10</span> <span class="toctext">WinXP: глубина цвета не может превышать 16 цветов</span></a></li>
<li class="toclevel-2 tocsection-74"><a href="#%D0%98%D1%81%D0%BF%D0%BE%D0%BB%D1%8C%D0%B7%D0%BE%D0%B2%D0%B0%D0%BD%D0%B8%D0%B5_%D0%BF%D0%BE%D1%81%D0%BB%D0%B5%D0%B4%D0%BE%D0%B2%D0%B0%D1%82%D0%B5%D0%BB%D1%8C%D0%BD%D1%8B%D1%85_%D0%BF%D0%BE%D1%80%D1%82%D0%BE%D0%B2_%D0%B2_%D0%B3%D0%BE%D1%81%D1%82%D0%B5%D0%B2%D0%BE%D0%B9_%D0%9E%D0%A1"><span class="tocnumber">6.11</span> <span class="toctext">Использование последовательных портов в гостевой ОС</span></a></li>
<li class="toclevel-2 tocsection-75"><a href="#Windows_8.x_%D0%BE%D1%88%D0%B8%D0%B1%D0%BA%D0%B0_0x000000C4"><span class="tocnumber">6.12</span> <span class="toctext">Windows 8.x ошибка 0x000000C4</span></a></li>
<li class="toclevel-2 tocsection-76"><a href="#Windows_8_VM_%D0%B2%D1%8B%D0%BB%D0%B5%D1%82%D0%B0%D0%B5%D1%82_%D0%BF%D1%80%D0%B8_%D0%B7%D0%B0%D0%B3%D1%80%D1%83%D0%B7%D0%BA%D0%B5_%D1%81_%D0%BE%D1%88%D0%B8%D0%B1%D0%BA%D0%BE%D0%B9_%22ERR_DISK_FULL%22"><span class="tocnumber">6.13</span> <span class="toctext">Windows 8 VM вылетает при загрузке с ошибкой "ERR_DISK_FULL"</span></a></li>
<li class="toclevel-2 tocsection-77"><a href="#%D0%93%D0%BE%D1%81%D1%82%D0%B5%D0%B2%D0%B0%D1%8F_%D0%9E%D0%A1_Linux_%D0%B2%D1%8B%D0%B4%D0%B0%D0%B5%D1%82_%D0%B8%D1%81%D0%BA%D0%B0%D0%B6%D1%91%D0%BD%D0%BD%D1%8B%D0%B9_%D0%B8%D0%BB%D0%B8_%D0%B7%D0%B0%D0%BF%D0%B0%D0%B7%D0%B4%D1%8B%D0%B2%D0%B0%D1%8E%D1%89%D0%B8%D0%B9_%D0%B7%D0%B2%D1%83%D0%BA"><span class="tocnumber">6.14</span> <span class="toctext">Гостевая ОС Linux  выдает искажённый или запаздывающий звук</span></a></li>
<li class="toclevel-2 tocsection-78"><a href="#%D0%93%D0%BE%D1%81%D1%82%D0%B5%D0%B2%D0%B0%D1%8F_%D0%9E%D0%A1_%D0%B7%D0%B0%D0%B2%D0%B8%D1%81%D0%B0%D0%B5%D1%82_%D0%BF%D0%BE%D1%81%D0%BB%D0%B5_%D0%B7%D0%B0%D0%BF%D1%83%D1%81%D0%BA%D0%B0_Xorg"><span class="tocnumber">6.15</span> <span class="toctext">Гостевая ОС зависает после запуска Xorg</span></a></li>
<li class="toclevel-2 tocsection-79"><a href="#%D0%98%D1%81%D1%87%D0%B5%D0%B7%D0%BD%D0%BE%D0%B2%D0%B5%D0%BD%D0%B8%D0%B5_%D0%BF%D1%83%D0%BD%D0%BA%D1%82%D0%BE%D0%B2_%D0%BC%D0%B5%D0%BD%D1%8E_%D0%B8_%D0%BE%D1%88%D0%B8%D0%B1%D0%BA%D0%B0_%22NS_ERROR_FAILURE%22"><span class="tocnumber">6.16</span> <span class="toctext">Исчезновение пунктов меню и ошибка "NS_ERROR_FAILURE"</span></a></li>
<li class="toclevel-2 tocsection-80"><a href="#%22%D0%A3%D0%BA%D0%B0%D0%B7%D0%B0%D0%BD%D0%BD%D1%8B%D0%B9_%D0%BF%D1%83%D1%82%D1%8C_%D0%BD%D0%B5_%D1%81%D1%83%D1%89%D0%B5%D1%81%D1%82%D0%B2%D1%83%D0%B5%D1%82._%D0%9F%D1%80%D0%BE%D0%B2%D0%B5%D1%80%D1%8C%D1%82%D0%B5_%D0%BF%D1%83%D1%82%D1%8C_%D0%B8_%D0%BF%D0%BE%D0%BF%D1%80%D0%BE%D0%B1%D1%83%D0%B9%D1%82%D0%B5_%D0%B5%D1%89%D0%B5_%D1%80%D0%B0%D0%B7.%22_%D0%9E%D1%88%D0%B8%D0%B1%D0%BA%D0%B0_%D0%B2_%D0%B3%D0%BE%D1%81%D1%82%D0%B5%D0%B2%D0%BE%D0%B9_%D0%9E%D0%A1_Windows"><span class="tocnumber">6.17</span> <span class="toctext">"Указанный путь не существует. Проверьте путь и попробуйте еще раз." Ошибка в гостевой ОС Windows</span></a></li>
<li class="toclevel-2 tocsection-81"><a href="#%D0%9D%D0%B5_%D1%80%D0%B0%D0%B1%D0%BE%D1%82%D0%B0%D1%8E%D1%82_64-%D0%B1%D0%B8%D1%82%D0%BD%D1%8B%D0%B5_%D0%B3%D0%BE%D1%81%D1%82%D0%B5%D0%B2%D1%8B%D0%B5_%D0%9E%D0%A1"><span class="tocnumber">6.18</span> <span class="toctext">Не работают 64-битные гостевые ОС</span></a></li>
<li class="toclevel-2 tocsection-82"><a href="#%D0%9E%D1%88%D0%B8%D0%B1%D0%BA%D0%B0_%22VT-x_is_not_available._(VERR_VMX_NO_VMX)%22_%D0%B8_%D0%BF%D1%80%D0%BE%D1%86%D0%B5%D1%81%D1%81%D0%BE%D1%80_%D0%B1%D0%B5%D0%B7_%D0%BF%D0%BE%D0%B4%D0%B4%D0%B5%D1%80%D0%B6%D0%BA%D0%B8_%D0%B2%D0%B8%D1%80%D1%82%D1%83%D0%B0%D0%BB%D0%B8%D0%B7%D0%B0%D1%86%D0%B8%D0%B8"><span class="tocnumber">6.19</span> <span class="toctext">Ошибка "VT-x is not available. (VERR_VMX_NO_VMX)" и процессор без поддержки виртуализации</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-83"><a href="#%D0%A1%D0%BC%D0%BE%D1%82%D1%80%D0%B8%D1%82%D0%B5_%D1%82%D0%B0%D0%BA%D0%B6%D0%B5"><span class="tocnumber">7</span> <span class="toctext">Смотрите также</span></a></li>
</ul>
</div>

<h2>
<span id=".D0.A3.D1.81.D1.82.D0.B0.D0.BD.D0.BE.D0.B2.D0.BA.D0.B0"></span><span class="mw-headline" id="Установка">Установка</span>
</h2>
<p>Установите VirtualBox по указаниям ниже, чтобы создавать и запускать виртуальные машины в Arch Linux.
</p>
<h3>
<span id=".D0.A3.D1.81.D1.82.D0.B0.D0.BD.D0.BE.D0.B2.D0.BA.D0.B0_.D0.BE.D1.81.D0.BD.D0.BE.D0.B2.D0.BD.D1.8B.D1.85_.D0.BF.D0.B0.D0.BA.D0.B5.D1.82.D0.BE.D0.B2"></span><span class="mw-headline" id="Установка_основных_пакетов">Установка основных пакетов</span>
</h3>
<p><a href="/title/%D0%A3%D1%81%D1%82%D0%B0%D0%BD%D0%BE%D0%B2%D0%B8%D1%82%D0%B5" class="mw-redirect" title="Установите">Установите</a> пакет <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=virtualbox">virtualbox</a></span>. Кроме того, необходимо установить host-модули:
</p>
<ul>
<li>для ядра <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=linux">linux</a></span> установите <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=virtualbox-host-modules-arch">virtualbox-host-modules-arch</a></span>.</li>
<li>для других <a href="/title/Kernel_(%D0%A0%D1%83%D1%81%D1%81%D0%BA%D0%B8%D0%B9)" title="Kernel (Русский)">ядер</a> (включая <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=linux-lts">linux-lts</a></span>) установите <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=virtualbox-host-dkms">virtualbox-host-dkms</a></span>.</li>
</ul>
<p><a href="/title/Dynamic_Kernel_Module_Support_(%D0%A0%D1%83%D1%81%D1%81%D0%BA%D0%B8%D0%B9)" title="Dynamic Kernel Module Support (Русский)">DKMS</a>-хук Pacman автоматически перекомпилирует модули <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=virtualbox-host-dkms">virtualbox-host-dkms</a></span> при каждом обновлении VirtualBox и/или ядра. При компиляции потребуются пакеты с заголовочными файлами для вашего ядра (например, <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=linux-lts-headers">linux-lts-headers</a></span> для ядра <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=linux-lts">linux-lts</a></span>) <a rel="nofollow" class="external autonumber" href="https://lists.archlinux.org/pipermail/arch-dev-public/2016-March/027808.html">[1]</a>.
</p>
<h3>
<span id=".D0.9F.D0.BE.D0.B4.D0.BF.D0.B8.D1.81.D1.8B.D0.B2.D0.B0.D0.BD.D0.B8.D0.B5_.D0.BC.D0.BE.D0.B4.D1.83.D0.BB.D0.B5.D0.B9"></span><span class="mw-headline" id="Подписывание_модулей">Подписывание модулей</span>
</h3>
<p>Если вы используете нестандартное ядро с включённой опцией <code>CONFIG_MODULE_SIG_FORCE</code>, то необходимо подписать ваши модули ключом, сгенерированным во время компиляции ядра.
</p>
<p>Перейдите в дерево каталогов вашего ядра и выполните:
</p>
<pre># for module in `ls /lib/modules/$(uname -r)/kernel/misc/{vboxdrv.ko,vboxnetadp.ko,vboxnetflt.ko}` ; do ./scripts/sign-file sha1 certs/signing_key.pem certs/signing_key.x509 $module ; done
</pre>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Примечание:</strong> Алгоритм хэширования может отличаться от указанного, но он должен быть встроен в ядро.</div>
<h3>
<span id=".D0.97.D0.B0.D0.B3.D1.80.D1.83.D0.B7.D0.BA.D0.B0_.D0.BC.D0.BE.D0.B4.D1.83.D0.BB.D0.B5.D0.B9_.D1.8F.D0.B4.D1.80.D0.B0_.D0.B4.D0.BB.D1.8F_VirtualBox"></span><span class="mw-headline" id="Загрузка_модулей_ядра_для_VirtualBox">Загрузка модулей ядра для VirtualBox</span>
</h3>
<p><span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=virtualbox-host-modules-arch">virtualbox-host-modules-arch</a></span> и <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=virtualbox-host-dkms">virtualbox-host-dkms</a></span> используют службу <code>systemd-modules-load.service</code> для загрузки необходимых VirtualBox модулей ядра при запуске системы. Если необходимо загрузить модуль сразу после установки, то либо перезагрузитесь, либо однократно загрузите его вручную. Список модулей можно найти в файлах <code>/usr/lib/modules-load.d/virtualbox-host-modules-arch.conf</code> или <code>/usr/lib/modules-load.d/virtualbox-host-dkms.conf</code>.
</p>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Примечание:</strong> Если автоматическая загрузка модулей VirtualBox при запуске системы нежелательна, замаскируйте файлы <code>/usr/lib/modules-load.d/virtualbox-host-modules-arch.conf</code> и <code>/usr/lib/modules-load.d/virtualbox-host-dkms.conf</code>, создав пустой файл (или символическую ссылку на <code>/dev/null</code>) с таким же именем в каталоге <code>/etc/modules-load.d/</code>.</div>
<p>Среди используемых VirtualBox <a href="/title/Kernel_module_(%D0%A0%D1%83%D1%81%D1%81%D0%BA%D0%B8%D0%B9)" title="Kernel module (Русский)">модулей ядра</a> обязательным является <code>vboxdrv</code>. Если он не был загружен, то запустить виртуальные машины не получится.
</p>
<p>Чтобы загрузить модуль вручную, выполните:
</p>
<pre># modprobe vboxdrv
</pre>
<p>Следующие модули необходимы в некоторых сложных конфигурациях:
</p>
<ul><li>
<code>vboxnetadp</code> и <code>vboxnetflt</code> необходимы для сетевых взаимодействий в режимах <a rel="nofollow" class="external text" href="https://www.virtualbox.org/manual/ch06.html#network_bridged">bridged</a> и <a rel="nofollow" class="external text" href="https://www.virtualbox.org/manual/ch06.html#network_hostonly">host-only</a>. Если точнее, <code>vboxnetadp</code> позволяет через настройки VirtualBox создать в хостовой системе программный сетевой интерфейс, а <code>vboxnetflt</code> даёт виртуальной машине возможность его использовать.</li></ul>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Примечание:</strong> Если модули ядра для VirtualBox были загружены, а после этого получили обновления, то необходимо перезагрузить их вручную, чтобы заработала обновлённая версия. Для этого выполните команду <code>vboxreload</code> с правами root.</div>
<h3>
<span id=".D0.94.D0.BE.D1.81.D1.82.D1.83.D0.BF_.D0.BA_USB-.D1.83.D1.81.D1.82.D1.80.D0.BE.D0.B9.D1.81.D1.82.D0.B2.D0.B0.D0.BC_.D1.85.D0.BE.D1.81.D1.82.D0.B0_.D0.B8.D0.B7_.D0.B3.D0.BE.D1.81.D1.82.D0.B5.D0.B2.D0.BE.D0.B9_.D0.9E.D0.A1"></span><span class="mw-headline" id="Доступ_к_USB-устройствам_хоста_из_гостевой_ОС">Доступ к USB-устройствам хоста из гостевой ОС</span>
</h3>
<p>Добавьте пользователя в <a href="/title/%D0%93%D1%80%D1%83%D0%BF%D0%BF%D1%8B" class="mw-redirect" title="Группы">группу</a> <code>vboxusers</code>, если необходимо предоставить ему доступ к USB-портам хоста из виртуальной машины.
</p>
<h3>
<span id=".D0.94.D0.B8.D1.81.D0.BA_.D1.81_.D0.B3.D0.BE.D1.81.D1.82.D0.B5.D0.B2.D1.8B.D0.BC.D0.B8_.D0.B4.D0.BE.D0.BF.D0.BE.D0.BB.D0.BD.D0.B5.D0.BD.D0.B8.D1.8F.D0.BC.D0.B8"></span><span class="mw-headline" id="Диск_с_гостевыми_дополнениями">Диск с гостевыми дополнениями</span>
</h3>
<p>Если в качестве гостя выступает не Arch Linux, то имеет смысл установить пакет <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=virtualbox-guest-iso">virtualbox-guest-iso</a></span>. Он работает как образ диска, с которого можно установить гостевые дополнения. Файл <i>.iso</i> будет находиться в каталоге <code>/usr/lib/virtualbox/additions/VBoxGuestAdditions.iso</code>. Зайдите в гостевую систему, вручную смонтируйте образ и запустите установщик.
</p>
<h3>
<span id=".D0.A0.D0.B0.D1.81.D1.88.D0.B8.D1.80.D0.B5.D0.BD.D0.B8.D1.8F"></span><span class="mw-headline" id="Расширения">Расширения</span>
</h3>
<p>Oracle Extension Pack предоставляет <a rel="nofollow" class="external text" href="https://www.virtualbox.org/manual/ch01.html#intro-installing">набор дополнительной функциональности</a>. Набор распространяется под несвободной лицензией <b>только для личного пользования</b>. Расширения доступны в виде пакета <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://aur.archlinux.org/packages/virtualbox-ext-oracle/">virtualbox-ext-oracle</a></span><sup><small>AUR</small></sup> в AUR или в скомпилированном виде в неофициальном репозитории <a href="/title/Unofficial_user_repositories#seblu" title="Unofficial user repositories">seblu</a>.
</p>
<p>Более "традиционный" способ — скачать расширения с сайта разработчиков и установить их либо через графический интерфейс (<i>File &gt; Preferences &gt; Extensions</i>), либо командой <code>VBoxManage extpack install &lt;.vbox-extpack&gt;</code>. Предварительно убедитесь, что у вас есть инструмент вроде <a href="/title/Polkit" title="Polkit">Polkit</a> для выдачи привилегированного доступа к VirtualBox — установка требует <a rel="nofollow" class="external text" href="https://www.virtualbox.org/ticket/8473">прав root</a>.
</p>
<h3>
<span id=".D0.98.D0.BD.D1.82.D0.B5.D1.80.D1.84.D0.B5.D0.B9.D1.81.D1.8B"></span><span class="mw-headline" id="Интерфейсы">Интерфейсы</span>
</h3>
<p>Для VirtualBox разработано три интерфейса:
</p>
<ul>
<li>стандартный графический интерфейс, команда <code>VirtualBox</code>.</li>
<li>интерфейс командной строки, команда <code>VBoxSDL</code>; создаёт окно виртуальной машины без оверлеев.</li>
<li>интерфейс командной строки без отображения окон (например, для ВМ, находящейся на сервере), команда <code>VBoxHeadless</code>. Расширение VRDP позволяет получить доступ к экрану виртеальной машины.</li>
</ul>
<p>Настройки безопасности Wayland (в частности, при использовании GDM) не пропускает ввод с клавиатуры в VirtualBox, что мешает, например, использовать в гостевой ОС комбинации клавиш. Чтобы это обойти, добавьте VirtualBox в белый список:
</p>
<pre>$ gsettings get org.gnome.mutter.wayland xwayland-grab-access-rules
$ gsettings set org.gnome.mutter.wayland xwayland-grab-access-rules "['VirtualBox Machine']"
</pre>
<p>Первая команда выведет текущий список приложений в белом списке. 'VirtualBox Machine' необходимо добавить к этому списку (вторая команда в примере выше не добавляет, а создаёт список из ровно одного элемента).
</p>
<p>Наконец, можно администрировать виртуальные машины через веб-интерфейс с помощью <a href="/title/PhpVirtualBox" title="PhpVirtualBox">phpVirtualBox</a>.
</p>
<p>Инструкции по созданиию виртуальных машин можно найти в <a rel="nofollow" class="external text" href="https://www.virtualbox.org/manual">руководстве пользователя</a>. 
</p>
<div class="archwiki-template-box archwiki-template-box-warning">
<strong>Важно:</strong> Если вы собираетесь хранить образы виртуальных дисков в файловой системе <a href="/title/Btrfs" title="Btrfs">Btrfs</a>, то перед их созданием необходимо отключить <a href="/title/Btrfs#Copy-on-Write_(CoW)" title="Btrfs">copy-on-write</a> для целевого каталога.</div>
<h2>
<span id=".D0.9F.D0.BE.D1.88.D0.B0.D0.B3.D0.BE.D0.B2.D0.B0.D1.8F_.D1.83.D1.81.D1.82.D0.B0.D0.BD.D0.BE.D0.B2.D0.BA.D0.B0_Arch_Linux_.D0.BA.D0.B0.D0.BA_.D0.B3.D0.BE.D1.81.D1.82.D0.B5.D0.B2.D0.BE.D0.B9_.D0.9E.D0.A1"></span><span class="mw-headline" id="Пошаговая_установка_Arch_Linux_как_гостевой_ОС">Пошаговая установка Arch Linux как гостевой ОС</span>
</h2>
<h3>
<span id=".D0.A3.D1.81.D1.82.D0.B0.D0.BD.D0.BE.D0.B2.D0.BA.D0.B0_Arch_Linux_.D0.B2_.D0.B2.D0.B8.D1.80.D1.82.D1.83.D0.B0.D0.BB.D1.8C.D0.BD.D1.83.D1.8E_.D0.BC.D0.B0.D1.88.D0.B8.D0.BD.D1.83"></span><span class="mw-headline" id="Установка_Arch_Linux_в_виртуальную_машину">Установка Arch Linux в виртуальную машину</span>
</h3>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Примечание:</strong> Хостам с ОС Windows, возможно, придется отключить Hyper-V для того, чтобы использовать возможности виртуализации устройств и создания 64-битных виртуальных машин в VirtualBox. Чтобы узнать, как отключить или снова включить Hyper-V, <a rel="nofollow" class="external text" href="https://superuser.com/questions/684966/switch-off-hyper-v-without-disable-functionality-in-windows-8-1">посмотрите пост на StackOverflow</a>. </div>
<p>Загрузите установочный носитель Arch через один из виртуальных дисков виртуальной машины. Затем совершите установку базовой системы Arch, как описано в <a href="/title/Installation_guide_(%D0%A0%D1%83%D1%81%D1%81%D0%BA%D0%B8%D0%B9)" title="Installation guide (Русский)">руководстве по установке</a>,  без установки графических драйверов: мы будем устанавливать драйвера, поставляемые VirtualBox на следующем этапе.
</p>
<h4>
<span id=".D0.A3.D1.81.D1.82.D0.B0.D0.BD.D0.BE.D0.B2.D0.BA.D0.B0_.D0.B2_.D1.80.D0.B5.D0.B6.D0.B8.D0.BC.D0.B5_EFI"></span><span class="mw-headline" id="Установка_в_режиме_EFI">Установка в режиме EFI</span>
</h4>
<p>Если вы хотите установить Arch Linux в режиме EFI внутри VirtualBox, в настройках виртуальной машины, перейдите в закладку <i>Настройки</i>, и установите флажок <i>Enable EFI (special OSes only)</i>. После выбора ядра из меню установочного носителя Arch Linux, установка будут висеть в течение минуты-двух, и после этого будет загружено ядро . Подождите и не прекращайте установку.
</p>
<p>При загрузке в режиме EFI, VirtualBox будет  пытаться выполнить <code>/EFI/BOOT/BOOTX64.EFI</code> из ESP. Если первый вариант не удается, VirtualBox будет пытаться выполнить сценарий оболочки EFI <code>startup.nsh</code> из корня ESP. Если вы не хотите вручную запускать загрузчик из оболочки EFI каждый раз, вы должны будете переместить свой загрузчик в этот путь по умолчанию. Не заморачивайтесь с VirtualBox Boot Manager (доступен по  <code>F2</code> при загрузке): EFI данные будут добавлены в него вручную при загрузке или <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=efibootmgr">efibootmgr</a></span> будет сохранять их после перезагрузки, <a rel="nofollow" class="external text" href="https://www.virtualbox.org/ticket/11177">но терять после закрытия виртуальной машины</a>.
</p>
<h3>
<span id=".D0.A3.D1.81.D1.82.D0.B0.D0.BD.D0.BE.D0.B2.D0.BA.D0.B0_.D0.B3.D0.BE.D1.81.D1.82.D0.B5.D0.B2.D1.8B.D1.85_.D0.B4.D0.BE.D0.BF.D0.BE.D0.BB.D0.BD.D0.B5.D0.BD.D0.B8.D0.B9"></span><span class="mw-headline" id="Установка_гостевых_дополнений">Установка гостевых дополнений</span>
</h3>
<p>После завершения установки гостевой системы, установите <a rel="nofollow" class="external text" href="https://www.virtualbox.org/manual/ch04.html">дополнения гостевой ОС</a>, которые включают драйверы и приложения, оптимизирующие гостевую операционную систему. Они могут быть установлены с помощью <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=virtualbox-guest-utils">virtualbox-guest-utils</a></span>, которая прикреплена к <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=virtualbox-guest-modules">virtualbox-guest-modules</a></span><sup>[<a href="/title/ArchWiki:Requests#Broken_package_links" class="mw-redirect" title="ArchWiki:Requests">ссылка недействительна</a>: package not found]</sup> как необходимая зависимость.
</p>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Примечание:</strong> Метод, описанный в <a rel="nofollow" class="external text" href="https://www.virtualbox.org/manual/ch04.html#idp54932560">VirtualBox руководстве</a> не работает на гостевой Arch Linux, в результате <code>Unable to determine your Linux distribution</code> несколько раз повторено, как сообщение об ошибке. Если Вы уже попробовали этот первый метод и вы используете правильное описанное выше решение впоследствии, это не удастся. Вы получите ошибку <code>/usr/bin/VBox* exists in filesystem</code> и <code>/usr/lib/VBox* exists in filesystem</code>. Решение заключается в удалении конфликтующих файлов: <code># rm /usr/bin/VBox* /usr/lib/VBox*</code> Эти файлы на самом деле являются символическими ссылками на места, где были установлены гостевые дополнения; По умолчанию, это <code>/opt/VBoxGuestAdditions-<i>номер версии</i></code>. Удалите и эти файлы <code># rm -r /opt/VBoxGuestAdditions-<i>номер версии</i></code>,так как они не нужны. Теперь вы можете перезапустить установку правильным, вышеописанным способом.</div>
<h3>
<span id=".D0.A3.D1.81.D1.82.D0.B0.D0.BD.D0.BE.D0.B2.D0.BA.D0.B0_.D0.B3.D0.BE.D1.81.D1.82.D0.B5.D0.B2.D1.8B.D1.85_.D0.BC.D0.BE.D0.B4.D1.83.D0.BB.D0.B5.D0.B9_.D1.8F.D0.B4.D1.80.D0.B0_VirtualBox"></span><span class="mw-headline" id="Установка_гостевых_модулей_ядра_VirtualBox">Установка гостевых модулей ядра VirtualBox</span>
</h3>
<h4>
<span id=".D0.97.D0.B0.D0.BF.D1.83.D1.81.D0.BA_.D0.B3.D0.BE.D1.81.D1.82.D0.B5.D0.B2.D0.BE.D0.B9_.D0.9E.D0.A1_.D1.81_.D0.BE.D1.84.D0.B8.D1.86.D0.B8.D0.B0.D0.BB.D1.8C.D0.BD.D1.8B.D0.BC_.D1.8F.D0.B4.D1.80.D0.BE.D0.BC"></span><span class="mw-headline" id="Запуск_гостевой_ОС_с_официальным_ядром">Запуск гостевой ОС с официальным ядром</span>
</h4>
<ul>
<li>Если вы используете ядро <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=linux">linux</a></span>, убедитесь, что пакет <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=virtualbox-guest-modules">virtualbox-guest-modules</a></span><sup>[<a href="/title/ArchWiki:Requests#Broken_package_links" class="mw-redirect" title="ArchWiki:Requests">ссылка недействительна</a>: package not found]</sup> установлен. <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=virtualbox-guest-modules">virtualbox-guest-modules</a></span><sup>[<a href="/title/ArchWiki:Requests#Broken_package_links" class="mw-redirect" title="ArchWiki:Requests">ссылка недействительна</a>: package not found]</sup> устанавливается как зависимость пакета <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=virtualbox-guest-utils">virtualbox-guest-utils</a></span>.</li>
<li>Если вы используете LTS ядро (<span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=linux-lts">linux-lts</a></span>), установите пакет <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://aur.archlinux.org/packages/virtualbox-guest-modules-lts/">virtualbox-guest-modules-lts</a></span><sup><small>AUR</small></sup><sup>[<a href="/title/ArchWiki:Requests#Broken_package_links" class="mw-redirect" title="ArchWiki:Requests">ссылка недействительна</a>: replaced by <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=virtualbox-guest-dkms">virtualbox-guest-dkms</a></span>]</sup>. Пакет <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=virtualbox-guest-modules">virtualbox-guest-modules</a></span><sup>[<a href="/title/ArchWiki:Requests#Broken_package_links" class="mw-redirect" title="ArchWiki:Requests">ссылка недействительна</a>: package not found]</sup> может быть удалён по вашему желанию.</li>
<li>Если вы используете ядро <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://aur.archlinux.org/packages/linux-ck/">linux-ck</a></span><sup><small>AUR</small></sup>, скомпилируйте пакет <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://aur.archlinux.org/packages/virtualbox-ck-guest-modules/">virtualbox-ck-guest-modules</a></span><sup><small>AUR</small></sup><sup>[<a href="/title/ArchWiki:Requests#Broken_package_links" class="mw-redirect" title="ArchWiki:Requests">ссылка недействительна</a>: package not found]</sup>. Пакет <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=virtualbox-guest-modules">virtualbox-guest-modules</a></span><sup>[<a href="/title/ArchWiki:Requests#Broken_package_links" class="mw-redirect" title="ArchWiki:Requests">ссылка недействительна</a>: package not found]</sup> также может быть удалён.</li>
</ul>
<h4>
<span id=".D0.97.D0.B0.D0.BF.D1.83.D1.81.D0.BA_.D0.B3.D0.BE.D1.81.D1.82.D0.B5.D0.B2.D0.BE.D0.B9_.D0.9E.D0.A1_.D1.81.D0.BE_.D1.81.D1.82.D0.BE.D1.80.D0.BE.D0.BD.D0.BD.D0.B8.D0.BC_.D1.8F.D0.B4.D1.80.D0.BE.D0.BC"></span><span class="mw-headline" id="Запуск_гостевой_ОС_со_сторонним_ядром">Запуск гостевой ОС со сторонним ядром</span>
</h4>
<p>Этот шаг установки очень похож на настройку модулей ядра в разделе Vitualbox для хоста, описанную выше. Обратитесь к <a href="#Install_the_VirtualBox_kernel_modules">этому разделу</a><sup>[<a href="/title/Help:Procedures#Fix_broken_section_links" title="Help:Procedures">ссылка недействительна</a>: раздел не найден]</sup> для получения дополнительной информации и замените все <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=virtualbox-host-modules">virtualbox-host-modules</a></span><sup>[<a href="/title/ArchWiki:Requests#Broken_package_links" class="mw-redirect" title="ArchWiki:Requests">ссылка недействительна</a>: replaced by <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=virtualbox-host-modules-arch">virtualbox-host-modules-arch</a></span>]</sup>, <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=virtualbox-host-dkms">virtualbox-host-dkms</a></span> и <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://aur.archlinux.org/packages/vboxhost-hook/">vboxhost-hook</a></span><sup><small>AUR</small></sup><sup>[<a href="/title/ArchWiki:Requests#Broken_package_links" class="mw-redirect" title="ArchWiki:Requests">ссылка недействительна</a>: package not found]</sup> на <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=virtualbox-guest-modules">virtualbox-guest-modules</a></span><sup>[<a href="/title/ArchWiki:Requests#Broken_package_links" class="mw-redirect" title="ArchWiki:Requests">ссылка недействительна</a>: package not found]</sup>, <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=virtualbox-guest-dkms">virtualbox-guest-dkms</a></span> и <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://aur.archlinux.org/packages/vboxguest-hook/">vboxguest-hook</a></span><sup><small>AUR</small></sup><sup>[<a href="/title/ArchWiki:Requests#Broken_package_links" class="mw-redirect" title="ArchWiki:Requests">ссылка недействительна</a>: package not found]</sup> соответственно.
</p>
<h3>
<span id=".D0.97.D0.B0.D0.B3.D1.80.D1.83.D0.B7.D0.BA.D0.B0_.D0.BC.D0.BE.D0.B4.D1.83.D0.BB.D0.B5.D0.B9_.D1.8F.D0.B4.D1.80.D0.B0_VirtualBox"></span><span class="mw-headline" id="Загрузка_модулей_ядра_VirtualBox">Загрузка модулей ядра VirtualBox</span>
</h3>
<p>Для загрузки модуля вручную выполните:
</p>
<pre># modprobe -a vboxguest vboxsf vboxvideo
</pre>
<p>Чтобы загрузить модуль VirtualBox во время загрузки системы, обратитесь к <a href="/title/Kernel_modules_(%D0%A0%D1%83%D1%81%D1%81%D0%BA%D0%B8%D0%B9)#%D0%90%D0%B2%D1%82%D0%BE%D0%BC%D0%B0%D1%82%D0%B8%D1%87%D0%B5%D1%81%D0%BA%D0%BE%D0%B5_%D1%83%D0%BF%D1%80%D0%B0%D0%B2%D0%BB%D0%B5%D0%BD%D0%B8%D0%B5_%D0%BC%D0%BE%D0%B4%D1%83%D0%BB%D1%8F%D0%BC%D0%B8" class="mw-redirect" title="Kernel modules (Русский)">Загрузка ядра#Автоматическое управление модулями</a> и создайте <code>*.conf</code> файл (например, <code>virtualbox.conf</code>) в директории <code>/etc/modules-load.d/</code> с следующим содержанием:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/modules-load.d/virtualbox.conf</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">vboxguest
vboxsf
vboxvideo</pre>
<p>Кроме того, команда
</p>
<pre># systemctl enable vboxservice 
</pre>
<p>включает автозагрузку модулей и синхронизацию времени хоста и гостевой ОС.
</p>
<h3>
<span id=".D0.97.D0.B0.D0.BF.D1.83.D1.81.D0.BA_.D0.B3.D0.BE.D1.81.D1.82.D0.B5.D0.B2.D1.8B.D1.85_.D1.81.D0.B5.D1.80.D0.B2.D0.B8.D1.81.D0.BE.D0.B2_VirtualBox"></span><span class="mw-headline" id="Запуск_гостевых_сервисов_VirtualBox">Запуск гостевых сервисов VirtualBox</span>
</h3>
<p>После довольно непростой установки с модулями ядра VirtualBox, необходимо обеспечить взаимодействие гостевой ОС и хоста посредством сервисов. Гостевой сервис -  на самом деле просто исполняемый файл, обращающийся к <code>VBoxClient</code>, который будет взаимодействовать с вашей X Window System.  <code>VBoxClient</code> управляет следующими функциями:
</p>
<ul>
<li>Общий буфер обмена и перетаскивания между принимающей стороной и гостевой ОС;</li>
<li>Бесшовный оконный режим;</li>
<li>Гостевой дисплей автоматически изменяется в соответствии с размером окна гостевой ОС;</li>
<li>Проверка версии VirtualBox, установленной на хосте.</li>
</ul>
<p>Все эти особенности могут быть включены независимо следующими параметрами:
 $ VBoxClient --clipboard --draganddrop --seamless --display --checkhostversion
</p>
<p>Как ссылка, <code>VBoxClient-all</code> bash скрипт позволяет использовать все эти функции. Вы должны установить <code>VBoxClient</code>, который будет автоматически загружен в качестве <a href="/title/Desktop_environment_(%D0%A0%D1%83%D1%81%D1%81%D0%BA%D0%B8%D0%B9)" title="Desktop environment (Русский)">DE</a> или <a href="/title/Window_manager_(%D0%A0%D1%83%D1%81%D1%81%D0%BA%D0%B8%D0%B9)" title="Window manager (Русский)">оконного менеджера</a> 
</p>
<p>На практике,
</p>
<ul>
<li>Если вы используете <a href="/title/Desktop_environment_(%D0%A0%D1%83%D1%81%D1%81%D0%BA%D0%B8%D0%B9)" title="Desktop environment (Русский)">DE</a>, вам просто нужно установить флажок или добавить <code>/usr/sbin/VBoxClient-all</code>} в разделе автозапуска вашей DE (DE обычно устанавливают флаг на <i>.desktop</i> файлы в <code>~/.config/autostart</code>, см. <a href="/title/Desktop_entries" title="Desktop entries">настройку автозапуска</a> для более подробной информации);</li>
<li>Если у вас нет каких-либо DE, добавьте следующую строку в начале <a href="/title/Xinitrc_(%D0%A0%D1%83%D1%81%D1%81%D0%BA%D0%B8%D0%B9)" class="mw-redirect" title="Xinitrc (Русский)">~/.xinitrc</a> перед любыми <code>exec</code> функциями:</li>
</ul>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">~/.xinitrc</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">/usr/bin/VBoxClient-all</pre>
<p>VirtualBox также может синхронизировать время между хостом и гостевой ОС. Чтобы сделать это, выполните <code>VBoxService</code> с правами суперпользователя. Чтобы установить автоматический запуск этого кода при загрузке, выполните:
</p>
<pre># systemctl enable vboxservice
</pre>
<p>Теперь у вас есть рабочая гостевая Arch Linux. Поздравляем!
</p>
<p>Если вы хотите расшарить директории между вашим компьютером и гостевым Arch Linux, читайте дальше.
</p>
<h3>
<span id=".D0.A0.D0.B0.D1.81.D1.88.D0.B0.D1.80.D0.B8.D0.B2.D0.B0.D0.BD.D0.B8.D0.B5_.D0.B4.D0.B8.D1.80.D0.B5.D0.BA.D1.82.D0.BE.D1.80.D0.B8.D0.B9"></span><span class="mw-headline" id="Расшаривание_директорий">Расшаривание директорий</span>
</h3>
<p>Общие папки управляются в хосте через настройки виртуальной машины, доступной через графический интерфейс VirtualBox, на вкладке <i>Shared Folders</i>. Там путь к директории и имя точки монтирования определены как <i>Имя папки</i> и аргументы, такие как  <i>Read-only</i>, <i>Auto-mount</i> и <i>Make permanent</i>  Эти параметры могут быть определены через утилиту <code>VBoxManage</code>. См. <a rel="nofollow" class="external text" href="https://www.virtualbox.org/manual/ch04.html#sharedfolders">для более подробной информации</a>.
</p>
<p>Независимо от того, какой метод вы будете использовать, чтобы смонтировать директорию, требуются некоторые начальные действия.
</p>
<p>Чтобы избежать проблемы <code>/sbin/mount.vboxsf: mounting failed with the error: No such device</code>, убедитесь, что модуль ядра <code>vboxsf</code> загружен правильно. Он должен быть загружен, поскольку мы включили все гостевые модули ядра ранее.
</p>
<p>Два дополнительных шага необходимы для того, чтобы точки монтирования должны быть доступны из пользователей кроме root-а:
</p>
<ul>
<li>Пакет <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=virtualbox-guest-utils">virtualbox-guest-utils</a></span> создает группу <code>vboxsf</code>;</li>
<li>Ваше имя пользователя должно быть в этой группе, используйте  команду <code>gpasswd -a $USER vboxsf</code>, чтобы добавить свое имя пользователя и запустите <code>newgrp</code>, чтобы применить изменения немедленно.</li>
</ul>
<h4>
<span id=".D0.A0.D1.83.D1.87.D0.BD.D0.BE.D0.B5_.D0.BC.D0.BE.D0.BD.D1.82.D0.B8.D1.80.D0.BE.D0.B2.D0.B0.D0.BD.D0.B8.D0.B5"></span><span class="mw-headline" id="Ручное_монтирование">Ручное монтирование</span>
</h4>
<p>Выполните следующую команду для монтирования директории в гостевой Arch Linux:
</p>
<pre># mount -t vboxsf <i>имя_расшариваемой_директории</i> <i>точка_монтирования_в_гостевой_ОС</i>
</pre>
<p>Файловая система <code>vboxsf</code> предоставляет и другие способы, просмотреть которые можно выполнив:
</p>
<pre># mount.vboxsf
</pre>
<p>Например, если пользователь не добавлен в <i>vboxsf</i> группу, мы могли бы использовать эту команду, чтобы смонтировать директорию в гостевой ОС:
</p>
<pre># mount -t vboxsf -o uid=1000,gid=1000 home /mnt/
</pre>
<p>Где <i>UID</i> и <i>GID</i> являются значениями, соответствующими пользователям, которым мы хотим дать доступ к монтированию директории. Эти значения можно узнать из вывода команды  <code>id</code>, выполненной из сессии этого пользователя.
</p>
<h4>
<span id=".D0.90.D0.B2.D1.82.D0.BE.D0.BC.D0.BE.D0.BD.D1.82.D0.B8.D1.80.D0.BE.D0.B2.D0.B0.D0.BD.D0.B8.D0.B5"></span><span class="mw-headline" id="Автомонтирование">Автомонтирование</span>
</h4>
<p>Чтобы функция автоматического монтирования заработала, вы должны включить флажок в графическом интерфейсе или использовать дополнительный  аргумент <code>--automount</code> при команде <code>VBoxManage общая_директория</code>
</p>
<p>Теперь общая директория должна появиться в <code>/media/sf_<i>имя_расшаренной_директории</i></code>.
</p>
<p>Вы можете использовать символические ссылки, если хотите иметь более удобный доступ:
</p>
<pre>$ ln -s /media/sf_<i>имя_расшаренной_директории</i> ~/<i>мои_документы</i>
</pre>
<h4>
<span id=".D0.9C.D0.BE.D0.BD.D1.82.D0.B8.D1.80.D0.BE.D0.B2.D0.B0.D0.BD.D0.B8.D0.B5_.D0.BF.D1.80.D0.B8_.D0.B7.D0.B0.D0.B3.D1.80.D1.83.D0.B7.D0.BA.D0.B5"></span><span class="mw-headline" id="Монтирование_при_загрузке">Монтирование при загрузке</span>
</h4>
<p>Вы можете монтировать директории с помощью <a href="/title/Fstab_(%D0%A0%D1%83%D1%81%D1%81%D0%BA%D0%B8%D0%B9)" title="Fstab (Русский)">fstab</a>. Во избежание проблем с systemd,  необходимо добавить в <code>/etc/fstab</code> строчку <code>comment=systemd.automount</code>. 
Таким образом, общие папки монтируются только тогда, когда доступны точки подключения, а не во время запуска. Это может избежать некоторых проблем, особенно если гостевая ОС еще не загружена, когда systemd уже начал читать fstab и монтировать разделы.
</p>
<pre>desktop   /media/desktop    vboxsf  uid=user,gid=group,rw,dmode=700,fmode=600,comment=systemd.automount 0 0
</pre>
<p>mount.vboxsf <a rel="nofollow" class="external text" href="https://www.virtualbox.org/ticket/10676%7C">может не поддерживать</a><sup>[<a href="https://en.wikipedia.org/wiki/Wikipedia:Link_rot" class="extiw" title="wikipedia:Wikipedia:Link rot">устаревшая ссылка</a> 2020-08-06]</sup> <i>nofail</i> аргумент:
</p>
<pre>desktop   /media/desktop    vboxsf  uid=user,gid=group,rw,dmode=700,fmode=600,nofail 0 0
</pre>
<h2>
<span id=".D0.98.D0.BC.D0.BF.D0.BE.D1.80.D1.82.2F.D1.8D.D0.BA.D1.81.D0.BF.D0.BE.D1.80.D1.82_.D0.B2.D0.B8.D1.80.D1.82.D1.83.D0.B0.D0.BB.D1.8C.D0.BD.D1.8B.D1.85_.D0.BC.D0.B0.D1.88.D0.B8.D0.BD_VirtualBox_.D0.B2.2F.D0.B8.D0.B7_.D0.B4.D1.80.D1.83.D0.B3.D0.B8.D1.85_.D0.B3.D0.B8.D0.BF.D0.B5.D1.80.D0.B2.D0.B8.D0.B7.D0.BE.D1.80.D0.BE.D0.B2"></span><span class="mw-headline" id="Импорт/экспорт_виртуальных_машин_VirtualBox_в/из_других_гипервизоров">Импорт/экспорт виртуальных машин VirtualBox в/из других гипервизоров</span>
</h2>
<p>Если вы планируете использовать виртуальную машину на другом гипервизоре или хотите импортировать в VirtualBox виртуальную машину, созданную в другом гипервизоре, вы можете быть заинтересованы в чтении следующих шагов.
</p>
<h3>
<span id=".D0.A3.D0.B4.D0.B0.D0.BB.D0.B5.D0.BD.D0.B8.D0.B5_.D0.B4.D0.BE.D0.BF.D0.BE.D0.BB.D0.BD.D0.B5.D0.BD.D0.B8.D0.B9_.D0.B3.D0.BE.D1.81.D1.82.D0.B5.D0.B2.D0.BE.D0.B9_.D0.9E.D0.A1"></span><span class="mw-headline" id="Удаление_дополнений_гостевой_ОС">Удаление дополнений гостевой ОС</span>
</h3>
<p>Гостевые дополнения доступны в большинстве гипервизоров: VirtualBox поставляется с гостевыми дополнениями, VMware с VMware Tools, Parallels с инструментами Parallels, и т.д. Это дополнительные компоненты, предназначенные для установки внутри виртуальной машины после гостевой операционной системы, состоящие из драйверов устройств и системных приложений, которые оптимизируют гостевую операционной системы для повышения производительности и удобства использования. <a rel="nofollow" class="external text" href="https://www.virtualbox.org/manual/ch04.html">Читать подробнее</a>.
</p>
<p>Если у вас установлены дополнения в вашей виртуальной машине - удалите их в первую очередь. Ваша гостевая ОС, особенно если это ОС из семейства Windows, может вести себя странно, аварийно или не загрузиться вообще, если вы используете специальные драйверы одного гипервизора на другом.
</p>
<h3>
<span id=".D0.98.D1.81.D0.BF.D0.BE.D0.BB.D1.8C.D0.B7.D0.BE.D0.B2.D0.B0.D0.BD.D0.B8.D0.B5_.D0.BF.D1.80.D0.B0.D0.B2.D0.B8.D0.BB.D1.8C.D0.BD.D0.BE.D0.B3.D0.BE_.D1.84.D0.BE.D1.80.D0.BC.D0.B0.D1.82.D0.B0_.D0.B2.D0.B8.D1.80.D1.82.D1.83.D0.B0.D0.BB.D1.8C.D0.BD.D0.BE.D0.B3.D0.BE_.D0.B4.D0.B8.D1.81.D0.BA.D0.B0"></span><span class="mw-headline" id="Использование_правильного_формата_виртуального_диска">Использование правильного формата виртуального диска</span>
</h3>
<p>От этого шага будет зависеть способность преобразовывать образ диска виртуальной в другие форматы - непосредственно или конвейерным методом.
</p>
<h4>
<span id=".D0.90.D0.B2.D1.82.D0.BE.D0.BC.D0.B0.D1.82.D0.B8.D1.87.D0.B5.D1.81.D0.BA.D0.B8.D0.B5_.D0.B8.D0.BD.D1.81.D1.82.D1.80.D1.83.D0.BC.D0.B5.D0.BD.D1.82.D1.8B"></span><span class="mw-headline" id="Автоматические_инструменты">Автоматические инструменты</span>
</h4>
<p>Некоторые компании предоставляют инструменты, которые предлагают возможность создания виртуальных машин с операционной системой Windows или GNU / Linux, расположенной в виртуальной машине или даже в оригинальной установке. С таким продуктом вам не нужно применять этот и следующие шаги, и можно далее не читать.
</p>
<ul>
<li>
<i><a rel="nofollow" class="external text" href="https://www.parallels.com/products/transporter">Parallels Transporter</a></i> -  не бесплатный, продукт от Parallels Inc. Это решение в основном заключается в части программного обеспечения под названием <i>агент</i>, который будет установлен в гостевой ОС, которую вы хотите импортировать / преобразовать. Затем, Parallels Transporter, <i>который работает только на OS X</i> , создаст виртуальную машину с этим <i>агентом</i>, который контактирует либо по USB или по сети Ethernet.</li>
<li>
<i><a rel="nofollow" class="external text" href="Https://www.vmware.com/products/converter/">VMware vCenter Converter</a></i> - бесплатен при регистрации на Webiste VMware, работает почти так же, как Parallels Transporter, но часть программного обеспечения, которая собирает данные для создания виртуальной машины работает только на платформе Windows.</li>
</ul>
<h4>
<span id=".D0.A0.D1.83.D1.87.D0.BD.D0.BE.D0.B5_.D0.BF.D1.80.D0.B5.D0.BE.D0.B1.D1.80.D0.B0.D0.B7.D0.BE.D0.B2.D0.B0.D0.BD.D0.B8.D0.B5"></span><span class="mw-headline" id="Ручное_преобразование">Ручное преобразование</span>
</h4>
<p>Во-первых, ознакомьтесь с  <a href="#%D0%A4%D0%BE%D1%80%D0%BC%D0%B0%D1%82%D1%8B,_%D0%BF%D0%BE%D0%B4%D0%B4%D0%B5%D1%80%D0%B6%D0%B8%D0%B2%D0%B0%D0%B5%D0%BC%D1%8B%D0%B5_VirtualBox">форматами, поддерживаемыми Virtualbox</a> и  <a href="https://en.wikipedia.org/wiki/Comparison_of_platform_virtual_machines#Image_type_compatibility" class="extiw" title="wikipedia:Comparison of platform virtual machines">форматами других гипервизоров</a>.
</p>
<ul><li>Импорт и экспорт виртуальной машины из/в формат VMware не является проблемой, если вы используете формат диска VMDK или OVF, в противном случае преобразования <a href="#VMDK_%D0%B2_VDI_%D0%B8_VDI_%D0%B2_VMDK">VMDK в VDI и VDI в VMDK</a> можно осуществить вышеописанным VMware vCenter Converter.</li></ul>
<ul><li>Импорт и экспорт из/в QEMU почти не проблема: некоторые форматы QEMU поддерживает непосредственно VirtualBox и преобразование между <a href="#QCOW2_%D0%B2_VDI_%D0%B8_VDI_%D0%B2_QCOW2">QCOW2 в VDI и VDI в QCOW2</a> по-прежнему доступны в случае необходимости.</li></ul>
<ul><li>Импорт и экспорт из/в Parallels гипервизора является трудный задачей: Parallels поддерживает только свой собственный формат жесткого диска (даже стандартные форматы и портативный формат OVF не поддерживается!).</li></ul>
<dl><dd><ul>
<li>Чтобы экспортировать виртуальную машину для Parallels, вам нужно будет использовать инструмент описанной выше  Parallels - Transporter.</li>
<li>Чтобы импортировать виртуальную машину в VirtualBox, вы должны будете использовать VMware vCenter Converter , чтобы преобразовать виртуальную машину в формат VMware в первую очередь -  а затем используйте инструмент для миграции с VMware.</li>
</ul></dd></dl>
<h3>
<span id=".D0.A1.D0.BE.D0.B7.D0.B4.D0.B0.D0.BD.D0.B8.D0.B5_.D0.BA.D0.BE.D0.BD.D1.84.D0.B8.D0.B3.D1.83.D1.80.D0.B0.D1.86.D0.B8.D0.B8_VM_.D0.B4.D0.BB.D1.8F_.D0.B3.D0.B8.D0.BF.D0.B5.D1.80.D0.B2.D0.B8.D0.B7.D0.BE.D1.80.D0.B0"></span><span class="mw-headline" id="Создание_конфигурации_VM_для_гипервизора">Создание конфигурации VM для гипервизора</span>
</h3>
<p>Каждый гипервизор имеет свой собственный файл конфигурации виртуальной машины: <code>.vbox</code> для VirtualBox, <code>.vmx</code> для VMware, <code>config.pvs</code> файл, расположенный в виртуальной машине (<code>.pvm</code> файл), и т.д. Вы можете, таким образом, создать новую виртуальную машину в новом гипервизоре и указать его конфигурацию как можно ближе относительно  начальной виртуальной машины.
</p>
<p>Обратите пристальное внимание на интерфейс прошивки (BIOS или UEFI), используемый для установки гостевой операционной системы. В то время как опция доступна выбирать между этими 2 интерфейсов на VirtualBox и на Parallels решений, на VMware, вам придется вручную добавить следующую строку в ваш <i>.vmx</i> файл.
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">ArchLinux_vm.vmx</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">firmware = "efi"</pre>
<p>Наконец, настройте ваш гипервизор, для использования существующего виртуального диска, который вы преобразовали и запустите виртуальную машину.
</p>
<div class="archwiki-template-box archwiki-template-box-tip">
<strong>Совет:</strong> 
<ul>
<li>В VirtualBox, если вы не хотите просмотривать весь графический интерфейс, чтобы найти нужное место где можно добавить новый виртуальный диск устройства, вы можете <a href="#%D0%97%D0%B0%D0%BC%D0%B5%D0%BD%D0%B0_%D0%B2%D0%B8%D1%80%D1%82%D1%83%D0%B0%D0%BB%D1%8C%D0%BD%D0%BE%D0%B3%D0%BE_%D0%B4%D0%B8%D1%81%D0%BA%D0%B0_%D0%B8%D0%B7_%D1%84%D0%B0%D0%B9%D0%BB%D0%B0_.vbox_%D0%B2%D1%80%D1%83%D1%87%D0%BD%D1%83%D1%8E">Заменить виртуальный диск вручную из файла .vbox</a>, или использовать <code>VBoxManage storageattach</code>, описанный в  <a href="#%D0%A3%D0%B2%D0%B5%D0%BB%D0%B8%D1%87%D0%B5%D0%BD%D0%B8%D0%B5_%D1%80%D0%B0%D0%B7%D0%BC%D0%B5%D1%80%D0%B0_%D0%B2%D0%B8%D1%80%D1%82%D1%83%D0%B0%D0%BB%D1%8C%D0%BD%D1%8B%D1%85_%D0%B4%D0%B8%D1%81%D0%BA%D0%BE%D0%B2">увеличении вируального диска</a> или в <a rel="nofollow" class="external text" href="https://www.virtualbox.org/manual/ch08.html#vboxmanage-storageattach">руководстве VirtualBox</a>
</li>
<li>Кроме того, в продуктах VMware, вы можете заменить местоположение текущего местоположения виртуального диска путем адаптации <i>.vmdk</i> местоположения файла в <i>.vmx</i> конфигурационном файле.</li>
</ul>
</div>
<h2>
<span id=".D0.A3.D0.BF.D1.80.D0.B0.D0.B2.D0.BB.D0.B5.D0.BD.D0.B8.D0.B5_.D0.B2.D0.B8.D1.80.D1.82.D1.83.D0.B0.D0.BB.D1.8C.D0.BD.D1.8B.D0.BC.D0.B8_.D0.B4.D0.B8.D1.81.D0.BA.D0.B0.D0.BC.D0.B8"></span><span class="mw-headline" id="Управление_виртуальными_дисками">Управление виртуальными дисками</span>
</h2>
<h3>
<span id=".D0.A4.D0.BE.D1.80.D0.BC.D0.B0.D1.82.D1.8B.2C_.D0.BF.D0.BE.D0.B4.D0.B4.D0.B5.D1.80.D0.B6.D0.B8.D0.B2.D0.B0.D0.B5.D0.BC.D1.8B.D0.B5_VirtualBox"></span><span class="mw-headline" id="Форматы,_поддерживаемые_VirtualBox">Форматы, поддерживаемые VirtualBox</span>
</h3>
<p>VirtualBox поддерживает следующие форматы виртуальных дисков:
</p>
<ul><li>VDI: Virtual Disk Image является собственным стандартои VirtualBox, используемыи по умолчанию, когда вы создаете виртуальную машину в VirtualBox.</li></ul>
<ul><li>VMDK:  изначально разработан VMware для своих продуктов.Спецификация была закрытым исходным кодом, но сейчас стало открытым форматом, который полностью поддерживается VirtualBox. Этот формат дает возможность разбивать себя на несколько файлов по 2 Гб. Эта функция особенно полезна, если вы хотите сохранить виртуальную машину на компьютерах, которые не поддерживают очень большие файлы. Другие форматы, за исключением формата HDD от Parallels, не обеспечивают такую эквивалентную функцию.</li></ul>
<ul><li>VHD: Virtual Hard Disk - формат, используемый в Microsoft в Windows Virtual PC и Hyper-V. Если вы собираетесь использовать любой из этих продуктов Microsoft, вы должны будете выбрать этот формат.</li></ul>
<dl><dd><div class="archwiki-template-box archwiki-template-box-tip">
<strong>Совет:</strong>  Начиная с Windows 7, этот формат может быть установлен непосредственно без каких-либо дополнительных приложений.</div></dd></dl>
<ul><li>VHDX (только для чтения): Это расширенная версия формата виртуального жесткого диска, разработанного Microsoft, которая была выпущена на 2012-09-04 с Hyper-V 3.0 при переходе на Windows Server 2012. Эта новая версия  имеет  повышенную производительность (лучшее расположение блоков), большие размеры блоков и поддержку журнала. VirtualBox <a rel="nofollow" class="external text" href="https://www.virtualbox.org/manual/ch15.html#idp63002176">поддерживает этот формат только для чтения</a>.</li></ul>
<ul><li>Версия 2 HDD: Формат HDD разработан Parallels Inc и используются в их гипервизоре, например Parallels Desktop для Mac. Новые версии этого формата (т.е. 3 и 4) не поддерживаются из-за отсутствия документации для этого форматф. <div class="archwiki-template-box archwiki-template-box-note">
<strong>Примечание:</strong>  Существуют  споры в отношении поддержки версии 2 формата. Официальное руководство VirtualBox <a rel="nofollow" class="external text" href="https://www.virtualbox.org/manual/ch05.html#vdidetails">сообщает, что поддерживается только 2 версия</a>, авторы Википедии утверждают,что <a href="https://en.wikipedia.org/wiki/Comparison_of_platform_virtual_machines#_Image_type_compatibility" class="extiw" title="wikipedia:Comparison of platform virtual machines">частично может работать и первая версия</a>. Приветствуется помощь, если вы можете выполнить некоторые тесты с первой версией формата HDD.</div>
</li></ul>
<ul><li>QED: Формат Enhanced Disk QEMU - старый формат для QEMU, свободный и открытый. Этот формат был разработан в 2010 году таким образом, чтобы обеспечить превосходную альтернативу qcow2 и другим форматам. Этот формат имеет полностью асинхронный ввод / вывод, хорошую целостность данных, откат файлов и разреженные файлы. Формат QED поддерживается только для совместимости с виртуальными машинами, созданными в старых версиях QEMU.</li></ul>
<ul><li>QCOW: QEMU CoW - нынешний формат для QEMU.Формат QCOW поддерживает  прозрачное сжатие на основе ZLIB и шифрование (последнее имеет недостаток, и не рекомендуется к сипользованию). QCOW доступен в двух версиях: QCOW и qcow2. Последний, как правило, заменяет первый. QCOW <a rel="nofollow" class="external text" href="https://www.virtualbox.org/manual/ch15.html#idp63002176">в настоящее время  поддерживается VirtualBox</a>. Qcow2 поставляется в двух версиях: qcow2 0.10 и qcow2 1.1 (по умолчанию используемый при создании виртуального диска с QEMU). VirtualBox не поддерживает  qcow2.</li></ul>
<ul><li>OVF: Open Virtualization Format является открытым форматом, который был разработан для обеспечения взаимодействия и распределения виртуальных машин между различными гипервизоров. VirtualBox поддерживает все версии этого формата через <a rel="nofollow" class="external text" href="https://www.virtualbox.org/manual/ch08.html#idp55423424"><code>VBoxManage</code> импорт / экспорт</a>, но с [https: //www.virtualbox.org/manual/ch14.html#KnownProblems известными ограничениями].</li></ul>
<ul><li>RAW: Это режим, когда виртуальный диск скидывается непосредственно на диск без определенного формата файл контейнера. VirtualBox поддерживает эту функцию несколькими способами: преобразование RAW диск <a rel="nofollow" class="external text" href="https://www.virtualbox.org/manual/ch08.html#idp59139136">к определенному формату</a>, или <a rel="nofollow" class="external text" href="https://www.virtualbox.org/manual/ch08.html#VBoxManage-clonevdi">клонированием диска в формате RAW</a>, или непосредственно через файл VMDK, <a rel="nofollow" class="external text" href="https://www.virtualbox.org/manual/ch09.html#idp57804112">который указывает на физический диск или просто файл</a>.</li></ul>
<h3>
<span id=".D0.9F.D1.80.D0.B5.D0.BE.D0.B1.D1.80.D0.B0.D0.B7.D0.BE.D0.B2.D0.B0.D0.BD.D0.B8.D0.B5_.D0.B2.D0.B8.D1.80.D1.82.D1.83.D0.B0.D0.BB.D1.8C.D0.BD.D1.8B.D1.85_.D0.B4.D0.B8.D1.81.D0.BA.D0.BE.D0.B2_.D1.80.D0.B0.D0.B7.D0.BD.D1.8B.D1.85_.D1.84.D0.BE.D1.80.D0.BC.D0.B0.D1.82.D0.BE.D0.B2"></span><span class="mw-headline" id="Преобразование_виртуальных_дисков_разных_форматов">Преобразование виртуальных дисков разных форматов</span>
</h3>
<h4>
<span id="VMDK_.D0.B2_VDI_.D0.B8_VDI_.D0.B2_VMDK"></span><span class="mw-headline" id="VMDK_в_VDI_и_VDI_в_VMDK">VMDK в VDI и VDI в VMDK</span>
</h4>
<p>VirtualBox может конвертировать  VDI в VMDK и обратно с использованием <a rel="nofollow" class="external text" href="https://www.virtualbox.org/manual/ch08.html#vboxmanage-clonevdi"><code>VBoxManage clonehd</code></a>.
</p>
<p>VMDK в VDI:
</p>
<pre>$ VBoxManage clonehd <i>source.vmdk</i> <i>destination.vdi</i> --format VDI
</pre>
<p>VDI в VMDK:
</p>
<pre>$ VBoxManage clonehd <i>source.vdi</i> <i>destination.vmdk</i> --format VMDK
</pre>
<h4>
<span id="VHD_.D0.B2_VDI_.D0.B8_VDI_.D0.B2_VDH"></span><span class="mw-headline" id="VHD_в_VDI_и_VDI_в_VDH">VHD в VDI и VDI в VDH</span>
</h4>
<p>VirtualBox также может конвертировать VHD в VDI и наоборот с использованием <a rel="nofollow" class="external text" href="https://www.virtualbox.org/manual/ch08.html#vboxmanage-clonevdi"><code>VBoxManage clonehd</code></a>:
</p>
<p>VHD в VDI:
</p>
<pre>$ VBoxManage clonehd <i>source.vhd</i> <i>destination.vdi</i> --format VDI
</pre>
<p>VDI в VHD:
</p>
<pre>$ VBoxManage clonehd <i>source.vdi</i> <i>destination.vhd</i> --format VHD
</pre>
<h4>
<span id="QCOW2_.D0.B2_VDI_.D0.B8_VDI_.D0.B2_QCOW2"></span><span class="mw-headline" id="QCOW2_в_VDI_и_VDI_в_QCOW2">QCOW2 в VDI и VDI в QCOW2</span>
</h4>
<p><a rel="nofollow" class="external text" href="https://www.virtualbox.org/manual/ch08.html#vboxmanage-clonevdi"><code>VBoxManage clonehd</code></a> не может конвертировать QEMU форматы и необходимо воспользоваться иными инструментами. Команда <code>qemu-img</code> из пакета <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=qemu">qemu</a></span> может  осуществлять преобразования QCOW2&lt;=&gt;VDI. </p>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Примечание:</strong> <code>qemu-img</code> также обрабатывает кучу других форматов. В соответствии выводу <code>qemu-img --help</code>, <code>qemu-img</code>  поддерживает данные форматы : "<i>vvfat vpc vmdk vhdx vdi ssh sheepdog sheepdog sheepdog raw host_cdrom host_floppy host_device file qed qcow2 qcow parallels nbd nbd nbd iscsi dmg tftp ftps ftp https http cow cloop bochs blkverify blkdebug'".</i>
</div>
<p>QCOW2 в VDI:
</p>
<pre>$ qemu-img convert -pO vdi <i>source.qcow2</i> <i>destination.vdi</i>
</pre>
<p>VDI в QCOW2:
</p>
<pre>$ qemu-img convert -pO qcow2 <i>source.vdi</i> <i>destination.qcow2</i>
</pre>
<p>Так как QCOW2 предостовляется в двух версиях (0.10 и 1.1) (см. <a href="#%D0%A4%D0%BE%D1%80%D0%BC%D0%B0%D1%82%D1%8B,_%D0%BF%D0%BE%D0%B4%D0%B4%D0%B5%D1%80%D0%B6%D0%B8%D0%B2%D0%B0%D0%B5%D0%BC%D1%8B%D0%B5_VirtualBox">форматы, поддерживаемые VirtualBox</a>. Используйте параметр <code>-o compat=</code> для выбора версии.
</p>
<pre>$ qemu-img convert -pO qcow2 <i>source.vdi</i> <i>destination.qcow2</i> -o compat=0.10
</pre>
<p>или
</p>
<pre>$ qemu-img convert -pO qcow2 <i>source.vdi</i> <i>destination.qcow2</i> -o compat=1.1
</pre>
<div class="archwiki-template-box archwiki-template-box-tip">
<strong>Совет:</strong> Параметр <code>-p</code>  отображает прогресс выполнения преобразования.</div>
<h3>
<span id=".D0.9C.D0.BE.D0.BD.D1.82.D0.B8.D1.80.D0.BE.D0.B2.D0.B0.D0.BD.D0.B8.D0.B5_.D0.B2.D0.B8.D1.80.D1.82.D1.83.D0.B0.D0.BB.D1.8C.D0.BD.D1.8B.D1.85_.D0.B4.D0.B8.D1.81.D0.BA.D0.BE.D0.B2"></span><span class="mw-headline" id="Монтирование_виртуальных_дисков">Монтирование виртуальных дисков</span>
</h3>
<h4><span class="mw-headline" id="VDI">VDI</span></h4>
<p>Монтирование образов VDI работает только с образами фиксированного размера  (т.е. статичными образами); динамические образы (динамическое выделение размера) монтируются довольно-таки не просто.
</p>
<p>Если необходимо смещение раздела (в VDI),  добавьте значение <code>offData</code> в <code>32256</code> (например, 69632 + 32256 = 101888):
</p>
<pre>$ VBoxManage internalcommands dumphdinfo &lt;storage.vdi&gt; | grep "offData"
</pre>
<p>Теперь cмонтируем:
</p>
<pre># mount -t ext4 -o rw,noatime,noexec,loop,offset=101888 &lt;storage.vdi&gt; /mntpoint/
</pre>
<p>Вы также можете использовать скрипт <a rel="nofollow" class="external text" href="https://github.com/pld-linux/VirtualBox/blob/master/mount.vdi">mount.vdi</a>, который можно использовать (и даже установить скрипт в <code>/usr/bin/</code>:
</p>
<pre># mount -t vdi -o fstype=ext4,rw,noatime,noexec <i>vdi_file_location</i> <i>/mnt/</i>
</pre>
<p>Также можно использовать  модули ядра <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=qemu">qemu</a></span> , которые выполняют эту же функцию <a rel="nofollow" class="external text" href="https://bethesignal.org/blog/2011/01/05/how-to-mount-virtualbox-vdi-image/">attrib</a>:
</p>
<pre># modprobe nbd max_part=16
# qemu-nbd -c /dev/nbd0 &lt;storage.vdi&gt;
# mount /dev/nbd0p1 /mnt/dir/
# # to unmount:
# umount /mnt/dir/
# qemu-nbd -d /dev/nbd0
</pre>
<p>Если файлы раздела не распространяются, попробуйте использовать <code>partprobe /dev/nbd0</code>. В противном случае, VDI раздел может быть отображен непосредственно в файл с помощью <code>qemu-nbd -P 1 -c /dev/nbd0 &lt;storage.vdi&gt;</code>.
</p>
<h3>
<span id=".D0.A1.D0.B6.D0.B0.D1.82.D0.B8.D0.B5_.D0.B2.D0.B8.D1.80.D1.82.D1.83.D0.B0.D0.BB.D1.8C.D0.BD.D1.8B.D1.85_.D0.B4.D0.B8.D1.81.D0.BA.D0.BE.D0.B2"></span><span class="mw-headline" id="Сжатие_виртуальных_дисков">Сжатие виртуальных дисков</span>
</h3>
<p>Сжатие работает только с файлами <code>.vdi</code> и в основном состоит из следующих действий: 
</p>
<p>Загрузите виртуальную машину и удалите все ненужное вручную или с помощью специальных средств, например <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=bleachbit">bleachbit</a></span> (<a rel="nofollow" class="external text" href="http://bleachbit.sourceforge.net/download/windows">доступна для ОС Windows</a>).
</p>
<p>Затирание свободного места нулями может быть выполнено следующими инструментами:
</p>
<ul>
<li>Если вы пользовались Bleachbit, просто установите галочку <i>System &gt; Free disk space</i> в графическом интерфейсе, выполните команду <code>bleachbit -c system.free_disk_space</code>;</li>
<li>В UNIX-based системах, выполните команду <code>dd</code> или, предпочтительно, <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://aur.archlinux.org/packages/dcfldd/">dcfldd</a></span><sup><small>AUR</small></sup> (см. <a rel="nofollow" class="external text" href="https://superuser.com/a/355322">здесь</a> информацию об отличиях):</li>
</ul>
<dl>
<dd><pre># dcfldd if=/dev/zero of=<i>/fillfile</i> bs=4M</pre></dd>
<dd>Когда <code>fillfile</code> достигает лимита раздела, вам будет выдано сообщение вида <code>1280 blocks (5120Mb) written.dcfldd:: No space left on device</code>. Это означает, что все пространство пользователя и незарезервированные блоки раздела будут затерты. Используя эту команду от суперпользователя, важно убедится в том, что все свободные блоки затерты. По умолчанию некий процент блоков ФС зарезервирован для супер-пользователя (см. вывод  <code>-m</code> аргумента при команде <code>mkfs.ext4</code> или используйте <code>tune2fs -l</code> чтобы увидеть, сколько места зарезервировано под приложения запущенные от root).</dd>
<dd>Когда вышеописанный процесс будет завершён, вы можете удалить созданный вами файл <code><i>fillfile</i></code>.</dd>
</dl>
<ul><li>В ОС Windows есть два инструмента:</li></ul>
<dl><dd>
<ul>
<li>
<code>sdelete</code> - <a rel="nofollow" class="external text" href="https://technet.microsoft.com/en-us/sysinternals/bb842062.aspx">Sysinternals Suite</a>, выполните <code>sdelete -s <i>c:</i></code> для каждого виртуального диска;</li>
<li>Для любителей PowerShell есть скрипт <a rel="nofollow" class="external text" href="http://blog.whatsupduck.net/2012/03/powershell-alternative-to-sdelete.html">PowerShell solution</a>. Его также необходимо отдельно выполнять для каждого виртуального диска.</li>
</ul>
<dl>
<dd><pre>PS&gt; ./Write-ZeroesToFreeSpace.ps1 -Root <i>c:\</i> -PercentFree 0</pre></dd>
<dd><div class="archwiki-template-box archwiki-template-box-note">
<strong>Примечание:</strong> Этот скрипт должен быть запущен в среде PowerShell от имени администратора. По дефолту скрипты не запускаются из-за ограничений политик безопасности. Необходимо установить необходимое значение параметра <code>Get-ExecutionPolicy</code> в политиках безопасности: <code>Set-ExecutionPolicy RemoteSigned</code>.</div></dd>
</dl>
</dd></dl>
<p>Перезагрузите виртуальную машину.
После выполнения задач и перезагрузки виртуальной машины рекомендуется провести проверку диска.
</p>
<ul><li>В UNIX-based системах можно использовать <code>fsck</code>;</li></ul>
<dl><dd><ul><li>В GNU/Linux системах, в том числе Arch Linux, вы можете установить проверку диска при загрузке вручную <a href="/title/Fsck#Forcing_the_check" title="Fsck">в параметрах загрузки ядра</a>;</li></ul></dd></dl>
<ul><li>В Windows системах:</li></ul>
<dl><dd><ul>
<li>
<code>chkdsk <i>c:</i> /F</code> где  <code><i>c:</i></code> заменяется на имя проверяемого диска;</li>
<li>или <code>FsckDskAll</code> <a rel="nofollow" class="external text" href="http://therightstuff.de/2009/02/14/ChkDskAll-ChkDsk-For-All-Drives.aspx">отсюда</a><sup>[<a href="https://en.wikipedia.org/wiki/Wikipedia:Link_rot" class="extiw" title="wikipedia:Wikipedia:Link rot">устаревшая ссылка</a> 2020-08-06]</sup>, который основан на <code>chkdsk</code>, но не требует перезапуска для каждого отдельного диска;</li>
</ul></dd></dl>
<p>Теперь удалите нули из <code>vdi</code> файлов с помощью <code><a rel="nofollow" class="external text" href="https://www.virtualbox.org/manual/ch08.html#vboxmanage-modifyvdi">VBoxManage modifyhd</a></code>:
</p>
<pre>$ VBoxManage modifyhd <i>your_disk.vdi</i> --compact
</pre>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Примечание:</strong> Если в вашей виртуальной машине есть снимки, вам необходимо выполнить команду для всех ваших <code>.vdi</code> файлов.</div>
<h3>
<span id=".D0.A3.D0.B2.D0.B5.D0.BB.D0.B8.D1.87.D0.B5.D0.BD.D0.B8.D0.B5_.D1.80.D0.B0.D0.B7.D0.BC.D0.B5.D1.80.D0.B0_.D0.B2.D0.B8.D1.80.D1.82.D1.83.D0.B0.D0.BB.D1.8C.D0.BD.D1.8B.D1.85_.D0.B4.D0.B8.D1.81.D0.BA.D0.BE.D0.B2"></span><span class="mw-headline" id="Увеличение_размера_виртуальных_дисков">Увеличение размера виртуальных дисков</span>
</h3>
<p>Если вы выходите за рамки пространства жесткого диска, которое выбрали при создании виртуальной машины, проблему можно решить по совету из руководства VirtualBox <a rel="nofollow" class="external text" href="https://www.virtualbox.org/manual/ch08.html#VBoxManage-modifyvdi"><code>VBoxManage modifyhd</code></a>. Эта команда работает только для динамически расширяемых дисков VDI и VHD . Если вы хотите изменить размер фиксированного виртуального диска, можете использовать нижеописанный трюк,  который работает и на виртуальной машине Windows, и в UNIX-подобных системах.
</p>
<p>Во-первых, создайте новый виртуальный диск рядом с тем, который вы хотите увеличить:
</p>
<p> $ VBoxManage createhd -filename <i> new.vdi </i> --size <i> 10000 </i>
</p>
<p>где размер указан в MiB, в этом примере 10000MiB ~ = 10GiB, <i>new.vdi</i> - имя создаваемого нового виртуального диска.
</p>
<p>Далее старый виртуальный диск должен быть клонирован в новый(это может занять длительной время):
</p>
<p> $ VBoxManage clonehd <i>old.vdi</i> <i> ew.vdi</i> --existing
</p>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Примечание:</strong> По умолчанию, эта команда использует <i>Standard</i> (что соответствует динамическому выделению) формату файла диска, и, следовательно, не будет использовать тот же формат в качестве формата исходного виртуального диска. Если ваш <i>old.vdi</i> имеет фиксированный размер, и вы хотите, чтобы новый диск был тоже фиксированным, добавьте параметр <code>--variant Fixed</code>.</div>
<p>Отключите старый диск и установите новый, обязательно заменив все выделенные курсивом аргументы на свои:
</p>
<pre>$ VBoxManage storageattach <i>VM_name</i> --storagectl <i>SATA</i> --port <i>0</i> --medium none
$ VBoxManage storageattach <i>VM_name</i> --storagectl <i>SATA</i> --port <i>0</i> --medium <i>new.vdi</i> --type hdd
</pre>
<p>Чтобы получить имя контроллера диска и номер порта, вы можете использовать команду <code>VBoxManage showvminfo <i>VM_name</i></code>. Среди вывода вы получите такой результат (то, что вы ищете выделено курсивом):
</p>
<pre>[...]
Storage Controller Name (0):            IDE
Storage Controller Type (0):            PIIX4
Storage Controller Instance Number (0): 0
Storage Controller Max Port Count (0):  2
Storage Controller Port Count (0):      2
Storage Controller Bootable (0):        on
Storage Controller Name (1):            SATA
Storage Controller Type (1):            IntelAhci
Storage Controller Instance Number (1): 0
Storage Controller Max Port Count (1):  30
Storage Controller Port Count (1):      1
Storage Controller Bootable (1):        on
IDE (1, 0): Empty
<i>SATA</i> (<i>0</i>, 0): /home/wget/IT/Virtual_machines/GNU_Linux_distributions/ArchLinux_x64_EFI/Snapshots/{6bb17af7-e8a2-4bbf-baac-fbba05ebd704}.vdi (UUID: 6bb17af7-e8a2-4bbf-baac-fbba05ebd704)
[...]</pre>
<p>Скачайте <a rel="nofollow" class="external text" href="https://gparted.org/download.php">GParted LiveCD</a> и установите его в качестве виртуального привода , загрузите вашу виртуальную машину, используйте увеличение / перемещение ваших разделов. По окончании работы отмонтируйте GParted LiveCD и перезагрузите машину.
</p>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Примечание:</strong>  На GPT дисках, увеличение размера диска приведет к созданию резервной копии заголовка GPT в месте, отличном от конца устройства. GParted попросит, чтобы исправить проблему, нажать на <i>исправить</i> два раза. На дисках MBR такой проблемы не возникнет.</div>
<p>Наконец, отключите старый виртуальный диск в VirtualBox и удалите его:
</p>
<pre>$ VBoxManage closemedium disk <i>old.vdi</i>
$ rm <i>old.vdi</i>
</pre>
<h3>
<span id=".D0.97.D0.B0.D0.BC.D0.B5.D0.BD.D0.B0_.D0.B2.D0.B8.D1.80.D1.82.D1.83.D0.B0.D0.BB.D1.8C.D0.BD.D0.BE.D0.B3.D0.BE_.D0.B4.D0.B8.D1.81.D0.BA.D0.B0_.D0.B8.D0.B7_.D1.84.D0.B0.D0.B9.D0.BB.D0.B0_.vbox_.D0.B2.D1.80.D1.83.D1.87.D0.BD.D1.83.D1.8E"></span><span class="mw-headline" id="Замена_виртуального_диска_из_файла_.vbox_вручную">Замена виртуального диска из файла .vbox вручную</span>
</h3>
<p>Если вы думаете, что редактирование простого <i>XML</i> файла более удобно, чем возня с GUI  или <code>VBoxManage</code> и вы хотите заменить (или добавить) виртуальный диск в вашей виртуальной машине, просто замените GUID, местоположение файла и формат для ваших нужд в конфигурационном файле <i>.vbox</i>, соответствующем вашей виртуальной машине:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">ArchLinux_vm.vbox</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">&lt;HardDisk uuid="<i>{670157e5-8bd4-4f7b-8b96-9ee412a712b5}</i>" location="<i>ArchLinux_vm.vdi</i>" format="<i>VDI</i>" type="Normal"/&gt;</pre>
<p>в <code>&lt;AttachedDevice&gt;</code>  (суб-тег  <code>&lt;StorageController&gt;</code>) замените старый GUID на новый.
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">ArchLinux_vm.vbox</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">&lt;AttachedDevice type="HardDisk" port="0" device="0"&gt;
  &lt;Image uuid="<i>{670157e5-8bd4-4f7b-8b96-9ee412a712b5}</i>"/&gt;
&lt;/AttachedDevice&gt;</pre>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Примечание:</strong> Если вы не знаете GUID диска который вы хотите добавить, вы можете использовать <code>VBoxManage showhdinfo <i>file</i></code>. Если раньше вы использовали <code>VBoxManage clonehd</code>, для копирования или конвертирования виртуальных дисков, он выводит GUID после завершения копирования / преобразования. Применение случайного GUID не работает, так как каждый <a rel="nofollow" class="external text" href="https://www.virtualbox.org/manual/ch05.html#cloningvdis">UUID хранится внутри любого образа диска</a>.</div>
<h3>
<span id=".D0.9A.D0.BB.D0.BE.D0.BD.D0.B8.D1.80.D0.BE.D0.B2.D0.B0.D0.BD.D0.B8.D0.B5_.D0.B2.D0.B8.D1.80.D1.82.D1.83.D0.B0.D0.BB.D1.8C.D0.BD.D0.BE.D0.B3.D0.BE_.D0.B4.D0.B8.D1.81.D0.BA.D0.B0_.D0.B8_.D0.BD.D0.B0.D0.B7.D0.BD.D0.B0.D1.87.D0.B5.D0.BD.D0.B8.D0.B5_.D0.B5.D0.BC.D1.83_.D0.BD.D0.BE.D0.B2.D0.BE.D0.B3.D0.BE_UUID"></span><span class="mw-headline" id="Клонирование_виртуального_диска_и_назначение_ему_нового_UUID">Клонирование виртуального диска и назначение ему нового UUID</span>
</h3>
<p>UUID широко используются VirtualBox. Каждая виртуальная машина и каждый виртуальный диск виртуальной машины должны иметь разные UUID. Когда вы запускаете виртуальную машину в VirtualBox, он будет отслеживать все UUID. См <a rel="nofollow" class="external text" href="https://www.virtualbox.org/manual/ch08.html#vboxmanage-list"><code>VBoxManage list</code></a>, чтобы просмотреть список элементов, зарегистрированных в VirtualBox.
</p>
<p>Если вы клонировали виртуальный диск вручную путем копирования файла виртуального диска, необходимо будет назначить новый UUID клонированному виртуальному диску.  Вы можете использовать этот диск в той же виртуальной машине или даже в другой (если он уже открыт и таким образом зарегистрирован в VirtualBox).
</p>
<p>Вы можете использовать эту команду, чтобы назначить новый UUID для вашего виртуального диска:
</p>
<pre>$ VBoxManage internalcommands sethduuid <i>/path/to/disk.vdi</i>
</pre>
<div class="archwiki-template-box archwiki-template-box-tip">
<strong>Совет:</strong> В будущем, чтобы избежать копирования виртуального диска и назначения нового UUID вручную, используйте  <code><a rel="nofollow" class="external text" href="https://www.virtualbox.org/manual/ch08.html#vboxmanage-clonevdi">VBoxManage clonehd</a></code>.</div>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Примечание:</strong>  Все указанные команды поддерживают <a href="#%D0%A4%D0%BE%D1%80%D0%BC%D0%B0%D1%82%D1%8B,_%D0%BF%D0%BE%D0%B4%D0%B4%D0%B5%D1%80%D0%B6%D0%B8%D0%B2%D0%B0%D0%B5%D0%BC%D1%8B%D0%B5_VirtualBox">все форматы виртуальных дисков, поддерживаемые VirtualBox</a>.</div>
<h2>
<span id=".D0.A0.D0.B0.D1.81.D1.88.D0.B8.D1.80.D0.B5.D0.BD.D0.BD.D0.B0.D1.8F_.D0.BD.D0.B0.D1.81.D1.82.D1.80.D0.BE.D0.B9.D0.BA.D0.B0"></span><span class="mw-headline" id="Расширенная_настройка">Расширенная настройка</span>
</h2>
<h3>
<span id=".D0.A3.D0.BF.D1.80.D0.B0.D0.B2.D0.BB.D0.B5.D0.BD.D0.B8.D0.B5_.D0.B7.D0.B0.D0.BF.D1.83.D1.81.D0.BA.D0.BE.D0.BC_.D0.B2.D0.B8.D1.80.D1.82.D1.83.D0.B0.D0.BB.D1.8C.D0.BD.D0.BE.D0.B9_.D0.BC.D0.B0.D1.88.D0.B8.D0.BD.D1.8B"></span><span class="mw-headline" id="Управление_запуском_виртуальной_машины">Управление запуском виртуальной машины</span>
</h3>
<h4>
<span id=".D0.97.D0.B0.D0.BF.D1.83.D1.81.D0.BA_.D0.B2.D0.B8.D1.80.D1.82.D1.83.D0.B0.D0.BB.D1.8C.D0.BD.D1.8B.D0.B9_.D0.BC.D0.B0.D1.88.D0.B8.D0.BD_.D0.BA.D0.B0.D0.BA_.D1.81.D0.B5.D1.80.D0.B2.D0.B8.D1.81.D0.B0_systemd"></span><span class="mw-headline" id="Запуск_виртуальный_машин_как_сервиса_systemd">Запуск виртуальный машин как сервиса systemd</span>
</h4>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/systemd/system/vboxvmservice@.service</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">[Unit]
Description=VBox Virtual Machine %i Service
Requires=systemd-modules-load.service
After=systemd-modules-load.service

[Service]
User=<i>username</i>
Group=vboxusers
ExecStart=/usr/bin/VBoxHeadless -s %i
ExecStop=/usr/bin/VBoxManage controlvm %i savestate

[Install]
WantedBy=multi-user.target</pre>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Примечание:</strong> Замените <code><i>username</i></code> на имя вашего пользователя и добавьте его в группу <code>vboxusers</code>. Убедитесь, что это именно тот пользователь, который управляет созданием VM. Иначе ничего не получится</div>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Примечание:</strong> Если у вас есть несколько машин запускаемых <code>Systemd</code>, и они завершаются некорректно, попробуйте добавить <code>RemainAfterExit=true</code> и <code>KillMode=none</code> в конец <code>[Service]</code> секции.</div>
<p>Для запуска VM начиная с следующей загрузки, выполните:
</p>
<pre># systemctl enable vboxvmservice@<i>your_virtual_machine_name</i>
</pre>
<p>Для запуска же в текущий момент времени выполните:
</p>
<pre># systemctl start vboxvmservice@<i>your_virtual_machine_name</i>
</pre>
<p>VirtualBox 4.2 <a rel="nofollow" class="external text" href="http://lifeofageekadmin.com/how-to-set-your-virtualbox-vm-to-automatically-startup/">предоставляет</a> для UNIX-like систем также другие способы автозапуска, без использования сервисов systemd.
</p>
<h4>
<span id=".D0.97.D0.B0.D0.BF.D1.83.D1.81.D0.BA_.D0.B2.D0.B8.D1.80.D1.82.D1.83.D0.B0.D0.BB.D1.8C.D0.BD.D0.BE.D0.B9_.D0.BC.D0.B0.D1.88.D0.B8.D0.BD.D1.8B_.D0.BF.D0.BE_.D0.B3.D0.BE.D1.80.D1.8F.D1.87.D0.B5.D0.B9_.D0.BA.D0.BB.D0.B0.D0.B2.D0.B8.D1.88.D0.B5"></span><span class="mw-headline" id="Запуск_виртуальной_машины_по_горячей_клавише">Запуск виртуальной машины по горячей клавише</span>
</h4>
<p>Может быть полезно запускать виртуальные машины непосредственно с клавиатуры вместо использования интерфейса VirtualBox (GUI или CLI). Для этого, вы можете просто определить ключевые привязки в <code>.xbindkeysrc</code>. Обратитесь к <a href="/title/Xbindkeys_(%D0%A0%D1%83%D1%81%D1%81%D0%BA%D0%B8%D0%B9)" title="Xbindkeys (Русский)">Xbindkeys</a> для более подробной информации.
</p>
<p>Например, запуск по <code>Fn+F3</code>:
</p>
<pre>"VBoxManage startvm 'Windows 7'"
m:0x0 + c:244
XF86Battery
</pre>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Примечание:</strong> Если у вас есть пробел в имени виртуальной машины, то заключите его в одинарные апострофы как сделано в вышеуказанном примере.</div>
<h3>
<span id=".D0.98.D1.81.D0.BF.D0.BE.D0.BB.D1.8C.D0.B7.D0.BE.D0.B2.D0.B0.D0.BD.D0.B8.D0.B5_.D0.BA.D0.BE.D0.BD.D0.BA.D1.80.D0.B5.D1.82.D0.BD.D1.8B.D1.85_.D1.83.D1.81.D1.82.D1.80.D0.BE.D0.B9.D1.81.D1.82.D0.B2_.D0.B2_.D0.B2.D0.B8.D1.80.D1.82.D1.83.D0.B0.D0.BB.D1.8C.D0.BD.D0.BE.D0.B9_.D0.BC.D0.B0.D1.88.D0.B8.D0.BD.D0.B5"></span><span class="mw-headline" id="Использование_конкретных_устройств_в_виртуальной_машине">Использование конкретных устройств в виртуальной машине</span>
</h3>
<h4>
<span id=".D0.98.D1.81.D0.BF.D0.BE.D0.BB.D1.8C.D0.B7.D0.BE.D0.B2.D0.B0.D0.BD.D0.B8.D0.B5_USB_.D0.B2.D0.B5.D0.B1-.D0.BA.D0.B0.D0.BC.D0.B5.D1.80.D1.8B.2F.D0.BC.D0.B8.D0.BA.D1.80.D0.BE.D1.84.D0.BE.D0.BD.D0.B0"></span><span class="mw-headline" id="Использование_USB_веб-камеры/микрофона">Использование USB веб-камеры/микрофона</span>
</h4>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Примечание:</strong> Вам понадобятся установленные гостевые дополнения, прежде чем следовать приведенному ниже примеру. См. <a href="#%D0%9E%D0%B1%D1%80%D0%B0%D0%B7_%D0%B4%D0%B8%D1%81%D0%BA%D0%B0_%D1%81_%D0%B3%D0%BE%D1%81%D1%82%D0%B5%D0%B2%D1%8B%D0%BC%D0%B8_%D0%B4%D0%BE%D0%BF%D0%BE%D0%BB%D0%BD%D0%B5%D0%BD%D0%B8%D1%8F%D0%BC%D0%B8">Дополнения гостевой ОС</a><sup>[<a href="/title/Help:Procedures#Fix_broken_section_links" title="Help:Procedures">ссылка недействительна</a>: раздел не найден]</sup> для более подробной информации.</div>
<ol>
<li>Убедитесь, что виртуальная машина не работает, а веб-камера / микрофон не используется.</li>
<li>Вызовите главное окно VirtualBox и перейдите к настройкам для Arch машины. Перейдите в раздел USB.</li>
<li>Убедитесь, что стоит галочка "Включить USB-контроллер". Также убедитесь, что выбран пункт "Разрешить USB 2.0 (EHCI) контроллер"</li>
<li>Нажмите кнопку "Добавить фильтр с устройства" (кабельное со значком «+»).</li>
<li>Выберите USB веб-камеру/микрофон из списка.</li>
<li>Нажмите кнопку ОК и запустите VM.</li>
</ol>
<h4>
<span id=".D0.9E.D0.B1.D0.BD.D0.B0.D1.80.D1.83.D0.B6.D0.B5.D0.BD.D0.B8.D0.B5_.D0.B2.D0.B5.D0.B1-.D0.BA.D0.B0.D0.BC.D0.B5.D1.80_.D0.B8_.D0.BF.D1.80.D0.BE.D1.87.D0.B8.D1.85_USB_.D1.83.D1.81.D1.82.D1.80.D0.BE.D0.B9.D1.81.D1.82.D0.B2"></span><span class="mw-headline" id="Обнаружение_веб-камер_и_прочих_USB_устройств">Обнаружение веб-камер и прочих USB устройств</span>
</h4>
<p>Убедитесь, что вы фильтруете любые устройства, (кроме клавиатур или мышей), чтобы они не запускались при загрузке -это гарантирует, что ОС Windows обнаружит устройство при запуске.
</p>
<h3>
<span id=".D0.94.D0.BE.D1.81.D1.82.D1.83.D0.BF_.D0.BA_.D0.B3.D0.BE.D1.81.D1.82.D0.B5.D0.B2.D0.BE.D0.BC.D1.83_.D1.81.D0.B5.D1.80.D0.B2.D0.B5.D1.80.D1.83"></span><span class="mw-headline" id="Доступ_к_гостевому_серверу">Доступ к гостевому серверу</span>
</h3>
<p>Для доступа к <a href="https://en.wikipedia.org/wiki/Apache_HTTP_Server" class="extiw" title="wikipedia:Apache HTTP Server">Apache серверу</a> в виртуальной машине только с хост-машины, выполните:
</p>
<pre>$ VBoxManage setextradata GuestName "VBoxInternal/Devices/<i>pcnet</i>/0/LUN#0/Config/Apache/HostPort" <i>8888</i>
$ VBoxManage setextradata GuestName "VBoxInternal/Devices/<i>pcnet</i>/0/LUN#0/Config/Apache/GuestPort" <i>80</i>
$ VBoxManage setextradata GuestName "VBoxInternal/Devices/<i>pcnet</i>/0/LUN#0/Config/Apache/Protocol" TCP
</pre>
<p>Where 8888 is the port the host should listen on and 80 is the port the VM will send Apache's signal on.
Где 8888 порт должна слушать хост-система, а VM шлет сигнал Apache на 80 порт.
</p>
<p>Чтобы использовать порт ниже, чем 1024 на хост-машине, изменения должны быть внесены в брандмауэр на этом хосте. Он также может быть настроен на работу с SSH или иных услуг путем изменения «Apache» с соответствующими сервисами и портами.
</p>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Примечание:</strong> <code>pcnet</code> относится к сетевой карте виртуальной машины. Если вы используете карту Intel в VM, необходимо изменить <code>pcnet</code> на <code>e1000</code>.</div>
<h3>
<span id="D3D_.D1.83.D1.81.D0.BA.D0.BE.D1.80.D0.B5.D0.BD.D0.B8.D0.B5_.D0.B2_.D0.B3.D0.BE.D1.81.D1.82.D0.B5.D0.B2.D0.BE.D0.B9_Windows"></span><span class="mw-headline" id="D3D_ускорение_в_гостевой_Windows">D3D ускорение в гостевой Windows</span>
</h3>
<p>Последние версии Virtualbox имеют поддержку ускорения OpenGL внутри гостевой ОС. Эта функция может быть включена галочкой в настройках машины (при установленных дополнениях гостевой ОС VirtualBox). Тем не менее, большинство игр под Windows используют Direct3D (часть DirectX), а не OpenGL, и, таким образом,  этот метод не поможет. Тем не менее возможно получить ускоренное Direct3D в гостевой Windows, за счет заимствования D3D библиотеки из Wine, который переводит инструкции d3d под OpenGL, который и занимается ускорением. Эти библиотеки теперь являются частью дополнений гостевой ОС.
</p>
<p>После включения OpenGL ускорения, как описано выше, перезагрузите гостевую ОС в безопасном режиме (нажмите F8 до появления экрана для Windows, но после  исчезновения экрана Virtualbox), и установите дополнения гостевой ОС, во время установки установите галочку <i>Включить поддержку Direct3D</i>. Перезагрузитесь обратно в нормальный режим, и вы получите ускоренный Direct3D.
</p>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Примечание:</strong>  Этот хак может может не работать для некоторых игр, в зависимости от того, какую аппаратную проверку они делают и какие части D3D они используют</div>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Примечание:</strong>  Хак был проверено на Windows XP, 7 и 8,1. Если метод не работает на версии Windows, пожалуйста, добавьте эту информацию здесь.</div>
<h3>
<span id="VirtualBox_c_USB-.D0.BA.D0.BB.D1.8E.D1.87.D0.BE.D0.BC"></span><span class="mw-headline" id="VirtualBox_c_USB-ключом">VirtualBox c USB-ключом</span>
</h3>
<p>При использовании VirtualBox с USB-ключом, например, для запуска установленной машины с ISO-образа, вы вручную должны создать VDMK-файлы существующих приводов. Тем не менее, как только новые файлы VMDK сохраняться и вы перейдёте на другую машину, у вас могут снова возникнуть проблемы. Чтобы избавиться от этой проблемы, можно использовать следующий скрипт для запуска VirtualBox. Этот сценарий будет убирать старые файлов VMDK и создавать новые:
</p>
<pre>#!/bin/bash

# Erase old VMDK entries
rm ~/.VirtualBox/*.vmdk

# Clean up VBox-Registry
sed -i '/sd/d' ~/.VirtualBox/VirtualBox.xml

# Remove old harddisks from existing machines
find ~/.VirtualBox/Machines -name \*.xml | while read file; do
  line=`grep -e "type\=\"HardDisk\"" -n $file | cut -d ':' -f 1`
  if [ -n "$line" ]; then
    sed -i ${line}d $file
    sed -i ${line}d $file
    sed -i ${line}d $file
  fi
  sed -i "/rg/d" $file
done

# Delete prev-files created by VirtualBox
find  ~/.VirtualBox/Machines -name \*-prev -exec rm '{}' \;

# Recreate VMDKs
ls -l /dev/disk/by-uuid | cut -d ' ' -f 9,11 | while read ln; do
  if [ -n "$ln" ]; then
    uuid=`echo "$ln" | cut -d ' ' -f 1`
    device=`echo "$ln" | cut -d ' ' -f 2 | cut -d '/' -f 3 | cut -b 1-3`

    # determine whether drive is mounted already
    checkstr1=`mount | grep $uuid`
    checkstr2=`mount | grep $device`
    checkstr3=`ls ~/.VirtualBox/*.vmdk | grep $device`
    if [[ -z "$checkstr1" &amp;&amp; -z "$checkstr2" &amp;&amp; -z "$checkstr3" ]]; then
      VBoxManage internalcommands createrawvmdk -filename ~/.VirtualBox/$device.vmdk -rawdisk /dev/$device -register
    fi
  fi
done

# Start VirtualBox
VirtualBox
</pre>
<p>Обратите внимание, что ваш пользователь должен быть добавлен в группу <code>disk</code>, чтобы создать VMDKs из существующих приводов.
</p>
<h3>
<span id=".D0.97.D0.B0.D0.BF.D1.83.D1.81.D0.BA_.D1.83.D1.81.D1.82.D0.B0.D0.BD.D0.BE.D0.B2.D0.BB.D0.B5.D0.BD.D0.BD.D0.BE.D0.B3.D0.BE_Arch_Linux_.D0.B2.D0.BD.D1.83.D1.82.D1.80.D0.B8_VirtualBox"></span><span class="mw-headline" id="Запуск_установленного_Arch_Linux_внутри_VirtualBox">Запуск установленного Arch Linux внутри VirtualBox</span>
</h3>
<p>Если у вас есть дуалбут системы между Arch Linux и другими операционных системами, он может быстро стать утомительным для переключения туда-сюда, если вам нужно работать в обоих. Кроме того, с помощью виртуальных машин, у вас есть только крошечный фрагмент власти компьютера, который может привести к проблемам при работе на проектах, требующих производительности.
</p>
<p>Это руководство позволит вам использовать в виртуальной машине, вашу родную установку Arch Linux, когда вы используете свою вторую операционную систему. Таким образом, вы сохраняете возможность запуска каждой операционной систему изначально, но есть возможность запустить установленный физически Arch Linux внутри виртуальной машины.
</p>
<h4>
<span id=".D0.A3.D0.B1.D0.B5.D0.B4.D0.B8.D1.82.D0.B5.D1.81.D1.8C.2C_.D1.87.D1.82.D0.BE_.D1.81.D0.B8.D1.81.D1.82.D0.B5.D0.BC.D0.B0_.D0.BD.D0.B0.D0.B8.D0.BC.D0.B5.D0.BD.D0.BE.D0.B2.D0.B0.D0.BD.D0.B8.D1.8F_.D1.80.D0.B0.D0.B7.D0.B4.D0.B5.D0.BB.D0.BE.D0.B2_.D0.BD.D0.B5_.D0.B8.D0.B7.D0.BC.D0.B5.D0.BD.D1.8F.D0.B5.D1.82.D1.81.D1.8F"></span><span class="mw-headline" id="Убедитесь,_что_система_наименования_разделов_не_изменяется">Убедитесь, что система наименования разделов не изменяется</span>
</h4>
<p>В зависимости от настроек вашего жесткого диска, файлы устройств, представляющих свои жесткие диски могут выглядеть по-разному когда вы будете запускать установку Arch Linux -  изначально или в виртуальной машине. Эта проблема возникает, например, при использовании <a href="/title/RAID#Implementation" title="RAID">FakeRAID</a>. Поддельные RAID устройстве, будут перемещены в <code>/dev/mapper/</code> при запуске дистрибутива GNU/Linux , в то время как будут устройства по-прежнему доступны по отдельности. Тем не менее, в вашей виртуальной машине может оказаться без отображения в  <code>/dev/sdaX</code> например, потому что драйвера, управляющие поддельными RAID в вашей локальной операционной системе (например, Windows) абстрагируются под поддельные RAID устройства.
</p>
<p>Чтобы обойти эту проблему, мы должны будем использовать схему адресации, работающую в обеих системах. Это может быть достигнуто с помощью  <a href="/title/Fstab#UUIDs" title="Fstab">UUIDs</a><sup>[<a href="/title/Help:Procedures#Fix_broken_section_links" title="Help:Procedures">ссылка недействительна</a>: раздел не найден]</sup>  в файле <code>/etc/fstab</code>. Убедитесь, что ваш <a href="/title/Fstab_(%D0%A0%D1%83%D1%81%D1%81%D0%BA%D0%B8%D0%B9)" title="Fstab (Русский)">fstab</a> использует UUID - в противном случае решайте эту проблему. Читайте <a href="/title/Fstab" title="Fstab">Fstab</a> и <a href="/title/Persistent_block_device_naming" title="Persistent block device naming">Устойчивое именование разделов</a>.
</p>
<p><code>/etc/fstab</code>  не является единственным местом, где используются UUID. Менеджеры загрузчиков тоже  их используют. Убедитесь, что они действительно используют UUID-ы.
</p>
<dl><dt><a href="/title/GRUB_Legacy_(%D0%A0%D1%83%D1%81%D1%81%D0%BA%D0%B8%D0%B9)" class="mw-redirect" title="GRUB Legacy (Русский)">GRUB Legacy</a></dt></dl>
<p>Если вы все еще используете <a href="/title/GRUB_Legacy_(%D0%A0%D1%83%D1%81%D1%81%D0%BA%D0%B8%D0%B9)" class="mw-redirect" title="GRUB Legacy (Русский)">GRUB Legacy</a>, может быть настало время его <a href="/title/GRUB_Legacy#Upgrading_to_GRUB2" title="GRUB Legacy">обновить</a>, так как этот пакет в настоящее время удален из официальных репозиториев Arch Linux. Если вы хотите сохранить его, отредактируйте <code>/boot/grub/menu.lst</code> и замените <code>root=/dev/sdXX</code> в загрузочной записи Arch Linux на Linux UUID <code>/dev/disk/by-uuid/</code>, соответствующий корневому разделу.
</p>
<pre>title  Arch Linux
root
kernel /vmlinuz-linux root=<i>/dev/disk/by-uuid/0a3407de-014b-458b-b5c1-848e92a327a3</i> ro vga=773
initrd /initramfs-linux-vbox.img
</pre>
<p>Предварительно создайте резервную копию файла на случай ошибок.
</p>
<dl><dt><a href="/title/GRUB_(%D0%A0%D1%83%D1%81%D1%81%D0%BA%D0%B8%D0%B9)" title="GRUB (Русский)">GRUB</a></dt></dl>
<p>Если вы работаете с самой последней версией <a href="/title/GRUB_(%D0%A0%D1%83%D1%81%D1%81%D0%BA%D0%B8%D0%B9)" title="GRUB (Русский)">GRUB</a>; у вас нет проблем. Это ещё одна причина для перехода на GRUB 2.
</p>
<div class="archwiki-template-box archwiki-template-box-warning">
<strong>Важно:</strong> 
<ul>
<li>Убедитесь, что ваш хост-раздел доступна только для чтения с вашей виртуальной машины Arch Linux. Это позволит избежать риска повреждения.</li>
<li>Вы никогда не должны позволять VirtualBox загружаться с момента загрузки вашей второй операционной системы, которая  используется в качестве хоста для этой виртуальной машины! Возьмите, таким образом, за правило - особенно если ваша загрузка производится по умолчанию в другую операционную систему. Установите более большой тайм-аут или переместите систему ниже в порядке предпочтений.</li>
</ul>
</div>
<h4>
<span id=".D0.A3.D0.B1.D0.B5.D0.B4.D0.B8.D1.82.D0.B5.D1.81.D1.8C_.D0.B2_.D0.BA.D0.BE.D1.80.D1.80.D0.B5.D0.BA.D1.82.D0.BD.D0.BE.D1.81.D1.82.D0.B8_.D0.BE.D0.B1.D1.80.D0.B0.D0.B7.D0.B0_mkinitcpio"></span><span class="mw-headline" id="Убедитесь_в_корректности_образа_mkinitcpio">Убедитесь в корректности образа mkinitcpio</span>
</h4>
<p>Убедитесь, что в конфигурации вашего <a href="/title/Mkinitcpio_(%D0%A0%D1%83%D1%81%D1%81%D0%BA%D0%B8%D0%B9)" title="Mkinitcpio (Русский)">mkinitcpio</a> есть <a href="/title/Mkinitcpio_(%D0%A0%D1%83%D1%81%D1%81%D0%BA%D0%B8%D0%B9)#%D0%97%D0%B0%D0%BF%D1%80%D0%B5%D1%82_%D0%BE%D0%B1%D1%80%D0%B0%D0%B1%D0%BE%D1%82%D1%87%D0%B8%D0%BA%D0%BE%D0%B2" title="Mkinitcpio (Русский)">хук</a> <code>block</code>:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/mkinitcpio.conf</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">[...]
HOOKS="base udev autodetect modconf <i>block</i> filesystems keyboard fsck"
[...]</pre>
<p>Если это не так, добавьте хук и сгенерируйте свой initramfs, с помощью команды <code># mkinitcpio -p linux</code>, что <a href="/title/Mkinitcpio_(%D0%A0%D1%83%D1%81%D1%81%D0%BA%D0%B8%D0%B9)#%D0%A1%D0%BE%D0%B7%D0%B4%D0%B0%D0%BD%D0%B8%D0%B5_%D0%BE%D0%B1%D1%80%D0%B0%D0%B7%D0%B0" title="Mkinitcpio (Русский)">описано здесь более подробно</a><sup>[<a href="/title/Help:Procedures#Fix_broken_section_links" title="Help:Procedures">ссылка недействительна</a>: раздел не найден]</sup>.
</p>
<h4>
<span id=".D0.A1.D0.BE.D0.B7.D0.B4.D0.B0.D0.BD.D0.B8.D0.B5_.D0.BA.D0.BE.D0.BD.D1.84.D0.B8.D0.B3.D1.83.D1.80.D0.B0.D1.86.D0.B8.D0.B8_.D0.B2.D0.B8.D1.80.D1.82.D1.83.D0.B0.D0.BB.D1.8C.D0.BD.D0.BE.D0.B9_.D0.BC.D0.B0.D1.88.D0.B8.D0.BD.D1.8B_.D0.B4.D0.BB.D1.8F_.D0.B7.D0.B0.D0.B3.D1.80.D1.83.D0.B7.D0.BA.D0.B8_.D1.81_.D1.84.D0.B8.D0.B7.D0.B8.D1.87.D0.B5.D1.81.D0.BA.D0.BE.D0.B3.D0.BE_.D0.B4.D0.B8.D1.81.D0.BA.D0.B0"></span><span class="mw-headline" id="Создание_конфигурации_виртуальной_машины_для_загрузки_с_физического_диска">Создание конфигурации виртуальной машины для загрузки с физического диска</span>
</h4>
<h5>
<span id=".D0.A1.D0.BE.D0.B7.D0.B4.D0.B0.D0.B9.D1.82.D0.B5_.D0.BF.D0.BE.D1.82.D0.BE.D0.BA.D0.BE.D0.B2.D1.8B.D0.B9.28raw.29_.D0.BE.D0.B1.D1.80.D0.B0.D0.B7_.vmdk"></span><span class="mw-headline" id="Создайте_потоковый(raw)_образ_.vmdk">Создайте потоковый(raw) образ .vmdk</span>
</h5>
<p>Теперь нам нужно создать новую виртуальную машину, которая будет использовать <a rel="nofollow" class="external text" href="https://www.virtualbox.org/manual/ch09.html#rawdisk">RAW диск</a> в качестве виртуального диска, для этого мы будем использовать файл ~ 1Kib VMDK, которые будет сбрасываться на физический диск. VirtualBox не имеет этой опции в графическом интерфейсе, так что мы должны использовать консоль и внутреннюю команду из <code>VBoxManage</code>.
</p>
<p>Загрузите хост, который будет использовать виртуальную машину Arch Linux.Команда должны быть адаптированы в соответствии с вашей хост-машиной.
</p>
<dl>
<dt>На хосте GNU/Linux</dt>
<dd></dd>
</dl>
<p>Существует 3 способа этого достичь: вход от суперпользователя, изменение прав доступа к устройству командой <code>chmod</code>, добавление пользователя в группу <code>disk</code>. Последний путь является более элегантным. Реализуем таким образом:
</p>
<pre># gpasswd -a <i>your_user</i> disk
</pre>
<p>Применить новые параметры сейчас же:
</p>
<pre>$ newgrp
</pre>
<p>Теперь вы можете использовать следующую команду:
</p>
<pre>$ VBoxManage internalcommands createrawvmdk -filename <i>/path/to/file.vmdk</i> -rawdisk <i>/dev/sdb</i> -register 
</pre>
<p>Адаптируйте команду для ваших потребностей.
</p>
<dl>
<dt>На хосте с Windows</dt>
<dd></dd>
</dl>
<p>
Откройте окно командной строки (необходимо запускать от имени администратора). </p>
<div class="archwiki-template-box archwiki-template-box-tip">
<strong>Совет:</strong>  В Windows откройте меню Пуск / стартовый экран, введите <code>cmd</code>, и нажмите <code>Ctrl+Shift+Enter</code>, это ярлык для запуска выбранной программы с правами администратора.</div>
<p>В Windows наименование дисков отлично от UNIX. Используйте эту команду, чтобы определить значения в вашей системе Windows, и их расположение:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;"># wmic diskdrive get name,size,model</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">Model                               Name                Size
WDC WD40EZRX-00SPEB0 ATA Device     \\.\PHYSICALDRIVE1  4000783933440
KINGSTON SVP100S296G ATA Device     \\.\PHYSICALDRIVE0  96024821760
Hitachi HDT721010SLA360 ATA Device  \\.\PHYSICALDRIVE2  1000202273280
Innostor Ext. HDD USB Device        \\.\PHYSICALDRIVE3  1000202273280</pre>
<p>В этом примере Windows называет диски <code>\\.\PhysicalDriveX</code>, Где X представляет собой число от 0, <code>\\.\PHYSICALDRIVE1</code> может быть сопоставим с <code>/dev/sdb</code> из терминологии Linux.
</p>
<p>Для использования в командной строке <code>VBoxManage</code> в Windows, вы должны изменить текущую папку в папку установки VirtualBox, обычно это <code>cd C:\Program Files\Oracle\VirtualBox\</code>
</p>
<pre># .\VBoxManage.exe internalcommands createrawvmdk -filename C:\file.vmdk -rawdisk \\.\PHYSICALDRIVE1
</pre>
<p>или использовать абсолютный путь:
</p>
<pre># "C:\Program Files\Oracle\VirtualBox\VBoxManage.exe" internalcommands createrawvmdk -filename C:\file.vmdk -rawdisk \\.\PHYSICALDRIVE1
</pre>
<dl>
<dt>На другой хост-OS</dt>
<dd></dd>
</dl>
<p>Есть и другие ограничения, касающиеся вышеприведенной команды, когда она используется в других операционных системах - таких как OS X.  Прочитайте <a rel="nofollow" class="external text" href="https://www.virtualbox.org/manual/ch09.html#rawdisk">внимательно руководство</a>, если это вас беспокоит.
</p>
<h5>
<span id=".D0.A1.D0.BE.D0.B7.D0.B4.D0.B0.D0.BD.D0.B8.D0.B5_.D1.84.D0.B0.D0.B9.D0.BB.D0.B0_.D0.BA.D0.BE.D0.BD.D1.84.D0.B8.D0.B3.D1.83.D1.80.D0.B0.D1.86.D0.B8.D0.B8_.D0.B2.D0.B8.D1.80.D1.82.D1.83.D0.B0.D0.BB.D1.8C.D0.BD.D0.BE.D0.B9_.D0.BC.D0.B0.D1.88.D0.B8.D0.BD.D1.8B"></span><span class="mw-headline" id="Создание_файла_конфигурации_виртуальной_машины">Создание файла конфигурации виртуальной машины</span>
</h5>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Примечание:</strong> 
<ul><li>Для использования команды VBoxManage в Windows, вам нужно сначало изменить текущую директорию в папку установки VirtualBox :</li></ul>
<pre>cd C:\Program Files\Oracle\VirtualBox\
</pre>
<ul><li>Windows делает использование обратного слеша вместо слеша, пожалуйста, замените все  вхождения / на \ в командах, которые вы будете использовать.</li></ul>
</div>
<p>После этого мы должны создать новую машину (замените <i>VM_name</i> ная ваш вариант) и зарегистрировать её в VirtualBox.
</p>
<pre>$ VBoxManage createvm -name <i>VM_name</i> -register
</pre>
<p>Затем виртуальный диск должен быть подключен к машине. Это будет зависеть от того, находится ли корень в вашей оригинальной установке Arch Linux на IDE или контроллере SATA.
</p>
<p>Если вам нужен контроллер IDE:
</p>
<pre>$ VBoxManage storagectl <i>VM_name</i> --name "IDE Controller" --add ide
$ VBoxManage storageattach machineA --storagectl "IDE Controller" --port 0 --device 0 --type hdd --medium /path/to/file.vmdk
</pre>
<p>В противном случае:
</p>
<pre>$ VBoxManage storagectl <i>VM_name</i> --name "SATA Controller" --add sata
$ VBoxManage storageattach machineA --storagectl "SATA Controller" --port 0 --device 0 --type hdd --medium /path/to/file.vmdk
</pre>
<p>В то время как вы продолжаете использовать интерфейс командной строки, рекомендуется использовать VirtualBox GUI, чтобы персонализировать настройки виртуальной машины. Необходимо указать аппаратную конфигурацию  как можно ближе к  родной машине: включение ускорения 3D, увеличение видеопамяти, установка сетевого интерфейса и т.д.
</p>
<h4>
<span id=".D0.A3.D1.81.D1.82.D0.B0.D0.BD.D0.BE.D0.B2.D0.BA.D0.B0_.D0.B4.D0.BE.D0.BF.D0.BE.D0.BB.D0.BD.D0.B5.D0.BD.D0.B8.D0.B9_.D0.B3.D0.BE.D1.81.D1.82.D0.B5.D0.B2.D0.BE.D0.B9_.D0.9E.D0.A1"></span><span class="mw-headline" id="Установка_дополнений_гостевой_ОС">Установка дополнений гостевой ОС</span>
</h4>
<p>Наконец, вы можете легко интегрировать Arch Linux с хост-системой и синхронизировать буфер обмена между двумя ОС. Обратитесь к <a href="#%D0%9E%D0%B1%D1%80%D0%B0%D0%B7_%D0%B4%D0%B8%D1%81%D0%BA%D0%B0_%D1%81_%D0%B3%D0%BE%D1%81%D1%82%D0%B5%D0%B2%D1%8B%D0%BC%D0%B8_%D0%B4%D0%BE%D0%BF%D0%BE%D0%BB%D0%BD%D0%B5%D0%BD%D0%B8%D1%8F%D0%BC%D0%B8">установке гостевых дополнений</a><sup>[<a href="/title/Help:Procedures#Fix_broken_section_links" title="Help:Procedures">ссылка недействительна</a>: раздел не найден]</sup>  для этого.
</p>
<div class="archwiki-template-box archwiki-template-box-warning">
<strong>Важно:</strong>  Для <a href="/title/Xorg_(%D0%A0%D1%83%D1%81%D1%81%D0%BA%D0%B8%D0%B9)" title="Xorg (Русский)">Xorg (Русский)</a>, чтобы работать в родной и в виртуальной машине, так как очевидно, он должен использовать другой драйвер, то лучше, если не будет <code>/etc/X11/xorg.conf</code> - так как Xorg будет собирать все, что необходимо на лету. Однако, если вам действительно нужно свою собственную конфигурацию Xorg, может быть, стоит установить используемые по умолчанию цели Systemd к <code>multi-user.target</code> с <code># systemctl isolate graphical.target</code> (более <a href="/title/Systemd_(%D0%A0%D1%83%D1%81%D1%81%D0%BA%D0%B8%D0%B9)#%D0%98%D0%B7%D0%BC%D0%B5%D0%BD%D0%B5%D0%BD%D0%B8%D0%B5_%D1%82%D0%B5%D0%BA%D1%83%D1%89%D0%B5%D0%B9_%D1%86%D0%B5%D0%BB%D0%B8" title="Systemd (Русский)">подробно</a>). Таким образом, графический интерфейс будет отключен (т.е. Xorg не запустится) и после входа в систему вы сможете выполнить <code>startx</code> вручную с пользовательским <code>xorg.conf</code>.</div>
<h3>
<span id=".D0.A4.D0.B8.D0.B7.D0.B8.D1.87.D0.B5.D1.81.D0.BA.D0.B0.D1.8F_.D1.83.D1.81.D1.82.D0.B0.D0.BD.D0.BE.D0.B2.D0.BA.D0.B0_.D1.81.D0.B8.D1.81.D1.82.D0.B5.D0.BC.D1.8B_Arch_Linux_.D0.B8.D0.B7_VirtualBox"></span><span class="mw-headline" id="Физическая_установка_системы_Arch_Linux_из_VirtualBox">Физическая установка системы Arch Linux из VirtualBox</span>
</h3>
<p>В некоторых случаях это может быть полезно для установки родной системы Arch Linux из другой операционной системы: один из способов достижения этой цели является выполнение установки через VirtualBox на <a rel="nofollow" class="external text" href="https://www.virtualbox.org/manual/ch09.html#rawdisk">жёсткий диск</a>. Если существующая операционная система на основе Linux, вы можете рассмотреть <a href="/title/Install_from_existing_Linux_(%D0%A0%D1%83%D1%81%D1%81%D0%BA%D0%B8%D0%B9)" class="mw-redirect" title="Install from existing Linux (Русский)">установку из существующего Linux</a> вместо этого.
</p>
<p>Этот сценарий очень похож на <a href="#%D0%97%D0%B0%D0%BF%D1%83%D1%81%D0%BA_%D1%83%D1%81%D1%82%D0%B0%D0%BD%D0%BE%D0%B2%D0%BB%D0%B5%D0%BD%D0%BD%D0%BE%D0%B3%D0%BE_Arch_Linux_%D0%B2%D0%BD%D1%83%D1%82%D1%80%D0%B8_VirtualBox">Запуск установленного ArchLinux в VirtualBox</a>, но будет реализовывать эти шаги в другом порядке: начать с создания <a href="#%D0%A1%D0%BE%D0%B7%D0%B4%D0%B0%D0%B9%D1%82%D0%B5_%D0%BF%D0%BE%D1%82%D0%BE%D0%BA%D0%BE%D0%B2%D1%8B%D0%B9(raw)_%D0%BE%D0%B1%D1%80%D0%B0%D0%B7_.vmdk">.vmdk образа жёсткого диска</a>, а затем <a href="#%D0%A1%D0%BE%D0%B7%D0%B4%D0%B0%D0%BD%D0%B8%D0%B5_%D1%84%D0%B0%D0%B9%D0%BB%D0%B0_%D0%BA%D0%BE%D0%BD%D1%84%D0%B8%D0%B3%D1%83%D1%80%D0%B0%D1%86%D0%B8%D0%B8_%D0%B2%D0%B8%D1%80%D1%82%D1%83%D0%B0%D0%BB%D1%8C%D0%BD%D0%BE%D0%B9_%D0%BC%D0%B0%D1%88%D0%B8%D0%BD%D1%8B">создавать файл конфигурации виртуальной машины</a>.
</p>
<p>Теперь вы должны иметь рабочую конфигурацию виртуальной машины, чей виртуальный VMDK-диск связан с реальным диском. Процесс установки точно такой же, как и описанный в <a href="#%D0%9F%D0%BE%D1%88%D0%B0%D0%B3%D0%BE%D0%B2%D0%B0%D1%8F_%D1%83%D1%81%D1%82%D0%B0%D0%BD%D0%BE%D0%B2%D0%BA%D0%B0_Arch_Linux_%D0%BA%D0%B0%D0%BA_%D0%B3%D0%BE%D1%81%D1%82%D0%B5%D0%B2%D0%BE%D0%B9_%D0%9E%D0%A1">пошаговой установке ArchLinux в VirtualBox</a>, но сначала <a href="#%D0%A3%D0%B1%D0%B5%D0%B4%D0%B8%D1%82%D0%B5%D1%81%D1%8C,_%D1%87%D1%82%D0%BE_%D1%81%D0%B8%D1%81%D1%82%D0%B5%D0%BC%D0%B0_%D0%BD%D0%B0%D0%B8%D0%BC%D0%B5%D0%BD%D0%BE%D0%B2%D0%B0%D0%BD%D0%B8%D1%8F_%D1%80%D0%B0%D0%B7%D0%B4%D0%B5%D0%BB%D0%BE%D0%B2_%D0%BD%D0%B5_%D0%B8%D0%B7%D0%BC%D0%B5%D0%BD%D1%8F%D0%B5%D1%82%D1%81%D1%8F">убедитесь в постоянной схеме наименования разделов</a> и <a href="#%D0%A3%D0%B1%D0%B5%D0%B4%D0%B8%D1%82%D0%B5%D1%81%D1%8C_%D0%B2_%D0%BA%D0%BE%D1%80%D1%80%D0%B5%D0%BA%D1%82%D0%BD%D0%BE%D1%81%D1%82%D0%B8_%D0%BE%D0%B1%D1%80%D0%B0%D0%B7%D0%B0_mkinitcpio">корректности образа mkinitcpio</a>.
</p>
<div class="archwiki-template-box archwiki-template-box-warning">
<strong>Важно:</strong> 
<ul>
<li>Для BIOS и MBR дисков: не устанавливайте загрузчик внутри виртуальной машины - он не будет работать, так как MBR не связан с MBR вашей реальной машины, и виртуальный диск отображается только в реальном разделе без MBR</li>
<li>Для UEFI систем без <a href="https://en.wikipedia.org/wiki/Unified_Extensible_Firmware_Interface#Compatibility_Support_Module" class="extiw" title="wikipedia:Unified Extensible Firmware Interface">CSM</a> и GPT дискa установка не будет работать вообще, так как:</li>
</ul>
<dl><dd><ul>
<li>
<a href="https://en.wikipedia.org/wiki/EFI_system_partition" class="extiw" title="wikipedia:EFI system partition">ESP</a> не отображается на виртуальный диск и Arch Linux требует, чтобы ядро Linux было на нём, чтобы загрузиться в качестве приложения EFI (смотрите статью <a href="/title/EFISTUB_(%D0%A0%D1%83%D1%81%D1%81%D0%BA%D0%B8%D0%B9)" title="EFISTUB (Русский)">EFISTUB (Русский)</a>)</li>
<li>и efivars, если вы устанавливаете Arch Linux через  VirtualBox, используя режим EFI, не загрузит ни одну из ваших реальных систем: записи Bootmanager не смогут быть зарегистрированы</li>
</ul></dd></dl>
<ul><li>Вот почему рекомендуется создавать разделы в родной установке. В противном случае разделы не будут приниматься во внимание в MBR / GPT таблице разделов</li></ul>
</div>
<p>После завершения установки загрузите компьютер сперва с установочного носителя GNU/Linux (будь то Arch Linux или нет), выполните <a href="/title/Installation_guide_(%D0%A0%D1%83%D1%81%D1%81%D0%BA%D0%B8%D0%B9)#Chroot" title="Installation guide (Русский)">chroot</a> в установленной Arch Linux и установите и настройте <a href="/title/Installation_guide_(%D0%A0%D1%83%D1%81%D1%81%D0%BA%D0%B8%D0%B9)#%D0%97%D0%B0%D0%B3%D1%80%D1%83%D0%B7%D1%87%D0%B8%D0%BA" title="Installation guide (Русский)">загрузчик</a>.
</p>
<h3>
<span id=".D0.9F.D0.B5.D1.80.D0.B5.D0.BC.D0.B5.D1.89.D0.B5.D0.BD.D0.B8.D0.B5_.D1.84.D0.B8.D0.B7.D0.B8.D1.87.D0.B5.D1.81.D0.BA.D0.B8_.D1.83.D1.81.D1.82.D0.B0.D0.BD.D0.BE.D0.B2.D0.BB.D0.B5.D0.BD.D0.BD.D0.BE.D0.B3.D0.BE_Windows_.D0.B2_.D0.B2.D0.B8.D1.80.D1.82.D1.83.D0.B0.D0.BB.D1.8C.D0.BD.D1.83.D1.8E_.D0.BC.D0.B0.D1.88.D0.B8.D0.BD.D1.83"></span><span class="mw-headline" id="Перемещение_физически_установленного_Windows_в_виртуальную_машину">Перемещение физически установленного Windows в виртуальную машину</span>
</h3>
<p>Если вы хотите перенести существующую Windows на виртуальную машину, которая будет использоваться с VirtualBox на GNU/Linux, этот вариант использования для вас. В этом разделе описан перенос только Windows с использованием схемы MSDOS/Intel разделов. Ваш  Windows должен находиться на первом после MBR разделе. Работа в других разделах доступна, но были не тестировалась (см <a href="#%D0%98%D0%B7%D0%B2%D0%B5%D1%81%D1%82%D0%BD%D1%8B%D0%B5_%D0%BE%D0%B3%D1%80%D0%B0%D0%BD%D0%B8%D1%87%D0%B5%D0%BD%D0%B8%D1%8F">Известные ограничения</a> для более подробной информации)
</p>
<div class="archwiki-template-box archwiki-template-box-warning">
<strong>Важно:</strong> Если вы используете OEM версию Windows, этот процесс является неправомочным по конечной пользовательской лицензии. Действительно, лицензия OEM, как правило, указывает, что Windows Install связана с аппаратными средствами.  Сделайте так, что бы у вас был полный Windows Install или полная лицензия, прежде чем продолжить. Если у вас есть полная лицензию для Windows, но последний не приходит в объеме, ни в качестве специальной лицензии на нескольких компьютерах, это означает, что вы должны будете удалить родную установку после операции клонирования в VM.</div>
<p>Несколько задач необходимо выполнить внутри вашей  Windows, а затем в хост-машине GNU/Linux.
</p>
<h4>
<span id=".D0.97.D0.B0.D0.B4.D0.B0.D1.87.D0.B8_.D0.B2_Windows"></span><span class="mw-headline" id="Задачи_в_Windows">Задачи в Windows</span>
</h4>
<p>Первые три следующих моменты происходит от <a rel="nofollow" class="external text" href="https://www.virtualbox.org/wiki/Migrate_Windows#HAL">этой устаревшей вики-страницы VirtualBox</a>, но обновляются здесь.
</p>
<ul><li>Удалите проверку IDE/ATA контроллеров (только Windows XP): Windows запоминает IDE/ATA после установки, и не будет загружаться, если он обнаружит что они изменились.Решение, предложенное Microsoft является повторным использованием того же контроллера или использовать один из той-же серии, что невозможно сделать, поскольку мы используем виртуальную машину. <a rel="nofollow" class="external text" href="https://www.virtualbox.org/wiki/Migrate_Windows#HardDiskSupport">MergeIDE</a>, немецкий инструмент, разработан как другое решением, предложенное Microsoft. Решение в основном состоит в принятии всех IDE/ATA драйверов контроллера IDE, поддерживаемые Windows XP от первоначального архива драйвера, их установке и регистрации в реестре через Regedit.</li></ul>
<ul><li>Используйте правильный тип слоя абстрагирования оборудования (старые 32-битный Windows): Microsoft использует с 3 версии по умолчанию: <code>Hal.dll</code> (Standard PC), <code>Halacpi.dll</code> (ACPI HAL) и <code>halaacpi.dll</code> (ACPI HAL с IO APIC). Ваша Windows-установка могла устанавитmся с первого или второго варианта. В этом случае, пожалуйста, <a rel="nofollow" class="external text" href="https://www.virtualbox.org/manual/ch08.html#idp56927888">отключите <i>Enable IO/APIC </i> в расширенных возможностях VirtualBox</a>.</li></ul>
<ul><li>Отключите драйвер AGP устройства (только устаревшие версии ОС Windows): Если у вас есть файлы <code>agp440.sys</code> или <code>intelppm.sys</code> внутри <code> C:\Windows\System32\drivers\</code>, то удалите его. Так как VirtualBox использует PCI виртуальную графическую карту, это может вызвать проблемы, когда   используется драйвер AGP.</li></ul>
<ul><li>Создайте диск восстановления ОС Windows: В следующих шагах, если что-то испортится, вам нужно будет восстановить установку Windows. Убедитесь, что у вас есть установочного носителя под рукой, или создайте через <i>Создать диск восстановления</i> в Vista SP1, <i>Создать диск восстановления системы</i> в Windows 7 или <i>Создать диск восстановления</i> в Windows 8.x).</li></ul>
<h4>
<span id=".D0.97.D0.B0.D0.B4.D0.B0.D1.87.D0.B8_.D0.B2_GNU.2FLinux"></span><span class="mw-headline" id="Задачи_в_GNU/Linux">Задачи в GNU/Linux</span>
</h4>
<ul><li>Уменьшите родной размер раздела Windows, для чего нужен <code>ntfsresize</code> из пакета <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=ntfs-3g">ntfs-3g</a></span>. Вы определяете размер, который будет равен  размере VDI, который будет создан на следующем шаге. Если этот размер будет слишком мал, вы можете сломать ваш Windows и он может не загружаться вообще.</li></ul>
<dl>
<dd>Включите параметр <code>--no-action</code> для тестового запуска:</dd>
<dd><pre># ntfsresize --no-action --size <i>52Gi</i> <i>/dev/sda1</i></pre></dd>
</dl>
<dl><dd>Если только предыдущий тест прошел успешно, необходимо выполнить следующую команду снова, только без вышеупомянутого параметра <code>--no-action</code>.</dd></dl>
<ul><li>Установите VirtualBox на ваш GNU/Linux-хост (см. <a href="#%D0%9F%D0%BE%D1%88%D0%B0%D0%B3%D0%BE%D0%B2%D0%B0%D1%8F_%D1%83%D1%81%D1%82%D0%B0%D0%BD%D0%BE%D0%B2%D0%BA%D0%B0_%D0%BD%D0%B0_%D1%85%D0%BE%D1%81%D1%82-%D0%BA%D0%BE%D0%BC%D0%BF%D1%8C%D1%8E%D1%82%D0%B5%D1%80_%D0%BF%D0%BE%D0%B4_%D1%83%D0%BF%D1%80%D0%B0%D0%B2%D0%BB%D0%B5%D0%BD%D0%B8%D0%B5%D0%BC_Arch_Linux">подробнее</a><sup>[<a href="/title/Help:Procedures#Fix_broken_section_links" title="Help:Procedures">ссылка недействительна</a>: раздел не найден]</sup> ).</li></ul>
<ul><li>Создайте образ диска для Windows от начала диска  до конца первого раздела, на котором находится Windows. Копирование с начала диска необходимо потому, что пространство MBR в начале привода должно быть перенесено на виртуальный диск вместе с самим Windows. В этом примере следующие два раздела <code>sda2</code> и <code>sda3</code> будут позже удалены из таблицы разделов и загрузчик MBR будет обновляться.</li></ul>
<dl><dd><pre># sectnum=$(( $(cat /sys/block/''sda/sda1''/start) + $(cat /sys/block/''sda/sda1''/size) ))</pre></dd></dl>
<p>Использование <code>cat /sys/block/<i>sda/sda1</i>/size</code> выведет количество секторов первого раздела диска <code>sda</code>. Адаптируйте команду, если это вам нужно.
</p>
<dl>
<dd><pre># dd if=''/dev/sda'' bs=512 count=$sectnum | VBoxManage convertfromraw stdin ''windows.vdi'' $(( $sectnum * 512 ))</pre></dd>
<dd>Мы должны показать размер в байтах,  <code>$(( $sectnum * 512 ))</code> преобразует номера секторов в байты.</dd>
</dl>
<ul><li>Так как вы создали свой образ диска с правами администратора, установите права доступа на образ диска: <code># chown $USER:users windows.vdi</code>.</li></ul>
<ul><li>Создайте Ваш файл конфигурации виртуальной машины - используйте виртуальный диск, созданный ранее в качестве основного виртуального жесткого диска.</li></ul>
<ul><li>Постарайтесь загрузиться с виртуальной машины Windows (может работать). Во-первых, хотя бы отключите восстановление дисков из процесса загрузки, так как это может помешать (и, вероятно, будет мешать) загрузиться в безопасном режиме.</li></ul>
<ul><li>Попытка загрузить виртуальную машину в безопасном режиме (нажмите клавишу F8 до логотипа Windows) ... при возникновении вопросов о загрузке, читайте <a href="#%D0%98%D1%81%D0%BF%D1%80%D0%B0%D0%B2%D0%BB%D0%B5%D0%BD%D0%B8%D0%B5_MBR_%D0%B8_%D0%B7%D0%B0%D0%B3%D1%80%D1%83%D0%B7%D1%87%D0%B8%D0%BA%D0%B0_Microsoft">Исправление MBR и загрузчика Microsoft</a>. В безопасном режиме вероятно будут установлен драйверы. Кроме того, установите Дополнения гостевой  ОС через меню <i>Devices</i> &gt; <i>Insert Guest Additions CD image...</i>. Если новое диалоговое окно не отображается, перейдите к компакт-дискам и запустите программу установки вручную.</li></ul>
<ul><li>Наконец-то у вас есть необходимый Windows в виртуальной машине. Ознакомьтесь с <a href="#%D0%98%D0%B7%D0%B2%D0%B5%D1%81%D1%82%D0%BD%D1%8B%D0%B5_%D0%BE%D0%B3%D1%80%D0%B0%D0%BD%D0%B8%D1%87%D0%B5%D0%BD%D0%B8%D1%8F">известными ограничениями</a>.</li></ul>
<h4>
<span id=".D0.98.D1.81.D0.BF.D1.80.D0.B0.D0.B2.D0.BB.D0.B5.D0.BD.D0.B8.D0.B5_MBR_.D0.B8_.D0.B7.D0.B0.D0.B3.D1.80.D1.83.D0.B7.D1.87.D0.B8.D0.BA.D0.B0_Microsoft"></span><span class="mw-headline" id="Исправление_MBR_и_загрузчика_Microsoft">Исправление MBR и загрузчика Microsoft</span>
</h4>
<p>Если ваша виртуальная машина с Windows отказывается загружаться, вам, возможно, потребуется применить следующие изменения в вашей виртуальной машине.
</p>
<ul><li>Начальная загрузка GNU/Live внутри виртуальной машины, прежде чем загрузится ОС Windows .</li></ul>
<ul><li>Удалить другие записи разделы с  MBR виртуального диска. В самом деле, так как мы скопировали MBR и только раздел Windows, записи, относящихся к другим разделам по-прежнему присутствуют в MBR, но разделы ведь больше не доступны. Используйте <code>fdisk</code>, чтобы добиться этого, например.</li></ul>
<dl><dd><pre>fdisk ''/dev/sda''
Command (m for help): a
Partition number (''1-3'', default ''3''): ''1''</pre></dd></dl>
<ul><li>Запишите обновленную таблицу разделов на диск (это будет пересозданием MBR) с помощью <code>m</code> команды в окружении <code>fdisk</code>.</li></ul>
<ul><li>Используйте <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=testdisk">testdisk</a></span> (см.  <a rel="nofollow" class="external text" href="https://www.cgsecurity.org/index.html?testdisk.html">здесь</a> для более подробной информации), чтобы добавить общий MBR:</li></ul>
<dl><dd><pre># testdisk &gt; <i>Disk /dev/sda...'</i> &gt; [Proceed] &gt;  [Intel] Intel/PC partition &gt; [MBR Code] Write TestDisk MBR to first sector &gt; Write a new copy of MBR code to first sector? (Y/n) &gt; Y &gt; Write a new copy of MBR code, confirm? (Y/N) &gt; A new copy of MBR code has been written. You have to reboot for the change to take effect. &gt; [OK]</pre></dd></dl>
<ul><li>С новым MBR и обновленной таблицей разделов, ваша виртуальная машина с Windows должна загрузиться. Если вы все еще сталкиваетесь с вопросами, загрузите диск восстановления Windows с предыдущей стадии, и внутри вашей среды Windows RE, выполняйте команды <a rel="nofollow" class="external text" href="https://support.microsoft.com/kb/927392">описанные здесь</a>.</li></ul>
<h4>
<span id=".D0.98.D0.B7.D0.B2.D0.B5.D1.81.D1.82.D0.BD.D1.8B.D0.B5_.D0.BE.D0.B3.D1.80.D0.B0.D0.BD.D0.B8.D1.87.D0.B5.D0.BD.D0.B8.D1.8F"></span><span class="mw-headline" id="Известные_ограничения">Известные ограничения</span>
</h4>
<ul>
<li>Ваша виртуальная машина может иногда зависать и забивать оперативную память, это может быть вызвано  конфликтующими драйверами , установленными внутри виртуальной машины Windows. Удачи вам найти их!</li>
<li>Дополнительное ПО ожидало драйвер,который не может установиться из-за невозможности отключения / деинсталляции старого драйвера.</li>
<li>Ваша Windows должна находиться в первом разделе для описанного выше процесса, чтобы заработать. Если это требование не выполнено, система может работать, но это не было испытаны. Это потребует либо копирования MBR и редактирования в шестнадцатеричном коде, см. <a rel="nofollow" class="external text" href="https://superuser.com/questions/237782/virtualbox-booting-cloned-disk/253417#253417">VirtualBox: загрузка клонированного диска</a> или потребуется  исправить таблицу разделов <a rel="nofollow" class="external text" href="https://gparted.org/h2-fix-msdos-pt.php">вручную</a> или восстанавливать Windows с диска восстановления, созданного в предыдущем шаге. Рассмотрим нашу установку окна на втором раздела; мы скопируем MBR, второму разделу, где лужит образ диска <code>VBoxManage convertfromraw</code> необходимо общее количество байтов, которые будут записаны: Вычислим как сумму  размера MBR (начало первого раздела) плюс размер второго (Windows) раздела.<code>{ dd if=/dev/sda bs=512 count=$(cat /sys/block/sda/sda1/start) ; dd if=/dev/sda2 bs=512 count=$(cat /sys/block/sda/sda2/size) ; } | VBoxManage convertfromraw stdin windows.vdi $(( ($(cat /sys/block/sda/sda1/start) + $(cat /sys/block/sda/sda2/size)) * 512 ))</code>.</li>
</ul>
<h2>
<span id=".D0.92.D0.BE.D0.B7.D0.BC.D0.BE.D0.B6.D0.BD.D1.8B.D0.B5_.D0.BF.D1.80.D0.BE.D0.B1.D0.BB.D0.B5.D0.BC.D1.8B"></span><span class="mw-headline" id="Возможные_проблемы">Возможные проблемы</span>
</h2>
<h3><span class="mw-headline" id="VERR_ACCESS_DENIED">VERR_ACCESS_DENIED</span></h3>
<p>Чтобы получить доступ к образу vdmk, расположенного на хосте под Windows, запустите VirtualBox GUI от имени администратора.
</p>
<h3>
<span id=".D0.9A.D0.BB.D0.B0.D0.B2.D0.B8.D0.B0.D1.82.D1.83.D1.80.D0.B0_.D0.B8_.D0.BC.D1.8B.D1.88.D0.BA.D0.B0_.D0.B7.D0.B0.D0.B1.D0.BB.D0.BE.D0.BA.D0.B8.D1.80.D0.BE.D0.B2.D0.B0.D0.BD.D1.8B_.D0.B2.D0.B8.D1.80.D1.82.D1.83.D0.B0.D0.BB.D1.8C.D0.BD.D0.BE.D0.B9_.D0.BC.D0.B0.D1.88.D0.B8.D0.BD.D0.BE.D0.B9"></span><span class="mw-headline" id="Клавиатура_и_мышка_заблокированы_виртуальной_машиной">Клавиатура и мышка заблокированы виртуальной машиной</span>
</h3>
<p>Это означает, что ваша виртуальная машина захватила ввод клавиатуры и мышки. Просто нажмите правый <code>Ctrl</code> и ваши устройства ввода будут доступны в основной системе.
</p>
<p>Для того, чтобы управление мышкой возвращалось основной ОС при выходе курсора за границы окна виртуальной машины, без нажатия каких-либо клавиш, и для возможности бесшовной интеграции, установите гостевое дополнение на виртуальную машину. Читайте шаг <a href="#%D0%A3%D1%81%D1%82%D0%B0%D0%BD%D0%BE%D0%B2%D0%BA%D0%B0_%D0%B3%D0%BE%D1%81%D1%82%D0%B5%D0%B2%D1%8B%D1%85_%D0%B4%D0%BE%D0%BF%D0%BE%D0%BB%D0%BD%D0%B5%D0%BD%D0%B8%D0%B9">#Установка гостевых дополнений</a> если вы новичок в Arch Linux, или читайте официальную справку VirtualBox.
</p>
<h3>
<span id=".D0.9D.D0.B5_.D0.BC.D0.BE.D0.B3.D1.83_.D0.BE.D1.82.D0.BF.D1.80.D0.B0.D0.B2.D0.B8.D1.82.D1.8C_.D0.BA.D0.BE.D0.BC.D0.B1.D0.B8.D0.BD.D0.B0.D1.86.D0.B8.D1.8E_CTRL.2BALT.2BFn_.D0.B2_.D0.B2.D0.B8.D1.80.D1.82.D1.83.D0.B0.D0.BB.D1.8C.D0.BD.D1.83.D1.8E_.D0.BC.D0.B0.D1.88.D0.B8.D0.BD.D1.83"></span><span class="mw-headline" id="Не_могу_отправить_комбинацию_CTRL+ALT+Fn_в_виртуальную_машину">Не могу отправить комбинацию CTRL+ALT+Fn в виртуальную машину</span>
</h3>
<p>Если в вашей виртуальной машине установлен дистрибутив GNU/Linux и вы хотите открыть новую оболочку TTY нажатием <code>Ctrl+Alt+F2</code> или выйти из X сессии с помощью <code>Ctrl+Alt+Backspace</code>, просто нажав это сочетание клавиш без какой-либо адаптации, гостевая машина его не получит и основная ОС (если это тоже дистрибутив GNU/Linux) распознает это сочетание клавиш. Для отправки <code>Ctrl+Alt+F2</code> на виртуальную машину нужно просто нажать ваш <i>Host Key</i> (обычно это правый <code>Ctrl</code>) и одновременно нажать <code>F2</code>.
</p>
<h3>
<span id=".D0.98.D1.81.D0.BF.D1.80.D0.B0.D0.B2.D0.BB.D0.B5.D0.BD.D0.B8.D0.B5_.D0.BF.D1.80.D0.BE.D0.B1.D0.BB.D0.B5.D0.BC_.D0.B2_ISO-.D0.BE.D0.B1.D1.80.D0.B0.D0.B7.D0.B0.D1.85"></span><span class="mw-headline" id="Исправление_проблем_в_ISO-образах">Исправление проблем в ISO-образах</span>
</h3>
<p>В то время как VirtualBox монтирует оригинальный образы ISO без проблем, есть такие форматы образов, которые не могут надежно быть преобразованы в ISO. Например, ccd2iso игнорирует .ccd и .sub файлы, что может привести к созданию образа диска с разбитыми файлами.
</p>
<p>В этом случае вам придется использовать <a href="/title/CDemu" title="CDemu">CDemu</a> для Linux внутри VirtualBox или любую другую утилиту, предназначенную для монтирования образов дисков.
</p>
<h3>
<span id="VirtualBox_GUI_.D0.BD.D0.B5_.D0.B2.D0.B8.D0.B4.D0.B8.D1.82_.D0.BC.D0.BE.D1.8E_.D1.82.D0.B5.D0.BC.D1.83_GTK_2x.2F3x"></span><span class="mw-headline" id="VirtualBox_GUI_не_видит_мою_тему_GTK_2x/3x">VirtualBox GUI не видит мою тему GTK 2x/3x</span>
</h3>
<p>Смотрите <a href="/title/Uniform_look_for_Qt_and_GTK_applications_(%D0%A0%D1%83%D1%81%D1%81%D0%BA%D0%B8%D0%B9)" class="mw-redirect" title="Uniform look for Qt and GTK applications (Русский)">Единый интерфейс GTK/QT приложений</a> для получения информации о настройке GUI Qt в GTK-окружениях.
</p>
<h3>
<span id="OpenBSD_.D0.BD.D0.B5_.D1.80.D0.B0.D0.B1.D0.BE.D1.82.D0.B0.D0.B5.D1.82_.D0.BF.D1.80.D0.B8_.D0.BD.D0.B5.D0.B4.D0.BE.D1.81.D1.82.D1.83.D0.BF.D0.BD.D1.8B.D1.85_.D0.B8.D0.BD.D1.81.D1.82.D1.80.D1.83.D0.BA.D1.86.D0.B8.D1.8F.D1.85_.D0.B2.D0.B8.D1.80.D1.82.D1.83.D0.B0.D0.BB.D0.B8.D0.B7.D0.B0.D1.86.D0.B8.D0.B8"></span><span class="mw-headline" id="OpenBSD_не_работает_при_недоступных_инструкциях_виртуализации">OpenBSD не работает при недоступных инструкциях виртуализации</span>
</h3>
<p>В то время как OpenBSD отлично работает  на других гипервизорах без включенной виртуализации (VT-х AMD-V), виртуальная машина с OpenBSD работает в VirtualBox без этих инструкций некорректно, выдавая кучу ошибок сегментации. Запуская VirtualBox с аргументом <i>-norawr0</i> <a rel="nofollow" class="external text" href="https://www.virtualbox.org/ticket/3947">можно избавиться от этой проблемы</a>. Вы можете сделать это следующим образом:
</p>
<pre>$ VBoxSDL -norawr0 -vm <i>имя_OpenBSD_VM</i>
</pre>
<h3>
<span id="VBOX_E_INVALID_OBJECT_STATE_.280x80BB0007.29"></span><span class="mw-headline" id="VBOX_E_INVALID_OBJECT_STATE_(0x80BB0007)">VBOX_E_INVALID_OBJECT_STATE (0x80BB0007)</span>
</h3>
<p>Это может произойти при некорректном завершении виртуальной машины. Разблокировка машины тривиальна:
</p>
<pre>$ VBoxManage controlvm <i>virtual_machine_name</i> poweroff
</pre>
<h3>
<span id=".D0.9F.D0.BE.D0.B4.D1.81.D0.B8.D1.81.D1.82.D0.B5.D0.BC.D0.B0_USB_.D0.BD.D0.B5_.D1.80.D0.B0.D0.B1.D0.BE.D1.82.D0.B0.D0.B5.D1.82_.D0.B2_.D1.85.D0.BE.D1.81.D1.82-.D0.BC.D0.B0.D1.88.D0.B8.D0.BD.D0.B5_.D0.B8.D0.BB.D0.B8_.D0.B3.D0.BE.D1.81.D1.82.D0.B5.D0.B2.D0.BE.D0.B9_.D0.9E.D0.A1"></span><span class="mw-headline" id="Подсистема_USB_не_работает_в_хост-машине_или_гостевой_ОС">Подсистема USB не работает в хост-машине или гостевой ОС</span>
</h3>
<p>Ваш пользователь должен быть в группе <code>vboxusers</code>, и вы должны установить  <a href="#%D0%9F%D0%B0%D0%BA%D0%B5%D1%82_%D0%B4%D0%BE%D0%BF%D0%BE%D0%BB%D0%BD%D0%B5%D0%BD%D0%B8%D0%B9">пакет дополнений</a><sup>[<a href="/title/Help:Procedures#Fix_broken_section_links" title="Help:Procedures">ссылка недействительна</a>: раздел не найден]</sup>, если хотите иметь поддержку USB 2. Тогда вы сможете включить USB 2 в настройках виртуальной машины и добавить один или несколько фильтров для устройств, которые будут иметь доступ  из гостевой ОС.
</p>
<p>Иногда, на старых Linux-хостах, подсистема USB не распознается автоматически и выдает ошибку  <code>Could not load the Host USB Proxy service: VERR_NOT_FOUND</code> или при невидимом USB-диске в хост-машине, <a rel="nofollow" class="external text" href="HTTPS://bbs.archlinux.org/viewtopic.php?id=121377,">даже когда пользователь находится в группе <b>vboxusers</b></a>. Эта проблема происходит из-за того, что VirtualBox переключается с <i>usbfs</i> на <i>sysfs</i> с версии 3.0.8. Если хост-машина не распознаёт этого изменения, вы можете вернуться к старому поведению, определив следующую переменную окружения в любом файле, которые конфигурирует  вашу оболочку (например, в <code>~/.bashrc</code>, если вы используете <i>bash</i>):
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">~/.bashrc</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">VBOX_USB=usbfs</pre>
<p>Затем убедитесь, что, окружающая среда приняла это изменение (перелогиньтесь, запустите новый экземпляр оболочки или перезагрузитесь).
</p>
<p>Также убедитесь, что ваш пользователь состоит в группе <code>storage</code>.
</p>
<h3>
<span id=".D0.9E.D1.88.D0.B8.D0.B1.D0.BA.D0.B0_.D1.81.D0.BE.D0.B7.D0.B4.D0.B0.D0.BD.D0.B8.D1.8F_.D1.81.D0.B5.D1.82.D0.B5.D0.B2.D0.BE.D0.B3.D0.BE_.D0.B8.D0.BD.D1.82.D0.B5.D1.80.D1.84.D0.B5.D0.B9.D1.81.D0.B0_.22host-only.22"></span><span class="mw-headline" id='Ошибка_создания_сетевого_интерфейса_"host-only"'>Ошибка создания сетевого интерфейса "host-only"</span>
</h3>
<p>Убедитесь в том, что все модули ядра VirtualBox загружены (см. <a href="#%D0%97%D0%B0%D0%B3%D1%80%D1%83%D0%B7%D0%BA%D0%B0_%D0%BC%D0%BE%D0%B4%D1%83%D0%BB%D0%B5%D0%B9_%D1%8F%D0%B4%D1%80%D0%B0_VirtualBox">Загрузка модулей ядра VirtualBox</a>).
</p>
<h3>
<span id="WinXP:_.D0.B3.D0.BB.D1.83.D0.B1.D0.B8.D0.BD.D0.B0_.D1.86.D0.B2.D0.B5.D1.82.D0.B0_.D0.BD.D0.B5_.D0.BC.D0.BE.D0.B6.D0.B5.D1.82_.D0.BF.D1.80.D0.B5.D0.B2.D1.8B.D1.88.D0.B0.D1.82.D1.8C_16_.D1.86.D0.B2.D0.B5.D1.82.D0.BE.D0.B2"></span><span class="mw-headline" id="WinXP:_глубина_цвета_не_может_превышать_16_цветов">WinXP: глубина цвета не может превышать 16 цветов</span>
</h3>
<p>Если Вы работаете в 16-битной глубине цвета, то значки будут отображаться некорректно. Тем не менее, при попытке изменить глубину цвета на более высокий уровень, система может ограничить вас с более низким разрешением или просто не позволит вам изменить глубину вообще. Чтобы это исправить, запустите <code>regedit</code> в Windows и добавьте следующий ключ реестра для виртуальной машины Windows XP:
</p>
<pre>[HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows NT\Terminal Services]
"ColorDepth"=dword:00000004
</pre>
<p>Затем обновите глубину цвета в "Свойствах рабочего стола". Если ничего не происходит, заставьте экран перерисоваться (например, нажмите<code>Host+f</code>).
</p>
<h3>
<span id=".D0.98.D1.81.D0.BF.D0.BE.D0.BB.D1.8C.D0.B7.D0.BE.D0.B2.D0.B0.D0.BD.D0.B8.D0.B5_.D0.BF.D0.BE.D1.81.D0.BB.D0.B5.D0.B4.D0.BE.D0.B2.D0.B0.D1.82.D0.B5.D0.BB.D1.8C.D0.BD.D1.8B.D1.85_.D0.BF.D0.BE.D1.80.D1.82.D0.BE.D0.B2_.D0.B2_.D0.B3.D0.BE.D1.81.D1.82.D0.B5.D0.B2.D0.BE.D0.B9_.D0.9E.D0.A1"></span><span class="mw-headline" id="Использование_последовательных_портов_в_гостевой_ОС">Использование последовательных портов в гостевой ОС</span>
</h3>
<p>Проверьте наличие прав для доступа к последовательным портам:
</p>
<pre>$ /bin/ls -l /dev/ttyS*
crw-rw---- 1 root uucp 4, 64 Feb  3 09:12 /dev/ttyS0
crw-rw---- 1 root uucp 4, 65 Feb  3 09:12 /dev/ttyS1
crw-rw---- 1 root uucp 4, 66 Feb  3 09:12 /dev/ttyS2
crw-rw---- 1 root uucp 4, 67 Feb  3 09:12 /dev/ttyS3
</pre>
<p>Добавьте пользователя в группу <code>uucp</code>
</p>
<pre># gpasswd -a $USER uucp 
</pre>
<p>и перелогиньтесь.
</p>
<h3>
<span id="Windows_8.x_.D0.BE.D1.88.D0.B8.D0.B1.D0.BA.D0.B0_0x000000C4"></span><span class="mw-headline" id="Windows_8.x_ошибка_0x000000C4">Windows 8.x ошибка 0x000000C4</span>
</h3>
<p>Если вы получаете этот код ошибки при загрузке, даже при выбранном типе OS Win 8, попробуйте включить инструкцию процессора <code>CMPXCHG16B</code>:
</p>
<pre>$ vboxmanage setextradata <i>virtual_machine_name</i> VBoxInternal/CPUM/CMPXCHG16B 1
</pre>
<h3>
<span id="Windows_8_VM_.D0.B2.D1.8B.D0.BB.D0.B5.D1.82.D0.B0.D0.B5.D1.82_.D0.BF.D1.80.D0.B8_.D0.B7.D0.B0.D0.B3.D1.80.D1.83.D0.B7.D0.BA.D0.B5_.D1.81_.D0.BE.D1.88.D0.B8.D0.B1.D0.BA.D0.BE.D0.B9_.22ERR_DISK_FULL.22"></span><span class="mw-headline" id='Windows_8_VM_вылетает_при_загрузке_с_ошибкой_"ERR_DISK_FULL"'>Windows 8 VM вылетает при загрузке с ошибкой "ERR_DISK_FULL"</span>
</h3>
<p>Если ваша Windows 8 не запускается, VirtualBox выдаёт ошибку что виртуальный диск заполнен, но тем не менее вы уверены что диск не является заполненным,
откройте настройки виртуальной машины <i>Настройки&gt;Память&gt;Контроллер: SATA</i> и выберите <i>Use Host I/O Cache</i>.
</p>
<h3>
<span id=".D0.93.D0.BE.D1.81.D1.82.D0.B5.D0.B2.D0.B0.D1.8F_.D0.9E.D0.A1_Linux_.D0.B2.D1.8B.D0.B4.D0.B0.D0.B5.D1.82_.D0.B8.D1.81.D0.BA.D0.B0.D0.B6.D1.91.D0.BD.D0.BD.D1.8B.D0.B9_.D0.B8.D0.BB.D0.B8_.D0.B7.D0.B0.D0.BF.D0.B0.D0.B7.D0.B4.D1.8B.D0.B2.D0.B0.D1.8E.D1.89.D0.B8.D0.B9_.D0.B7.D0.B2.D1.83.D0.BA"></span><span class="mw-headline" id="Гостевая_ОС_Linux_выдает_искажённый_или_запаздывающий_звук">Гостевая ОС Linux  выдает искажённый или запаздывающий звук</span>
</h3>
<p>Аудио драйвер AC97 в ядре linux иногда неправильно считывает время из  Virtual Box, что приводит к различным искажениям звука. Для исправления проблемы, создайте файл <code>/etc/modprobe.d</code> со следующим содержанием:
</p>
<pre>options snd-intel8x0 ac97_clock=48000
</pre>
<h3>
<span id=".D0.93.D0.BE.D1.81.D1.82.D0.B5.D0.B2.D0.B0.D1.8F_.D0.9E.D0.A1_.D0.B7.D0.B0.D0.B2.D0.B8.D1.81.D0.B0.D0.B5.D1.82_.D0.BF.D0.BE.D1.81.D0.BB.D0.B5_.D0.B7.D0.B0.D0.BF.D1.83.D1.81.D0.BA.D0.B0_Xorg"></span><span class="mw-headline" id="Гостевая_ОС_зависает_после_запуска_Xorg">Гостевая ОС зависает после запуска Xorg</span>
</h3>
<p>Неисправные или отсутствующие драйверы могут привести к остановке после запуска Xorg, см., например, <a rel="nofollow" class="external autonumber" href="https://bbs.archlinux.org/viewtopic.php?pid=1167838">[2]</a> и <a rel="nofollow" class="external autonumber" href="https://bbs.archlinux.org/viewtopic.PHP?ID=156079">[3]</a><sup>[<a href="https://en.wikipedia.org/wiki/Wikipedia:Link_rot" class="extiw" title="wikipedia:Wikipedia:Link rot">устаревшая ссылка</a> 2020-08-06]</sup>. Попробуйте отключить 3D-ускорение в <i>Настройки&gt; Дисплей</i>, и проверьте, все ли драйверы <a href="/title/Xorg" title="Xorg">Xorg</a> установлены.
</p>
<h3>
<span id=".D0.98.D1.81.D1.87.D0.B5.D0.B7.D0.BD.D0.BE.D0.B2.D0.B5.D0.BD.D0.B8.D0.B5_.D0.BF.D1.83.D0.BD.D0.BA.D1.82.D0.BE.D0.B2_.D0.BC.D0.B5.D0.BD.D1.8E_.D0.B8_.D0.BE.D1.88.D0.B8.D0.B1.D0.BA.D0.B0_.22NS_ERROR_FAILURE.22"></span><span class="mw-headline" id='Исчезновение_пунктов_меню_и_ошибка_"NS_ERROR_FAILURE"'>Исчезновение пунктов меню и ошибка "NS_ERROR_FAILURE"</span>
</h3>
<p>Если после первого запуска машины вы столкнулись с такой ошибкой:
</p>
<pre>Failed to open a session for the virtual machine debian.
Could not open the medium '/home/.../VirtualBox VMs/debian/debian.qcow'.
QCow: Reading the L1 table for image '/home/.../VirtualBox VMs/debian/debian.qcow' failed (VERR_EOF).
VD: error VERR_EOF opening image file '/home/.../VirtualBox VMs/debian/debian.qcow' (VERR_EOF).

Result Code: 
NS_ERROR_FAILURE (0x80004005)
Component: 
Medium
</pre>
<p>Выйдите из VirtualBox, удалите все файлы новой машины и из файла конфигурации VirtualBox удалите последнюю строку в  <code>MachineRegistry</code> меню:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">~/.config/VirtualBox/VirtualBox.xml</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">...
&lt;MachineRegistry&gt;
  &lt;MachineEntry uuid="{00000000-0000-0000-0000-000000000000}" src="/home/void/VirtualBox VMs/debian/debian.vbox"/&gt;
  &lt;MachineEntry uuid="{00000000-0000-0000-0000-000000000000}" src="/home/void/VirtualBox VMs/ubuntu/ubuntu.vbox"/&gt;
  <strike>&lt;MachineEntry uuid="{00000000-0000-0000-0000-000000000000}" src="/home/void/VirtualBox VMs/lastvmcausingproblems/lastvmcausingproblems.qcow"/&gt;</strike>
&lt;/MachineRegistry&gt;
...</pre>
<p>Это иногда происходит при выборе <i>QCOW</i>/<i>QCOW2</i>/<i>QED</i> формата виртуального диска.
</p>
<h3>
<span id=".22.D0.A3.D0.BA.D0.B0.D0.B7.D0.B0.D0.BD.D0.BD.D1.8B.D0.B9_.D0.BF.D1.83.D1.82.D1.8C_.D0.BD.D0.B5_.D1.81.D1.83.D1.89.D0.B5.D1.81.D1.82.D0.B2.D1.83.D0.B5.D1.82._.D0.9F.D1.80.D0.BE.D0.B2.D0.B5.D1.80.D1.8C.D1.82.D0.B5_.D0.BF.D1.83.D1.82.D1.8C_.D0.B8_.D0.BF.D0.BE.D0.BF.D1.80.D0.BE.D0.B1.D1.83.D0.B9.D1.82.D0.B5_.D0.B5.D1.89.D0.B5_.D1.80.D0.B0.D0.B7..22_.D0.9E.D1.88.D0.B8.D0.B1.D0.BA.D0.B0_.D0.B2_.D0.B3.D0.BE.D1.81.D1.82.D0.B5.D0.B2.D0.BE.D0.B9_.D0.9E.D0.A1_Windows"></span><span class="mw-headline" id='"Указанный_путь_не_существует._Проверьте_путь_и_попробуйте_еще_раз."_Ошибка_в_гостевой_ОС_Windows'>"Указанный путь не существует. Проверьте путь и попробуйте еще раз." Ошибка в гостевой ОС Windows</span>
</h3>
<p>Это сообщение об ошибке часто появляется при работе с расширением .exe  который требует привелегий администратора из общей папки в гостевой Windows. См. <a rel="nofollow" class="external text" href="https://www.virtualbox.org/ticket/5732">отчет об ошибке</a>.
</p>
<p>Есть несколько способов обойти ошибку:
</p>
<ol>
<li>Отключить UAC с помощью Панель управления -&gt; Центр поддержки -&gt; "Settings Change User Account Control" из левой боковой панели -&gt; Установить ползунок "Никогда не уведомлять» -&gt; OK и перезагрузить ОС</li>
<li>Скопируйте файл из папки общего доступа в гостевую ОС и запустите оттуда</li>
</ol>
<h3>
<span id=".D0.9D.D0.B5_.D1.80.D0.B0.D0.B1.D0.BE.D1.82.D0.B0.D1.8E.D1.82_64-.D0.B1.D0.B8.D1.82.D0.BD.D1.8B.D0.B5_.D0.B3.D0.BE.D1.81.D1.82.D0.B5.D0.B2.D1.8B.D0.B5_.D0.9E.D0.A1"></span><span class="mw-headline" id="Не_работают_64-битные_гостевые_ОС">Не работают 64-битные гостевые ОС</span>
</h3>
<p>При запуске клиента VM, если никакие 64-битные варианты не доступны, убедитесь что ваши возможности виртуализации процессора (обычно с именем <code>VT-X</code>) включены в BIOS.
</p>
<h3>
<span id=".D0.9E.D1.88.D0.B8.D0.B1.D0.BA.D0.B0_.22VT-x_is_not_available._.28VERR_VMX_NO_VMX.29.22_.D0.B8_.D0.BF.D1.80.D0.BE.D1.86.D0.B5.D1.81.D1.81.D0.BE.D1.80_.D0.B1.D0.B5.D0.B7_.D0.BF.D0.BE.D0.B4.D0.B4.D0.B5.D1.80.D0.B6.D0.BA.D0.B8_.D0.B2.D0.B8.D1.80.D1.82.D1.83.D0.B0.D0.BB.D0.B8.D0.B7.D0.B0.D1.86.D0.B8.D0.B8"></span><span class="mw-headline" id='Ошибка_"VT-x_is_not_available._(VERR_VMX_NO_VMX)"_и_процессор_без_поддержки_виртуализации'>Ошибка "VT-x is not available. (VERR_VMX_NO_VMX)" и процессор без поддержки виртуализации</span>
</h3>
<p>Начиная с версии 6.1.0 (<a rel="nofollow" class="external text" href="https://www.virtualbox.org/wiki/Changelog-6.1#v0">выпущенной 10 декабря 2019</a>), VirtualBox требует аппаратную поддержку виртуализации. Если же она отсутствует в процессоре, временным решением может быть установка более ранней версии VirtualBox, например, с помощью понижения версии пакета или установки <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://aur.archlinux.org/packages/virtualbox-bin-5/">virtualbox-bin-5</a></span><sup><small>AUR</small></sup>, однако работоспособность на свежих ядрах Linux не гарантируется.
</p>
<h2>
<span id=".D0.A1.D0.BC.D0.BE.D1.82.D1.80.D0.B8.D1.82.D0.B5_.D1.82.D0.B0.D0.BA.D0.B6.D0.B5"></span><span class="mw-headline" id="Смотрите_также">Смотрите также</span>
</h2>
<ul>
<li><a rel="nofollow" class="external text" href="https://www.virtualbox.org/manual/UserManual.html">Руководство пользователя VirtualBox</a></li>
<li><a rel="nofollow" class="external text" href="https://ru.wikipedia.org/wiki/VirtualBox">Википедия:VirtualBox</a></li>
</ul>
</div>
</div>
<div id="catlinks" class="catlinks" data-mw="interface">
<div id="mw-normal-catlinks" class="mw-normal-catlinks">
<a href="/title/Special:Categories" title="Special:Categories">Categories</a>: <ul>
<li><a href="/title/Category:Hypervisors_(%D0%A0%D1%83%D1%81%D1%81%D0%BA%D0%B8%D0%B9)" title="Category:Hypervisors (Русский)">Hypervisors (Русский)</a></li>
<li><a href="/title/Category:Oracle_(%D0%A0%D1%83%D1%81%D1%81%D0%BA%D0%B8%D0%B9)" title="Category:Oracle (Русский)">Oracle (Русский)</a></li>
</ul>
</div>
<div id="mw-hidden-catlinks" class="mw-hidden-catlinks mw-hidden-cats-hidden">Hidden categories: <ul>
<li><a href="/title/Category:Pages_with_broken_package_links" title="Category:Pages with broken package links">Pages with broken package links</a></li>
<li><a href="/title/Category:Pages_with_broken_section_links" title="Category:Pages with broken section links">Pages with broken section links</a></li>
</ul>
</div>
</div>
	</div>
</div>

<footer id="footer" class="mw-footer" role="contentinfo" style="margin: 0">
	<ul id="footer-info">
		<li>Retrieved from "<a dir="ltr" href="https://wiki.archlinux.org/index.php?title=VirtualBox_(%D0%A0%D1%83%D1%81%D1%81%D0%BA%D0%B8%D0%B9)&amp;oldid=669509">https://wiki.archlinux.org/index.php?title=VirtualBox_(Русский)&amp;oldid=669509</a>"</li>
		<li id="footer-info-lastmod"> This page was last edited on 8 May 2021, at 11:54.</li>
		<li id="footer-info-copyright">Content is available under <a class="external" rel="nofollow" href="http://www.gnu.org/copyleft/fdl.html">GNU Free Documentation License 1.3 or later</a> unless otherwise noted.</li>
	<br>
</ul>
	<ul id="footer-places">
		<li id="footer-places-privacy"><a href="/title/ArchWiki:Privacy_policy" title="ArchWiki:Privacy policy">Privacy policy</a></li>
		<li id="footer-places-about"><a href="/title/ArchWiki:About" title="ArchWiki:About">About ArchWiki</a></li>
		<li id="footer-places-disclaimer"><a href="/title/ArchWiki:General_disclaimer" title="ArchWiki:General disclaimer">Disclaimers</a></li>
	</ul>
	<ul id="footer-icons" class="noprint">
		<li id="footer-copyrightico">
	</ul>
	<div style="clear: both;"></div>
</footer>



</body>
</html>
