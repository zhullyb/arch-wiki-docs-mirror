<!DOCTYPE html>
<html class="client-nojs" lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<title>Archiso (Русский) - ArchWiki</title>
<link rel="stylesheet" href="../ArchWikiOffline.css">
<meta name="ResourceLoaderDynamicStyles" content="">
<meta name="generator" content="MediaWiki 1.35.0">
<meta name="robots" content="noindex,follow">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="shortcut icon" href="/favicon.ico">
<link rel="search" type="application/opensearchdescription+xml" href="/opensearch_desc.php" title="ArchWiki (en)">
<link rel="EditURI" type="application/rsd+xml" href="https://wiki.archlinux.org/api.php?action=rsd">
<link rel="license" href="http://www.gnu.org/copyleft/fdl.html">
<link rel="alternate" type="application/atom+xml" title="ArchWiki Atom feed" href="/index.php?title=Special:RecentChanges&amp;feed=atom">
</head>
<body class="mediawiki ltr sitedir-ltr mw-hide-empty-elt ns-0 ns-subject page-Archiso_Русский rootpage-Archiso_Русский skin-vector action-view skin-vector-legacy">
<div id="content" class="mw-body" role="main" style="margin: 0">
	<a id="top"></a>
	<div id="siteNotice" class="mw-body-content"></div>
	<div class="mw-indicators mw-body-content">
	</div>
	<h1 id="firstHeading" class="firstHeading" lang="en">Archiso (Русский)</h1>
	<div id="bodyContent" class="mw-body-content">
		<div id="siteSub" class="noprint">From ArchWiki</div>
		<div id="contentSub"></div>
		<div id="contentSub2"></div>
		
		<div id="jump-to-nav"></div>
		<a class="mw-jump-link" href="#mw-head">Jump to navigation</a>
		<a class="mw-jump-link" href="#searchInput">Jump to search</a>
		<div id="mw-content-text" lang="en" dir="ltr" class="mw-content-ltr">
<div class="warningbox">The printable version is no longer supported and may have rendering errors. Please update your browser bookmarks and please use the default browser print function instead.</div>
<div class="mw-parser-output">
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Состояние перевода:</strong> На этой странице представлен перевод статьи <a href="../en/Archiso.html" title="Archiso">Archiso</a>. Дата последней синхронизации: 19 декабря 2018. Вы можете <a href="../ru/ArchWiki:Translation_Team.html" title="ArchWiki:Translation Team (Русский)">помочь</a> синхронизировать перевод, если в английской версии произошли <a rel="nofollow" class="external text" href="https://wiki.archlinux.org/index.php?title=Archiso&amp;diff=0&amp;oldid=559444">изменения</a>.</div>
<div class="archwiki-template-meta-related-articles-start">
<p>Ссылки по теме</p>
<ul>
<li><a href="../ru/Archiso.html" class="mw-redirect" title="Ремастеринг установочного ISO-образа">Ремастеринг установочного ISO-образа</a></li>
<li><a href="../ru/Preboot_Execution_Environment.html" class="mw-redirect" title="PXE (Русский)">PXE (Русский)</a></li>
<li><a href="../ru/Archboot.html" title="Archboot (Русский)">Archboot (Русский)</a></li>
<li><a href="../ru/Offline_installation.html" class="mw-redirect" title="Установка без подключения к Интернету">Установка без подключения к Интернету</a></li>
</ul>
</div>
<p><b>Archiso</b> — набор bash скриптов, предназначенных для создания полностью функциональных Live-CD/DVD и Live-USB на базе Arch Linux. Это тот же инструмент, который используется для создания официальных образов, но он довольно гибкий инструмент, который может быть использован как для создания дисков восстановления или установочных, так и для специализированных live-CD/DVD/USB систем. Сердце Archiso — <i>mkarchiso</i>. Для получения подробного описания всех его опций достаточно вызвать его без параметров, так что здесь будет описанно только создание live диска своими руками.
</p>
<p>Если вам требуется только краткое изложение требований и процесса сборки, вы можете также воспользоваться <a rel="nofollow" class="external text" href="https://gitlab.archlinux.org/archlinux/archiso/tree/master/docs">официальной документацией проекта</a>. 
</p>
<div id="toc" class="toc" role="navigation" aria-labelledby="mw-toc-heading">
<input type="checkbox" role="button" id="toctogglecheckbox" class="toctogglecheckbox" style="display:none"><div class="toctitle" lang="en" dir="ltr">
<h2 id="mw-toc-heading">Contents</h2>
<span class="toctogglespan"><label class="toctogglelabel" for="toctogglecheckbox"></label></span>
</div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#%D0%A3%D1%81%D1%82%D0%B0%D0%BD%D0%BE%D0%B2%D0%BA%D0%B0"><span class="tocnumber">1</span> <span class="toctext">Установка</span></a></li>
<li class="toclevel-1 tocsection-2">
<a href="#%D0%9D%D0%B0%D1%81%D1%82%D1%80%D0%BE%D0%B9%D0%BA%D0%B0_live_%D0%BD%D0%BE%D1%81%D0%B8%D1%82%D0%B5%D0%BB%D1%8F"><span class="tocnumber">2</span> <span class="toctext">Настройка live носителя</span></a>
<ul>
<li class="toclevel-2 tocsection-3">
<a href="#%D0%A3%D1%81%D1%82%D0%B0%D0%BD%D0%BE%D0%B2%D0%BA%D0%B0_%D0%BF%D0%B0%D0%BA%D0%B5%D1%82%D0%BE%D0%B2"><span class="tocnumber">2.1</span> <span class="toctext">Установка пакетов</span></a>
<ul>
<li class="toclevel-3 tocsection-4"><a href="#%D0%A1%D0%BE%D0%B1%D1%81%D1%82%D0%B2%D0%B5%D0%BD%D0%BD%D1%8B%D0%B9_%D0%BB%D0%BE%D0%BA%D0%B0%D0%BB%D1%8C%D0%BD%D1%8B%D0%B9_%D1%80%D0%B5%D0%BF%D0%BE%D0%B7%D0%B8%D1%82%D0%BE%D1%80%D0%B8%D0%B9"><span class="tocnumber">2.1.1</span> <span class="toctext">Собственный локальный репозиторий</span></a></li>
<li class="toclevel-3 tocsection-5"><a href="#%D0%9F%D1%80%D0%B5%D0%B4%D0%BE%D1%82%D0%B2%D1%80%D0%B0%D1%89%D0%B5%D0%BD%D0%B8%D0%B5_%D1%83%D1%81%D1%82%D0%B0%D0%BD%D0%BE%D0%B2%D0%BA%D0%B8_%D0%BF%D0%B0%D0%BA%D0%B5%D1%82%D0%BE%D0%B2,_%D0%BF%D1%80%D0%B8%D0%BD%D0%B0%D0%B4%D0%BB%D0%B5%D0%B6%D0%B0%D1%89%D0%B8%D1%85_%D0%BE%D1%81%D0%BD%D0%BE%D0%B2%D0%BD%D0%BE%D0%B9_%D0%B3%D1%80%D1%83%D0%BF%D0%BF%D0%B5"><span class="tocnumber">2.1.2</span> <span class="toctext">Предотвращение установки пакетов, принадлежащих основной группе</span></a></li>
<li class="toclevel-3 tocsection-6"><a href="#%D0%A3%D1%81%D1%82%D0%B0%D0%BD%D0%BE%D0%B2%D0%BA%D0%B0_%D0%BF%D0%B0%D0%BA%D0%B5%D1%82%D0%BE%D0%B2_%D0%B8%D0%B7_multilib"><span class="tocnumber">2.1.3</span> <span class="toctext">Установка пакетов из multilib</span></a></li>
</ul>
</li>
<li class="toclevel-2 tocsection-7"><a href="#%D0%94%D0%BE%D0%B1%D0%B0%D0%B2%D0%BB%D0%B5%D0%BD%D0%B8%D0%B5_%D1%84%D0%B0%D0%B9%D0%BB%D0%BE%D0%B2_%D0%B2_%D0%BE%D0%B1%D1%80%D0%B0%D0%B7"><span class="tocnumber">2.2</span> <span class="toctext">Добавление файлов в образ</span></a></li>
<li class="toclevel-2 tocsection-8">
<a href="#%D0%97%D0%B0%D0%B3%D1%80%D1%83%D0%B7%D1%87%D0%B8%D0%BA"><span class="tocnumber">2.3</span> <span class="toctext">Загрузчик</span></a>
<ul>
<li class="toclevel-3 tocsection-9"><a href="#UEFI_Secure_Boot"><span class="tocnumber">2.3.1</span> <span class="toctext">UEFI Secure Boot</span></a></li>
</ul>
</li>
<li class="toclevel-2 tocsection-10"><a href="#%D0%92%D1%85%D0%BE%D0%B4_%D0%B2_%D1%81%D0%B8%D1%81%D1%82%D0%B5%D0%BC%D1%83"><span class="tocnumber">2.4</span> <span class="toctext">Вход в систему</span></a></li>
<li class="toclevel-2 tocsection-11"><a href="#%D0%98%D0%B7%D0%BC%D0%B5%D0%BD%D0%B5%D0%BD%D0%B8%D0%B5_%D0%B0%D0%B2%D1%82%D0%BE%D0%BC%D0%B0%D1%82%D0%B8%D1%87%D0%B5%D1%81%D0%BA%D0%BE%D0%B3%D0%BE_%D0%B2%D1%85%D0%BE%D0%B4%D0%B0_%D0%B2_%D1%81%D0%B8%D1%81%D1%82%D0%B5%D0%BC%D1%83"><span class="tocnumber">2.5</span> <span class="toctext">Изменение автоматического входа в систему</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-12">
<a href="#%D0%A1%D0%B1%D0%BE%D1%80%D0%BA%D0%B0_ISO"><span class="tocnumber">3</span> <span class="toctext">Сборка ISO</span></a>
<ul>
<li class="toclevel-2 tocsection-13"><a href="#%D0%9F%D0%B5%D1%80%D0%B5%D1%81%D0%B1%D0%BE%D1%80%D0%BA%D0%B0_ISO"><span class="tocnumber">3.1</span> <span class="toctext">Пересборка ISO</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-14"><a href="#%D0%98%D1%81%D0%BF%D0%BE%D0%BB%D1%8C%D0%B7%D0%BE%D0%B2%D0%B0%D0%BD%D0%B8%D0%B5_ISO"><span class="tocnumber">4</span> <span class="toctext">Использование ISO</span></a></li>
<li class="toclevel-1 tocsection-15">
<a href="#%D0%A1%D0%BC%D0%BE%D1%82%D1%80%D0%B8%D1%82%D0%B5_%D1%82%D0%B0%D0%BA%D0%B6%D0%B5"><span class="tocnumber">5</span> <span class="toctext">Смотрите также</span></a>
<ul>
<li class="toclevel-2 tocsection-16"><a href="#%D0%94%D0%BE%D0%BA%D1%83%D0%BC%D0%B5%D0%BD%D1%82%D0%B0%D1%86%D0%B8%D1%8F_%D0%B8_%D1%83%D1%87%D0%B5%D0%B1%D0%BD%D1%8B%D0%B5_%D0%BF%D0%BE%D1%81%D0%BE%D0%B1%D0%B8%D1%8F"><span class="tocnumber">5.1</span> <span class="toctext">Документация и учебные пособия</span></a></li>
<li class="toclevel-2 tocsection-17"><a href="#%D0%9F%D1%80%D0%B8%D0%BC%D0%B5%D1%80%D1%8B_%D1%88%D0%B0%D0%B1%D0%BB%D0%BE%D0%BD%D0%BE%D0%B2_%D0%BD%D0%B0%D1%81%D1%82%D1%80%D0%BE%D0%B9%D0%BA%D0%B8"><span class="tocnumber">5.2</span> <span class="toctext">Примеры шаблонов настройки</span></a></li>
<li class="toclevel-2 tocsection-18"><a href="#%D0%A1%D0%BE%D0%B7%D0%B4%D0%B0%D0%BD%D0%B8%D0%B5_%D0%B0%D0%B2%D1%82%D0%BE%D0%BD%D0%BE%D0%BC%D0%BD%D0%BE%D0%B3%D0%BE_%D1%83%D1%81%D1%82%D0%B0%D0%BD%D0%BE%D0%B2%D0%BE%D1%87%D0%BD%D0%BE%D0%B3%D0%BE_ISO"><span class="tocnumber">5.3</span> <span class="toctext">Создание автономного установочного ISO</span></a></li>
</ul>
</li>
</ul>
</div>

<h2>
<span id=".D0.A3.D1.81.D1.82.D0.B0.D0.BD.D0.BE.D0.B2.D0.BA.D0.B0"></span><span class="mw-headline" id="Установка">Установка</span>
</h2>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Примечание:</strong> Рекомендуется действовать с правами суперпользователем во всех последующих шагах. В противном случае возможны проблемы позже с ложными разрешениями.</div>
<p>Прежде чем начать, <a href="../ru/Help:Reading.html#%D0%A3%D1%81%D1%82%D0%B0%D0%BD%D0%BE%D0%B2%D0%BA%D0%B0_%D0%BF%D0%B0%D0%BA%D0%B5%D1%82%D0%BE%D0%B2" class="mw-redirect" title="Установите">установите</a> пакет <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=archiso">archiso</a></span> или <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://aur.archlinux.org/packages/archiso-git/">archiso-git</a></span><sup><small>AUR</small></sup>.
</p>
<p>Archiso поставляется с двумя "профилями": <i>releng</i> и <i>baseline</i>.
</p>
<ul>
<li>Если вы хотите создать полностью индивидуальную версию Arch Linux, предварительно установленной со всеми вашими любимыми программами и конфигурациями, используйте профиль <i>releng</i>.</li>
<li>Если вы просто хотите создать основу для live CD, без предварительно установленных пакетов и минимальной конфигурацией, используйте <i>baseline</i>.</li>
</ul>
<p>Теперь скопируйте профиль на Ваш выбор, в каталог (<code>~/archlive</code> используется в примере ниже), в котором вы можете вносить корректировки. Выполните следующую команду, заменив <code><b>profile</b></code> либо на <code>releng</code>, либо на <code>baseline</code>.
</p>
<pre># cp -r /usr/share/archiso/configs/<b>profile</b>/ <i>archlive</i>
</pre>
<ul>
<li>Если вы используете профиль <code>releng</code> для создания полностью индивидуального образа, вы можете переходить к секции <a href="#%D0%9D%D0%B0%D1%81%D1%82%D1%80%D0%BE%D0%B9%D0%BA%D0%B0_live_%D0%BD%D0%BE%D1%81%D0%B8%D1%82%D0%B5%D0%BB%D1%8F">#Настройка live носителя</a>.</li>
<li>Если вы используете профиль <code>baseline</code> для создания пустого образа, то вам не нужно его настраивать, поэтому переходите к секции <a href="#%D0%A1%D0%B1%D0%BE%D1%80%D0%BA%D0%B0_ISO">#Сборка ISO</a>.</li>
</ul>
<h2>
<span id=".D0.9D.D0.B0.D1.81.D1.82.D1.80.D0.BE.D0.B9.D0.BA.D0.B0_live_.D0.BD.D0.BE.D1.81.D0.B8.D1.82.D0.B5.D0.BB.D1.8F"></span><span class="mw-headline" id="Настройка_live_носителя">Настройка live носителя</span>
</h2>
<p>В этом разделе подробно описывается настройка создаваемого вами образа, определение пакетов и конфигураций, которые вы хотите, чтобы ваш live образ содержал.
</p>
<p>Внутри каталога <code><i>archlive</i></code>, созданного в <a href="#%D0%A3%D1%81%D1%82%D0%B0%D0%BD%D0%BE%D0%B2%D0%BA%D0%B0">#Установка</a>, имеется ряд файлов и каталогов; мы рассмотрим лишь несколько из них, в основном: 
</p>
<ul>
<li>
<code>packages.x86_64</code> — это где вы перечисляете построчно пакеты, которые вы хотите установить, и</li>
<li>каталог <code>airootfs</code> — это каталог, действующий как наложение, и именно там вы делаете все настройки.</li>
</ul>
<p>Как правило, любые административные задачи, которые вы обычно делаете после новой установки, могут быть выполнены в скрипте <code><i>archlive</i>/airootfs/root/customize_airootfs.sh</code>, за исключением установки пакетов. Скрипт должен быть написан с точки зрения новой среды, поэтому <code>/</code> в скрипте означает корень ISO-образа, который создается.
</p>
<h3>
<span id=".D0.A3.D1.81.D1.82.D0.B0.D0.BD.D0.BE.D0.B2.D0.BA.D0.B0_.D0.BF.D0.B0.D0.BA.D0.B5.D1.82.D0.BE.D0.B2"></span><span class="mw-headline" id="Установка_пакетов">Установка пакетов</span>
</h3>
<p>Отредактируйте списки пакетов в <code>packages.x86_64</code> чтобы указать, какие пакеты должны быть установлены на live носителе.
</p>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Примечание:</strong> Если вы хотите использовать <a href="../ru/Window_manager.html" class="mw-redirect" title="Оконный менеджер">оконный менеджер</a> в Live CD, то вы должны добавить необходимые и правильные <a href="../ru/Xorg.html#%D0%A3%D1%81%D1%82%D0%B0%D0%BD%D0%BE%D0%B2%D0%BA%D0%B0_%D0%B4%D1%80%D0%B0%D0%B9%D0%B2%D0%B5%D1%80%D0%B0" class="mw-redirect" title="Видео драйвера">видео драйвера</a>, или WM может зависнуть при загрузке.</div>
<h4>
<span id=".D0.A1.D0.BE.D0.B1.D1.81.D1.82.D0.B2.D0.B5.D0.BD.D0.BD.D1.8B.D0.B9_.D0.BB.D0.BE.D0.BA.D0.B0.D0.BB.D1.8C.D0.BD.D1.8B.D0.B9_.D1.80.D0.B5.D0.BF.D0.BE.D0.B7.D0.B8.D1.82.D0.BE.D1.80.D0.B8.D0.B9"></span><span class="mw-headline" id="Собственный_локальный_репозиторий">Собственный локальный репозиторий</span>
</h4>
<div class="noprint archwiki-template-message">
<p><a href="../File:Merge-arrows-2.png" class="image"><img alt="Merge-arrows-2.png" src="../File:Merge-arrows-2.png" decoding="async" width="48" height="48"></a><b>This article or section is a candidate for merging with <a href="../ru/9162c98b104d744ec851c6ccfd816dd7.html#%D0%A1%D0%BE%D0%B1%D1%81%D1%82%D0%B2%D0%B5%D0%BD%D0%BD%D1%8B%D0%B9_%D0%BB%D0%BE%D0%BA%D0%B0%D0%BB%D1%8C%D0%BD%D1%8B%D0%B9_%D1%80%D0%B5%D0%BF%D0%BE%D0%B7%D0%B8%D1%82%D0%BE%D1%80%D0%B8%D0%B9" class="mw-redirect" title="Pacman/Tips and tricks (Русский)">Pacman/Tips and tricks (Русский)#Собственный локальный репозиторий</a>.</b><a href="../File:Merge-arrows-2.png" class="image"><img alt="Merge-arrows-2.png" src="../File:Merge-arrows-2.png" decoding="async" width="48" height="48"></a></p>
<div>
<b>Notes:</b> Переместите общую информацию (например, дерево репо) в основную статью. (Discuss in <a rel="nofollow" class="external text" href="https://wiki.archlinux.org/index.php/Talk:Archiso_(%D0%A0%D1%83%D1%81%D1%81%D0%BA%D0%B8%D0%B9)">Talk:Archiso (Русский)#</a>)</div>
</div>
<p>Для подготовки своих пакетов или пакетов из <a href="../ru/Arch_User_Repository.html" class="mw-redirect" title="AUR (Русский)">AUR</a>/<a href="../ru/Arch_Build_System.html" title="Arch Build System (Русский)">ABS</a>, вы можете <a href="../ru/9162c98b104d744ec851c6ccfd816dd7.html#%D0%A1%D0%BE%D0%B1%D1%81%D1%82%D0%B2%D0%B5%D0%BD%D0%BD%D1%8B%D0%B9_%D0%BB%D0%BE%D0%BA%D0%B0%D0%BB%D1%8C%D0%BD%D1%8B%D0%B9_%D1%80%D0%B5%D0%BF%D0%BE%D0%B7%D0%B8%D1%82%D0%BE%D1%80%D0%B8%D0%B9" class="mw-redirect" title="Pacman/Tips and tricks (Русский)">создать собственный локальный репозиторий</a>. Если вам нужна поддержка нескольких архитектур, примените соответствующие меры для предотвращения ошибок в будущем. Каждая архитектура должна иметь собственное дерево каталогов:
</p>
<p>Например:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">$ tree ~/customrepo/ | sed "s/$(uname -m)/&lt;arch&gt;/g"</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">/home/archie/customrepo/
└── &lt;arch&gt;
    ├── customrepo.db -&gt; customrepo.db.tar.xz
    ├── customrepo.db.tar.xz
    ├── customrepo.files -&gt; customrepo.files.tar.xz
    ├── customrepo.files.tar.xz
    └── personal-website-git-b99cce0-1-&lt;arch&gt;.pkg.tar.xz

1 directory, 5 files
</pre>
<p>Затем вы можете добавить свой репозиторий, поместив следующее в <code>~/archlive/pacman.conf</code> выше других записей (для более высокого приоритета):
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">~/archlive/pacman.conf</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">...
 # Свой (пользовательский) репозиторий
 [customrepo]
 SigLevel = Optional TrustAll
 Server = file:///home/<b>пользователь</b>/customrepo/$arch
...</pre>
<p>Если пакет подходит, <i>repo-add</i> выполняет проверку. Иначе, вы столкнетесь с сообщениями об ошибках, подобными этому:
</p>
<pre>==&gt; ERROR: '/home/archie/customrepo/&lt;arch&gt;/foo-&lt;arch&gt;.pkg.tar.xz' does not have a valid database archive extension.
</pre>
<h4>
<span id=".D0.9F.D1.80.D0.B5.D0.B4.D0.BE.D1.82.D0.B2.D1.80.D0.B0.D1.89.D0.B5.D0.BD.D0.B8.D0.B5_.D1.83.D1.81.D1.82.D0.B0.D0.BD.D0.BE.D0.B2.D0.BA.D0.B8_.D0.BF.D0.B0.D0.BA.D0.B5.D1.82.D0.BE.D0.B2.2C_.D0.BF.D1.80.D0.B8.D0.BD.D0.B0.D0.B4.D0.BB.D0.B5.D0.B6.D0.B0.D1.89.D0.B8.D1.85_.D0.BE.D1.81.D0.BD.D0.BE.D0.B2.D0.BD.D0.BE.D0.B9_.D0.B3.D1.80.D1.83.D0.BF.D0.BF.D0.B5"></span><span class="mw-headline" id="Предотвращение_установки_пакетов,_принадлежащих_основной_группе">Предотвращение установки пакетов, принадлежащих основной группе</span>
</h4>
<p>По умолчанию <code>/usr/bin/mkarchiso</code>, скрипт, который используется <code>~/archlive/build.sh</code>, вызывает один из скриптов <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=arch-install-scripts">arch-install-scripts</a></span> с именем <code>pacstrap</code> без флага <code>-i</code>, что заставляет <a href="../ru/Pacman.html" title="Pacman (Русский)">Pacman</a> не ждать ввода пользователя во время процесса установки.
</p>
<p>При внесении в черный список основных пакетов группы путем добавления их в строку <code>IgnorePkg</code> в файле <code>~/archlive/pacman.conf</code>, <a href="../ru/Pacman.html" title="Pacman (Русский)">Pacman</a> спрашивает, должны ли они все еще быть установлены, а это значит, что они будут при обходе ввода пользователя. Чтобы избавиться от этих пакетов существует несколько вариантов:
</p>
<ul><li>
<b>"Грязный" способ</b>: Добавьте флаг <code>-i</code> в каждую строку, вызывающую <code>pacstrap</code> в <code>/usr/bin/mkarchiso</code>.</li></ul>
<ul><li>
<b>"Чистый"</b>: Создайте копию <code>/usr/bin/mkarchiso</code>, в которую вы добавите флаг и адаптируете <code>~/archlive/build.sh</code>, так чтобы он вызывал измененную версию скрипта mkarchiso.</li></ul>
<ul><li>
<b>Расширенный способ</b>: Создайте функцию для <code>~/archlive/build.sh</code>, которая явно удаляет пакеты после основной установки. Это принесет вам удовольствие от того, что вам не придется много вводить во время процесса установки.</li></ul>
<h4>
<span id=".D0.A3.D1.81.D1.82.D0.B0.D0.BD.D0.BE.D0.B2.D0.BA.D0.B0_.D0.BF.D0.B0.D0.BA.D0.B5.D1.82.D0.BE.D0.B2_.D0.B8.D0.B7_multilib"></span><span class="mw-headline" id="Установка_пакетов_из_multilib">Установка пакетов из multilib</span>
</h4>
<p>Чтобы установить пакеты из репозитория <a href="../ru/Official_repositories.html#multilib" class="mw-redirect" title="Multilib (Русский)">multilib</a>, вам нужно просто раскомментировать его в <code>~/archlive/pacman.conf</code>:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">pacman.conf</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">[multilib]
SigLevel = PackageRequired
Include = /etc/pacman.d/mirrorlist</pre>
<h3>
<span id=".D0.94.D0.BE.D0.B1.D0.B0.D0.B2.D0.BB.D0.B5.D0.BD.D0.B8.D0.B5_.D1.84.D0.B0.D0.B9.D0.BB.D0.BE.D0.B2_.D0.B2_.D0.BE.D0.B1.D1.80.D0.B0.D0.B7"></span><span class="mw-headline" id="Добавление_файлов_в_образ">Добавление файлов в образ</span>
</h3>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Примечание:</strong> Для этого вы должны быть суперпользователем, не изменяйте владельца для какого-либо скопированного вами файла, <b>все</b> в каталоге airootfs должно принадлежать суперпользователю. Правильные владельцы будут установлены в ближайшее время.</div>
<p>Каталог airootfs действует как наложение, считайте его корневым каталогом '/' в вашей текущей системе, поэтому любые файлы, которые вы размещаете в этом каталоге, будут скопированы при загрузке.
</p>
<p>Поэтому, если у вас есть набор скриптов iptables в вашей текущей системе, которые вы хотите использовать на вашем live образe, скопируйте их:
</p>
<pre># cp -r /etc/iptables ~/archlive/airootfs/etc
</pre>
<p>Размещение файлов в домашнем каталоге пользователей немного отличается. Не помещайте их в <code>airootfs/home</code>, а вместо этого создайте каталог skel внутри <code>airootfs/</code> и разместите их там. Затем мы добавим соответствующие команды в <code>customize_airootfs.sh</code>, которые мы собираемся использовать для их копирования при загрузке и выяснения разрешений.
</p>
<p>Сначала создайте каталог skel:
</p>
<pre># mkdir ~/archlive/airootfs/etc/skel
</pre>
<p>Теперь скопируйте файлы 'home' в каталог skel, например для <code>.bashrc</code>:
</p>
<pre># cp ~/.bashrc ~/archlive/airootfs/etc/skel/
</pre>
<p>Когда выполняется <code>~/archlive/airootfs/root/customize_airootfs.sh</code>, и создается новый пользователь, файлы из каталога skel будут автоматически скопированы в новую домашнюю папку, а разрешения будут установлены правильно.
</p>
<p>Аналогичным образом, требуется обратить внимание на особые файлы конфигурации, которые находятся где-то внизу по иерархии. В качестве примера конфигурационный файл <code>/etc/X11/xinit/xinitrc</code> находится на пути, который может быть перезаписан путем установки пакета. Чтобы поместить файл конфигурации, следует поместить пользовательский <code>xinitrc</code> в <code>~/archlive/airootfs/etc/skel/</code>, а затем изменить <code>customize_airootfs.sh</code>, чтобы переместить его соответствующим образом.
</p>
<h3>
<span id=".D0.97.D0.B0.D0.B3.D1.80.D1.83.D0.B7.D1.87.D0.B8.D0.BA"></span><span class="mw-headline" id="Загрузчик">Загрузчик</span>
</h3>
<p>Файл по умолчанию должен работать прекрасно, поэтому вам не нужно трогать его.
</p>
<p>Из-за модульной природы isolinux вы можете использовать множество дополнений, так как все *.c32 файлы копируются и доступны вам. Посмотрите <a rel="nofollow" class="external text" href="http://syslinux.zytor.com/wiki/index.php/SYSLINUX">официальный сайт syslinux</a> и <a rel="nofollow" class="external text" href="https://projects.archlinux.org/archiso.git/tree/configs/syslinux-iso/boot-files">репозиторий git archiso</a><sup>[<a href="https://en.wikipedia.org/wiki/Wikipedia:Link_rot" class="extiw" title="wikipedia:Wikipedia:Link rot">устаревшая ссылка</a> 2020-08-02]</sup>. Используя указанные аддоны, можно сделать визуально привлекательные и сложные меню. Для получения дополнительной информации смотрите <a rel="nofollow" class="external text" href="http://syslinux.zytor.com/wiki/index.php/Comboot/menu.c32">здесь</a>.
</p>
<h4><span class="mw-headline" id="UEFI_Secure_Boot">UEFI Secure Boot</span></h4>
<p>Если вы хотите загружать Archiso в окружении с включённым UEFI Secure Boot, вы должны использовать подписанный загрузчик. Вы можете воспользоваться инструкциями из статьи <a href="../en/Unified_Extensible_Firmware_Interface/Secure_Boot.html#Booting_an_installation_medium" class="mw-redirect" title="Secure Boot">Secure Boot#Booting an installation medium</a>.
</p>
<h3>
<span id=".D0.92.D1.85.D0.BE.D0.B4_.D0.B2_.D1.81.D0.B8.D1.81.D1.82.D0.B5.D0.BC.D1.83"></span><span class="mw-headline" id="Вход_в_систему">Вход в систему</span>
</h3>
<p>Запуск X при загрузке выполняется путем включения службы <a href="../ru/Systemd.html" title="Systemd (Русский)">systemd</a> менеджера входа в систему. Если вы знаете, какой файл .service нуждается в символической ссылке: Отлично. Если нет, то вы можете легко узнать в случае, если вы используете одну и ту же программу в системе, в которой вы собираете свой iso. Просто используйте:
</p>
<pre>$ ls -l /etc/systemd/system/display-manager.service
</pre>
<p>Теперь создайте ту же самую символическую ссылку в <code>~/archlive/airootfs/etc/systemd/system</code>. Для LXDM:
</p>
<pre># ln -s /usr/lib/systemd/system/lxdm.service ~/archlive/airootfs/etc/systemd/system/display-manager.service
</pre>
<p>Это позволяeт запустить LXDM при загрузке системы из вашего live образа.
</p>
<p>В качестве альтернативы вы можете просто включить службу в <code>airootfs/root/customize_airootfs.sh</code> вместе с другими включенными там службами.
</p>
<p>Если вы хотите, чтобы графическая среда фактически запускалась автоматически во время загрузки, обязательно отредактируйте <code>airootfs/root/customize_airootfs.sh</code> и замените 
</p>
<pre>systemctl set-default multi-user.target
</pre>
<p>на
</p>
<pre>systemctl set-default graphical.target
</pre>
<h3>
<span id=".D0.98.D0.B7.D0.BC.D0.B5.D0.BD.D0.B5.D0.BD.D0.B8.D0.B5_.D0.B0.D0.B2.D1.82.D0.BE.D0.BC.D0.B0.D1.82.D0.B8.D1.87.D0.B5.D1.81.D0.BA.D0.BE.D0.B3.D0.BE_.D0.B2.D1.85.D0.BE.D0.B4.D0.B0_.D0.B2_.D1.81.D0.B8.D1.81.D1.82.D0.B5.D0.BC.D1.83"></span><span class="mw-headline" id="Изменение_автоматического_входа_в_систему">Изменение автоматического входа в систему</span>
</h3>
<p>Файлы настроек автоматического входа для getty расположены в <code>airootfs/etc/systemd/system/getty@tty1.service.d/autologin.conf</code>.
</p>
<p>Вы можете отредактировать этот файл для изменения автоматического входа пользователя в систему:
</p>
<pre>[Service]
ExecStart=
ExecStart=-/sbin/agetty --autologin <b>isouser</b> --noclear %I 38400 linux
</pre>
<p>Или удалите его вообще для отключения автоматического входа в систему.
</p>
<h2>
<span id=".D0.A1.D0.B1.D0.BE.D1.80.D0.BA.D0.B0_ISO"></span><span class="mw-headline" id="Сборка_ISO">Сборка ISO</span>
</h2>
<p>Теперь вы готовы превратить ваши файлы в .iso, которые вы можете записать на CD или USB:
</p>
<p>Сначала создайте каталог <code>out/</code>,
</p>
<pre># mkdir ~/archlive/out/
</pre>
<p>Затем внутри <code>~/archlive</code> выполните:
</p>
<pre># ./build.sh -v
</pre>
<p>Теперь скрипт загрузит и установит пакеты, указанные в <code>work/*/airootfs</code>, создаст ядро и инициализирует образы, применит ваши настройки и, наконец, создаст iso в <code>out/</code>.
</p>
<h3>
<span id=".D0.9F.D0.B5.D1.80.D0.B5.D1.81.D0.B1.D0.BE.D1.80.D0.BA.D0.B0_ISO"></span><span class="mw-headline" id="Пересборка_ISO">Пересборка ISO</span>
</h3>
<p>Пересборка iso после изменений официально не поддерживается. Однако это легко осуществить, применив два шага. Сначала вам нужно удалить файлы блокировки в рабочем каталоге:
</p>
<pre># rm -v work/build.make_*
</pre>
<p>Кроме того, требуется отредактировать скрипт <code>airootfs/root/customize_airootfs.sh</code>, и добавить команду <code>id</code> в начале строки <code>useradd</code>, как показано здесь. В противном случае пересборка останавливается на этом моменте, потому что пользователь, который должен быть добавлен, уже существует <a rel="nofollow" class="external text" href="https://bugs.archlinux.org/task/41865">FS#41865</a>.
</p>
<div class="noprint archwiki-template-message">
<p><a href="../File:Tango-edit-clear.png" class="image"><img alt="Tango-edit-clear.png" src="../File:Tango-edit-clear.png" decoding="async" width="48" height="48"></a><b>This article or section needs language, wiki syntax or style improvements. See <a href="../en/Help:Style.html" title="Help:Style">Help:Style</a> for reference.</b><a href="../File:Tango-edit-clear.png" class="image"><img alt="Tango-edit-clear.png" src="../File:Tango-edit-clear.png" decoding="async" width="48" height="48"></a></p>
<div>
<b>Reason:</b> Опечатка? (Discuss in <a rel="nofollow" class="external text" href="https://wiki.archlinux.org/index.php/Talk:Archiso_(%D0%A0%D1%83%D1%81%D1%81%D0%BA%D0%B8%D0%B9)">Talk:Archiso (Русский)#</a>)</div>
</div>
<pre>! id arch &amp;&amp; useradd -m -p "" -g users -G "adm,audio,floppy,log,network,rfkill,scanner,storage,optical,power,wheel" -s /usr/bin/zsh arch
</pre>
<p>Также удалите постоянные данные, например созданные пользователями или символические ссылки, такие как <code>/etc/sudoers</code>.
</p>
<div class="noprint archwiki-template-message">
<p><a href="../File:Tango-view-fullscreen.png" class="image"><img alt="Tango-view-fullscreen.png" src="../File:Tango-view-fullscreen.png" decoding="async" width="48" height="48"></a><b>This article or section needs expansion.</b><a href="../File:Tango-view-fullscreen.png" class="image"><img alt="Tango-view-fullscreen.png" src="../File:Tango-view-fullscreen.png" decoding="async" width="48" height="48"></a></p>
<div>
<b>Reason:</b> Сообщите больше информации о том, что необходимо удалить или сбросить. (Discuss in <a rel="nofollow" class="external text" href="https://wiki.archlinux.org/index.php/Talk:Archiso_(%D0%A0%D1%83%D1%81%D1%81%D0%BA%D0%B8%D0%B9)">Talk:Archiso (Русский)#</a>)</div>
</div>
<p>Сборку можно немного ускорить, отредактировав скрипт pacstrap (расположенный в /bin/pacstrap) и изменив следующее в строке 361:
</p>
<p>До:
</p>
<pre>if ! pacman -r "$newroot" -Sy "${pacman_args[@]}"; then
</pre>
<p>После:
</p>
<pre>if ! pacman -r "$newroot" -Sy --needed "${pacman_args[@]}"; then
</pre>
<p>Это увеличивает скорость первоначальной загрузки, так как не нужно загружать и устанавливать какие-либо основные пакеты, которые уже установлены.
</p>
<h2>
<span id=".D0.98.D1.81.D0.BF.D0.BE.D0.BB.D1.8C.D0.B7.D0.BE.D0.B2.D0.B0.D0.BD.D0.B8.D0.B5_ISO"></span><span class="mw-headline" id="Использование_ISO">Использование ISO</span>
</h2>
<p>Для получения дополнительной информации смотрите статью <a href="../ru/Installation_guide.html" class="mw-redirect" title="Руководство по установке">Руководство по установке</a>.
</p>
<h2>
<span id=".D0.A1.D0.BC.D0.BE.D1.82.D1.80.D0.B8.D1.82.D0.B5_.D1.82.D0.B0.D0.BA.D0.B6.D0.B5"></span><span class="mw-headline" id="Смотрите_также">Смотрите также</span>
</h2>
<h3>
<span id=".D0.94.D0.BE.D0.BA.D1.83.D0.BC.D0.B5.D0.BD.D1.82.D0.B0.D1.86.D0.B8.D1.8F_.D0.B8_.D1.83.D1.87.D0.B5.D0.B1.D0.BD.D1.8B.D0.B5_.D0.BF.D0.BE.D1.81.D0.BE.D0.B1.D0.B8.D1.8F"></span><span class="mw-headline" id="Документация_и_учебные_пособия">Документация и учебные пособия</span>
</h3>
<ul>
<li><a rel="nofollow" class="external text" href="https://gitlab.archlinux.org/archlinux/archiso">Страница проекта Archiso</a></li>
<li><a rel="nofollow" class="external text" href="https://gitlab.archlinux.org/archlinux/archiso/tree/master/docs">Official Официальная документация</a></li>
</ul>
<h3>
<span id=".D0.9F.D1.80.D0.B8.D0.BC.D0.B5.D1.80.D1.8B_.D1.88.D0.B0.D0.B1.D0.BB.D0.BE.D0.BD.D0.BE.D0.B2_.D0.BD.D0.B0.D1.81.D1.82.D1.80.D0.BE.D0.B9.D0.BA.D0.B8"></span><span class="mw-headline" id="Примеры_шаблонов_настройки">Примеры шаблонов настройки</span>
</h3>
<ul><li><a rel="nofollow" class="external text" href="http://easy.open.and.free.fr/didjix/">Live DJ дистрибутив, основанный на ArchLinux и созданный с помощью Archiso</a></li></ul>
<h3>
<span id=".D0.A1.D0.BE.D0.B7.D0.B4.D0.B0.D0.BD.D0.B8.D0.B5_.D0.B0.D0.B2.D1.82.D0.BE.D0.BD.D0.BE.D0.BC.D0.BD.D0.BE.D0.B3.D0.BE_.D1.83.D1.81.D1.82.D0.B0.D0.BD.D0.BE.D0.B2.D0.BE.D1.87.D0.BD.D0.BE.D0.B3.D0.BE_ISO"></span><span class="mw-headline" id="Создание_автономного_установочного_ISO">Создание автономного установочного ISO</span>
</h3>
<ul><li><a href="/index.php?title=Archiso_offline&amp;action=edit&amp;redlink=1" class="new" title="Archiso offline (page does not exist)">Archiso offline</a></li></ul>
</div>
</div>
<div id="catlinks" class="catlinks" data-mw="interface">
<div id="mw-normal-catlinks" class="mw-normal-catlinks">
<a href="../Special:Categories.html" title="Special:Categories">Categories</a>: <ul>
<li><a href="../ru/Category:Live_Arch_systems.html" title="Category:Live Arch systems (Русский)">Live Arch systems (Русский)</a></li>
<li><a href="../ru/Category:Installation_process.html" title="Category:Installation process (Русский)">Installation process (Русский)</a></li>
<li><a href="../ru/Category:Arch_projects.html" title="Category:Arch projects (Русский)">Arch projects (Русский)</a></li>
</ul>
</div>
<div id="mw-hidden-catlinks" class="mw-hidden-catlinks mw-hidden-cats-hidden">Hidden categories: <ul>
<li><a href="../en/Category:Pages_or_sections_flagged_with_Template:Merge.html" title="Category:Pages or sections flagged with Template:Merge">Pages or sections flagged with Template:Merge</a></li>
<li><a href="../en/Category:Pages_or_sections_flagged_with_Template:Style.html" title="Category:Pages or sections flagged with Template:Style">Pages or sections flagged with Template:Style</a></li>
<li><a href="../en/Category:Pages_or_sections_flagged_with_Template:Expansion.html" title="Category:Pages or sections flagged with Template:Expansion">Pages or sections flagged with Template:Expansion</a></li>
</ul>
</div>
</div>
	</div>
</div>

<footer id="footer" class="mw-footer" role="contentinfo" style="margin: 0">
	<ul id="footer-info">
		<li>Retrieved from "<a dir="ltr" href="https://wiki.archlinux.org/index.php?title=Archiso_(%D0%A0%D1%83%D1%81%D1%81%D0%BA%D0%B8%D0%B9)&amp;oldid=628870">https://wiki.archlinux.org/index.php?title=Archiso_(Русский)&amp;oldid=628870</a>"</li>
		<li id="footer-info-lastmod"> This page was last edited on 3 August 2020, at 20:37.</li>
		<li id="footer-info-copyright">Content is available under <a class="external" rel="nofollow" href="http://www.gnu.org/copyleft/fdl.html">GNU Free Documentation License 1.3 or later</a> unless otherwise noted.</li>
	<br>
</ul>
	<ul id="footer-places">
		<li id="footer-places-privacy"><a href="../en/ArchWiki:Privacy_policy.html" title="ArchWiki:Privacy policy">Privacy policy</a></li>
		<li id="footer-places-about"><a href="../en/ArchWiki:About.html" title="ArchWiki:About">About ArchWiki</a></li>
		<li id="footer-places-disclaimer"><a href="../en/ArchWiki:General_disclaimer.html" title="ArchWiki:General disclaimer">Disclaimers</a></li>
	</ul>
	<ul id="footer-icons" class="noprint">
		<li id="footer-copyrightico">
	</ul>
	<div style="clear: both;"></div>
</footer>



</body>
</html>
