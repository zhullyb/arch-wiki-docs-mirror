<!DOCTYPE html>
<html class="client-nojs" lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<title>CUPS (正體中文) - ArchWiki</title>
<link rel="stylesheet" href="../ArchWikiOffline.css">
<meta name="ResourceLoaderDynamicStyles" content="">
<meta name="generator" content="MediaWiki 1.35.0">
<meta name="referrer" content="no-referrer-when-downgrade">
<meta name="robots" content="noindex,follow">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="shortcut icon" href="/favicon.ico">
<link rel="search" type="application/opensearchdescription+xml" href="/opensearch_desc.php" title="ArchWiki (en)">
<link rel="EditURI" type="application/rsd+xml" href="https://wiki.archlinux.org/api.php?action=rsd">
<link rel="license" href="http://www.gnu.org/copyleft/fdl.html">
<link rel="alternate" type="application/atom+xml" title="ArchWiki Atom feed" href="/index.php?title=Special:RecentChanges&amp;feed=atom">
</head>
<body class="mediawiki ltr sitedir-ltr mw-hide-empty-elt ns-0 ns-subject page-CUPS_正體中文 rootpage-CUPS_正體中文 skin-vector action-view skin-vector-legacy">
<div id="content" class="mw-body" role="main" style="margin: 0">
	<a id="top"></a>
	<div id="siteNotice" class="mw-body-content"></div>
	<div class="mw-indicators mw-body-content">
	</div>
	<h1 id="firstHeading" class="firstHeading" lang="en">CUPS (正體中文)</h1>
	<div id="bodyContent" class="mw-body-content">
		<div id="siteSub" class="noprint">From ArchWiki</div>
		<div id="contentSub"></div>
		<div id="contentSub2"></div>
		
		<div id="jump-to-nav"></div>
		<a class="mw-jump-link" href="#mw-head">Jump to navigation</a>
		<a class="mw-jump-link" href="#searchInput">Jump to search</a>
		<div id="mw-content-text" lang="en" dir="ltr" class="mw-content-ltr">
<div class="warningbox">The printable version is no longer supported and may have rendering errors. Please update your browser bookmarks and please use the default browser print function instead.</div>
<div class="mw-parser-output">
<div class="noprint archwiki-template-message">
<p><a href="/title/File:Tango-preferences-desktop-locale.png" class="image"><img alt="Tango-preferences-desktop-locale.png" src="../File:Tango-preferences-desktop-locale.png" decoding="async" width="48" height="48"></a><b>本條目或段落需要進行<a href="/title/ArchWiki:Contributing#Translating" title="ArchWiki:Contributing">翻譯</a>。</b><a href="/title/File:Tango-preferences-desktop-locale.png" class="image"><img alt="Tango-preferences-desktop-locale.png" src="../File:Tango-preferences-desktop-locale.png" decoding="async" width="48" height="48"></a></p>
<div>
<b>註記: </b> <span style="color:red;">please use the first argument of the template to provide more detailed indications.</span> (<a rel="nofollow" class="external text" href="https://wiki.archlinux.org/title/Talk:CUPS_(%E6%AD%A3%E9%AB%94%E4%B8%AD%E6%96%87)">討論</a>)</div>
</div>
<div id="toc" class="toc" role="navigation" aria-labelledby="mw-toc-heading">
<input type="checkbox" role="button" id="toctogglecheckbox" class="toctogglecheckbox" style="display:none"><div class="toctitle" lang="en" dir="ltr">
<h2 id="mw-toc-heading">Contents</h2>
<span class="toctogglespan"><label class="toctogglelabel" for="toctogglecheckbox"></label></span>
</div>
<ul>
<li class="toclevel-1 tocsection-1">
<a href="#%E5%89%8D%E8%A8%80"><span class="tocnumber">1</span> <span class="toctext">前言</span></a>
<ul>
<li class="toclevel-2 tocsection-2"><a href="#CUPS_%E6%98%AF%E4%BB%80%E9%BA%BC?"><span class="tocnumber">1.1</span> <span class="toctext">CUPS 是什麼?</span></a></li>
<li class="toclevel-2 tocsection-3"><a href="#%E7%96%91%E9%9B%A3%E6%8E%92%E8%A7%A3%E5%92%8CCUPS%E7%9A%84%E7%B5%84%E6%88%90"><span class="tocnumber">1.2</span> <span class="toctext">疑難排解和CUPS的組成</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-4">
<a href="#%E5%AE%89%E8%A3%9D_CUPS"><span class="tocnumber">2</span> <span class="toctext">安裝 CUPS</span></a>
<ul>
<li class="toclevel-2 tocsection-5"><a href="#%E8%BB%9F%E9%AB%94%E5%A5%97%E4%BB%B6"><span class="tocnumber">2.1</span> <span class="toctext">軟體套件</span></a></li>
<li class="toclevel-2 tocsection-6">
<a href="#%E7%82%BA%E6%A0%B8%E5%BF%83%E5%8A%A0%E8%BC%89%E5%8D%B0%E8%A1%A8%E6%A9%9F%E6%A8%A1%E7%B5%84"><span class="tocnumber">2.2</span> <span class="toctext">為核心加載印表機模組</span></a>
<ul>
<li class="toclevel-3 tocsection-7"><a href="#USB_%E5%9F%A0%E5%8D%B0%E8%A1%A8%E6%A9%9F"><span class="tocnumber">2.2.1</span> <span class="toctext">USB 埠印表機</span></a></li>
<li class="toclevel-3 tocsection-8"><a href="#%E4%B8%A6%E5%88%97%E5%9F%A0%E5%8D%B0%E8%A1%A8%E6%A9%9F"><span class="tocnumber">2.2.2</span> <span class="toctext">並列埠印表機</span></a></li>
</ul>
</li>
<li class="toclevel-2 tocsection-9"><a href="#%E5%95%9F%E5%8B%95_CUPS"><span class="tocnumber">2.3</span> <span class="toctext">啟動 CUPS</span></a></li>
<li class="toclevel-2 tocsection-10"><a href="#%E5%88%97%E5%8D%B0%E9%A9%85%E5%8B%95%EF%BC%9A_Foomatic"><span class="tocnumber">2.4</span> <span class="toctext">列印驅動： Foomatic</span></a></li>
<li class="toclevel-2 tocsection-11"><a href="#%E5%88%97%E5%8D%B0%E9%A9%85%E5%8B%95%EF%BC%9Ahplip"><span class="tocnumber">2.5</span> <span class="toctext">列印驅動：hplip</span></a></li>
<li class="toclevel-2 tocsection-12"><a href="#%E5%88%97%E5%8D%B0%E9%A9%85%E5%8B%95%EF%BC%9AGutenprint"><span class="tocnumber">2.6</span> <span class="toctext">列印驅動：Gutenprint</span></a></li>
<li class="toclevel-2 tocsection-13"><a href="#%E5%9C%A8_X_%E4%B8%8B%E8%A8%AD%E5%AE%9A_CUPS"><span class="tocnumber">2.7</span> <span class="toctext">在 X 下設定 CUPS</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-14">
<a href="#%E5%8D%B0%E8%A1%A8%E6%A9%9F%E7%9A%84%E5%85%B1%E4%BA%AB"><span class="tocnumber">3</span> <span class="toctext">印表機的共享</span></a>
<ul>
<li class="toclevel-2 tocsection-15"><a href="#Linux_%E5%B0%8D_Linux"><span class="tocnumber">3.1</span> <span class="toctext">Linux 對 Linux</span></a></li>
<li class="toclevel-2 tocsection-16"><a href="#Linux_to_Windows"><span class="tocnumber">3.2</span> <span class="toctext">Linux to Windows</span></a></li>
<li class="toclevel-2 tocsection-17"><a href="#Windows_to_Linux"><span class="tocnumber">3.3</span> <span class="toctext">Windows to Linux</span></a></li>
<li class="toclevel-2 tocsection-18"><a href="#Windows_2000_and_Windows_XP_to_Linux"><span class="tocnumber">3.4</span> <span class="toctext">Windows 2000 and Windows XP to Linux</span></a></li>
<li class="toclevel-2 tocsection-19"><a href="#Others_to_Linux,_Linux_to_others"><span class="tocnumber">3.5</span> <span class="toctext">Others to Linux, Linux to others</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-20">
<a href="#Appendix"><span class="tocnumber">4</span> <span class="toctext">Appendix</span></a>
<ul>
<li class="toclevel-2 tocsection-21"><a href="#Alternative_CUPS_Interfaces"><span class="tocnumber">4.1</span> <span class="toctext">Alternative CUPS Interfaces</span></a></li>
<li class="toclevel-2 tocsection-22"><a href="#PDF_Virtual_Printer"><span class="tocnumber">4.2</span> <span class="toctext">PDF Virtual Printer</span></a></li>
<li class="toclevel-2 tocsection-23"><a href="#Online_Resources"><span class="tocnumber">4.3</span> <span class="toctext">Online Resources</span></a></li>
<li class="toclevel-2 tocsection-24">
<a href="#Specialized_Cases"><span class="tocnumber">4.4</span> <span class="toctext">Specialized Cases</span></a>
<ul>
<li class="toclevel-3 tocsection-25"><a href="#Printing_does_not_work/aborts_with_the_HP_Deskjet_700_Series_Printers."><span class="tocnumber">4.4.1</span> <span class="toctext">Printing does not work/aborts with the HP Deskjet 700 Series Printers.</span></a></li>
<li class="toclevel-3 tocsection-26"><a href="#Getting_HP_LaserJet_1010_to_work"><span class="tocnumber">4.4.2</span> <span class="toctext">Getting HP LaserJet 1010 to work</span></a></li>
<li class="toclevel-3 tocsection-27"><a href="#Getting_HP_LaserJet_1020_to_work"><span class="tocnumber">4.4.3</span> <span class="toctext">Getting HP LaserJet 1020 to work</span></a></li>
<li class="toclevel-3 tocsection-28"><a href="#Printer_connected_to_an_Airport_Express_Station"><span class="tocnumber">4.4.4</span> <span class="toctext">Printer connected to an Airport Express Station</span></a></li>
<li class="toclevel-3 tocsection-29">
<a href="#Performing_Utility_Functions_on_Epson_Printers"><span class="tocnumber">4.4.5</span> <span class="toctext">Performing Utility Functions on Epson Printers</span></a>
<ul>
<li class="toclevel-4 tocsection-30"><a href="#Escputil"><span class="tocnumber">4.4.5.1</span> <span class="toctext">Escputil</span></a></li>
<li class="toclevel-4 tocsection-31"><a href="#Mtink"><span class="tocnumber">4.4.5.2</span> <span class="toctext">Mtink</span></a></li>
</ul>
</li>
</ul>
</li>
<li class="toclevel-2 tocsection-32"><a href="#Another_Source_for_Printer_Drivers"><span class="tocnumber">4.5</span> <span class="toctext">Another Source for Printer Drivers</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-33">
<a href="#Troubleshooting"><span class="tocnumber">5</span> <span class="toctext">Troubleshooting</span></a>
<ul>
<li class="toclevel-2 tocsection-34">
<a href="#As_a_result_of_upgrade"><span class="tocnumber">5.1</span> <span class="toctext">As a result of upgrade</span></a>
<ul>
<li class="toclevel-3 tocsection-35"><a href="#Error_with_gnutls"><span class="tocnumber">5.1.1</span> <span class="toctext">Error with gnutls</span></a></li>
<li class="toclevel-3 tocsection-36"><a href="#All_jobs_are_%22stopped%22"><span class="tocnumber">5.1.2</span> <span class="toctext">All jobs are "stopped"</span></a></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>

<h2>
<span id=".E5.89.8D.E8.A8.80"></span><span class="mw-headline" id="前言">前言</span>
</h2>
<h3>
<span id="CUPS_.E6.98.AF.E4.BB.80.E9.BA.BC.3F"></span><span class="mw-headline" id="CUPS_是什麼?">CUPS 是什麼?</span>
</h3>
<p>CUPS是蘋果公司發展的一套開源標準的列印系統，其支援MacOSX以及其他Unix-like作業系統，其使用"Internet Printing Protocol"並且對大部分的雷射印表機、噴墨印表機提供完整的列印服務。CUPS遵循GNU GPL條款。雖然也有很多列印軟體(例：LPRNG)，但是CUPS仍然是相對主流，而且簡單操作。許多Linux的發行板(包括Arch)都已經預設CUPS為預設列印系統。
</p>
<h3>
<span id=".E7.96.91.E9.9B.A3.E6.8E.92.E8.A7.A3.E5.92.8CCUPS.E7.9A.84.E7.B5.84.E6.88.90"></span><span class="mw-headline" id="疑難排解和CUPS的組成">疑難排解和CUPS的組成</span>
</h3>
<p>最佳列印的方法是在'/etc/cups/cupsd.conf'中設定'LogLevel'。
</p>
<pre>LogLevel debug2
</pre>
<p>然後注意看'/var/log/cups/error_log'中的訊息，可以用下令命令常看
</p>
<pre>tail -n 100 -f /var/log/cups/error_log
</pre>
<p>左側的字元其意義如下：
</p>
<pre>D = Debug(臭蟲)
E = Error(錯誤)
I = Information(資訊)
etc...</pre>
<p>這些檔案提供的訊息非常有用。
</p>
<pre>在這裡'/var/log/cups/page_log'每次成功列印都會列出資訊
在這裡'/var/log/cups/access_log'列出所有CUPS http1.1服務的狀態
</pre>
<p>如果要確定CUPS是否正常運作，以及要做疑難排解，上述的資訊是非常重要的。
</p>
<ol>
<li>一般應用程式在你壓下"列印"時，會送.ps檔案(PostScript)給CUPS。</li>
<li>之後CUPS會察看你的列印機的PPD檔案(printer description)，再決定如何把.ps檔案轉換成印表機能了解的語言，像是PJL、PCL...等。這個步驟一般需要ghostscript。</li>
<li>GhostScript接收到訊息後會決定使用不同的filter，並且將.ps透過filter轉換成印表機可以接受的格式。</li>
<li>最後送到後端(backend)。例：如果你的印表機是用USB聯接電腦的，那麼就會送到USB後端(backend)。</li>
</ol>
<p>找份檔案列印，同時注意'error_log'可以的到列印過程中的更多細節
</p>
<h2>
<span id=".E5.AE.89.E8.A3.9D_CUPS"></span><span class="mw-headline" id="安裝_CUPS">安裝 CUPS</span>
</h2>
<h3>
<span id=".E8.BB.9F.E9.AB.94.E5.A5.97.E4.BB.B6"></span><span class="mw-headline" id="軟體套件">軟體套件</span>
</h3>
<p>你至少需要CUPS和Ghostscript：
</p>
<pre># pacman -S cups ghostscript gsfonts
</pre>
<ul>
<li>
<b>cups</b> - CUPS套件</li>
<li>
<b>ghostscript</b> - 一個對Posrscript的翻譯器</li>
<li>
<b>gsfonts</b> - Ghostscript standard Type1 fonts</li>
</ul>
<p>依據你的列印設備的不同，可能需要下列驅動程式套件。如果你不確定，建議使用gutenprint。
</p>
<ul>
<li>
<b>gutenprint</b> - 一個蒐集了大多數Canon, Epson, Lexmark, Sony, Olympus,PCL列印機的驅動程式套件，並且可以支援Ghostscript, CUPS, Foomatic,Gimp。</li>
<li>
<b>foomatic</b>, <b>foomatic-db</b>, <b>foomatic-db-engine</b>, <b>foomatic-db-ppd</b> and <b>foomatic-filters</b> - Foomatic是Unix下，以資料庫驅動系統(database-driven system)去整合自由軟體列印驅動，並且支援一般的列印緩衝(spooler)的套件。</li>
<li>如果error.log回報"stopped with status 22!"，安裝 <b>foomatic-filters</b>可以解決這個問題。</li>
<li>
<b>hplip</b> - HP Linux inkjet driver的縮寫。提供HP DeskJet, OfficeJet, Photosmart, Business Inkjet和一些LaserJet印表機的模組。</li>
<li>
<b>cups-pdf</b> - 一個虛擬的PDF印表機套件，可以讓你產生PDF檔案，而不需要真實列印。</li>
</ul>
<p>如果你是透過samba通訊協定網路服務來列印的，或是你的列印系統將提供給windows的客戶端使用，請安裝samba。
</p>
<pre># pacman -S samba
</pre>
<h3>
<span id=".E7.82.BA.E6.A0.B8.E5.BF.83.E5.8A.A0.E8.BC.89.E5.8D.B0.E8.A1.A8.E6.A9.9F.E6.A8.A1.E7.B5.84"></span><span class="mw-headline" id="為核心加載印表機模組">為核心加載印表機模組</span>
</h3>
<p>連接好印表機機，並打開電源，隨後：
</p>
<h4>
<span id="USB_.E5.9F.A0.E5.8D.B0.E8.A1.A8.E6.A9.9F"></span><span class="mw-headline" id="USB_埠印表機">USB 埠印表機</span>
</h4>
<pre># modprobe usblp                      （2.6.x 核心）
# modprobe printer                    （2.4.x 核心）
# tail /var/log/messages.log          （看看安裝成功了沒有）
</pre>
<h4>
<span id=".E4.B8.A6.E5.88.97.E5.9F.A0.E5.8D.B0.E8.A1.A8.E6.A9.9F"></span><span class="mw-headline" id="並列埠印表機">並列埠印表機</span>
</h4>
<pre># modprobe lp parport parport_pc      （2.6.x 核心）
# modprobe parport parport_pc         （2.4.x 核心）
# tail /var/log/messages.log          （看看安裝成功了沒有）
</pre>
<p>將這些模組加入/etc/rc.conf中的MODULES中去，以便開機時自動加載。
</p>
<h3>
<span id=".E5.95.9F.E5.8B.95_CUPS"></span><span class="mw-headline" id="啟動_CUPS">啟動 CUPS</span>
</h3>
<ol><li>/etc/rc.d/cupsd start</li></ol>
<p>可將cupsd加入/etc/rc.conf中的DAEMONS中去，以便開機時自動加載.
</p>
<p>這個時候，就可以用CUPS在控制檯下做一些簡單的列印了，如：
</p>
<pre>$ cat ~/.xinitrc &gt; /dev/usb/lp0      (USB 埠印表機)
</pre>
<p>當然僅僅依靠CUPS列印，如果在X下，肯定是不方便的。主要是因為缺少驅動，Linux下的列印驅動是PPD檔案。
</p>
<h3>
<span id=".E5.88.97.E5.8D.B0.E9.A9.85.E5.8B.95.EF.BC.9A_Foomatic"></span><span class="mw-headline" id="列印驅動：_Foomatic">列印驅動： Foomatic</span>
</h3>
<p>Foomatic是一個資料庫驅動的列印系統，它將Unix下的通用後臺列印系統與開源的印表機驅動整合在一起。
只要有任一在開源驅動下能夠正常工作的印表機，它就能支援了。它支援CUPS, LPRng, LPD, GNUlpr, Solaris LP,
PPR, PDQ, CPS 這些底層的列印系統，也能直接列印（既是驅動也是列印工具）。
Foomatic列印速度快，列印質量也挺不錯。不過缺點是，有個別的印表機可能沒有PPD檔案驅動。
</p>
<pre># pacman -S foomatic-***
</pre>
<p>Foomatic包含五個安裝包：
foomatic-filters (幫助後臺列印系統將PostScript轉成印表機語言)，
foomatic-db (foomatic-db-engine生成PPD檔案時要用到的一切資料)，
foomatic-db-PPD (已經獲支援的列印驅動)
foomatic-db-engine (將 Foomatic XMLo資料庫中的數據生成PPD檔案)，
foomatic-db-hpijs (專為HP列印驅動生成Foomatic XML 數據)。
</p>
<p>一般來說，安裝前四個包就可以了。如果沒有惠普印表機，就不必安裝foomatic-db-hpijs了。
</p>
<h3>
<span id=".E5.88.97.E5.8D.B0.E9.A9.85.E5.8B.95.EF.BC.9Ahplip"></span><span class="mw-headline" id="列印驅動：hplip">列印驅動：hplip</span>
</h3>
<p>惠普DeskJet, OfficeJet, Photosmart, Business Inkjet 和一些 LaserJet 印表機型號，需要安裝hplip。只用於惠普印表機。
也可同時安裝上面的Foomatic，對比一下兩者的列印速度。
</p>
<pre># pacman -S hplip
</pre>
<h3>
<span id=".E5.88.97.E5.8D.B0.E9.A9.85.E5.8B.95.EF.BC.9AGutenprint"></span><span class="mw-headline" id="列印驅動：Gutenprint">列印驅動：Gutenprint</span>
</h3>
<p>也許以上的列印驅動仍然不行（不過安裝foomatic一定是必要的，能提高列印速度）。在設定CUPS時（即將講到）
沒有找到自己的印表機型號。那麼可能還需要接著安裝Gutenprint。
Gutenprint 是GIMP的列印擴充功能模組，過去叫"gimp-print"，它能夠為GIMP提供流行的列印驅動，能
讓佳能、愛普生、惠普、利盟、索尼、奧林巴斯，以及其他基於PCL技術的印表機，列印出更出色的品質。用於高品質的圖像列印是在好不過了。
它支援的印表機型號列表可見於：<a rel="nofollow" class="external free" href="https://web.archive.org/web/20080513123708/http://gutenprint.sourceforge.net/p_Supported_Printers.php3">https://web.archive.org/web/20080513123708/http://gutenprint.sourceforge.net/p_Supported_Printers.php3</a>
不過Gutenprint的列印品質是沒得說，但速度就不敢恭維了。但有foomatic的支援就會快很多。
</p>
<pre># pacman -S gutenprint
</pre>
<h3>
<span id=".E5.9C.A8_X_.E4.B8.8B.E8.A8.AD.E5.AE.9A_CUPS"></span><span class="mw-headline" id="在_X_下設定_CUPS">在 X 下設定 CUPS</span>
</h3>
<p>列印基礎系統CUPS和列印驅動安裝好的，就要開始設定印表機了。
可以通過設定CUPS來設定印表機。設定CUPS的方法適用於一切印表機及其驅動。因此推薦使用。
進入X，打開一個網頁瀏覽器，訪問：
<a rel="nofollow" class="external free" href="http://localhost:631">http://localhost:631</a>      （也可以用在/etc/hosts中設置好的hostname來代替localhost）
按照提示，一步一步的設定好印表機：
Manage Printers ---&gt; Add Printer ---&gt; root密碼驗證 ---&gt; 輸入印表機名稱 ---&gt; 選擇設備類型
（印表機型號及其連接介面：USB埠 or 並列埠印表機） ---&gt; 選擇你的印表機 ---&gt; 通過印表機型號來選擇適當的印表機驅動，並Add
（如果列印驅動的名稱中出現了foomatic字樣，一定要優先選擇） ---&gt; 列印選項的設置 ---&gt; 完成
</p>
<p>也可以使用另外的設定界面，不過可能要另外安裝：
</p>
<pre>tupac -S gnome-cups-manager     (Gnome下)
tupac -S gtklp                  (KDE下)
</pre>
<h2>
<span id=".E5.8D.B0.E8.A1.A8.E6.A9.9F.E7.9A.84.E5.85.B1.E4.BA.AB"></span><span class="mw-headline" id="印表機的共享">印表機的共享</span>
</h2>
<h3>
<span id="Linux_.E5.B0.8D_Linux"></span><span class="mw-headline" id="Linux_對_Linux">Linux 對 Linux</span>
</h3>
<p>Once you have CUPS setup on your Linux print server, sharing the printer with another Linux box is relatively easy. There are several ways to configure such a scenario, here we will describe the manual setup. On the server computer (the one managing and connecting to the printer) simply open up the <i>/etc/cups/cupsd.conf</i> file and allow access to the server by modifying the location lines.  For instance:
</p>
<pre>&lt;Location /&gt;
  Order Deny,Allow
  Deny From All
  Allow From 127.0.0.1
  Allow From 10.0.0.*
&lt;/Location&gt;
</pre>
<p>You will also need to make sure the server is listening on the IP address your client will be addressing.  Add the following line after "Listen localhost:631":
</p>
<pre>Listen 10.0.0.1:631
</pre>
<p>using your server's IP address instead of 10.0.0.1.
</p>
<p>Add the IP address of the client computer by doing Allow From client_ip_address.  After you make your modifications, you will want to restart CUPS by doing:
</p>
<pre># /etc/rc.d/cupsd restart
</pre>
<p>On the client side, open up <i>/etc/cups/client.conf</i> and edit the ServerName option to match the ip address or the name of your server.  For instance I named my server beast and have entry in my hosts file to point to it.  So in my <i>client.conf</i> file, I just edited this line:
</p>
<pre>ServerName beast
</pre>
<p>Next, run the following command to update the client computer:
</p>
<pre># lpq
</pre>
<p>You should see something like this:
</p>
<pre>ml1250 is ready
no entries
</pre>
<p>There are more configuration possibilities including an automatic configuration which are described in detail on <a rel="nofollow" class="external free" href="http://localhost:631/sam.html#CLIENT_SETUP">http://localhost:631/sam.html#CLIENT_SETUP</a> (this link works on your printer server).
</p>
<p>when prompted for username and password use root to access
then follow the instructions from here
<a rel="nofollow" class="external free" href="https://web.archive.org/web/20091217222844/http://www.digitalhermit.com/linux/printing/">https://web.archive.org/web/20091217222844/http://www.digitalhermit.com/linux/printing/</a>
if its a TCP/IP printer use Jetdirect
</p>
<p>That's it for Linux to Linux printer sharing.
</p>
<h3><span class="mw-headline" id="Linux_to_Windows">Linux to Windows</span></h3>
<p>If you are connected to a Windows print server (or any other Samba capable print server), you can skip the section about kernel modules and such.  All you have to do is start the CUPS daemon and complete the web interface as specified in section 3.3 and 3.4.  Before this, you need to activate the Samba CUPS backend.  You can do this by entering the following command:
</p>
<pre># ln -s `which smbspool` /usr/lib/cups/backend/smb
</pre>
<p>Note that the symbol before is ` (underneath the ~ on a standard US keyboard) and not '.  After this, you will have to restart CUPS using the command specified in the previous section.  Next, simply login into the CUPS web interface and choose to add a new printer.  For device, there should be an option that says something to the effect Windows Printer Via Samba near the button of the device list.  For the device location enter:
</p>
<pre>smb://username:password@hostname/printer_name
</pre>
<p>Or without a password:
</p>
<pre>smb://username@hostname/printer_name
</pre>
<p>Make sure that the user actually has access to the printer on Windows computer.  Select the appropriate drivers and that's about it. If the computer is located on a domain, make sure the username includes the domain: 
</p>
<pre>smb://username:password@domain/hostname/printer_name
</pre>
<p>Note: if your network contains many printers use "lpoptions -d your_desired_default_printer_name" to set your preferred printer
</p>
<p>Note: I, thepizzaking, was having 'NT_STATUS_ACCESS_DENIED' errors and to fix them I needed to use a slightly different syntax:
</p>
<pre>smb://workgroup/username:password@hostname/printer_name
</pre>
<h3><span class="mw-headline" id="Windows_to_Linux">Windows to Linux</span></h3>
<p>Sometimes, you might want to allow a Windows computer to connect to your computer.  There are a few ways to do this, and the one I am most familiar with is using Samba.  In order to do this, you will have to edit your <i>/etc/samba/smb.conf</i> file to allow access to your printers.  Your smb.conf can look something like this:
</p>
<pre>[global]
workgroup = Heroes
server string = Arch Linux Print Server
security = user

[printers]
    comment = All Printers
    path = /var/spool/samba
    browseable = yes
    # to allow user 'guest account' to print.
    guest ok = no
    writable = no
    printable = yes
    create mode = 0700
    write list = @adm root neocephas</pre>
<p>That should be enough to share your printer, but you just might want to add an individual printer entry:
</p>
<pre>[ML1250]
    comment = Samsung ML-1250 Laser Printer
    printer=ml1250
    path = /var/spool/samba
    printing = cups
    printable = yes
    printer admin = @admin root neocephas
    user client driver = yes
    # to allow user 'guest account' to print.
    guest ok = no
    writable = no
    write list = @adm root neocephas
    valid users = @adm root neocephas</pre>
<p>Please note that in my configuration I made it so that users must have a valid account to access the printer.  To have a public printer, set guest ok to yes, and remove the valid users line.  To add accounts, you must setup a regular Linux account and then setup a Samba password on the server.  For instance:
</p>
<pre># useradd neocephas
# smbpasswd -a neocephas
</pre>
<p>After setting up any user accounts that you need, you will also need to set up the samba spool folder:
</p>
<pre># mkdir /var/spool/samba
# chmod 777 /var/spool/samba
</pre>
<p>The next items that need changing are /etc/cups/mime.convs and /etc/cups/mime.types:
</p>
<p>mime.convs:
</p>
<pre># The following line is found at near the end of the file. Uncomment it.
application/octet-stream        application/vnd.cups-raw        0       -
</pre>
<p>mime.types:
</p>
<pre># Again near the end of the file.
application/octet-stream
</pre>
<p>The changes to mime.convs and mime.types are needed to make CUPS print Microsoft Office document files. Many people seem to need that.
</p>
<p>After this restart your Samba daemon:
</p>
<pre># /etc/rc.d/samba restart
</pre>
<p>Obvious, there are a lot of tweaks and customization that can be done with setting up a Samba print server, so I advise you to look at the Samba and CUPS documentation for more help.  The <i>smb.conf.example</i> file also has some good samples to that you might want to look at.
</p>
<h3><span class="mw-headline" id="Windows_2000_and_Windows_XP_to_Linux">Windows 2000 and Windows XP to Linux</span></h3>
<p>For the most modern flavors of Windows an alternative way of connecting to your Linux printer server is to use the CUPS protocol directly.  The Windows client will need to be using Windows 2000 or Windows XP.  Make sure you allows the clients to access the print server by editing the location settings as specified in section 4.1.
</p>
<p>On the Windows computer, go to the printer control panel and choose to Add a New Printer.  Next, choose to give an url.  For the url type in the location of your printer:
</p>
<p><i><a rel="nofollow" class="external free" href="http://host_ip_address:631/printers/printer_name">http://host_ip_address:631/printers/printer_name</a></i>
</p>
<p>where host_ip_address is the Linux server's IP address and printer_name is the name of the printer you are connecting to.  After this, install the printer drivers for the Windows computer.  If you setup the CUPS server to use its own printer drivers, then you can just select a generic postscript printer for the Windows client.  You can then test your print setup by printing a test page.
</p>
<h3>
<span id="Others_to_Linux.2C_Linux_to_others"></span><span class="mw-headline" id="Others_to_Linux,_Linux_to_others">Others to Linux, Linux to others</span>
</h3>
<p>More information on interfacing CUPS with other printing systems can be found in the CUPS manual, e.g. on <a rel="nofollow" class="external free" href="http://localhost:631/sam.html#PRINTING_OTHER">http://localhost:631/sam.html#PRINTING_OTHER</a>
</p>
<h2><span class="mw-headline" id="Appendix">Appendix</span></h2>
<h3><span class="mw-headline" id="Alternative_CUPS_Interfaces">Alternative CUPS Interfaces</span></h3>
<p>If you are a GNOME user, you can manage and configure your printer by using the gnome-cups-manager.
</p>
<p>Update: this package is now available through pacman if you have the "community" repository uncommented in /etc/pacman.conf
</p>
<pre>pacman -S gnome-cups-manager
</pre>
<p>The package is also still available from the <a rel="nofollow" class="external text" href="https://aur.archlinux.org/packages/?0&amp;C=0&amp;K=cups&amp;SB=&amp;SO=&amp;PP=25&amp;do_MyPackages=0&amp;do_Orphans=0&amp;SeB=nd">AUR</a>.
</p>
<p>KDE users can modify their printers from the Control Center.  Both should refer the those desktop environments' documentation for more information on how to use the interfaces.
</p>
<p>There is also <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://aur.archlinux.org/packages/gtklp/">gtklp</a></span><sup><small>AUR</small></sup>. It is in the [extra] repository.
</p>
<h3><span class="mw-headline" id="PDF_Virtual_Printer">PDF Virtual Printer</span></h3>
<p>A nice little package that I submitted to the incoming folder (<a rel="nofollow" class="external free" href="ftp://ftp.archlinux.org/incoming">ftp://ftp.archlinux.org/incoming</a>) is CUPS-PDF.  This package allows one to setup a virtual printer that will generate a PDF from anything sent to it.  For example, I wrote this document in AbiWord and then printed it to the Virtual Printer which generated a PDF in my <i>/var/spool/cups-pdf/neocephas</i> folder.  Obviously, this package is not necessary, but it can be quite useful.  After downloading the package from the FTP server and installing it, you can set it up as you would for any other printer in the web interface.  Select Virtual PDF Printer as the device and choose Postscript -&gt; Postscript Color Printer for the drivers.
</p>
<h3><span class="mw-headline" id="Online_Resources">Online Resources</span></h3>
<p>Here is a listing of websites that may be of use to you:
</p>
<ul>
<li>
<b>Official CUPS documentation on your computer</b> <a rel="nofollow" class="external free" href="http://localhost:631/documentation.html">http://localhost:631/documentation.html</a>
</li>
<li>
<b>Official CUPS Website</b> - <a rel="nofollow" class="external free" href="https://www.cups.org/">https://www.cups.org/</a>
</li>
<li>
<b>Linux Printing</b> - <a rel="nofollow" class="external free" href="http://www.linuxprinting.org/">http://www.linuxprinting.org/</a>
</li>
<li>
<b>Tips and Suggestions on common CUPS problems</b> - <a rel="nofollow" class="external free" href="https://web.archive.org/web/20080918042956/http://home.nyc.rr.com/computertaijutsu/cups.html">https://web.archive.org/web/20080918042956/http://home.nyc.rr.com/computertaijutsu/cups.html</a>
</li>
<li>
<b>Gentoo's Printing Guide</b> - <a rel="nofollow" class="external free" href="https://www.gentoo.org/doc/en/printing-howto.xml">https://www.gentoo.org/doc/en/printing-howto.xml</a>
</li>
<li>
<b>Arch Linux User Forums</b> - <a rel="nofollow" class="external free" href="https://bbs.archlinux.org/">https://bbs.archlinux.org/</a>
</li>
<li><a rel="nofollow" class="external text" href="https://uniteddigitalsolutions.com/?page=prcat&amp;cid=83">Minolta toner cartridge</a></li>
<li><a rel="nofollow" class="external text" href="http://uniteddigitalsolutions.com/index.php?page=prcat&amp;cid=91">Tektronix print cartridge</a></li>
<li><a rel="nofollow" class="external text" href="https://uniteddigitalsolutions.com/?page=prcat&amp;cid=87">Pitney Bowes ink cartridge</a></li>
</ul>
<h3><span class="mw-headline" id="Specialized_Cases">Specialized Cases</span></h3>
<p>This section is dedicated to specific problems and their solutions. If you managed to get some <i>unusual</i> printer working, please put the solution here.
</p>
<h4>
<span id="Printing_does_not_work.2Faborts_with_the_HP_Deskjet_700_Series_Printers."></span><span class="mw-headline" id="Printing_does_not_work/aborts_with_the_HP_Deskjet_700_Series_Printers.">Printing does not work/aborts with the HP Deskjet 700 Series Printers.</span>
</h4>
<ul><li>The solution is to install <b>pnm2ppa</b> printer filter for the HP Deskjet 700 series. Without this the print jobs will be aborted by the system.  A <a href="/title/PKGBUILD" title="PKGBUILD">PKGBUILD</a> for <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://aur.archlinux.org/packages/pnm2ppa/">pnm2ppa</a></span><sup><small>AUR</small></sup> can be found in the <a href="/title/AUR" class="mw-redirect" title="AUR">AUR</a>.</li></ul>
<h4><span class="mw-headline" id="Getting_HP_LaserJet_1010_to_work">Getting HP LaserJet 1010 to work</span></h4>
<p>I had to compile ghostscript myself because ESP gs in rep was 7.07 and had not fixed some bugs like ESP 8.15.1 had. I never downloaded 'foomatic' in rep. I think that is an old package. 
</p>
<pre>$ pacman -Qs cups a2ps psutils foo ghost
local/cups 1.1.23-3
    The CUPS Printing System
local/a2ps 4.13b-3
    a2ps is an Any to PostScript filter
local/psutils p17-3
    A set of postscript utilities.
local/foomatic-db 3.0.2-1
    Foomatic is a system for using free software printer drivers with common
    spoolers on Unix
local/foomatic-db-engine 3.0.2-1
    Foomatic is a system for using free software printer drivers with common
    spoolers on Unix
local/foomatic-db-ppd 3.0.2-1
    Foomatic is a system for using free software printer drivers with common
    spoolers on Unix
local/foomatic-filters 3.0.2-1
    Foomatic is a system for using free software printer drivers with common
    spoolers on Unix
local/espgs 8.15.1-1
    ESP Ghostscript
</pre>
<p>I also had to set LogLevel in /etc/cups/cupsd.conf to debug2 before i saw that I missed some "Nimbus" fonts. Then I had to rename &amp; put them where the log told me to. Some fancy google searching had to be applied, example: <a rel="nofollow" class="external free" href="https://www.google.com/search?q=n019003l+filetype%3Apfb">https://www.google.com/search?q=n019003l+filetype%3Apfb</a> since the fonts turned out to be proprietary (i'm sure windows comes with these default). Nevertheless after downloading them(about 7 fonts) and putting them in the correct folder printing started working.
</p>
<p>Before that i were getting all the errors said here: <a rel="nofollow" class="external free" href="https://linuxprinting.org/show_printer.cgi?recnum=HP-LaserJet_1010">https://linuxprinting.org/show_printer.cgi?recnum=HP-LaserJet_1010</a> 'Unsupport PCL' etc...
</p>
<p>I'm sure it could have worked with ESP gs 7.07 too(in rep) if i was smart enough to turn on DebugLevel2 sooner :/ UPDATE: yeah it did... maybe this info is useful for someone else though.. sorry for the inconvenience.
</p>
<h4><span class="mw-headline" id="Getting_HP_LaserJet_1020_to_work">Getting HP LaserJet 1020 to work</span></h4>
<p>After a lot of tries with hplib and gutenprint I finally found the solution to get my printer HP Laserjet 1020 printing. 
</p>
<p>First of all you only need to install cups and ghostscript. Then follow the link on <a rel="nofollow" class="external free" href="http://www.linuxprinting.org/show_printer.cgi?recnum=HP-LaserJet_1020">http://www.linuxprinting.org/show_printer.cgi?recnum=HP-LaserJet_1020</a> to the <a rel="nofollow" class="external free" href="https://web.archive.org/web/20210129024712/http://foo2zjs.rkkda.com/">https://web.archive.org/web/20210129024712/http://foo2zjs.rkkda.com/</a> printer driver page and follow the install instructions. Log in as root. After you downloaded the package and extracted the archive, change into the foo2zjs directory. Now you can follow the original installation instructions with a minor modification to change the userid for printing:<br>
</p>
<pre>$ make
$ ./getweb 1020

</pre>
<p>Open the <i>Makefile</i>
</p>
<pre>$ nano Makefile
</pre>
<p>and search for the line
</p>
<pre># LPuid=-olp
</pre>
<p>and modify it to
</p>
<pre># LPuid=-oroot
</pre>
<p>then continue with the script
</p>
<pre>$ make install
$ make install-hotplug
$ make cups
</pre>
<p>Or you can use the package foo2zjs from AUR and modify the PKGBUILD: change the line
</p>
<pre>./getweb all
</pre>
<p>to
</p>
<pre>./getweb 1020
</pre>
<p>(or if you are setting another printer change this line to what you need).
</p>
<p>As a last step add and configure the printer in the CUPS manager. The printer should be recognized automatically. It works fine for root and all users. When booting the operating system, the printer is initialized and indicates its working.
</p>
<h4><span class="mw-headline" id="Printer_connected_to_an_Airport_Express_Station">Printer connected to an Airport Express Station</span></h4>
<p>The first thing to do is to scan the airport express station. It
seems that there are different addresses depending on the model.
</p>
<pre>[root@somostation somos]# nmap 192.168.0.4

Starting Nmap 4.20 ( <a rel="nofollow" class="external free" href="https://insecure.org">https://insecure.org</a> ) at 2007-06-26 00:50 CEST
Interesting ports on 192.168.0.4:
Not shown: 1694 closed ports
PORT      STATE SERVICE
5000/tcp  open  UPnP
9100/tcp  open  jetdirect
10000/tcp open  snet-sensor-mgmt
MAC Address: 00:14:51:70:D5:66 (Apple Computer)

Nmap finished: 1 IP address (1 host up) scanned in 25.815 seconds
</pre>
<p>With my station the port is 9100. The airport station is accessed like
an HP JetDirect printer.
After, you can edit your printer.conf file in this way:
</p>
<pre># Printer configuration file for CUPS v1.2.11
# Written by cupsd on 2007-06-26 00:44
&lt;Printer LaserSim&gt;
Info SAMSUNG ML-1510 gdi
Location SomoStation
DeviceURI socket://192.168.0.4:9100
State Idle
StateTime 1182811465
Accepting Yes
Shared Yes
JobSheets none none
QuotaPeriod 0
PageLimit 0
KLimit 0
OpPolicy default
ErrorPolicy stop-printer
&lt;/Printer&gt;
</pre>
<p>It should work. I had a few problems. There were resolved by removing foomatic and installing foomatic-db, foomatic-db-engine, foomatic-db-ppd instead.
</p>
<h4><span class="mw-headline" id="Performing_Utility_Functions_on_Epson_Printers">Performing Utility Functions on Epson Printers</span></h4>
<h5><span class="mw-headline" id="Escputil">Escputil</span></h5>
<p>Here we explain how to perform some of the utility functions such as nozzle cleaning and nozzle checks on Epson printers. We will use the escputil utility, which is part of the gutenprint package.
</p>
<p>There is a man page ("man escputil") that provides pretty good information, but it does not include necessary information on how to identify your printer. There are two parameters that can be used. One is --printer; what it expects is the name you used to identify your printer when you configured it. The other is --raw-device. What this option expects is is something beginning with "/dev". If your printer is a serial printer, and the only serial printer, it is "/dev/lp0". If it is an usb printer, it is "/dev/usb/lp0". If you have more than one printer, they will have names ending in "lp1", "lp2", etc. 
</p>
<ul><li>To clean the printer heads:</li></ul>
<pre>  escputil -u --clean-head
</pre>
<ul><li>To prints the nozzle-check pattern, allowing you to verify that the previous head cleaning worked. (Or to determine that you need to clean the heads)</li></ul>
<pre>  escputil -u --nozzle-check
</pre>
<p>If you want to perform an operation that requires 2-way communication with a printer, you must use the "--raw-device" specification, and your user must root or be a member of the group "lp". 
</p>
<ul><li>The following is an example of getting the printer's internal identification:</li></ul>
<pre>  sudo escputil --raw-device=/dev/usb/lp0 --identify
</pre>
<ul><li>To prints out the ink levels of the printer:</li></ul>
<pre>  sudo escputil --raw-device=/dev/usb/lp0 --ink-level
</pre>
<h5><span class="mw-headline" id="Mtink">Mtink</span></h5>
<p>This is a printer status monitor which enables to get the remaining ink quantity, to print test patterns, to reset printer and to clean nozzle. It use an intuitive graphical user interface. Package can be downloaded from <a rel="nofollow" class="external text" href="https://aur.archlinux.org/packages/?O=0&amp;L=0&amp;C=0&amp;K=mtink&amp;SB=n&amp;SO=a&amp;PP=25&amp;do_MyPackages=0&amp;do_Orphans=0&amp;SeB=nd">AUR</a>.
</p>
<h3><span class="mw-headline" id="Another_Source_for_Printer_Drivers">Another Source for Printer Drivers</span></h3>
<p>On <i><a rel="nofollow" class="external free" href="http://www.turboprint.de/english.html">http://www.turboprint.de/english.html</a></i> is a really good printer driver for many printers not yet supported by Linux (especially Canon i*). The only problem is that high-quality-prints are either marked with a turboprint-logo or you have to pay for it... It's not Open-Source.
</p>
<p><a href="https://en.wikipedia.org/wiki/Common_Unix_Printing_System" class="extiw" title="wikipedia:Common Unix Printing System">Wikipedia:Common_Unix_Printing_System</a>
</p>
<h2><span class="mw-headline" id="Troubleshooting">Troubleshooting</span></h2>
<h3><span class="mw-headline" id="As_a_result_of_upgrade">As a result of upgrade</span></h3>
<h4><span class="mw-headline" id="Error_with_gnutls">Error with gnutls</span></h4>
<p>After updating, if you get something like :
</p>
<pre> /usr/sbin/cupsd: error while loading shared libraries: libgnutls.so.13: cannot open shared object file: No such file or directory
</pre>
<p>You need to update gnutls:
</p>
<pre> pacman -S gnutls
</pre>
<p>In addition, in /etc/cups, there will be a file named cupsd.conf.pacnew.  Rename it cupsd.conf.
</p>
<h4>
<span id="All_jobs_are_.22stopped.22"></span><span class="mw-headline" id='All_jobs_are_"stopped"'>All jobs are "stopped"</span>
</h4>
<p>After updating CUPS, if all jobs sent to the printer become "stopped", delete the printer and add it again.
Using the CUPS web interface (<a rel="nofollow" class="external free" href="http://localhost:631">http://localhost:631</a>), go to Printers &gt; Delete Printer.
</p>
<p><i>Note:</i> If you do not remember your printer's settings, go to Printers &gt; Modify Printer. Copy down the information displayed, click 'Modify Printer' to proceed to the next page(s), etc.
</p>
</div>
</div>
<div id="catlinks" class="catlinks" data-mw="interface">
<div id="mw-normal-catlinks" class="mw-normal-catlinks">
<a href="/title/Special:Categories" title="Special:Categories">Categories</a>: <ul>
<li><a href="/title/Category:%E6%AD%A3%E9%AB%94%E4%B8%AD%E6%96%87" title="Category:正體中文">正體中文</a></li>
<li><a href="/title/Category:Printers_(%E6%AD%A3%E9%AB%94%E4%B8%AD%E6%96%87)" title="Category:Printers (正體中文)">Printers (正體中文)</a></li>
</ul>
</div>
<div id="mw-hidden-catlinks" class="mw-hidden-catlinks mw-hidden-cats-hidden">Hidden category: <ul><li><a href="/title/Category:Pages_or_sections_flagged_with_Template:Translateme_(%E6%AD%A3%E9%AB%94%E4%B8%AD%E6%96%87)" title="Category:Pages or sections flagged with Template:Translateme (正體中文)">Pages or sections flagged with Template:Translateme (正體中文)</a></li></ul>
</div>
</div>
	</div>
</div>

<footer id="footer" class="mw-footer" role="contentinfo" style="margin: 0">
	<ul id="footer-info">
		<li>Retrieved from "<a dir="ltr" href="https://wiki.archlinux.org/index.php?title=CUPS_(%E6%AD%A3%E9%AB%94%E4%B8%AD%E6%96%87)&amp;oldid=670544">https://wiki.archlinux.org/index.php?title=CUPS_(正體中文)&amp;oldid=670544</a>"</li>
		<li id="footer-info-lastmod"> This page was last edited on 11 May 2021, at 21:45.</li>
		<li id="footer-info-copyright">Content is available under <a class="external" rel="nofollow" href="http://www.gnu.org/copyleft/fdl.html">GNU Free Documentation License 1.3 or later</a> unless otherwise noted.</li>
	<br>
</ul>
	<ul id="footer-places">
		<li id="footer-places-privacy"><a href="/title/ArchWiki:Privacy_policy" title="ArchWiki:Privacy policy">Privacy policy</a></li>
		<li id="footer-places-about"><a href="/title/ArchWiki:About" title="ArchWiki:About">About ArchWiki</a></li>
		<li id="footer-places-disclaimer"><a href="/title/ArchWiki:General_disclaimer" title="ArchWiki:General disclaimer">Disclaimers</a></li>
	</ul>
	<ul id="footer-icons" class="noprint">
		<li id="footer-copyrightico">
	</ul>
	<div style="clear: both;"></div>
</footer>



</body>
</html>
