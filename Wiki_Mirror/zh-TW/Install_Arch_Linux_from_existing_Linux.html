<!DOCTYPE html>
<html class="client-nojs" lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<title>Install Arch Linux from existing Linux (正體中文) - ArchWiki</title>
<link rel="stylesheet" href="../ArchWikiOffline.css">
<meta name="ResourceLoaderDynamicStyles" content="">
<meta name="generator" content="MediaWiki 1.35.0">
<meta name="robots" content="noindex,follow">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="shortcut icon" href="/favicon.ico">
<link rel="search" type="application/opensearchdescription+xml" href="/opensearch_desc.php" title="ArchWiki (en)">
<link rel="EditURI" type="application/rsd+xml" href="https://wiki.archlinux.org/api.php?action=rsd">
<link rel="license" href="http://www.gnu.org/copyleft/fdl.html">
<link rel="alternate" type="application/atom+xml" title="ArchWiki Atom feed" href="/index.php?title=Special:RecentChanges&amp;feed=atom">
</head>
<body class="mediawiki ltr sitedir-ltr mw-hide-empty-elt ns-0 ns-subject page-Install_Arch_Linux_from_existing_Linux_正體中文 rootpage-Install_Arch_Linux_from_existing_Linux_正體中文 skin-vector action-view skin-vector-legacy">
<div id="content" class="mw-body" role="main" style="margin: 0">
	<a id="top"></a>
	<div id="siteNotice" class="mw-body-content"></div>
	<div class="mw-indicators mw-body-content">
	</div>
	<h1 id="firstHeading" class="firstHeading" lang="en">Install Arch Linux from existing Linux (正體中文)</h1>
	<div id="bodyContent" class="mw-body-content">
		<div id="siteSub" class="noprint">From ArchWiki</div>
		<div id="contentSub"></div>
		<div id="contentSub2"></div>
		
		<div id="jump-to-nav"></div>
		<a class="mw-jump-link" href="#mw-head">Jump to navigation</a>
		<a class="mw-jump-link" href="#searchInput">Jump to search</a>
		<div id="mw-content-text" lang="en" dir="ltr" class="mw-content-ltr">
<div class="warningbox">The printable version is no longer supported and may have rendering errors. Please update your browser bookmarks and please use the default browser print function instead.</div>
<div class="mw-parser-output">
<div class="noprint archwiki-template-message">
<p><a href="../File:Merge-arrows-2.png" class="image"><img alt="Merge-arrows-2.png" src="../File:Merge-arrows-2.png" decoding="async" width="48" height="48"></a><b>This article or section is a candidate for merging with <a href="../zh-TW/Install_Arch_Linux_from_existing_Linux.html" class="mw-redirect" title="Fast Arch Install from existing Linux System (正體中文)">Fast Arch Install from existing Linux System (正體中文)</a>.</b><a href="../File:Merge-arrows-2.png" class="image"><img alt="Merge-arrows-2.png" src="../File:Merge-arrows-2.png" decoding="async" width="48" height="48"></a></p>
<div>
<b>Notes:</b> this article has the correct title. (Discuss in <a rel="nofollow" class="external text" href="https://wiki.archlinux.org/index.php/Talk:Install_Arch_Linux_from_existing_Linux_(%E6%AD%A3%E9%AB%94%E4%B8%AD%E6%96%87)">Talk:Install Arch Linux from existing Linux (正體中文)#</a>)</div>
</div>
<div class="noprint archwiki-template-message">
<p><a href="../File:Tango-preferences-desktop-locale.png" class="image"><img alt="Tango-preferences-desktop-locale.png" src="../File:Tango-preferences-desktop-locale.png" decoding="async" width="48" height="48"></a><b>This article or section needs to be <a href="../en/ArchWiki:Contributing.html#Translating" title="ArchWiki:Contributing">translated</a>.</b><a href="../File:Tango-preferences-desktop-locale.png" class="image"><img alt="Tango-preferences-desktop-locale.png" src="../File:Tango-preferences-desktop-locale.png" decoding="async" width="48" height="48"></a></p>
<div>
<b>Notes:</b> <span style="color:red;">please use the first argument of the template to provide more detailed indications.</span> (Discuss in <a rel="nofollow" class="external text" href="https://wiki.archlinux.org/index.php/Talk:Install_Arch_Linux_from_existing_Linux_(%E6%AD%A3%E9%AB%94%E4%B8%AD%E6%96%87)">Talk:Install Arch Linux from existing Linux (正體中文)#</a>)</div>
</div>
<p>這份指南試圖結合這個Wiki上已存在且相似的三篇不同安裝指南。
也寫給對想在其它運作中的Linux平台(LiveCD或是已安裝的不同發行版)上安裝Arch Linux的任何使用者。
</p>
<div id="toc" class="toc" role="navigation" aria-labelledby="mw-toc-heading">
<input type="checkbox" role="button" id="toctogglecheckbox" class="toctogglecheckbox" style="display:none"><div class="toctitle" lang="en" dir="ltr">
<h2 id="mw-toc-heading">Contents</h2>
<span class="toctogglespan"><label class="toctogglelabel" for="toctogglecheckbox"></label></span>
</div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#%E7%B8%BD%E8%A6%BD"><span class="tocnumber">1</span> <span class="toctext">總覽</span></a></li>
<li class="toclevel-1 tocsection-2">
<a href="#%E8%A8%AD%E5%AE%9A_host_%E7%B3%BB%E7%B5%B1"><span class="tocnumber">2</span> <span class="toctext">設定 host 系統</span></a>
<ul>
<li class="toclevel-2 tocsection-3"><a href="#%E5%8F%96%E5%BE%97%E5%BF%85%E8%A6%81%E7%9A%84%E8%BB%9F%E9%AB%94%E5%8C%85"><span class="tocnumber">2.1</span> <span class="toctext">取得必要的軟體包</span></a></li>
<li class="toclevel-2 tocsection-4"><a href="#%E5%AE%89%E8%A3%9D%E5%BF%85%E8%A6%81%E6%AA%94%E6%A1%88%E5%88%B0_host_%E7%B3%BB%E7%B5%B1"><span class="tocnumber">2.2</span> <span class="toctext">安裝必要檔案到 host 系統</span></a></li>
<li class="toclevel-2 tocsection-5"><a href="#%E8%A8%AD%E7%BD%9D_host_%E7%B3%BB%E7%B5%B1%E7%B5%84%E6%85%8B"><span class="tocnumber">2.3</span> <span class="toctext">設罝 host 系統組態</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-6">
<a href="#%E8%A8%AD%E5%AE%9A_target_%E7%B3%BB%E7%B5%B1"><span class="tocnumber">3</span> <span class="toctext">設定 target 系統</span></a>
<ul>
<li class="toclevel-2 tocsection-7"><a href="#%E6%BA%96%E5%82%99%E5%88%86%E5%89%B2%E7%B5%A6_Arch_%E4%BD%BF%E7%94%A8"><span class="tocnumber">3.1</span> <span class="toctext">準備分割給 Arch 使用</span></a></li>
<li class="toclevel-2 tocsection-8"><a href="#%E5%AE%89%E8%A3%9D_core"><span class="tocnumber">3.2</span> <span class="toctext">安裝 core</span></a></li>
<li class="toclevel-2 tocsection-9"><a href="#%E6%BA%96%E5%82%99_/dev_nodes"><span class="tocnumber">3.3</span> <span class="toctext">準備 /dev nodes</span></a></li>
<li class="toclevel-2 tocsection-10"><a href="#Chroot"><span class="tocnumber">3.4</span> <span class="toctext">Chroot</span></a></li>
<li class="toclevel-2 tocsection-11"><a href="#%E5%AE%89%E8%A3%9D%E5%89%A9%E9%A4%98%E9%83%A8%E5%88%86"><span class="tocnumber">3.5</span> <span class="toctext">安裝剩餘部分</span></a></li>
<li class="toclevel-2 tocsection-12"><a href="#%E8%A8%AD%E7%BD%9D_target_%E7%B3%BB%E7%B5%B1%E7%B5%84%E6%85%8B"><span class="tocnumber">3.6</span> <span class="toctext">設罝 target 系統組態</span></a></li>
<li class="toclevel-2 tocsection-13"><a href="#%E8%A8%AD%E5%AE%9A_Grub"><span class="tocnumber">3.7</span> <span class="toctext">設定 Grub</span></a></li>
<li class="toclevel-2 tocsection-14"><a href="#Finishing_touches"><span class="tocnumber">3.8</span> <span class="toctext">Finishing touches</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-15">
<a href="#%E7%96%91%E9%9B%A3%E6%8E%92%E9%99%A4"><span class="tocnumber">4</span> <span class="toctext">疑難排除</span></a>
<ul>
<li class="toclevel-2 tocsection-16"><a href="#Kernel_Panic"><span class="tocnumber">4.1</span> <span class="toctext">Kernel Panic</span></a></li>
<li class="toclevel-2 tocsection-17"><a href="#Root_device_'/dev/sd??'_%E4%B8%8D%E5%AD%98%E5%9C%A8"><span class="tocnumber">4.2</span> <span class="toctext">Root device '/dev/sd??' 不存在</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-18">
<a href="#%E5%8F%A6%E4%B8%80%E5%80%8B%E6%96%B9%E6%B3%95:_%E7%94%A8_Arch_%E6%98%A0%E5%83%8F%E6%AA%94%E5%BE%9E%E5%B7%B2%E6%9C%89%E7%9A%84_Linux_%E5%AE%89%E8%A3%9D"><span class="tocnumber">5</span> <span class="toctext">另一個方法: 用 Arch 映像檔從已有的 Linux 安裝</span></a>
<ul>
<li class="toclevel-2 tocsection-19"><a href="#Preparing_the_Installation_Environment"><span class="tocnumber">5.1</span> <span class="toctext">Preparing the Installation Environment</span></a></li>
<li class="toclevel-2 tocsection-20"><a href="#Install_from_New_Environment"><span class="tocnumber">5.2</span> <span class="toctext">Install from New Environment</span></a></li>
<li class="toclevel-2 tocsection-21"><a href="#Update_and_Install_packages_from_host_system_via_chroot"><span class="tocnumber">5.3</span> <span class="toctext">Update and Install packages from host system via chroot</span></a></li>
</ul>
</li>
</ul>
</div>

<h2>
<span id=".E7.B8.BD.E8.A6.BD"></span><span class="mw-headline" id="總覽">總覽</span>
</h2>
<p>Arch Linux 的 <a href="../en/Pacman.html" title="Pacman">pacman</a> 可指定(-r)任何你想要的目錄作為"根目錄(root)"完成安裝操作。
這對在另一個發行版的LiveCD或已有的系統上從頭開始建罝一個新的Arch Linux系統很有幫助。
It's also useful for creating new chroot environments on a "host" system, 
maintaining a "golden-master" for development &amp; distribution, 
or other fun topics like rootfs-over-NFS for diskless machines. 
</p>
<p>以x86_64 host來說，它甚至有可能用i686-pacman建罝出32-bit的chroot環境。請參閱 <a href="../en/ArchWiki:Archive.html" class="mw-redirect" title="Arch64 Install bundled 32bit system">Arch64 Install bundled 32bit system</a>。
</p>
<p>Throughout this guide, we will refer to partitions as /dev/sdxx.  This refers to whatever dev entry you have on your system for the partition in question.   The convention is:
Drive 1, Partition 1: /dev/sda1
Drive 1, Partition 2: /dev/sda2
Drive 2, Partition 1: /dev/sdb1
etc...
</p>
<p>We will refer to it as /dev/sdxx whenever possible.
</p>
<p>如果你在安裝過程中有寬頻連線可用，而且只想作basic install，<a rel="nofollow" class="external text" href="http://unetbootin.sourceforge.net/">UNetBootin</a> 可能會是值得一看的容易解答。
(還有 <a href="../en/USB_flash_installation_medium.html#UNetBootin" class="mw-redirect" title="Putting installation media on a USB key">discussed here</a><sup>[<a href="../en/Help:Procedures.html#Fix_broken_section_links" title="Help:Procedures">broken link</a>: invalid section]</sup>.)
</p>
<p>In this article, "host" refers to the computer which is used to perform the installation, 
and "target" refers to the computer where you want to install Arch. 
These may be one and the same computer. 
The host does not need to be an Arch system -- it can be a Debian or Redhat system. 
The section entitled "Setup the host system" explains how to install pacman on the host. 
The following section entitle "Setup the target system" explains how to use pacman from the host system to install Arch on the target system. 
Therefore if the host system is already running Arch, you can skip to "Setup the target system".
</p>
<h2>
<span id=".E8.A8.AD.E5.AE.9A_host_.E7.B3.BB.E7.B5.B1"></span><span class="mw-headline" id="設定_host_系統">設定 host 系統</span>
</h2>
<p>你需要安裝archlinux軟體包管理程式<a href="../en/Pacman.html" title="Pacman">pacman</a>到你的 host linux 環境。 
另外你也會需要一份pacman映像站台清單，用來下載軟體包和它們自己的資料。
</p>
<h3>
<span id=".E5.8F.96.E5.BE.97.E5.BF.85.E8.A6.81.E7.9A.84.E8.BB.9F.E9.AB.94.E5.8C.85"></span><span class="mw-headline" id="取得必要的軟體包">取得必要的軟體包</span>
</h3>
<p>You need to get the required packages for your host linux environment. 
The examples given here assume you are using a i686 environment. 
<b>If you are running on an 64bit linux instead you should replace each occurance of "i686" with "x86_64".</b>
</p>
<p>All version numbers given here may change. Please check the version numbers the packages are at first and note them down. The version numbers can be found <a rel="nofollow" class="external text" href="https://www.archlinux.org/packages/core/i686/pacman/">here for pacman</a><sup title="Last check status: 404">[<a href="https://en.wikipedia.org/wiki/Wikipedia:Link_rot" class="extiw" title="wikipedia:Wikipedia:Link rot">dead link</a> 2020-08-02 ⓘ]</sup> and <a rel="nofollow" class="external text" href="https://www.archlinux.org/packages/core/i686/pacman-mirrorlist/">here for pacman-mirrorlist</a><sup title="Last check status: 404">[<a href="https://en.wikipedia.org/wiki/Wikipedia:Link_rot" class="extiw" title="wikipedia:Wikipedia:Link rot">dead link</a> 2020-08-02 ⓘ]</sup>. Once you are sure of the version numbers download the required packages:
</p>
<pre>mkdir /tmp/archlinux
cd /tmp/archlinux
wget <a rel="nofollow" class="external free" href="ftp://ftp.archlinux.org/core/os/i686/pacman-%5C*.pkg.tar.gz">ftp://ftp.archlinux.org/core/os/i686/pacman-\*.pkg.tar.gz</a>
tar xzvf pacman-*.pkg.tar.gz
</pre>
<h3>
<span id=".E5.AE.89.E8.A3.9D.E5.BF.85.E8.A6.81.E6.AA.94.E6.A1.88.E5.88.B0_host_.E7.B3.BB.E7.B5.B1"></span><span class="mw-headline" id="安裝必要檔案到_host_系統">安裝必要檔案到 host 系統</span>
</h3>
<p>If you do not mind littering your install host, you can extract all the downloaded tar balls into your root directory by running as root:
</p>
<pre>cd /
for f in /tmp/archlinux/pacman-*pkg.tar.gz
  tar xzf $f
done
</pre>
<ol>
<li><div>If installing from Ubuntu 9.10's LiveCD (perhaps other versions), you will need more than just the pacman files (shared libs) to use pacman at all.  Use Lucky's script described in <a rel="nofollow" class="external text" href="https://bbs.archlinux.org/viewtopic.php?pid=759166">this thread</a> to get/install them for you!
</div></li>
<li><div>Alternatively, you can instead turn these tarballs into packages for your distribution with the <a rel="nofollow" class="external text" href="http://kitenet.net/~joey/code/alien/">alien</a> tool. See the man page of the tool for instructions. The packages created that way may be installed into your host distribution using the usual package management tools available there. This approach offers the best integration into the host linux environment. For a debian package based system this is done with the following commands:
<pre>cd /tmp/archlinux
alien -d pacman-3.3.3-1-i686.pkg.tar.gz
alien -d pacman-mirrorlist-20101223-1-any.pkg.tar.gz
</pre>
<p><br>
RPM based systems will need to replace the parameter "-d" with "-r".
</p>
<p>These distribution packages can then get installed using the normal package management tools of the host linux environment.
</p>
</div></li>
<li><div>
<p>Under Fedora 12, I wasn't able to install pacman with any of the other methods, but with the nice script at <a rel="nofollow" class="external free" href="https://bbs.archlinux.org/viewtopic.php?pid=734336#p734336">https://bbs.archlinux.org/viewtopic.php?pid=734336#p734336</a> it will download and install it for you. Worked wonderfully for me.
</p>
</div></li>
<li><div>On <a rel="nofollow" class="external text" href="http://gentoo.org/">Gentoo</a>: First Install the <a rel="nofollow" class="external text" href="http://overlays.gentoo.org/proj/sunrise/">sunrise overlay</a><sup title="Last check status: 404">[<a href="https://en.wikipedia.org/wiki/Wikipedia:Link_rot" class="extiw" title="wikipedia:Wikipedia:Link rot">dead link</a> 2020-08-02 ⓘ]</sup>. Then unmask pacman by adding <tt>sys-apps/pacman</tt> to <tt>/etc/portage/package.keywords</tt>. Now just run <tt>emerge -av pacman</tt>.
<p>There is also a <a rel="nofollow" class="external text" href="http://ohnopub.net/~ohnobinki/gentoo/arch/">more detailed tutorial</a>.
</p>
</div></li>
<li><div>
<p>An older method is <a href="/index.php?title=Quick_Custom_Installation&amp;action=edit&amp;redlink=1" class="new" title="Quick Custom Installation (page does not exist)">discussed here</a>.
</p>
</div></li>
</ol>
<h3>
<span id=".E8.A8.AD.E7.BD.9D_host_.E7.B3.BB.E7.B5.B1.E7.B5.84.E6.85.8B"></span><span class="mw-headline" id="設罝_host_系統組態">設罝 host 系統組態</span>
</h3>
<p>Configure your /etc/pacman.conf to your liking, and remove unnecessary mirrors from /etc/pacman.d/mirrorlist. Also, enabling at least a few mirrors might become necessary, as you may experience errors during syncing if you have no mirror set. You may want to manually resolve DNS in the /etc/pacman.d/mirrorlist, because pacman for i686 may not be able to get address information on x86_64 systems.
</p>
<p>If you're installing from a LiveCD, and you have a system with a low amount of combined RAM and swap (&lt; 1 GB), be sure to set the cachedir in /etc/pacman.conf to be in the new Arch partition (e.g. <code>/newarch/var/cache/pacman/pkg</code>).   Otherwise you could exhaust memory between the overhead of the existing distro and downloading necessary packages to install.
</p>
<h2>
<span id=".E8.A8.AD.E5.AE.9A_target_.E7.B3.BB.E7.B5.B1"></span><span class="mw-headline" id="設定_target_系統">設定 target 系統</span>
</h2>
<h3>
<span id=".E6.BA.96.E5.82.99.E5.88.86.E5.89.B2.E7.B5.A6_Arch_.E4.BD.BF.E7.94.A8"></span><span class="mw-headline" id="準備分割給_Arch_使用">準備分割給 Arch 使用</span>
</h3>
<p>You don't <i>have to</i> install Arch on a separate partition. You could instead build up a root filesystem in a normal directory, and then create a master tarball from it, or transfer it across the network.
</p>
<p>However, most users will want to be installing Arch onto its own partition.
</p>
<p>Prepare any partitions and filesystems you need for your installation. If your host system has any gui tools for this, such as gparted, cfdisk, or mandrakes diskdrake, feel free to use them. 
</p>
<p>To format a partition as ext3, you run (where /dev/sdxx is the partition you want to setup): 
</p>
<pre># mkfs.ext3 /dev/sdxx 
</pre>
<p>To format it as ext3 with journaling and dir_index: 
</p>
<pre># mkfs.ext3 -j -O dir_index /dev/sdxx 
</pre>
<p>To format it as reiserfs: 
</p>
<pre># mkreiserfs /dev/sdxx 
</pre>
<p>To format a partition as swap, and to start using it: 
</p>
<pre># mkswap /dev/sdxx 
# swapon /dev/sdxx
</pre>
<p>Most other filesystems can be setup with their own mkfs variant, take a look with tab completion. Available filesystems depend entirely on your host system. 
</p>
<p>Once you have your filesystems setup, mount them. Throughout this guide, we will refer to the new Arch root directory as /newarch, however you can put it wherever you like. 
</p>
<pre># mkdir /newarch 
# mount /dev/sdxx /newarch
</pre>
<h3>
<span id=".E5.AE.89.E8.A3.9D_core"></span><span class="mw-headline" id="安裝_core">安裝 core</span>
</h3>
<p>Update pacman. You may have to create the <code>/newarch/var/lib/pacman</code> folder for it to work (see "Setup the host system" above):
</p>
<pre># mkdir -p /newarch/var/lib/pacman 
# pacman -Sy -r /newarch
</pre>
<p>Install the 'base' group of packages:
</p>
<pre># pacman -S base -r /newarch
</pre>
<p><b>NOTE:</b> The -r parameter doesn't change the location of Pacman's cache directory. If you don't want Pacman's cache to be created in your host distro, supply another location with --cachedir, or modify pacman.conf as described <a href="#Configure_the_host_system">above</a><sup>[<a href="../en/Help:Procedures.html#Fix_broken_section_links" title="Help:Procedures">broken link</a>: invalid section]</sup>.
</p>
<h3>
<span id=".E6.BA.96.E5.82.99_.2Fdev_nodes"></span><span class="mw-headline" id="準備_/dev_nodes">準備 /dev nodes</span>
</h3>
<p>First, ensure the correct /dev nodes have been made for udev:
</p>
<pre>ls -alF /newarch/dev
</pre>
<p>This result in a list containing lines similar to the following (the dates will differ for you):
</p>
<pre>crw-------  1 root root 5, 1 2008-12-27 21:40 console
crw-rw-rw-  1 root root 1, 3 2008-12-27 21:42 null
crw-rw-rw-  1 root root 1, 5 2008-12-27 21:40 zero
</pre>
<p>Delete and recreate any device which has a different set of permissions (the crw-... stuff plus the two root entries) and major/minor numbers (the two before the date).
</p>
<pre>cd /newarch/dev 
rm console ; mknod -m 600 console c 5 1 
rm null ; mknod -m 666 null c 1 3 
rm zero ; mknod -m 666 zero c 1 5
</pre>
<p>All device nodes should have been created for you already with the right permissions and you should not need to recreate any of them.
</p>
<h3><span class="mw-headline" id="Chroot">Chroot</span></h3>
<p>Now we will <a href="../en/Chroot.html" class="mw-redirect" title="Change root">chroot into the new Arch system</a>.
</p>
<p>In order for DNS to work properly you need to edit <code>/newarch/etc/resolv.conf</code> or replace it with the resolv.conf from your running distribution 
</p>
<pre>cp /etc/resolv.conf /newarch/etc/ 
</pre>
<p>Also, you need to copy a correctly setup mirrorlist into the new system:
</p>
<pre>cp /etc/pacman.d/mirrorlist /newarch/etc/pacman.d
</pre>
<p>Mount various filesystems into the new Arch system: 
</p>
<pre>mount -t proc proc /newarch/proc
mount -t sysfs sys /newarch/sys
mount -o bind /dev /newarch/dev
</pre>
<p>If you have a separate <code>/boot</code> partition, you'll probably need to mount that too. See <a href="../en/Chroot.html" class="mw-redirect" title="Change root">Change root</a> for more details.
</p>
<p>When everything is prepared, chroot into the new filesystem: 
</p>
<pre>chroot /newarch /bin/bash
</pre>
<h3>
<span id=".E5.AE.89.E8.A3.9D.E5.89.A9.E9.A4.98.E9.83.A8.E5.88.86"></span><span class="mw-headline" id="安裝剩餘部分">安裝剩餘部分</span>
</h3>
<p>Install your preferred kernel, and any other packages you may wish to install. 
For the default kernel (which is already installed!):
</p>
<pre>pacman -S linux
</pre>
<p>If you wish to install extra packages now, you may do so with: 
</p>
<pre>pacman -S packagename
</pre>
<h3>
<span id=".E8.A8.AD.E7.BD.9D_target_.E7.B3.BB.E7.B5.B1.E7.B5.84.E6.85.8B"></span><span class="mw-headline" id="設罝_target_系統組態">設罝 target 系統組態</span>
</h3>
<p>Edit your <code>/etc/fstab</code>, remembering to add /, swap and any other partitions you may wish to use. 
</p>
<p>Edit your <code>/etc/rc.conf</code>, <code>/etc/hosts</code> and <code>/etc/mkinitcpio.conf</code> to your needs. Then rebuild your initcpio image: 
</p>
<pre>mkinitcpio -p linux

</pre>
<p>Edit <code>/etc/locale.gen</code>, uncommenting any locales you wish to have available, and build the locales: 
</p>
<pre>locale-gen
</pre>
<h3>
<span id=".E8.A8.AD.E5.AE.9A_Grub"></span><span class="mw-headline" id="設定_Grub">設定 Grub</span>
</h3>
<p>To use <a href="../en/GRUB.html" title="GRUB">GRUB</a> when chrooted, you need to ensure that <code>/etc/mtab</code> is up-to-date:
</p>
<pre>grep -v rootfs /proc/mounts &gt; /etc/mtab  
</pre>
<p>You can now run: 
</p>
<pre>grub-install /dev/sdx
</pre>
<p>If grub-install fails, you can manually install:
</p>
<pre>grub 
grub&gt; find /boot/grub/stage1     (You should see some results here if you have done everything right so far.   If not, back up and retrace your steps.)
grub&gt; root (hd0,X) 
grub&gt; setup (hd0) 
grub&gt; quit 
</pre>
<p>Double-check your <code>/boot/grub/menu.lst</code>. Depending on the host, it could need correcting from hda to sda, and a prefix of /boot as well in the paths. 
</p>
<p>Detailed instructions for <a href="../en/GRUB.html" title="GRUB">GRUB</a> and <a href="../en/LILO.html" title="LILO">LILO</a> are available elsewhere on this wiki.
</p>
<h3><span class="mw-headline" id="Finishing_touches">Finishing touches</span></h3>
<p><a href="../en/Chroot.html#Cleaning_up" class="mw-redirect" title="Change root">Exit your chroot</a><sup>[<a href="../en/Help:Procedures.html#Fix_broken_section_links" title="Help:Procedures">broken link</a>: invalid section]</sup>:
</p>
<pre>  exit
  umount /newarch/boot   # if you mounted this or any other separate partitions
  umount /newarch/{proc,sys,dev}
  umount /newarch
</pre>
<p>Reboot to your new Arch system!
</p>
<h2>
<span id=".E7.96.91.E9.9B.A3.E6.8E.92.E9.99.A4"></span><span class="mw-headline" id="疑難排除">疑難排除</span>
</h2>
<h3><span class="mw-headline" id="Kernel_Panic">Kernel Panic</span></h3>
<p>如果在重開機到你的新系統時遇到 kernel panic 說 console 打不開： 
</p>
<pre>kinit: couldn't open console, no such file... 
</pre>
<p>這表示你沒有跟著前面的步驟做。在開頭準備的地方照著步驟來產生basic device nodes。
</p>
<h3>
<span id="Root_device_.27.2Fdev.2Fsd.3F.3F.27_.E4.B8.8D.E5.AD.98.E5.9C.A8"></span><span class="mw-headline" id="Root_device_'/dev/sd??'_不存在">Root device '/dev/sd??' 不存在</span>
</h3>
<p>If when you reboot into your new system you get a error messages like this: 
</p>
<pre>Root device '/dev/sda1' doesn't exist, attempting to create it... etc. 
</pre>
<p>This means the drives are showing up as "hda1" instead of "sda1" In which case change your GRUB or LILO settings to use "hd??" or try the following. 
</p>
<p>Edit /etc/mkinitcpio.conf and change "ide" to "pata" in the "HOOKS=" line. Then regenerate your initrd. (Make sure you have chroot'ed into the new system first.) 
</p>
<pre>mkinitcpio -p linux
</pre>
<p>If you are using LVM make sure you add "lvm2" in the HOOKS line. Regenerate your initrd as above.
</p>
<p>If you're installing to a device that needs PATA hook make sure it's located before autodetect hook in mkinitcpio.conf.
</p>
<h1>
<span id=".E5.8F.A6.E4.B8.80.E5.80.8B.E6.96.B9.E6.B3.95:_.E7.94.A8_Arch_.E6.98.A0.E5.83.8F.E6.AA.94.E5.BE.9E.E5.B7.B2.E6.9C.89.E7.9A.84_Linux_.E5.AE.89.E8.A3.9D"></span><span class="mw-headline" id="另一個方法:_用_Arch_映像檔從已有的_Linux_安裝">另一個方法: 用 Arch 映像檔從已有的 Linux 安裝</span>
</h1>
<h3><span class="mw-headline" id="Preparing_the_Installation_Environment">Preparing the Installation Environment</span></h3>
<p>You can grab whatever image from Arch's Download Page and get the content of image by mount loopback:
</p>
<p>CD Image:  
</p>
<pre>$ mount -o loop archlinux-2009.08-core-i686.iso /mnt/loop
</pre>
<p>with USB Image:
</p>
<pre>$ losetup -f archlinux-2009.08-core-i686.img
$ losetup -fo 32256 /dev/loop0
$ mount /dev/loop0 /mnt/loop
</pre>
<p>and the content of image:
</p>
<pre>$ ls /mnt/loop 
boot  core-pkgs.sqfs  isomounts  lost+found  overlay.sqfs  root-image.sqfs
</pre>
<p>extract the root image:
</p>
<pre>$ cd /mnt
$ unsquashfs loop/root-image.sqfs
</pre>
<p>after this step, you will have a new squashfs-root directory which contain new Arch system.
</p>
<h3><span class="mw-headline" id="Install_from_New_Environment">Install from New Environment</span></h3>
<p>If you have Core Arch installation media, and want to install the core packages from it, just copy core-pkgs.sqfs to new squashfs-root directory:
</p>
<pre>$ cp loop/core-pkgs.sqfs squashfs-root
</pre>
<p>Now <a href="../en/Chroot.html" class="mw-redirect" title="Change root">chroot into the new Arch system</a>: 
</p>
<pre>$ mount -t proc proc /mnt/squashfs-root/proc
$ mount -t sysfs sys /mnt/squashfs-root/sys
$ mount -o bind /dev /mnt/squashfs-root/dev 
$ chroot /mnt/squashfs-root /bin/bash
</pre>
<p>Now you're inside the new installation's filesystem. If you're going to use core-pkgs.sqfs, mount it now:
</p>
<pre>$ mkdir -p /src/core/pkg
$ mount -o loop -t squashfs core-pkgs.sqfs /src/core/pkg 
</pre>
<p>At this point, go ahead and launch Arch's aif installer!
</p>
<pre>$ aif -p interactive
</pre>
<p>and you can install Arch as normal (from CD or Internet) with the notice:
</p>
<ul><li>Your target partition must not using by host system</li></ul>
<p><br>
After installing Arch from chroot's environment, you can remove any squashfs-root directory and exit the chroot:
</p>
<pre>$ umount /src/core/pkg
$ exit
$ umount /mnt/squashfs-root/dev 
$ umount /mnt/squashfs-root/sys 
$ umount /mnt/squashfs-root/proc
$ rm -rf /mnt/squashfs-root
</pre>
<h3><span class="mw-headline" id="Update_and_Install_packages_from_host_system_via_chroot">Update and Install packages from host system via chroot</span></h3>
<p>Add an entry to your existing Grub bootloader's menu.lst, or if you installed a new Grub during the Arch installation process, add it to the /boot/grub/menu.lst on your Arch filesystem.
</p>
<p>Now either reboot or <a href="../en/Chroot.html" class="mw-redirect" title="Change root">chroot</a> into the new Arch's partition to install further packages:
</p>
<pre>$ mkdir /mnt/arch
$ mount /dev/sdxx /mnt/arch
$ mount -t proc proc /mnt/arch/proc
$ mount -t sysfs sys /mnt/arch/sys
$ mount -o bind /dev /mnt/arch/dev 
$ chroot /mnt/arch /bin/bash
</pre>
<p>Update and install new packages:
</p>
<pre># pacman -Syu
</pre>
</div>
</div>
<div id="catlinks" class="catlinks" data-mw="interface">
<div id="mw-normal-catlinks" class="mw-normal-catlinks">
<a href="../Special:Categories.html" title="Special:Categories">Categories</a>: <ul>
<li><a href="../zh-TW/Category:Installation_process.html" title="Category:Installation process (正體中文)">Installation process (正體中文)</a></li>
<li><a href="../en/Category:7d876dcc0aeb99723c8082d6986c7db5.html" title="Category:正體中文">正體中文</a></li>
</ul>
</div>
<div id="mw-hidden-catlinks" class="mw-hidden-catlinks mw-hidden-cats-hidden">Hidden categories: <ul>
<li><a href="../en/Category:Pages_or_sections_flagged_with_Template:Merge.html" title="Category:Pages or sections flagged with Template:Merge">Pages or sections flagged with Template:Merge</a></li>
<li><a href="../en/Category:Pages_or_sections_flagged_with_Template:Translateme.html" title="Category:Pages or sections flagged with Template:Translateme">Pages or sections flagged with Template:Translateme</a></li>
<li><a href="../en/Category:Pages_with_broken_section_links.html" title="Category:Pages with broken section links">Pages with broken section links</a></li>
<li><a href="../en/Category:Pages_with_dead_links.html" title="Category:Pages with dead links">Pages with dead links</a></li>
</ul>
</div>
</div>
	</div>
</div>

<footer id="footer" class="mw-footer" role="contentinfo" style="margin: 0">
	<ul id="footer-info">
		<li>Retrieved from "<a dir="ltr" href="https://wiki.archlinux.org/index.php?title=Install_Arch_Linux_from_existing_Linux_(%E6%AD%A3%E9%AB%94%E4%B8%AD%E6%96%87)&amp;oldid=638439">https://wiki.archlinux.org/index.php?title=Install_Arch_Linux_from_existing_Linux_(正體中文)&amp;oldid=638439</a>"</li>
		<li id="footer-info-lastmod"> This page was last edited on 14 October 2020, at 07:12.</li>
		<li id="footer-info-copyright">Content is available under <a class="external" rel="nofollow" href="http://www.gnu.org/copyleft/fdl.html">GNU Free Documentation License 1.3 or later</a> unless otherwise noted.</li>
	<br>
</ul>
	<ul id="footer-places">
		<li id="footer-places-privacy"><a href="../en/ArchWiki:Privacy_policy.html" title="ArchWiki:Privacy policy">Privacy policy</a></li>
		<li id="footer-places-about"><a href="../en/ArchWiki:About.html" title="ArchWiki:About">About ArchWiki</a></li>
		<li id="footer-places-disclaimer"><a href="../en/ArchWiki:General_disclaimer.html" title="ArchWiki:General disclaimer">Disclaimers</a></li>
	</ul>
	<ul id="footer-icons" class="noprint">
		<li id="footer-copyrightico">
	</ul>
	<div style="clear: both;"></div>
</footer>



</body>
</html>
