<!DOCTYPE html>
<html class="client-nojs" lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<title>Creating Arch Linux disk image (العربية) - ArchWiki</title>
<link rel="stylesheet" href="../ArchWikiOffline.css">
<meta name="ResourceLoaderDynamicStyles" content="">
<meta name="generator" content="MediaWiki 1.35.0">
<meta name="referrer" content="no-referrer-when-downgrade">
<meta name="robots" content="noindex,follow">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="shortcut icon" href="/favicon.ico">
<link rel="search" type="application/opensearchdescription+xml" href="/opensearch_desc.php" title="ArchWiki (en)">
<link rel="EditURI" type="application/rsd+xml" href="https://wiki.archlinux.org/api.php?action=rsd">
<link rel="license" href="http://www.gnu.org/copyleft/fdl.html">
<link rel="alternate" type="application/atom+xml" title="ArchWiki Atom feed" href="/index.php?title=Special:RecentChanges&amp;feed=atom">
</head>
<body class="mediawiki ltr sitedir-ltr mw-hide-empty-elt ns-0 ns-subject page-Creating_Arch_Linux_disk_image_العربية rootpage-Creating_Arch_Linux_disk_image_العربية skin-vector action-view skin-vector-legacy">
<div id="content" class="mw-body" role="main" style="margin: 0">
	<a id="top"></a>
	<div id="siteNotice" class="mw-body-content"></div>
	<div class="mw-indicators mw-body-content">
	</div>
	<h1 id="firstHeading" class="firstHeading" lang="en">Creating Arch Linux disk image (العربية)</h1>
	<div id="bodyContent" class="mw-body-content">
		<div id="siteSub" class="noprint">From ArchWiki</div>
		<div id="contentSub"></div>
		<div id="contentSub2"></div>
		
		<div id="jump-to-nav"></div>
		<a class="mw-jump-link" href="#mw-head">Jump to navigation</a>
		<a class="mw-jump-link" href="#searchInput">Jump to search</a>
		<div id="mw-content-text" lang="en" dir="ltr" class="mw-content-ltr">
<div class="warningbox">The printable version is no longer supported and may have rendering errors. Please update your browser bookmarks and please use the default browser print function instead.</div>
<div class="mw-parser-output">
<div class="noprint archwiki-template-message">
<p><a href="/title/File:Tango-preferences-desktop-locale-modified.png" class="image"><img alt="Tango-preferences-desktop-locale-modified.png" src="../File:Tango-preferences-desktop-locale-modified.png" decoding="async" width="48" height="48"></a><b>The <a href="/title/ArchWiki:Contributing#Translating" title="ArchWiki:Contributing">translation</a> of this article or section does not reflect the original text.</b><a href="/title/File:Tango-preferences-desktop-locale-modified.png" class="image"><img alt="Tango-preferences-desktop-locale-modified.png" src="../File:Tango-preferences-desktop-locale-modified.png" decoding="async" width="48" height="48"></a></p>
<div>
<b>Reason:</b> Last updated in 2013 and page no exists in English (Discuss in <a rel="nofollow" class="external text" href="https://wiki.archlinux.org/title/Talk:Creating_Arch_Linux_disk_image_(%D8%A7%D9%84%D8%B9%D8%B1%D8%A8%D9%8A%D8%A9)">Talk:Creating Arch Linux disk image (العربية)#</a>)</div>
</div>
<div align="right" dir="rtl">
<p>هذا المُستند يقوم بشرح كيفية إنشاء ملف يحتوي على صورة قرص لتوزيعة Arch Linux . صورة القرص يمكنها العمل على أحد برامج الآلة الافتراضية <a href="/title/QEMU" title="QEMU">QEMU</a>, <a href="/title/VirtualBox" title="VirtualBox">VirtualBox</a>, أو <a href="/title/VMware" title="VMware">VMware</a>, و يمكنك تخصيصها كيفما تشاء .
</p>
<div id="toc" class="toc" role="navigation" aria-labelledby="mw-toc-heading">
<input type="checkbox" role="button" id="toctogglecheckbox" class="toctogglecheckbox" style="display:none"><div class="toctitle" lang="en" dir="ltr">
<h2 id="mw-toc-heading">Contents</h2>
<span class="toctogglespan"><label class="toctogglelabel" for="toctogglecheckbox"></label></span>
</div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Archiso"><span class="tocnumber">1</span> <span class="toctext">Archiso</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#%D8%AA%D9%86%D8%B5%D9%8A%D8%A8_Arch_Linux_%D8%AF%D8%A7%D8%AE%D9%84_%D8%B5%D9%88%D8%B1%D8%A9_%D9%82%D8%B1%D8%B5_%D8%A8%D8%A7%D8%B3%D8%AA%D8%AE%D8%AF%D8%A7%D9%85_%D9%88%D8%B3%D9%8A%D8%B7_%D8%A7%D9%84%D8%AA%D9%86%D8%B5%D9%8A%D8%A8"><span class="tocnumber">2</span> <span class="toctext">تنصيب Arch Linux داخل صورة قرص باستخدام وسيط التنصيب</span></a></li>
<li class="toclevel-1 tocsection-3">
<a href="#%D8%AA%D9%86%D8%B5%D9%8A%D8%A8_Arch_Linux_%D8%AF%D8%A7%D8%AE%D9%84_%D8%B5%D9%88%D8%B1%D8%A9_%D9%82%D8%B1%D8%B5_%D8%AF%D9%88%D9%86_%D8%A7%D8%B3%D8%AA%D8%AE%D8%AF%D8%A7%D9%85_%D9%88%D8%B3%D9%8A%D8%B7_%D8%A7%D9%84%D8%AA%D9%86%D8%B5%D9%8A%D8%A8"><span class="tocnumber">3</span> <span class="toctext">تنصيب Arch Linux داخل صورة قرص دون استخدام وسيط التنصيب</span></a>
<ul>
<li class="toclevel-2 tocsection-4"><a href="#%D8%A5%D9%86%D8%B4%D8%A7%D8%A1_%D9%85%D9%84%D9%81_%D8%AE%D8%A7%D9%85_%D9%84%D8%B5%D9%88%D8%B1%D8%A9_%D8%A7%D9%84%D9%82%D8%B1%D8%B5"><span class="tocnumber">3.1</span> <span class="toctext">إنشاء ملف خام لصورة القرص</span></a></li>
<li class="toclevel-2 tocsection-5">
<a href="#%D8%A5%D9%86%D8%B4%D8%A7%D8%A1_%D8%A3%D9%86%D8%B8%D9%85%D8%A9_%D8%A7%D9%84%D9%85%D9%84%D9%81%D8%A7%D8%AA_%D9%81%D9%8A_%D8%A7%D9%84%D9%82%D8%B1%D8%B5_%D8%A7%D9%84%D8%AE%D8%A7%D9%85"><span class="tocnumber">3.2</span> <span class="toctext">إنشاء أنظمة الملفات في القرص الخام</span></a>
<ul>
<li class="toclevel-3 tocsection-6"><a href="#%D8%A7%D8%B3%D8%AA%D8%AE%D8%AF%D9%85_%D8%A7%D9%84%D9%82%D8%B1%D8%B5_%D8%A8%D8%A3%D9%83%D9%85%D9%84%D9%87_%D9%83%D9%86%D8%B8%D8%A7%D9%85_%D9%85%D9%84%D9%81%D8%A7%D8%AA_%D9%88%D8%AD%D9%8A%D8%AF"><span class="tocnumber">3.2.1</span> <span class="toctext">استخدم القرص بأكمله كنظام ملفات وحيد</span></a></li>
<li class="toclevel-3 tocsection-7"><a href="#%D8%A7%D8%B3%D8%AA%D8%AE%D8%AF%D8%A7%D9%85_%D8%B9%D8%AF%D8%A9_%D9%82%D8%B7%D8%A7%D8%B9%D8%A7%D8%AA"><span class="tocnumber">3.2.2</span> <span class="toctext">استخدام عدة قطاعات</span></a></li>
</ul>
</li>
<li class="toclevel-2 tocsection-8"><a href="#%D8%AA%D9%86%D8%B5%D9%8A%D8%A8_%D8%A7%D9%84%D8%AD%D8%B2%D9%85_%D8%B9%D9%84%D9%89_%D8%A7%D9%84%D9%86%D8%B8%D8%A7%D9%85_%D8%A7%D9%84%D8%B6%D9%8A%D9%81"><span class="tocnumber">3.3</span> <span class="toctext">تنصيب الحزم على النظام الضيف</span></a></li>
<li class="toclevel-2 tocsection-9"><a href="#Write_a_fstab_file_for_the_guest"><span class="tocnumber">3.4</span> <span class="toctext">Write a fstab file for the guest</span></a></li>
<li class="toclevel-2 tocsection-10"><a href="#Generate_initramfs_for_the_guest"><span class="tocnumber">3.5</span> <span class="toctext">Generate initramfs for the guest</span></a></li>
<li class="toclevel-2 tocsection-11">
<a href="#%D8%AA%D9%86%D8%B5%D9%8A%D8%A8_%D9%85%D9%8F%D8%AD%D9%85%D9%84_%D8%A7%D9%84%D8%A5%D9%82%D9%84%D8%A7%D8%B9_%D8%B9%D9%84%D9%89_%D8%A7%D9%84%D9%86%D8%B8%D8%A7%D9%85_%D8%A7%D9%84%D8%B6%D9%8A%D9%81"><span class="tocnumber">3.6</span> <span class="toctext">تنصيب مُحمل الإقلاع على النظام الضيف</span></a>
<ul>
<li class="toclevel-3 tocsection-12"><a href="#Extlinux"><span class="tocnumber">3.6.1</span> <span class="toctext">Extlinux</span></a></li>
<li class="toclevel-3 tocsection-13"><a href="#GRUB2"><span class="tocnumber">3.6.2</span> <span class="toctext">GRUB2</span></a></li>
</ul>
</li>
<li class="toclevel-2 tocsection-14"><a href="#%D8%A5%D8%B2%D8%A7%D9%84%D8%A9_%D8%A7%D9%84%D9%85%D9%84%D9%81%D8%A7%D8%AA_%D8%A7%D9%84%D9%85%D8%A4%D9%82%D8%AA%D8%A9"><span class="tocnumber">3.7</span> <span class="toctext">إزالة الملفات المؤقتة</span></a></li>
<li class="toclevel-2 tocsection-15"><a href="#%D8%A5%D9%82%D9%84%D8%A7%D8%B9_%D8%A7%D9%84%D9%86%D8%B8%D8%A7%D9%85_%D8%A7%D9%84%D8%B6%D9%8A%D9%81"><span class="tocnumber">3.8</span> <span class="toctext">إقلاع النظام الضيف</span></a></li>
<li class="toclevel-2 tocsection-16"><a href="#%D8%AA%D9%84%D9%85%D9%8A%D8%AD%D8%A7%D8%AA"><span class="tocnumber">3.9</span> <span class="toctext">تلميحات</span></a></li>
</ul>
</li>
</ul>
</div>

<h2><span class="mw-headline" id="Archiso">Archiso</span></h2>
<p>إن <a rel="nofollow" class="external text" href="https://archlinux.org/download/">الوسيط الافتراضي للتنصيب </a> هو ملف ISO , لذا يمكنك الإقلاع منها كقرص عادي أو باستخدام سواقة CD-ROM , لكن بما أنها تستخدم نظام ملفات ISO , فلا يمكنك الكتابة عليها دون إعادة إنشاء قرص التنصيب .
</p>
<p>يمكنك أيضا إنشاء قرص الحي من توزيعة Arch Linux الخاص بك عن طريق مجموعة أدوات <a href="/title/Archiso_(%D8%A7%D9%84%D8%B9%D8%B1%D8%A8%D9%8A%D8%A9)" title="Archiso (العربية)">Archiso</a> .
, لربما يكون هذا هو غرضك لكن مع ذلك فإن Archiso مُصمم لإنشاء أقراص إقلاعية حيّة لكن نظام ملفاتها يكون أيضاً للقراءة فقط ولا يمكن الكتابة عليه .
</p>
<h2>
<span id=".D8.AA.D9.86.D8.B5.D9.8A.D8.A8_Arch_Linux_.D8.AF.D8.A7.D8.AE.D9.84_.D8.B5.D9.88.D8.B1.D8.A9_.D9.82.D8.B1.D8.B5_.D8.A8.D8.A7.D8.B3.D8.AA.D8.AE.D8.AF.D8.A7.D9.85_.D9.88.D8.B3.D9.8A.D8.B7_.D8.A7.D9.84.D8.AA.D9.86.D8.B5.D9.8A.D8.A8"></span><span class="mw-headline" id="تنصيب_Arch_Linux_داخل_صورة_قرص_باستخدام_وسيط_التنصيب">تنصيب Arch Linux داخل صورة قرص باستخدام وسيط التنصيب</span>
</h2>
<p>باستخدام <a href="/title/QEMU" title="QEMU">QEMU</a>, <a href="/title/VirtualBox" title="VirtualBox">VirtualBox</a>, أو أي من برامج الآلة الإفتراضية , يُمكنك تنصيب Arch Linux على صورة القرص عن طريق إقلاعه من <a rel="nofollow" class="external text" href="https://archlinux.org/download/">وسيط التنصيب</a> من داخل برنامج الآلة الإفتراضية الذي تستخدمه مُستخدماً وسيط التثبيت كأحد الأقراص الصلبة داخل الآلة الإفتراضية . هذه هي أفضل طريقة لإنشاء صورة قرص وهمي يحوي على Arch Linux , لأن عملية التنصيب داخل الآلة الإفتراضية مشابهة تماماً لتنصيبها على القرص الصلب .
</p>
<h2>
<span id=".D8.AA.D9.86.D8.B5.D9.8A.D8.A8_Arch_Linux_.D8.AF.D8.A7.D8.AE.D9.84_.D8.B5.D9.88.D8.B1.D8.A9_.D9.82.D8.B1.D8.B5_.D8.AF.D9.88.D9.86_.D8.A7.D8.B3.D8.AA.D8.AE.D8.AF.D8.A7.D9.85_.D9.88.D8.B3.D9.8A.D8.B7_.D8.A7.D9.84.D8.AA.D9.86.D8.B5.D9.8A.D8.A8"></span><span class="mw-headline" id="تنصيب_Arch_Linux_داخل_صورة_قرص_دون_استخدام_وسيط_التنصيب">تنصيب Arch Linux داخل صورة قرص دون استخدام وسيط التنصيب</span>
</h2>
<p>يمكن أيضاً إنشاء صورة قرص وهمي يحوي على Arch linux باستخدام البرمجيات و الحزم الموجودة على نظام Arch linux المُستضيف , لهذه الطريقة عدة محاسن :
</p>
<ul>
<li>لا يتوجب عليك أن تملك قرص التنصيب الخاص بتوزيعة Arch linux .</li>
<li>يمكنك تضمين آخر البرمجيات والحزم في صورة القرص و ذلك عن طريق تنصيبهم باستخدام مدير الحزم على النظام المُستضيف .</li>
<li>يمكنك تعديل و تخصيص صورة القرص بشكل يمكن أن لا يدعمه مثبت Arch linux .</li>
</ul>
<p>على أي حال هذه الطريقة أصعب بكثير من الطريقة السابقة , بالإضافة الى ذلك فهي لن تعمل إذا لم يكن هنالك مدير الحزم  <a href="/title/Pacman" title="Pacman">pacman</a> على النظام المُتسضيف (النظام المُستضيف لا يعمل بنظام Arch linux)
</p>
<p>في الفقرات التالية سيتم الإارة الى النظام الذي يعمل بتوزيعة Arch linux والذي تعمل عليه حالياً بـ"النظام المُستضيف" , بينما يتم الإشارة الى النظام الذي ستقوم بإنشاء صورة القرص له باسم "النظام الضيف" .
</p>
<h3>
<span id=".D8.A5.D9.86.D8.B4.D8.A7.D8.A1_.D9.85.D9.84.D9.81_.D8.AE.D8.A7.D9.85_.D9.84.D8.B5.D9.88.D8.B1.D8.A9_.D8.A7.D9.84.D9.82.D8.B1.D8.B5"></span><span class="mw-headline" id="إنشاء_ملف_خام_لصورة_القرص">إنشاء ملف خام لصورة القرص</span>
</h3>
<ul><li>إنشاء ملف خام للعمل عليه داخل الآلة الإفتراضية , في المثال التالي سيتم إنشاء ملف بحجم تخزيني يساوي 1GiB :</li></ul>
<div align="left" dir="ltr">
<pre>$ dd if=/dev/zero of=archlinux.raw bs=4096 count=262144
</pre>
</div>
<p>أو بطريقة اخرى , في أنظمة الأقراص التي تدعم دالة النظام <code>fallocate()</code> يمكن تنفيذ التعليمة التالية :
</p>
<div align="left" dir="ltr">
<pre>$ fallocate -l 1G archlinux.raw
</pre>
</div>
<ul><li>اذا قمت بتنصيب <a href="/title/QEMU" title="QEMU">QEMU</a>, يمكنك استخدام <code>qemu-img create</code> لإنشاء صورة القرص الخام . التعليمة  <code>qemu-img</code> يمكنها أيضاً إنشاء صورة قرص لكن بإحدى الصيغ الاخرى كصيغة qcow2 . provided that you export the image using <code>qemu-nbd</code> to set up a device that appears to contain the actual data of the disk image.</li></ul>
<h3>
<span id=".D8.A5.D9.86.D8.B4.D8.A7.D8.A1_.D8.A3.D9.86.D8.B8.D9.85.D8.A9_.D8.A7.D9.84.D9.85.D9.84.D9.81.D8.A7.D8.AA_.D9.81.D9.8A_.D8.A7.D9.84.D9.82.D8.B1.D8.B5_.D8.A7.D9.84.D8.AE.D8.A7.D9.85"></span><span class="mw-headline" id="إنشاء_أنظمة_الملفات_في_القرص_الخام">إنشاء أنظمة الملفات في القرص الخام</span>
</h3>
<h4>
<span id=".D8.A7.D8.B3.D8.AA.D8.AE.D8.AF.D9.85_.D8.A7.D9.84.D9.82.D8.B1.D8.B5_.D8.A8.D8.A3.D9.83.D9.85.D9.84.D9.87_.D9.83.D9.86.D8.B8.D8.A7.D9.85_.D9.85.D9.84.D9.81.D8.A7.D8.AA_.D9.88.D8.AD.D9.8A.D8.AF"></span><span class="mw-headline" id="استخدم_القرص_بأكمله_كنظام_ملفات_وحيد">استخدم القرص بأكمله كنظام ملفات وحيد</span>
</h4>
<p>إذا لم تكن هناك الحاجة الى إنشاء عدة قطاعات في نظام Arch linux الضيف , فتكون أسهل طريقة بإنشاء نظام ملفات وحيد على القرص الخام , لإنشاء نظام ملفات ext4 قم بتنفيذ التعليمة التالية :
</p>
<div align="left" dir="ltr">
<pre>$ mkfs.ext4 -F archlinux.raw
</pre>
</div>
<h4>
<span id=".D8.A7.D8.B3.D8.AA.D8.AE.D8.AF.D8.A7.D9.85_.D8.B9.D8.AF.D8.A9_.D9.82.D8.B7.D8.A7.D8.B9.D8.A7.D8.AA"></span><span class="mw-headline" id="استخدام_عدة_قطاعات">استخدام عدة قطاعات</span>
</h4>
<p>أو يمكنك استخدام الفطاعات على صورة القرص , في المثال البسيط التالي سنقوم بتقطيع القرص الى قطاع واحد فقط وجعله قطاع رئيسي إقلاعي تمت تهيئته كنظام ملفات <a href="/title/Ext4" title="Ext4">ext4</a> يحوي على كامل نظام الملفات الخاص بالنظام الضيف.  دون وجود قرص  <a href="/title/Swap" title="Swap">swap</a> .
</p>
<ul><li>قم بتقطيع القرص</li></ul>
<div align="left" dir="ltr">
<pre>$ fdisk archlinux.raw &lt;&lt;&lt; '
$ &gt; o
$ &gt; n
$ &gt; p
$ &gt; 1
$ &gt;
$ &gt;
$ &gt; a
$ &gt; 1
$ &gt; w'
</pre>
</div>
<ul><li>قم بتقطيع بجعل القطاعات متوفرة كأقراص قابلة للإسترجاع loopback , التعلمات التالية تعتبر أن القرص القابل للإسترجاع للملف <code>archlinux.raw</code> هو <code>/dev/loop0</code>, لكن الرقم يمكن أن يكون أعلى إذا كان لديك أقراص قابلة للإسترجاع اخرى .</li></ul>
<div align="left" dir="ltr">
<pre># losetup -f --show archlinux.raw
# kpartx -a /dev/loop0
</pre>
</div>
<div style="padding: 5px; margin: 0.50em 0; background-color: #DDDDFF; border: thin solid #BBBBDD; overflow: hidden;">
<strong>  ملاحظة  </strong>
<code>kpartx</code> هو جزء من <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://aur.archlinux.org/packages/multipath-tools-git/">multipath-tools-git</a></span><sup><small>AUR</small></sup> المُقدم من <a href="/title/Arch_User_Repository" title="Arch User Repository">AUR</a>.  يمكنك الرجوع الى<a href="/title/QEMU#Mounting_a_partition_from_a_raw_image" title="QEMU">QEMU#Mounting a partition from a raw image</a> لمعرفة الطرق الاخرى لكي يتم وصل قطاع داخل صورة قرص وهمي , لكن كن حذراً , حيث لا يتم تنصيب GRUB2 بشكل صحيح الى صورة القرص إذا لم يتم إنشاء القرص القابل للإسترجاع باستخدام (<code>kpartx</code>).</div>
<ul><li>قم بإنشاء انظمة الأقراص في القطاعات التي قمت بإنشائها.</li></ul>
<div align="left" dir="ltr">
<pre># mkfs.ext4 /dev/mapper/loop0p1
</pre>
</div>
<h3>
<span id=".D8.AA.D9.86.D8.B5.D9.8A.D8.A8_.D8.A7.D9.84.D8.AD.D8.B2.D9.85_.D8.B9.D9.84.D9.89_.D8.A7.D9.84.D9.86.D8.B8.D8.A7.D9.85_.D8.A7.D9.84.D8.B6.D9.8A.D9.81"></span><span class="mw-headline" id="تنصيب_الحزم_على_النظام_الضيف">تنصيب الحزم على النظام الضيف</span>
</h3>
<ul><li>قم بوصل المجلد الجذر في نظام ملفات النظام الضيف الى مجلد مؤقت :</li></ul>
<div align="left" dir="ltr">
<pre># TMPDIR=/full/path/to/temporary/directory
</pre>
</div>
<p>للقيام بتلك المهمة على قرص تم تقطيعه الى قطاعات :
</p>
<div align="left" dir="ltr">
<pre># mount /dev/mapper/loop0p1 $TMPDIR
</pre>
</div>
<p>أو على قرص لم يتم تقطيعه:
</p>
<div align="left" dir="ltr">
<pre># mount archlinux.raw $TMPDIR
</pre>
</div>
<p>قم بتنصيب الحزم التي تريد على النظام :
</p>
<div align="left" dir="ltr">
<pre># pacstrap $TMPDIR base
</pre>
</div>
<h3><span class="mw-headline" id="Write_a_fstab_file_for_the_guest">Write a fstab file for the guest</span></h3>
<ul><li>Add any mountpoints to the guest's <a href="/title/Fstab" title="Fstab">fstab</a> file.  In this example, we just need a mountpoint for the guest's root filesystem.  You do not have to specify it by UUID, but it is a good idea to do so because it guarantees that the root partition will be found regardless of what type of disk is emulated.</li></ul>
<pre># UUID=$(blkid -s UUID -o value /dev/mapper/loop0p1)
# echo "UUID=$UUID   /   ext4   defaults   0   1" &gt;&gt; $TMPDIR/etc/fstab 
</pre>
<h3><span class="mw-headline" id="Generate_initramfs_for_the_guest">Generate initramfs for the guest</span></h3>
<p>As noted earlier, <a href="/title/Initramfs" class="mw-redirect" title="Initramfs">initramfs</a> generation failed when installing <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=linux">linux</a></span>.  
</p>
<ul><li>You may need to edit <code>$TMPDIR/etc/mkinitcpio.conf</code> to remove the <code>autodetect</code> hook, to stop your host system's hardware configuration from removing essential modules (e.g. those needed to access the root filesystem) from the <a href="/title/Initramfs" class="mw-redirect" title="Initramfs">initramfs</a> of the guest, which is going to be running in a different environment in a virtual machine.  In addition, it would be a good idea to have the MODULES line read</li></ul>
<pre>MODULES="virtio_blk virtio_pci"
</pre>
<p>so that it will be possible to boot your Arch Linux guest using a paravirtualized block device.
</p>
<ul><li>Generate the initramfs for the guest manually by running the following command:</li></ul>
<pre># mkinitcpio -g $TMPDIR/boot/initramfs-linux.img -k $TMPDIR/boot/vmlinuz-linux -c $TMPDIR/etc/mkinitcpio.conf
</pre>
<h3>
<span id=".D8.AA.D9.86.D8.B5.D9.8A.D8.A8_.D9.85.D9.8F.D8.AD.D9.85.D9.84_.D8.A7.D9.84.D8.A5.D9.82.D9.84.D8.A7.D8.B9_.D8.B9.D9.84.D9.89_.D8.A7.D9.84.D9.86.D8.B8.D8.A7.D9.85_.D8.A7.D9.84.D8.B6.D9.8A.D9.81"></span><span class="mw-headline" id="تنصيب_مُحمل_الإقلاع_على_النظام_الضيف">تنصيب مُحمل الإقلاع على النظام الضيف</span>
</h3>
<p>بخصوص مُحمل الإقلاع, يمكنك الإختيار بين <a href="/title/Extlinux" class="mw-redirect" title="Extlinux">Extlinux</a>, <a href="/title/GRUB2" class="mw-redirect" title="GRUB2">GRUB2</a>, أو غيرها من محملات الإقلاع. وبسبب المشاكل التي تحدث عند تنصيب GRUB2 في هذه الحالة , أنا أقترح تنصيب Extlinux
</p>
<h4><span class="mw-headline" id="Extlinux">Extlinux</span></h4>
<ul><li>تنصيب Extlinux على قطاع الإقلاع في النظام الضيف .</li></ul>
<div align="left" dir="ltr">
<pre># extlinux --install $TMPDIR/boot
</pre>
</div>
<ul><li>تنصيب MBR الخاص بـ"Syslinux" (فقط للأقراص التي تحوي على قطاعات)</li></ul>
<div align="left" dir="ltr">
<pre># dd if=/usr/lib/syslinux/mbr.bin conv=notrunc bs=440 count=1 of=/dev/loop0
</pre>
</div>
<ul><li>إنشاء ملف إعدادات لمُحمل الإقلاع Extlinux , قم باستبدال $UUID بقيمة UUID الخاصة بنظام ملفات الذي يستخدمه النظام الضيف.</li></ul>
<div align="left" dir="ltr">
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">$TMPDIR/boot/extlinux.conf</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">DEFAULT archlinux
LABEL   archlinux
SAY     Booting Arch Linux
LINUX   /boot/vmlinuz-linux
APPEND  root=/dev/disk/by-uuid/$UUID ro
INITRD  /boot/initramfs-linux.img
</pre>
</div>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Note:</strong> لكي يتم الإقلاع من القطاع الرئيسي MBR في الإقراص التي تم تقطيعها الى قطاعات باستخدام مُحمل الإقلاع Extlinux ; يجب أن يُحدد القطاع كقطاع إقلاعي .</div>
<h4><span class="mw-headline" id="GRUB2">GRUB2</span></h4>
<p>في هذا المثال سنقوم بتنصيب مُحمل الإقلاع <a href="/title/GRUB2" class="mw-redirect" title="GRUB2">GRUB2</a> على قرص تم تقطيعه الى قطاعات في النظام الضيف , تأكد من وجود الحزمة <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=grub2-bios">grub2-bios</a></span><sup>[<a href="/title/Help:Procedures#Fix_broken_package_links" title="Help:Procedures">broken link</a>: package not found]</sup> منصبةً على جهازك المُستضيف .
</p>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>ملاحظة:</strong> يمكن أن تقع في عدد من المشاكل عندما تُحاول تنصيب GRUB2 على قرص وهمي . يبدو أنه يعمل فقط على القطاعات المتوفرة كأقراص قابلة للإسترجاع تم إنشاءها يواسطة device mapper , وليس الأقراص التي تم إنشاءها باستخدام <code>loop</code> , إضافة الى ذلك فإن GRUB سيفشل في التعرف الى نظام الملفات ext4 الخاص بك , لذلك أنصحك بإستخدام Extlinux إذا لم يكن لديك أسباب خاصة لإستخدام GRUB .</div>
<ul><li>قم الآن بتنصيب GRUB2 مُحدداً قيمة الخيار <code>--boot-directory</code> الى المجلد <code>/boot</code> في نظام ملفات النظام الضيف , لكن إحذر أن تقوم عن طريق الخطأ بإعادة كتابة مُحمل الإقلاع الخاص بجهازك المُستضيف .</li></ul>
<div align="left" dir="ltr">
<pre># grub-install --boot-directory=$TMPDIR/boot /dev/loop0
</pre>
</div>
<ul><li>الآن قم بكتابة ملف <code>grub.cfg</code> مُستبدلاً $UUID, بقيمة UUID الخاصة بنظام ملفات الذي يستخدمه النظام الضيف.</li></ul>
<div align="left" dir="ltr">
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">$TMPDIR/boot/grub/grub.cfg</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">set default="0"
set timeout="3"
insmod msdospart
insmod ext2
set root='(/dev/sda, msdos1)'
search --no-floppy --fs-uuid --set=root $UUID
menuentry "Arch Linux" {
   linux /boot/vmlinuz-linux root=/dev/disk/by-uuid/$UUID ro
   initrd /boot/initramfs-linux.img
}
</pre>
</div>
<h3>
<span id=".D8.A5.D8.B2.D8.A7.D9.84.D8.A9_.D8.A7.D9.84.D9.85.D9.84.D9.81.D8.A7.D8.AA_.D8.A7.D9.84.D9.85.D8.A4.D9.82.D8.AA.D8.A9"></span><span class="mw-headline" id="إزالة_الملفات_المؤقتة">إزالة الملفات المؤقتة</span>
</h3>
<p>لا يتوجب عليك إقلاع النظام الضيف بينما نظام ملفاته مايزال موصولاً لأن ذلك قد يُسبب بإتلاف الملفات , لذا قم بفصل نظام ملفات النظام الضيف و إزالة أقراص الإرجاع .
</p>
<div align="left" dir="ltr">
<pre># umount $TMPDIR
# kpartx -d /dev/loop0
# losetup -d /dev/loop0
</pre>
</div>
<h3>
<span id=".D8.A5.D9.82.D9.84.D8.A7.D8.B9_.D8.A7.D9.84.D9.86.D8.B8.D8.A7.D9.85_.D8.A7.D9.84.D8.B6.D9.8A.D9.81"></span><span class="mw-headline" id="إقلاع_النظام_الضيف">إقلاع النظام الضيف</span>
</h3>
<p>في النهاية قم بإقلاع النظام الضيف الذي يعمل بتوزيعة Arch Linux بإستخدام أحد برامج الآلة الإفتراضية كبرنامج <a href="/title/QEMU" title="QEMU">QEMU</a>:
</p>
<div align="left" dir="ltr">
<pre># qemu archlinux.raw
</pre>
</div>
<div class="archwiki-template-box archwiki-template-box-tip">
<strong>تلميحة:</strong> If you have built the virtio block drivers into your guest's initramfs, then you can boot it using a paravirtualized block device.  Combine it with <a href="/title/KVM" title="KVM">KVM</a> and a minimal Arch Linux guest will boot to a login prompt in as little as 3 seconds after starting QEMU.
<pre># qemu-system-x86_64 -enable-kvm -drive file=archlinux.raw,media=disk,if=virtio
</pre>
</div>
<h3>
<span id=".D8.AA.D9.84.D9.85.D9.8A.D8.AD.D8.A7.D8.AA"></span><span class="mw-headline" id="تلميحات">تلميحات</span>
</h3>
<ul><li>إذا كنت تستخدم QEMU كبرنامج آلة إفتراضية , فيمكنك تحديد النواة المُستخدمة و initramfs للنظام الضيف عن طريق سطر الأوامر . إذا قُمت بذلك فلن تحتاج الى مُحمل إقلاع في صورة القرص الخاص بك ولا الى تنصيب حزمة <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://archlinux.org/packages/?name=linux">linux</a></span>.</li></ul>
<ul><li>بما أنك تستطيع التحكم الكامل بالعتاد الذي يعمل عليه النظام الضيف . فليس من الصعب أن تقوم ببناء نواة خاصة بك من المصدر تحوي على جميع الواحدات التي تحتاجها فقط .</li></ul>
<ul><li>يمكنك إنشاء عدة نسخ من صورة القرص الذي قُمت بإنشاء و تشغيل أكثر من آلة إفتراضية تعمل على Arch linux في آن واحد .</li></ul>
<ul><li>See <a href="/title/Install_from_existing_Linux" class="mw-redirect" title="Install from existing Linux">Install from existing Linux</a> for some more general tips about installing Arch Linux from an existing Linux installation that does not necessarily have to be Arch Linux.</li></ul>
</div>
</div>
</div>
<div id="catlinks" class="catlinks" data-mw="interface">
<div id="mw-normal-catlinks" class="mw-normal-catlinks">
<a href="/title/Special:Categories" title="Special:Categories">Categories</a>: <ul>
<li><a href="/title/Category:Virtualization_(%D8%A7%D9%84%D8%B9%D8%B1%D8%A8%D9%8A%D8%A9)" title="Category:Virtualization (العربية)">Virtualization (العربية)</a></li>
<li><a href="/title/Category:Installation_process_(%D8%A7%D9%84%D8%B9%D8%B1%D8%A8%D9%8A%D8%A9)" title="Category:Installation process (العربية)">Installation process (العربية)</a></li>
<li><a href="/title/Category:%D8%A7%D9%84%D8%B9%D8%B1%D8%A8%D9%8A%D8%A9" title="Category:العربية">العربية</a></li>
</ul>
</div>
<div id="mw-hidden-catlinks" class="mw-hidden-catlinks mw-hidden-cats-hidden">Hidden categories: <ul>
<li><a href="/title/Category:Pages_or_sections_flagged_with_Template:Bad_translation" title="Category:Pages or sections flagged with Template:Bad translation">Pages or sections flagged with Template:Bad translation</a></li>
<li><a href="/title/Category:Pages_with_broken_package_links" title="Category:Pages with broken package links">Pages with broken package links</a></li>
</ul>
</div>
</div>
	</div>
</div>

<footer id="footer" class="mw-footer" role="contentinfo" style="margin: 0">
	<ul id="footer-info">
		<li>Retrieved from "<a dir="ltr" href="https://wiki.archlinux.org/index.php?title=Creating_Arch_Linux_disk_image_(%D8%A7%D9%84%D8%B9%D8%B1%D8%A8%D9%8A%D8%A9)&amp;oldid=665230">https://wiki.archlinux.org/index.php?title=Creating_Arch_Linux_disk_image_(العربية)&amp;oldid=665230</a>"</li>
		<li id="footer-info-lastmod"> This page was last edited on 29 April 2021, at 13:57.</li>
		<li id="footer-info-copyright">Content is available under <a class="external" rel="nofollow" href="http://www.gnu.org/copyleft/fdl.html">GNU Free Documentation License 1.3 or later</a> unless otherwise noted.</li>
	<br>
</ul>
	<ul id="footer-places">
		<li id="footer-places-privacy"><a href="/title/ArchWiki:Privacy_policy" title="ArchWiki:Privacy policy">Privacy policy</a></li>
		<li id="footer-places-about"><a href="/title/ArchWiki:About" title="ArchWiki:About">About ArchWiki</a></li>
		<li id="footer-places-disclaimer"><a href="/title/ArchWiki:General_disclaimer" title="ArchWiki:General disclaimer">Disclaimers</a></li>
	</ul>
	<ul id="footer-icons" class="noprint">
		<li id="footer-copyrightico">
	</ul>
	<div style="clear: both;"></div>
</footer>



</body>
</html>
