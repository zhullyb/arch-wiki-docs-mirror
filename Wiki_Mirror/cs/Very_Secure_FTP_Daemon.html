<!DOCTYPE html>
<html class="client-nojs" lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<title>Very Secure FTP Daemon (Česky) - ArchWiki</title>
<link rel="stylesheet" href="../ArchWikiOffline.css">
<meta name="ResourceLoaderDynamicStyles" content="">
<meta name="generator" content="MediaWiki 1.35.0">
<meta name="robots" content="noindex,follow">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="shortcut icon" href="/favicon.ico">
<link rel="search" type="application/opensearchdescription+xml" href="/opensearch_desc.php" title="ArchWiki (en)">
<link rel="EditURI" type="application/rsd+xml" href="https://wiki.archlinux.org/api.php?action=rsd">
<link rel="license" href="http://www.gnu.org/copyleft/fdl.html">
<link rel="alternate" type="application/atom+xml" title="ArchWiki Atom feed" href="/index.php?title=Special:RecentChanges&amp;feed=atom">
</head>
<body class="mediawiki ltr sitedir-ltr mw-hide-empty-elt ns-0 ns-subject page-Very_Secure_FTP_Daemon_Česky rootpage-Very_Secure_FTP_Daemon_Česky skin-vector action-view skin-vector-legacy">
<div id="content" class="mw-body" role="main" style="margin: 0">
	<a id="top"></a>
	<div id="siteNotice" class="mw-body-content"></div>
	<div class="mw-indicators mw-body-content">
	</div>
	<h1 id="firstHeading" class="firstHeading" lang="en">Very Secure FTP Daemon (Česky)</h1>
	<div id="bodyContent" class="mw-body-content">
		<div id="siteSub" class="noprint">From ArchWiki</div>
		<div id="contentSub"></div>
		<div id="contentSub2"></div>
		
		<div id="jump-to-nav"></div>
		<a class="mw-jump-link" href="#mw-head">Jump to navigation</a>
		<a class="mw-jump-link" href="#searchInput">Jump to search</a>
		<div id="mw-content-text" lang="en" dir="ltr" class="mw-content-ltr">
<div class="warningbox">The printable version is no longer supported and may have rendering errors. Please update your browser bookmarks and please use the default browser print function instead.</div>
<div class="mw-parser-output">
<div class="noprint archwiki-template-message">
<p><a href="../File:Tango-view-refresh-red.png" class="image"><img alt="Tango-view-refresh-red.png" src="../File:Tango-view-refresh-red.png" decoding="async" width="48" height="48"></a><b>This article or section is out of date.</b><a href="../File:Tango-view-refresh-red.png" class="image"><img alt="Tango-view-refresh-red.png" src="../File:Tango-view-refresh-red.png" decoding="async" width="48" height="48"></a></p>
<div>
<b>Reason:</b> <span style="color:red;">please use the first argument of the template to provide a brief explanation.</span> (Discuss in <a rel="nofollow" class="external text" href="https://wiki.archlinux.org/index.php/Talk:Very_Secure_FTP_Daemon_(%C4%8Cesky)">Talk:Very Secure FTP Daemon (Česky)#</a>)</div>
</div>
<p><b>vsftpd</b> (Very Secure FTP Daemon) je lehký, stabilní a bezpečný FTP server pro UNIX-like systémy.
</p>
<div id="toc" class="toc" role="navigation" aria-labelledby="mw-toc-heading">
<input type="checkbox" role="button" id="toctogglecheckbox" class="toctogglecheckbox" style="display:none"><div class="toctitle" lang="en" dir="ltr">
<h2 id="mw-toc-heading">Contents</h2>
<span class="toctogglespan"><label class="toctogglelabel" for="toctogglecheckbox"></label></span>
</div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Instalace"><span class="tocnumber">1</span> <span class="toctext">Instalace</span></a></li>
<li class="toclevel-1 tocsection-2">
<a href="#Konfigurace"><span class="tocnumber">2</span> <span class="toctext">Konfigurace</span></a>
<ul>
<li class="toclevel-2 tocsection-3"><a href="#Povolen%C3%AD_uploadu"><span class="tocnumber">2.1</span> <span class="toctext">Povolení uploadu</span></a></li>
<li class="toclevel-2 tocsection-4"><a href="#P%C5%99ihla%C5%A1ov%C3%A1n%C3%AD_lok%C3%A1ln%C3%ADch_u%C5%BEivatel%C5%AF"><span class="tocnumber">2.2</span> <span class="toctext">Přihlašování lokálních uživatelů</span></a></li>
<li class="toclevel-2 tocsection-5"><a href="#Anonymn%C3%AD_p%C5%99ihla%C5%A1ov%C3%A1n%C3%AD"><span class="tocnumber">2.3</span> <span class="toctext">Anonymní přihlašování</span></a></li>
<li class="toclevel-2 tocsection-6"><a href="#Prost%C5%99ed%C3%AD_chroot"><span class="tocnumber">2.4</span> <span class="toctext">Prostředí chroot</span></a></li>
<li class="toclevel-2 tocsection-7"><a href="#Zamezen%C3%AD_p%C5%99ihla%C5%A1ov%C3%A1n%C3%AD_u%C5%BEivatel%C5%AF"><span class="tocnumber">2.5</span> <span class="toctext">Zamezení přihlašování uživatelů</span></a></li>
<li class="toclevel-2 tocsection-8"><a href="#Omezen%C3%AD_p%C5%99ipojen%C3%AD"><span class="tocnumber">2.6</span> <span class="toctext">Omezení připojení</span></a></li>
<li class="toclevel-2 tocsection-9"><a href="#Pou%C5%BEit%C3%AD_xinetd"><span class="tocnumber">2.7</span> <span class="toctext">Použití xinetd</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-10">
<a href="#Tipy_a_triky"><span class="tocnumber">3</span> <span class="toctext">Tipy a triky</span></a>
<ul>
<li class="toclevel-2 tocsection-11">
<a href="#PAM_s_virtu%C3%A1ln%C3%ADmi_u%C5%BEivatelsk%C3%BDmi_%C3%BA%C4%8Dty"><span class="tocnumber">3.1</span> <span class="toctext">PAM s virtuálními uživatelskými účty</span></a>
<ul>
<li class="toclevel-3 tocsection-12"><a href="#P%C5%99id%C3%A1n%C3%AD_soukrom%C3%BDch_adres%C3%A1%C5%99%C5%AF_pro_virtu%C3%A1ln%C3%AD_u%C5%BEivatelsk%C3%A9_%C3%BA%C4%8Dty"><span class="tocnumber">3.1.1</span> <span class="toctext">Přidání soukromých adresářů pro virtuální uživatelské účty</span></a></li>
</ul>
</li>
</ul>
</li>
<li class="toclevel-1 tocsection-13"><a href="#Dal%C5%A1%C3%AD_zdroje"><span class="tocnumber">4</span> <span class="toctext">Další zdroje</span></a></li>
</ul>
</div>

<h2><span class="mw-headline" id="Instalace">Instalace</span></h2>
<p>Vsftpd je začleněn do oficiálního repozitáře. Instalovat můžete např. pomocí utility pacman:
</p>
<pre># pacman -S vsftpd
</pre>
<p>Připojení povolíte modifikací souboru <code>/etc/hosts.allow</code>:
</p>
<pre># Povolit všechna připojení
vsftpd: ALL
# Omezit na určený rozsah IP adres
vsftpd: 10.0.0.0/255.255.255.0
</pre>
<p>Server můžete spustit tímto skriptem:
</p>
<pre># /etc/rc.d/vsftpd start
</pre>
<p>Pokud chcete spustit vsftpd při startu počítače, přidejte ho do pole DAEMONS v souboru <code>/etc/rc.conf</code>.
</p>
<p>Pokud chcete použít vsftpd s xinetd následujte postup napsaný níže.
</p>
<h2><span class="mw-headline" id="Konfigurace">Konfigurace</span></h2>
<p>Většiny nastavení docílíte editací souboru <code>/etc/vsftpd.conf</code>. Soubor je dobře zdokumentovaný, a proto tato sekce poukazuje pouze na některé důležité změny. Pro všechny možnosti a dokumentaci můžete použít man vsftpd.conf (5).
</p>
<h3>
<span id="Povolen.C3.AD_uploadu"></span><span class="mw-headline" id="Povolení_uploadu">Povolení uploadu</span>
</h3>
<p>Pokud chcete povolit změny na souborovém systému, jako například při uploadu, <code>WRITE_ENABLE</code> musíte nastavit na YES v souboru <code>/etc/vsftpd.conf</code>:
</p>
<pre>write_enable=YES
</pre>
<h3>
<span id="P.C5.99ihla.C5.A1ov.C3.A1n.C3.AD_lok.C3.A1ln.C3.ADch_u.C5.BEivatel.C5.AF"></span><span class="mw-headline" id="Přihlašování_lokálních_uživatelů">Přihlašování lokálních uživatelů</span>
</h3>
<p>Pro povolení přihlašování uživatelů v souboru <code>/etc/passwd</code> nastavte tento řádek v souboru <code>/etc/vsftpd.conf</code>:
</p>
<pre>local_enable=YES
</pre>
<h3>
<span id="Anonymn.C3.AD_p.C5.99ihla.C5.A1ov.C3.A1n.C3.AD"></span><span class="mw-headline" id="Anonymní_přihlašování">Anonymní přihlašování</span>
</h3>
<p>Tyto řádky v souboru <code>/etc/vsftpd.conf</code> určují, zda se anonymní uživatelé mohou přihlásit:
</p>
<pre>anonymous_enable=YES # Povolí anonymní přihlášení
no_anon_password=YES # Nevyžadovat heslo k anonymnímu přihlášení
anon_max_rate=30000  # Maximální rychlost přenosu anonymními uživateli v bytech za sekundu
</pre>
<h3>
<span id="Prost.C5.99ed.C3.AD_chroot"></span><span class="mw-headline" id="Prostředí_chroot">Prostředí chroot</span>
</h3>
<p>Je možné nastavit prostředí chroot, které uživatelům zamezí opouštění jejich domovského adresáře. Pro povolení zapište následující řádky do souboru <code>/etc/vsftpd.conf</code>:
</p>
<pre>chroot_list_enable=YES
chroot_list_file=/etc/vsftpd.chroot_list
</pre>
<p>Proměnná <code>chroot_list_file</code> udává soubor se seznamem uživatelů, kteří jsou uzavřeni do prostředí chroot.
</p>
<p>Pro ještě přísnější nastavení můžete použít tyto řádky:
</p>
<pre>chroot_local_user=YES
</pre>
<p>Toto nastavení v základu uzavře lokální uživatele fo prostředí chroot. V tomto případě, soubor udaný proměnnou <code>chroot_list_file</code> obsahuje seznam uživatelů, kteří <b>nejsou</b> uzavřeni do prostředí chroot.
</p>
<h3>
<span id="Zamezen.C3.AD_p.C5.99ihla.C5.A1ov.C3.A1n.C3.AD_u.C5.BEivatel.C5.AF"></span><span class="mw-headline" id="Zamezení_přihlašování_uživatelů">Zamezení přihlašování uživatelů</span>
</h3>
<p>Je možné zamezit uživatelům přístup k FTP serveru přidáním 2 řádek do souboru <code>/etc/vsftpd.conf</code>:
</p>
<pre>userlist_enable=YES
userlist_file=/etc/vsftpd.user_list
</pre>
<p><code>chroot_list_file</code> nyní určuje uživatele, kteří se nesmí přihlásit.
</p>
<p>Pokud chcete naopak pouze některým uživatelům povolit přístup, přidejte řádek:
</p>
<pre>userlist_deny=NO
</pre>
<p>Soubor určený na řádku <code>chroot_list_file</code> pak obsahuje uřivatele, kteří se mohou přihlásit.
</p>
<h3>
<span id="Omezen.C3.AD_p.C5.99ipojen.C3.AD"></span><span class="mw-headline" id="Omezení_připojení">Omezení připojení</span>
</h3>
<p>Můžete omezit rychlost přenosu dat, počet klientů a počet připojení na jednu IP adresu pro lokální uživatele, přidáním těchto řádek do souboru <code>/etc/vsftpd.conf</code>:
</p>
<pre>local_max_rate=1000000 # Maximální rychlost přenosu dat v bytech za sekundu
max_clients=50         # Maximální počet klientů, kteří mohou být připojeni
max_per_ip=2           # Maximální počet připojení na jednu IP adresu
</pre>
<h3>
<span id="Pou.C5.BEit.C3.AD_xinetd"></span><span class="mw-headline" id="Použití_xinetd">Použití xinetd</span>
</h3>
<p>Pokud chcete použít vsftpd s xinetd, přidejte následující řádky do souboru <code>/etc/xinetd.d/vsftpd</code>:
</p>
<pre>service ftp
{
        socket_type             = stream
        wait                    = no
        user                    = root
        server                  = /usr/sbin/vsftpd
        log_on_success  += HOST DURATION
        log_on_failure  += HOST
        disable                 = no
}
</pre>
<p>Tyto volby by měly být nastaveny v souboru <code>/etc/vsftpd.conf</code>:
</p>
<pre>tcp_wrappers=YES        # Použít tcp_wrappers ke správě připojení. Poté povolit v hosts.allow
pam_service_name=vsftpd
</pre>
<p>Poté se ujistěte, že je vsftpd povolen pro IP adresy, které se mají připojovat k serveru, v souboru <code>/etc/hosts.allow</code>:
</p>
<pre>vsftpd: ALL
</pre>
<p>Nakonec přidejte xinetd do pole DAEMONS v souboru <code>/etc/rc.conf</code>. Není třeba přidávat vsftpd, neboť bude spuštěn utilitou xinetd kdykoliv bude třeba.
</p>
<p>Pokud při připojování k serveru dostáváte chybová hlášení jako toto:
</p>
<pre>500 OOPS: cap_set_proc
</pre>
<p>Je třeba přidat <i>capability</i> do pole MODULES= v souboru <code>/etc/rc.conf</code>.
</p>
<p>Po přejití na verzi 2.1.0 můžete dostávát během připojování chybová hlášení jako toto:
</p>
<pre>500 OOPS: could not bind listening IPv4 socket
</pre>
<p>V předešlých verzích stačilo nechat tyto řádky zakomentované:
</p>
<pre># Toto použijte k nastavení vsftpd do samostatného módu nebo vsftpd bude fungovat s (x)inetd
# listen=YES
</pre>
<p>V této verzi, a nejspíše i v budoucích, je třeba explicitně nastavit vsftpd, aby neběžel v samostatném módu:
</p>
<pre># Toto použijte k nastavení vsftpd do samostatného módu nebo vsftpd bude fungovat s (x)inetd
listen=NO
</pre>
<h2><span class="mw-headline" id="Tipy_a_triky">Tipy a triky</span></h2>
<h3>
<span id="PAM_s_virtu.C3.A1ln.C3.ADmi_u.C5.BEivatelsk.C3.BDmi_.C3.BA.C4.8Dty"></span><span class="mw-headline" id="PAM_s_virtuálními_uživatelskými_účty">PAM s virtuálními uživatelskými účty</span>
</h3>
<p>Používání virtuálních uživatelů přináší výhodu v nevyžadování reálného uživatelského účtu v systému. Keeping the environment in a container is of course a more secure option.
</p>
<p>Pro vytvoření databáze uživatelů, je nejdříve třeba vytvořit jednoduchý textový soubor, jako například tento:
</p>
<pre>uživatel1
heslo1
uživatel2
heslo2
</pre>
<p>Vložte kolik virtuálních uživatelů potřebujete, jen je třeba zachovat strukturu souboru. Seznam uložte jako logins.txt; na názvu souboru nezáleží. Další krok závisí na databázovém systému Berkeley, který je zahrnutý v základním systému Arch. Jako uživatel root vytvořte databázi ze souboru login.txt (nebo jak jste ho pojmenovali):
</p>
<pre># db_load -T -t hash -f logins.txt /etc/vsftpd_login.db
</pre>
<p>Je vhodné omezit oprávnění k nově vzniklému souboru <code>vsftpd_login.db</code>:
</p>
<pre># chmod 600 /etc/vsftpd_login.db
</pre>
<div class="archwiki-template-box archwiki-template-box-warning">
<strong>Warning:</strong> Ukládání hesel v čistém textu není bezpečné, proto nezapomeňte smazat dočasný soubor tímto příkazem <code>rm logins.txt</code>.</div>
<p>Nyní je třeba zajistit aby PAM byl schopný uživatele identifikovat podle vsftpd_login.db. K docílení tohoto stavu je třeba vytvořit soubor s názvem ftp v adresáři <code>/etc/pam.d/</code>, který obsahuje tyto volby:
</p>
<pre>auth required pam_userdb.so db=/etc/vsftpd_login crypt=hash 
account required pam_userdb.so db=/etc/vsftpd_login crypt=hash
</pre>
<div class="archwiki-template-box archwiki-template-box-note">
<strong>Note:</strong> Při nastavování PAM je použit /etc/vsftpd_login bez přípony .db!</div>
<p>Dále je třeba vytvořit domovské adresáře pro virtuální uživatele. Pro příklad můžete použít adresář <code>/srv/ftp</code> pro hosting dat virtuálních uživatelů. Tento příklad také respektuje základní adresářovou strukturu systému Arch. Nejdříve tedy vytvořte uživatele virtual a učiňte <code>/srv/ftp</code> jeho domovským adresářem:
</p>
<pre># useradd -d /srv/ftp virtual
</pre>
<p>Učiňte uživatele virtual vlastníkem:
</p>
<pre># chown virtual:virtual /srv/ftp
</pre>
<p>Nastavte vsftpd, aby využíval právě vytvořené prostředí, v souboru /etc/vsftpd.conf. Toto je nezbytné nastavení, které omezí přístup pouze na virtuální uživatele, kteří se boudou moci přihlásit pod svým uživatelským jménem a heslem a omezí jejich přístup pouze na adresář <code>/srv/ftp</code>:
</p>
<pre>anonymous_enable=NO
local_enable=YES
chroot_local_user=YES
guest_enable=YES
guest_username=virtual
virtual_use_local_privs=YES
</pre>
<p>Pokud je použita metoda, kdy xinetd spouští službu, vsftpd by měl povolit přístup pouze po přihlášení kombinací uživatelského jména a hesla, která byla definována v databázi.
</p>
<h4>
<span id="P.C5.99id.C3.A1n.C3.AD_soukrom.C3.BDch_adres.C3.A1.C5.99.C5.AF_pro_virtu.C3.A1ln.C3.AD_u.C5.BEivatelsk.C3.A9_.C3.BA.C4.8Dty"></span><span class="mw-headline" id="Přidání_soukromých_adresářů_pro_virtuální_uživatelské_účty">Přidání soukromých adresářů pro virtuální uživatelské účty</span>
</h4>
<p>Nejdříve vytvořte složky pro uživatele:
</p>
<pre># mkdir /srv/ftp/user1
# mkdir /srv/ftp/user2
# chown virtual:virtual /srv/ftp/user?/
</pre>
<p>Poté přidejte následující řádky do souboru <code>/etc/vsftpd.conf</code>:
</p>
<pre>local_root=/srv/ftp/$USER
user_sub_token=$USER
</pre>
<h2>
<span id="Dal.C5.A1.C3.AD_zdroje"></span><span class="mw-headline" id="Další_zdroje">Další zdroje</span>
</h2>
<ul>
<li><a rel="nofollow" class="external text" href="http://vsftpd.beasts.org/">Oficiální stránka vsftpd</a></li>
<li><a rel="nofollow" class="external text" href="http://vsftpd.beasts.org/vsftpd_conf.html">vsftpd.conf man stránka</a></li>
</ul>
</div>
</div>
<div id="catlinks" class="catlinks" data-mw="interface">
<div id="mw-normal-catlinks" class="mw-normal-catlinks">
<a href="../Special:Categories.html" title="Special:Categories">Category</a>: <ul><li><a href="../cs/Category:Networking.html" title="Category:Networking (Česky)">Networking (Česky)</a></li></ul>
</div>
<div id="mw-hidden-catlinks" class="mw-hidden-catlinks mw-hidden-cats-hidden">Hidden category: <ul><li><a href="../en/Category:Pages_or_sections_flagged_with_Template:Out_of_date.html" title="Category:Pages or sections flagged with Template:Out of date">Pages or sections flagged with Template:Out of date</a></li></ul>
</div>
</div>
	</div>
</div>

<footer id="footer" class="mw-footer" role="contentinfo" style="margin: 0">
	<ul id="footer-info">
		<li>Retrieved from "<a dir="ltr" href="https://wiki.archlinux.org/index.php?title=Very_Secure_FTP_Daemon_(%C4%8Cesky)&amp;oldid=638678">https://wiki.archlinux.org/index.php?title=Very_Secure_FTP_Daemon_(Česky)&amp;oldid=638678</a>"</li>
		<li id="footer-info-lastmod"> This page was last edited on 14 October 2020, at 07:19.</li>
		<li id="footer-info-copyright">Content is available under <a class="external" rel="nofollow" href="http://www.gnu.org/copyleft/fdl.html">GNU Free Documentation License 1.3 or later</a> unless otherwise noted.</li>
	<br>
</ul>
	<ul id="footer-places">
		<li id="footer-places-privacy"><a href="../en/ArchWiki:Privacy_policy.html" title="ArchWiki:Privacy policy">Privacy policy</a></li>
		<li id="footer-places-about"><a href="../en/ArchWiki:About.html" title="ArchWiki:About">About ArchWiki</a></li>
		<li id="footer-places-disclaimer"><a href="../en/ArchWiki:General_disclaimer.html" title="ArchWiki:General disclaimer">Disclaimers</a></li>
	</ul>
	<ul id="footer-icons" class="noprint">
		<li id="footer-copyrightico">
	</ul>
	<div style="clear: both;"></div>
</footer>



</body>
</html>
